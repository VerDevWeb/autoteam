var AR=Object.defineProperty,aj=Object.defineProperties;var cj=Object.getOwnPropertyDescriptors;var DR=Object.getOwnPropertySymbols,uj=Object.getPrototypeOf,lj=Object.prototype.hasOwnProperty,dj=Object.prototype.propertyIsEnumerable,hj=Reflect.get;var SR=(n,e,t)=>e in n?AR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,K=(n,e)=>{for(var t in e||={})lj.call(e,t)&&SR(n,t,e[t]);if(DR)for(var t of DR(e))dj.call(e,t)&&SR(n,t,e[t]);return n},ot=(n,e)=>aj(n,cj(e));var fj=(n,e)=>{for(var t in e)AR(n,t,{get:e[t],enumerable:!0})};var Dr=(n,e,t)=>hj(uj(n),t,e);var g=(n,e,t)=>new Promise((r,i)=>{var s=c=>{try{a(t.next(c))}catch(u){i(u)}},o=c=>{try{a(t.throw(c))}catch(u){i(u)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(n,e)).next())});var RR=null;var Zy=1,xR=Symbol("SIGNAL");function Ne(n){let e=RR;return RR=n,e}var NR={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function pj(n){if(!(nv(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Zy)){if(!n.producerMustRecompute(n)&&!ev(n)){n.dirty=!1,n.lastCleanEpoch=Zy;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Zy}}function PR(n){return n&&(n.nextProducerIndex=0),Ne(n)}function MR(n,e){if(Ne(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(nv(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)tv(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function ev(n){gf(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(pj(t),r!==t.version))return!0}return!1}function kR(n){if(gf(n),nv(n))for(let e=0;e<n.producerNode.length;e++)tv(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function tv(n,e){if(mj(n),gf(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)tv(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];gf(i),i.producerIndexOfThis[r]=e}}function nv(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function gf(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function mj(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function gj(){throw new Error}var _j=gj;function OR(n){_j=n}function ue(n){return typeof n=="function"}function wa(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var _f=wa(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function nl(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Rt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ue(r))try{r()}catch(s){e=s instanceof _f?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{LR(s)}catch(o){e=e??[],o instanceof _f?e=[...e,...o.errors]:e.push(o)}}if(e)throw new _f(e)}}add(e){var t;if(e&&e!==this)if(this.closed)LR(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&nl(t,e)}remove(e){let{_finalizers:t}=this;t&&nl(t,e),e instanceof n&&e._removeParent(this)}};Rt.EMPTY=(()=>{let n=new Rt;return n.closed=!0,n})();var rv=Rt.EMPTY;function yf(n){return n instanceof Rt||n&&"closed"in n&&ue(n.remove)&&ue(n.add)&&ue(n.unsubscribe)}function LR(n){ue(n)?n():n.unsubscribe()}var or={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ia={setTimeout(n,e,...t){let{delegate:r}=Ia;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Ia;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function vf(n){Ia.setTimeout(()=>{let{onUnhandledError:e}=or;if(e)e(n);else throw n})}function rl(){}var FR=iv("C",void 0,void 0);function VR(n){return iv("E",void 0,n)}function UR(n){return iv("N",n,void 0)}function iv(n,e,t){return{kind:n,value:e,error:t}}var Js=null;function Ea(n){if(or.useDeprecatedSynchronousErrorHandling){let e=!Js;if(e&&(Js={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Js;if(Js=null,t)throw r}}else n()}function BR(n){or.useDeprecatedSynchronousErrorHandling&&Js&&(Js.errorThrown=!0,Js.error=n)}var Xs=class extends Rt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,yf(e)&&e.add(this)):this.destination=wj}static create(e,t,r){return new Ta(e,t,r)}next(e){this.isStopped?ov(UR(e),this):this._next(e)}error(e){this.isStopped?ov(VR(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ov(FR,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},yj=Function.prototype.bind;function sv(n,e){return yj.call(n,e)}var av=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){wf(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){wf(r)}else wf(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){wf(t)}}},Ta=class extends Xs{constructor(e,t,r){super();let i;if(ue(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&or.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&sv(e.next,s),error:e.error&&sv(e.error,s),complete:e.complete&&sv(e.complete,s)}):i=e}this.destination=new av(i)}};function wf(n){or.useDeprecatedSynchronousErrorHandling?BR(n):vf(n)}function vj(n){throw n}function ov(n,e){let{onStoppedNotification:t}=or;t&&Ia.setTimeout(()=>t(n,e))}var wj={closed:!0,next:rl,error:vj,complete:rl};var ba=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Rn(n){return n}function cv(...n){return uv(n)}function uv(n){return n.length===0?Rn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Fe=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=Ej(t)?t:new Ta(t,r,i);return Ea(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=jR(r),new r((i,s)=>{let o=new Ta({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[ba](){return this}pipe(...t){return uv(t)(this)}toPromise(t){return t=jR(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function jR(n){var e;return(e=n??or.Promise)!==null&&e!==void 0?e:Promise}function Ij(n){return n&&ue(n.next)&&ue(n.error)&&ue(n.complete)}function Ej(n){return n&&n instanceof Xs||Ij(n)&&yf(n)}function lv(n){return ue(n?.lift)}function be(n){return e=>{if(lv(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ce(n,e,t,r,i){return new dv(n,e,t,r,i)}var dv=class extends Xs{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ca(){return be((n,e)=>{let t=null;n._refCount++;let r=Ce(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Da=class extends Fe{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,lv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Rt;let t=this.getSubject();e.add(this.source.subscribe(Ce(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Rt.EMPTY)}return e}refCount(){return Ca()(this)}};var $R=wa(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Qt=(()=>{class n extends Fe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new If(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new $R}next(t){Ea(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Ea(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Ea(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?rv:(this.currentObservers=null,s.push(t),new Rt(()=>{this.currentObservers=null,nl(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new Fe;return t.source=this,t}}return n.create=(e,t)=>new If(e,t),n})(),If=class extends Qt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:rv}};var Ye=class extends Qt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var xn=new Fe(n=>n.complete());function HR(n){return n&&ue(n.schedule)}function qR(n){return n[n.length-1]}function zR(n){return ue(qR(n))?n.pop():void 0}function Wi(n){return HR(qR(n))?n.pop():void 0}function Ef(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function WR(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?s(d.value):i(d.value).then(a,c)}u((r=r.apply(n,e||[])).next())})}function GR(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zs(n){return this instanceof Zs?(this.v=n,this):new Zs(n)}function KR(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(w){return Promise.resolve(w).then(_,h)}}function a(_,w){r[_]&&(i[_]=function(C){return new Promise(function(A,F){s.push([_,C,A,F])>1||c(_,C)})},w&&(i[_]=w(i[_])))}function c(_,w){try{u(r[_](w))}catch(C){p(s[0][3],C)}}function u(_){_.value instanceof Zs?Promise.resolve(_.value.v).then(d,h):p(s[0][2],_)}function d(_){c("next",_)}function h(_){c("throw",_)}function p(_,w){_(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function QR(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof GR=="function"?GR(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}var Tf=n=>n&&typeof n.length=="number"&&typeof n!="function";function bf(n){return ue(n?.then)}function Cf(n){return ue(n[ba])}function Df(n){return Symbol.asyncIterator&&ue(n?.[Symbol.asyncIterator])}function Sf(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Tj(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Af=Tj();function Rf(n){return ue(n?.[Af])}function xf(n){return KR(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Zs(t.read());if(i)return yield Zs(void 0);yield yield Zs(r)}}finally{t.releaseLock()}})}function Nf(n){return ue(n?.getReader)}function Mt(n){if(n instanceof Fe)return n;if(n!=null){if(Cf(n))return bj(n);if(Tf(n))return Cj(n);if(bf(n))return Dj(n);if(Df(n))return YR(n);if(Rf(n))return Sj(n);if(Nf(n))return Aj(n)}throw Sf(n)}function bj(n){return new Fe(e=>{let t=n[ba]();if(ue(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Cj(n){return new Fe(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function Dj(n){return new Fe(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,vf)})}function Sj(n){return new Fe(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function YR(n){return new Fe(e=>{Rj(n,e).catch(t=>e.error(t))})}function Aj(n){return YR(xf(n))}function Rj(n,e){var t,r,i,s;return WR(this,void 0,void 0,function*(){try{for(t=QR(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function wn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function Pf(n,e=0){return be((t,r)=>{t.subscribe(Ce(r,i=>wn(r,n,()=>r.next(i),e),()=>wn(r,n,()=>r.complete(),e),i=>wn(r,n,()=>r.error(i),e)))})}function Mf(n,e=0){return be((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function JR(n,e){return Mt(n).pipe(Mf(e),Pf(e))}function XR(n,e){return Mt(n).pipe(Mf(e),Pf(e))}function ZR(n,e){return new Fe(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function ex(n,e){return new Fe(t=>{let r;return wn(t,e,()=>{r=n[Af](),wn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>ue(r?.return)&&r.return()})}function kf(n,e){if(!n)throw new Error("Iterable cannot be null");return new Fe(t=>{wn(t,e,()=>{let r=n[Symbol.asyncIterator]();wn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function tx(n,e){return kf(xf(n),e)}function nx(n,e){if(n!=null){if(Cf(n))return JR(n,e);if(Tf(n))return ZR(n,e);if(bf(n))return XR(n,e);if(Df(n))return kf(n,e);if(Rf(n))return ex(n,e);if(Nf(n))return tx(n,e)}throw Sf(n)}function ht(n,e){return e?nx(n,e):Mt(n)}function oe(...n){let e=Wi(n);return ht(n,e)}function Sa(n,e){let t=ue(n)?n:()=>n,r=i=>i.error(t());return new Fe(e?i=>e.schedule(r,0,i):r)}function hv(n){return!!n&&(n instanceof Fe||ue(n.lift)&&ue(n.subscribe))}var gi=wa(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function De(n,e){return be((t,r)=>{let i=0;t.subscribe(Ce(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:xj}=Array;function Nj(n,e){return xj(e)?n(...e):n(e)}function rx(n){return De(e=>Nj(n,e))}var{isArray:Pj}=Array,{getPrototypeOf:Mj,prototype:kj,keys:Oj}=Object;function ix(n){if(n.length===1){let e=n[0];if(Pj(e))return{args:e,keys:null};if(Lj(e)){let t=Oj(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function Lj(n){return n&&typeof n=="object"&&Mj(n)===kj}function sx(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function il(...n){let e=Wi(n),t=zR(n),{args:r,keys:i}=ix(n);if(r.length===0)return ht([],e);let s=new Fe(Fj(r,e,i?o=>sx(i,o):Rn));return t?s.pipe(rx(t)):s}function Fj(n,e,t=Rn){return r=>{ox(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)ox(e,()=>{let u=ht(n[c],e),d=!1;u.subscribe(Ce(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function ox(n,e,t){n?wn(t,n,e):e()}function ax(n,e,t,r,i,s,o,a){let c=[],u=0,d=0,h=!1,p=()=>{h&&!c.length&&!u&&e.complete()},_=C=>u<r?w(C):c.push(C),w=C=>{s&&e.next(C),u++;let A=!1;Mt(t(C,d++)).subscribe(Ce(e,F=>{i?.(F),s?_(F):e.next(F)},()=>{A=!0},void 0,()=>{if(A)try{for(u--;c.length&&u<r;){let F=c.shift();o?wn(e,o,()=>w(F)):w(F)}p()}catch(F){e.error(F)}}))};return n.subscribe(Ce(e,_,()=>{h=!0,p()})),()=>{a?.()}}function _t(n,e,t=1/0){return ue(e)?_t((r,i)=>De((s,o)=>e(r,s,i,o))(Mt(n(r,i))),t):(typeof e=="number"&&(t=e),be((r,i)=>ax(r,i,n,t)))}function Aa(n=1/0){return _t(Rn,n)}function cx(){return Aa(1)}function Ra(...n){return cx()(ht(n,Wi(n)))}function Of(n){return new Fe(e=>{Mt(n()).subscribe(e)})}function jn(n,e){return be((t,r)=>{let i=0;t.subscribe(Ce(r,s=>n.call(e,s,i++)&&r.next(s)))})}function Ki(n){return be((e,t)=>{let r=null,i=!1,s;r=e.subscribe(Ce(t,void 0,void 0,o=>{s=Mt(n(o,Ki(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function ux(n,e,t,r,i){return(s,o)=>{let a=t,c=e,u=0;s.subscribe(Ce(o,d=>{let h=u++;c=a?n(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function eo(n,e){return ue(e)?_t(n,e,1):_t(n,1)}function Qi(n){return be((e,t)=>{let r=!1;e.subscribe(Ce(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function _i(n){return n<=0?()=>xn:be((e,t)=>{let r=0;e.subscribe(Ce(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function fv(n){return De(()=>n)}function Lf(n=Vj){return be((e,t)=>{let r=!1;e.subscribe(Ce(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function Vj(){return new gi}function sl(n){return be((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Sr(n,e){let t=arguments.length>=2;return r=>r.pipe(n?jn((i,s)=>n(i,s,r)):Rn,_i(1),t?Qi(e):Lf(()=>new gi))}function xa(n){return n<=0?()=>xn:be((e,t)=>{let r=[];e.subscribe(Ce(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function pv(n,e){let t=arguments.length>=2;return r=>r.pipe(n?jn((i,s)=>n(i,s,r)):Rn,xa(1),t?Qi(e):Lf(()=>new gi))}function mv(n,e){return be(ux(n,e,arguments.length>=2,!0))}function gv(...n){let e=Wi(n);return be((t,r)=>{(e?Ra(n,t,e):Ra(n,t)).subscribe(r)})}function $n(n,e){return be((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(Ce(r,c=>{i?.unsubscribe();let u=0,d=s++;Mt(n(c,d)).subscribe(i=Ce(r,h=>r.next(e?e(c,h,d,u++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function _v(n){return be((e,t)=>{Mt(n).subscribe(Ce(t,()=>t.complete(),rl)),!t.closed&&e.subscribe(t)})}function jt(n,e,t){let r=ue(n)||e||t?{next:n,error:e,complete:t}:n;return r?be((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Ce(s,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),s.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):Rn}var Gx="https://g.co/ng/security#xss",te=class extends Error{constructor(e,t){super(lw(e,t)),this.code=e}};function lw(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function vl(n){return{toString:n}.toString()}var Ff="__parameters__";function Uj(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function Wx(n,e,t){return vl(()=>{let r=Uj(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,u,d){let h=c.hasOwnProperty(Ff)?c[Ff]:Object.defineProperty(c,Ff,{value:[]})[Ff];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var an=globalThis;function Be(n){for(let e in n)if(n[e]===Be)return e;throw Error("Could not find renamed property on target object.")}function En(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(En).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function lx(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var Bj=Be({__forward_ref__:Be});function Kx(n){return n.__forward_ref__=Kx,n.toString=function(){return En(this())},n}function Hn(n){return Qx(n)?n():n}function Qx(n){return typeof n=="function"&&n.hasOwnProperty(Bj)&&n.__forward_ref__===Kx}function ne(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function hr(n){return{providers:n.providers||[],imports:n.imports||[]}}function fp(n){return dx(n,Jx)||dx(n,Xx)}function Yx(n){return fp(n)!==null}function dx(n,e){return n.hasOwnProperty(e)?n[e]:null}function jj(n){let e=n&&(n[Jx]||n[Xx]);return e||null}function hx(n){return n&&(n.hasOwnProperty(fx)||n.hasOwnProperty($j))?n[fx]:null}var Jx=Be({\u0275prov:Be}),fx=Be({\u0275inj:Be}),Xx=Be({ngInjectableDef:Be}),$j=Be({ngInjectorDef:Be}),le=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ne({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Zx(n){return n&&!!n.\u0275providers}var Hj=Be({\u0275cmp:Be}),qj=Be({\u0275dir:Be}),zj=Be({\u0275pipe:Be}),Gj=Be({\u0275mod:Be}),zf=Be({\u0275fac:Be}),ol=Be({__NG_ELEMENT_ID__:Be}),px=Be({__NG_ENV_ID__:Be});function pp(n){return typeof n=="string"?n:n==null?"":String(n)}function Wj(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():pp(n)}function Kj(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new te(-200,n)}function dw(n,e){throw new te(-201,!1)}var ve=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ve||{}),Sv;function eN(){return Sv}function In(n){let e=Sv;return Sv=n,e}function tN(n,e,t){let r=fp(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ve.Optional)return null;if(e!==void 0)return e;dw(n,"Injector")}var Qj={},cl=Qj,Av="__NG_DI_FLAG__",Gf="ngTempTokenPath",Yj="ngTokenPath",Jj=/\n/gm,Xj="\u0275",mx="__source",Oa;function Zj(){return Oa}function Yi(n){let e=Oa;return Oa=n,e}function e$(n,e=ve.Default){if(Oa===void 0)throw new te(-203,!1);return Oa===null?tN(n,void 0,e):Oa.get(n,e&ve.Optional?null:void 0,e)}function re(n,e=ve.Default){return(eN()||e$)(Hn(n),e)}function W(n,e=ve.Default){return re(n,mp(e))}function mp(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Rv(n){let e=[];for(let t=0;t<n.length;t++){let r=Hn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new te(900,!1);let i,s=ve.Default;for(let o=0;o<r.length;o++){let a=r[o],c=t$(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(re(i,s))}else e.push(re(r))}return e}function nN(n,e){return n[Av]=e,n.prototype[Av]=e,n}function t$(n){return n[Av]}function n$(n,e,t,r){let i=n[Gf];throw e[mx]&&i.unshift(e[mx]),n.message=r$(`
`+n.message,i,t,r),n[Yj]=i,n[Gf]=null,n}function r$(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==Xj?n.slice(2):n;let i=En(e);if(Array.isArray(e))i=e.map(En).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):En(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(Jj,`
  `)}`}var gp=nN(Wx("Optional"),8);var hw=nN(Wx("SkipSelf"),4);function ro(n,e){let t=n.hasOwnProperty(zf);return t?n[zf]:null}function fw(n,e){n.forEach(t=>Array.isArray(t)?fw(t,e):e(t))}function rN(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Wf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var ul={},Ar=[],Fa=new le(""),iN=new le("",-1),sN=new le(""),Kf=class{get(e,t=cl){if(t===cl){let r=new Error(`NullInjectorError: No provider for ${En(e)}!`);throw r.name="NullInjectorError",r}return t}},oN=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(oN||{}),Nr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Nr||{}),ur=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(ur||{});function i$(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function xv(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];s$(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function aN(n){return n===3||n===4||n===6}function s$(n){return n.charCodeAt(0)===64}function pw(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?gx(n,t,i,null,e[++r]):gx(n,t,i,null,null))}}return n}function gx(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var cN="ng-template";function o$(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&i$(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(mw(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function mw(n){return n.type===4&&n.value!==cN}function a$(n,e,t){let r=n.type===4&&!t?cN:n.value;return e===r}function c$(n,e,t){let r=4,i=n.attrs,s=i!==null?d$(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!ar(r)&&!ar(c))return!1;if(o&&ar(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!a$(n,c,t)||c===""&&e.length===1){if(ar(r))return!1;o=!0}}else if(r&8){if(i===null||!o$(n,i,c,t)){if(ar(r))return!1;o=!0}}else{let u=e[++a],d=u$(c,i,mw(n),t);if(d===-1){if(ar(r))return!1;o=!0;continue}if(u!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&u!==h){if(ar(r))return!1;o=!0}}}}return ar(r)||o}function ar(n){return(n&1)===0}function u$(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return h$(e,n)}function l$(n,e,t=!1){for(let r=0;r<e.length;r++)if(c$(n,e[r],t))return!0;return!1}function d$(n){for(let e=0;e<n.length;e++){let t=n[e];if(aN(t))return e}return n.length}function h$(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function _x(n,e){return n?":not("+e.trim()+")":e}function f$(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!ar(o)&&(e+=_x(s,i),i=""),r=o,s=s||!ar(r);t++}return i!==""&&(e+=_x(s,i)),e}function p$(n){return n.map(f$).join(",")}function m$(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!ar(i))break;i=s}r++}return{attrs:e,classes:t}}function yt(n){return vl(()=>{let e=pN(n),t=ot(K({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===oN.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Nr.Emulated,styles:n.styles||Ar,_:null,schemas:n.schemas||null,tView:null,id:""});mN(t);let r=n.dependencies;return t.directiveDefs=vx(r,!1),t.pipeDefs=vx(r,!0),t.id=y$(t),t})}function g$(n){return Xi(n)||lN(n)}function _$(n){return n!==null}function fr(n){return vl(()=>({type:n.type,bootstrap:n.bootstrap||Ar,declarations:n.declarations||Ar,imports:n.imports||Ar,exports:n.exports||Ar,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function yx(n,e){if(n==null)return ul;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=ur.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==ur.None?[r,a]:r,e[s]=o):t[s]=r}return t}function ja(n){return vl(()=>{let e=pN(n);return mN(e),e})}function uN(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function Xi(n){return n[Hj]||null}function lN(n){return n[qj]||null}function dN(n){return n[zj]||null}function hN(n){let e=Xi(n)||lN(n)||dN(n);return e!==null?e.standalone:!1}function fN(n,e){let t=n[Gj]||null;if(!t&&e===!0)throw new Error(`Type ${En(n)} does not have '\u0275mod' property.`);return t}function pN(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||ul,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||Ar,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:yx(n.inputs,e),outputs:yx(n.outputs),debugInfo:null}}function mN(n){n.features?.forEach(e=>e(n))}function vx(n,e){if(!n)return null;let t=e?dN:g$;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(_$)}function y$(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function v$(...n){return{\u0275providers:gN(!0,n),\u0275fromNgModule:!0}}function gN(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return fw(e,o=>{let a=o;Nv(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&_N(i,s),t}function _N(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];gw(i,s=>{e(s,r)})}}function Nv(n,e,t,r){if(n=Hn(n),!n)return!1;let i=null,s=hx(n),o=!s&&Xi(n);if(!s&&!o){let c=n.ngModule;if(s=hx(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let u of c)Nv(u,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let u;try{fw(s.imports,d=>{Nv(d,e,t,r)&&(u||=[],u.push(d))})}finally{}u!==void 0&&_N(u,e)}if(!a){let u=ro(i)||(()=>new i);e({provide:i,useFactory:u,deps:Ar},i),e({provide:sN,useValue:i,multi:!0},i),e({provide:Fa,useValue:()=>re(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let u=n;gw(c,d=>{e(d,u)})}}else return!1;return i!==n&&n.providers!==void 0}function gw(n,e){for(let t of n)Zx(t)&&(t=t.\u0275providers),Array.isArray(t)?gw(t,e):e(t)}var w$=Be({provide:String,useValue:Be});function yN(n){return n!==null&&typeof n=="object"&&w$ in n}function I$(n){return!!(n&&n.useExisting)}function E$(n){return!!(n&&n.useFactory)}function Pv(n){return typeof n=="function"}var _p=new le(""),Bf={},T$={},yv;function _w(){return yv===void 0&&(yv=new Kf),yv}var Tn=class{},ll=class extends Tn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,kv(e,o=>this.processProvider(o)),this.records.set(iN,Na(void 0,this)),i.has("environment")&&this.records.set(Tn,Na(void 0,this));let s=this.records.get(_p);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(sN,Ar,ve.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Ne(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ne(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Yi(this),r=In(void 0),i;try{return e()}finally{Yi(t),In(r)}}get(e,t=cl,r=ve.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(px))return e[px](this);r=mp(r);let i,s=Yi(this),o=In(void 0);try{if(!(r&ve.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=R$(e)&&fp(e);u&&this.injectableDefInScope(u)?c=Na(Mv(e),Bf):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ve.Self?_w():this.parent;return t=r&ve.Optional&&t===cl?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Gf]=a[Gf]||[]).unshift(En(e)),s)throw a;return n$(a,e,"R3InjectorError",this.source)}else throw a}finally{In(o),Yi(s)}}resolveInjectorInitializers(){let e=Ne(null),t=Yi(this),r=In(void 0),i;try{let s=this.get(Fa,Ar,ve.Self);for(let o of s)o()}finally{Yi(t),In(r),Ne(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(En(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new te(205,!1)}processProvider(e){e=Hn(e);let t=Pv(e)?e:Hn(e&&e.provide),r=C$(e);if(!Pv(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Na(void 0,Bf,!0),i.factory=()=>Rv(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Ne(null);try{return t.value===Bf&&(t.value=T$,t.value=t.factory()),typeof t.value=="object"&&t.value&&A$(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ne(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Hn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Mv(n){let e=fp(n),t=e!==null?e.factory:ro(n);if(t!==null)return t;if(n instanceof le)throw new te(204,!1);if(n instanceof Function)return b$(n);throw new te(204,!1)}function b$(n){if(n.length>0)throw new te(204,!1);let t=jj(n);return t!==null?()=>t.factory(n):()=>new n}function C$(n){if(yN(n))return Na(void 0,n.useValue);{let e=D$(n);return Na(e,Bf)}}function D$(n,e,t){let r;if(Pv(n)){let i=Hn(n);return ro(i)||Mv(i)}else if(yN(n))r=()=>Hn(n.useValue);else if(E$(n))r=()=>n.useFactory(...Rv(n.deps||[]));else if(I$(n))r=()=>re(Hn(n.useExisting));else{let i=Hn(n&&(n.useClass||n.provide));if(S$(n))r=()=>new i(...Rv(n.deps));else return ro(i)||Mv(i)}return r}function Na(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function S$(n){return!!n.deps}function A$(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function R$(n){return typeof n=="function"||typeof n=="object"&&n instanceof le}function kv(n,e){for(let t of n)Array.isArray(t)?kv(t,e):t&&Zx(t)?kv(t.\u0275providers,e):e(t)}function yi(n,e){n instanceof ll&&n.assertNotDestroyed();let t,r=Yi(n),i=In(void 0);try{return e()}finally{Yi(r),In(i)}}function vN(){return eN()!==void 0||Zj()!=null}function x$(n){if(!vN())throw new te(-203,!1)}function N$(n){let e=an.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function P$(n){return typeof n=="function"}var vi=0,Ee=1,ae=2,Yt=3,cr=4,pr=5,Qf=6,dl=7,lr=8,Va=9,dr=10,$t=11,hl=12,wx=13,$a=14,Pr=15,yp=16,Pa=17,Ua=18,vp=19,wN=20,Ji=21,vv=22,io=23,Mr=25,IN=1;var so=7,Yf=8,Jf=9,qn=10,yw=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(yw||{});function to(n){return Array.isArray(n)&&typeof n[IN]=="object"}function wi(n){return Array.isArray(n)&&n[IN]===!0}function EN(n){return(n.flags&4)!==0}function wp(n){return n.componentOffset>-1}function vw(n){return(n.flags&1)===1}function wl(n){return!!n.template}function M$(n){return(n[ae]&512)!==0}var Ov=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function TN(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function Il(){return bN}function bN(n){return n.type.prototype.ngOnChanges&&(n.setInput=O$),k$}Il.ngInherit=!0;function k$(){let n=DN(this),e=n?.current;if(e){let t=n.previous;if(t===ul)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function O$(n,e,t,r,i){let s=this.declaredInputs[r],o=DN(n)||L$(n,{previous:ul,current:null}),a=o.current||(o.current={}),c=o.previous,u=c[s];a[s]=new Ov(u&&u.currentValue,t,c===ul),TN(n,e,i,t)}var CN="__ngSimpleChanges__";function DN(n){return n[CN]||null}function L$(n,e){return n[CN]=e}var Ix=null;var Rr=function(n,e,t){Ix?.(n,e,t)},F$="svg",V$="math",U$=!1;function B$(){return U$}function kr(n){for(;Array.isArray(n);)n=n[vi];return n}function j$(n,e){return kr(e[n])}function zn(n,e){return kr(e[n.index])}function SN(n,e){return n.data[e]}function $$(n,e){return n[e]}function es(n,e){let t=e[n];return to(t)?t:t[vi]}function ww(n){return(n[ae]&128)===128}function H$(n){return wi(n[Yt])}function Xf(n,e){return e==null?null:n[e]}function AN(n){n[Pa]=0}function q$(n){n[ae]&1024||(n[ae]|=1024,ww(n)&&fl(n))}function z$(n,e){for(;n>0;)e=e[$a],n--;return e}function Iw(n){return!!(n[ae]&9216||n[io]?.dirty)}function Lv(n){n[dr].changeDetectionScheduler?.notify(1),Iw(n)?fl(n):n[ae]&64&&(B$()?(n[ae]|=1024,fl(n)):n[dr].changeDetectionScheduler?.notify())}function fl(n){n[dr].changeDetectionScheduler?.notify();let e=pl(n);for(;e!==null&&!(e[ae]&8192||(e[ae]|=8192,!ww(e)));)e=pl(e)}function RN(n,e){if((n[ae]&256)===256)throw new te(911,!1);n[Ji]===null&&(n[Ji]=[]),n[Ji].push(e)}function G$(n,e){if(n[Ji]===null)return;let t=n[Ji].indexOf(e);t!==-1&&n[Ji].splice(t,1)}function pl(n){let e=n[Yt];return wi(e)?e[Yt]:e}var Te={lFrame:LN(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function W$(){return Te.lFrame.elementDepthCount}function K$(){Te.lFrame.elementDepthCount++}function Q$(){Te.lFrame.elementDepthCount--}function xN(){return Te.bindingsEnabled}function Y$(){return Te.skipHydrationRootTNode!==null}function J$(n){return Te.skipHydrationRootTNode===n}function X$(){Te.skipHydrationRootTNode=null}function Je(){return Te.lFrame.lView}function Lr(){return Te.lFrame.tView}function Ii(n){return Te.lFrame.contextLView=n,n[lr]}function Ei(n){return Te.lFrame.contextLView=null,n}function Gn(){let n=NN();for(;n!==null&&n.type===64;)n=n.parent;return n}function NN(){return Te.lFrame.currentTNode}function Z$(){let n=Te.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function El(n,e){let t=Te.lFrame;t.currentTNode=n,t.isParent=e}function PN(){return Te.lFrame.isParent}function eH(){Te.lFrame.isParent=!1}function tH(){let n=Te.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function nH(n){return Te.lFrame.bindingIndex=n}function Ew(){return Te.lFrame.bindingIndex++}function rH(){return Te.lFrame.inI18n}function iH(n,e){let t=Te.lFrame;t.bindingIndex=t.bindingRootIndex=n,Fv(e)}function sH(){return Te.lFrame.currentDirectiveIndex}function Fv(n){Te.lFrame.currentDirectiveIndex=n}function MN(n){Te.lFrame.currentQueryIndex=n}function oH(n){let e=n[Ee];return e.type===2?e.declTNode:e.type===1?n[pr]:null}function kN(n,e,t){if(t&ve.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&ve.Host);)if(i=oH(s),i===null||(s=s[$a],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=Te.lFrame=ON();return r.currentTNode=e,r.lView=n,!0}function Tw(n){let e=ON(),t=n[Ee];Te.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function ON(){let n=Te.lFrame,e=n===null?null:n.child;return e===null?LN(n):e}function LN(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function FN(){let n=Te.lFrame;return Te.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var VN=FN;function bw(){let n=FN();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function aH(n){return(Te.lFrame.contextLView=z$(n,Te.lFrame.contextLView))[lr]}function Cw(){return Te.lFrame.selectedIndex}function oo(n){Te.lFrame.selectedIndex=n}function Dw(){let n=Te.lFrame;return SN(n.tView,n.selectedIndex)}function cH(){return Te.lFrame.currentNamespace}var UN=!0;function Sw(){return UN}function Aw(n){UN=n}function uH(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=bN(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function Rw(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function jf(n,e,t){BN(n,e,3,t)}function $f(n,e,t,r){(n[ae]&3)===t&&BN(n,e,t,r)}function wv(n,e){let t=n[ae];(t&3)===e&&(t&=16383,t+=1,n[ae]=t)}function BN(n,e,t,r){let i=r!==void 0?n[Pa]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Pa]+=65536),(a<s||s==-1)&&(lH(n,t,e,c),n[Pa]=(n[Pa]&4294901760)+c+2),c++}function Ex(n,e){Rr(4,n,e);let t=Ne(null);try{e.call(n)}finally{Ne(t),Rr(5,n,e)}}function lH(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[ae]>>14<n[Pa]>>16&&(n[ae]&3)===e&&(n[ae]+=16384,Ex(a,s)):Ex(a,s)}var La=-1,ml=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function dH(n){return n instanceof ml}function hH(n){return(n.flags&8)!==0}function fH(n){return(n.flags&16)!==0}function jN(n){return n!==La}function Zf(n){return n&32767}function pH(n){return n>>16}function ep(n,e){let t=pH(n),r=e;for(;t>0;)r=r[$a],t--;return r}var Vv=!0;function tp(n){let e=Vv;return Vv=n,e}var mH=256,$N=mH-1,HN=5,gH=0,xr={};function _H(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(ol)&&(r=t[ol]),r==null&&(r=t[ol]=gH++);let i=r&$N,s=1<<i;e.data[n+(i>>HN)]|=s}function qN(n,e){let t=zN(n,e);if(t!==-1)return t;let r=e[Ee];r.firstCreatePass&&(n.injectorIndex=e.length,Iv(r.data,n),Iv(e,null),Iv(r.blueprint,null));let i=xw(n,e),s=n.injectorIndex;if(jN(i)){let o=Zf(i),a=ep(i,e),c=a[Ee].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|c[o+u]}return e[s+8]=i,s}function Iv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function zN(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function xw(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=YN(i),r===null)return La;if(t++,i=i[$a],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return La}function yH(n,e,t){_H(n,e,t)}function vH(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(aN(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function GN(n,e,t){if(t&ve.Optional||n!==void 0)return n;dw(e,"NodeInjector")}function WN(n,e,t,r){if(t&ve.Optional&&r===void 0&&(r=null),!(t&(ve.Self|ve.Host))){let i=n[Va],s=In(void 0);try{return i?i.get(e,r,t&ve.Optional):tN(e,r,t&ve.Optional)}finally{In(s)}}return GN(r,e,t)}function KN(n,e,t,r=ve.Default,i){if(n!==null){if(e[ae]&2048&&!(r&ve.Self)){let o=bH(n,e,t,r,xr);if(o!==xr)return o}let s=QN(n,e,t,r,xr);if(s!==xr)return s}return WN(e,t,r,i)}function QN(n,e,t,r,i){let s=EH(t);if(typeof s=="function"){if(!kN(e,n,r))return r&ve.Host?GN(i,t,r):WN(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&ve.Optional))dw(t);else return o}finally{VN()}}else if(typeof s=="number"){let o=null,a=zN(n,e),c=La,u=r&ve.Host?e[Pr][pr]:null;for((a===-1||r&ve.SkipSelf)&&(c=a===-1?xw(n,e):e[a+8],c===La||!bx(r,!1)?a=-1:(o=e[Ee],a=Zf(c),e=ep(c,e)));a!==-1;){let d=e[Ee];if(Tx(s,a,d.data)){let h=wH(a,e,t,o,r,u);if(h!==xr)return h}c=e[a+8],c!==La&&bx(r,e[Ee].data[a+8]===u)&&Tx(s,a,e)?(o=d,a=Zf(c),e=ep(c,e)):a=-1}}return i}function wH(n,e,t,r,i,s){let o=e[Ee],a=o.data[n+8],c=r==null?wp(a)&&Vv:r!=o&&(a.type&3)!==0,u=i&ve.Host&&s===a,d=IH(a,o,t,c,u);return d!==null?gl(e,o,d,a):xr}function IH(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,u=n.directiveEnd,d=s>>20,h=r?a:a+d,p=i?a+d:u;for(let _=h;_<p;_++){let w=o[_];if(_<c&&t===w||_>=c&&w.type===t)return _}if(i){let _=o[c];if(_&&wl(_)&&_.type===t)return c}return null}function gl(n,e,t,r){let i=n[t],s=e.data;if(dH(i)){let o=i;o.resolving&&Kj(Wj(s[t]));let a=tp(o.canSeeViewProviders);o.resolving=!0;let c,u=o.injectImpl?In(o.injectImpl):null,d=kN(n,r,ve.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&uH(t,s[t],e)}finally{u!==null&&In(u),tp(a),o.resolving=!1,VN()}}return i}function EH(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(ol)?n[ol]:void 0;return typeof e=="number"?e>=0?e&$N:TH:e}function Tx(n,e,t){let r=1<<n;return!!(t[e+(n>>HN)]&r)}function bx(n,e){return!(n&ve.Self)&&!(n&ve.Host&&e)}var no=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return KN(this._tNode,this._lView,e,mp(r),t)}};function TH(){return new no(Gn(),Je())}function Nw(n){return vl(()=>{let e=n.prototype.constructor,t=e[zf]||Uv(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[zf]||Uv(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Uv(n){return Qx(n)?()=>{let e=Uv(Hn(n));return e&&e()}:ro(n)}function bH(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[ae]&2048&&!(o[ae]&512);){let a=QN(s,o,t,r|ve.Self,xr);if(a!==xr)return a;let c=s.parent;if(!c){let u=o[wN];if(u){let d=u.get(t,xr,r);if(d!==xr)return d}c=YN(o),o=o[$a]}s=c}return i}function YN(n){let e=n[Ee],t=e.type;return t===2?e.declTNode:t===1?n[pr]:null}function Pw(n){return vH(Gn(),n)}function Cx(n,e=null,t=null,r){let i=JN(n,e,t,r);return i.resolveInjectorInitializers(),i}function JN(n,e=null,t=null,r,i=new Set){let s=[t||Ar,v$(n)];return r=r||(typeof n=="object"?void 0:En(n)),new ll(s,e||_w(),r||null,i)}var Fr=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return Cx({name:""},i,r,"");{let s=r.name??"";return Cx({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=cl,e.NULL=new Kf,e.\u0275prov=ne({token:e,providedIn:"any",factory:()=>re(iN)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var CH="ngOriginalError";function Ev(n){return n[CH]}var Or=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Ev(e);for(;t&&Ev(t);)t=Ev(t);return t||null}},XN=new le("",{providedIn:"root",factory:()=>W(Or).handleError.bind(void 0)}),Mw=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=DH,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),Bv=class extends Mw{constructor(e){super(),this._lView=e}onDestroy(e){return RN(this._lView,e),()=>G$(this._lView,e)}};function DH(){return new Bv(Je())}function SH(){return Ip(Gn(),Je())}function Ip(n,e){return new Tl(zn(n,e))}var Tl=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=SH;let n=e;return n})();var jv=class extends Qt{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,vN()&&(this.destroyRef=W(Mw,{optional:!0})??void 0)}emit(e){let t=Ne(null);try{super.next(e)}finally{Ne(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Tv(s),i&&(i=Tv(i)),o&&(o=Tv(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Rt&&e.add(a),a}};function Tv(n){return e=>{setTimeout(n,void 0,e)}}var on=jv;function ZN(n){return(n.flags&128)===128}var eP=new Map,AH=0;function RH(){return AH++}function xH(n){eP.set(n[vp],n)}function NH(n){eP.delete(n[vp])}var Dx="__ngContext__";function ao(n,e){to(e)?(n[Dx]=e[vp],xH(e)):n[Dx]=e}function tP(n){return rP(n[hl])}function nP(n){return rP(n[cr])}function rP(n){for(;n!==null&&!wi(n);)n=n[cr];return n}var $v;function iP(n){$v=n}function PH(){if($v!==void 0)return $v;if(typeof document<"u")return document;throw new te(210,!1)}var Ep=new le("",{providedIn:"root",factory:()=>MH}),MH="ng",kw=new le(""),ts=new le("",{providedIn:"platform",factory:()=>"unknown"});var Ow=new le("",{providedIn:"root",factory:()=>PH().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var kH="h",OH="b";var LH=()=>null;function Lw(n,e,t=!1){return LH(n,e,t)}var sP=!1,FH=new le("",{providedIn:"root",factory:()=>sP});var Vf;function VH(){if(Vf===void 0&&(Vf=null,an.trustedTypes))try{Vf=an.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Vf}function Sx(n){return VH()?.createScriptURL(n)||n}var np=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Gx})`}};function Tp(n){return n instanceof np?n.changingThisBreaksApplicationSecurity:n}function Fw(n,e){let t=UH(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Gx})`)}return t===e}function UH(n){return n instanceof np&&n.getTypeName()||null}var BH=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function oP(n){return n=String(n),n.match(BH)?n:"unsafe:"+n}var bp=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(bp||{});function jH(n){let e=cP();return e?e.sanitize(bp.URL,n)||"":Fw(n,"URL")?Tp(n):oP(pp(n))}function $H(n){let e=cP();if(e)return Sx(e.sanitize(bp.RESOURCE_URL,n)||"");if(Fw(n,"ResourceURL"))return Sx(Tp(n));throw new te(904,!1)}function HH(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?$H:jH}function aP(n,e,t){return HH(e,t)(n)}function cP(){let n=Je();return n&&n[dr].sanitizer}function uP(n){return n instanceof Function?n():n}function qH(n){return(n??W(Fr)).get(ts)==="browser"}var uo=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(uo||{}),zH;function Vw(n,e){return zH(n,e)}function Ma(n,e,t,r,i){if(r!=null){let s,o=!1;wi(r)?s=r:to(r)&&(o=!0,r=r[vi]);let a=kr(r);n===0&&t!==null?i==null?pP(e,t,a):rp(e,t,a,i||null,!0):n===1&&t!==null?rp(e,t,a,i||null,!0):n===2?cq(e,a,o):n===3&&e.destroyNode(a),s!=null&&lq(e,n,s,t,i)}}function GH(n,e){return n.createText(e)}function WH(n,e,t){n.setValue(e,t)}function lP(n,e,t){return n.createElement(e,t)}function KH(n,e){dP(n,e),e[vi]=null,e[pr]=null}function QH(n,e,t,r,i,s){r[vi]=i,r[pr]=e,Cp(n,r,t,1,i,s)}function dP(n,e){e[dr].changeDetectionScheduler?.notify(1),Cp(n,e,e[$t],2,null,null)}function YH(n){let e=n[hl];if(!e)return bv(n[Ee],n);for(;e;){let t=null;if(to(e))t=e[hl];else{let r=e[qn];r&&(t=r)}if(!t){for(;e&&!e[cr]&&e!==n;)to(e)&&bv(e[Ee],e),e=e[Yt];e===null&&(e=n),to(e)&&bv(e[Ee],e),t=e&&e[cr]}e=t}}function JH(n,e,t,r){let i=qn+r,s=t.length;r>0&&(t[i-1][cr]=e),r<s-qn?(e[cr]=t[i],rN(t,qn+r,e)):(t.push(e),e[cr]=null),e[Yt]=t;let o=e[yp];o!==null&&t!==o&&XH(o,e);let a=e[Ua];a!==null&&a.insertView(n),Lv(e),e[ae]|=128}function XH(n,e){let t=n[Jf],i=e[Yt][Yt][Pr];e[Pr]!==i&&(n[ae]|=yw.HasTransplantedViews),t===null?n[Jf]=[e]:t.push(e)}function hP(n,e){let t=n[Jf],r=t.indexOf(e);t.splice(r,1)}function Hv(n,e){if(n.length<=qn)return;let t=qn+e,r=n[t];if(r){let i=r[yp];i!==null&&i!==n&&hP(i,r),e>0&&(n[t-1][cr]=r[cr]);let s=Wf(n,qn+e);KH(r[Ee],r);let o=s[Ua];o!==null&&o.detachView(s[Ee]),r[Yt]=null,r[cr]=null,r[ae]&=-129}return r}function fP(n,e){if(!(e[ae]&256)){let t=e[$t];t.destroyNode&&Cp(n,e,t,3,null,null),YH(e)}}function bv(n,e){if(e[ae]&256)return;let t=Ne(null);try{e[ae]&=-129,e[ae]|=256,e[io]&&kR(e[io]),eq(n,e),ZH(n,e),e[Ee].type===1&&e[$t].destroy();let r=e[yp];if(r!==null&&wi(e[Yt])){r!==e[Yt]&&hP(r,e);let i=e[Ua];i!==null&&i.detachView(n)}NH(e)}finally{Ne(t)}}function ZH(n,e){let t=n.cleanup,r=e[dl];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[dl]=null);let i=e[Ji];if(i!==null){e[Ji]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function eq(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof ml)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Rr(4,a,c);try{c.call(a)}finally{Rr(5,a,c)}}else{Rr(4,i,s);try{s.call(i)}finally{Rr(5,i,s)}}}}}function tq(n,e,t){return nq(n,e.parent,t)}function nq(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[vi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===Nr.None||s===Nr.Emulated)return null}return zn(r,t)}}function rp(n,e,t,r,i){n.insertBefore(e,t,r,i)}function pP(n,e,t){n.appendChild(e,t)}function Ax(n,e,t,r,i){r!==null?rp(n,e,t,r,i):pP(n,e,t)}function rq(n,e,t,r){n.removeChild(e,t,r)}function Uw(n,e){return n.parentNode(e)}function iq(n,e){return n.nextSibling(e)}function sq(n,e,t){return aq(n,e,t)}function oq(n,e,t){return n.type&40?zn(n,t):null}var aq=oq,Rx;function Bw(n,e,t,r){let i=tq(n,r,e),s=e[$t],o=r.parent||e[pr],a=sq(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)Ax(s,i,t[c],a,!1);else Ax(s,i,t,a,!1);Rx!==void 0&&Rx(s,r,e,t,i)}function Hf(n,e){if(e!==null){let t=e.type;if(t&3)return zn(e,n);if(t&4)return qv(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Hf(n,r);{let i=n[e.index];return wi(i)?qv(-1,i):kr(i)}}else{if(t&32)return Vw(e,n)()||kr(n[e.index]);{let r=mP(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=pl(n[Pr]);return Hf(i,r)}else return Hf(n,e.next)}}}return null}function mP(n,e){if(e!==null){let r=n[Pr][pr],i=e.projection;return r.projection[i]}return null}function qv(n,e){let t=qn+n+1;if(t<e.length){let r=e[t],i=r[Ee].firstChild;if(i!==null)return Hf(r,i)}return e[so]}function cq(n,e,t){let r=Uw(n,e);r&&rq(n,r,e,t)}function jw(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&e===0&&(a&&ao(kr(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)jw(n,e,t.child,r,i,s,!1),Ma(e,n,i,a,s);else if(c&32){let u=Vw(t,r),d;for(;d=u();)Ma(e,n,i,d,s);Ma(e,n,i,a,s)}else c&16?uq(n,e,r,t,i,s):Ma(e,n,i,a,s);t=o?t.projectionNext:t.next}}function Cp(n,e,t,r,i,s){jw(t,r,n.firstChild,e,i,s,!1)}function uq(n,e,t,r,i,s){let o=t[Pr],c=o[pr].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let d=c[u];Ma(e,n,i,d,s)}else{let u=c,d=o[Yt];ZN(r)&&(u.flags|=128),jw(n,e,u,d,i,s,!0)}}function lq(n,e,t,r,i){let s=t[so],o=kr(t);s!==o&&Ma(e,n,r,s,i);for(let a=qn;a<t.length;a++){let c=t[a];Cp(c[Ee],c,n,e,r,s)}}function dq(n,e,t){n.setAttribute(e,"style",t)}function gP(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function _P(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&xv(n,e,r),i!==null&&gP(n,e,i),s!==null&&dq(n,e,s)}var Ha={};function cn(n=1){yP(Lr(),Je(),Cw()+n,!1)}function yP(n,e,t,r){if(!r)if((e[ae]&3)===3){let s=n.preOrderCheckHooks;s!==null&&jf(e,s,t)}else{let s=n.preOrderHooks;s!==null&&$f(e,s,0,t)}oo(t)}function Se(n,e=ve.Default){let t=Je();if(t===null)return re(n,e);let r=Gn();return KN(r,t,Hn(n),e)}function vP(){let n="invalid";throw new Error(n)}function wP(n,e,t,r,i,s){let o=Ne(null);try{let a=null;i&ur.SignalBased&&(a=e[r][xR]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&ur.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):TN(e,a,r,s)}finally{Ne(o)}}function hq(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)oo(~i);else{let s=i,o=t[++r],a=t[++r];iH(o,s);let c=e[s];a(2,c)}}}finally{oo(-1)}}function Dp(n,e,t,r,i,s,o,a,c,u,d){let h=e.blueprint.slice();return h[vi]=i,h[ae]=r|4|128|8|64,(u!==null||n&&n[ae]&2048)&&(h[ae]|=2048),AN(h),h[Yt]=h[$a]=n,h[lr]=t,h[dr]=o||n&&n[dr],h[$t]=a||n&&n[$t],h[Va]=c||n&&n[Va]||null,h[pr]=s,h[vp]=RH(),h[Qf]=d,h[wN]=u,h[Pr]=e.type==2?n[Pr]:h,h}function Sp(n,e,t,r,i){let s=n.data[e];if(s===null)s=fq(n,e,t,r,i),rH()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=Z$();s.injectorIndex=o===null?-1:o.injectorIndex}return El(s,!0),s}function fq(n,e,t,r,i){let s=NN(),o=PN(),a=o?s:s&&s.parent,c=n.data[e]=yq(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function IP(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function EP(n,e,t,r,i){let s=Cw(),o=r&2;try{oo(-1),o&&e.length>Mr&&yP(n,e,Mr,!1),Rr(o?2:0,i),t(r,i)}finally{oo(s),Rr(o?3:1,i)}}function TP(n,e,t){if(EN(e)){let r=Ne(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Ne(r)}}}function bP(n,e,t){xN()&&(bq(n,e,t,zn(t,e)),(t.flags&64)===64&&xP(n,e,t))}function CP(n,e,t=zn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function DP(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=$w(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function $w(n,e,t,r,i,s,o,a,c,u,d){let h=Mr+r,p=h+i,_=pq(h,p),w=typeof u=="function"?u():u;return _[Ee]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:d}}function pq(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Ha);return t}function mq(n,e,t,r){let s=r.get(FH,sP)||t===Nr.ShadowDom,o=n.selectRootElement(e,s);return gq(o),o}function gq(n){_q(n)}var _q=()=>null;function yq(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return Y$()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function xx(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=ur.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let u=s;if(i!==null){if(!i.hasOwnProperty(s))continue;u=i[s]}n===0?Nx(r,t,u,a,c):Nx(r,t,u,a)}return r}function Nx(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function vq(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,u=null;for(let d=r;d<i;d++){let h=s[d],p=t?t.get(h):null,_=p?p.inputs:null,w=p?p.outputs:null;c=xx(0,h.inputs,d,c,_),u=xx(1,h.outputs,d,u,w);let C=c!==null&&o!==null&&!mw(e)?Oq(c,d,o):null;a.push(C)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function wq(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function SP(n,e,t,r,i,s,o,a){let c=zn(e,t),u=e.inputs,d;!a&&u!=null&&(d=u[r])?(Hw(n,t,d,r,i),wp(e)&&Iq(t,e.index)):e.type&3?(r=wq(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function Iq(n,e){let t=es(e,n);t[ae]&16||(t[ae]|=64)}function AP(n,e,t,r){if(xN()){let i=r===null?null:{"":-1},s=Dq(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&RP(n,e,t,o,i,a),i&&Sq(t,r,i)}t.mergedAttrs=pw(t.mergedAttrs,t.attrs)}function RP(n,e,t,r,i,s){for(let u=0;u<r.length;u++)yH(qN(t,e),n,r[u].type);Rq(t,n.data.length,r.length);for(let u=0;u<r.length;u++){let d=r[u];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=IP(n,e,r.length,null);for(let u=0;u<r.length;u++){let d=r[u];t.mergedAttrs=pw(t.mergedAttrs,d.hostAttrs),xq(n,t,e,c,d),Aq(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}vq(n,t,s)}function Eq(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;Tq(o)!=a&&o.push(a),o.push(t,r,s)}}function Tq(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function bq(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;wp(t)&&Nq(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||qN(t,e),ao(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],u=gl(e,n,a,t);if(ao(u,e),o!==null&&kq(e,a-i,u,c,t,o),wl(c)){let d=es(t.index,e);d[lr]=gl(e,n,a,t)}}}function xP(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=sH();try{oo(s);for(let a=r;a<i;a++){let c=n.data[a],u=e[a];Fv(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&Cq(c,u)}}finally{oo(-1),Fv(o)}}function Cq(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function Dq(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(l$(e,o.selectors,!1))if(r||(r=[]),wl(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;zv(n,e,c)}else r.unshift(o),zv(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function zv(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function Sq(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new te(-301,!1);r.push(e[i],s)}}}function Aq(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;wl(e)&&(t[""]=n)}}function Rq(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function xq(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=ro(i.type,!0)),o=new ml(s,wl(i),Se);n.blueprint[r]=o,t[r]=o,Eq(n,e,r,IP(n,t,i.hostVars,Ha),i)}function Nq(n,e,t){let r=zn(e,n),i=DP(t),s=n[dr].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=Ap(n,Dp(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function Pq(n,e,t,r,i,s){let o=zn(n,e);Mq(e[$t],o,s,n.value,t,r,i)}function Mq(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?pp(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function kq(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],u=o[a++],d=o[a++],h=o[a++];wP(r,t,c,u,d,h)}}function Oq(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function NP(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function PP(n,e){let t=n.contentQueries;if(t!==null){let r=Ne(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];MN(s),a.contentQueries(2,e[o],o)}}}finally{Ne(r)}}}function Ap(n,e){return n[hl]?n[wx][cr]=e:n[hl]=e,n[wx]=e,e}function Gv(n,e,t){MN(0);let r=Ne(null);try{e(n,t)}finally{Ne(r)}}function Lq(n){return n[dl]||(n[dl]=[])}function Fq(n){return n.cleanup||(n.cleanup=[])}function MP(n,e){let t=n[Va],r=t?t.get(Or,null):null;r&&r.handleError(e)}function Hw(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],u=e[o],d=n.data[o];wP(d,u,r,a,c,i)}}function Vq(n,e,t){let r=j$(e,n);WH(n[$t],r,t)}function Uq(n,e){let t=es(e,n),r=t[Ee];Bq(r,t);let i=t[vi];i!==null&&t[Qf]===null&&(t[Qf]=Lw(i,t[Va])),qw(r,t,t[lr])}function Bq(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function qw(n,e,t){Tw(e);try{let r=n.viewQuery;r!==null&&Gv(1,r,t);let i=n.template;i!==null&&EP(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Ua]?.finishViewCreation(n),n.staticContentQueries&&PP(n,e),n.staticViewQueries&&Gv(2,n.viewQuery,t);let s=n.components;s!==null&&jq(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ae]&=-5,bw()}}function jq(n,e){for(let t=0;t<e.length;t++)Uq(n,e[t])}function $q(n,e,t,r){let i=Ne(null);try{let s=e.tView,a=n[ae]&4096?4096:16,c=Dp(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),u=n[e.index];c[yp]=u;let d=n[Ua];return d!==null&&(c[Ua]=d.createEmbeddedView(s)),qw(s,c,t),c}finally{Ne(i)}}function Px(n,e){return!e||e.firstChild===null||ZN(n)}function Hq(n,e,t,r=!0){let i=e[Ee];if(JH(i,e,n,t),r){let o=qv(t,n),a=e[$t],c=Uw(a,n[so]);c!==null&&QH(i,n[pr],a,e,c,o)}let s=e[Qf];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function ip(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(kr(s)),wi(s)&&qq(s,r);let o=t.type;if(o&8)ip(n,e,t.child,r);else if(o&32){let a=Vw(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=mP(e,t);if(Array.isArray(a))r.push(...a);else{let c=pl(e[Pr]);ip(c[Ee],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function qq(n,e){for(let t=qn;t<n.length;t++){let r=n[t],i=r[Ee].firstChild;i!==null&&ip(r[Ee],r,i,e)}n[so]!==n[vi]&&e.push(n[so])}var kP=[];function zq(n){return n[io]??Gq(n)}function Gq(n){let e=kP.pop()??Object.create(Kq);return e.lView=n,e}function Wq(n){n.lView[io]!==n&&(n.lView=null,kP.push(n))}var Kq=ot(K({},NR),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{fl(n.lView)},consumerOnSignalRead(){this.lView[io]=this}}),OP=100;function LP(n,e=!0,t=0){let r=n[dr],i=r.rendererFactory,s=!1;s||i.begin?.();try{Qq(n,t)}catch(o){throw e&&MP(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function Qq(n,e){Wv(n,e);let t=0;for(;Iw(n);){if(t===OP)throw new te(103,!1);t++,Wv(n,1)}}function Yq(n,e,t,r){let i=e[ae];if((i&256)===256)return;let s=!1;!s&&e[dr].inlineEffectRunner?.flush(),Tw(e);let o=null,a=null;!s&&Jq(n)&&(a=zq(e),o=PR(a));try{AN(e),nH(n.bindingStartIndex),t!==null&&EP(n,e,t,2,r);let c=(i&3)===3;if(!s)if(c){let h=n.preOrderCheckHooks;h!==null&&jf(e,h,null)}else{let h=n.preOrderHooks;h!==null&&$f(e,h,0,null),wv(e,0)}if(Xq(e),FP(e,0),n.contentQueries!==null&&PP(n,e),!s)if(c){let h=n.contentCheckHooks;h!==null&&jf(e,h)}else{let h=n.contentHooks;h!==null&&$f(e,h,1),wv(e,1)}hq(n,e);let u=n.components;u!==null&&UP(e,u,0);let d=n.viewQuery;if(d!==null&&Gv(2,d,r),!s)if(c){let h=n.viewCheckHooks;h!==null&&jf(e,h)}else{let h=n.viewHooks;h!==null&&$f(e,h,2),wv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[vv]){for(let h of e[vv])h();e[vv]=null}s||(e[ae]&=-73)}catch(c){throw fl(e),c}finally{a!==null&&(MR(a,o),Wq(a)),bw()}}function Jq(n){return n.type!==2}function FP(n,e){for(let t=tP(n);t!==null;t=nP(t))for(let r=qn;r<t.length;r++){let i=t[r];VP(i,e)}}function Xq(n){for(let e=tP(n);e!==null;e=nP(e)){if(!(e[ae]&yw.HasTransplantedViews))continue;let t=e[Jf];for(let r=0;r<t.length;r++){let i=t[r],s=i[Yt];q$(i)}}}function Zq(n,e,t){let r=es(e,n);VP(r,t)}function VP(n,e){ww(n)&&Wv(n,e)}function Wv(n,e){let r=n[Ee],i=n[ae],s=n[io],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&ev(s)),s&&(s.dirty=!1),n[ae]&=-9217,o)Yq(r,n,r.template,n[lr]);else if(i&8192){FP(n,1);let a=r.components;a!==null&&UP(n,a,1)}}function UP(n,e,t){for(let r=0;r<e.length;r++)Zq(n,e[r],t)}function zw(n){for(n[dr].changeDetectionScheduler?.notify();n;){n[ae]|=64;let e=pl(n);if(M$(n)&&!e)return n;n=e}return null}var co=class{get rootNodes(){let e=this._lView,t=e[Ee];return ip(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[lr]}set context(e){this._lView[lr]=e}get destroyed(){return(this._lView[ae]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Yt];if(wi(e)){let t=e[Yf],r=t?t.indexOf(this):-1;r>-1&&(Hv(e,r),Wf(t,r))}this._attachedToViewContainer=!1}fP(this._lView[Ee],this._lView)}onDestroy(e){RN(this._lView,e)}markForCheck(){zw(this._cdRefInjectingView||this._lView)}detach(){this._lView[ae]&=-129}reattach(){Lv(this._lView),this._lView[ae]|=128}detectChanges(){this._lView[ae]|=1024,LP(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new te(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,dP(this._lView[Ee],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new te(902,!1);this._appRef=e,Lv(this._lView)}},Rp=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=n4;let n=e;return n})(),e4=Rp,t4=class extends e4{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=$q(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new co(i)}};function n4(){return r4(Gn(),Je())}function r4(n,e){return n.type&4?new t4(e,n,Ip(n,e)):null}var _ie=new RegExp(`^(\\d+)*(${OH}|${kH})*(.*)`);var i4=()=>null;function Mx(n,e){return i4(n,e)}var sp=class{},Kv=class{},op=class{};function s4(n){let e=Error(`No component factory found for ${En(n)}.`);return e[o4]=n,e}var o4="ngComponent";var Qv=class{resolveComponentFactory(e){throw s4(e)}},xp=(()=>{let e=class e{};e.NULL=new Qv;let n=e;return n})(),_l=class{},Np=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>a4();let n=e;return n})();function a4(){let n=Je(),e=Gn(),t=es(e.index,n);return(to(t)?t:n)[$t]}var c4=(()=>{let e=class e{};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),Cv={};var kx=new Set;function Gw(n){kx.has(n)||(kx.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function Ox(...n){}function u4(){let n=typeof an.requestAnimationFrame=="function",e=an[n?"requestAnimationFrame":"setTimeout"],t=an[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var qe=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new on(!1),this.onMicrotaskEmpty=new on(!1),this.onStable=new on(!1),this.onError=new on(!1),typeof Zone>"u")throw new te(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=u4().nativeRequestAnimationFrame,h4(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new te(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new te(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,l4,Ox,Ox);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},l4={};function Ww(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function d4(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(an,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Yv(n),n.isCheckStableRunning=!0,Ww(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Yv(n))}function h4(n){let e=()=>{d4(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(f4(a))return t.invokeTask(i,s,o,a);try{return Lx(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),Fx(n)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return Lx(n),t.invoke(i,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),Fx(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Yv(n),Ww(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Yv(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function Lx(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Fx(n){n._nesting--,Ww(n)}var Jv=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new on,this.onMicrotaskEmpty=new on,this.onStable=new on,this.onError=new on}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function f4(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}function p4(n="zone.js",e){return n==="noop"?new Jv:n==="zone.js"?new qe(e):n}var ka=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(ka||{}),m4={destroy(){}};function Pp(n,e){!e&&x$(Pp);let t=e?.injector??W(Fr);if(!qH(t))return m4;Gw("NgAfterNextRender");let r=t.get(Kw),i=r.handler??=new Zv,s=e?.phase??ka.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(Mw).onDestroy(o),c=yi(t,()=>new Xv(s,()=>{o(),n()}));return i.register(c),{destroy:o}}var Xv=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=W(qe),this.errorHandler=W(Or,{optional:!0}),W(sp,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Zv=class{constructor(){this.executingCallbacks=!1,this.buckets={[ka.EarlyRead]:new Set,[ka.Write]:new Set,[ka.MixedReadWrite]:new Set,[ka.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},Kw=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function ew(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=lx(i,a);else if(s==2){let c=a,u=e[++o];r=lx(r,c+": "+u+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var ap=class extends xp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Xi(e);return new Ba(t,this.ngModule)}};function Vx(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function g4(n){let e=n.toLowerCase();return e==="svg"?F$:e==="math"?V$:null}var tw=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=mp(r);let i=this.injector.get(e,Cv,r);return i!==Cv||t===Cv?i:this.parentInjector.get(e,t,r)}},Ba=class extends op{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=Vx(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return Vx(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=p$(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Ne(null);try{i=i||this.ngModule;let o=i instanceof Tn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new tw(e,o):e,c=a.get(_l,null);if(c===null)throw new te(407,!1);let u=a.get(c4,null),d=a.get(Kw,null),h=a.get(sp,null),p={rendererFactory:c,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},_=c.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",C=r?mq(_,r,this.componentDef.encapsulation,a):lP(_,w,g4(w)),A=512;this.componentDef.signals?A|=4096:this.componentDef.onPush||(A|=16);let F=null;C!==null&&(F=Lw(C,a,!0));let G=$w(0,null,null,1,0,null,null,null,null,null,null),U=Dp(null,G,null,A,null,null,p,_,a,null,F);Tw(U);let Q,se;try{let J=this.componentDef,T,v=null;J.findHostDirectiveDefs?(T=[],v=new Map,J.findHostDirectiveDefs(J,T,v),T.push(J)):T=[J];let I=_4(U,C),b=y4(I,C,J,T,U,p,_);se=SN(G,Mr),C&&I4(_,J,C,r),t!==void 0&&E4(se,this.ngContentSelectors,t),Q=w4(b,J,T,v,U,[T4]),qw(G,U,null)}finally{bw()}return new nw(this.componentType,Q,Ip(se,U),U,se)}finally{Ne(s)}}},nw=class extends Kv{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new co(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;Hw(s[Ee],s,i,e,t),this.previousInputValues.set(e,t);let o=es(this._tNode.index,s);zw(o)}}get injector(){return new no(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function _4(n,e){let t=n[Ee],r=Mr;return n[r]=e,Sp(t,r,2,"#host",null)}function y4(n,e,t,r,i,s,o){let a=i[Ee];v4(r,n,e,o);let c=null;e!==null&&(c=Lw(e,i[Va]));let u=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=Dp(i,DP(t),null,d,i[n.index],n,s,u,null,null,c);return a.firstCreatePass&&zv(a,n,r.length-1),Ap(i,h),i[n.index]=h}function v4(n,e,t,r){for(let i of n)e.mergedAttrs=pw(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(ew(e,e.mergedAttrs,!0),t!==null&&_P(r,t,e))}function w4(n,e,t,r,i,s){let o=Gn(),a=i[Ee],c=zn(o,i);RP(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,p=gl(i,a,h,o);ao(p,i)}xP(a,i,o),c&&ao(c,i);let u=gl(i,a,o.directiveStart+o.componentOffset,o);if(n[lr]=i[lr]=u,s!==null)for(let d of s)d(u,e);return TP(a,o,i),u}function I4(n,e,t,r){if(r)xv(n,t,["ng-version","17.3.11"]);else{let{attrs:i,classes:s}=m$(e.selectors[0]);i&&xv(n,t,i),s&&s.length>0&&gP(n,t,s.join(" "))}}function E4(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function T4(){let n=Gn();Rw(Je()[Ee],n)}var qa=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=b4;let n=e;return n})();function b4(){let n=Gn();return D4(n,Je())}var C4=qa,BP=class extends C4{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Ip(this._hostTNode,this._hostLView)}get injector(){return new no(this._hostTNode,this._hostLView)}get parentInjector(){let e=xw(this._hostTNode,this._hostLView);if(jN(e)){let t=ep(e,this._hostLView),r=Zf(e),i=t[Ee].data[r+8];return new no(i,t)}else return new no(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=Ux(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-qn}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Mx(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,Px(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!P$(e),a;if(o)a=t;else{let w=t||{};a=w.index,r=w.injector,i=w.projectableNodes,s=w.environmentInjector||w.ngModuleRef}let c=o?e:new Ba(Xi(e)),u=r||this.parentInjector;if(!s&&c.ngModule==null){let C=(o?u:this.parentInjector).get(Tn,null);C&&(s=C)}let d=Xi(c.componentType??{}),h=Mx(this._lContainer,d?.id??null),p=h?.firstChild??null,_=c.create(u,i,p,s);return this.insertImpl(_.hostView,a,Px(this._hostTNode,h)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(H$(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Yt],u=new BP(c,c[pr],c[Yt]);u.detach(u.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return Hq(o,i,s,r),e.attachToViewContainerRef(),rN(Dv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=Ux(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Hv(this._lContainer,t);r&&(Wf(Dv(this._lContainer),t),fP(r[Ee],r))}detach(e){let t=this._adjustIndex(e,-1),r=Hv(this._lContainer,t);return r&&Wf(Dv(this._lContainer),t)!=null?new co(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function Ux(n){return n[Yf]}function Dv(n){return n[Yf]||(n[Yf]=[])}function D4(n,e){let t,r=e[n.index];return wi(r)?t=r:(t=NP(r,e,null,n),e[n.index]=t,Ap(e,t)),A4(t,e,n,r),new BP(t,n,e)}function S4(n,e){let t=n[$t],r=t.createComment(""),i=zn(e,n),s=Uw(t,i);return rp(t,s,r,iq(t,i),!1),r}var A4=N4,R4=()=>!1;function x4(n,e,t){return R4(n,e,t)}function N4(n,e,t,r){if(n[so])return;let i;t.type&8?i=kr(r):i=S4(e,t),n[so]=i}function P4(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(L4))}return s}return cp.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(u=>{i.template=u}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let u=i.styles.length,d=i.styleUrls;i.styleUrls.forEach((h,p)=>{a.push(""),o.push(r(h).then(_=>{a[u+p]=_,d.splice(d.indexOf(h),1),d.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(u=>{a.push(u),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>F4(s));e.push(c)}),k4(),Promise.all(e).then(()=>{})}var cp=new Map,M4=new Set;function k4(){let n=cp;return cp=new Map,n}function O4(){return cp.size===0}function L4(n){return typeof n=="string"?n:n.text()}function F4(n){M4.delete(n)}function Qw(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var Zi=class{},yl=class{};var up=class extends Zi{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new ap(this);let i=fN(e);this._bootstrapComponents=uP(i.bootstrap),this._r3Injector=JN(e,t,[{provide:Zi,useValue:this},{provide:xp,useValue:this.componentFactoryResolver},...r],En(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},lp=class extends yl{constructor(e){super(),this.moduleType=e}create(e){return new up(this.moduleType,e,[])}};function V4(n,e,t){return new up(n,e,t)}var rw=class extends Zi{constructor(e){super(),this.componentFactoryResolver=new ap(this),this.instance=null;let t=new ll([...e.providers,{provide:Zi,useValue:this},{provide:xp,useValue:this.componentFactoryResolver}],e.parent||_w(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Mp(n,e,t=null){return new rw({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var kp=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Ye(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function jP(n){return B4(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function U4(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function B4(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function j4(n,e,t){return n[e]=t}function Op(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function $4(n){return(n.flags&32)===32}function H4(n,e,t,r,i,s,o,a,c){let u=e.consts,d=Sp(e,n,4,o||null,Xf(u,a));AP(e,t,d,Xf(u,c)),Rw(e,d);let h=d.tView=$w(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}function Ti(n,e,t,r,i,s,o,a){let c=Je(),u=Lr(),d=n+Mr,h=u.firstCreatePass?H4(d,u,c,e,t,r,i,s,o):u.data[d];El(h,!1);let p=q4(u,c,h,n);Sw()&&Bw(u,c,p,h),ao(p,c);let _=NP(p,c,p,h);return c[d]=_,Ap(c,_),x4(_,h,c),vw(h)&&bP(u,c,h),o!=null&&CP(c,h,a),Ti}var q4=z4;function z4(n,e,t,r){return Aw(!0),e[$t].createComment("")}function Yw(n,e,t,r){let i=Je(),s=Ew();if(Op(i,s,e)){let o=Lr(),a=Dw();Pq(a,i,n,e,t,r)}return Yw}function $P(n,e,t,r){return Op(n,Ew(),t)?e+pp(t)+r:Ha}function Vr(n,e,t){let r=Je(),i=Ew();if(Op(r,i,e)){let s=Lr(),o=Dw();SP(s,o,r,n,e,r[$t],t,!1)}return Vr}function Bx(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";Hw(n,t,s[o],o,r)}function G4(n,e,t,r,i,s){let o=e.consts,a=Xf(o,i),c=Sp(e,n,2,r,a);return AP(e,t,c,Xf(o,s)),c.attrs!==null&&ew(c,c.attrs,!1),c.mergedAttrs!==null&&ew(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function O(n,e,t,r){let i=Je(),s=Lr(),o=Mr+n,a=i[$t],c=s.firstCreatePass?G4(o,s,i,e,t,r):s.data[o],u=W4(s,i,c,a,e,n);i[o]=u;let d=vw(c);return El(c,!0),_P(a,u,c),!$4(c)&&Sw()&&Bw(s,i,u,c),W$()===0&&ao(u,i),K$(),d&&(bP(s,i,c),TP(s,c,i)),r!==null&&CP(i,c),O}function M(){let n=Gn();PN()?eH():(n=n.parent,El(n,!1));let e=n;J$(e)&&X$(),Q$();let t=Lr();return t.firstCreatePass&&(Rw(t,n),EN(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&hH(e)&&Bx(t,e,Je(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&fH(e)&&Bx(t,e,Je(),e.stylesWithoutHost,!1),M}function ce(n,e,t,r){return O(n,e,t,r),M(),ce}var W4=(n,e,t,r,i,s)=>(Aw(!0),lP(r,i,cH()));function lo(){return Je()}var dp="en-US";var K4=dp;function Q4(n){typeof n=="string"&&(K4=n.toLowerCase().replace(/_/g,"-"))}function fe(n,e,t,r){let i=Je(),s=Lr(),o=Gn();return J4(s,i,i[$t],o,n,e,r),fe}function Y4(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[dl],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function J4(n,e,t,r,i,s,o){let a=vw(r),u=n.firstCreatePass&&Fq(n),d=e[lr],h=Lq(e),p=!0;if(r.type&3||o){let C=zn(r,e),A=o?o(C):C,F=h.length,G=o?Q=>o(kr(Q[r.index])):r.index,U=null;if(!o&&a&&(U=Y4(n,e,i,r.index)),U!==null){let Q=U.__ngLastListenerFn__||U;Q.__ngNextListenerFn__=s,U.__ngLastListenerFn__=s,p=!1}else{s=$x(r,e,d,s,!1);let Q=t.listen(A,i,s);h.push(s,Q),u&&u.push(i,G,F,F+1)}}else s=$x(r,e,d,s,!1);let _=r.outputs,w;if(p&&_!==null&&(w=_[i])){let C=w.length;if(C)for(let A=0;A<C;A+=2){let F=w[A],G=w[A+1],se=e[F][G].subscribe(s),J=h.length;h.push(s,se),u&&u.push(i,r.index,J,-(J+1))}}}function jx(n,e,t,r){let i=Ne(null);try{return Rr(6,e,t),t(r)!==!1}catch(s){return MP(n,s),!1}finally{Rr(7,e,t),Ne(i)}}function $x(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?es(n.index,e):e;zw(a);let c=jx(e,t,r,o),u=s.__ngNextListenerFn__;for(;u;)c=jx(e,t,u,o)&&c,u=u.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function bi(n=1){return aH(n)}function Lp(n,e,t,r,i){let s=Je(),o=$P(s,e,t,r);if(o!==Ha){let a=Lr(),c=Dw();SP(a,c,s,n,o,s[$t],i,!1)}return Lp}function X4(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function j(n,e=""){let t=Je(),r=Lr(),i=n+Mr,s=r.firstCreatePass?Sp(r,i,1,e,null):r.data[i],o=Z4(r,t,s,e,n);t[i]=o,Sw()&&Bw(r,t,o,s),El(s,!1)}var Z4=(n,e,t,r,i)=>(Aw(!0),GH(e[$t],r));function za(n){return Fp("",n,""),za}function Fp(n,e,t){let r=Je(),i=$P(r,n,e,t);return i!==Ha&&Vq(r,Cw(),i),Fp}var ez=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=gN(!1,r.type),s=i.length>0?Mp([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=ne({token:e,providedIn:"environment",factory:()=>new e(re(Tn))});let n=e;return n})();function HP(n){Gw("NgStandalone"),n.getStandaloneInjector=e=>e.get(ez).getOrCreateStandaloneInjector(n)}function tz(n,e){let t=n[e];return t===Ha?void 0:t}function nz(n,e,t,r,i,s){let o=e+t;return Op(n,o,i)?j4(n,o+1,s?r.call(s,i):r(i)):tz(n,o+1)}function Vp(n,e){let t=Lr(),r,i=n+Mr;t.firstCreatePass?(r=rz(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=ro(r.type,!0)),o,a=In(Se);try{let c=tp(!1),u=s();return tp(c),X4(t,Je(),i,u),u}finally{In(a)}}function rz(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function Up(n,e,t){let r=n+Mr,i=Je(),s=$$(i,r);return iz(i,r)?nz(i,tH(),e,s.transform,t,s):s.transform(t)}function iz(n,e){return n[Ee].data[e].pure}var Uf=null;function sz(n){Uf!==null&&(n.defaultEncapsulation!==Uf.defaultEncapsulation||n.preserveWhitespaces!==Uf.preserveWhitespaces)||(Uf=n)}var Bp=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var Jw=new le(""),bl=new le(""),jp=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,Xw||(oz(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{qe.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(re(qe),re($p),re(bl))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),$p=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return Xw?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function oz(n){Xw=n}var Xw;function Ga(n){return!!n&&typeof n.then=="function"}function Zw(n){return!!n&&typeof n.subscribe=="function"}var Hp=new le(""),qP=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=W(Hp,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Ga(o))r.push(o);else if(Zw(o)){let a=new Promise((c,u)=>{o.subscribe({complete:c,error:u})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),eI=new le("");function az(){OR(()=>{throw new te(600,!1)})}function cz(n){return n.isBoundToModule}function uz(n,e,t){try{let r=t();return Ga(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function zP(n,e){return Array.isArray(e)?e.reduce(zP,n):K(K({},n),e)}var Wa=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=W(XN),this.afterRenderEffectManager=W(Kw),this.externalTestViews=new Set,this.beforeRender=new Qt,this.afterTick=new Qt,this.componentTypes=[],this.components=[],this.isStable=W(kp).hasPendingTasks.pipe(De(r=>!r)),this._injector=W(Tn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof op;if(!this._injector.get(qP).done){let _=!s&&hN(r),w=!1;throw new te(405,w)}let a;s?a=r:a=this._injector.get(xp).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=cz(a)?void 0:this._injector.get(Zi),u=i||a.selector,d=a.create(Fr.NULL,[],u,c),h=d.location.nativeElement,p=d.injector.get(Jw,null);return p?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),qf(this.components,d),p?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new te(101,!1);let i=Ne(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Ne(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===OP)throw new te(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)lz(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>iw(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>iw(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;qf(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(eI,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>qf(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new te(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function qf(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function lz(n,e,t){!e&&!iw(n)||dz(n,t,e)}function iw(n){return Iw(n)}function dz(n,e,t){let r;t?(r=0,n[ae]|=1024):n[ae]&64?r=0:r=1,LP(n,e,r)}var sw=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},qp=(()=>{let e=class e{compileModuleSync(r){return new lp(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=fN(r),o=uP(s.declarations).reduce((a,c)=>{let u=Xi(c);return u&&a.push(new Ba(u)),a},[]);return new sw(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),hz=new le("");function fz(n,e,t){let r=new lp(t);return Promise.resolve(r)}function Hx(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var pz=(()=>{let e=class e{constructor(){this.zone=W(qe),this.applicationRef=W(Wa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function mz(n){return[{provide:qe,useFactory:n},{provide:Fa,multi:!0,useFactory:()=>{let e=W(pz,{optional:!0});return()=>e.initialize()}},{provide:Fa,multi:!0,useFactory:()=>{let e=W(yz);return()=>{e.initialize()}}},{provide:XN,useFactory:gz}]}function gz(){let n=W(qe),e=W(Or);return t=>n.runOutsideAngular(()=>e.handleError(t))}function _z(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var yz=(()=>{let e=class e{constructor(){this.subscription=new Rt,this.initialized=!1,this.zone=W(qe),this.pendingTasks=W(kp)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{qe.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{qe.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function vz(){return typeof $localize<"u"&&$localize.locale||dp}var tI=new le("",{providedIn:"root",factory:()=>W(tI,ve.Optional|ve.SkipSelf)||vz()});var GP=new le(""),WP=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=p4(i?.ngZone,_z({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=V4(r.moduleType,this.injector,mz(()=>s)),a=o.injector.get(Or,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:u=>{a.handleError(u)}});o.onDestroy(()=>{qf(this._modules,o),c.unsubscribe()})}),uz(a,s,()=>{let c=o.injector.get(qP);return c.runInitializers(),c.donePromise.then(()=>{let u=o.injector.get(tI,dp);return Q4(u||dp),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=zP({},i);return fz(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(Wa);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new te(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new te(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(GP,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(re(Fr))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),al=null,KP=new le("");function wz(n){if(al&&!al.get(KP,!1))throw new te(400,!1);az(),al=n;let e=n.get(WP);return Tz(n),e}function nI(n,e,t=[]){let r=`Platform: ${e}`,i=new le(r);return(s=[])=>{let o=QP();if(!o||o.injector.get(KP,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):wz(Iz(a,r))}return Ez(i)}}function Iz(n=[],e){return Fr.create({name:e,providers:[{provide:_p,useValue:"platform"},{provide:GP,useValue:new Set([()=>al=null])},...n]})}function Ez(n){let e=QP();if(!e)throw new te(401,!1);return e}function QP(){return al?.get(WP)??null}function Tz(n){n.get(kw,null)?.forEach(t=>t())}var Ka=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=bz;let n=e;return n})();function bz(n){return Cz(Gn(),Je(),(n&16)===16)}function Cz(n,e,t){if(wp(n)&&!t){let r=es(n.index,e);return new co(r,r)}else if(n.type&47){let r=e[Pr];return new co(r,e)}return null}var ow=class{constructor(){}supports(e){return jP(e)}create(e){return new aw(e)}},Dz=(n,e)=>e,aw=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Dz}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<qx(r,i,s)?t:r,a=qx(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let u=a-i,d=c-i;if(u!=d){for(let p=0;p<u;p++){let _=p<s.length?s[p]:s[p]=0,w=_+p;d<=w&&w<u&&(s[p]=_+1)}let h=o.previousIndex;s[h]=d-u}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!jP(e))throw new te(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,U4(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new cw(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new hp),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new hp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},cw=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},uw=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},hp=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new uw,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function qx(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function zx(){return new rI([new ow])}var rI=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||zx()),deps:[[e,new hw,new gp]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new te(901,!1)}};e.\u0275prov=ne({token:e,providedIn:"root",factory:zx});let n=e;return n})();var YP=nI(null,"core",[]),JP=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(re(Wa))},e.\u0275mod=fr({type:e}),e.\u0275inj=hr({});let n=e;return n})();function Cl(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function iI(n){let e=Ne(null);try{return n()}finally{Ne(e)}}function XP(n){let e=Xi(n);if(!e)return null;let t=new Ba(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var iM=null;function ho(){return iM}function sM(n){iM??=n}var zp=class{};var bn=new le(""),dI=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(Sz),providedIn:"platform"});let n=e;return n})(),oM=new le(""),Sz=(()=>{let e=class e extends dI{constructor(){super(),this._doc=W(bn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ho().getBaseHref(this._doc)}onPopState(r){let i=ho().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=ho().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function hI(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function ZP(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Ci(n){return n&&n[0]!=="?"?"?"+n:n}var mr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(fI),providedIn:"root"});let n=e;return n})(),aM=new le(""),fI=(()=>{let e=class e extends mr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??W(bn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return hI(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Ci(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Ci(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Ci(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(re(dI),re(aM,8))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Wp=(()=>{let e=class e extends mr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=hI(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Ci(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Ci(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(re(dI),re(aM,8))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Qa=(()=>{let e=class e{constructor(r){this._subject=new on,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=xz(ZP(eM(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Ci(i))}normalize(r){return e.stripTrailingSlash(Rz(this._basePath,eM(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Ci(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Ci(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Ci,e.joinWithSlash=hI,e.stripTrailingSlash=ZP,e.\u0275fac=function(i){return new(i||e)(re(mr))},e.\u0275prov=ne({token:e,factory:()=>Az(),providedIn:"root"});let n=e;return n})();function Az(){return new Qa(re(mr))}function Rz(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function eM(n){return n.replace(/\/index.html$/,"")}function xz(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function cM(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var sI=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Kp=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new sI(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),tM(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);tM(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(Se(qa),Se(Rp),Se(rI))},e.\u0275dir=ja({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let n=e;return n})();function tM(n,e){n.context.$implicit=e.item}var Qp=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new oI,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){nM("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){nM("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(Se(qa),Se(Rp))},e.\u0275dir=ja({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let n=e;return n})(),oI=class{constructor(){this.$implicit=null,this.ngIf=null}};function nM(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${En(e)}'.`)}function Nz(n,e){return new te(2100,!1)}var aI=class{createSubscription(e,t){return iI(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){iI(()=>e.unsubscribe())}},cI=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},Pz=new cI,Mz=new aI,Yp=(()=>{let e=class e{constructor(r){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=r}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(r){if(!this._obj){if(r)try{this.markForCheckOnValueUpdate=!1,this._subscribe(r)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return r!==this._obj?(this._dispose(),this.transform(r)):this._latestValue}_subscribe(r){this._obj=r,this._strategy=this._selectStrategy(r),this._subscription=this._strategy.createSubscription(r,i=>this._updateLatestValue(r,i))}_selectStrategy(r){if(Ga(r))return Pz;if(Zw(r))return Mz;throw Nz(e,r)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(r,i){r===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}};e.\u0275fac=function(i){return new(i||e)(Se(Ka,16))},e.\u0275pipe=uN({name:"async",type:e,pure:!1,standalone:!0});let n=e;return n})();var uM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=fr({type:e}),e.\u0275inj=hr({});let n=e;return n})(),pI="browser",kz="server";function Oz(n){return n===pI}function mI(n){return n===kz}var lM=(()=>{let e=class e{};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>Oz(W(ts))?new uI(W(bn),window):new lI});let n=e;return n})(),uI=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=Lz(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function Lz(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var lI=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Gp=class{};var yI=class extends zp{constructor(){super(...arguments),this.supportsDOMEvents=!0}},vI=class n extends yI{static makeCurrent(){sM(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Vz();return t==null?null:Uz(t)}resetBaseElement(){Dl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return cM(document.cookie,e)}},Dl=null;function Vz(){return Dl=Dl||document.querySelector("base"),Dl?Dl.getAttribute("href"):null}function Uz(n){return new URL(n,document.baseURI).pathname}var wI=class{addToWindow(e){an.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new te(5103,!1);return s},an.getAllAngularTestabilities=()=>e.getAllTestabilities(),an.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=an.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};an.frameworkStabilizers||(an.frameworkStabilizers=[]),an.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?ho().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},Bz=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),II=new le(""),pM=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new te(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(re(II),re(qe))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Xp=class{constructor(e){this._doc=e}},gI="ng-app-id",mM=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=mI(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${gI}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(gI),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(gI,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(re(bn),re(Ep),re(Ow,8),re(ts))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),_I={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},TI=/%COMP%/g,gM="%COMP%",jz=`_nghost-${gM}`,$z=`_ngcontent-${gM}`,Hz=!0,qz=new le("",{providedIn:"root",factory:()=>Hz});function zz(n){return $z.replace(TI,n)}function Gz(n){return jz.replace(TI,n)}function _M(n,e){return e.map(t=>t.replace(TI,n))}var dM=(()=>{let e=class e{constructor(r,i,s,o,a,c,u,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=u,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=mI(c),this.defaultRenderer=new Sl(r,a,u,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Nr.ShadowDom&&(i=ot(K({},i),{encapsulation:Nr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Zp?s.applyToHost(r):s instanceof Al&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,u=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(i.encapsulation){case Nr.Emulated:o=new Zp(u,d,i,this.appId,h,a,c,p);break;case Nr.ShadowDom:return new EI(u,d,r,i,a,c,this.nonce,p);default:o=new Al(u,d,i,h,a,c,p);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(re(pM),re(mM),re(Ep),re(qz),re(bn),re(ts),re(qe),re(Ow))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Sl=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(_I[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(hM(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(hM(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new te(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=_I[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=_I[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(uo.DashCase|uo.Important)?e.style.setProperty(t,r,i&uo.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&uo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=ho().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function hM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var EI=class extends Sl{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=_M(i.id,i.styles);for(let d of u){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Al=class extends Sl{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?_M(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Zp=class extends Al{constructor(e,t,r,i,s,o,a,c){let u=i+"-"+r.id;super(e,t,r,s,o,a,c,u),this.contentAttr=zz(u),this.hostAttr=Gz(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},Wz=(()=>{let e=class e extends Xp{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(re(bn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),fM=["alt","control","meta","shift"],Kz={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Qz={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Yz=(()=>{let e=class e extends Xp{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ho().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),fM.forEach(d=>{let h=i.indexOf(d);h>-1&&(i.splice(h,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let u={};return u.domEventName=s,u.fullKey=a,u}static matchEventFullKeyCode(r,i){let s=Kz[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),fM.forEach(a=>{if(a!==s){let c=Qz[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(re(bn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function Jz(){vI.makeCurrent()}function Xz(){return new Or}function Zz(){return iP(document),document}var eG=[{provide:ts,useValue:pI},{provide:kw,useValue:Jz,multi:!0},{provide:bn,useFactory:Zz,deps:[]}],yM=nI(YP,"browser",eG),tG=new le(""),nG=[{provide:bl,useClass:wI,deps:[]},{provide:Jw,useClass:jp,deps:[qe,$p,bl]},{provide:jp,useClass:jp,deps:[qe,$p,bl]}],rG=[{provide:_p,useValue:"root"},{provide:Or,useFactory:Xz,deps:[]},{provide:II,useClass:Wz,multi:!0,deps:[bn,qe,ts]},{provide:II,useClass:Yz,multi:!0,deps:[bn]},dM,mM,pM,{provide:_l,useExisting:dM},{provide:Gp,useClass:Bz,deps:[]},[]],vM=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Ep,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(re(tG,12))},e.\u0275mod=fr({type:e}),e.\u0275inj=hr({providers:[...rG,...nG],imports:[uM,JP]});let n=e;return n})();var wM=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(re(bn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var me="primary",Hl=Symbol("RouteTitle"),AI=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ec(n){return new AI(n)}function iG(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function sG(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Ur(n[t],e[t]))return!1;return!0}function Ur(n,e){let t=n?RI(n):void 0,r=e?RI(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!xM(n[i],e[i]))return!1;return!0}function RI(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function xM(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function NM(n){return n.length>0?n[n.length-1]:null}function ss(n){return hv(n)?n:Ga(n)?ht(Promise.resolve(n)):oe(n)}var oG={exact:MM,subset:kM},PM={exact:aG,subset:cG,ignored:()=>!0};function EM(n,e,t){return oG[t.paths](n.root,e.root,t.matrixParams)&&PM[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function aG(n,e){return Ur(n,e)}function MM(n,e,t){if(!po(n.segments,e.segments)||!nm(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!MM(n.children[r],e.children[r],t))return!1;return!0}function cG(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>xM(n[t],e[t]))}function kM(n,e,t){return OM(n,e,e.segments,t)}function OM(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!po(i,t)||e.hasChildren()||!nm(i,t,r))}else if(n.segments.length===t.length){if(!po(n.segments,t)||!nm(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!kM(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!po(n.segments,i)||!nm(n.segments,i,r)||!n.children[me]?!1:OM(n.children[me],e,s,r)}}function nm(n,e,t){return e.every((r,i)=>PM[t](n[i].parameters,r.parameters))}var ns=class{constructor(e=new Oe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ec(this.queryParams),this._queryParamMap}toString(){return dG.serialize(this)}},Oe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return rm(this)}},fo=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ec(this.parameters),this._parameterMap}toString(){return FM(this)}};function uG(n,e){return po(n,e)&&n.every((t,r)=>Ur(t.parameters,e[r].parameters))}function po(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function lG(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===me&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==me&&(t=t.concat(e(i,r)))}),t}var ql=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>new Ol,providedIn:"root"});let n=e;return n})(),Ol=class{parse(e){let t=new NI(e);return new ns(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Rl(e.root,!0)}`,r=pG(e.queryParams),i=typeof e.fragment=="string"?`#${hG(e.fragment)}`:"";return`${t}${r}${i}`}},dG=new Ol;function rm(n){return n.segments.map(e=>FM(e)).join("/")}function Rl(n,e){if(!n.hasChildren())return rm(n);if(e){let t=n.children[me]?Rl(n.children[me],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==me&&r.push(`${i}:${Rl(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=lG(n,(r,i)=>i===me?[Rl(n.children[me],!1)]:[`${i}:${Rl(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[me]!=null?`${rm(n)}/${t[0]}`:`${rm(n)}/(${t.join("//")})`}}function LM(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function em(n){return LM(n).replace(/%3B/gi,";")}function hG(n){return encodeURI(n)}function xI(n){return LM(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function im(n){return decodeURIComponent(n)}function TM(n){return im(n.replace(/\+/g,"%20"))}function FM(n){return`${xI(n.path)}${fG(n.parameters)}`}function fG(n){return Object.entries(n).map(([e,t])=>`;${xI(e)}=${xI(t)}`).join("")}function pG(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${em(t)}=${em(i)}`).join("&"):`${em(t)}=${em(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var mG=/^[^\/()?;#]+/;function bI(n){let e=n.match(mG);return e?e[0]:""}var gG=/^[^\/()?;=#]+/;function _G(n){let e=n.match(gG);return e?e[0]:""}var yG=/^[^=?&#]+/;function vG(n){let e=n.match(yG);return e?e[0]:""}var wG=/^[^&#]+/;function IG(n){let e=n.match(wG);return e?e[0]:""}var NI=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Oe([],{}):new Oe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[me]=new Oe(e,t)),r}parseSegment(){let e=bI(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new te(4009,!1);return this.capture(e),new fo(im(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=_G(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=bI(this.remaining);i&&(r=i,this.capture(r))}e[im(t)]=im(r)}parseQueryParam(e){let t=vG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=IG(this.remaining);o&&(r=o,this.capture(r))}let i=TM(t),s=TM(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=bI(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new te(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=me);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[me]:new Oe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new te(4011,!1)}};function VM(n){return n.segments.length>0?new Oe([],{[me]:n}):n}function UM(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=UM(i);if(r===me&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Oe(n.segments,e);return EG(t)}function EG(n){if(n.numberOfChildren===1&&n.children[me]){let e=n.children[me];return new Oe(n.segments.concat(e.segments),e.children)}return n}function tc(n){return n instanceof ns}function TG(n,e,t=null,r=null){let i=BM(n);return jM(i,e,t,r)}function BM(n){let e;function t(s){let o={};for(let c of s.children){let u=t(c);o[c.outlet]=u}let a=new Oe(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=VM(r);return e??i}function jM(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return CI(i,i,i,t,r);let s=bG(e);if(s.toRoot())return CI(i,i,new Oe([],{}),t,r);let o=CG(s,i,n),a=o.processChildren?Pl(o.segmentGroup,o.index,s.commands):HM(o.segmentGroup,o.index,s.commands);return CI(i,o.segmentGroup,a,t,r)}function sm(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Ll(n){return typeof n=="object"&&n!=null&&n.outlets}function CI(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(d=>`${d}`):`${u}`});let o;n===e?o=t:o=$M(n,e,t);let a=VM(UM(o));return new ns(a,s,i)}function $M(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=$M(s,e,t)}),new Oe(n.segments,r)}var om=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&sm(r[0]))throw new te(4003,!1);let i=r.find(Ll);if(i&&i!==NM(r))throw new te(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function bG(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new om(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new om(t,e,r)}var Xa=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function CG(n,e,t){if(n.isAbsolute)return new Xa(e,!0,0);if(!t)return new Xa(e,!1,NaN);if(t.parent===null)return new Xa(t,!0,0);let r=sm(n.commands[0])?0:1,i=t.segments.length-1+r;return DG(t,i,n.numberOfDoubleDots)}function DG(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new te(4005,!1);i=r.segments.length}return new Xa(r,!1,i-s)}function SG(n){return Ll(n[0])?n[0].outlets:{[me]:n}}function HM(n,e,t){if(n??=new Oe([],{}),n.segments.length===0&&n.hasChildren())return Pl(n,e,t);let r=AG(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Oe(n.segments.slice(0,r.pathIndex),{});return s.children[me]=new Oe(n.segments.slice(r.pathIndex),n.children),Pl(s,0,i)}else return r.match&&i.length===0?new Oe(n.segments,{}):r.match&&!n.hasChildren()?PI(n,e,t):r.match?Pl(n,0,i):PI(n,e,t)}function Pl(n,e,t){if(t.length===0)return new Oe(n.segments,{});{let r=SG(t),i={};if(Object.keys(r).some(s=>s!==me)&&n.children[me]&&n.numberOfChildren===1&&n.children[me].segments.length===0){let s=Pl(n.children[me],e,t);return new Oe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=HM(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Oe(n.segments,i)}}function AG(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(Ll(a))break;let c=`${a}`,u=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!CM(c,u,o))return s;r+=2}else{if(!CM(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function PI(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Ll(s)){let c=RG(s.outlets);return new Oe(r,c)}if(i===0&&sm(t[0])){let c=n.segments[e];r.push(new fo(c.path,bM(t[0]))),i++;continue}let o=Ll(s)?s.outlets[me]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&sm(a)?(r.push(new fo(o,bM(a))),i+=2):(r.push(new fo(o,{})),i++)}return new Oe(r,{})}function RG(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=PI(new Oe([],{}),0,r))}),e}function bM(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function CM(n,e,t){return n==t.path&&Ur(e,t.parameters)}var Ml="imperative",kt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(kt||{}),Wn=class{constructor(e,t){this.id=e,this.url=t}},nc=class extends Wn{constructor(e,t,r="imperative",i=null){super(e,t),this.type=kt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Br=class extends Wn{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=kt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Pn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Pn||{}),am=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(am||{}),rs=class extends Wn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=kt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},is=class extends Wn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=kt.NavigationSkipped}},Fl=class extends Wn{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=kt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},cm=class extends Wn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=kt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},MI=class extends Wn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=kt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},kI=class extends Wn{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=kt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},OI=class extends Wn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=kt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},LI=class extends Wn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=kt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},FI=class{constructor(e){this.route=e,this.type=kt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},VI=class{constructor(e){this.route=e,this.type=kt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},UI=class{constructor(e){this.snapshot=e,this.type=kt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},BI=class{constructor(e){this.snapshot=e,this.type=kt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jI=class{constructor(e){this.snapshot=e,this.type=kt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$I=class{constructor(e){this.snapshot=e,this.type=kt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},um=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=kt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Vl=class{},Ul=class{constructor(e){this.url=e}};var HI=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new zl,this.attachRef=null}},zl=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new HI,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),lm=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=qI(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=qI(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=zI(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return zI(e,this._root).map(t=>t.value)}};function qI(n,e){if(n===e.value)return e;for(let t of e.children){let r=qI(n,t);if(r)return r}return null}function zI(n,e){if(n===e.value)return[e];for(let t of e.children){let r=zI(n,t);if(r.length)return r.unshift(e),r}return[]}var Nn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Ja(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var dm=class extends lm{constructor(e,t){super(e),this.snapshot=t,tE(this,e)}toString(){return this.snapshot.toString()}};function qM(n){let e=xG(n),t=new Ye([new fo("",{})]),r=new Ye({}),i=new Ye({}),s=new Ye({}),o=new Ye(""),a=new Di(t,r,s,o,i,me,n,e.root);return a.snapshot=e.root,new dm(new Nn(a,[]),e)}function xG(n){let e={},t={},r={},i="",s=new Bl([],e,r,i,t,me,n,null,{});return new hm("",new Nn(s,[]))}var Di=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(De(u=>u[Hl]))??oe(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(De(e=>ec(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(De(e=>ec(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function eE(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:K(K({},e.params),n.params),data:K(K({},e.data),n.data),resolve:K(K(K(K({},n.data),e.data),i?.data),n._resolvedData)}:r={params:K({},n.params),data:K({},n.data),resolve:K(K({},n.data),n._resolvedData??{})},i&&GM(i)&&(r.resolve[Hl]=i.title),r}var Bl=class{get title(){return this.data?.[Hl]}constructor(e,t,r,i,s,o,a,c,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ec(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ec(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},hm=class extends lm{constructor(e,t){super(t),this.url=e,tE(this,t)}toString(){return zM(this._root)}};function tE(n,e){e.value._routerState=n,e.children.forEach(t=>tE(n,t))}function zM(n){let e=n.children.length>0?` { ${n.children.map(zM).join(", ")} } `:"";return`${n.value}${e}`}function DI(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Ur(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Ur(e.params,t.params)||n.paramsSubject.next(t.params),sG(e.url,t.url)||n.urlSubject.next(t.url),Ur(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function GI(n,e){let t=Ur(n.params,e.params)&&uG(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||GI(n.parent,e.parent))}function GM(n){return typeof n.title=="string"||n.title===null}var nE=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=me,this.activateEvents=new on,this.deactivateEvents=new on,this.attachEvents=new on,this.detachEvents=new on,this.parentContexts=W(zl),this.location=W(qa),this.changeDetector=W(Ka),this.environmentInjector=W(Tn),this.inputBinder=W(_m,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new te(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new te(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new te(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new te(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new WI(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:u,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=ja({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Il]});let n=e;return n})(),WI=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Di?this.route:e===zl?this.childContexts:this.parent.get(e,t)}},_m=new le(""),DM=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=il([i.queryParams,i.params,i.data]).pipe($n(([o,a,c],u)=>(c=K(K(K({},o),a),c),u===0?oe(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=XP(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function NG(n,e,t){let r=jl(n,e._root,t?t._root:void 0);return new dm(r,e)}function jl(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=PG(n,e,t);return new Nn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>jl(n,a)),o}}let r=MG(e.value),i=e.children.map(s=>jl(n,s));return new Nn(r,i)}}function PG(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return jl(n,r,i);return jl(n,r)})}function MG(n){return new Di(new Ye(n.url),new Ye(n.params),new Ye(n.queryParams),new Ye(n.fragment),new Ye(n.data),n.outlet,n.component,n)}var WM="ngNavigationCancelingError";function KM(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=tc(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=QM(!1,Pn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function QM(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[WM]=!0,t.cancellationCode=e,t}function kG(n){return YM(n)&&tc(n.url)}function YM(n){return!!n&&n[WM]}var OG=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=yt({type:e,selectors:[["ng-component"]],standalone:!0,features:[HP],decls:1,vars:0,template:function(i,s){i&1&&ce(0,"router-outlet")},dependencies:[nE],encapsulation:2});let n=e;return n})();function LG(n,e){return n.providers&&!n._injector&&(n._injector=Mp(n.providers,e,`Route: ${n.path}`)),n._injector??e}function rE(n){let e=n.children&&n.children.map(rE),t=e?ot(K({},n),{children:e}):K({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==me&&(t.component=OG),t}function jr(n){return n.outlet||me}function FG(n,e){let t=n.filter(r=>jr(r)===e);return t.push(...n.filter(r=>jr(r)!==e)),t}function Gl(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var VG=(n,e,t,r)=>De(i=>(new KI(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),KI=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),DI(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Ja(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ja(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ja(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Ja(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new $I(s.value.snapshot))}),e.children.length&&this.forwardEvent(new BI(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(DI(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),DI(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Gl(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},fm=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Za=class{constructor(e,t){this.component=e,this.route=t}};function UG(n,e,t){let r=n._root,i=e?e._root:null;return xl(r,i,t,[r.value])}function BG(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function ic(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!Yx(n)?n:e.get(n):r}function xl(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Ja(e);return n.children.forEach(o=>{jG(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>kl(a,t.getContext(o),i)),i}function jG(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=$G(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new fm(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?xl(n,e,a?a.children:null,r,i):xl(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Za(a.outlet.component,o))}else o&&kl(e,a,i),i.canActivateChecks.push(new fm(r)),s.component?xl(n,null,a?a.children:null,r,i):xl(n,null,t,r,i);return i}function $G(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!po(n.url,e.url);case"pathParamsOrQueryParamsChange":return!po(n.url,e.url)||!Ur(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!GI(n,e)||!Ur(n.queryParams,e.queryParams);case"paramsChange":default:return!GI(n,e)}}function kl(n,e,t){let r=Ja(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?kl(o,e.children.getContext(s),t):kl(o,null,t):kl(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Za(e.outlet.component,i)):t.canDeactivateChecks.push(new Za(null,i)):t.canDeactivateChecks.push(new Za(null,i))}function Wl(n){return typeof n=="function"}function HG(n){return typeof n=="boolean"}function qG(n){return n&&Wl(n.canLoad)}function zG(n){return n&&Wl(n.canActivate)}function GG(n){return n&&Wl(n.canActivateChild)}function WG(n){return n&&Wl(n.canDeactivate)}function KG(n){return n&&Wl(n.canMatch)}function JM(n){return n instanceof gi||n?.name==="EmptyError"}var tm=Symbol("INITIAL_VALUE");function rc(){return $n(n=>il(n.map(e=>e.pipe(_i(1),gv(tm)))).pipe(De(e=>{for(let t of e)if(t!==!0){if(t===tm)return tm;if(t===!1||t instanceof ns)return t}return!0}),jn(e=>e!==tm),_i(1)))}function QG(n,e){return _t(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?oe(ot(K({},t),{guardsResult:!0})):YG(o,r,i,n).pipe(_t(a=>a&&HG(a)?JG(r,s,n,e):oe(a)),De(a=>ot(K({},t),{guardsResult:a})))})}function YG(n,e,t,r){return ht(n).pipe(_t(i=>nW(i.component,i.route,t,e,r)),Sr(i=>i!==!0,!0))}function JG(n,e,t,r){return ht(e).pipe(eo(i=>Ra(ZG(i.route.parent,r),XG(i.route,r),tW(n,i.path,t),eW(n,i.route,t))),Sr(i=>i!==!0,!0))}function XG(n,e){return n!==null&&e&&e(new jI(n)),oe(!0)}function ZG(n,e){return n!==null&&e&&e(new UI(n)),oe(!0)}function eW(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return oe(!0);let i=r.map(s=>Of(()=>{let o=Gl(e)??t,a=ic(s,o),c=zG(a)?a.canActivate(e,n):yi(o,()=>a(e,n));return ss(c).pipe(Sr())}));return oe(i).pipe(rc())}function tW(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>BG(o)).filter(o=>o!==null).map(o=>Of(()=>{let a=o.guards.map(c=>{let u=Gl(o.node)??t,d=ic(c,u),h=GG(d)?d.canActivateChild(r,n):yi(u,()=>d(r,n));return ss(h).pipe(Sr())});return oe(a).pipe(rc())}));return oe(s).pipe(rc())}function nW(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return oe(!0);let o=s.map(a=>{let c=Gl(e)??i,u=ic(a,c),d=WG(u)?u.canDeactivate(n,e,t,r):yi(c,()=>u(n,e,t,r));return ss(d).pipe(Sr())});return oe(o).pipe(rc())}function rW(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return oe(!0);let s=i.map(o=>{let a=ic(o,n),c=qG(a)?a.canLoad(e,t):yi(n,()=>a(e,t));return ss(c)});return oe(s).pipe(rc(),XM(r))}function XM(n){return cv(jt(e=>{if(tc(e))throw KM(n,e)}),De(e=>e===!0))}function iW(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return oe(!0);let s=i.map(o=>{let a=ic(o,n),c=KG(a)?a.canMatch(e,t):yi(n,()=>a(e,t));return ss(c)});return oe(s).pipe(rc(),XM(r))}var $l=class{constructor(e){this.segmentGroup=e||null}},pm=class extends Error{constructor(e){super(),this.urlTree=e}};function Ya(n){return Sa(new $l(n))}function sW(n){return Sa(new te(4e3,!1))}function oW(n){return Sa(QM(!1,Pn.GuardRejected))}var QI=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return oe(r);if(i.numberOfChildren>1||!i.children[me])return sW(e.redirectTo);i=i.children[me]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new pm(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new ns(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Oe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new te(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},YI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function aW(n,e,t,r,i){let s=iE(n,e,t);return s.matched?(r=LG(e,r),iW(r,e,t,i).pipe(De(o=>o===!0?s:K({},YI)))):oe(s)}function iE(n,e,t){if(e.path==="**")return cW(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?K({},YI):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||iG)(t,n,e);if(!i)return K({},YI);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?K(K({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function cW(n){return{matched:!0,parameters:n.length>0?NM(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function SM(n,e,t,r){return t.length>0&&dW(n,t,r)?{segmentGroup:new Oe(e,lW(r,new Oe(t,n.children))),slicedSegments:[]}:t.length===0&&hW(n,t,r)?{segmentGroup:new Oe(n.segments,uW(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Oe(n.segments,n.children),slicedSegments:t}}function uW(n,e,t,r){let i={};for(let s of t)if(ym(n,e,s)&&!r[jr(s)]){let o=new Oe([],{});i[jr(s)]=o}return K(K({},r),i)}function lW(n,e){let t={};t[me]=e;for(let r of n)if(r.path===""&&jr(r)!==me){let i=new Oe([],{});t[jr(r)]=i}return t}function dW(n,e,t){return t.some(r=>ym(n,e,r)&&jr(r)!==me)}function hW(n,e,t){return t.some(r=>ym(n,e,r))}function ym(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function fW(n,e,t,r){return jr(n)!==r&&(r===me||!ym(e,t,n))?!1:iE(e,n,t).matched}function pW(n,e,t){return e.length===0&&!n.children[t]}var JI=class{};function mW(n,e,t,r,i,s,o="emptyOnly"){return new XI(n,e,t,r,i,o,s).recognize()}var gW=31,XI=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new QI(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new te(4002,`'${e.segmentGroup}'`)}recognize(){let e=SM(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(De(t=>{let r=new Bl([],Object.freeze({}),Object.freeze(K({},this.urlTree.queryParams)),this.urlTree.fragment,{},me,this.rootComponentType,null,{}),i=new Nn(r,t),s=new hm("",i),o=TG(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,me).pipe(Ki(r=>{if(r instanceof pm)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof $l?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=eE(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(De(s=>s instanceof Nn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ht(i).pipe(eo(s=>{let o=r.children[s],a=FG(t,s);return this.processSegmentGroup(e,a,o,s)}),mv((s,o)=>(s.push(...o),s)),Qi(null),pv(),_t(s=>{if(s===null)return Ya(r);let o=ZM(s);return _W(o),oe(o)}))}processSegment(e,t,r,i,s,o){return ht(t).pipe(eo(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(Ki(c=>{if(c instanceof $l)return oe(null);throw c}))),Sr(a=>!!a),Ki(a=>{if(JM(a))return pW(r,i,s)?oe(new JI):Ya(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return fW(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):Ya(i):Ya(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:u,remainingSegments:d}=iE(t,i,s);if(!a)return Ya(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>gW&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,u);return this.applyRedirects.lineralizeSegments(i,h).pipe(_t(p=>this.processSegment(e,r,t,p.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=aW(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe($n(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe($n(({routes:c})=>{let u=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:p}=a,_=new Bl(d,p,Object.freeze(K({},this.urlTree.queryParams)),this.urlTree.fragment,vW(r),jr(r),r.component??r._loadedComponent??null,r,wW(r)),{segmentGroup:w,slicedSegments:C}=SM(t,d,h,c);if(C.length===0&&w.hasChildren())return this.processChildren(u,c,w).pipe(De(F=>F===null?null:new Nn(_,F)));if(c.length===0&&C.length===0)return oe(new Nn(_,[]));let A=jr(r)===s;return this.processSegment(u,c,w,C,A?me:s,!0).pipe(De(F=>new Nn(_,F instanceof Nn?[F]:[])))}))):Ya(t)))}getChildConfig(e,t,r){return t.children?oe({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?oe({routes:t._loadedRoutes,injector:t._loadedInjector}):rW(e,t,r,this.urlSerializer).pipe(_t(i=>i?this.configLoader.loadChildren(e,t).pipe(jt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):oW(t))):oe({routes:[],injector:e})}};function _W(n){n.sort((e,t)=>e.value.outlet===me?-1:t.value.outlet===me?1:e.value.outlet.localeCompare(t.value.outlet))}function yW(n){let e=n.value.routeConfig;return e&&e.path===""}function ZM(n){let e=[],t=new Set;for(let r of n){if(!yW(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=ZM(r.children);e.push(new Nn(r.value,i))}return e.filter(r=>!t.has(r))}function vW(n){return n.data||{}}function wW(n){return n.resolve||{}}function IW(n,e,t,r,i,s){return _t(o=>mW(n,e,t,r,o.extractedUrl,i,s).pipe(De(({state:a,tree:c})=>ot(K({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function EW(n,e){return _t(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return oe(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of ek(c))o.add(u);let a=0;return ht(o).pipe(eo(c=>s.has(c)?TW(c,r,n,e):(c.data=eE(c,c.parent,n).resolve,oe(void 0))),jt(()=>a++),xa(1),_t(c=>a===o.size?oe(t):xn))})}function ek(n){let e=n.children.map(t=>ek(t)).flat();return[n,...e]}function TW(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!GM(i)&&(s[Hl]=i.title),bW(s,n,e,r).pipe(De(o=>(n._resolvedData=o,n.data=eE(n,n.parent,t).resolve,null)))}function bW(n,e,t,r){let i=RI(n);if(i.length===0)return oe({});let s={};return ht(i).pipe(_t(o=>CW(n[o],e,t,r).pipe(Sr(),jt(a=>{s[o]=a}))),xa(1),fv(s),Ki(o=>JM(o)?xn:Sa(o)))}function CW(n,e,t,r){let i=Gl(e)??r,s=ic(n,i),o=s.resolve?s.resolve(e,t):yi(i,()=>s(e,t));return ss(o)}function SI(n){return $n(e=>{let t=n(e);return t?ht(t).pipe(De(()=>e)):oe(e)})}var tk=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===me);return i}getResolvedTitleForRoute(r){return r.data[Hl]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(DW),providedIn:"root"});let n=e;return n})(),DW=(()=>{let e=class e extends tk{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(re(wM))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Kl=new le("",{providedIn:"root",factory:()=>({})}),mm=new le(""),sE=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=W(qp)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return oe(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=ss(r.loadComponent()).pipe(De(nk),jt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),sl(()=>{this.componentLoaders.delete(r)})),s=new Da(i,()=>new Qt).pipe(Ca());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return oe({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=SW(i,this.compiler,r,this.onLoadEndListener).pipe(sl(()=>{this.childrenLoaders.delete(i)})),a=new Da(o,()=>new Qt).pipe(Ca());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function SW(n,e,t,r){return ss(n.loadChildren()).pipe(De(nk),_t(i=>i instanceof yl||Array.isArray(i)?oe(i):ht(e.compileModuleAsync(i))),De(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(mm,[],{optional:!0,self:!0}).flat()),{routes:o.map(rE),injector:s}}))}function AW(n){return n&&typeof n=="object"&&"default"in n}function nk(n){return AW(n)?n.default:n}var oE=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(RW),providedIn:"root"});let n=e;return n})(),RW=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),rk=new le(""),ik=new le("");function xW(n,e,t){let r=n.get(ik),i=n.get(bn);return n.get(qe).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(u=>setTimeout(u));let s,o=new Promise(u=>{s=u}),a=i.startViewTransition(()=>(s(),NW(n))),{onViewTransitionCreated:c}=r;return c&&yi(n,()=>c({transition:a,from:e,to:t})),o})}function NW(n){return new Promise(e=>{Pp(e,{injector:n})})}var aE=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Qt,this.transitionAbortSubject=new Qt,this.configLoader=W(sE),this.environmentInjector=W(Tn),this.urlSerializer=W(ql),this.rootContexts=W(zl),this.location=W(Qa),this.inputBindingEnabled=W(_m,{optional:!0})!==null,this.titleStrategy=W(tk),this.options=W(Kl,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=W(oE),this.createViewTransition=W(rk,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>oe(void 0),this.rootComponentType=null;let r=s=>this.events.next(new FI(s)),i=s=>this.events.next(new VI(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ot(K(K({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Ye({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ml,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(jn(o=>o.id!==0),De(o=>ot(K({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),$n(o=>{let a=!1,c=!1;return oe(o).pipe($n(u=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Pn.SupersededByNewNavigation),xn;this.currentTransition=o,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?ot(K({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=u.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&h!=="reload"){let p="";return this.events.next(new is(u.id,this.urlSerializer.serialize(u.rawUrl),p,am.IgnoredSameUrlNavigation)),u.resolve(null),xn}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return oe(u).pipe($n(p=>{let _=this.transitions?.getValue();return this.events.next(new nc(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),_!==this.transitions?.getValue()?xn:Promise.resolve(p)}),IW(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),jt(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=ot(K({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let _=new cm(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(_)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:p,extractedUrl:_,source:w,restoredState:C,extras:A}=u,F=new nc(p,this.urlSerializer.serialize(_),w,C);this.events.next(F);let G=qM(this.rootComponentType).snapshot;return this.currentTransition=o=ot(K({},u),{targetSnapshot:G,urlAfterRedirects:_,extras:ot(K({},A),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=_,oe(o)}else{let p="";return this.events.next(new is(u.id,this.urlSerializer.serialize(u.extractedUrl),p,am.IgnoredByUrlHandlingStrategy)),u.resolve(null),xn}}),jt(u=>{let d=new MI(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),De(u=>(this.currentTransition=o=ot(K({},u),{guards:UG(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),QG(this.environmentInjector,u=>this.events.next(u)),jt(u=>{if(o.guardsResult=u.guardsResult,tc(u.guardsResult))throw KM(this.urlSerializer,u.guardsResult);let d=new kI(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(d)}),jn(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",Pn.GuardRejected),!1)),SI(u=>{if(u.guards.canActivateChecks.length)return oe(u).pipe(jt(d=>{let h=new OI(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),$n(d=>{let h=!1;return oe(d).pipe(EW(this.paramsInheritanceStrategy,this.environmentInjector),jt({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",Pn.NoDataFromResolver)}}))}),jt(d=>{let h=new LI(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),SI(u=>{let d=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(jt(_=>{h.component=_}),De(()=>{})));for(let _ of h.children)p.push(...d(_));return p};return il(d(u.targetSnapshot.root)).pipe(Qi(null),_i(1))}),SI(()=>this.afterPreactivation()),$n(()=>{let{currentSnapshot:u,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,u.root,d.root);return h?ht(h).pipe(De(()=>o)):oe(o)}),De(u=>{let d=NG(r.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=ot(K({},u),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),jt(()=>{this.events.next(new Vl)}),VG(this.rootContexts,r.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),_i(1),jt({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Br(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),_v(this.transitionAbortSubject.pipe(jt(u=>{throw u}))),sl(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Pn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Ki(u=>{if(c=!0,YM(u))this.events.next(new rs(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),kG(u)?this.events.next(new Ul(u.url)):o.resolve(!1);else{this.events.next(new Fl(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(u))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return xn}))}))}cancelNavigationTransition(r,i,s){let o=new rs(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function PW(n){return n!==Ml}var MW=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(kW),providedIn:"root"});let n=e;return n})(),ZI=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},kW=(()=>{let e=class e extends ZI{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Nw(e)))(s||e)}})(),e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),sk=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(OW),providedIn:"root"});let n=e;return n})(),OW=(()=>{let e=class e extends sk{constructor(){super(...arguments),this.location=W(Qa),this.urlSerializer=W(ql),this.options=W(Kl,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=W(oE),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ns,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=qM(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof nc)this.stateMemento=this.createStateMemento();else if(r instanceof is)this.rawUrlTree=i.initialUrl;else if(r instanceof cm){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Vl?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof rs&&(r.code===Pn.GuardRejected||r.code===Pn.NoDataFromResolver)?this.restoreHistory(i):r instanceof Fl?this.restoreHistory(i,!0):r instanceof Br&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=K(K({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=K(K({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Nw(e)))(s||e)}})(),e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Nl=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Nl||{});function ok(n,e){n.events.pipe(jn(t=>t instanceof Br||t instanceof rs||t instanceof Fl||t instanceof is),De(t=>t instanceof Br||t instanceof is?Nl.COMPLETE:(t instanceof rs?t.code===Pn.Redirect||t.code===Pn.SupersededByNewNavigation:!1)?Nl.REDIRECTING:Nl.FAILED),jn(t=>t!==Nl.REDIRECTING),_i(1)).subscribe(()=>{e()})}function LW(n){throw n}var FW={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},VW={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},vt=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=W(Bp),this.stateManager=W(sk),this.options=W(Kl,{optional:!0})||{},this.pendingTasks=W(kp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=W(aE),this.urlSerializer=W(ql),this.location=W(Qa),this.urlHandlingStrategy=W(oE),this._events=new Qt,this.errorHandler=this.options.errorHandler||LW,this.navigated=!1,this.routeReuseStrategy=W(MW),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=W(mm,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!W(_m,{optional:!0}),this.eventsSubscription=new Rt,this.isNgZoneEnabled=W(qe)instanceof qe&&qe.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof rs&&i.code!==Pn.Redirect&&i.code!==Pn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Br)this.navigated=!0;else if(i instanceof Ul){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||PW(s.source)};this.scheduleNavigation(a,Ml,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}BW(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Ml,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let u=K({},s);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(rE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:u}=i,d=u?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=K(K({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let _=s?s.snapshot:this.routerState.snapshot.root;p=BM(_)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),p=this.currentUrlTree.root}return jM(p,r,h,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=tc(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Ml,null,i)}navigate(r,i={skipLocationChange:!1}){return UW(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=K({},FW):i===!1?s=K({},VW):s=i,tc(r))return EM(this.currentUrlTree,r,s);let o=this.parseUrl(r);return EM(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,u,d;a?(c=a.resolve,u=a.reject,d=a.promise):d=new Promise((p,_)=>{c=p,u=_});let h=this.pendingTasks.add();return ok(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:u,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function UW(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new te(4008,!1)}function BW(n){return!(n instanceof Vl)&&!(n instanceof Ul)}var vm=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Qt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let u=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof Br&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,u),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:aP(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(Se(vt),Se(Di),Pw("tabindex"),Se(Np),Se(Tl),Se(mr))},e.\u0275dir=ja({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&fe("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&Yw("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[ur.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Cl],skipLocationChange:[ur.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Cl],replaceUrl:[ur.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Cl],routerLink:"routerLink"},standalone:!0,features:[Qw,Il]});let n=e;return n})();var gm=class{};var jW=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(jn(r=>r instanceof Br),eo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Mp(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return ht(s).pipe(Aa())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=oe(null);let o=s.pipe(_t(a=>a===null?oe(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return ht([o,a]).pipe(Aa())}else return o})}};e.\u0275fac=function(i){return new(i||e)(re(vt),re(qp),re(Tn),re(gm),re(sE))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),ak=new le(""),$W=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=W(Tn),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof nc?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof Br?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof is&&r.code===am.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof um&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>g(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),Pp(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new um(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){vP()},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function HW(n){return n.routerState.root}function Ql(n,e){return{\u0275kind:n,\u0275providers:e}}function qW(){let n=W(Fr);return e=>{let t=n.get(Wa);if(e!==t.components[0])return;let r=n.get(vt),i=n.get(ck);n.get(cE)===1&&r.initialNavigation(),n.get(uk,null,ve.Optional)?.setUpPreloading(),n.get(ak,null,ve.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var ck=new le("",{factory:()=>new Qt}),cE=new le("",{providedIn:"root",factory:()=>1});function zW(){return Ql(2,[{provide:cE,useValue:0},{provide:Hp,multi:!0,deps:[Fr],useFactory:e=>{let t=e.get(oM,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(vt),s=e.get(ck);ok(i,()=>{r(!0)}),e.get(aE).afterPreactivation=()=>(r(!0),s.closed?oe(void 0):s),i.initialNavigation()}))}}])}function GW(){return Ql(3,[{provide:Hp,multi:!0,useFactory:()=>{let e=W(vt);return()=>{e.setUpLocationChangeListener()}}},{provide:cE,useValue:2}])}var uk=new le("");function WW(n){return Ql(0,[{provide:uk,useExisting:jW},{provide:gm,useExisting:n}])}function KW(){return Ql(8,[DM,{provide:_m,useExisting:DM}])}function QW(n){let e=[{provide:rk,useValue:xW},{provide:ik,useValue:K({skipNextTransition:!!n?.skipInitialTransition},n)}];return Ql(9,e)}var AM=new le("ROUTER_FORROOT_GUARD"),YW=[Qa,{provide:ql,useClass:Ol},vt,zl,{provide:Di,useFactory:HW,deps:[vt]},sE,[]],uE=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[YW,[],{provide:mm,multi:!0,useValue:r},{provide:AM,useFactory:e3,deps:[[vt,new gp,new hw]]},{provide:Kl,useValue:i||{}},i?.useHash?XW():ZW(),JW(),i?.preloadingStrategy?WW(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?t3(i):[],i?.bindToComponentInputs?KW().\u0275providers:[],i?.enableViewTransitions?QW().\u0275providers:[],n3()]}}static forChild(r){return{ngModule:e,providers:[{provide:mm,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(re(AM,8))},e.\u0275mod=fr({type:e}),e.\u0275inj=hr({});let n=e;return n})();function JW(){return{provide:ak,useFactory:()=>{let n=W(lM),e=W(qe),t=W(Kl),r=W(aE),i=W(ql);return t.scrollOffset&&n.setOffset(t.scrollOffset),new $W(i,r,n,e,t)}}}function XW(){return{provide:mr,useClass:Wp}}function ZW(){return{provide:mr,useClass:fI}}function e3(n){return"guarded"}function t3(n){return[n.initialNavigation==="disabled"?GW().\u0275providers:[],n.initialNavigation==="enabledBlocking"?zW().\u0275providers:[]]}var RM=new le("");function n3(){return[{provide:RM,useFactory:qW},{provide:eI,multi:!0,useExisting:RM}]}var dE={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var B=function(n,e){if(!n)throw mo(e)},mo=function(n){return new Error("Firebase Database ("+dE.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var dk=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},r3=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Im={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,u=c?n[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4,p=(a&15)<<2|u>>6,_=u&63;c||(_=64,o||(p=64)),r.push(t[d],t[h],t[p],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(dk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):r3(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let u=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||u==null||h==null)throw new hE;let p=s<<2|a>>4;if(r.push(p),u!==64){let _=a<<4&240|u>>2;if(r.push(_),h!==64){let w=u<<6&192|h;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},hE=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},pE=function(n){let e=dk(n);return Im.encodeByteArray(e,!0)},Yl=function(n){return pE(n).replace(/\./g,"")},Jl=function(n){try{return Im.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function hk(n){return ac(void 0,n)}function ac(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!i3(t)||(n[t]=ac(n[t],e[t]));return n}function i3(n){return n!=="__proto__"}function s3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var o3=()=>s3().__FIREBASE_DEFAULTS__,a3=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},c3=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Jl(n[1]);return e&&JSON.parse(e)},mE=()=>{try{return o3()||a3()||c3()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var gE=()=>{var n;return(n=mE())===null||n===void 0?void 0:n.config},fk=n=>{var e;return(e=mE())===null||e===void 0?void 0:e[`_${n}`]};var xt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function cc(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Yl(JSON.stringify(t)),Yl(JSON.stringify(o)),""].join(".")}function je(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Xl(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(je())}function Em(){var n;let e=(n=mE())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Tm(){return typeof self=="object"&&self.self===self}function bm(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function go(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Cm(){let n=je();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function $r(){return dE.NODE_CLIENT===!0||dE.NODE_ADMIN===!0}function _E(){return!Em()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function os(){try{return typeof indexedDB=="object"}catch{return!1}}function pk(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var u3="FirebaseError",at=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=u3,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Kn.prototype.create)}},Kn=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?l3(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new at(i,a,r)}};function l3(n,e){return n.replace(d3,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var d3=/\{\$([^}]+)}/g;function oc(n){return JSON.parse(n)}function wt(n){return JSON.stringify(n)}var mk=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=oc(Jl(s[0])||""),t=oc(Jl(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var gk=function(n){let e=mk(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},_k=function(n){let e=mk(n).claims;return typeof e=="object"&&e.admin===!0};function ln(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function as(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function uc(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Zl(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function cs(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(lk(s)&&lk(o)){if(!cs(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function lk(n){return n!==null&&typeof n=="object"}function Si(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function us(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function lc(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var wm=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){let p=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(p<<1|p>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],u,d;for(let h=0;h<80;h++){h<40?h<20?(u=a^s&(o^a),d=1518500249):(u=s^o^a,d=1859775393):h<60?(u=s&o|a&(s|o),d=2400959708):(u=s^o^a,d=3395469782);let p=(i<<5|i>>>27)+u+c+d+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=p}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function Dm(n,e){let t=new fE(n,e);return t.subscribe.bind(t)}var fE=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");h3(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=lE),i.error===void 0&&(i.error=lE),i.complete===void 0&&(i.complete=lE);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function h3(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function lE(){}var ie=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){let s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function Jt(n,e){return`${n} failed: ${e} argument `}function Nt(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(Jt(n,e)+"must be a valid function.")}function yE(n,e,t,r){if(!(r&&!t)&&(typeof t!="object"||t===null))throw new Error(Jt(n,e)+"must be a valid context object.")}var yk=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,B(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},ed=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var Ase=4*60*60*1e3;function H(n){return n&&n._delegate?n._delegate:n}var Ve=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var _o="[DEFAULT]";var yo=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new xt;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(p3(e))try{this.getOrInitializeService({instanceIdentifier:_o})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=_o){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=_o){return this.instances.has(e)}getOptions(e=_o){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:f3(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=_o){return this.component?this.component.multipleInstances?e:_o:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function f3(n){return n===_o?void 0:n}function p3(n){return n.instantiationMode==="EAGER"}var ls=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new yo(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var kE={};fj(kE,{FirebaseError:()=>at,SDK_VERSION:()=>hn,_DEFAULT_ENTRY_NAME:()=>qr,_addComponent:()=>fc,_addOrOverwriteComponent:()=>NE,_apps:()=>ds,_clearComponents:()=>t9,_components:()=>hc,_getProvider:()=>pc,_isFirebaseApp:()=>Mk,_isFirebaseServerApp:()=>tt,_registerComponent:()=>dn,_removeServiceInstance:()=>Pk,_serverApps:()=>dc,deleteApp:()=>Nm,getApp:()=>nd,getApps:()=>i9,initializeApp:()=>xm,initializeServerApp:()=>r9,onLog:()=>PE,registerVersion:()=>ft,setLogLevel:()=>ME});var vE=[],ge=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(ge||{}),vk={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},m3=ge.INFO,g3={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},_3=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=g3[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Cn=class{constructor(e){this.name=e,this._logLevel=m3,this._logHandler=_3,this._userLogHandler=null,vE.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}};function wk(n){vE.forEach(e=>{e.setLogLevel(n)})}function Ik(n,e){for(let t of vE){let r=null;e&&e.level&&(r=vk[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:ge[s].toLowerCase(),message:a,args:o,type:i.name})}}}var y3=(n,e)=>e.some(t=>n instanceof t),Ek,Tk;function v3(){return Ek||(Ek=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function w3(){return Tk||(Tk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var bk=new WeakMap,IE=new WeakMap,Ck=new WeakMap,wE=new WeakMap,TE=new WeakMap;function I3(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Hr(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&bk.set(t,n)}).catch(()=>{}),TE.set(e,n),e}function E3(n){if(IE.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});IE.set(n,e)}var EE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return IE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ck.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Hr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Dk(n){EE=n(EE)}function T3(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Sm(this),e,...t);return Ck.set(r,e.sort?e.sort():[e]),Hr(r)}:w3().includes(n)?function(...e){return n.apply(Sm(this),e),Hr(bk.get(this))}:function(...e){return Hr(n.apply(Sm(this),e))}}function b3(n){return typeof n=="function"?T3(n):(n instanceof IDBTransaction&&E3(n),y3(n,v3())?new Proxy(n,EE):n)}function Hr(n){if(n instanceof IDBRequest)return I3(n);if(wE.has(n))return wE.get(n);let e=b3(n);return e!==n&&(wE.set(n,e),TE.set(e,n)),e}var Sm=n=>TE.get(n);function Ak(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=Hr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Hr(o.result),c.oldVersion,c.newVersion,Hr(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}var C3=["get","getKey","getAll","getAllKeys","count"],D3=["put","add","delete","clear"],bE=new Map;function Sk(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(bE.get(e))return bE.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=D3.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||C3.includes(t)))return;let s=function(o,...a){return g(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),u=c.store;return r&&(u=u.index(a.shift())),(yield Promise.all([u[t](...a),i&&c.done]))[0]})};return bE.set(e,s),s}Dk(n=>ot(K({},n),{get:(e,t,r)=>Sk(e,t)||n.get(e,t,r),has:(e,t)=>!!Sk(e,t)||n.has(e,t)}));var DE=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(S3(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function S3(n){let e=n.getComponent();return e?.type==="VERSION"}var Am="@firebase/app",SE="0.10.5";var vo=new Cn("@firebase/app"),A3="@firebase/app-compat",R3="@firebase/analytics-compat",x3="@firebase/analytics",N3="@firebase/app-check-compat",P3="@firebase/app-check",M3="@firebase/auth",k3="@firebase/auth-compat",O3="@firebase/database",L3="@firebase/database-compat",F3="@firebase/functions",V3="@firebase/functions-compat",U3="@firebase/installations",B3="@firebase/installations-compat",j3="@firebase/messaging",$3="@firebase/messaging-compat",H3="@firebase/performance",q3="@firebase/performance-compat",z3="@firebase/remote-config",G3="@firebase/remote-config-compat",W3="@firebase/storage",K3="@firebase/storage-compat",Q3="@firebase/firestore",Y3="@firebase/vertexai-preview",J3="@firebase/firestore-compat",X3="firebase",Z3="10.12.2";var qr="[DEFAULT]",e9={[Am]:"fire-core",[A3]:"fire-core-compat",[x3]:"fire-analytics",[R3]:"fire-analytics-compat",[P3]:"fire-app-check",[N3]:"fire-app-check-compat",[M3]:"fire-auth",[k3]:"fire-auth-compat",[O3]:"fire-rtdb",[L3]:"fire-rtdb-compat",[F3]:"fire-fn",[V3]:"fire-fn-compat",[U3]:"fire-iid",[B3]:"fire-iid-compat",[j3]:"fire-fcm",[$3]:"fire-fcm-compat",[H3]:"fire-perf",[q3]:"fire-perf-compat",[z3]:"fire-rc",[G3]:"fire-rc-compat",[W3]:"fire-gcs",[K3]:"fire-gcs-compat",[Q3]:"fire-fst",[J3]:"fire-fst-compat",[Y3]:"fire-vertex","fire-js":"fire-js",[X3]:"fire-js-all"};var ds=new Map,dc=new Map,hc=new Map;function fc(n,e){try{n.container.addComponent(e)}catch(t){vo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function NE(n,e){n.container.addOrOverwriteComponent(e)}function dn(n){let e=n.name;if(hc.has(e))return vo.debug(`There were multiple attempts to register component ${e}.`),!1;hc.set(e,n);for(let t of ds.values())fc(t,n);for(let t of dc.values())fc(t,n);return!0}function pc(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Pk(n,e,t=qr){pc(n,e).clearInstance(t)}function Mk(n){return n.options!==void 0}function tt(n){return n.settings!==void 0}function t9(){hc.clear()}var n9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qn=new Kn("app","Firebase",n9);var Rm=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ve("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qn.create("app-deleted",{appName:this._name})}};var AE=class extends Rm{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,ft(Am,SE,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Nm(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Qn.create("server-app-deleted")}};var hn=Z3;function xm(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:qr,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Qn.create("bad-app-name",{appName:String(i)});if(t||(t=gE()),!t)throw Qn.create("no-options");let s=ds.get(i);if(s){if(cs(t,s.options)&&cs(r,s.config))return s;throw Qn.create("duplicate-app",{appName:i})}let o=new ls(i);for(let c of hc.values())o.addComponent(c);let a=new Rm(t,r,o);return ds.set(i,a),a}function r9(n,e){if(Tm())throw Qn.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;Mk(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=u=>[...u].reduce((d,h)=>Math.imul(31,d)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Qn.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=dc.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new ls(s);for(let u of hc.values())a.addComponent(u);let c=new AE(t,e,s,a);return dc.set(s,c),c}function nd(n=qr){let e=ds.get(n);if(!e&&n===qr&&gE())return xm();if(!e)throw Qn.create("no-app",{appName:n});return e}function i9(){return Array.from(ds.values())}function Nm(n){return g(this,null,function*(){let e=!1,t=n.name;ds.has(t)?(e=!0,ds.delete(t)):dc.has(t)&&n.decRefCount()<=0&&(dc.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function ft(n,e,t){var r;let i=(r=e9[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vo.warn(a.join(" "));return}dn(new Ve(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function PE(n,e){if(n!==null&&typeof n!="function")throw Qn.create("invalid-log-argument");Ik(n,e)}function ME(n){wk(n)}var s9="firebase-heartbeat-database",o9=1,td="firebase-heartbeat-store",CE=null;function kk(){return CE||(CE=Ak(s9,o9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(td)}catch(t){console.warn(t)}}}}).catch(n=>{throw Qn.create("idb-open",{originalErrorMessage:n.message})})),CE}function a9(n){return g(this,null,function*(){try{let t=(yield kk()).transaction(td),r=yield t.objectStore(td).get(Ok(n));return yield t.done,r}catch(e){if(e instanceof at)vo.warn(e.message);else{let t=Qn.create("idb-get",{originalErrorMessage:e?.message});vo.warn(t.message)}}})}function Rk(n,e){return g(this,null,function*(){try{let r=(yield kk()).transaction(td,"readwrite");yield r.objectStore(td).put(e,Ok(n)),yield r.done}catch(t){if(t instanceof at)vo.warn(t.message);else{let r=Qn.create("idb-set",{originalErrorMessage:t?.message});vo.warn(r.message)}}})}function Ok(n){return`${n.name}!${n.options.appId}`}var c9=1024,u9=30*24*60*60*1e3,RE=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new xE(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return g(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=xk();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=u9}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return g(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=xk(),{heartbeatsToSend:r,unsentEntries:i}=l9(this._heartbeatsCache.heartbeats),s=Yl(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function xk(){return new Date().toISOString().substring(0,10)}function l9(n,e=c9){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Nk(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Nk(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var xE=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return os()?pk().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield a9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Rk(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Rk(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Nk(n){return Yl(JSON.stringify({version:2,heartbeats:n})).length}function d9(n){dn(new Ve("platform-logger",e=>new DE(e),"PRIVATE")),dn(new Ve("heartbeat",e=>new RE(e),"PRIVATE")),ft(Am,SE,n),ft(Am,SE,"esm2017"),ft("fire-js","")}d9("");var OE=class{constructor(e,t){this._delegate=e,this.firebase=t,fc(e,new Ve("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Nm(this._delegate)))}_getService(e,t=qr){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=qr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){fc(this._delegate,e)}_addOrOverwriteComponent(e){NE(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var h9={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Lk=new Kn("app-compat","Firebase",h9);function f9(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:ft,setLogLevel:ME,onLog:PE,apps:null,SDK_VERSION:hn,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:kE}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(u){delete e[u]}function i(u){if(u=u||qr,!ln(e,u))throw Lk.create("no-app",{appName:u});return e[u]}i.App=n;function s(u,d={}){let h=xm(u,d);if(ln(e,h.name))return e[h.name];let p=new n(h,t);return e[h.name]=p,p}function o(){return Object.keys(e).map(u=>e[u])}function a(u){let d=u.name,h=d.replace("-compat","");if(dn(u)&&u.type==="PUBLIC"){let p=(_=i())=>{if(typeof _[h]!="function")throw Lk.create("invalid-app-argument",{appName:d});return _[h]()};u.serviceProps!==void 0&&ac(p,u.serviceProps),t[h]=p,n.prototype[h]=function(..._){return this._getService.bind(this,d).apply(this,u.multipleInstances?_:[])}}return u.type==="PUBLIC"?t[h]:null}function c(u,d){return d==="serverAuth"?null:d}return t}function Vk(){let n=f9(OE);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:Vk,extendNamespace:e,createSubscribe:Dm,ErrorFactory:Kn,deepExtend:ac});function e(t){ac(n,t)}return n}var p9=Vk();var Fk=new Cn("@firebase/app-compat"),m9="@firebase/app-compat",g9="0.2.35";function _9(n){ft(m9,g9,n)}if(Tm()&&self.firebase!==void 0){Fk.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);let n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&Fk.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var X=p9;_9();var Co={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var gs={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function y9(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function eO(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var hT=y9,tO=eO,nO=new Kn("auth","Firebase",eO());var Om=new Cn("@firebase/auth");function v9(n,...e){Om.logLevel<=ge.WARN&&Om.warn(`Auth (${hn}): ${n}`,...e)}function Mm(n,...e){Om.logLevel<=ge.ERROR&&Om.error(`Auth (${hn}): ${n}`,...e)}function Tt(n,...e){throw pT(n,...e)}function Et(n,...e){return pT(n,...e)}function fT(n,e,t){let r=Object.assign(Object.assign({},tO()),{[e]:t});return new Kn("auth","Firebase",r).create(e,{appName:n.name})}function Ot(n){return fT(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _c(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Tt(n,"argument-error"),fT(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function pT(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return nO.create(n,...e)}function V(n,e,...t){if(!n)throw pT(e,...t)}function zr(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Mm(e),new Error(e)}function Yn(n,e){n||zr(e)}function ad(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function mT(){return Uk()==="http:"||Uk()==="https:"}function Uk(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function w9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(mT()||bm()||"connection"in navigator)?navigator.onLine:!0}function I9(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var wo=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Yn(t>e,"Short delay should be less than long delay!"),this.isMobile=Xl()||go()}get(){return w9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function gT(n,e){Yn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var cd=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;zr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;zr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;zr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var E9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var T9=new wo(3e4,6e4);function ct(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function ut(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){return rO(n,i,()=>g(this,null,function*(){let u={},d={};r&&(e==="GET"?d=r:u={body:JSON.stringify(r)});let h=Si(Object.assign({key:n.config.apiKey},d)).slice(1),p=yield n._getAdditionalHeaders();return p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode),cd.fetch()(iO(n,n.config.apiHost,t,h),Object.assign({method:e,headers:p,referrerPolicy:"no-referrer"},u))}))})}function rO(n,e,t){return g(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},E9),e);try{let i=new BE(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw rd(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw rd(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw rd(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw rd(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw fT(n,d,u);Tt(n,d)}}catch(i){if(i instanceof at)throw i;Tt(n,"network-request-failed",{message:String(i)})}})}function xi(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){let u=yield ut(n,e,t,r,i);return"mfaPendingCredential"in u&&Tt(n,"multi-factor-auth-required",{_serverResponse:u}),u})}function iO(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?gT(n.config,i):`${n.config.apiScheme}://${i}`}function b9(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var BE=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Et(this.auth,"network-request-failed")),T9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function rd(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Et(n,e,r);return i.customData._tokenResponse=t,i}function Bk(n){return n!==void 0&&n.getResponse!==void 0}function jk(n){return n!==void 0&&n.enterprise!==void 0}var jE=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return b9(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function C9(n){return g(this,null,function*(){return(yield ut(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})}function D9(n,e){return g(this,null,function*(){return ut(n,"GET","/v2/recaptchaConfig",ct(n,e))})}function S9(n,e){return g(this,null,function*(){return ut(n,"POST","/v1/accounts:delete",e)})}function A9(n,e){return g(this,null,function*(){return ut(n,"POST","/v1/accounts:update",e)})}function sO(n,e){return g(this,null,function*(){return ut(n,"POST","/v1/accounts:lookup",e)})}function id(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function oO(n,e=!1){return g(this,null,function*(){let t=H(n),r=yield t.getIdToken(e),i=Gm(r);V(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:id(LE(i.auth_time)),issuedAtTime:id(LE(i.iat)),expirationTime:id(LE(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function LE(n){return Number(n)*1e3}function Gm(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Mm("JWT malformed, contained fewer than 3 sections"),null;try{let i=Jl(t);return i?JSON.parse(i):(Mm("Failed to decode base64 JWT payload"),null)}catch(i){return Mm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function $k(n){let e=Gm(n);return V(e,"internal-error"),V(typeof e.exp<"u","internal-error"),V(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Ri(n,e,t=!1){return g(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof at&&R9(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function R9({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var $E=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var ud=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=id(this.lastLoginAt),this.creationTime=id(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function ld(n){return g(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Ri(n,sO(t,{idToken:r}));V(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?cO(s.providerUserInfo):[],a=x9(n.providerData,o),c=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!a?.length,d=c?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ud(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,h)})}function aO(n){return g(this,null,function*(){let e=H(n);yield ld(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function x9(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function cO(n){return n.map(e=>{var{providerId:t}=e,r=Ef(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function N9(n,e){return g(this,null,function*(){let t=yield rO(n,{},()=>g(this,null,function*(){let r=Si({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=iO(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",cd.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function P9(n,e){return g(this,null,function*(){return ut(n,"POST","/v2/accounts:revokeToken",ct(n,e))})}var sd=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){V(e.idToken,"internal-error"),V(typeof e.idToken<"u","internal-error"),V(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$k(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){V(e.length!==0,"internal-error");let t=$k(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return g(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(V(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield N9(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(V(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(V(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(V(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return zr("not implemented")}};function hs(n,e){V(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Io=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Ef(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $E(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ud(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let t=yield Ri(this,this.stsTokenManager.getToken(this.auth,e));return V(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return oO(this,e)}reload(){return aO(this)}_assign(e){this!==e&&(V(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){V(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield ld(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(tt(this.auth.app))return Promise.reject(Ot(this.auth));let e=yield this.getIdToken();return yield Ri(this,S9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,u,d;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,w=(o=t.photoURL)!==null&&o!==void 0?o:void 0,C=(a=t.tenantId)!==null&&a!==void 0?a:void 0,A=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,F=(u=t.createdAt)!==null&&u!==void 0?u:void 0,G=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:U,emailVerified:Q,isAnonymous:se,providerData:J,stsTokenManager:T}=t;V(U&&T,e,"internal-error");let v=sd.fromJSON(this.name,T);V(typeof U=="string",e,"internal-error"),hs(h,e.name),hs(p,e.name),V(typeof Q=="boolean",e,"internal-error"),V(typeof se=="boolean",e,"internal-error"),hs(_,e.name),hs(w,e.name),hs(C,e.name),hs(A,e.name),hs(F,e.name),hs(G,e.name);let I=new n({uid:U,auth:e,email:p,emailVerified:Q,displayName:h,isAnonymous:se,photoURL:w,phoneNumber:_,tenantId:C,stsTokenManager:v,createdAt:F,lastLoginAt:G});return J&&Array.isArray(J)&&(I.providerData=J.map(b=>Object.assign({},b))),A&&(I._redirectEventId=A),I}static _fromIdTokenResponse(e,t,r=!1){return g(this,null,function*(){let i=new sd;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield ld(s),s})}static _fromGetAccountInfoResponse(e,t,r){return g(this,null,function*(){let i=t.users[0];V(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?cO(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new sd;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new ud(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,u),c})}};var Hk=new Map;function Xt(n){Yn(n instanceof Function,"Expected a class definition");let e=Hk.get(n);return e?(Yn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Hk.set(n,e),e)}var M9=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(t,r){return g(this,null,function*(){this.storage[t]=r})}_get(t){return g(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return g(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),ps=M9;function Gr(n,e,t){return`firebase:${n}:${e}:${t}`}var Lm=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Gr(this.userKey,i.apiKey,s),this.fullPersistenceKey=Gr("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Io._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return g(this,null,function*(){if(!t.length)return new n(Xt(ps),e,r);let i=(yield Promise.all(t.map(u=>g(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=i[0]||Xt(ps),o=Gr(r,e.config.apiKey,e.name),a=null;for(let u of t)try{let d=yield u._get(o);if(d){let h=Io._fromJSON(e,d);u!==s&&(a=h),s=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(u=>g(this,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new n(s,e,r))})}};function qk(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hO(e))return"Blackberry";if(fO(e))return"Webos";if(_T(e))return"Safari";if((e.includes("chrome/")||lO(e))&&!e.includes("edge/"))return"Chrome";if(yc(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function uO(n=je()){return/firefox\//i.test(n)}function _T(n=je()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function lO(n=je()){return/crios\//i.test(n)}function dO(n=je()){return/iemobile/i.test(n)}function yc(n=je()){return/android/i.test(n)}function hO(n=je()){return/blackberry/i.test(n)}function fO(n=je()){return/webos/i.test(n)}function Do(n=je()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function pO(n=je()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function k9(n=je()){var e;return Do(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function O9(){return Cm()&&document.documentMode===10}function mO(n=je()){return Do(n)||yc(n)||fO(n)||hO(n)||/windows phone/i.test(n)||dO(n)}function L9(){try{return!!(window&&window!==window.top)}catch{return!1}}function yT(n,e=[]){let t;switch(n){case"Browser":t=qk(je());break;case"Worker":t=`${qk(je())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${hn}/${r}`}var HE=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function F9(t){return g(this,arguments,function*(n,e={}){return ut(n,"GET","/v2/passwordPolicy",ct(n,e))})}var V9=6,qE=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:V9,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Fm=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Vm(this),this.idTokenSubscription=new Vm(this),this.beforeStateQueue=new HE(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nO,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Xt(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Lm.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let t=yield sO(this,{idToken:e}),r=yield Io._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var t;if(tt(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return V(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield ld(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=I9()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(tt(this.app))return Promise.reject(Ot(this));let t=e?H(e):null;return t&&V(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&V(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return tt(this.app)?Promise.reject(Ot(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return tt(this.app)?Promise.reject(Ot(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(Xt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield F9(this),t=new qE(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Kn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield P9(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Xt(e)||this._popupRedirectResolver;V(t,this,"argument-error"),this.redirectPersistenceManager=yield Lm.create(this,[Xt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(V(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return V(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=yT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return g(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&v9(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Ke(n){return H(n)}var Vm=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Dm(t=>this.observer=t)}get next(){return V(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var wd={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function U9(n){wd=n}function vT(n){return wd.loadJS(n)}function B9(){return wd.recaptchaV2Script}function j9(){return wd.recaptchaEnterpriseScript}function $9(){return wd.gapiScript}function gO(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var H9="recaptcha-enterprise",q9="NO_RECAPTCHA",zE=class{constructor(e){this.type=H9,this.auth=Ke(e)}verify(e="verify",t=!1){return g(this,null,function*(){function r(s){return g(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>g(this,null,function*(){D9(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let u=new jE(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;jk(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(q9)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&jk(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=j9();c.length!==0&&(c+=a),vT(c).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})})}};function zk(n,e,t,r=!1){return g(this,null,function*(){let i=new zE(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function dd(n,e,t,r){return g(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield zk(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>g(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield zk(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function z9(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Xt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function wT(n,e,t){let r=Ke(n);V(r._canInitEmulator,r,"emulator-config-failed"),V(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=_O(e),{host:o,port:a}=G9(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||W9()}function _O(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function G9(n){let e=_O(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:Gk(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:Gk(o)}}}function Gk(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function W9(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Wr=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return zr("not implemented")}_getIdTokenResponse(e){return zr("not implemented")}_linkToIdToken(e,t){return zr("not implemented")}_getReauthenticationResolver(e){return zr("not implemented")}};function yO(n,e){return g(this,null,function*(){return ut(n,"POST","/v1/accounts:resetPassword",ct(n,e))})}function K9(n,e){return g(this,null,function*(){return ut(n,"POST","/v1/accounts:update",e)})}function Q9(n,e){return g(this,null,function*(){return ut(n,"POST","/v1/accounts:signUp",e)})}function Y9(n,e){return g(this,null,function*(){return ut(n,"POST","/v1/accounts:update",ct(n,e))})}function J9(n,e){return g(this,null,function*(){return xi(n,"POST","/v1/accounts:signInWithPassword",ct(n,e))})}function Wm(n,e){return g(this,null,function*(){return ut(n,"POST","/v1/accounts:sendOobCode",ct(n,e))})}function X9(n,e){return g(this,null,function*(){return Wm(n,e)})}function Z9(n,e){return g(this,null,function*(){return Wm(n,e)})}function e6(n,e){return g(this,null,function*(){return Wm(n,e)})}function t6(n,e){return g(this,null,function*(){return Wm(n,e)})}function n6(n,e){return g(this,null,function*(){return xi(n,"POST","/v1/accounts:signInWithEmailLink",ct(n,e))})}function r6(n,e){return g(this,null,function*(){return xi(n,"POST","/v1/accounts:signInWithEmailLink",ct(n,e))})}var hd=class n extends Wr{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return g(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dd(e,t,"signInWithPassword",J9);case"emailLink":return n6(e,{email:this._email,oobCode:this._password});default:Tt(e,"internal-error")}})}_linkToIdToken(e,t){return g(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dd(e,r,"signUpPassword",Q9);case"emailLink":return r6(e,{idToken:t,email:this._email,oobCode:this._password});default:Tt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Ai(n,e){return g(this,null,function*(){return xi(n,"POST","/v1/accounts:signInWithIdp",ct(n,e))})}var i6="http://localhost",gr=class n extends Wr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Tt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Ef(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return Ai(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Ai(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Ai(e,t)}buildRequest(){let e={requestUri:i6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Si(t)}return e}};function s6(n,e){return g(this,null,function*(){return ut(n,"POST","/v1/accounts:sendVerificationCode",ct(n,e))})}function o6(n,e){return g(this,null,function*(){return xi(n,"POST","/v1/accounts:signInWithPhoneNumber",ct(n,e))})}function a6(n,e){return g(this,null,function*(){let t=yield xi(n,"POST","/v1/accounts:signInWithPhoneNumber",ct(n,e));if(t.temporaryProof)throw rd(n,"account-exists-with-different-credential",t);return t})}var c6={USER_NOT_FOUND:"user-not-found"};function u6(n,e){return g(this,null,function*(){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return xi(n,"POST","/v1/accounts:signInWithPhoneNumber",ct(n,t),c6)})}var mc=class n extends Wr{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return o6(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return a6(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return u6(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function l6(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function d6(n){let e=us(lc(n)).link,t=e?us(lc(e)).deep_link_id:null,r=us(lc(n)).deep_link_id;return(r?us(lc(r)).link:null)||r||t||e||n}var fd=class n{constructor(e){var t,r,i,s,o,a;let c=us(lc(e)),u=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=l6((i=c.mode)!==null&&i!==void 0?i:null);V(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=d6(e);try{return new n(t)}catch{return null}}};var Id=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return hd._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=fd.parseLink(r);return V(i,"argument-error"),hd._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),_r=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var ms=class extends _r{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},gc=class n extends ms{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return V("providerId"in t&&"signInMethod"in t,"argument-error"),gr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return V(e.idToken||e.accessToken,"argument-error"),gr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var Km=(()=>{class n extends ms{constructor(){super("facebook.com")}static credential(t){return gr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.FACEBOOK_SIGN_IN_METHOD="facebook.com",n.PROVIDER_ID="facebook.com";return n})(),Qm=(()=>{class n extends ms{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return gr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})(),Ym=(()=>{class n extends ms{constructor(){super("github.com")}static credential(t){return gr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.GITHUB_SIGN_IN_METHOD="github.com",n.PROVIDER_ID="github.com";return n})(),h6="http://localhost",Eo=class n extends Wr{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return Ai(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Ai(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Ai(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:h6,returnSecureToken:!0,pendingToken:this.pendingToken}}};var f6="saml.",pd=class n extends _r{constructor(e){V(e.startsWith(f6),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=Eo.fromJSON(e);return V(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Eo._create(r,t)}catch{return null}}};var Jm=(()=>{class n extends ms{constructor(){super("twitter.com")}static credential(t,r){return gr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return n.credential(r,i)}catch{return null}}}n.TWITTER_SIGN_IN_METHOD="twitter.com",n.PROVIDER_ID="twitter.com";return n})();function vO(n,e){return g(this,null,function*(){return xi(n,"POST","/v1/accounts:signUp",ct(n,e))})}var yr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return g(this,null,function*(){let s=yield Io._fromIdTokenResponse(e,r,i),o=Wk(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return g(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=Wk(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function Wk(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function IT(n){return g(this,null,function*(){var e;if(tt(n.app))return Promise.reject(Ot(n));let t=Ke(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new yr({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield vO(t,{returnSecureToken:!0}),i=yield yr._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var GE=class n extends at{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function wO(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?GE._fromErrorAndOperation(n,s,e,r):s})}function IO(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}function ET(n,e){return g(this,null,function*(){let t=H(n);yield Xm(!0,t,e);let{providerUserInfo:r}=yield A9(t.auth,{idToken:yield t.getIdToken(),deleteProvider:[e]}),i=IO(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),yield t.auth._persistUserIfCurrent(t),t})}function TT(n,e,t=!1){return g(this,null,function*(){let r=yield Ri(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return yr._forOperation(n,"link",r)})}function Xm(n,e,t){return g(this,null,function*(){yield ld(e);let r=IO(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";V(r.has(t)===n,e.auth,i)})}function EO(n,e,t=!1){return g(this,null,function*(){let{auth:r}=n;if(tt(r.app))return Promise.reject(Ot(r));let i="reauthenticate";try{let s=yield Ri(n,wO(r,i,e,n),t);V(s.idToken,r,"internal-error");let o=Gm(s.idToken);V(o,r,"internal-error");let{sub:a}=o;return V(n.uid===a,r,"user-mismatch"),yr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Tt(r,"user-mismatch"),s}})}function TO(n,e,t=!1){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r="signIn",i=yield wO(n,r,e),s=yield yr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function vc(n,e){return g(this,null,function*(){return TO(Ke(n),e)})}function Zm(n,e){return g(this,null,function*(){let t=H(n);return yield Xm(!1,t,e.providerId),TT(t,e)})}function eg(n,e){return g(this,null,function*(){return EO(H(n),e)})}function p6(n,e){return g(this,null,function*(){return xi(n,"POST","/v1/accounts:signInWithCustomToken",ct(n,e))})}function bT(n,e){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let t=Ke(n),r=yield p6(t,{token:e,returnSecureToken:!0}),i=yield yr._fromIdTokenResponse(t,"signIn",r);return yield t._updateCurrentUser(i.user),i})}var To=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?WE._fromServerResponse(e,t):"totpInfo"in t?KE._fromServerResponse(e,t):Tt(e,"internal-error")}},WE=class n extends To{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},KE=class n extends To{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function tg(n,e,t){var r;V(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),V(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(V(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(V(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function CT(n){return g(this,null,function*(){let e=Ke(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function DT(n,e,t){return g(this,null,function*(){let r=Ke(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&tg(r,i,t),yield dd(r,i,"getOobCode",Z9)})}function ST(n,e,t){return g(this,null,function*(){yield yO(H(n),{oobCode:e,newPassword:t}).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&CT(n),r}))})}function AT(n,e){return g(this,null,function*(){yield Y9(H(n),{oobCode:e})})}function ng(n,e){return g(this,null,function*(){let t=H(n),r=yield yO(t,{oobCode:e}),i=r.requestType;switch(V(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":V(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":V(r.mfaInfo,t,"internal-error");default:V(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=To._fromServerResponse(Ke(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}})}function RT(n,e){return g(this,null,function*(){let{data:t}=yield ng(H(n),e);return t.email})}function xT(n,e,t){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r=Ke(n),o=yield dd(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",vO).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&CT(n),c}),a=yield yr._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function NT(n,e,t){return tt(n.app)?Promise.reject(Ot(n)):vc(H(n),Id.credential(e,t)).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&CT(n),r}))}function PT(n,e,t){return g(this,null,function*(){let r=Ke(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){V(a.handleCodeInApp,r,"argument-error"),a&&tg(r,o,a)}s(i,t),yield dd(r,i,"getOobCode",e6)})}function MT(n,e){let t=fd.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}function kT(n,e,t){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r=H(n),i=Id.credentialWithLink(e,t||ad());return V(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),vc(r,i)})}function m6(n,e){return g(this,null,function*(){return ut(n,"POST","/v1/accounts:createAuthUri",ct(n,e))})}function OT(n,e){return g(this,null,function*(){let t=mT()?ad():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=yield m6(H(n),r);return i||[]})}function LT(n,e){return g(this,null,function*(){let t=H(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&tg(t.auth,i,e);let{email:s}=yield X9(t.auth,i);s!==n.email&&(yield n.reload())})}function FT(n,e,t){return g(this,null,function*(){let r=H(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield n.getIdToken(),newEmail:e};t&&tg(r.auth,s,t);let{email:o}=yield t6(r.auth,s);o!==n.email&&(yield n.reload())})}function g6(n,e){return g(this,null,function*(){return ut(n,"POST","/v1/accounts:update",e)})}function VT(r,i){return g(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=H(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield Ri(s,g6(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let u=s.providerData.find(({providerId:d})=>d==="password");u&&(u.displayName=s.displayName,u.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function UT(n,e){let t=H(n);return tt(t.auth.app)?Promise.reject(Ot(t.auth)):bO(t,e,null)}function BT(n,e){return bO(H(n),null,e)}function bO(n,e,t){return g(this,null,function*(){let{auth:r}=n,s={idToken:yield n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=yield Ri(n,K9(r,s));yield n._updateTokensIfNecessary(o,!0)})}function _6(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=Gm(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new fs(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new QE(s,i);case"github.com":return new YE(s,i);case"google.com":return new JE(s,i);case"twitter.com":return new XE(s,i,n.screenName||null);case"custom":case"anonymous":return new fs(s,null);default:return new fs(s,r,i)}}var fs=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},Um=class extends fs{constructor(e,t,r,i){super(e,t,r),this.username=i}},QE=class extends fs{constructor(e,t){super(e,"facebook.com",t)}},YE=class extends Um{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},JE=class extends fs{constructor(e,t){super(e,"google.com",t)}},XE=class extends Um{constructor(e,t,r){super(e,"twitter.com",t,r)}};function jT(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:_6(t)}var Bm=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var ZE=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=Ke(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>To._fromServerResponse(r,a));V(i.mfaPendingCredential,r,"internal-error");let o=Bm._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,a=>g(this,null,function*(){let c=yield a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let u=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let d=yield yr._fromIdTokenResponse(r,t.operationType,u);return yield r._updateCurrentUser(d.user),d;case"reauthenticate":return V(t.user,r,"internal-error"),yr._forOperation(t.user,t.operationType,u);default:Tt(r,"internal-error")}}))}resolveSignIn(e){return g(this,null,function*(){let t=e;return this.signInResolver(t)})}};function $T(n,e){var t;let r=H(n),i=e;return V(e.customData.operationType,r,"argument-error"),V((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),ZE._fromError(r,i)}function y6(n,e){return ut(n,"POST","/v2/accounts/mfaEnrollment:start",ct(n,e))}function v6(n,e){return ut(n,"POST","/v2/accounts/mfaEnrollment:finalize",ct(n,e))}function w6(n,e){return ut(n,"POST","/v2/accounts/mfaEnrollment:withdraw",ct(n,e))}var eT=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>To._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}getSession(){return g(this,null,function*(){return Bm._fromIdtoken(yield this.user.getIdToken(),this.user)})}enroll(e,t){return g(this,null,function*(){let r=e,i=yield this.getSession(),s=yield Ri(this.user,r._process(this.user.auth,i,t));return yield this.user._updateTokensIfNecessary(s),this.user.reload()})}unenroll(e){return g(this,null,function*(){let t=typeof e=="string"?e:e.uid,r=yield this.user.getIdToken();try{let i=yield Ri(this.user,w6(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),yield this.user._updateTokensIfNecessary(i),yield this.user.reload()}catch(i){throw i}})}},FE=new WeakMap;function HT(n){let e=H(n);return FE.has(e)||FE.set(e,eT._fromUser(e)),FE.get(e)}var jm="__sak";var $m=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(jm,"1"),this.storage.removeItem(jm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function I6(){let n=je();return _T(n)||Do(n)}var E6=1e3,T6=10,b6=(()=>{class n extends $m{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=I6()&&L9(),this.fallbackToPolling=mO(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}let i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(i);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);O9()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,T6):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},E6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return g(this,null,function*(){yield Dr(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return g(this,null,function*(){let r=yield Dr(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return g(this,null,function*(){yield Dr(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),wc=b6;var C6=(()=>{class n extends $m{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Kr=C6;function D6(n){return Promise.all(n.map(e=>g(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var S6=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return g(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>g(this,null,function*(){return d(r.origin,o)})),u=yield D6(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:u})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function So(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var tT=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return g(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let u=So("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let p=h;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function It(){return window}function A6(n){It().location.href=n}function qT(){return typeof It().WorkerGlobalScope<"u"&&typeof It().importScripts=="function"}function R6(){return g(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function x6(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function N6(){return qT()?self:null}var CO="firebaseLocalStorageDb",P6=1,Hm="firebaseLocalStorage",DO="fbase_key",bo=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function rg(n,e){return n.transaction([Hm],e?"readwrite":"readonly").objectStore(Hm)}function M6(){let n=indexedDB.deleteDatabase(CO);return new bo(n).toPromise()}function nT(){let n=indexedDB.open(CO,P6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Hm,{keyPath:DO})}catch(i){t(i)}}),n.addEventListener("success",()=>g(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Hm)?e(r):(r.close(),yield M6(),e(yield nT()))}))})}function Kk(n,e,t){return g(this,null,function*(){let r=rg(n,!0).put({[DO]:e,value:t});return new bo(r).toPromise()})}function k6(n,e){return g(this,null,function*(){let t=rg(n,!1).get(e),r=yield new bo(t).toPromise();return r===void 0?null:r.value})}function Qk(n,e){let t=rg(n,!0).delete(e);return new bo(t).toPromise()}var O6=800,L6=3,F6=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db?this.db:(this.db=yield nT(),this.db)})}_withRetries(t){return g(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>L6)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return qT()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=S6._getInstance(N6()),this.receiver._subscribe("keyChanged",(t,r)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var t,r;if(this.activeServiceWorker=yield R6(),!this.activeServiceWorker)return;this.sender=new tT(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return g(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||x6()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;let t=yield nT();return yield Kk(t,jm,"1"),yield Qk(t,jm),!0}catch{}return!1})}_withPendingWrite(t){return g(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(i=>Kk(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return g(this,null,function*(){let r=yield this._withRetries(i=>k6(i,t));return this.localCache[t]=r,r})}_remove(t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(r=>Qk(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return g(this,null,function*(){let t=yield this._withRetries(s=>{let o=rg(s,!1).getAll();return new bo(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),O6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Ao=F6;function V6(n,e){return ut(n,"POST","/v2/accounts/mfaSignIn:start",ct(n,e))}function U6(n,e){return ut(n,"POST","/v2/accounts/mfaSignIn:finalize",ct(n,e))}var B6=500,j6=6e4,Pm=1e12,rT=class{constructor(e){this.auth=e,this.counter=Pm,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new iT(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||Pm;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||Pm;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}execute(e){return g(this,null,function*(){var t;let r=e||Pm;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""})}},iT=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;V(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=$6(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},j6)},B6))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function $6(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var VE=gO("rcb"),H6=new wo(3e4,6e4),sT=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=It().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return V(q6(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Bk(It().grecaptcha)?Promise.resolve(It().grecaptcha):new Promise((r,i)=>{let s=It().setTimeout(()=>{i(Et(e,"network-request-failed"))},H6.get());It()[VE]=()=>{It().clearTimeout(s),delete It()[VE];let a=It().grecaptcha;if(!a||!Bk(a)){i(Et(e,"internal-error"));return}let c=a.render;a.render=(u,d)=>{let h=c(u,d);return this.counter++,h},this.hostLanguage=t,r(a)};let o=`${B9()}?${Si({onload:VE,render:"explicit",hl:t})}`;vT(o).catch(()=>{clearTimeout(s),i(Et(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=It().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function q6(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var oT=class{load(e){return g(this,null,function*(){return new rT(e)})}clearedOneInstance(){}};var SO="recaptcha",z6={theme:"light",type:"image"},md=class{constructor(e,t,r=Object.assign({},z6)){this.parameters=r,this.type=SO,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ke(e),this.isInvisible=this.parameters.size==="invisible",V(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;V(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new oT:new sT,this.validateStartingState()}verify(){return g(this,null,function*(){this.assertNotDestroyed();let e=yield this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){V(!this.parameters.sitekey,this.auth,"argument-error"),V(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),V(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=It()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){V(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){return g(this,null,function*(){if(yield this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId})}init(){return g(this,null,function*(){V(mT()&&!qT(),this.auth,"internal-error"),yield G6(),this.recaptcha=yield this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=yield C9(this.auth);V(e,this.auth,"internal-error"),this.parameters.sitekey=e})}getAssertedRecaptcha(){return V(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function G6(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var gd=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=mc._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};function zT(n,e,t){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r=Ke(n),i=yield ig(r,e,H(t));return new gd(i,s=>vc(r,s))})}function GT(n,e,t){return g(this,null,function*(){let r=H(n);yield Xm(!1,r,"phone");let i=yield ig(r.auth,e,H(t));return new gd(i,s=>Zm(r,s))})}function WT(n,e,t){return g(this,null,function*(){let r=H(n);if(tt(r.auth.app))return Promise.reject(Ot(r.auth));let i=yield ig(r.auth,e,H(t));return new gd(i,s=>eg(r,s))})}function ig(n,e,t){return g(this,null,function*(){var r;let i=yield t.verify();try{V(typeof i=="string",n,"argument-error"),V(t.type===SO,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return V(o.type==="enroll",n,"internal-error"),(yield y6(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{V(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return V(a,n,"missing-multi-factor-info"),(yield V6(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=yield s6(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}})}function KT(n,e){return g(this,null,function*(){let t=H(n);if(tt(t.auth.app))return Promise.reject(Ot(t.auth));yield TT(t,e)})}var Ro=(()=>{class n{constructor(t){this.providerId=n.PROVIDER_ID,this.auth=Ke(t)}verifyPhoneNumber(t,r){return ig(this.auth,t,H(r))}static credential(t,r){return mc._fromVerification(t,r)}static credentialFromResult(t){let r=t;return n.credentialFromTaggedObject(r)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{phoneNumber:r,temporaryProof:i}=t;return r&&i?mc._fromTokenResponse(r,i):null}}n.PROVIDER_ID="phone",n.PHONE_SIGN_IN_METHOD="phone";return n})();function xo(n,e){return e?Xt(e):(V(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var _d=class extends Wr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ai(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ai(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ai(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function W6(n){return TO(n.auth,new _d(n),n.bypassAuthState)}function K6(n){let{auth:e,user:t}=n;return V(t,e,"internal-error"),EO(t,new _d(n),n.bypassAuthState)}function Q6(n){return g(this,null,function*(){let{auth:e,user:t}=n;return V(t,e,"internal-error"),TT(t,new _d(n),n.bypassAuthState)})}var qm=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return g(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return W6;case"linkViaPopup":case"linkViaRedirect":return Q6;case"reauthViaPopup":case"reauthViaRedirect":return K6;default:Tt(this.auth,"internal-error")}}resolve(e){Yn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Y6=new wo(2e3,1e4);function QT(n,e,t){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Et(n,"operation-not-supported-in-this-environment"));let r=Ke(n);_c(n,e,_r);let i=xo(r,t);return new XT(r,"signInViaPopup",e,i).executeNotNull()})}function YT(n,e,t){return g(this,null,function*(){let r=H(n);if(tt(r.auth.app))return Promise.reject(Et(r.auth,"operation-not-supported-in-this-environment"));_c(r.auth,e,_r);let i=xo(r.auth,t);return new XT(r.auth,"reauthViaPopup",e,i,r).executeNotNull()})}function JT(n,e,t){return g(this,null,function*(){let r=H(n);_c(r.auth,e,_r);let i=xo(r.auth,t);return new XT(r.auth,"linkViaPopup",e,i,r).executeNotNull()})}var XT=(()=>{class n extends qm{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return g(this,null,function*(){let t=yield this.execute();return V(t,this.auth,"internal-error"),t})}onExecution(){return g(this,null,function*(){Yn(this.filter.length===1,"Popup operations only handle one event");let t=So();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Et(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Et(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Et(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,Y6.get())};t()}}n.currentPopupAction=null;return n})(),J6="pendingRedirect",od=new Map,aT=class n extends qm{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return g(this,null,function*(){let e=od.get(this.auth._key());if(!e){try{let r=(yield X6(this.resolver,this.auth))?yield Dr(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}od.set(this.auth._key(),e)}return this.bypassAuthState||od.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if(e.type==="signInViaRedirect")return Dr(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Dr(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return g(this,null,function*(){})}cleanUp(){}};function X6(n,e){return g(this,null,function*(){let t=xO(e),r=RO(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function ZT(n,e){return g(this,null,function*(){return RO(n)._set(xO(e),"true")})}function AO(){od.clear()}function Ic(n,e){od.set(n._key(),e)}function RO(n){return Xt(n._redirectPersistence)}function xO(n){return Gr(J6,n.config.apiKey,n.name)}function eb(n,e,t){return Z6(n,e,t)}function Z6(n,e,t){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r=Ke(n);_c(n,e,_r),yield r._initializationPromise;let i=xo(r,t);return yield ZT(i,r),i._openRedirect(r,e,"signInViaRedirect")})}function tb(n,e,t){return e5(n,e,t)}function e5(n,e,t){return g(this,null,function*(){let r=H(n);if(_c(r.auth,e,_r),tt(r.auth.app))return Promise.reject(Ot(r.auth));yield r.auth._initializationPromise;let i=xo(r.auth,t);yield ZT(i,r.auth);let s=yield NO(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)})}function nb(n,e,t){return t5(n,e,t)}function t5(n,e,t){return g(this,null,function*(){let r=H(n);_c(r.auth,e,_r),yield r.auth._initializationPromise;let i=xo(r.auth,t);yield Xm(!1,r,e.providerId),yield ZT(i,r.auth);let s=yield NO(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)})}function rb(n,e){return g(this,null,function*(){return yield Ke(n)._initializationPromise,No(n,e,!1)})}function No(n,e,t=!1){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r=Ke(n),i=xo(r,e),o=yield new aT(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}function NO(n){return g(this,null,function*(){let e=So(`${n.uid}:::`);return n._redirectEventId=e,yield n.auth._setRedirectUser(n),yield n.auth._persistUserIfCurrent(n),e})}var n5=10*60*1e3,yd=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!r5(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!PO(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Et(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=n5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Yk(e))}saveEventToCache(e){this.cachedEventUids.add(Yk(e)),this.lastProcessedEventTime=Date.now()}};function Yk(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function PO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function r5(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PO(n);default:return!1}}function ib(t){return g(this,arguments,function*(n,e={}){return ut(n,"GET","/v1/projects",e)})}var i5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,s5=/^https?/;function o5(n){return g(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield ib(n);for(let t of e)try{if(a5(t))return}catch{}Tt(n,"unauthorized-domain")})}function a5(n){let e=ad(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!s5.test(t))return!1;if(i5.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var c5=new wo(3e4,6e4);function Jk(){let n=It().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function u5(n){return new Promise((e,t)=>{var r,i,s;function o(){Jk(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Jk(),t(Et(n,"network-request-failed"))},timeout:c5.get()})}if(!((i=(r=It().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=It().gapi)===null||s===void 0)&&s.load)o();else{let a=gO("iframefcb");return It()[a]=()=>{gapi.load?o():t(Et(n,"network-request-failed"))},vT(`${$9()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw km=null,e})}var km=null;function l5(n){return km=km||u5(n),km}var d5=new wo(5e3,15e3),h5="__/auth/iframe",f5="emulator/auth/iframe",p5={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},m5=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function g5(n){let e=n.config;V(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?gT(e,f5):`https://${n.config.authDomain}/${h5}`,r={apiKey:e.apiKey,appName:n.name,v:hn},i=m5.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Si(r).slice(1)}`}function _5(n){return g(this,null,function*(){let e=yield l5(n),t=It().gapi;return V(t,n,"internal-error"),e.open({where:document.body,url:g5(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:p5,dontclear:!0},r=>new Promise((i,s)=>g(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=Et(n,"network-request-failed"),a=It().setTimeout(()=>{s(o)},d5.get());function c(){It().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var y5={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},v5=500,w5=600,I5="_blank",E5="http://localhost",vd=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function T5(n,e,t,r=v5,i=w5){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},y5),{width:r.toString(),height:i.toString(),top:s,left:o}),u=je().toLowerCase();t&&(a=lO(u)?I5:t),uO(u)&&(e=e||E5,c.scrollbars="yes");let d=Object.entries(c).reduce((p,[_,w])=>`${p}${_}=${w},`,"");if(k9(u)&&a!=="_self")return b5(e||"",a),new vd(null);let h=window.open(e||"",a,d);V(h,n,"popup-blocked");try{h.focus()}catch{}return new vd(h)}function b5(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var C5="__/auth/handler",D5="emulator/auth/handler",S5=encodeURIComponent("fac");function zm(n,e,t,r,i,s){return g(this,null,function*(){V(n.config.authDomain,n,"auth-domain-config-required"),V(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:hn,eventId:i};if(e instanceof _r){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",uc(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(s||{}))o[d]=h}if(e instanceof ms){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),u=c?`#${S5}=${encodeURIComponent(c)}`:"";return`${A5(n)}?${Si(a).slice(1)}${u}`})}function A5({config:n}){return n.emulator?gT(n,D5):`https://${n.authDomain}/${C5}`}var UE="webStorageSupport",cT=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Kr,this._completeRedirectFn=No,this._overrideRedirectResult=Ic}_openPopup(e,t,r,i){return g(this,null,function*(){var s;Yn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield zm(e,t,r,ad(),i);return T5(e,o,So())})}_openRedirect(e,t,r,i){return g(this,null,function*(){yield this._originValidation(e);let s=yield zm(e,t,r,ad(),i);return A6(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Yn(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return g(this,null,function*(){let t=yield _5(e),r=new yd(e);return t.register("authEvent",i=>(V(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(UE,{type:UE},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[UE];o!==void 0&&t(!!o),Tt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=o5(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return mO()||_T()||Do()}},sb=cT,uT=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return zr("unexpected MultiFactorSessionType")}}},lT=class n extends uT{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return v6(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return U6(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},ob=(()=>{class n{constructor(){}static assertion(t){return lT._fromCredential(t)}}return n.FACTOR_ID="phone",n})();var Xk="@firebase/auth",Zk="1.7.4";var dT=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){V(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function R5(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function x5(n){dn(new Ve("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;V(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yT(n)},u=new Fm(r,i,s,c);return z9(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),dn(new Ve("auth-internal",e=>{let t=Ke(e.getProvider("auth").getImmediate());return(r=>new dT(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ft(Xk,Zk,R5(n)),ft(Xk,Zk,"esm2017")}var N5=5*60,noe=fk("authIdTokenMaxAge")||N5;function P5(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}U9({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Et("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",P5().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});x5("Browser");function Po(){return window}var M5=2e3;function k5(n,e,t){return g(this,null,function*(){var r;let{BuildInfo:i}=Po();Yn(e.sessionId,"AuthEvent did not contain a session ID");let s=yield U5(e.sessionId),o={};return Do()?o.ibi=i.packageName:yc()?o.apn=i.packageName:Tt(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,zm(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)})}function O5(n){return g(this,null,function*(){let{BuildInfo:e}=Po(),t={};Do()?t.iosBundleId=e.packageName:yc()?t.androidPackageName=e.packageName:Tt(n,"operation-not-supported-in-this-environment"),yield ib(n,t)})}function L5(n){let{cordova:e}=Po();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,pO()?"_blank":"_system","location=yes"),t(i)})})}function F5(n,e,t){return g(this,null,function*(){let{cordova:r}=Po(),i=()=>{};try{yield new Promise((s,o)=>{let a=null;function c(){var h;s();let p=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof p=="function"&&p(),typeof t?.close=="function"&&t.close()}function u(){a||(a=window.setTimeout(()=>{o(Et(n,"redirect-cancelled-by-user"))},M5))}function d(){document?.visibilityState==="visible"&&u()}e.addPassiveListener(c),document.addEventListener("resume",u,!1),yc()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}})}function V5(n){var e,t,r,i,s,o,a,c,u,d;let h=Po();V(typeof((e=h?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),V(typeof((t=h?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),V(typeof((s=(i=(r=h?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),V(typeof((c=(a=(o=h?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),V(typeof((d=(u=h?.cordova)===null||u===void 0?void 0:u.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function U5(n){return g(this,null,function*(){let e=B5(n),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")})}function B5(n){if(Yn(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var j5=20,ab=class extends yd{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}initialized(){return g(this,null,function*(){yield this.initPromise})}};function $5(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:z5(),postBody:null,tenantId:n.tenantId,error:Et(n,"no-auth-event")}}function H5(n,e){return cb()._set(ub(n),e)}function MO(n){return g(this,null,function*(){let e=yield cb()._get(ub(n));return e&&(yield cb()._remove(ub(n))),e})}function q5(n,e){var t,r;let i=W5(e);if(i.includes("/__/auth/callback")){let s=sg(i),o=s.firebaseError?G5(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?Et(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function z5(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<j5;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function cb(){return Xt(wc)}function ub(n){return Gr("authEvent",n.config.apiKey,n.name)}function G5(n){try{return JSON.parse(n)}catch{return null}}function W5(n){let e=sg(n),t=e.link?decodeURIComponent(e.link):void 0,r=sg(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return sg(i).link||i||r||t||n}function sg(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return us(t.join("?"))}var K5=500,lb=class{constructor(){this._redirectPersistence=Kr,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=No,this._overrideRedirectResult=Ic}_initialize(e){return g(this,null,function*(){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new ab(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r})}_openPopup(e){Tt(e,"operation-not-supported-in-this-environment")}_openRedirect(e,t,r,i){return g(this,null,function*(){V5(e);let s=yield this._initialize(e);yield s.initialized(),s.resetRedirect(),AO(),yield this._originValidation(e);let o=$5(e,r,i);yield H5(e,o);let a=yield k5(e,o,t),c=yield L5(a);return F5(e,s,c)})}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=O5(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Po(),o=setTimeout(()=>g(this,null,function*(){yield MO(e),t.onEvent(kO())}),K5),a=d=>g(this,null,function*(){clearTimeout(o);let h=yield MO(e),p=null;h&&d?.url&&(p=q5(h,d.url)),t.onEvent(p||kO())});typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,u=`${s.packageName.toLowerCase()}://`;Po().handleOpenURL=d=>g(this,null,function*(){if(d.toLowerCase().startsWith(u)&&a({url:d}),typeof c=="function")try{c(d)}catch(h){console.error(h)}})}},OO=lb;function kO(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Et("no-auth-event")}}function LO(n,e){Ke(n)._logFramework(e)}var Y5="@firebase/auth-compat",J5="0.5.9";var X5=1e3;function bd(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function Z5(){return bd()==="http:"||bd()==="https:"}function UO(n=je()){return!!((bd()==="file:"||bd()==="ionic:"||bd()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function e8(){return go()||Em()}function t8(){return Cm()&&document?.documentMode===11}function n8(n=je()){return/Edge\/\d+/.test(n)}function r8(n=je()){return t8()||n8(n)}function BO(){try{let n=self.localStorage,e=So();if(n)return n.setItem(e,"1"),n.removeItem(e),r8()?os():!0}catch{return gb()&&os()}return!1}function gb(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function db(){return(Z5()||bm()||UO())&&!e8()&&BO()&&!gb()}function jO(){return UO()&&typeof document<"u"}function i8(){return g(this,null,function*(){return jO()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},X5);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1})}function s8(){return typeof window<"u"?window:null}var Mn={LOCAL:"local",NONE:"none",SESSION:"session"},Ed=V,$O="persistence";function o8(n,e){if(Ed(Object.values(Mn).includes(e),n,"invalid-persistence-type"),go()){Ed(e!==Mn.SESSION,n,"unsupported-persistence-type");return}if(Em()){Ed(e===Mn.NONE,n,"unsupported-persistence-type");return}if(gb()){Ed(e===Mn.NONE||e===Mn.LOCAL&&os(),n,"unsupported-persistence-type");return}Ed(e===Mn.NONE||BO(),n,"unsupported-persistence-type")}function hb(n){return g(this,null,function*(){yield n._initializationPromise;let e=HO(),t=Gr($O,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())})}function a8(n,e){let t=HO();if(!t)return[];let r=Gr($O,n,e);switch(t.getItem(r)){case Mn.NONE:return[ps];case Mn.LOCAL:return[Ao,Kr];case Mn.SESSION:return[Kr];default:return[]}}function HO(){var n;try{return((n=s8())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var c8=V,Qr=class{constructor(){this.browserResolver=Xt(sb),this.cordovaResolver=Xt(OO),this.underlyingResolver=null,this._redirectPersistence=Kr,this._completeRedirectFn=No,this._overrideRedirectResult=Ic}_initialize(e){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)})}_openPopup(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)})}_openRedirect(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)})}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return jO()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return c8(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){return g(this,null,function*(){if(this.underlyingResolver)return;let e=yield i8();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver})}};function qO(n){return n.unwrap()}function u8(n){return n.wrapped()}function l8(n){return zO(n)}function d8(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new pb(n,$T(n,e))}else if(r){let i=zO(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function zO(n){let{_tokenResponse:e}=n instanceof at?n.customData:n;if(!e)return null;if(!(n instanceof at)&&"temporaryProof"in e&&"phoneNumber"in e)return Ro.credentialFromResult(n);let t=e.providerId;if(!t||t===Co.PASSWORD)return null;let r;switch(t){case Co.GOOGLE:r=Qm;break;case Co.FACEBOOK:r=Km;break;case Co.GITHUB:r=Ym;break;case Co.TWITTER:r=Jm;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?Eo._create(t,a):gr._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new gc(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof at?r.credentialFromError(n):r.credentialFromResult(n)}function Dn(n,e){return e.catch(t=>{throw t instanceof at&&d8(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:l8(t),additionalUserInfo:jT(t),user:Ec.getOrCreate(i)}})}function fb(n,e){return g(this,null,function*(){let t=yield e;return{verificationId:t.verificationId,confirm:r=>Dn(n,t.confirm(r))}})}var pb=class{constructor(e,t){this.resolver=t,this.auth=u8(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Dn(qO(this.auth),this.resolver.resolveSignIn(e))}};var Ec=class n{constructor(e){this._delegate=e,this.multiFactor=HT(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}linkWithCredential(e){return g(this,null,function*(){return Dn(this.auth,Zm(this._delegate,e))})}linkWithPhoneNumber(e,t){return g(this,null,function*(){return fb(this.auth,GT(this._delegate,e,t))})}linkWithPopup(e){return g(this,null,function*(){return Dn(this.auth,JT(this._delegate,e,Qr))})}linkWithRedirect(e){return g(this,null,function*(){return yield hb(Ke(this.auth)),nb(this._delegate,e,Qr)})}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}reauthenticateWithCredential(e){return g(this,null,function*(){return Dn(this.auth,eg(this._delegate,e))})}reauthenticateWithPhoneNumber(e,t){return fb(this.auth,WT(this._delegate,e,t))}reauthenticateWithPopup(e){return Dn(this.auth,YT(this._delegate,e,Qr))}reauthenticateWithRedirect(e){return g(this,null,function*(){return yield hb(Ke(this.auth)),tb(this._delegate,e,Qr)})}sendEmailVerification(e){return LT(this._delegate,e)}unlink(e){return g(this,null,function*(){return yield ET(this._delegate,e),this})}updateEmail(e){return UT(this._delegate,e)}updatePassword(e){return BT(this._delegate,e)}updatePhoneNumber(e){return KT(this._delegate,e)}updateProfile(e){return VT(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return FT(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Ec.USER_MAP=new WeakMap;var Td=V,FO=(()=>{class n{constructor(t,r){if(this.app=t,r.isInitialized()){this._delegate=r.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:i}=t.options;Td(i,"invalid-api-key",{appName:t.name}),Td(i,"invalid-api-key",{appName:t.name});let s=typeof window<"u"?Qr:void 0;this._delegate=r.initialize({options:{persistence:h8(i,t.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(hT),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Ec.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,r){wT(this._delegate,t,r)}applyActionCode(t){return AT(this._delegate,t)}checkActionCode(t){return ng(this._delegate,t)}confirmPasswordReset(t,r){return ST(this._delegate,t,r)}createUserWithEmailAndPassword(t,r){return g(this,null,function*(){return Dn(this._delegate,xT(this._delegate,t,r))})}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return OT(this._delegate,t)}isSignInWithEmailLink(t){return MT(this._delegate,t)}getRedirectResult(){return g(this,null,function*(){Td(db(),this._delegate,"operation-not-supported-in-this-environment");let t=yield rb(this._delegate,Qr);return t?Dn(this._delegate,Promise.resolve(t)):{credential:null,user:null}})}addFrameworkForLogging(t){LO(this._delegate,t)}onAuthStateChanged(t,r,i){let{next:s,error:o,complete:a}=VO(t,r,i);return this._delegate.onAuthStateChanged(s,o,a)}onIdTokenChanged(t,r,i){let{next:s,error:o,complete:a}=VO(t,r,i);return this._delegate.onIdTokenChanged(s,o,a)}sendSignInLinkToEmail(t,r){return PT(this._delegate,t,r)}sendPasswordResetEmail(t,r){return DT(this._delegate,t,r||void 0)}setPersistence(t){return g(this,null,function*(){o8(this._delegate,t);let r;switch(t){case Mn.SESSION:r=Kr;break;case Mn.LOCAL:r=(yield Xt(Ao)._isAvailable())?Ao:wc;break;case Mn.NONE:r=ps;break;default:return Tt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)})}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return Dn(this._delegate,IT(this._delegate))}signInWithCredential(t){return Dn(this._delegate,vc(this._delegate,t))}signInWithCustomToken(t){return Dn(this._delegate,bT(this._delegate,t))}signInWithEmailAndPassword(t,r){return Dn(this._delegate,NT(this._delegate,t,r))}signInWithEmailLink(t,r){return Dn(this._delegate,kT(this._delegate,t,r))}signInWithPhoneNumber(t,r){return fb(this._delegate,zT(this._delegate,t,r))}signInWithPopup(t){return g(this,null,function*(){return Td(db(),this._delegate,"operation-not-supported-in-this-environment"),Dn(this._delegate,QT(this._delegate,t,Qr))})}signInWithRedirect(t){return g(this,null,function*(){return Td(db(),this._delegate,"operation-not-supported-in-this-environment"),yield hb(this._delegate),eb(this._delegate,t,Qr)})}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return RT(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=Mn,n})();function VO(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&Ec.getOrCreate(o)),error:e,complete:t}}function h8(n,e){let t=a8(n,e);if(typeof self<"u"&&!t.includes(Ao)&&t.push(Ao),typeof window<"u")for(let r of[wc,Kr])t.includes(r)||t.push(r);return t.includes(ps)||t.push(ps),t}var Cd=class{constructor(){this.providerId="phone",this._delegate=new Ro(qO(X.auth()))}static credential(e,t){return Ro.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};Cd.PHONE_SIGN_IN_METHOD=Ro.PHONE_SIGN_IN_METHOD;Cd.PROVIDER_ID=Ro.PROVIDER_ID;var f8=V,mb=class{constructor(e,t,r=X.app()){var i;f8((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new md(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var p8="auth-compat";function m8(n){n.INTERNAL.registerComponent(new Ve(p8,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new FO(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:gs.EMAIL_SIGNIN,PASSWORD_RESET:gs.PASSWORD_RESET,RECOVER_EMAIL:gs.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:gs.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:gs.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:gs.VERIFY_EMAIL}},EmailAuthProvider:Id,FacebookAuthProvider:Km,GithubAuthProvider:Ym,GoogleAuthProvider:Qm,OAuthProvider:gc,SAMLAuthProvider:pd,PhoneAuthProvider:Cd,PhoneMultiFactorGenerator:ob,RecaptchaVerifier:mb,TwitterAuthProvider:Jm,Auth:FO,AuthCredential:Wr,Error:at}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(Y5,J5)}m8(X);var GO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},WO={};var _s,_b;(function(){var n;function e(T,v){function I(){}I.prototype=v.prototype,T.D=v.prototype,T.prototype=new I,T.prototype.constructor=T,T.C=function(b,D,R){for(var E=Array(arguments.length-2),fi=2;fi<arguments.length;fi++)E[fi-2]=arguments[fi];return v.prototype[D].apply(b,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,v,I){I||(I=0);var b=Array(16);if(typeof v=="string")for(var D=0;16>D;++D)b[D]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(D=0;16>D;++D)b[D]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=T.g[0],I=T.g[1],D=T.g[2];var R=T.g[3],E=v+(R^I&(D^R))+b[0]+3614090360&4294967295;v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[1]+3905402710&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[2]+606105819&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[3]+3250441966&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+b[4]+4118548399&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[5]+1200080426&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[6]+2821735955&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[7]+4249261313&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+b[8]+1770035416&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[9]+2336552879&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[10]+4294925233&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[11]+2304563134&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+b[12]+1804603682&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[13]+4254626195&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[14]+2792965006&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[15]+1236535329&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(D^R&(I^D))+b[1]+4129170786&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[6]+3225465664&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[11]+643717713&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[0]+3921069994&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+b[5]+3593408605&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[10]+38016083&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[15]+3634488961&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[4]+3889429448&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+b[9]+568446438&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[14]+3275163606&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[3]+4107603335&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[8]+1163531501&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+b[13]+2850285829&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[2]+4243563512&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[7]+1735328473&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[12]+2368359562&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(I^D^R)+b[5]+4294588738&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[8]+2272392833&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[11]+1839030562&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[14]+4259657740&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+b[1]+2763975236&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[4]+1272893353&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[7]+4139469664&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[10]+3200236656&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+b[13]+681279174&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[0]+3936430074&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[3]+3572445317&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[6]+76029189&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+b[9]+3654602809&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[12]+3873151461&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[15]+530742520&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[2]+3299628645&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(D^(I|~R))+b[0]+4096336452&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[7]+1126891415&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[14]+2878612391&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[5]+4237533241&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+b[12]+1700485571&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[3]+2399980690&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[10]+4293915773&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[1]+2240044497&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+b[8]+1873313359&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[15]+4264355552&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[6]+2734768916&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[13]+1309151649&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+b[4]+4149444226&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[11]+3174756917&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[2]+718787259&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[9]+3951481745&4294967295,T.g[0]=T.g[0]+v&4294967295,T.g[1]=T.g[1]+(D+(E<<21&4294967295|E>>>11))&4294967295,T.g[2]=T.g[2]+D&4294967295,T.g[3]=T.g[3]+R&4294967295}r.prototype.u=function(T,v){v===void 0&&(v=T.length);for(var I=v-this.blockSize,b=this.B,D=this.h,R=0;R<v;){if(D==0)for(;R<=I;)i(this,T,R),R+=this.blockSize;if(typeof T=="string"){for(;R<v;)if(b[D++]=T.charCodeAt(R++),D==this.blockSize){i(this,b),D=0;break}}else for(;R<v;)if(b[D++]=T[R++],D==this.blockSize){i(this,b),D=0;break}}this.h=D,this.o+=v},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var v=1;v<T.length-8;++v)T[v]=0;var I=8*this.o;for(v=T.length-8;v<T.length;++v)T[v]=I&255,I/=256;for(this.u(T),T=Array(16),v=I=0;4>v;++v)for(var b=0;32>b;b+=8)T[I++]=this.g[v]>>>b&255;return T};function s(T,v){var I=a;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=v(T)}function o(T,v){this.h=v;for(var I=[],b=!0,D=T.length-1;0<=D;D--){var R=T[D]|0;b&&R==v||(I[D]=R,b=!1)}this.g=I}var a={};function c(T){return-128<=T&&128>T?s(T,function(v){return new o([v|0],0>v?-1:0)}):new o([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return h;if(0>T)return A(u(-T));for(var v=[],I=1,b=0;T>=I;b++)v[b]=T/I|0,I*=4294967296;return new o(v,0)}function d(T,v){if(T.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(T.charAt(0)=="-")return A(d(T.substring(1),v));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(v,8)),b=h,D=0;D<T.length;D+=8){var R=Math.min(8,T.length-D),E=parseInt(T.substring(D,D+R),v);8>R?(R=u(Math.pow(v,R)),b=b.j(R).add(u(E))):(b=b.j(I),b=b.add(u(E)))}return b}var h=c(0),p=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(C(this))return-A(this).m();for(var T=0,v=1,I=0;I<this.g.length;I++){var b=this.i(I);T+=(0<=b?b:4294967296+b)*v,v*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(w(this))return"0";if(C(this))return"-"+A(this).toString(T);for(var v=u(Math.pow(T,6)),I=this,b="";;){var D=Q(I,v).g;I=F(I,D.j(v));var R=((0<I.g.length?I.g[0]:I.h)>>>0).toString(T);if(I=D,w(I))return R+b;for(;6>R.length;)R="0"+R;b=R+b}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function w(T){if(T.h!=0)return!1;for(var v=0;v<T.g.length;v++)if(T.g[v]!=0)return!1;return!0}function C(T){return T.h==-1}n.l=function(T){return T=F(this,T),C(T)?-1:w(T)?0:1};function A(T){for(var v=T.g.length,I=[],b=0;b<v;b++)I[b]=~T.g[b];return new o(I,~T.h).add(p)}n.abs=function(){return C(this)?A(this):this},n.add=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0,D=0;D<=v;D++){var R=b+(this.i(D)&65535)+(T.i(D)&65535),E=(R>>>16)+(this.i(D)>>>16)+(T.i(D)>>>16);b=E>>>16,R&=65535,E&=65535,I[D]=E<<16|R}return new o(I,I[I.length-1]&-2147483648?-1:0)};function F(T,v){return T.add(A(v))}n.j=function(T){if(w(this)||w(T))return h;if(C(this))return C(T)?A(this).j(A(T)):A(A(this).j(T));if(C(T))return A(this.j(A(T)));if(0>this.l(_)&&0>T.l(_))return u(this.m()*T.m());for(var v=this.g.length+T.g.length,I=[],b=0;b<2*v;b++)I[b]=0;for(b=0;b<this.g.length;b++)for(var D=0;D<T.g.length;D++){var R=this.i(b)>>>16,E=this.i(b)&65535,fi=T.i(D)>>>16,Fu=T.i(D)&65535;I[2*b+2*D]+=E*Fu,G(I,2*b+2*D),I[2*b+2*D+1]+=R*Fu,G(I,2*b+2*D+1),I[2*b+2*D+1]+=E*fi,G(I,2*b+2*D+1),I[2*b+2*D+2]+=R*fi,G(I,2*b+2*D+2)}for(b=0;b<v;b++)I[b]=I[2*b+1]<<16|I[2*b];for(b=v;b<2*v;b++)I[b]=0;return new o(I,0)};function G(T,v){for(;(T[v]&65535)!=T[v];)T[v+1]+=T[v]>>>16,T[v]&=65535,v++}function U(T,v){this.g=T,this.h=v}function Q(T,v){if(w(v))throw Error("division by zero");if(w(T))return new U(h,h);if(C(T))return v=Q(A(T),v),new U(A(v.g),A(v.h));if(C(v))return v=Q(T,A(v)),new U(A(v.g),v.h);if(30<T.g.length){if(C(T)||C(v))throw Error("slowDivide_ only works with positive integers.");for(var I=p,b=v;0>=b.l(T);)I=se(I),b=se(b);var D=J(I,1),R=J(b,1);for(b=J(b,2),I=J(I,2);!w(b);){var E=R.add(b);0>=E.l(T)&&(D=D.add(I),R=E),b=J(b,1),I=J(I,1)}return v=F(T,D.j(v)),new U(D,v)}for(D=h;0<=T.l(v);){for(I=Math.max(1,Math.floor(T.m()/v.m())),b=Math.ceil(Math.log(I)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),R=u(I),E=R.j(v);C(E)||0<E.l(T);)I-=b,R=u(I),E=R.j(v);w(R)&&(R=p),D=D.add(R),T=F(T,E)}return new U(D,T)}n.A=function(T){return Q(this,T).h},n.and=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)&T.i(b);return new o(I,this.h&T.h)},n.or=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)|T.i(b);return new o(I,this.h|T.h)},n.xor=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)^T.i(b);return new o(I,this.h^T.h)};function se(T){for(var v=T.g.length+1,I=[],b=0;b<v;b++)I[b]=T.i(b)<<1|T.i(b-1)>>>31;return new o(I,T.h)}function J(T,v){var I=v>>5;v%=32;for(var b=T.g.length-I,D=[],R=0;R<b;R++)D[R]=0<v?T.i(R+I)>>>v|T.i(R+I+1)<<32-v:T.i(R+I);return new o(D,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,_b=WO.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,_s=WO.Integer=o}).apply(typeof GO<"u"?GO:typeof self<"u"?self:typeof window<"u"?window:{});var og=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ni={};var yb,vb,Tc,wb,Dd,ag,Ib,Eb,Tb;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,f,m){return l==Array.prototype||l==Object.prototype||(l[f]=m.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof og=="object"&&og];for(var f=0;f<l.length;++f){var m=l[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=t(this);function i(l,f){if(f)e:{var m=r;l=l.split(".");for(var y=0;y<l.length-1;y++){var S=l[y];if(!(S in m))break e;m=m[S]}l=l[l.length-1],y=m[l],f=f(y),f!=y&&f!=null&&e(m,l,{configurable:!0,writable:!0,value:f})}}function s(l,f){l instanceof String&&(l+="");var m=0,y=!1,S={next:function(){if(!y&&m<l.length){var N=m++;return{value:f(N,l[N]),done:!1}}return y=!0,{done:!0,value:void 0}}};return S[Symbol.iterator]=function(){return S},S}i("Array.prototype.values",function(l){return l||function(){return s(this,function(f,m){return m})}});var o=o||{},a=this||self;function c(l){var f=typeof l;return f=f!="object"?f:l?Array.isArray(l)?"array":f:"null",f=="array"||f=="object"&&typeof l.length=="number"}function u(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function d(l,f,m){return l.call.apply(l.bind,arguments)}function h(l,f,m){if(!l)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var S=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(S,y),l.apply(f,S)}}return function(){return l.apply(f,arguments)}}function p(l,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function _(l,f){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),l.apply(this,y)}}function w(l,f){function m(){}m.prototype=f.prototype,l.aa=f.prototype,l.prototype=new m,l.prototype.constructor=l,l.Qb=function(y,S,N){for(var $=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)$[Ue-2]=arguments[Ue];return f.prototype[S].apply(y,$)}}function C(l){let f=l.length;if(0<f){let m=Array(f);for(let y=0;y<f;y++)m[y]=l[y];return m}return[]}function A(l,f){for(let m=1;m<arguments.length;m++){let y=arguments[m];if(c(y)){let S=l.length||0,N=y.length||0;l.length=S+N;for(let $=0;$<N;$++)l[S+$]=y[$]}else l.push(y)}}class F{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function G(l){return/^[\s\xa0]*$/.test(l)}function U(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function Q(l){return Q[" "](l),l}Q[" "]=function(){};var se=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function J(l,f,m){for(let y in l)f.call(m,l[y],y,l)}function T(l,f){for(let m in l)f.call(void 0,l[m],m,l)}function v(l){let f={};for(let m in l)f[m]=l[m];return f}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(l,f){let m,y;for(let S=1;S<arguments.length;S++){y=arguments[S];for(m in y)l[m]=y[m];for(let N=0;N<I.length;N++)m=I[N],Object.prototype.hasOwnProperty.call(y,m)&&(l[m]=y[m])}}function D(l){var f=1;l=l.split(":");let m=[];for(;0<f&&l.length;)m.push(l.shift()),f--;return l.length&&m.push(l.join(":")),m}function R(l){a.setTimeout(()=>{throw l},0)}function E(){var l=Ay;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class fi{constructor(){this.h=this.g=null}add(f,m){let y=Fu.get();y.set(f,m),this.h?this.h.next=y:this.g=y,this.h=y}}var Fu=new F(()=>new SB,l=>l.reset());class SB{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Vu,Uu=!1,Ay=new fi,CA=()=>{let l=a.Promise.resolve(void 0);Vu=()=>{l.then(AB)}};var AB=()=>{for(var l;l=E();){try{l.h.call(l.g)}catch(m){R(m)}var f=Fu;f.j(l),100>f.h&&(f.h++,l.next=f.g,f.g=l)}Uu=!1};function Hi(){this.s=this.s,this.C=this.C}Hi.prototype.s=!1,Hi.prototype.ma=function(){this.s||(this.s=!0,this.N())},Hi.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function zt(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}zt.prototype.h=function(){this.defaultPrevented=!0};var RB=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{let m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return l}();function Bu(l,f){if(zt.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var m=this.type=l.type,y=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget){if(se){e:{try{Q(f.nodeName);var S=!0;break e}catch{}S=!1}S||(f=null)}}else m=="mouseover"?f=l.fromElement:m=="mouseout"&&(f=l.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:xB[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Bu.aa.h.call(this)}}w(Bu,zt);var xB={2:"touch",3:"pen",4:"mouse"};Bu.prototype.h=function(){Bu.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ju="closure_listenable_"+(1e6*Math.random()|0),NB=0;function PB(l,f,m,y,S){this.listener=l,this.proxy=null,this.src=f,this.type=m,this.capture=!!y,this.ha=S,this.key=++NB,this.da=this.fa=!1}function Xh(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Zh(l){this.src=l,this.g={},this.h=0}Zh.prototype.add=function(l,f,m,y,S){var N=l.toString();l=this.g[N],l||(l=this.g[N]=[],this.h++);var $=xy(l,f,y,S);return-1<$?(f=l[$],m||(f.fa=!1)):(f=new PB(f,this.src,N,!!y,S),f.fa=m,l.push(f)),f};function Ry(l,f){var m=f.type;if(m in l.g){var y=l.g[m],S=Array.prototype.indexOf.call(y,f,void 0),N;(N=0<=S)&&Array.prototype.splice.call(y,S,1),N&&(Xh(f),l.g[m].length==0&&(delete l.g[m],l.h--))}}function xy(l,f,m,y){for(var S=0;S<l.length;++S){var N=l[S];if(!N.da&&N.listener==f&&N.capture==!!m&&N.ha==y)return S}return-1}var Ny="closure_lm_"+(1e6*Math.random()|0),Py={};function DA(l,f,m,y,S){if(y&&y.once)return AA(l,f,m,y,S);if(Array.isArray(f)){for(var N=0;N<f.length;N++)DA(l,f[N],m,y,S);return null}return m=Ly(m),l&&l[ju]?l.K(f,m,u(y)?!!y.capture:!!y,S):SA(l,f,m,!1,y,S)}function SA(l,f,m,y,S,N){if(!f)throw Error("Invalid event type");var $=u(S)?!!S.capture:!!S,Ue=ky(l);if(Ue||(l[Ny]=Ue=new Zh(l)),m=Ue.add(f,m,y,$,N),m.proxy)return m;if(y=MB(),m.proxy=y,y.src=l,y.listener=m,l.addEventListener)RB||(S=$),S===void 0&&(S=!1),l.addEventListener(f.toString(),y,S);else if(l.attachEvent)l.attachEvent(xA(f.toString()),y);else if(l.addListener&&l.removeListener)l.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function MB(){function l(m){return f.call(l.src,l.listener,m)}let f=kB;return l}function AA(l,f,m,y,S){if(Array.isArray(f)){for(var N=0;N<f.length;N++)AA(l,f[N],m,y,S);return null}return m=Ly(m),l&&l[ju]?l.L(f,m,u(y)?!!y.capture:!!y,S):SA(l,f,m,!0,y,S)}function RA(l,f,m,y,S){if(Array.isArray(f))for(var N=0;N<f.length;N++)RA(l,f[N],m,y,S);else y=u(y)?!!y.capture:!!y,m=Ly(m),l&&l[ju]?(l=l.i,f=String(f).toString(),f in l.g&&(N=l.g[f],m=xy(N,m,y,S),-1<m&&(Xh(N[m]),Array.prototype.splice.call(N,m,1),N.length==0&&(delete l.g[f],l.h--)))):l&&(l=ky(l))&&(f=l.g[f.toString()],l=-1,f&&(l=xy(f,m,y,S)),(m=-1<l?f[l]:null)&&My(m))}function My(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[ju])Ry(f.i,l);else{var m=l.type,y=l.proxy;f.removeEventListener?f.removeEventListener(m,y,l.capture):f.detachEvent?f.detachEvent(xA(m),y):f.addListener&&f.removeListener&&f.removeListener(y),(m=ky(f))?(Ry(m,l),m.h==0&&(m.src=null,f[Ny]=null)):Xh(l)}}}function xA(l){return l in Py?Py[l]:Py[l]="on"+l}function kB(l,f){if(l.da)l=!0;else{f=new Bu(f,this);var m=l.listener,y=l.ha||l.src;l.fa&&My(l),l=m.call(y,f)}return l}function ky(l){return l=l[Ny],l instanceof Zh?l:null}var Oy="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ly(l){return typeof l=="function"?l:(l[Oy]||(l[Oy]=function(f){return l.handleEvent(f)}),l[Oy])}function Gt(){Hi.call(this),this.i=new Zh(this),this.M=this,this.F=null}w(Gt,Hi),Gt.prototype[ju]=!0,Gt.prototype.removeEventListener=function(l,f,m,y){RA(this,l,f,m,y)};function rn(l,f){var m,y=l.F;if(y)for(m=[];y;y=y.F)m.push(y);if(l=l.M,y=f.type||f,typeof f=="string")f=new zt(f,l);else if(f instanceof zt)f.target=f.target||l;else{var S=f;f=new zt(y,l),b(f,S)}if(S=!0,m)for(var N=m.length-1;0<=N;N--){var $=f.g=m[N];S=ef($,y,!0,f)&&S}if($=f.g=l,S=ef($,y,!0,f)&&S,S=ef($,y,!1,f)&&S,m)for(N=0;N<m.length;N++)$=f.g=m[N],S=ef($,y,!1,f)&&S}Gt.prototype.N=function(){if(Gt.aa.N.call(this),this.i){var l=this.i,f;for(f in l.g){for(var m=l.g[f],y=0;y<m.length;y++)Xh(m[y]);delete l.g[f],l.h--}}this.F=null},Gt.prototype.K=function(l,f,m,y){return this.i.add(String(l),f,!1,m,y)},Gt.prototype.L=function(l,f,m,y){return this.i.add(String(l),f,!0,m,y)};function ef(l,f,m,y){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();for(var S=!0,N=0;N<f.length;++N){var $=f[N];if($&&!$.da&&$.capture==m){var Ue=$.listener,Bt=$.ha||$.src;$.fa&&Ry(l.i,$),S=Ue.call(Bt,y)!==!1&&S}}return S&&!y.defaultPrevented}function NA(l,f,m){if(typeof l=="function")m&&(l=p(l,m));else if(l&&typeof l.handleEvent=="function")l=p(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(l,f||0)}function PA(l){l.g=NA(()=>{l.g=null,l.i&&(l.i=!1,PA(l))},l.l);let f=l.h;l.h=null,l.m.apply(null,f)}class OB extends Hi{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:PA(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $u(l){Hi.call(this),this.h=l,this.g={}}w($u,Hi);var MA=[];function kA(l){J(l.g,function(f,m){this.g.hasOwnProperty(m)&&My(f)},l),l.g={}}$u.prototype.N=function(){$u.aa.N.call(this),kA(this)},$u.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fy=a.JSON.stringify,LB=a.JSON.parse,FB=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Vy(){}Vy.prototype.h=null;function OA(l){return l.h||(l.h=l.i())}function LA(){}var Hu={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Uy(){zt.call(this,"d")}w(Uy,zt);function By(){zt.call(this,"c")}w(By,zt);var Ws={},FA=null;function tf(){return FA=FA||new Gt}Ws.La="serverreachability";function VA(l){zt.call(this,Ws.La,l)}w(VA,zt);function qu(l){let f=tf();rn(f,new VA(f))}Ws.STAT_EVENT="statevent";function UA(l,f){zt.call(this,Ws.STAT_EVENT,l),this.stat=f}w(UA,zt);function sn(l){let f=tf();rn(f,new UA(f,l))}Ws.Ma="timingevent";function BA(l,f){zt.call(this,Ws.Ma,l),this.size=f}w(BA,zt);function zu(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},f)}function Gu(){this.g=!0}Gu.prototype.xa=function(){this.g=!1};function VB(l,f,m,y,S,N){l.info(function(){if(l.g)if(N)for(var $="",Ue=N.split("&"),Bt=0;Bt<Ue.length;Bt++){var Pe=Ue[Bt].split("=");if(1<Pe.length){var Wt=Pe[0];Pe=Pe[1];var Kt=Wt.split("_");$=2<=Kt.length&&Kt[1]=="type"?$+(Wt+"="+Pe+"&"):$+(Wt+"=redacted&")}}else $=null;else $=N;return"XMLHTTP REQ ("+y+") [attempt "+S+"]: "+f+`
`+m+`
`+$})}function UB(l,f,m,y,S,N,$){l.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+S+"]: "+f+`
`+m+`
`+N+" "+$})}function ga(l,f,m,y){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+jB(l,m)+(y?" "+y:"")})}function BB(l,f){l.info(function(){return"TIMEOUT: "+f})}Gu.prototype.info=function(){};function jB(l,f){if(!l.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(l=0;l<m.length;l++)if(Array.isArray(m[l])){var y=m[l];if(!(2>y.length)){var S=y[1];if(Array.isArray(S)&&!(1>S.length)){var N=S[0];if(N!="noop"&&N!="stop"&&N!="close")for(var $=1;$<S.length;$++)S[$]=""}}}}return Fy(m)}catch{return f}}var nf={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},jA={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},jy;function rf(){}w(rf,Vy),rf.prototype.g=function(){return new XMLHttpRequest},rf.prototype.i=function(){return{}},jy=new rf;function qi(l,f,m,y){this.j=l,this.i=f,this.l=m,this.R=y||1,this.U=new $u(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new $A}function $A(){this.i=null,this.g="",this.h=!1}var HA={},$y={};function Hy(l,f,m){l.L=1,l.v=cf(pi(f)),l.m=m,l.P=!0,qA(l,null)}function qA(l,f){l.F=Date.now(),sf(l),l.A=pi(l.v);var m=l.A,y=l.R;Array.isArray(y)||(y=[String(y)]),iR(m.i,"t",y),l.C=0,m=l.j.J,l.h=new $A,l.g=ER(l.j,m?f:null,!l.m),0<l.O&&(l.M=new OB(p(l.Y,l,l.g),l.O)),f=l.U,m=l.g,y=l.ca;var S="readystatechange";Array.isArray(S)||(S&&(MA[0]=S.toString()),S=MA);for(var N=0;N<S.length;N++){var $=DA(m,S[N],y||f.handleEvent,!1,f.h||f);if(!$)break;f.g[$.key]=$}f=l.H?v(l.H):{},l.m?(l.u||(l.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,f)):(l.u="GET",l.g.ea(l.A,l.u,null,f)),qu(),VB(l.i,l.u,l.A,l.l,l.R,l.m)}qi.prototype.ca=function(l){l=l.target;let f=this.M;f&&mi(l)==3?f.j():this.Y(l)},qi.prototype.Y=function(l){try{if(l==this.g)e:{let Kt=mi(this.g);var f=this.g.Ba();let va=this.g.Z();if(!(3>Kt)&&(Kt!=3||this.g&&(this.h.h||this.g.oa()||dR(this.g)))){this.J||Kt!=4||f==7||(f==8||0>=va?qu(3):qu(2)),qy(this);var m=this.g.Z();this.X=m;t:if(zA(this)){var y=dR(this.g);l="";var S=y.length,N=mi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ks(this),Wu(this);var $="";break t}this.h.i=new a.TextDecoder}for(f=0;f<S;f++)this.h.h=!0,l+=this.h.i.decode(y[f],{stream:!(N&&f==S-1)});y.length=0,this.h.g+=l,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=m==200,UB(this.i,this.u,this.A,this.l,this.R,Kt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Ue,Bt=this.g;if((Ue=Bt.g?Bt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(Ue)){var Pe=Ue;break t}}Pe=null}if(m=Pe)ga(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zy(this,m);else{this.o=!1,this.s=3,sn(12),Ks(this),Wu(this);break e}}if(this.P){m=!0;let sr;for(;!this.J&&this.C<$.length;)if(sr=$B(this,$),sr==$y){Kt==4&&(this.s=4,sn(14),m=!1),ga(this.i,this.l,null,"[Incomplete Response]");break}else if(sr==HA){this.s=4,sn(15),ga(this.i,this.l,$,"[Invalid Chunk]"),m=!1;break}else ga(this.i,this.l,sr,null),zy(this,sr);if(zA(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Kt!=4||$.length!=0||this.h.h||(this.s=1,sn(16),m=!1),this.o=this.o&&m,!m)ga(this.i,this.l,$,"[Invalid Chunked Response]"),Ks(this),Wu(this);else if(0<$.length&&!this.W){this.W=!0;var Wt=this.j;Wt.g==this&&Wt.ba&&!Wt.M&&(Wt.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),Jy(Wt),Wt.M=!0,sn(11))}}else ga(this.i,this.l,$,null),zy(this,$);Kt==4&&Ks(this),this.o&&!this.J&&(Kt==4?yR(this.j,this):(this.o=!1,sf(this)))}else sj(this.g),m==400&&0<$.indexOf("Unknown SID")?(this.s=3,sn(12)):(this.s=0,sn(13)),Ks(this),Wu(this)}}}catch{}finally{}};function zA(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function $B(l,f){var m=l.C,y=f.indexOf(`
`,m);return y==-1?$y:(m=Number(f.substring(m,y)),isNaN(m)?HA:(y+=1,y+m>f.length?$y:(f=f.slice(y,y+m),l.C=y+m,f)))}qi.prototype.cancel=function(){this.J=!0,Ks(this)};function sf(l){l.S=Date.now()+l.I,GA(l,l.I)}function GA(l,f){if(l.B!=null)throw Error("WatchDog timer not null");l.B=zu(p(l.ba,l),f)}function qy(l){l.B&&(a.clearTimeout(l.B),l.B=null)}qi.prototype.ba=function(){this.B=null;let l=Date.now();0<=l-this.S?(BB(this.i,this.A),this.L!=2&&(qu(),sn(17)),Ks(this),this.s=2,Wu(this)):GA(this,this.S-l)};function Wu(l){l.j.G==0||l.J||yR(l.j,l)}function Ks(l){qy(l);var f=l.M;f&&typeof f.ma=="function"&&f.ma(),l.M=null,kA(l.U),l.g&&(f=l.g,l.g=null,f.abort(),f.ma())}function zy(l,f){try{var m=l.j;if(m.G!=0&&(m.g==l||Gy(m.h,l))){if(!l.K&&Gy(m.h,l)&&m.G==3){try{var y=m.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var S=y;if(S[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<l.F)ff(m),df(m);else break e;Yy(m),sn(18)}}else m.za=S[1],0<m.za-m.T&&37500>S[2]&&m.F&&m.v==0&&!m.C&&(m.C=zu(p(m.Za,m),6e3));if(1>=QA(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else Ys(m,11)}else if((l.K||m.g==l)&&ff(m),!G(f))for(S=m.Da.g.parse(f),f=0;f<S.length;f++){let Pe=S[f];if(m.T=Pe[0],Pe=Pe[1],m.G==2)if(Pe[0]=="c"){m.K=Pe[1],m.ia=Pe[2];let Wt=Pe[3];Wt!=null&&(m.la=Wt,m.j.info("VER="+m.la));let Kt=Pe[4];Kt!=null&&(m.Aa=Kt,m.j.info("SVER="+m.Aa));let va=Pe[5];va!=null&&typeof va=="number"&&0<va&&(y=1.5*va,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;let sr=l.g;if(sr){let mf=sr.g?sr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(mf){var N=y.h;N.g||mf.indexOf("spdy")==-1&&mf.indexOf("quic")==-1&&mf.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(Wy(N,N.h),N.h=null))}if(y.D){let Xy=sr.g?sr.g.getResponseHeader("X-HTTP-Session-Id"):null;Xy&&(y.ya=Xy,We(y.I,y.D,Xy))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-l.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var $=l;if(y.qa=IR(y,y.J?y.ia:null,y.W),$.K){YA(y.h,$);var Ue=$,Bt=y.L;Bt&&(Ue.I=Bt),Ue.B&&(qy(Ue),sf(Ue)),y.g=$}else gR(y);0<m.i.length&&hf(m)}else Pe[0]!="stop"&&Pe[0]!="close"||Ys(m,7);else m.G==3&&(Pe[0]=="stop"||Pe[0]=="close"?Pe[0]=="stop"?Ys(m,7):Qy(m):Pe[0]!="noop"&&m.l&&m.l.ta(Pe),m.v=0)}}qu(4)}catch{}}var HB=class{constructor(l,f){this.g=l,this.map=f}};function WA(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function KA(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function QA(l){return l.h?1:l.g?l.g.size:0}function Gy(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function Wy(l,f){l.g?l.g.add(f):l.h=f}function YA(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}WA.prototype.cancel=function(){if(this.i=JA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let l of this.g.values())l.cancel();this.g.clear()}};function JA(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let f=l.i;for(let m of l.g.values())f=f.concat(m.D);return f}return C(l.i)}function qB(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var f=[],m=l.length,y=0;y<m;y++)f.push(l[y]);return f}f=[],m=0;for(y in l)f[m++]=l[y];return f}function zB(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var f=[];l=l.length;for(var m=0;m<l;m++)f.push(m);return f}f=[],m=0;for(let y in l)f[m++]=y;return f}}}function XA(l,f){if(l.forEach&&typeof l.forEach=="function")l.forEach(f,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,f,void 0);else for(var m=zB(l),y=qB(l),S=y.length,N=0;N<S;N++)f.call(void 0,y[N],m&&m[N],l)}var ZA=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function GB(l,f){if(l){l=l.split("&");for(var m=0;m<l.length;m++){var y=l[m].indexOf("="),S=null;if(0<=y){var N=l[m].substring(0,y);S=l[m].substring(y+1)}else N=l[m];f(N,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function Qs(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Qs){this.h=l.h,of(this,l.j),this.o=l.o,this.g=l.g,af(this,l.s),this.l=l.l;var f=l.i,m=new Yu;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),eR(this,m),this.m=l.m}else l&&(f=String(l).match(ZA))?(this.h=!1,of(this,f[1]||"",!0),this.o=Ku(f[2]||""),this.g=Ku(f[3]||"",!0),af(this,f[4]),this.l=Ku(f[5]||"",!0),eR(this,f[6]||"",!0),this.m=Ku(f[7]||"")):(this.h=!1,this.i=new Yu(null,this.h))}Qs.prototype.toString=function(){var l=[],f=this.j;f&&l.push(Qu(f,tR,!0),":");var m=this.g;return(m||f=="file")&&(l.push("//"),(f=this.o)&&l.push(Qu(f,tR,!0),"@"),l.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&l.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&l.push("/"),l.push(Qu(m,m.charAt(0)=="/"?QB:KB,!0))),(m=this.i.toString())&&l.push("?",m),(m=this.m)&&l.push("#",Qu(m,JB)),l.join("")};function pi(l){return new Qs(l)}function of(l,f,m){l.j=m?Ku(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function af(l,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);l.s=f}else l.s=null}function eR(l,f,m){f instanceof Yu?(l.i=f,XB(l.i,l.h)):(m||(f=Qu(f,YB)),l.i=new Yu(f,l.h))}function We(l,f,m){l.i.set(f,m)}function cf(l){return We(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Ku(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Qu(l,f,m){return typeof l=="string"?(l=encodeURI(l).replace(f,WB),m&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function WB(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var tR=/[#\/\?@]/g,KB=/[#\?:]/g,QB=/[#\?]/g,YB=/[#\?@]/g,JB=/#/g;function Yu(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function zi(l){l.g||(l.g=new Map,l.h=0,l.i&&GB(l.i,function(f,m){l.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=Yu.prototype,n.add=function(l,f){zi(this),this.i=null,l=_a(this,l);var m=this.g.get(l);return m||this.g.set(l,m=[]),m.push(f),this.h+=1,this};function nR(l,f){zi(l),f=_a(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function rR(l,f){return zi(l),f=_a(l,f),l.g.has(f)}n.forEach=function(l,f){zi(this),this.g.forEach(function(m,y){m.forEach(function(S){l.call(f,S,y,this)},this)},this)},n.na=function(){zi(this);let l=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let y=0;y<f.length;y++){let S=l[y];for(let N=0;N<S.length;N++)m.push(f[y])}return m},n.V=function(l){zi(this);let f=[];if(typeof l=="string")rR(this,l)&&(f=f.concat(this.g.get(_a(this,l))));else{l=Array.from(this.g.values());for(let m=0;m<l.length;m++)f=f.concat(l[m])}return f},n.set=function(l,f){return zi(this),this.i=null,l=_a(this,l),rR(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},n.get=function(l,f){return l?(l=this.V(l),0<l.length?String(l[0]):f):f};function iR(l,f,m){nR(l,f),0<m.length&&(l.i=null,l.g.set(_a(l,f),C(m)),l.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let l=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var y=f[m];let N=encodeURIComponent(String(y)),$=this.V(y);for(y=0;y<$.length;y++){var S=N;$[y]!==""&&(S+="="+encodeURIComponent(String($[y]))),l.push(S)}}return this.i=l.join("&")};function _a(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function XB(l,f){f&&!l.j&&(zi(l),l.i=null,l.g.forEach(function(m,y){var S=y.toLowerCase();y!=S&&(nR(this,y),iR(this,S,m))},l)),l.j=f}function ZB(l,f){let m=new Gu;if(a.Image){let y=new Image;y.onload=_(Gi,m,"TestLoadImage: loaded",!0,f,y),y.onerror=_(Gi,m,"TestLoadImage: error",!1,f,y),y.onabort=_(Gi,m,"TestLoadImage: abort",!1,f,y),y.ontimeout=_(Gi,m,"TestLoadImage: timeout",!1,f,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=l}else f(!1)}function ej(l,f){let m=new Gu,y=new AbortController,S=setTimeout(()=>{y.abort(),Gi(m,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:y.signal}).then(N=>{clearTimeout(S),N.ok?Gi(m,"TestPingServer: ok",!0,f):Gi(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(S),Gi(m,"TestPingServer: error",!1,f)})}function Gi(l,f,m,y,S){try{S&&(S.onload=null,S.onerror=null,S.onabort=null,S.ontimeout=null),y(m)}catch{}}function tj(){this.g=new FB}function nj(l,f,m){let y=m||"";try{XA(l,function(S,N){let $=S;u(S)&&($=Fy(S)),f.push(y+N+"="+encodeURIComponent($))})}catch(S){throw f.push(y+"type="+encodeURIComponent("_badmap")),S}}function Ju(l){this.l=l.Ub||null,this.j=l.eb||!1}w(Ju,Vy),Ju.prototype.g=function(){return new uf(this.l,this.j)},Ju.prototype.i=function(l){return function(){return l}}({});function uf(l,f){Gt.call(this),this.D=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(uf,Gt),n=uf.prototype,n.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=f,this.readyState=1,Zu(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(f.body=l),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xu(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Zu(this)),this.g&&(this.readyState=3,Zu(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;sR(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function sR(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?Xu(this):Zu(this),this.readyState==3&&sR(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,Xu(this))},n.Qa=function(l){this.g&&(this.response=l,Xu(this))},n.ga=function(){this.g&&Xu(this)};function Xu(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Zu(l)}n.setRequestHeader=function(l,f){this.u.append(l,f)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let l=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,l.push(m[0]+": "+m[1]),m=f.next();return l.join(`\r
`)};function Zu(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(uf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function oR(l){let f="";return J(l,function(m,y){f+=y,f+=":",f+=m,f+=`\r
`}),f}function Ky(l,f,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=oR(m),typeof l=="string"?m!=null&&encodeURIComponent(String(m)):We(l,f,m))}function st(l){Gt.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(st,Gt);var rj=/^https?$/i,ij=["POST","PUT"];n=st.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,f,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():jy.g(),this.v=this.o?OA(this.o):OA(jy),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(N){aR(this,N);return}if(l=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var S in y)m.set(S,y[S]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let N of y.keys())m.set(N,y.get(N));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(N=>N.toLowerCase()=="content-type"),S=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(ij,f,void 0))||y||S||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[N,$]of m)this.g.setRequestHeader(N,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{lR(this),this.u=!0,this.g.send(l),this.u=!1}catch(N){aR(this,N)}};function aR(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.m=5,cR(l),lf(l)}function cR(l){l.A||(l.A=!0,rn(l,"complete"),rn(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,rn(this,"complete"),rn(this,"abort"),lf(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),lf(this,!0)),st.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?uR(this):this.bb())},n.bb=function(){uR(this)};function uR(l){if(l.h&&typeof o<"u"&&(!l.v[1]||mi(l)!=4||l.Z()!=2)){if(l.u&&mi(l)==4)NA(l.Ea,0,l);else if(rn(l,"readystatechange"),mi(l)==4){l.h=!1;try{let $=l.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var y;if(y=$===0){var S=String(l.D).match(ZA)[1]||null;!S&&a.self&&a.self.location&&(S=a.self.location.protocol.slice(0,-1)),y=!rj.test(S?S.toLowerCase():"")}m=y}if(m)rn(l,"complete"),rn(l,"success");else{l.m=6;try{var N=2<mi(l)?l.g.statusText:""}catch{N=""}l.l=N+" ["+l.Z()+"]",cR(l)}}finally{lf(l)}}}}function lf(l,f){if(l.g){lR(l);let m=l.g,y=l.v[0]?()=>{}:null;l.g=null,l.v=null,f||rn(l,"ready");try{m.onreadystatechange=y}catch{}}}function lR(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function mi(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<mi(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),LB(f)}};function dR(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function sj(l){let f={};l=(l.g&&2<=mi(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<l.length;y++){if(G(l[y]))continue;var m=D(l[y]);let S=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let N=f[S]||[];f[S]=N,N.push(m)}T(f,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function el(l,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[l]||f}function hR(l){this.Aa=0,this.i=[],this.j=new Gu,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=el("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=el("baseRetryDelayMs",5e3,l),this.cb=el("retryDelaySeedMs",1e4,l),this.Wa=el("forwardChannelMaxRetries",2,l),this.wa=el("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new WA(l&&l.concurrentRequestLimit),this.Da=new tj,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=hR.prototype,n.la=8,n.G=1,n.connect=function(l,f,m,y){sn(0),this.W=l,this.H=f||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=IR(this,null,this.W),hf(this)};function Qy(l){if(fR(l),l.G==3){var f=l.U++,m=pi(l.I);if(We(m,"SID",l.K),We(m,"RID",f),We(m,"TYPE","terminate"),tl(l,m),f=new qi(l,l.j,f),f.L=2,f.v=cf(pi(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=ER(f.j,null),f.g.ea(f.v)),f.F=Date.now(),sf(f)}wR(l)}function df(l){l.g&&(Jy(l),l.g.cancel(),l.g=null)}function fR(l){df(l),l.u&&(a.clearTimeout(l.u),l.u=null),ff(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function hf(l){if(!KA(l.h)&&!l.s){l.s=!0;var f=l.Ga;Vu||CA(),Uu||(Vu(),Uu=!0),Ay.add(f,l),l.B=0}}function oj(l,f){return QA(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=f.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=zu(p(l.Ga,l,f),vR(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;let S=new qi(this,this.j,l),N=this.o;if(this.S&&(N?(N=v(N),b(N,this.S)):N=this.S),this.m!==null||this.O||(S.H=N,N=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=mR(this,S,f),m=pi(this.I),We(m,"RID",l),We(m,"CVER",22),this.D&&We(m,"X-HTTP-Session-Id",this.D),tl(this,m),N&&(this.O?f="headers="+encodeURIComponent(String(oR(N)))+"&"+f:this.m&&Ky(m,this.m,N)),Wy(this.h,S),this.Ua&&We(m,"TYPE","init"),this.P?(We(m,"$req",f),We(m,"SID","null"),S.T=!0,Hy(S,m,null)):Hy(S,m,f),this.G=2}}else this.G==3&&(l?pR(this,l):this.i.length==0||KA(this.h)||pR(this))};function pR(l,f){var m;f?m=f.l:m=l.U++;let y=pi(l.I);We(y,"SID",l.K),We(y,"RID",m),We(y,"AID",l.T),tl(l,y),l.m&&l.o&&Ky(y,l.m,l.o),m=new qi(l,l.j,m,l.B+1),l.m===null&&(m.H=l.o),f&&(l.i=f.D.concat(l.i)),f=mR(l,m,1e3),m.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Wy(l.h,m),Hy(m,y,f)}function tl(l,f){l.H&&J(l.H,function(m,y){We(f,y,m)}),l.l&&XA({},function(m,y){We(f,y,m)})}function mR(l,f,m){m=Math.min(l.i.length,m);var y=l.l?p(l.l.Na,l.l,l):null;e:{var S=l.i;let N=-1;for(;;){let $=["count="+m];N==-1?0<m?(N=S[0].g,$.push("ofs="+N)):N=0:$.push("ofs="+N);let Ue=!0;for(let Bt=0;Bt<m;Bt++){let Pe=S[Bt].g,Wt=S[Bt].map;if(Pe-=N,0>Pe)N=Math.max(0,S[Bt].g-100),Ue=!1;else try{nj(Wt,$,"req"+Pe+"_")}catch{y&&y(Wt)}}if(Ue){y=$.join("&");break e}}}return l=l.i.splice(0,m),f.D=l,y}function gR(l){if(!l.g&&!l.u){l.Y=1;var f=l.Fa;Vu||CA(),Uu||(Vu(),Uu=!0),Ay.add(f,l),l.v=0}}function Yy(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=zu(p(l.Fa,l),vR(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,_R(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=zu(p(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,sn(10),df(this),_R(this))};function Jy(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function _R(l){l.g=new qi(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var f=pi(l.qa);We(f,"RID","rpc"),We(f,"SID",l.K),We(f,"AID",l.T),We(f,"CI",l.F?"0":"1"),!l.F&&l.ja&&We(f,"TO",l.ja),We(f,"TYPE","xmlhttp"),tl(l,f),l.m&&l.o&&Ky(f,l.m,l.o),l.L&&(l.g.I=l.L);var m=l.g;l=l.ia,m.L=1,m.v=cf(pi(f)),m.m=null,m.P=!0,qA(m,l)}n.Za=function(){this.C!=null&&(this.C=null,df(this),Yy(this),sn(19))};function ff(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function yR(l,f){var m=null;if(l.g==f){ff(l),Jy(l),l.g=null;var y=2}else if(Gy(l.h,f))m=f.D,YA(l.h,f),y=1;else return;if(l.G!=0){if(f.o)if(y==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var S=l.B;y=tf(),rn(y,new BA(y,m)),hf(l)}else gR(l);else if(S=f.s,S==3||S==0&&0<f.X||!(y==1&&oj(l,f)||y==2&&Yy(l)))switch(m&&0<m.length&&(f=l.h,f.i=f.i.concat(m)),S){case 1:Ys(l,5);break;case 4:Ys(l,10);break;case 3:Ys(l,6);break;default:Ys(l,2)}}}function vR(l,f){let m=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(m*=2),m*f}function Ys(l,f){if(l.j.info("Error code "+f),f==2){var m=p(l.fb,l),y=l.Xa;let S=!y;y=new Qs(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||of(y,"https"),cf(y),S?ZB(y.toString(),m):ej(y.toString(),m)}else sn(2);l.G=0,l.l&&l.l.sa(f),wR(l),fR(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),sn(2)):(this.j.info("Failed to ping google.com"),sn(1))};function wR(l){if(l.G=0,l.ka=[],l.l){let f=JA(l.h);(f.length!=0||l.i.length!=0)&&(A(l.ka,f),A(l.ka,l.i),l.h.i.length=0,C(l.i),l.i.length=0),l.l.ra()}}function IR(l,f,m){var y=m instanceof Qs?pi(m):new Qs(m);if(y.g!="")f&&(y.g=f+"."+y.g),af(y,y.s);else{var S=a.location;y=S.protocol,f=f?f+"."+S.hostname:S.hostname,S=+S.port;var N=new Qs(null);y&&of(N,y),f&&(N.g=f),S&&af(N,S),m&&(N.l=m),y=N}return m=l.D,f=l.ya,m&&f&&We(y,m,f),We(y,"VER",l.la),tl(l,y),y}function ER(l,f,m){if(f&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Ca&&!l.pa?new st(new Ju({eb:m})):new st(l.pa),f.Ha(l.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function TR(){}n=TR.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function pf(){}pf.prototype.g=function(l,f){return new An(l,f)};function An(l,f){Gt.call(this),this.g=new hR(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(l?l["X-WebChannel-Client-Profile"]=f.va:l={"X-WebChannel-Client-Profile":f.va}),this.g.S=l,(l=f&&f.Sb)&&!G(l)&&(this.g.m=l),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!G(f)&&(this.g.D=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new ya(this)}w(An,Gt),An.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},An.prototype.close=function(){Qy(this.g)},An.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var m={};m.__data__=l,l=m}else this.u&&(m={},m.__data__=Fy(l),l=m);f.i.push(new HB(f.Ya++,l)),f.G==3&&hf(f)},An.prototype.N=function(){this.g.l=null,delete this.j,Qy(this.g),delete this.g,An.aa.N.call(this)};function bR(l){Uy.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(let m in f){l=m;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}w(bR,Uy);function CR(){By.call(this),this.status=1}w(CR,By);function ya(l){this.g=l}w(ya,TR),ya.prototype.ua=function(){rn(this.g,"a")},ya.prototype.ta=function(l){rn(this.g,new bR(l))},ya.prototype.sa=function(l){rn(this.g,new CR)},ya.prototype.ra=function(){rn(this.g,"b")},pf.prototype.createWebChannel=pf.prototype.g,An.prototype.send=An.prototype.o,An.prototype.open=An.prototype.m,An.prototype.close=An.prototype.close,Tb=Ni.createWebChannelTransport=function(){return new pf},Eb=Ni.getStatEventTarget=function(){return tf()},Ib=Ni.Event=Ws,ag=Ni.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},nf.NO_ERROR=0,nf.TIMEOUT=8,nf.HTTP_ERROR=6,Dd=Ni.ErrorCode=nf,jA.COMPLETE="complete",wb=Ni.EventType=jA,LA.EventType=Hu,Hu.OPEN="a",Hu.CLOSE="b",Hu.ERROR="c",Hu.MESSAGE="d",Gt.prototype.listen=Gt.prototype.K,Tc=Ni.WebChannel=LA,vb=Ni.FetchXmlHttpFactory=Ju,st.prototype.listenOnce=st.prototype.L,st.prototype.getLastError=st.prototype.Ka,st.prototype.getLastErrorCode=st.prototype.Ba,st.prototype.getStatus=st.prototype.Z,st.prototype.getResponseJson=st.prototype.Oa,st.prototype.getResponseText=st.prototype.oa,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Ha,yb=Ni.XhrIo=st}).apply(typeof og<"u"?og:typeof self<"u"?self:typeof window<"u"?window:{});var KO="@firebase/firestore";var Dt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Dt.UNAUTHENTICATED=new Dt(null),Dt.GOOGLE_CREDENTIALS=new Dt("google-credentials-uid"),Dt.FIRST_PARTY=new Dt("first-party-uid"),Dt.MOCK_USER=new Dt("mock-user");var eu="10.12.1";var bs=new Cn("@firebase/firestore");function Ac(){return bs.logLevel}function Q1(n){bs.setLogLevel(n)}function L(n,...e){if(bs.logLevel<=ge.DEBUG){let t=e.map(D0);bs.debug(`Firestore (${eu}): ${n}`,...t)}}function pt(n,...e){if(bs.logLevel<=ge.ERROR){let t=e.map(D0);bs.error(`Firestore (${eu}): ${n}`,...t)}}function Xn(n,...e){if(bs.logLevel<=ge.WARN){let t=e.map(D0);bs.warn(`Firestore (${eu}): ${n}`,...t)}}function D0(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function Y(n="Unexpected state"){let e=`FIRESTORE (${eu}) INTERNAL ASSERTION FAILED: `+n;throw pt(e),new Error(e)}function Z(n,e){n||Y()}function Y1(n,e){n||Y()}function z(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},k=class extends at{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var St=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var yg=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Ab=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Dt.UNAUTHENTICATED))}shutdown(){}},Rb=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},xb=class{constructor(e){this.t=e,this.currentUser=Dt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new St;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new St,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{L("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(L("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new St)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(L("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Z(typeof r.accessToken=="string"),new yg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return Z(e===null||typeof e=="string"),new Dt(e)}},Nb=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Dt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Pb=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Nb(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Dt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Mb=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},kb=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&L("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,L("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{L("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):L("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Z(typeof t.token=="string"),this.R=t.token,new Mb(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function g8(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var vg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=g8(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function de(n,e){return n<e?-1:n>e?1:0}function Fc(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function J1(n){return n+"\0"}var nt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new k(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?de(this.nanoseconds,e.nanoseconds):de(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var ee=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new nt(0,0))}static max(){return new n(new nt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var wg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&Y(),r===void 0?r=e.length-t:r>e.length-t&&Y(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Re=class n extends wg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new k(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},_8=/^[_a-zA-Z][_a-zA-Z0-9]*$/,mt=class n extends wg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return _8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new k(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new k(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new k(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new k(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var q=class n{constructor(e){this.path=e}static fromPath(e){return new n(Re.fromString(e))}static fromName(e){return new n(Re.fromString(e).popFirst(5))}static empty(){return new n(Re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Re.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Re.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Re(e.slice()))}};var Vc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function Ob(n){return n.fields.find(e=>e.kind===2)}function ko(n){return n.fields.filter(e=>e.kind!==2)}Vc.UNKNOWN_ID=-1;var kc=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Vd=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Zn.min())}};function X1(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ee.fromTimestamp(r===1e9?new nt(t+1,0):new nt(t,r));return new Zn(i,q.empty(),e)}function Z1(n){return new Zn(n.readTime,n.key,-1)}var Zn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(ee.min(),q.empty(),-1)}static max(){return new n(ee.max(),q.empty(),-1)}};function S0(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=q.comparator(n.documentKey,e.documentKey),t!==0?t:de(n.largestBatchId,e.largestBatchId))}var eL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ig=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ks(n){return g(this,null,function*(){if(n.code!==P.FAILED_PRECONDITION||n.message!==eL)throw n;L("LocalStore","Unexpectedly lost primary lease")})}var x=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;t(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var Eg=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new St,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Bo(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=A0(r.target.error);this.V.reject(new Bo(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new Bo(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(L("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new Fb(t)}},Cs=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(je())===12.2&&pt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return L("SimpleDb","Removing database:",e),Oo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!os())return!1;if(n.C())return!0;let e=je(),t=n.S(e),r=0<t&&t<10,i=tL(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return g(this,null,function*(){return this.db||(L("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new Bo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new k(P.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new k(P.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Bo(e,o))},i.onupgradeneeded=s=>{L("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{L("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return g(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=Eg.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),x.reject(u))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,u=c.name!=="FirebaseError"&&o<3;if(L("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function tL(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var Lb=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Oo(this.B.delete())}},Bo=class extends k{constructor(e,t){super(P.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Os(n){return n.name==="IndexedDbTransactionError"}var Fb=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(L("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(L("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Oo(r)}add(e){return L("SimpleDb","ADD",this.store.name,e,e),Oo(this.store.add(e))}get(e){return Oo(this.store.get(e)).next(t=>(t===void 0&&(t=null),L("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return L("SimpleDb","DELETE",this.store.name,e),Oo(this.store.delete(e))}count(){return L("SimpleDb","COUNT",this.store.name),Oo(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new x((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new x((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){L("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new x((r,i)=>{t.onerror=s=>{let o=A0(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new x((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new Lb(a),u=t(a.primaryKey,a.value,c);if(u instanceof x){let d=u.catch(h=>(c.done(),x.reject(h)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>x.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Oo(n){return new x((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=A0(r.target.error);t(i)}})}var QO=!1;function A0(n){let e=Cs.S(je());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return QO||(QO=!0,setTimeout(()=>{throw r},0)),r}}return n}var Vb=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){L("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{L("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){Os(t)?L("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield ks(t)}yield this.X(6e4)}))}},Ub=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return x.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return L("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(L("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=Z1(s);S0(o,r)>0&&(r=o)}),new Zn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var kn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function oh(n){return n==null}function Ud(n){return n===0&&1/n==-1/0}function nL(n){return typeof n=="number"&&Number.isInteger(n)&&!Ud(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function fn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=YO(e)),e=y8(n.get(t),e);return YO(e)}function y8(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function YO(n){return n+""}function Yr(n){let e=n.length;if(Z(e>=2),e===2)return Z(n.charAt(0)===""&&n.charAt(1)===""),Re.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&Y(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:Y()}s=o+2}return new Re(r)}var JO=["userId","batchId"];function hg(n,e){return[n,fn(e)]}function rL(n,e,t){return[n,fn(e),t]}var v8={},w8=["prefixPath","collectionGroup","readTime","documentId"],I8=["prefixPath","collectionGroup","documentId"],E8=["collectionGroup","readTime","prefixPath","documentId"],T8=["canonicalId","targetId"],b8=["targetId","path"],C8=["path","targetId"],D8=["collectionId","parent"],S8=["indexId","uid"],A8=["uid","sequenceNumber"],R8=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],x8=["indexId","uid","orderedDocumentKey"],N8=["userId","collectionPath","documentId"],P8=["userId","collectionPath","largestBatchId"],M8=["userId","collectionGroup","largestBatchId"],iL=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],k8=[...iL,"documentOverlays"],sL=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],oL=sL,aL=[...oL,"indexConfiguration","indexState","indexEntries"],O8=aL;var Bd=class extends Ig{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Ft(n,e){let t=z(n);return Cs.F(t._e,e)}function XO(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Xo(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function cL(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Qe=class n{constructor(e,t){this.comparator=e,this.root=t||Xr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Xr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Mc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Mc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Mc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Mc(this.root,e,this.comparator,!0)}},Mc=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Xr=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Y();let e=this.left.check();if(e!==this.right.check())throw Y();return e+(this.isRed()?0:1)}};Xr.EMPTY=null,Xr.RED=!0,Xr.BLACK=!1;Xr.EMPTY=new class{constructor(){this.size=0}get key(){throw Y()}get value(){throw Y()}get color(){throw Y()}get left(){throw Y()}get right(){throw Y()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Xr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var $e=class n{constructor(e){this.comparator=e,this.data=new Qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Tg(this.data.getIterator())}getIteratorFrom(e){return new Tg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Tg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function bc(n){return n.hasNext()?n.getNext():void 0}var On=class n{constructor(e){this.fields=e,e.sort(mt.comparator)}static empty(){return new n([])}unionWith(e){let t=new $e(mt.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fc(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var bg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function uL(){return typeof atob<"u"}var Lt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new bg("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return de(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Lt.EMPTY_BYTE_STRING=new Lt("");var L8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ki(n){if(Z(!!n),typeof n=="string"){let e=0,t=L8.exec(n);if(Z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:lt(n.seconds),nanos:lt(n.nanos)}}function lt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ds(n){return typeof n=="string"?Lt.fromBase64String(n):Lt.fromUint8Array(n)}function p_(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function R0(n){let e=n.mapValue.fields.__previous_value__;return p_(e)?R0(e):e}function jd(n){let e=ki(n.mapValue.fields.__local_write_time__.timestampValue);return new nt(e.seconds,e.nanos)}var Bb=class{constructor(e,t,r,i,s,o,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},Ss=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Es={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},fg={nullValue:"NULL_VALUE"};function jo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?p_(n)?4:lL(n)?9007199254740991:10:Y()}function ti(n,e){if(n===e)return!0;let t=jo(n);if(t!==jo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return jd(n).isEqual(jd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=ki(i.timestampValue),a=ki(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Ds(i.bytesValue).isEqual(Ds(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return lt(i.geoPointValue.latitude)===lt(s.geoPointValue.latitude)&&lt(i.geoPointValue.longitude)===lt(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return lt(i.integerValue)===lt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=lt(i.doubleValue),a=lt(s.doubleValue);return o===a?Ud(o)===Ud(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Fc(n.arrayValue.values||[],e.arrayValue.values||[],ti);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(XO(o)!==XO(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!ti(o[c],a[c])))return!1;return!0}(n,e);default:return Y()}}function $d(n,e){return(n.values||[]).find(t=>ti(t,e))!==void 0}function As(n,e){if(n===e)return 0;let t=jo(n),r=jo(e);if(t!==r)return de(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return de(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=lt(s.integerValue||s.doubleValue),c=lt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return ZO(n.timestampValue,e.timestampValue);case 4:return ZO(jd(n),jd(e));case 5:return de(n.stringValue,e.stringValue);case 6:return function(s,o){let a=Ds(s),c=Ds(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let d=de(a[u],c[u]);if(d!==0)return d}return de(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=de(lt(s.latitude),lt(o.latitude));return a!==0?a:de(lt(s.longitude),lt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let d=As(a[u],c[u]);if(d)return d}return de(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Es.mapValue&&o===Es.mapValue)return 0;if(s===Es.mapValue)return 1;if(o===Es.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let p=de(c[h],d[h]);if(p!==0)return p;let _=As(a[c[h]],u[d[h]]);if(_!==0)return _}return de(c.length,d.length)}(n.mapValue,e.mapValue);default:throw Y()}}function ZO(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return de(n,e);let t=ki(n),r=ki(e),i=de(t.seconds,r.seconds);return i!==0?i:de(t.nanos,r.nanos)}function Uc(n){return jb(n)}function jb(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=ki(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ds(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return q.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=jb(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${jb(t.fields[o])}`;return i+"}"}(n.mapValue):Y()}function $o(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function $b(n){return!!n&&"integerValue"in n}function Hd(n){return!!n&&"arrayValue"in n}function e1(n){return!!n&&"nullValue"in n}function t1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function pg(n){return!!n&&"mapValue"in n}function Md(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Xo(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Md(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Md(n.arrayValue.values[t]);return e}return Object.assign({},n)}function lL(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function F8(n){return"nullValue"in n?fg:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?$o(Ss.empty(),q.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Y()}function V8(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?$o(Ss.empty(),q.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Es:Y()}function n1(n,e){let t=As(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function r1(n,e){let t=As(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var en=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!pg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Md(t)}setAll(e){let t=mt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Md(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());pg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ti(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];pg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Xo(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Md(this.value))}};function dL(n){let e=[];return Xo(n.fields,(t,r)=>{let i=new mt([t]);if(pg(r)){let s=dL(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new On(e)}var At=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,ee.min(),ee.min(),ee.min(),en.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,ee.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,ee.min(),ee.min(),en.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ee.min(),ee.min(),en.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=en.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=en.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var ni=class{constructor(e,t){this.position=e,this.inclusive=t}};function i1(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=q.comparator(q.fromName(o.referenceValue),t.key):r=As(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function s1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ti(n.position[t],e.position[t]))return!1;return!0}var Ho=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function U8(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Cg=class{},Ie=class n extends Cg{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new zb(e,t,r):t==="array-contains"?new Kb(e,r):t==="in"?new Dg(e,r):t==="not-in"?new Qb(e,r):t==="array-contains-any"?new Yb(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Gb(e,r):new Wb(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(As(t,this.value)):t!==null&&jo(this.value)===jo(t)&&this.matchesComparison(As(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Le=class n extends Cg{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Bc(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Bc(n){return n.op==="and"}function Hb(n){return n.op==="or"}function x0(n){return hL(n)&&Bc(n)}function hL(n){for(let e of n.filters)if(e instanceof Le)return!1;return!0}function qb(n){if(n instanceof Ie)return n.field.canonicalString()+n.op.toString()+Uc(n.value);if(x0(n))return n.filters.map(e=>qb(e)).join(",");{let e=n.filters.map(t=>qb(t)).join(",");return`${n.op}(${e})`}}function fL(n,e){return n instanceof Ie?function(r,i){return i instanceof Ie&&r.op===i.op&&r.field.isEqual(i.field)&&ti(r.value,i.value)}(n,e):n instanceof Le?function(r,i){return i instanceof Le&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&fL(o,i.filters[a]),!0):!1}(n,e):void Y()}function pL(n,e){let t=n.filters.concat(e);return Le.create(t,n.op)}function mL(n){return n instanceof Ie?function(t){return`${t.field.canonicalString()} ${t.op} ${Uc(t.value)}`}(n):n instanceof Le?function(t){return t.op.toString()+" {"+t.getFilters().map(mL).join(" ,")+"}"}(n):"Filter"}var zb=class extends Ie{constructor(e,t,r){super(e,t,r),this.key=q.fromName(r.referenceValue)}matches(e){let t=q.comparator(e.key,this.key);return this.matchesComparison(t)}},Gb=class extends Ie{constructor(e,t){super(e,"in",t),this.keys=gL("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Wb=class extends Ie{constructor(e,t){super(e,"not-in",t),this.keys=gL("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function gL(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>q.fromName(r.referenceValue))}var Kb=class extends Ie{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Hd(t)&&$d(t.arrayValue,this.value)}},Dg=class extends Ie{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&$d(this.value.arrayValue,t)}},Qb=class extends Ie{constructor(e,t){super(e,"not-in",t)}matches(e){if($d(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!$d(this.value.arrayValue,t)}},Yb=class extends Ie{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Hd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>$d(this.value.arrayValue,r))}};var Jb=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function Xb(n,e=null,t=[],r=[],i=null,s=null,o=null){return new Jb(n,e,t,r,i,s,o)}function qo(n){let e=z(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>qb(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),oh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Uc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Uc(r)).join(",")),e.ue=t}return e.ue}function ah(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!U8(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!fL(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!s1(n.startAt,e.startAt)&&s1(n.endAt,e.endAt)}function Sg(n){return q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ag(n,e){return n.filters.filter(t=>t instanceof Ie&&t.field.isEqual(e))}function o1(n,e,t){let r=fg,i=!0;for(let s of Ag(n,e)){let o=fg,a=!0;switch(s.op){case"<":case"<=":o=F8(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=fg}n1({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];n1({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function a1(n,e,t){let r=Es,i=!0;for(let s of Ag(n,e)){let o=Es,a=!0;switch(s.op){case">=":case">":o=V8(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Es}r1({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];r1({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var vr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function _L(n,e,t,r,i,s,o,a){return new vr(n,e,t,r,i,s,o,a)}function tu(n){return new vr(n)}function c1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function N0(n){return n.collectionGroup!==null}function Oc(n){let e=z(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new $e(mt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Ho(s,r))}),t.has(mt.keyField().canonicalString())||e.ce.push(new Ho(mt.keyField(),r))}return e.ce}function pn(n){let e=z(n);return e.le||(e.le=B8(e,Oc(n))),e.le}function B8(n,e){if(n.limitType==="F")return Xb(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Ho(i.field,s)});let t=n.endAt?new ni(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ni(n.startAt.position,n.startAt.inclusive):null;return Xb(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Zb(n,e){let t=n.filters.concat([e]);return new vr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Rg(n,e,t){return new vr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ch(n,e){return ah(pn(n),pn(e))&&n.limitType===e.limitType}function yL(n){return`${qo(pn(n))}|lt:${n.limitType}`}function Rc(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>mL(i)).join(", ")}]`),oh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Uc(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Uc(i)).join(",")),`Target(${r})`}(pn(n))}; limitType=${n.limitType})`}function uh(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):q.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of Oc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=i1(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,Oc(r),i)||r.endAt&&!function(o,a,c){let u=i1(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,Oc(r),i))}(n,e)}function vL(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wL(n){return(e,t)=>{let r=!1;for(let i of Oc(n)){let s=j8(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function j8(n,e,t){let r=n.field.isKeyField()?q.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?As(c,u):Y()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Y()}}var ri=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Xo(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return cL(this.inner)}size(){return this.innerSize}};var $8=new Qe(q.comparator);function Sn(){return $8}var IL=new Qe(q.comparator);function Nd(...n){let e=IL;for(let t of n)e=e.insert(t.key,t);return e}function EL(n){let e=IL;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Jr(){return kd()}function TL(){return kd()}function kd(){return new ri(n=>n.toString(),(n,e)=>n.isEqual(e))}var H8=new Qe(q.comparator),q8=new $e(q.comparator);function pe(...n){let e=q8;for(let t of n)e=e.add(t);return e}var z8=new $e(de);function P0(){return z8}function bL(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ud(e)?"-0":e}}function CL(n){return{integerValue:""+n}}function DL(n,e){return nL(e)?CL(e):bL(n,e)}var jc=class{constructor(){this._=void 0}};function G8(n,e,t){return n instanceof Rs?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&p_(s)&&(s=R0(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Oi?AL(n,e):n instanceof Li?RL(n,e):function(i,s){let o=SL(i,s),a=u1(o)+u1(i.Pe);return $b(o)&&$b(i.Pe)?CL(a):bL(i.serializer,a)}(n,e)}function W8(n,e,t){return n instanceof Oi?AL(n,e):n instanceof Li?RL(n,e):t}function SL(n,e){return n instanceof xs?function(r){return $b(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Rs=class extends jc{},Oi=class extends jc{constructor(e){super(),this.elements=e}};function AL(n,e){let t=xL(e);for(let r of n.elements)t.some(i=>ti(i,r))||t.push(r);return{arrayValue:{values:t}}}var Li=class extends jc{constructor(e){super(),this.elements=e}};function RL(n,e){let t=xL(e);for(let r of n.elements)t=t.filter(i=>!ti(i,r));return{arrayValue:{values:t}}}var xs=class extends jc{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function u1(n){return lt(n.integerValue||n.doubleValue)}function xL(n){return Hd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var zo=class{constructor(e,t){this.field=e,this.transform=t}};function K8(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Oi&&i instanceof Oi||r instanceof Li&&i instanceof Li?Fc(r.elements,i.elements,ti):r instanceof xs&&i instanceof xs?ti(r.Pe,i.Pe):r instanceof Rs&&i instanceof Rs}(n.transform,e.transform)}var eC=class{constructor(e,t){this.version=e,this.transformResults=t}},dt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function mg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var $c=class{};function NL(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ps(n.key,dt.none()):new Ns(n.key,n.data,dt.none());{let t=n.data,r=en.empty(),i=new $e(mt.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new wr(n.key,r,new On(i.toArray()),dt.none())}}function Q8(n,e,t){n instanceof Ns?function(i,s,o){let a=i.value.clone(),c=d1(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof wr?function(i,s,o){if(!mg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=d1(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(PL(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Od(n,e,t,r){return n instanceof Ns?function(s,o,a,c){if(!mg(s.precondition,o))return a;let u=s.value.clone(),d=h1(s.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof wr?function(s,o,a,c){if(!mg(s.precondition,o))return a;let u=h1(s.fieldTransforms,c,o),d=o.data;return d.setAll(PL(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return mg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function Y8(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=SL(r.transform,i||null);s!=null&&(t===null&&(t=en.empty()),t.set(r.field,s))}return t||null}function l1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Fc(r,i,(s,o)=>K8(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Ns=class extends $c{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},wr=class extends $c{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function PL(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function d1(n,e,t){let r=new Map;Z(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,W8(o,a,t[i]))}return r}function h1(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,G8(s,o,e))}return r}var Ps=class extends $c{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},qd=class extends $c{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var zd=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&Q8(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Od(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Od(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=TL();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=NL(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(ee.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),pe())}isEqual(e){return this.batchId===e.batchId&&Fc(this.mutations,e.mutations,(t,r)=>l1(t,r))&&Fc(this.baseMutations,e.baseMutations,(t,r)=>l1(t,r))}},tC=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Z(e.mutations.length===r.length);let i=function(){return H8}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Gd=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var nC=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var bt,Ae;function ML(n){switch(n){default:return Y();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function kL(n){if(n===void 0)return pt("GRPC error has no .code"),P.UNKNOWN;switch(n){case bt.OK:return P.OK;case bt.CANCELLED:return P.CANCELLED;case bt.UNKNOWN:return P.UNKNOWN;case bt.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case bt.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case bt.INTERNAL:return P.INTERNAL;case bt.UNAVAILABLE:return P.UNAVAILABLE;case bt.UNAUTHENTICATED:return P.UNAUTHENTICATED;case bt.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case bt.NOT_FOUND:return P.NOT_FOUND;case bt.ALREADY_EXISTS:return P.ALREADY_EXISTS;case bt.PERMISSION_DENIED:return P.PERMISSION_DENIED;case bt.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case bt.ABORTED:return P.ABORTED;case bt.OUT_OF_RANGE:return P.OUT_OF_RANGE;case bt.UNIMPLEMENTED:return P.UNIMPLEMENTED;case bt.DATA_LOSS:return P.DATA_LOSS;default:return Y()}}(Ae=bt||(bt={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";var f1=null;function OL(){return new TextEncoder}var J8=new _s([4294967295,4294967295],0);function p1(n){let e=OL().encode(n),t=new _b;return t.update(e),new Uint8Array(t.digest())}function m1(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new _s([t,r],0),new _s([i,s],0)]}var rC=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Uo(`Invalid padding: ${t}`);if(r<0)throw new Uo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Uo(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Uo(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=_s.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(_s.fromNumber(r)));return i.compare(J8)===1&&(i=new _s([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=p1(e),[r,i]=m1(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=p1(e),[r,i]=m1(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Uo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Wd=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Kd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(ee.min(),i,new Qe(de),Sn(),pe())}},Kd=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,pe(),pe(),pe())}};var Lc=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},xg=class{constructor(e,t){this.targetId=e,this.me=t}},Ng=class{constructor(e,t,r=Lt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Pg=class{constructor(){this.fe=0,this.ge=_1(),this.pe=Lt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=pe(),t=pe(),r=pe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Y()}}),new Kd(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=_1()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},iC=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Sn(),this.qe=g1(),this.Qe=new Qe(de)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Y()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(Sg(s))if(r===0){let o=new q(s.path);this.Ue(t,o,At.newNoDocument(o,ee.min()))}else Z(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}f1?.et(function(d,h,p,_,w){var C,A,F,G,U,Q;let se={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},J=h.unchangedNames;return J&&(se.bloomFilter={applied:w===0,hashCount:(C=J?.hashCount)!==null&&C!==void 0?C:0,bitmapLength:(G=(F=(A=J?.bits)===null||A===void 0?void 0:A.bitmap)===null||F===void 0?void 0:F.length)!==null&&G!==void 0?G:0,padding:(Q=(U=J?.bits)===null||U===void 0?void 0:U.padding)!==null&&Q!==void 0?Q:0,mightContain:T=>{var v;return(v=_?.mightContain(T))!==null&&v!==void 0&&v}}),se}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=Ds(r).toUint8Array()}catch(c){if(c instanceof bg)return Xn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new rC(o,i,s)}catch(c){return Xn(c instanceof Uo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&Sg(a.target)){let c=new q(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,At.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let r=pe();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Wd(e,t,this.Qe,this.ke,r);return this.ke=Sn(),this.qe=g1(),this.Qe=new Qe(de),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Pg,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new $e(de),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||L("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Pg),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function g1(){return new Qe(q.comparator)}function _1(){return new Qe(q.comparator)}var X8={asc:"ASCENDING",desc:"DESCENDING"},Z8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eK={and:"AND",or:"OR"},sC=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function oC(n,e){return n.useProto3Json||oh(e)?e:{value:e}}function Hc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function LL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function tK(n,e){return Hc(n,e.toTimestamp())}function gt(n){return Z(!!n),ee.fromTimestamp(function(t){let r=ki(t);return new nt(r.seconds,r.nanos)}(n))}function M0(n,e){return aC(n,e).canonicalString()}function aC(n,e){let t=function(i){return new Re(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function FL(n){let e=Re.fromString(n);return Z(WL(e)),e}function Qd(n,e){return M0(n.databaseId,e.path)}function Zr(n,e){let t=FL(e);if(t.get(1)!==n.databaseId.projectId)throw new k(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new k(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new q(BL(t))}function VL(n,e){return M0(n.databaseId,e)}function UL(n){let e=FL(n);return e.length===4?Re.emptyPath():BL(e)}function cC(n){return new Re(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function BL(n){return Z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function y1(n,e,t){return{name:Qd(n,e),fields:t.value.mapValue.fields}}function jL(n,e,t){let r=Zr(n,e.name),i=gt(e.updateTime),s=e.createTime?gt(e.createTime):ee.min(),o=new en({mapValue:{fields:e.fields}}),a=At.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function nK(n,e){return"found"in e?function(r,i){Z(!!i.found),i.found.name,i.found.updateTime;let s=Zr(r,i.found.name),o=gt(i.found.updateTime),a=i.found.createTime?gt(i.found.createTime):ee.min(),c=new en({mapValue:{fields:i.found.fields}});return At.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){Z(!!i.missing),Z(!!i.readTime);let s=Zr(r,i.missing),o=gt(i.readTime);return At.newNoDocument(s,o)}(n,e):Y()}function rK(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Y()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(Z(d===void 0||typeof d=="string"),Lt.fromBase64String(d||"")):(Z(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Lt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let d=u.code===void 0?P.UNKNOWN:kL(u.code);return new k(d,u.message||"")}(o);t=new Ng(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Zr(n,r.document.name),s=gt(r.document.updateTime),o=r.document.createTime?gt(r.document.createTime):ee.min(),a=new en({mapValue:{fields:r.document.fields}}),c=At.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new Lc(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Zr(n,r.document),s=r.readTime?gt(r.readTime):ee.min(),o=At.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Lc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Zr(n,r.document),s=r.removedTargetIds||[];t=new Lc([],s,i,null)}else{if(!("filter"in e))return Y();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new nC(i,s),a=r.targetId;t=new xg(a,o)}}return t}function Yd(n,e){let t;if(e instanceof Ns)t={update:y1(n,e.key,e.value)};else if(e instanceof Ps)t={delete:Qd(n,e.key)};else if(e instanceof wr)t={update:y1(n,e.key,e.data),updateMask:uK(e.fieldMask)};else{if(!(e instanceof qd))return Y();t={verify:Qd(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Rs)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Oi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Li)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof xs)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Y()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:tK(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Y()}(n,e.precondition)),t}function uC(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?dt.updateTime(gt(s.updateTime)):s.exists!==void 0?dt.exists(s.exists):dt.none()}(e.currentDocument):dt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)Z(a.setToServerValue==="REQUEST_TIME"),c=new Rs;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new Oi(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new Li(d)}else"increment"in a?c=new xs(o,a.increment):Y();let u=mt.fromServerFormat(a.fieldPath);return new zo(u,c)}(n,i)):[];if(e.update){e.update.name;let i=Zr(n,e.update.name),s=new en({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let u=c.fieldPaths||[];return new On(u.map(d=>mt.fromServerFormat(d)))}(e.updateMask);return new wr(i,s,o,t,r)}return new Ns(i,s,t,r)}if(e.delete){let i=Zr(n,e.delete);return new Ps(i,t)}if(e.verify){let i=Zr(n,e.verify);return new qd(i,t)}return Y()}function iK(n,e){return n&&n.length>0?(Z(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?gt(i.updateTime):gt(s);return o.isEqual(ee.min())&&(o=gt(s)),new eC(o,i.transformResults||[])}(t,e))):[]}function $L(n,e){return{documents:[VL(n,e.path)]}}function HL(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=VL(n,i);let s=function(u){if(u.length!==0)return GL(Le.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:xc(p.field),direction:oK(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=oC(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:i}}function qL(n){let e=UL(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Z(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let p=zL(h);return p instanceof Le&&x0(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(p=>function(w){return new Ho(Nc(w.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,oh(p)?null:p}(t.limit));let c=null;t.startAt&&(c=function(h){let p=!!h.before,_=h.values||[];return new ni(_,p)}(t.startAt));let u=null;return t.endAt&&(u=function(h){let p=!h.before,_=h.values||[];return new ni(_,p)}(t.endAt)),_L(e,i,o,s,a,"F",c,u)}function sK(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function zL(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Nc(t.unaryFilter.field);return Ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Nc(t.unaryFilter.field);return Ie.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Nc(t.unaryFilter.field);return Ie.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Nc(t.unaryFilter.field);return Ie.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Y()}}(n):n.fieldFilter!==void 0?function(t){return Ie.create(Nc(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Y()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Le.create(t.compositeFilter.filters.map(r=>zL(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Y()}}(t.compositeFilter.op))}(n):Y()}function oK(n){return X8[n]}function aK(n){return Z8[n]}function cK(n){return eK[n]}function xc(n){return{fieldPath:n.canonicalString()}}function Nc(n){return mt.fromServerFormat(n.fieldPath)}function GL(n){return n instanceof Ie?function(t){if(t.op==="=="){if(t1(t.value))return{unaryFilter:{field:xc(t.field),op:"IS_NAN"}};if(e1(t.value))return{unaryFilter:{field:xc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(t1(t.value))return{unaryFilter:{field:xc(t.field),op:"IS_NOT_NAN"}};if(e1(t.value))return{unaryFilter:{field:xc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xc(t.field),op:aK(t.op),value:t.value}}}(n):n instanceof Le?function(t){let r=t.getFilters().map(i=>GL(i));return r.length===1?r[0]:{compositeFilter:{op:cK(t.op),filters:r}}}(n):Y()}function uK(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function WL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var qc=class n{constructor(e,t,r,i,s=ee.min(),o=ee.min(),a=Lt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Mg=class{constructor(e){this.ct=e}};function lK(n,e){let t;if(e.document)t=jL(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=q.fromSegments(e.noDocument.path),i=Wo(e.noDocument.readTime);t=At.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Y();{let r=q.fromSegments(e.unknownDocument.path),i=Wo(e.unknownDocument.version);t=At.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new nt(i[0],i[1]);return ee.fromTimestamp(s)}(e.readTime)),t}function v1(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:kg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Qd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Hc(s,o.version.toTimestamp()),createTime:Hc(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Go(e.version)};else{if(!e.isUnknownDocument())return Y();r.unknownDocument={path:t.path.toArray(),version:Go(e.version)}}return r}function kg(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Go(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Wo(n){let e=new nt(n.seconds,n.nanoseconds);return ee.fromTimestamp(e)}function Lo(n,e){let t=(e.baseMutations||[]).map(s=>uC(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>uC(n.ct,s)),i=nt.fromMillis(e.localWriteTimeMs);return new zd(e.batchId,i,t,r)}function Pd(n){let e=Wo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Wo(n.lastLimboFreeSnapshotVersion):ee.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return Z(s.documents.length===1),pn(tu(UL(s.documents[0])))}(n.query):function(s){return pn(qL(s))}(n.query),new qc(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Lt.fromBase64String(n.resumeToken))}function KL(n,e){let t=Go(e.snapshotVersion),r=Go(e.lastLimboFreeSnapshotVersion),i;i=Sg(e.target)?$L(n.ct,e.target):HL(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:qo(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function k0(n){let e=qL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Rg(e,e.limit,"L"):e}function bb(n,e){return new Gd(e.largestBatchId,uC(n.ct,e.overlayMutation))}function w1(n,e){let t=e.path.lastSegment();return[n,fn(e.path.popLast()),t]}function I1(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Go(r.readTime),documentKey:fn(r.documentKey.path),largestBatchId:r.largestBatchId}}var lC=class{getBundleMetadata(e,t){return E1(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Wo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return E1(e).put(function(i){return{bundleId:i.id,createTime:Go(gt(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return T1(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:k0(s.bundledQuery),readTime:Wo(s.readTime)}}(r)})}saveNamedQuery(e,t){return T1(e).put(function(i){return{name:i.name,readTime:Go(gt(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function E1(n){return Ft(n,"bundles")}function T1(n){return Ft(n,"namedQueries")}var Og=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Sd(e).get(w1(this.userId,t)).next(r=>r?bb(this.serializer,r):null)}getOverlays(e,t){let r=Jr();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new Gd(t,o);i.push(this.ht(e,a))}),x.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(fn(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Sd(e).j("collectionPathOverlayIndex",a))}),x.waitFor(s)}getOverlaysForCollection(e,t,r){let i=Jr(),s=fn(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Sd(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let u=bb(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=Jr(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Sd(e).J({index:"collectionGroupOverlayIndex",range:a},(c,u,d)=>{let h=bb(this.serializer,u);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return Sd(e).put(function(i,s,o){let[a,c,u]=w1(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Yd(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function Sd(n){return Ft(n,"documentOverlays")}var Pi=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(lt(e.integerValue));else if("doubleValue"in e){let r=lt(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),Ud(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=ki(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Ds(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?lL(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):Y()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),q.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};Pi.bt=new Pi;function dK(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function b1(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=dK(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var dC=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ct(r.value),r=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Mt(r.value),r=t.next();this.xt()}Ot(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let t=this.Bt(e),r=b1(t);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){let t=this.Bt(e),r=b1(t);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},hC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},fC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Fo=class{constructor(){this.Gt=new dC,this.zt=new hC(this.Gt),this.jt=new fC(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Vo=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function ys(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=C1(n.arrayValue,e.arrayValue),t!==0?t:(t=C1(n.directionalValue,e.directionalValue),t!==0?t:q.comparator(n.documentKey,e.documentKey)))}function C1(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Lg=class{constructor(e){this.Yt=new $e((t,r)=>mt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let r=t;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(Z(e.collectionGroup===this.collectionId),this.en)return!1;let t=Ob(e);if(t!==void 0&&!this.nn(t))return!1;let r=ko(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new $e(mt.comparator),t=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new kc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new kc(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new kc(r.field,r.dir==="asc"?0:1)));return new Vc(Vc.UNKNOWN_ID,this.collectionId,t,Vd.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function QL(n){var e,t;if(Z(n instanceof Ie||n instanceof Le),n instanceof Ie){if(n instanceof Dg){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Ie.create(n.field,"==",s)))||[];return Le.create(i,"or")}return n}let r=n.filters.map(i=>QL(i));return Le.create(r,n.op)}function hK(n){if(n.getFilters().length===0)return[];let e=gC(QL(n));return Z(YL(e)),pC(e)||mC(e)?[e]:e.getFilters()}function pC(n){return n instanceof Ie}function mC(n){return n instanceof Le&&x0(n)}function YL(n){return pC(n)||mC(n)||function(t){if(t instanceof Le&&Hb(t)){for(let r of t.getFilters())if(!pC(r)&&!mC(r))return!1;return!0}return!1}(n)}function gC(n){if(Z(n instanceof Ie||n instanceof Le),n instanceof Ie)return n;if(n.filters.length===1)return gC(n.filters[0]);let e=n.filters.map(r=>gC(r)),t=Le.create(e,n.op);return t=Fg(t),YL(t)?t:(Z(t instanceof Le),Z(Bc(t)),Z(t.filters.length>1),t.filters.reduce((r,i)=>O0(r,i)))}function O0(n,e){let t;return Z(n instanceof Ie||n instanceof Le),Z(e instanceof Ie||e instanceof Le),t=n instanceof Ie?e instanceof Ie?function(i,s){return Le.create([i,s],"and")}(n,e):D1(n,e):e instanceof Ie?D1(e,n):function(i,s){if(Z(i.filters.length>0&&s.filters.length>0),Bc(i)&&Bc(s))return pL(i,s.getFilters());let o=Hb(i)?i:s,a=Hb(i)?s:i,c=o.filters.map(u=>O0(u,a));return Le.create(c,"or")}(n,e),Fg(t)}function D1(n,e){if(Bc(e))return pL(e,n.getFilters());{let t=e.filters.map(r=>O0(n,r));return Le.create(t,"or")}}function Fg(n){if(Z(n instanceof Ie||n instanceof Le),n instanceof Ie)return n;let e=n.getFilters();if(e.length===1)return Fg(e[0]);if(hL(n))return n;let t=e.map(i=>Fg(i)),r=[];return t.forEach(i=>{i instanceof Ie?r.push(i):i instanceof Le&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Le.create(r,n.op)}var _C=class{constructor(){this._n=new Jd}addToCollectionParentIndex(e,t){return this._n.add(t),x.resolve()}getCollectionParents(e,t){return x.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return x.resolve()}deleteFieldIndex(e,t){return x.resolve()}deleteAllFieldIndexes(e){return x.resolve()}createTargetIndexes(e,t){return x.resolve()}getDocumentsMatchingTarget(e,t){return x.resolve(null)}getIndexType(e,t){return x.resolve(0)}getFieldIndexes(e,t){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,t){return x.resolve(Zn.min())}getMinOffsetFromCollectionGroup(e,t){return x.resolve(Zn.min())}updateCollectionGroup(e,t,r){return x.resolve()}updateIndexEntries(e,t){return x.resolve()}},Jd=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new $e(Re.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new $e(Re.comparator)).toArray()}};var cg=new Uint8Array(0),yC=class{constructor(e,t){this.databaseId=t,this.an=new Jd,this.un=new ri(r=>qo(r),(r,i)=>ah(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:r,parent:fn(i)};return S1(e).put(s)}return x.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[J1(t),""],!1,!0);return S1(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(Yr(o.parent))}return r})}addFieldIndex(e,t){let r=Ad(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=Dc(e);return s.next(a=>{o.put(I1(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=Ad(e),i=Dc(e),s=Cc(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Ad(e),r=Cc(e),i=Dc(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return x.forEach(this.cn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Lg(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=Cc(e),i=!0,s=new Map;return x.forEach(this.cn(t),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=pe(),a=[];return x.forEach(s,(c,u)=>{L("IndexedDbIndexManager",`Using index ${function(U){return`id=${U.indexId}|cg=${U.collectionGroup}|f=${U.fields.map(Q=>`${Q.fieldPath}:${Q.kind}`).join(",")}`}(c)} to execute ${qo(t)}`);let d=function(U,Q){let se=Ob(Q);if(se===void 0)return null;for(let J of Ag(U,se.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null}(u,c),h=function(U,Q){let se=new Map;for(let J of ko(Q))for(let T of Ag(U,J.fieldPath))switch(T.op){case"==":case"in":se.set(J.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return se.set(J.fieldPath.canonicalString(),T.value),Array.from(se.values())}return null}(u,c),p=function(U,Q){let se=[],J=!0;for(let T of ko(Q)){let v=T.kind===0?o1(U,T.fieldPath,U.startAt):a1(U,T.fieldPath,U.startAt);se.push(v.value),J&&(J=v.inclusive)}return new ni(se,J)}(u,c),_=function(U,Q){let se=[],J=!0;for(let T of ko(Q)){let v=T.kind===0?a1(U,T.fieldPath,U.endAt):o1(U,T.fieldPath,U.endAt);se.push(v.value),J&&(J=v.inclusive)}return new ni(se,J)}(u,c),w=this.hn(c,u,p),C=this.hn(c,u,_),A=this.Pn(c,u,h),F=this.In(c.indexId,d,w,p.inclusive,C,_.inclusive,A);return x.forEach(F,G=>r.G(G,t.limit).next(U=>{U.forEach(Q=>{let se=q.fromSegments(Q.documentKey);o.has(se)||(o=o.add(se),a.push(se))})}))}).next(()=>a)}return x.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=hK(Le.create(e.filters,"and")).map(r=>Xb(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),u=c/(t!=null?t.length:1),d=[];for(let h=0;h<c;++h){let p=t?this.Tn(t[h/u]):cg,_=this.En(e,p,r[h%u],i),w=this.dn(e,p,s[h%u],o),C=a.map(A=>this.En(e,p,A,!0));d.push(...this.createRange(_,w,C))}return d}En(e,t,r,i){let s=new Vo(e,q.empty(),t,r);return i?s:s.Jt()}dn(e,t,r,i){let s=new Vo(e,q.empty(),t,r);return i?s.Jt():s}ln(e,t){let r=new Lg(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.cn(t);return x.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new $e(mt.comparator),d=!1;for(let h of c.filters)for(let p of h.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?d=!0:u=u.add(p.field));for(let h of c.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}An(e,t){let r=new Fo;for(let i of ko(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Pi.bt.Pt(s,o)}return r.Wt()}Tn(e){let t=new Fo;return Pi.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let r=new Fo;return Pi.bt.Pt($o(this.databaseId,t),r.Ht(function(s){let o=ko(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,t,r){if(r===null)return[];let i=[];i.push(new Fo);let s=0;for(let o of ko(e)){let a=r[s++];for(let c of i)if(this.Vn(t,o.fieldPath)&&Hd(a))i=this.mn(i,o,a);else{let u=c.Ht(o.kind);Pi.bt.Pt(a,u)}}return this.fn(i)}hn(e,t,r){return this.Pn(e,t,r.position)}fn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Wt();return t}mn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new Fo;c.seed(a.Wt()),Pi.bt.Pt(o,c.Ht(t.kind)),s.push(c)}return s}Vn(e,t){return!!e.filters.find(r=>r instanceof Ie&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Ad(e),i=Dc(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return x.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,h){let p=h?new Vd(h.sequenceNumber,new Zn(Wo(h.readTime),new q(Yr(h.documentKey)),h.largestBatchId)):Vd.empty(),_=d.fields.map(([w,C])=>new kc(mt.fromServerFormat(w),C));return new Vc(d.indexId,d.collectionGroup,_,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:de(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Ad(e),s=Dc(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>x.forEach(a,c=>s.put(I1(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return x.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?x.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),x.forEach(a,c=>this.pn(e,i,c).next(u=>{let d=this.yn(s,c);return u.isEqual(d)?x.resolve():this.wn(e,s,c,u,d)}))))})}Sn(e,t,r,i){return Cc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,t.key),documentKey:t.key.path.toArray()})}bn(e,t,r,i){return Cc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,t.key),t.key.path.toArray()])}pn(e,t,r){let i=Cc(e),s=new $e(ys);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,t)])},(o,a)=>{s=s.add(new Vo(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,t){let r=new $e(ys),i=this.An(t,e);if(i==null)return r;let s=Ob(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Hd(o))for(let a of o.arrayValue.values||[])r=r.add(new Vo(t.indexId,e.key,this.Tn(a),i))}else r=r.add(new Vo(t.indexId,e.key,cg,i));return r}wn(e,t,r,i,s){L("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,u,d,h,p){let _=c.getIterator(),w=u.getIterator(),C=bc(_),A=bc(w);for(;C||A;){let F=!1,G=!1;if(C&&A){let U=d(C,A);U<0?G=!0:U>0&&(F=!0)}else C!=null?G=!0:F=!0;F?(h(A),A=bc(w)):G?(p(C),C=bc(_)):(C=bc(_),A=bc(w))}}(i,s,ys,a=>{o.push(this.Sn(e,t,r,a))},a=>{o.push(this.bn(e,t,r,a))}),x.waitFor(o)}gn(e){let t=1;return Dc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>ys(o,a)).filter((o,a,c)=>!a||ys(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=ys(o,e),c=ys(o,t);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,cg,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,cg,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,t){return ys(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(A1)}getMinOffset(e,t){return x.mapArray(this.cn(t),r=>this.ln(e,r).next(i=>i||Y())).next(A1)}};function S1(n){return Ft(n,"collectionParents")}function Cc(n){return Ft(n,"indexEntries")}function Ad(n){return Ft(n,"indexConfiguration")}function Dc(n){return Ft(n,"indexState")}function A1(n){Z(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;S0(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Zn(e.readTime,e.documentKey,t)}var R1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Jn=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function JL(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,h,p)=>(a++,p.delete()));s.push(c.next(()=>{Z(a===1)}));let u=[];for(let d of t.mutations){let h=rL(e,d.key.path,t.batchId);s.push(i.delete(h)),u.push(d.key)}return x.waitFor(s).next(()=>u)}function Vg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Y();e=n.noDocument}return JSON.stringify(e).length}Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn(41943040,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);var Ug=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,t,r,i){Z(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return vs(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=Pc(e),o=vs(e);return o.add({}).next(a=>{Z(typeof a=="number");let c=new zd(a,t,r,i),u=function(_,w,C){let A=C.baseMutations.map(G=>Yd(_.ct,G)),F=C.mutations.map(G=>Yd(_.ct,G));return{userId:w,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:A,mutations:F}}(this.serializer,this.userId,c),d=[],h=new $e((p,_)=>de(p.canonicalString(),_.canonicalString()));for(let p of i){let _=rL(this.userId,p.key.path,a);h=h.add(p.key.path.popLast()),d.push(o.put(u)),d.push(s.put(_,v8))}return h.forEach(p=>{d.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),x.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return vs(e).get(t).next(r=>r?(Z(r.userId===this.userId),Lo(this.serializer,r)):null)}vn(e,t){return this.Cn[t]?x.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return vs(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(Z(a.batchId>=r),s=Lo(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return vs(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return vs(e).U("userMutationsIndex",t).next(r=>r.map(i=>Lo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=hg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Pc(e).J({range:i},(o,a,c)=>{let[u,d,h]=o,p=Yr(d);if(u===this.userId&&t.path.isEqual(p))return vs(e).get(h).next(_=>{if(!_)throw Y();Z(_.userId===this.userId),s.push(Lo(this.serializer,_))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new $e(de),i=[];return t.forEach(s=>{let o=hg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Pc(e).J({range:a},(u,d,h)=>{let[p,_,w]=u,C=Yr(_);p===this.userId&&s.path.isEqual(C)?r=r.add(w):h.done()});i.push(c)}),x.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=hg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new $e(de);return Pc(e).J({range:o},(c,u,d)=>{let[h,p,_]=c,w=Yr(p);h===this.userId&&r.isPrefixOf(w)?w.length===i&&(a=a.add(_)):d.done()}).next(()=>this.Fn(e,a))}Fn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(vs(e).get(s).next(o=>{if(o===null)throw Y();Z(o.userId===this.userId),r.push(Lo(this.serializer,o))}))}),x.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return JL(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),x.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return x.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Pc(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=Yr(s[1]);i.push(c)}else a.done()}).next(()=>{Z(i.length===0)})})}containsKey(e,t){return XL(e,this.userId,t)}xn(e){return ZL(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function XL(n,e,t){let r=hg(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Pc(n).J({range:s,H:!0},(a,c,u)=>{let[d,h,p]=a;d===e&&h===i&&(o=!0),u.done()}).next(()=>o)}function vs(n){return Ft(n,"mutations")}function Pc(n){return Ft(n,"documentMutations")}function ZL(n){return Ft(n,"mutationQueues")}var zc=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var vC=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let r=new zc(t.highestTargetId);return t.highestTargetId=r.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>ee.fromTimestamp(new nt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(t,r),this.kn(e,r))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Sc(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(Z(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return Sc(e).J((o,a)=>{let c=Pd(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>x.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Sc(e).J((r,i)=>{let s=Pd(i);t(s)})}Bn(e){return x1(e).get("targetGlobalKey").next(t=>(Z(t!==null),t))}kn(e,t){return x1(e).put("targetGlobalKey",t)}qn(e,t){return Sc(e).put(KL(this.serializer,t))}Qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=qo(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Sc(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let u=Pd(a);ah(t,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=ws(e);return t.forEach(o=>{let a=fn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),x.waitFor(i)}removeMatchingKeys(e,t,r){let i=ws(e);return x.forEach(t,s=>{let o=fn(s.path);return x.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=ws(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=ws(e),s=pe();return i.J({range:r,H:!0},(o,a,c)=>{let u=Yr(o[1]),d=new q(u);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=fn(t.path),i=IDBKeyRange.bound([r],[J1(r)],!1,!0),s=0;return ws(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,t){return Sc(e).get(t).next(r=>r?Pd(r):null)}};function Sc(n){return Ft(n,"targets")}function x1(n){return Ft(n,"targetGlobal")}function ws(n){return Ft(n,"targetDocuments")}function N1([n,e],[t,r]){let i=de(n,t);return i===0?de(e,r):i}var wC=class{constructor(e){this.Kn=e,this.buffer=new $e(N1),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();N1(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},IC=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){L("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Os(t)?L("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield ks(t)}yield this.zn(3e5)}))}},EC=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return x.resolve(kn.oe);let r=new wC(t);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(L("LruGarbageCollector","Garbage collection skipped; disabled"),x.resolve(R1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(L("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),R1):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let r,i,s,o,a,c,u,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(L("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),Ac()<=ge.DEBUG&&L("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),x.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function fK(n,e){return new EC(n,e)}var TC=class{constructor(e,t){this.db=e,this.garbageCollector=fK(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Zn(e){let t=0;return this.Jn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(r,i)=>t(i))}addReference(e,t,r){return ug(e,r)}removeReference(e,t,r){return ug(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return ug(e,t)}er(e,t){return function(i,s){let o=!1;return ZL(i).Y(a=>XL(i,a,s).next(c=>(c&&(o=!0),x.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=t){let c=this.er(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ee.min()),ws(e).delete(function(h){return[0,fn(h.path)]}(o))))});i.push(c)}}).next(()=>x.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return ug(e,t)}Xn(e,t){let r=ws(e),i,s=kn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==kn.oe&&t(new q(Yr(i)),s),s=u,i=c):s=kn.oe}).next(()=>{s!==kn.oe&&t(new q(Yr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function ug(n,e){return ws(n).put(function(r,i){return{targetId:0,path:fn(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Bg=class{constructor(){this.changes=new ri(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,At.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?x.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var bC=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Mo(e).put(r)}removeEntry(e,t,r){return Mo(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],kg(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.tr(e,r)))}getEntry(e,t){let r=At.newInvalidDocument(t);return Mo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Rd(t))},(i,s)=>{r=this.nr(t,s)}).next(()=>r)}rr(e,t){let r={size:0,document:At.newInvalidDocument(t)};return Mo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Rd(t))},(i,s)=>{r={document:this.nr(t,s),size:Vg(s)}}).next(()=>r)}getEntries(e,t){let r=Sn();return this.ir(e,t,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,t){let r=Sn(),i=new Qe(q.comparator);return this.ir(e,t,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,Vg(o))}).next(()=>({documents:r,_r:i}))}ir(e,t,r){if(t.isEmpty())return x.resolve();let i=new $e(k1);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(Rd(i.first()),Rd(i.last())),o=i.getIterator(),a=o.getNext();return Mo(e).J({index:"documentKeyIndex",range:s},(c,u,d)=>{let h=q.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&k1(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.$(Rd(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),kg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Mo(e).U(IDBKeyRange.bound(a,c,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let d=Sn();for(let h of u){let p=this.nr(q.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);p.isFoundDocument()&&(uh(t,p)||i.has(p.key))&&(d=d.insert(p.key,p))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=Sn(),o=M1(t,r),a=M1(t,Zn.max());return Mo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,d)=>{let h=this.nr(q.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new CC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return P1(e).get("remoteDocumentGlobalKey").next(t=>(Z(!!t),t))}tr(e,t){return P1(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let r=lK(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ee.min())))return r}return At.newInvalidDocument(e)}};function eF(n){return new bC(n)}var CC=class extends Bg{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new ri(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new $e((s,o)=>de(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=v1(this.ar.serializer,o);i=i.add(s.path.popLast());let u=Vg(c);r+=u-a.size,t.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=v1(this.ar.serializer,o.convertToNoDocument(ee.min()));t.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,r)),x.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(r=>(this.ur.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function P1(n){return Ft(n,"remoteDocumentGlobal")}function Mo(n){return Ft(n,"remoteDocumentsV14")}function Rd(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function M1(n,e){let t=e.documentKey.path.toArray();return[n,kg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function k1(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=de(t[s],r[s]),i)return i;return i=de(t.length,r.length),i||(i=de(t[t.length-2],r[r.length-2]),i||de(t[t.length-1],r[r.length-1]))}var DC=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var jg=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Od(r.mutation,i,On.empty(),nt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=pe()){let i=Jr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Nd();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Jr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,pe()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Sn(),o=kd(),a=function(){return kd()}();return t.forEach((c,u)=>{let d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof wr)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Od(d.mutation,u,d.mutation.getFieldMask(),nt.now())):o.set(u.key,On.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,d)=>o.set(u,d)),t.forEach((u,d)=>{var h;return a.set(u,new DC(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=kd(),i=new Qe((o,a)=>o-a),s=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=t.get(c);if(u===null)return;let d=r.get(c)||On.empty();d=a.applyToLocalView(u,d),r.set(c,d);let h=(i.get(a.batchId)||pe()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,d=c.value,h=TL();d.forEach(p=>{if(!s.has(p)){let _=NL(t.get(p),r.get(p));_!==null&&h.set(p,_),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return x.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):N0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):x.resolve(Jr()),a=-1,c=s;return o.next(u=>x.forEach(u,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?x.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,pe())).next(d=>({batchId:a,changes:EL(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next(r=>{let i=Nd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Nd();return this.indexManager.getCollectionParents(e,s).next(a=>x.forEach(a,c=>{let u=function(h,p){return new vr(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((h,p)=>{o=o.insert(h,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,u)=>{let d=u.getKey();o.get(d)===null&&(o=o.insert(d,At.newInvalidDocument(d)))});let a=Nd();return o.forEach((c,u)=>{let d=s.get(c);d!==void 0&&Od(d.mutation,u,On.empty(),nt.now()),uh(t,u)&&(a=a.insert(c,u))}),a})}};var SC=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return x.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:gt(i.createTime)}}(t)),x.resolve()}getNamedQuery(e,t){return x.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:k0(i.bundledQuery),readTime:gt(i.readTime)}}(t)),x.resolve()}};var AC=class{constructor(){this.overlays=new Qe(q.comparator),this.hr=new Map}getOverlay(e,t){return x.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Jr();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),x.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),x.resolve()}getOverlaysForCollection(e,t,r){let i=Jr(),s=t.length+1,o=new q(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return x.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Qe((u,d)=>u-d),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=Jr(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=Jr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return x.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Gd(t,r));let s=this.hr.get(t);s===void 0&&(s=pe(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var Xd=class{constructor(){this.Pr=new $e(Ct.Ir),this.Tr=new $e(Ct.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new Ct(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new Ct(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new q(new Re([])),r=new Ct(t,e),i=new Ct(t,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new q(new Re([])),r=new Ct(t,e),i=new Ct(t,e+1),s=pe();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Ct(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ct=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return q.comparator(e.key,t.key)||de(e.pr,t.pr)}static Er(e,t){return de(e.pr,t.pr)||q.comparator(e.key,t.key)}};var RC=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new $e(Ct.Ir)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new zd(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new Ct(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return x.resolve(o)}lookupMutationBatch(e,t){return x.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return x.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ct(t,0),i=new Ct(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),x.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new $e(de);return t.forEach(i=>{let s=new Ct(i,0),o=new Ct(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),x.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;q.isDocumentKey(s)||(s=s.child(""));let o=new Ct(new q(s),0),a=new $e(de);return this.wr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.pr)),!0)},o),x.resolve(this.Dr(a))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Z(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return x.forEach(t.mutations,i=>{let s=new Ct(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new Ct(t,0),i=this.wr.firstAfterOrEqual(r);return x.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var xC=class{constructor(e){this.vr=e,this.docs=function(){return new Qe(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return x.resolve(r?r.document.mutableCopy():At.newInvalidDocument(t))}getEntries(e,t){let r=Sn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():At.newInvalidDocument(i))}),x.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Sn(),o=t.path,a=new q(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||S0(Z1(d),r)<=0||(i.has(d.key)||uh(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return x.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Y()}Fr(e,t){return x.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new NC(this)}getSize(e){return x.resolve(this.size)}},NC=class extends Bg{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),x.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var PC=class{constructor(e){this.persistence=e,this.Mr=new ri(t=>qo(t),ah),this.lastRemoteSnapshotVersion=ee.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Xd,this.targetCount=0,this.Lr=zc.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),x.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new zc(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,x.resolve()}updateTargetData(e,t){return this.qn(t),x.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),x.waitFor(s).next(()=>i)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return x.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),x.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),x.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),x.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return x.resolve(r)}containsKey(e,t){return x.resolve(this.Nr.containsKey(t))}};var $g=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new kn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new PC(this),this.indexManager=new _C,this.remoteDocumentCache=function(i){return new xC(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Mg(t),this.$r=new SC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new AC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new RC(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){L("MemoryPersistence","Starting transaction:",e);let i=new MC(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return x.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},MC=class extends Ig{constructor(e){super(),this.currentSequenceNumber=e}},Hg=class n{constructor(e){this.persistence=e,this.zr=new Xd,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw Y()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),x.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),x.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),x.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Jr,r=>{let i=q.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,ee.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return x.or([()=>x.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var kC=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new Eg("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",JO,{unique:!0}),c.createObjectStore("documentMutations")}(e),O1(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=x.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),O1(e)),o=o.next(()=>function(c){let u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ee.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",JO,{unique:!0});let h=u.store("mutations"),p=d.map(_=>h.put(_));return x.waitFor(p)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let u=c.createObjectStore("documentOverlays",{keyPath:N8});u.createIndex("collectionPathOverlayIndex",P8,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",M8,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let u=c.createObjectStore("remoteDocumentsV14",{keyPath:w8});u.createIndex("documentKeyIndex",I8),u.createIndex("collectionGroupIndex",E8)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:S8}).createIndex("sequenceNumberIndex",A8,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:R8}).createIndex("documentKeyIndex",x8,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Vg(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>x.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>x.forEach(a,c=>{Z(c.userId===s.userId);let u=Lo(this.serializer,c);return JL(e,s.userId,u).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new Re(o),u=function(h){return[0,fn(h)]}(c);s.push(t.get(u).next(d=>d?x.resolve():(h=>t.put({targetId:0,path:fn(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>x.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:D8});let r=t.store("collectionParents"),i=new Jd,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:fn(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new Re(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],u)=>{let d=Yr(a);return s(d.popLast())}))}ri(e){let t=e.store("targets");return t.J((r,i)=>{let s=Pd(i),o=KL(this.serializer,s);return t.put(o)})}ii(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(h){return h.document?new q(Re.fromString(h.document.name).popFirst(5)):h.noDocument?q.fromSegments(h.noDocument.path):h.unknownDocument?q.fromSegments(h.unknownDocument.path):Y()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>x.waitFor(i))}si(e,t){let r=t.store("mutations"),i=eF(this.serializer),s=new $g(Hg.Hr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var u;let d=(u=a.get(c.userId))!==null&&u!==void 0?u:pe();Lo(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),x.forEach(a,(c,u)=>{let d=new Dt(u),h=Og.lt(this.serializer,d),p=s.getIndexManager(d),_=Ug.lt(d,this.serializer,p,s.referenceDelegate);return new jg(i,_,h,p).recalculateAndSaveOverlaysForDocumentKeys(new Bd(t,kn.oe),c).next()})})}};function O1(n){n.createObjectStore("targetDocuments",{keyPath:b8}).createIndex("documentTargetsIndex",C8,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",T8,{unique:!0}),n.createObjectStore("targetGlobal")}var Cb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",OC=class n{constructor(e,t,r,i,s,o,a,c,u,d,h=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=u,this.ai=d,this.ui=h,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=p=>Promise.resolve(),!n.D())throw new k(P.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new TC(this,i),this.Ti=t+"main",this.serializer=new Mg(c),this.Ei=new Cs(this.Ti,this.ui,new kC(this.serializer)),this.Qr=new vC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=eF(this.serializer),this.$r=new lC,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,d===!1&&pt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(P.FAILED_PRECONDITION,Cb);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new kn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>g(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>g(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>lg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(Os(e))return L("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return L("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return xd(e).get("owner").next(t=>x.resolve(this.Si(t)))}bi(e){return lg(e).delete(this.clientId)}Di(){return g(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Ft(t,"clientMetadata");return r.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return x.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?x.resolve(!0):xd(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new k(P.FAILED_PRECONDITION,Cb);return!1}}return!(!this.networkEnabled||!this.inForeground)||lg(e).U().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&L("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return g(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Bd(e,kn.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(r=>this.Ci(r.updateTimeMs,t)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>lg(e).U().next(t=>this.vi(t,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return Ug.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new yC(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Og.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,r){L("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===16?O8:c===15?aL:c===14?oL:c===13?sL:c===12?k8:c===11?iL:void Y()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Bd(a,this.kr?this.kr.next():kn.oe),t==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw pt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new k(P.FAILED_PRECONDITION,eL);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return xd(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new k(P.FAILED_PRECONDITION,Cb)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return xd(e).put("owner",t)}static D(){return Cs.D()}yi(e){let t=xd(e);return t.get("owner").next(r=>this.Si(r)?(L("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):x.resolve())}Ci(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(pt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;_E()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let r=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return L("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return pt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){pt("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function xd(n){return Ft(n,"owner")}function lg(n){return Ft(n,"clientMetadata")}function L0(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var LC=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=pe(),i=pe();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var FC=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var qg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return _E()?8:tL(je())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new FC;return this.Ji(e,t,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(Ac()<=ge.DEBUG&&L("QueryEngine","SDK will not create cache indexes for query:",Rc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),x.resolve()):(Ac()<=ge.DEBUG&&L("QueryEngine","Query:",Rc(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Ac()<=ge.DEBUG&&L("QueryEngine","The SDK decides to create cache indexes for query:",Rc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pn(t))):x.resolve())}ji(e,t){if(c1(t))return x.resolve(null);let r=pn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Rg(t,null,"F"),r=pn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=pe(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.Zi(t,a);return this.Xi(t,u,o,c.readTime)?this.ji(e,Rg(t,null,"F")):this.es(e,u,t,c)}))})))}Hi(e,t,r,i){return c1(t)||i.isEqual(ee.min())?x.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,r,i)?x.resolve(null):(Ac()<=ge.DEBUG&&L("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Rc(t)),this.es(e,o,t,X1(i,-1)).next(a=>a))})}Zi(e,t){let r=new $e(wL(e));return t.forEach((i,s)=>{uh(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return Ac()<=ge.DEBUG&&L("QueryEngine","Using full collection scan to execute query:",Rc(t)),this.zi.getDocumentsMatchingQuery(e,t,Zn.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var VC=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new Qe(de),this.rs=new ri(s=>qo(s),ah),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jg(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function tF(n,e,t,r){return new VC(n,e,t,r)}function nF(n,e){return g(this,null,function*(){let t=z(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=pe();for(let u of i){o.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}for(let u of s){a.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(u=>({us:u,removedBatchIds:o,addedBatchIds:a}))})})})}function pK(n,e){let t=z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(a,c,u,d){let h=u.batch,p=h.keys(),_=x.resolve();return p.forEach(w=>{_=_.next(()=>d.getEntry(c,w)).next(C=>{let A=u.docVersions.get(w);Z(A!==null),C.version.compareTo(A)<0&&(h.applyToRemoteDocument(C,u),C.isValidDocument()&&(C.setReadTime(u.commitVersion),d.addEntry(C)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=pe();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function rF(n){let e=z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function mK(n,e){let t=z(n),r=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let a=[];e.targetChanges.forEach((d,h)=>{let p=i.get(h);if(!p)return;a.push(t.Qr.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Qr.addMatchingKeys(s,d.addedDocuments,h)));let _=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?_=_.withResumeToken(Lt.EMPTY_BYTE_STRING,ee.min()).withLastLimboFreeSnapshotVersion(ee.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(h,_),function(C,A,F){return C.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0}(p,_,d)&&a.push(t.Qr.updateTargetData(s,_))});let c=Sn(),u=pe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(iF(s,o,e.documentUpdates).next(d=>{c=d.cs,u=d.ls})),!r.isEqual(ee.min())){let d=t.Qr.getLastRemoteSnapshotVersion(s).next(h=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return x.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(t.ns=i,s))}function iF(n,e,t){let r=pe(),i=pe();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Sn();return t.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(ee.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):L("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{cs:o,ls:i}})}function gK(n,e){let t=z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Gc(n,e){let t=z(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,x.resolve(i)):t.Qr.allocateTargetId(r).next(o=>(i=new qc(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}function Wc(n,e,t){return g(this,null,function*(){let r=z(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Os(o))throw o;L("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function zg(n,e,t){let r=z(n),i=ee.min(),s=pe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){let h=z(c),p=h.rs.get(d);return p!==void 0?x.resolve(h.ns.get(p)):h.Qr.getTargetData(u,d)}(r,o,pn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?i:ee.min(),t?s:pe())).next(a=>(aF(r,vL(e),a),{documents:a,hs:s})))}function sF(n,e){let t=z(n),r=z(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function oF(n,e){let t=z(n),r=t.ss.get(e)||ee.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,X1(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(aF(t,e,i),i))}function aF(n,e,t){let r=n.ss.get(e)||ee.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}function _K(n,e,t,r){return g(this,null,function*(){let i=z(n),s=pe(),o=Sn();for(let u of t){let d=e.Ps(u.metadata.name);u.document&&(s=s.add(d));let h=e.Is(u);h.setReadTime(e.Ts(u.metadata.readTime)),o=o.insert(d,h)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield Gc(i,function(d){return pn(tu(Re.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>iF(u,a,o).next(d=>(a.apply(u),d)).next(d=>i.Qr.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.Qr.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,d.cs,d.ls)).next(()=>d.cs)))})}function yK(r,i){return g(this,arguments,function*(n,e,t=pe()){let s=yield Gc(n,pn(k0(e.bundledQuery))),o=z(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=gt(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let u=s.withResumeToken(Lt.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(u.targetId,u),o.Qr.updateTargetData(a,u).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,t,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function L1(n,e){return`firestore_clients_${n}_${e}`}function F1(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Db(n,e){return`firestore_targets_${n}_${e}`}var Gg=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Es(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new k(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(pt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Ld=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Es(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new k(r.error.code,r.error.message))),s?new n(e,r.state,i):(pt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Wg=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=P0();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=nL(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(pt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},UC=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(pt("SharedClientState",`Failed to parse online state: ${e}`),null)}},Zd=class{constructor(){this.activeTargetIds=P0()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Fd=class{constructor(e,t,r,i,s){this.window=e,this.oi=t,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Qe(de),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=L1(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Zd),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(L1(this.persistenceKey,r));if(i){let s=Wg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let r=this.xs(t);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,r){this.Ls(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(Db(this.persistenceKey,e));if(r){let i=Ld.Es(e,r);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Db(this.persistenceKey,e))}updateQueryState(e,t,r){this.qs(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return L("SharedClientState","READ",e,t),t}setItem(e,t){L("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){L("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(L("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void pt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let r=this.$s(t.key);return this.Us(r,null)}{let r=this.Ws(t.key,t.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let r=this.Gs(t.key,t.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let r=this.js(t.key,t.newValue);if(r)return this.Hs(r)}}else if(t.key===this.vs){if(t.newValue!==null){let r=this.xs(t.newValue);if(r)return this.Os(r)}}else if(t.key===this.Ss){let r=function(s){let o=kn.oe;if(s!=null)try{let a=JSON.parse(s);Z(typeof a=="number"),o=a}catch(a){pt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==kn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Fs){let r=this.Js(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,r){let i=new Gg(this.currentUser,e,t,r),s=F1(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let t=F1(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,r){let i=Db(this.persistenceKey,e),s=new Ld(e,t,r);this.setItem(i,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let r=this.$s(e);return Wg.Es(r,t)}Gs(e,t){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Gg.Es(new Dt(s),i,t)}js(e,t){let r=this.Cs.exec(e),i=Number(r[1]);return Ld.Es(i,t)}xs(e){return UC.Es(e)}Js(e){return JSON.parse(e)}zs(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);L("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let r=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=P0();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Kg=class{constructor(){this.no=new Zd,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Zd,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var BC=class{io(e){}shutdown(){}};var Qg=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){L("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){L("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var dg=null;function Sb(){return dg===null?dg=function(){return 268435456+Math.round(2147483648*Math.random())}():dg++,"0x"+dg.toString(16)}var vK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var jC=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var Zt="WebChannelConnection",$C=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,o){let a=Sb(),c=this.vo(t,r.toUriEncodedString());L("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(u,s,o),this.Mo(t,c,u,i).then(d=>(L("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Xn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}xo(t,r,i,s,o,a){return this.Co(t,r,i,s,o)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+eu}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,r){let i=vK[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=Sb();return new Promise((o,a)=>{let c=new yb;c.setWithCredentials(!0),c.listenOnce(wb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Dd.NO_ERROR:let d=c.getResponseJson();L(Zt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Dd.TIMEOUT:L(Zt,`RPC '${e}' ${s} timed out`),a(new k(P.DEADLINE_EXCEEDED,"Request time out"));break;case Dd.HTTP_ERROR:let h=c.getStatus();if(L(Zt,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);let _=p?.error;if(_&&_.status&&_.message){let w=function(A){let F=A.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(F)>=0?F:P.UNKNOWN}(_.status);a(new k(w,_.message))}else a(new k(P.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new k(P.UNAVAILABLE,"Connection failed."));break;default:Y()}}finally{L(Zt,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);L(Zt,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",u,r,15)})}Oo(e,t,r){let i=Sb(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Tb(),a=Eb(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new vb({})),this.Fo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");L(Zt,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c),p=!1,_=!1,w=new jC({lo:A=>{_?L(Zt,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(p||(L(Zt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),L(Zt,`RPC '${e}' stream ${i} sending:`,A),h.send(A))},ho:()=>h.close()}),C=(A,F,G)=>{A.listen(F,U=>{try{G(U)}catch(Q){setTimeout(()=>{throw Q},0)}})};return C(h,Tc.EventType.OPEN,()=>{_||(L(Zt,`RPC '${e}' stream ${i} transport opened.`),w.mo())}),C(h,Tc.EventType.CLOSE,()=>{_||(_=!0,L(Zt,`RPC '${e}' stream ${i} transport closed`),w.po())}),C(h,Tc.EventType.ERROR,A=>{_||(_=!0,Xn(Zt,`RPC '${e}' stream ${i} transport errored:`,A),w.po(new k(P.UNAVAILABLE,"The operation could not be completed")))}),C(h,Tc.EventType.MESSAGE,A=>{var F;if(!_){let G=A.data[0];Z(!!G);let U=G,Q=U.error||((F=U[0])===null||F===void 0?void 0:F.error);if(Q){L(Zt,`RPC '${e}' stream ${i} received error:`,Q);let se=Q.status,J=function(I){let b=bt[I];if(b!==void 0)return kL(b)}(se),T=Q.message;J===void 0&&(J=P.INTERNAL,T="Unknown error status: "+se+" with message "+Q.message),_=!0,w.po(new k(J,T)),h.close()}else L(Zt,`RPC '${e}' stream ${i} received:`,G),w.yo(G)}}),C(a,Ib.STAT_EVENT,A=>{A.stat===ag.PROXY?L(Zt,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===ag.NOPROXY&&L(Zt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}};function cF(){return typeof window<"u"?window:null}function gg(){return typeof document<"u"?document:null}function lh(n){return new sC(n,!0)}var eh=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&L("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var Yg=class{constructor(e,t,r,i,s,o,a,c){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new eh(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return g(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return g(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return g(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(pt(t.toString()),pt("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new k(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>g(this,null,function*(){this.state=0,this.start()}))}c_(e){return L("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(L("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},HC=class extends Yg{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=rK(this.serializer,e),r=function(s){if(!("targetChange"in s))return ee.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?ee.min():o.readTime?gt(o.readTime):ee.min()}(e);return this.listener.h_(t,r)}P_(e){let t={};t.database=cC(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=Sg(c)?{documents:$L(s,c)}:{query:HL(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=LL(s,o.resumeToken);let u=oC(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ee.min())>0){a.readTime=Hc(s,o.snapshotVersion.toTimestamp());let u=oC(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=sK(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){let t={};t.database=cC(this.serializer),t.removeTarget=e,this.i_(t)}},qC=class extends Yg{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(Z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=iK(e.writeResults,e.commitTime),r=gt(e.commitTime);return this.listener.A_(r,t)}return Z(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=cC(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Yd(this.serializer,r))};this.i_(t)}};var zC=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new k(P.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,aC(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(P.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,aC(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new k(P.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},GC=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(pt(t),this.y_=!1):L("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var WC=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>g(this,null,function*(){Ls(this)&&(L("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let u=z(c);u.M_.add(4),yield nu(u),u.N_.set("Unknown"),u.M_.delete(4),yield dh(u)})}(this))}))}),this.N_=new GC(r,i)}};function dh(n){return g(this,null,function*(){if(Ls(n))for(let e of n.x_)yield e(!0)})}function nu(n){return g(this,null,function*(){for(let e of n.x_)yield e(!1)})}function m_(n,e){let t=z(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),U0(t)?V0(t):iu(t).Xo()&&F0(t,e))}function Kc(n,e){let t=z(n),r=iu(t);t.F_.delete(e),r.Xo()&&uF(t,e),t.F_.size===0&&(r.Xo()?r.n_():Ls(t)&&t.N_.set("Unknown"))}function F0(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ee.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}iu(n).P_(e)}function uF(n,e){n.L_.xe(e),iu(n).I_(e)}function V0(n){n.L_=new iC({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),iu(n).start(),n.N_.w_()}function U0(n){return Ls(n)&&!iu(n).Zo()&&n.F_.size>0}function Ls(n){return z(n).M_.size===0}function lF(n){n.L_=void 0}function wK(n){return g(this,null,function*(){n.N_.set("Online")})}function IK(n){return g(this,null,function*(){n.F_.forEach((e,t)=>{F0(n,e)})})}function EK(n,e){return g(this,null,function*(){lF(n),U0(n)?(n.N_.D_(e),V0(n)):n.N_.set("Unknown")})}function TK(n,e,t){return g(this,null,function*(){if(n.N_.set("Online"),e instanceof Ng&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(n,e)}catch(r){L("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Jg(n,r)}else if(e instanceof Lc?n.L_.Ke(e):e instanceof xg?n.L_.He(e):n.L_.We(e),!t.isEqual(ee.min()))try{let r=yield rF(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.F_.get(u);d&&s.F_.set(u,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let d=s.F_.get(c);if(!d)return;s.F_.set(c,d.withResumeToken(Lt.EMPTY_BYTE_STRING,d.snapshotVersion)),uF(s,c);let h=new qc(d.target,c,u,d.sequenceNumber);F0(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){L("RemoteStore","Failed to raise snapshot:",r),yield Jg(n,r)}})}function Jg(n,e,t){return g(this,null,function*(){if(!Os(e))throw e;n.M_.add(1),yield nu(n),n.N_.set("Offline"),t||(t=()=>rF(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){L("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield dh(n)}))})}function dF(n,e){return e().catch(t=>Jg(n,t,e))}function ru(n){return g(this,null,function*(){let e=z(n),t=Ms(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;bK(e);)try{let i=yield gK(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,CK(e,i)}catch(i){yield Jg(e,i)}hF(e)&&fF(e)})}function bK(n){return Ls(n)&&n.v_.length<10}function CK(n,e){n.v_.push(e);let t=Ms(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function hF(n){return Ls(n)&&!Ms(n).Zo()&&n.v_.length>0}function fF(n){Ms(n).start()}function DK(n){return g(this,null,function*(){Ms(n).V_()})}function SK(n){return g(this,null,function*(){let e=Ms(n);for(let t of n.v_)e.d_(t.mutations)})}function AK(n,e,t){return g(this,null,function*(){let r=n.v_.shift(),i=tC.from(r,e,t);yield dF(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield ru(n)})}function RK(n,e){return g(this,null,function*(){e&&Ms(n).E_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return ML(o)&&o!==P.ABORTED}(i.code)){let s=r.v_.shift();Ms(r).t_(),yield dF(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield ru(r)}})}(n,e)),hF(n)&&fF(n)})}function V1(n,e){return g(this,null,function*(){let t=z(n);t.asyncQueue.verifyOperationInProgress(),L("RemoteStore","RemoteStore received new credentials");let r=Ls(t);t.M_.add(3),yield nu(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield dh(t)})}function KC(n,e){return g(this,null,function*(){let t=z(n);e?(t.M_.delete(2),yield dh(t)):e||(t.M_.add(2),yield nu(t),t.N_.set("Unknown"))})}function iu(n){return n.B_||(n.B_=function(t,r,i){let s=z(t);return s.f_(),new HC(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:wK.bind(null,n),To:IK.bind(null,n),Ao:EK.bind(null,n),h_:TK.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.B_.t_(),U0(n)?V0(n):n.N_.set("Unknown")):(yield n.B_.stop(),lF(n))}))),n.B_}function Ms(n){return n.k_||(n.k_=function(t,r,i){let s=z(t);return s.f_(),new qC(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:DK.bind(null,n),Ao:RK.bind(null,n),R_:SK.bind(null,n),A_:AK.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.k_.t_(),yield ru(n)):(yield n.k_.stop(),n.v_.length>0&&(L("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var QC=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new St,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function su(n,e){if(pt("AsyncQueue",`${e}: ${n}`),Os(n))return new k(P.UNAVAILABLE,`${e}: ${n}`);throw n}var Xg=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||q.comparator(t.key,r.key):(t,r)=>q.comparator(t.key,r.key),this.keyedMap=Nd(),this.sortedSet=new Qe(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Zg=class{constructor(){this.q_=new Qe(q.comparator)}track(e){let t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):Y():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}},Qc=class n{constructor(e,t,r,i,s,o,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Xg.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ch(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var YC=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},JC=class{constructor(){this.queries=new ri(e=>yL(e),ch),this.onlineState="Unknown",this.z_=new Set}};function B0(n,e){return g(this,null,function*(){let t=z(n),r=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new YC,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=su(o,`Initialization of query '${Rc(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&$0(t)})}function j0(n,e){return g(this,null,function*(){let t=z(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function xK(n,e){let t=z(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&$0(t)}function NK(n,e,t){let r=z(n),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(t);r.queries.delete(e)}function $0(n){n.z_.forEach(e=>{e.next()})}var XC,U1;(U1=XC||(XC={})).J_="default",U1.Cache="cache";var th=class{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Qc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Qc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==XC.Cache}};var ZC=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var e_=class{constructor(e){this.serializer=e}Ps(e){return Zr(this.serializer,e)}Is(e){return e.metadata.exists?jL(this.serializer,e.document,!1):At.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return gt(e)}},e0=class{constructor(e,t,r){this.oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=pF(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let r=Re.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,r=new e_(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||pe()).add(s);t.set(o,a)}}return t}complete(){return g(this,null,function*(){let e=yield _K(this.localStore,new e_(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let r of this.queries)yield yK(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function pF(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var t_=class{constructor(e){this.key=e}},n_=class{constructor(e){this.key=e}},r_=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=pe(),this.mutatedKeys=pe(),this.Ia=wL(e),this.Ta=new Xg(this.Ia)}get Ea(){return this.la}da(e,t){let r=t?t.Aa:new Zg,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let p=i.get(d),_=uh(this.query,h)?h:null,w=!!p&&this.mutatedKeys.has(p.key),C=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),A=!1;p&&_?p.data.isEqual(_.data)?w!==C&&(r.track({type:3,doc:_}),A=!0):this.Ra(p,_)||(r.track({type:2,doc:_}),A=!0,(c&&this.Ia(_,c)>0||u&&this.Ia(_,u)<0)&&(a=!0)):!p&&_?(r.track({type:0,doc:_}),A=!0):p&&!_&&(r.track({type:1,doc:p}),A=!0,(c||u)&&(a=!0)),A&&(_?(o=o.add(_),s=C?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((d,h)=>function(_,w){let C=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Y()}};return C(_)-C(w)}(d.type,h.type)||this.Ia(d.doc,h.doc)),this.Va(r),i=i!=null&&i;let a=t&&!i?this.ma():[],c=this.Pa.size===0&&this.current&&!i?1:0,u=c!==this.ha;return this.ha=c,o.length!==0||u?{snapshot:new Qc(this.query,e.Ta,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new Zg,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=pe(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new n_(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new t_(r))}),t}pa(e){this.la=e.hs,this.Pa=pe();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Qc.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},t0=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},n0=class{constructor(e){this.key=e,this.wa=!1}},r0=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new ri(a=>yL(a),ch),this.Da=new Map,this.Ca=new Set,this.va=new Qe(q.comparator),this.Fa=new Map,this.Ma=new Xd,this.xa={},this.Oa=new Map,this.Na=zc.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function PK(n,e,t=!0){return g(this,null,function*(){let r=g_(n),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield mF(r,e,t,!0),i})}function MK(n,e){return g(this,null,function*(){let t=g_(n);yield mF(t,e,!0,!1)})}function mF(n,e,t,r){return g(this,null,function*(){let i=yield Gc(n.localStore,pn(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield H0(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&m_(n.remoteStore,i),a})}function H0(n,e,t,r,i){return g(this,null,function*(){n.Ba=(h,p,_)=>function(C,A,F,G){return g(this,null,function*(){let U=A.view.da(F);U.Xi&&(U=yield zg(C.localStore,A.query,!1).then(({documents:T})=>A.view.da(T,U)));let Q=G&&G.targetChanges.get(A.targetId),se=G&&G.targetMismatches.get(A.targetId)!=null,J=A.view.applyChanges(U,C.isPrimaryClient,Q,se);return i0(C,A.targetId,J.fa),J.snapshot})}(n,h,p,_);let s=yield zg(n.localStore,e,!0),o=new r_(e,s.hs),a=o.da(s.documents),c=Kd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=o.applyChanges(a,n.isPrimaryClient,c);i0(n,t,u.fa);let d=new t0(e,t,o);return n.ba.set(e,d),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),u.snapshot})}function kK(n,e,t){return g(this,null,function*(){let r=z(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!ch(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Wc(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Kc(r.remoteStore,i.targetId),Yc(r,i.targetId)}).catch(ks))):(Yc(r,i.targetId),yield Wc(r.localStore,i.targetId,!0))})}function OK(n,e){return g(this,null,function*(){let t=z(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Kc(t.remoteStore,r.targetId))})}function LK(n,e,t){return g(this,null,function*(){let r=W0(n);try{let i=yield function(o,a){let c=z(o),u=nt.now(),d=a.reduce((_,w)=>_.add(w.key),pe()),h,p;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let w=Sn(),C=pe();return c.os.getEntries(_,d).next(A=>{w=A,w.forEach((F,G)=>{G.isValidDocument()||(C=C.add(F))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,w)).next(A=>{h=A;let F=[];for(let G of a){let U=Y8(G,h.get(G.key).overlayedDocument);U!=null&&F.push(new wr(G.key,U,dL(U.value.mapValue),dt.exists(!0)))}return c.mutationQueue.addMutationBatch(_,u,F,a)}).next(A=>{p=A;let F=A.applyToLocalDocumentSet(h,C);return c.documentOverlayCache.saveOverlays(_,A.batchId,F)})}).then(()=>({batchId:p.batchId,changes:EL(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.xa[o.currentUser.toKey()];u||(u=new Qe(de)),u=u.insert(a,c),o.xa[o.currentUser.toKey()]=u}(r,i.batchId,t),yield Ui(r,i.changes),yield ru(r.remoteStore)}catch(i){let s=su(i,"Failed to persist write");t.reject(s)}})}function gF(n,e){return g(this,null,function*(){let t=z(n);try{let r=yield mK(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(Z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?Z(o.wa):i.removedDocuments.size>0&&(Z(o.wa),o.wa=!1))}),yield Ui(t,r,e)}catch(r){yield ks(r)}})}function B1(n,e,t){let r=z(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=z(o);c.onlineState=a;let u=!1;c.queries.forEach((d,h)=>{for(let p of h.U_)p.j_(a)&&(u=!0)}),u&&$0(c)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function FK(n,e,t){return g(this,null,function*(){let r=z(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new Qe(q.comparator);o=o.insert(s,At.newNoDocument(s,ee.min()));let a=pe().add(s),c=new Wd(ee.min(),new Map,new Qe(de),o,a);yield gF(r,c),r.va=r.va.remove(s),r.Fa.delete(e),G0(r)}else yield Wc(r.localStore,e,!1).then(()=>Yc(r,e,t)).catch(ks)})}function VK(n,e){return g(this,null,function*(){let t=z(n),r=e.batch.batchId;try{let i=yield pK(t.localStore,e);z0(t,r,null),q0(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ui(t,i)}catch(i){yield ks(i)}})}function UK(n,e,t){return g(this,null,function*(){let r=z(n);try{let i=yield function(o,a){let c=z(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next(h=>(Z(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);z0(r,e,t),q0(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ui(r,i)}catch(i){yield ks(i)}})}function BK(n,e){return g(this,null,function*(){let t=z(n);Ls(t.remoteStore)||L("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=z(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Oa.get(r)||[];i.push(e),t.Oa.set(r,i)}catch(r){let i=su(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function q0(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function z0(n,e,t){let r=z(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Yc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||_F(n,r)})}function _F(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(Kc(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),G0(n))}function i0(n,e,t){for(let r of t)r instanceof t_?(n.Ma.addReference(r.key,e),jK(n,r)):r instanceof n_?(L("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||_F(n,r.key)):Y()}function jK(n,e){let t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(L("SyncEngine","New document in limbo: "+t),n.Ca.add(r),G0(n))}function G0(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new q(Re.fromString(e)),r=n.Na.next();n.Fa.set(r,new n0(t)),n.va=n.va.insert(t,r),m_(n.remoteStore,new qc(pn(tu(t.path)),r,"TargetPurposeLimboResolution",kn.oe))}}function Ui(n,e,t){return g(this,null,function*(){let r=z(n),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,c)=>{o.push(r.Ba(c,e,t).then(u=>{if((u||t)&&r.isPrimaryClient){let d=u&&!u.fromCache;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(u){i.push(u);let d=LC.Ki(c.targetId,u);s.push(d)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(c,u){return g(this,null,function*(){let d=z(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>x.forEach(u,p=>x.forEach(p.qi,_=>d.persistence.referenceDelegate.addReference(h,p.targetId,_)).next(()=>x.forEach(p.Qi,_=>d.persistence.referenceDelegate.removeReference(h,p.targetId,_)))))}catch(h){if(!Os(h))throw h;L("LocalStore","Failed to update sequence numbers: "+h)}for(let h of u){let p=h.targetId;if(!h.fromCache){let _=d.ns.get(p),w=_.snapshotVersion,C=_.withLastLimboFreeSnapshotVersion(w);d.ns=d.ns.insert(p,C)}}})}(r.localStore,s))})}function $K(n,e){return g(this,null,function*(){let t=z(n);if(!t.currentUser.isEqual(e)){L("SyncEngine","User change. New user:",e.toKey());let r=yield nF(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(c=>{c.reject(new k(P.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ui(t,r.us)}})}function HK(n,e){let t=z(n),r=t.Fa.get(e);if(r&&r.wa)return pe().add(r.key);{let i=pe(),s=t.Da.get(e);if(!s)return i;for(let o of s){let a=t.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function qK(n,e){return g(this,null,function*(){let t=z(n),r=yield zg(t.localStore,e.query,!0),i=e.view.pa(r);return t.isPrimaryClient&&i0(t,e.targetId,i.fa),i})}function zK(n,e){return g(this,null,function*(){let t=z(n);return oF(t.localStore,e).then(r=>Ui(t,r))})}function GK(n,e,t,r){return g(this,null,function*(){let i=z(n),s=yield function(a,c){let u=z(a),d=z(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.vn(h,c).next(p=>p?u.localDocuments.getDocuments(h,p):x.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield ru(i.remoteStore):t==="acknowledged"||t==="rejected"?(z0(i,e,r||null),q0(i,e),function(a,c){z(z(a).mutationQueue).Mn(c)}(i.localStore,e)):Y(),yield Ui(i,s)):L("SyncEngine","Cannot apply mutation batch with id: "+e)})}function WK(n,e){return g(this,null,function*(){let t=z(n);if(g_(t),W0(t),e===!0&&t.La!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield j1(t,r.toArray());t.La=!0,yield KC(t.remoteStore,!0);for(let s of i)m_(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let r=[],i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Yc(t,o),Wc(t.localStore,o,!0))),Kc(t.remoteStore,o)}),yield i,yield j1(t,r),function(o){let a=z(o);a.Fa.forEach((c,u)=>{Kc(a.remoteStore,u)}),a.Ma.mr(),a.Fa=new Map,a.va=new Qe(q.comparator)}(t),t.La=!1,yield KC(t.remoteStore,!1)}})}function j1(n,e,t){return g(this,null,function*(){let r=z(n),i=[],s=[];for(let o of e){let a,c=r.Da.get(o);if(c&&c.length!==0){a=yield Gc(r.localStore,pn(c[0]));for(let u of c){let d=r.ba.get(u),h=yield qK(r,d);h.snapshot&&s.push(h.snapshot)}}else{let u=yield sF(r.localStore,o);a=yield Gc(r.localStore,u),yield H0(r,yF(u),o,!1,a.resumeToken)}i.push(a)}return r.Sa.h_(s),i})}function yF(n){return _L(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function KK(n){return function(t){return z(z(t).persistence).Bi()}(z(n).localStore)}function QK(n,e,t,r){return g(this,null,function*(){let i=z(n);if(i.La)return void L("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield oF(i.localStore,vL(s[0])),a=Wd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Lt.EMPTY_BYTE_STRING);yield Ui(i,o,a);break}case"rejected":yield Wc(i.localStore,e,!0),Yc(i,e,r);break;default:Y()}})}function YK(n,e,t){return g(this,null,function*(){let r=g_(n);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){L("SyncEngine","Adding an already active target "+i);continue}let s=yield sF(r.localStore,i),o=yield Gc(r.localStore,s);yield H0(r,yF(s),o.targetId,!1,o.resumeToken),m_(r.remoteStore,o)}for(let i of t)r.Da.has(i)&&(yield Wc(r.localStore,i,!1).then(()=>{Kc(r.remoteStore,i),Yc(r,i)}).catch(ks))}})}function g_(n){let e=z(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=gF.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=HK.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FK.bind(null,e),e.Sa.h_=xK.bind(null,e.eventManager),e.Sa.ka=NK.bind(null,e.eventManager),e}function W0(n){let e=z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VK.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=UK.bind(null,e),e}function JK(n,e,t){let r=z(n);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(_,w){let C=z(_),A=gt(w.createTime);return C.persistence.runTransaction("hasNewerBundle","readonly",F=>C.$r.getBundleMetadata(F,w.id)).then(F=>!!F&&F.createTime.compareTo(A)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(pF(c));let u=new e0(c,s.localStore,o.serializer),d=yield o.qa();for(;d;){let p=yield u._a(d);p&&a._updateProgress(p),d=yield o.qa()}let h=yield u.complete();return yield Ui(s,h.ca,void 0),yield function(_,w){let C=z(_);return C.persistence.runTransaction("Save bundle","readwrite",A=>C.$r.saveBundleMetadata(A,w))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.ua)}catch(c){return Xn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var nh=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=lh(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return tF(this.persistence,new qg,e.initialUser,this.serializer)}createPersistence(e){return new $g(Hg.Hr,this.serializer)}createSharedClientState(e){return new Kg}terminate(){return g(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var i_=class n extends nh{constructor(e,t,r){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield Dr(n.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield W0(this.Qa.syncEngine),yield ru(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return tF(this.persistence,new qg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new IC(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new Ub(t,this.persistence);return new Vb(e.asyncQueue,r)}createPersistence(e){let t=L0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new OC(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,cF(),gg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Kg}},s0=class n extends i_{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield Dr(n.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof Fd&&(this.sharedClientState.syncEngine={Zs:GK.bind(null,t),Xs:QK.bind(null,t),eo:YK.bind(null,t),Bi:KK.bind(null,t),Ys:zK.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>g(this,null,function*(){yield WK(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=cF();if(!Fd.D(t))throw new k(P.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=L0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Fd(t,e.asyncQueue,r,e.clientId,e.initialUser)}},rh=class{initialize(e,t){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>B1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=$K.bind(null,this.syncEngine),yield KC(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new JC}()}createDatastore(e){let t=lh(e.databaseInfo.databaseId),r=function(s){return new $C(s)}(e.databaseInfo);return function(s,o,a,c){return new zC(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new WC(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>B1(this.syncEngine,t,0),function(){return Qg.D()?new Qg:new BC}())}createSyncEngine(e,t){return function(i,s,o,a,c,u,d){let h=new r0(i,s,o,a,c,u);return d&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return g(this,null,function*(){var e;yield function(r){return g(this,null,function*(){let i=z(r);L("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield nu(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function $1(n,e=10240){let t=0;return{read(){return g(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Jc=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):pt("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var o0=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new St,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}qa(){return g(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return g(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),r=Number(t);isNaN(r)&&this.ja(`length string (${t}) is not valid number`);let i=yield this.Ha(r);return new ZC(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return g(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return g(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var a0=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new k(P.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return g(this,null,function*(){let o=z(i),a={documents:s.map(h=>Qd(o.serializer,h))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,Re.emptyPath(),a,s.length),u=new Map;c.forEach(h=>{let p=nK(o.serializer,h);u.set(p.key.toString(),p)});let d=[];return s.forEach(h=>{let p=u.get(h.toString());Z(!!p),d.push(p)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ps(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=q.fromPath(r);this.mutations.push(new qd(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=z(r),o={writes:i.map(a=>Yd(s.serializer,a))};yield s.Co("Commit",s.serializer.databaseId,Re.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Y();t=ee.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new k(P.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ee.min())?dt.exists(!1):dt.updateTime(t):dt.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ee.min()))throw new k(P.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return dt.updateTime(t)}return dt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var c0=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Yo=new eh(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>g(this,null,function*(){let e=new a0(this.datastore),t=this.tu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let t=this.updateFunction(e);return!oh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!ML(t)}return!1}};var u0=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Dt.UNAUTHENTICATED,this.clientId=vg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){L("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(L("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(P.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new St;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=su(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function _g(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),L("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield nF(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function l0(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield K0(n);L("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>V1(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>V1(e.remoteStore,i)),n._onlineComponents=e})}function vF(n){return n.name==="FirebaseError"?n.code===P.FAILED_PRECONDITION||n.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function K0(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){L("FirestoreClient","Using user provided OfflineComponentProvider");try{yield _g(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!vF(t))throw t;Xn("Error using user provided cache. Falling back to memory cache: "+t),yield _g(n,new nh)}}else L("FirestoreClient","Using default OfflineComponentProvider"),yield _g(n,new nh);return n._offlineComponents})}function __(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(L("FirestoreClient","Using user provided OnlineComponentProvider"),yield l0(n,n._uninitializedComponentsProvider._online)):(L("FirestoreClient","Using default OnlineComponentProvider"),yield l0(n,new rh))),n._onlineComponents})}function wF(n){return K0(n).then(e=>e.persistence)}function Q0(n){return K0(n).then(e=>e.localStore)}function IF(n){return __(n).then(e=>e.remoteStore)}function Y0(n){return __(n).then(e=>e.syncEngine)}function XK(n){return __(n).then(e=>e.datastore)}function Xc(n){return g(this,null,function*(){let e=yield __(n),t=e.eventManager;return t.onListen=PK.bind(null,e.syncEngine),t.onUnlisten=kK.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=MK.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=OK.bind(null,e.syncEngine),t})}function ZK(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield wF(n),t=yield IF(n);return e.setNetworkEnabled(!0),function(i){let s=z(i);return s.M_.delete(0),dh(s)}(t)}))}function eQ(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield wF(n),t=yield IF(n);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=z(i);s.M_.add(0),yield nu(s),s.N_.set("Offline")})}(t)}))}function tQ(n,e){let t=new St;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(u,d){let h=z(u);return h.persistence.runTransaction("read document","readonly",p=>h.localDocuments.getDocument(p,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new k(P.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=su(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield Q0(n),e,t)})),t.promise}function EF(n,e,t={}){let r=new St;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,u){let d=new Jc({next:p=>{o.enqueueAndForget(()=>j0(s,h));let _=p.docs.has(a);!_&&p.fromCache?u.reject(new k(P.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&c&&c.source==="server"?u.reject(new k(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),h=new th(tu(a.path),d,{includeMetadataChanges:!0,ra:!0});return B0(s,h)}(yield Xc(n),n.asyncQueue,e,t,r)})),r.promise}function nQ(n,e){let t=new St;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield zg(i,s,!0),c=new r_(s,a.hs),u=c.da(a.documents),d=c.applyChanges(u,!1);o.resolve(d.snapshot)}catch(a){let c=su(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield Q0(n),e,t)})),t.promise}function TF(n,e,t={}){let r=new St;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,u){let d=new Jc({next:p=>{o.enqueueAndForget(()=>j0(s,h)),p.fromCache&&c.source==="server"?u.reject(new k(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),h=new th(a,d,{includeMetadataChanges:!0,ra:!0});return B0(s,h)}(yield Xc(n),n.asyncQueue,e,t,r)})),r.promise}function rQ(n,e){let t=new Jc(e);return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){z(i).z_.add(s),s.next()}(yield Xc(n),t)})),()=>{t.$a(),n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){z(i).z_.delete(s)}(yield Xc(n),t)}))}}function iQ(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?OL().encode(o):o,function(d,h){return new o0(d,h)}(function(d,h){if(d instanceof Uint8Array)return $1(d,h);if(d instanceof ArrayBuffer)return $1(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,lh(e));n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){JK(yield Y0(n),i,r)}))}function sQ(n,e){return n.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=z(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield Q0(n),e)}))}function bF(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var H1=new Map;function J0(n,e,t){if(!t)throw new k(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function X0(n,e,t,r){if(e===!0&&r===!0)throw new k(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function q1(n){if(!q.isDocumentKey(n))throw new k(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function z1(n){if(q.isDocumentKey(n))throw new k(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function y_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Y()}function xe(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new k(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=y_(n);throw new k(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function CF(n,e){if(e<=0)throw new k(P.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var s_=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new k(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}X0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bF((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new k(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new k(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new k(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ko=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new s_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new k(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new k(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new s_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Ab;switch(r.type){case"firstParty":return new Pb(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new k(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=H1.get(t);r&&(L("ComponentProvider","Removing Datastore"),H1.delete(t),r.terminate())}(this),Promise.resolve()}};function DF(n,e,t,r={}){var i;let s=(n=xe(n,Ko))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Xn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Dt.MOCK_USER;else{a=cc(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new k(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Dt(u)}n._authCredentials=new Rb(new yg(a,c))}}var Ht=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},ze=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ei(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},ei=class n extends Ht{constructor(e,t,r){super(e,t,tu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ze(this.firestore,null,new q(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Z0(n,e,...t){if(n=H(n),J0("collection","path",e),n instanceof Ko){let r=Re.fromString(e,...t);return z1(r),new ei(n,null,r)}{if(!(n instanceof ze||n instanceof ei))throw new k(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Re.fromString(e,...t));return z1(r),new ei(n.firestore,null,r)}}function SF(n,e){if(n=xe(n,Ko),J0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(P.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ht(n,null,function(r){return new vr(Re.emptyPath(),r)}(e))}function hh(n,e,...t){if(n=H(n),arguments.length===1&&(e=vg.newId()),J0("doc","path",e),n instanceof Ko){let r=Re.fromString(e,...t);return q1(r),new ze(n,null,new q(r))}{if(!(n instanceof ze||n instanceof ei))throw new k(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Re.fromString(e,...t));return q1(r),new ze(n.firestore,n instanceof ei?n.converter:null,new q(r))}}function eD(n,e){return n=H(n),e=H(e),(n instanceof ze||n instanceof ei)&&(e instanceof ze||e instanceof ei)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function tD(n,e){return n=H(n),e=H(e),n instanceof Ht&&e instanceof Ht&&n.firestore===e.firestore&&ch(n._query,e._query)&&n.converter===e.converter}var d0=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new eh(this,"async_queue_retry"),this.hu=()=>{let t=gg();t&&L("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=gg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=gg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new St;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return g(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Os(e))throw e;L("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw pt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=QC.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&Y()}verifyOperationInProgress(){}du(){return g(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function h0(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var f0=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new St,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var AF=-1,Xe=class extends Ko{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new d0}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||RF(this),this._firestoreClient.terminate()}};function Pt(n){return n._firestoreClient||RF(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function RF(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,u,d){return new Bb(a,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,bF(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new u0(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function xF(n,e){UF(n=xe(n,Xe));let t=Pt(n);if(t._uninitializedComponentsProvider)throw new k(P.FAILED_PRECONDITION,"SDK cache is already specified.");Xn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new rh;return PF(t,i,new i_(i,r.cacheSizeBytes,e?.forceOwnership))}function NF(n){UF(n=xe(n,Xe));let e=Pt(n);if(e._uninitializedComponentsProvider)throw new k(P.FAILED_PRECONDITION,"SDK cache is already specified.");Xn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new rh;return PF(e,r,new s0(r,t.cacheSizeBytes))}function PF(n,e,t){let r=new St;return n.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield _g(n,t),yield l0(n,e),r.resolve()}catch(i){let s=i;if(!vF(s))throw s;Xn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function MF(n){if(n._initialized&&!n._terminated)throw new k(P.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new St;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!Cs.D())return Promise.resolve();let i=r+"main";yield Cs.delete(i)})}(L0(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function kF(n){return function(t){let r=new St;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return BK(yield Y0(t),r)})),r.promise}(Pt(n=xe(n,Xe)))}function OF(n){return ZK(Pt(n=xe(n,Xe)))}function LF(n){return eQ(Pt(n=xe(n,Xe)))}function FF(n,e){let t=Pt(n=xe(n,Xe)),r=new f0;return iQ(t,n._databaseId,e,r),r}function VF(n,e){return sQ(Pt(n=xe(n,Xe)),e).then(t=>t?new Ht(n,null,t.query):null)}function UF(n){if(n._initialized||n._terminated)throw new k(P.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var ii=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Lt.fromBase64String(e))}catch(t){throw new k(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Lt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Ir=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new k(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Fi=class{constructor(e){this._methodName=e}};var Qo=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new k(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return de(this._lat,e._lat)||de(this._long,e._long)}};var oQ=/^__.*__$/,p0=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new wr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ns(e,this.data,t,this.fieldTransforms)}},o_=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new wr(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function BF(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y()}}var a_=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return c_(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(BF(this.fu)&&oQ.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},m0=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||lh(e)}Fu(e,t,r,i=!1){return new a_({fu:e,methodName:t,vu:r,path:mt.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Zo(n){let e=n._freezeSettings(),t=lh(n._databaseId);return new m0(n._databaseId,!!e.ignoreUndefinedProperties,t)}function v_(n,e,t,r,i,s={}){let o=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);iD("Data must be an object, but it was:",o,r);let a=HF(r,o),c,u;if(s.merge)c=new On(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let p=w0(e,h,t);if(!o.contains(p))throw new k(P.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);zF(d,p)||d.push(p)}c=new On(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new p0(new en(a),c,u)}var ih=class n extends Fi{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function jF(n,e,t){return new a_({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var g0=class n extends Fi{_toFieldTransform(e){return new zo(e.path,new Rs)}isEqual(e){return e instanceof n}},_0=class n extends Fi{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=jF(this,e,!0),r=this.Mu.map(s=>ea(s,t)),i=new Oi(r);return new zo(e.path,i)}isEqual(e){return e instanceof n&&cs(this.Mu,e.Mu)}},y0=class n extends Fi{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=jF(this,e,!0),r=this.Mu.map(s=>ea(s,t)),i=new Li(r);return new zo(e.path,i)}isEqual(e){return e instanceof n&&cs(this.Mu,e.Mu)}},v0=class n extends Fi{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new xs(e.serializer,DL(e.serializer,this.xu));return new zo(e.path,t)}isEqual(e){return e instanceof n&&this.xu===e.xu}};function nD(n,e,t,r){let i=n.Fu(1,e,t);iD("Data must be an object, but it was:",i,r);let s=[],o=en.empty();Xo(r,(c,u)=>{let d=sD(e,c,t);u=H(u);let h=i.Su(d);if(u instanceof ih)s.push(d);else{let p=ea(u,h);p!=null&&(s.push(d),o.set(d,p))}});let a=new On(s);return new o_(o,a,i.fieldTransforms)}function rD(n,e,t,r,i,s){let o=n.Fu(1,e,t),a=[w0(e,r,t)],c=[i];if(s.length%2!=0)throw new k(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(w0(e,s[p])),c.push(s[p+1]);let u=[],d=en.empty();for(let p=a.length-1;p>=0;--p)if(!zF(u,a[p])){let _=a[p],w=c[p];w=H(w);let C=o.Su(_);if(w instanceof ih)u.push(_);else{let A=ea(w,C);A!=null&&(u.push(_),d.set(_,A))}}let h=new On(u);return new o_(d,h,o.fieldTransforms)}function $F(n,e,t,r=!1){return ea(t,n.Fu(r?4:3,e))}function ea(n,e){if(qF(n=H(n)))return iD("Unsupported field value:",e,n),HF(n,e);if(n instanceof Fi)return function(r,i){if(!BF(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=ea(a,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=H(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return DL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=nt.fromDate(r);return{timestampValue:Hc(i.serializer,s)}}if(r instanceof nt){let s=new nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Hc(i.serializer,s)}}if(r instanceof Qo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ii)return{bytesValue:LL(i.serializer,r._byteString)};if(r instanceof ze){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:M0(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${y_(r)}`)}(n,e)}function HF(n,e){let t={};return cL(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xo(n,(r,i)=>{let s=ea(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function qF(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof nt||n instanceof Qo||n instanceof ii||n instanceof ze||n instanceof Fi)}function iD(n,e,t){if(!qF(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=y_(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function w0(n,e,t){if((e=H(e))instanceof Ir)return e._internalPath;if(typeof e=="string")return sD(n,e);throw c_("Field path arguments must be of type string or ",n,!1,void 0,t)}var aQ=new RegExp("[~\\*/\\[\\]]");function sD(n,e,t){if(e.search(aQ)>=0)throw c_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ir(...e.split("."))._internalPath}catch{throw c_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function c_(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new k(P.INVALID_ARGUMENT,a+n+c)}function zF(n,e){return n.some(t=>t.isEqual(e))}var Yo=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new I0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(w_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},I0=class extends Yo{data(){return super.data()}};function w_(n,e){return typeof e=="string"?sD(n,e):e instanceof Ir?e._internalPath:e._delegate._internalPath}function GF(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new k(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var sh=class{},Jo=class extends sh{};function Bi(n,e,...t){let r=[];e instanceof sh&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof E0).length,a=s.filter(c=>c instanceof u_).length;if(o>1||o>0&&a>0)throw new k(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var u_=class n extends Jo{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return nV(e._query,t),new Ht(e.firestore,e.converter,Zb(e._query,t))}_parse(e){let t=Zo(e.firestore);return function(s,o,a,c,u,d,h){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new k(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){W1(h,d);let _=[];for(let w of h)_.push(G1(c,s,w));p={arrayValue:{values:_}}}else p=G1(c,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||W1(h,d),p=$F(a,o,h,d==="in"||d==="not-in");return Ie.create(u,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function WF(n,e,t){let r=e,i=w_("where",n);return u_._create(i,r,t)}var E0=class n extends sh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Le.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)nV(o,c),o=Zb(o,c)}(e._query,t),new Ht(e.firestore,e.converter,Zb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var T0=class n extends Jo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new k(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new k(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ho(s,o)}(e._query,this._field,this._direction);return new Ht(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new vr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function KF(n,e="asc"){let t=e,r=w_("orderBy",n);return T0._create(r,t)}var l_=class n extends Jo{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Ht(e.firestore,e.converter,Rg(e._query,this._limit,this._limitType))}};function QF(n){return CF("limit",n),l_._create("limit",n,"F")}function YF(n){return CF("limitToLast",n),l_._create("limitToLast",n,"L")}var d_=class n extends Jo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=tV(e,this.type,this._docOrFields,this._inclusive);return new Ht(e.firestore,e.converter,function(i,s){return new vr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function JF(...n){return d_._create("startAt",n,!0)}function XF(...n){return d_._create("startAfter",n,!1)}var h_=class n extends Jo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=tV(e,this.type,this._docOrFields,this._inclusive);return new Ht(e.firestore,e.converter,function(i,s){return new vr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function ZF(...n){return h_._create("endBefore",n,!1)}function eV(...n){return h_._create("endAt",n,!0)}function tV(n,e,t,r){if(t[0]=H(t[0]),t[0]instanceof Yo)return function(s,o,a,c,u){if(!c)throw new k(P.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of Oc(s))if(h.field.isKeyField())d.push($o(o,c.key));else{let p=c.data.field(h.field);if(p_(p))throw new k(P.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let _=h.field.canonicalString();throw new k(P.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(p)}return new ni(d,u)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Zo(n.firestore);return function(o,a,c,u,d,h){let p=o.explicitOrderBy;if(d.length>p.length)throw new k(P.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let _=[];for(let w=0;w<d.length;w++){let C=d[w];if(p[w].field.isKeyField()){if(typeof C!="string")throw new k(P.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof C}`);if(!N0(o)&&C.indexOf("/")!==-1)throw new k(P.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${C}' contains a slash.`);let A=o.path.child(Re.fromString(C));if(!q.isDocumentKey(A))throw new k(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);let F=new q(A);_.push($o(a,F))}else{let A=$F(c,u,C);_.push(A)}}return new ni(_,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function G1(n,e,t){if(typeof(t=H(t))=="string"){if(t==="")throw new k(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!N0(e)&&t.indexOf("/")!==-1)throw new k(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Re.fromString(t));if(!q.isDocumentKey(r))throw new k(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return $o(n,new q(r))}if(t instanceof ze)return $o(n,t._key);throw new k(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${y_(t)}.`)}function W1(n,e){if(!Array.isArray(n)||n.length===0)throw new k(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function nV(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new k(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new k(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Zc=class{convertValue(e,t="none"){switch(jo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ds(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Y()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Xo(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Qo(lt(e.latitude),lt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=R0(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(jd(e));default:return null}}convertTimestamp(e){let t=ki(e);return new nt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Re.fromString(e);Z(WL(r));let i=new Ss(r.get(1),r.get(3)),s=new q(r.popFirst(5));return i.isEqual(t)||pt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function I_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var b0=class extends Zc{constructor(e){super(),this.firestore=e}convertBytes(e){return new ii(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ze(this.firestore,null,t)}};var Mi=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},er=class extends Yo{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Ts(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(w_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Ts=class extends er{data(e={}){return super.data(e)}},Er=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Mi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Ts(this._firestore,this._userDataWriter,r.key,r,new Mi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new k(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Ts(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Mi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Ts(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Mi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:cQ(a.type),doc:c,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function cQ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y()}}function oD(n,e){return n instanceof er&&e instanceof er?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Er&&e instanceof Er&&n._firestore===e._firestore&&tD(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function rV(n){n=xe(n,ze);let e=xe(n.firestore,Xe);return EF(Pt(e),n._key).then(t=>lD(e,n,t))}var Vi=class extends Zc{constructor(e){super(),this.firestore=e}convertBytes(e){return new ii(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ze(this.firestore,null,t)}};function iV(n){n=xe(n,ze);let e=xe(n.firestore,Xe),t=Pt(e),r=new Vi(e);return tQ(t,n._key).then(i=>new er(e,r,n._key,i,new Mi(i!==null&&i.hasLocalMutations,!0),n.converter))}function sV(n){n=xe(n,ze);let e=xe(n.firestore,Xe);return EF(Pt(e),n._key,{source:"server"}).then(t=>lD(e,n,t))}function oV(n){n=xe(n,Ht);let e=xe(n.firestore,Xe),t=Pt(e),r=new Vi(e);return GF(n._query),TF(t,n._query).then(i=>new Er(e,r,n,i))}function aV(n){n=xe(n,Ht);let e=xe(n.firestore,Xe),t=Pt(e),r=new Vi(e);return nQ(t,n._query).then(i=>new Er(e,r,n,i))}function cV(n){n=xe(n,Ht);let e=xe(n.firestore,Xe),t=Pt(e),r=new Vi(e);return TF(t,n._query,{source:"server"}).then(i=>new Er(e,r,n,i))}function aD(n,e,t){n=xe(n,ze);let r=xe(n.firestore,Xe),i=I_(n.converter,e,t);return ou(r,[v_(Zo(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,dt.none())])}function cD(n,e,t,...r){n=xe(n,ze);let i=xe(n.firestore,Xe),s=Zo(i),o;return o=typeof(e=H(e))=="string"||e instanceof Ir?rD(s,"updateDoc",n._key,e,t,r):nD(s,"updateDoc",n._key,e),ou(i,[o.toMutation(n._key,dt.exists(!0))])}function uV(n){return ou(xe(n.firestore,Xe),[new Ps(n._key,dt.none())])}function lV(n,e){let t=xe(n.firestore,Xe),r=hh(n),i=I_(n.converter,e);return ou(t,[v_(Zo(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,dt.exists(!1))]).then(()=>r)}function uD(n,...e){var t,r,i;n=H(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||h0(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(h0(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,u,d;if(n instanceof ze)u=xe(n.firestore,Xe),d=tu(n._key.path),c={next:h=>{e[o]&&e[o](lD(u,n,h))},error:e[o+1],complete:e[o+2]};else{let h=xe(n,Ht);u=xe(h.firestore,Xe),d=h._query;let p=new Vi(u);c={next:_=>{e[o]&&e[o](new Er(u,p,h,_))},error:e[o+1],complete:e[o+2]},GF(n._query)}return function(p,_,w,C){let A=new Jc(C),F=new th(_,A,w);return p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return B0(yield Xc(p),F)})),()=>{A.$a(),p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return j0(yield Xc(p),F)}))}}(Pt(u),d,a,c)}function dV(n,e){return rQ(Pt(n=xe(n,Xe)),h0(e)?e:{next:e})}function ou(n,e){return function(r,i){let s=new St;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return LK(yield Y0(r),i,s)})),s.promise}(Pt(n),e)}function lD(n,e,t){let r=t.docs.get(e._key),i=new Vi(n);return new er(n,i,e._key,r,new Mi(t.hasPendingWrites,t.fromCache),e.converter)}var uQ={maxAttempts:5};var f_=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Zo(e)}set(e,t,r){this._verifyNotCommitted();let i=Is(e,this._firestore),s=I_(i.converter,t,r),o=v_(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,dt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=Is(e,this._firestore),o;return o=typeof(t=H(t))=="string"||t instanceof Ir?rD(this._dataReader,"WriteBatch.update",s._key,t,r,i):nD(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,dt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Is(e,this._firestore);return this._mutations=this._mutations.concat(new Ps(t._key,dt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(P.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Is(n,e){if((n=H(n)).firestore!==e)throw new k(P.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var C0=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Zo(t)}get(t){let r=Is(t,this._firestore),i=new b0(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Y();let o=s[0];if(o.isFoundDocument())return new Yo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Yo(this._firestore,i,r._key,null,r.converter);throw Y()})}set(t,r,i){let s=Is(t,this._firestore),o=I_(s.converter,r,i),a=v_(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=Is(t,this._firestore),a;return a=typeof(r=H(r))=="string"||r instanceof Ir?rD(this._dataReader,"Transaction.update",o._key,r,i,s):nD(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=Is(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Is(e,this._firestore),r=new Vi(this._firestore);return super.get(e).then(i=>new er(this._firestore,r,t._key,i._document,new Mi(!1,!1),t.converter))}};function hV(n,e,t){n=xe(n,Xe);let r=Object.assign(Object.assign({},uQ),t);return function(s){if(s.maxAttempts<1)throw new k(P.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new St;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let u=yield XK(s);new c0(s.asyncQueue,u,a,o,c).Xa()})),c.promise}(Pt(n),i=>e(new C0(n,i)),r)}function fV(){return new ih("deleteField")}function pV(){return new g0("serverTimestamp")}function mV(...n){return new _0("arrayUnion",n)}function gV(...n){return new y0("arrayRemove",n)}function _V(n){return new v0("increment",n)}(function(e,t=!0){(function(i){eu=i})(hn),dn(new Ve("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Xe(new xb(r.getProvider("auth-internal")),new kb(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new k(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ss(u.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),ft(KO,"4.6.3",e),ft(KO,"4.6.3","esm2017")})();var lQ="@firebase/firestore-compat",dQ="0.3.32";function gD(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function yV(){if(typeof Uint8Array>"u")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function vV(){if(!uL())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}var E_=class n{constructor(e){this._delegate=e}static fromBase64String(e){return vV(),new n(ii.fromBase64String(e))}static fromUint8Array(e){return yV(),new n(ii.fromUint8Array(e))}toBase64(){return vV(),this._delegate.toBase64()}toUint8Array(){return yV(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function dD(n){return hQ(n,["next","error","complete"])}function hQ(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var hD=class{enableIndexedDbPersistence(e,t){return xF(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return NF(e._delegate)}clearIndexedDbPersistence(e){return MF(e._delegate)}},T_=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ss||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Xn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){DF(this._delegate,e,t,r)}enableNetwork(){return OF(this._delegate)}disableNetwork(){return LF(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,X0("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return kF(this._delegate)}onSnapshotsInSync(e){return dV(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new uu(this,Z0(this._delegate,e))}catch(t){throw mn(t,"collection()","Firestore.collection()")}}doc(e){try{return new si(this,hh(this._delegate,e))}catch(t){throw mn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ia(this,SF(this._delegate,e))}catch(t){throw mn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return hV(this._delegate,t=>e(new b_(this,t)))}batch(){return Pt(this._delegate),new C_(new f_(this._delegate,e=>ou(this._delegate,e)))}loadBundle(e){return FF(this._delegate,e)}namedQuery(e){return VF(this._delegate,e).then(t=>t?new ia(this,t):null)}},au=class extends Zc{constructor(e){super(),this.firestore=e}convertBytes(e){return new E_(new ii(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return si.forKey(t,this.firestore,null)}};function fQ(n){Q1(n)}var b_=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new au(e)}get(e){let t=ta(e);return this._delegate.get(t).then(r=>new na(this._firestore,new er(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=ta(e);return r?(gD("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=ta(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=ta(e);return this._delegate.delete(t),this}},C_=class{constructor(e){this._delegate=e}set(e,t,r){let i=ta(e);return r?(gD("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=ta(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=ta(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},cu=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Ts(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ra(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new au(e),t),i.set(t,s)),s}};cu.INSTANCES=new WeakMap;var si=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new au(e)}static forPath(e,t,r){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new ze(t._delegate,r,new q(e)))}static forKey(e,t,r){return new n(t,new ze(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new uu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new uu(this.firestore,Z0(this._delegate,e))}catch(t){throw mn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=H(e),e instanceof ze?eD(this._delegate,e):!1}set(e,t){t=gD("DocumentReference.set",t);try{return t?aD(this._delegate,e,t):aD(this._delegate,e)}catch(r){throw mn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?cD(this._delegate,e):cD(this._delegate,e,t,...r)}catch(i){throw mn(i,"updateDoc()","DocumentReference.update()")}}delete(){return uV(this._delegate)}onSnapshot(...e){let t=wV(e),r=IV(e,i=>new na(this.firestore,new er(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return uD(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=iV(this._delegate):e?.source==="server"?t=sV(this._delegate):t=rV(this._delegate),t.then(r=>new na(this.firestore,new er(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(cu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function mn(n,e,t){return n.message=n.message.replace(e,t),n}function wV(n){for(let e of n)if(typeof e=="object"&&!dD(e))return e;return{}}function IV(n,e){var t,r;let i;return dD(n[0])?i=n[0]:dD(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var na=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new si(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return oD(this._delegate,e._delegate)}},ra=class extends na{data(e){let t=this._delegate.data(e);return this._delegate._converter||Y1(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},ia=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new au(e)}where(e,t,r){try{return new n(this.firestore,Bi(this._delegate,WF(e,t,r)))}catch(i){throw mn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Bi(this._delegate,KF(e,t)))}catch(r){throw mn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Bi(this._delegate,QF(e)))}catch(t){throw mn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Bi(this._delegate,YF(e)))}catch(t){throw mn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Bi(this._delegate,JF(...e)))}catch(t){throw mn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Bi(this._delegate,XF(...e)))}catch(t){throw mn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Bi(this._delegate,ZF(...e)))}catch(t){throw mn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Bi(this._delegate,eV(...e)))}catch(t){throw mn(t,"endAt()","Query.endAt()")}}isEqual(e){return tD(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=aV(this._delegate):e?.source==="server"?t=cV(this._delegate):t=oV(this._delegate),t.then(r=>new fh(this.firestore,new Er(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=wV(e),r=IV(e,i=>new fh(this.firestore,new Er(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return uD(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(cu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},fD=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new ra(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},fh=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new ia(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ra(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new fD(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new ra(this._firestore,r))})}isEqual(e){return oD(this._delegate,e._delegate)}},uu=class n extends ia{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new si(this.firestore,e):null}doc(e){try{return e===void 0?new si(this.firestore,hh(this._delegate)):new si(this.firestore,hh(this._delegate,e))}catch(t){throw mn(t,"doc()","CollectionReference.doc()")}}add(e){return lV(this._delegate,e).then(t=>new si(this.firestore,t))}isEqual(e){return eD(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(cu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ta(n){return xe(n,ze)}var pD=class n{constructor(...e){this._delegate=new Ir(...e)}static documentId(){return new n(mt.keyField().canonicalString())}isEqual(e){return e=H(e),e instanceof Ir?this._delegate._internalPath.isEqual(e._internalPath):!1}};var mD=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=pV();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=fV();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=mV(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=gV(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=_V(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var pQ={Firestore:T_,GeoPoint:Qo,Timestamp:nt,Blob:E_,Transaction:b_,WriteBatch:C_,DocumentReference:si,DocumentSnapshot:na,Query:ia,QueryDocumentSnapshot:ra,QuerySnapshot:fh,CollectionReference:uu,FieldPath:pD,FieldValue:mD,setLogLevel:fQ,CACHE_SIZE_UNLIMITED:AF};function mQ(n,e){n.INTERNAL.registerComponent(new Ve("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},pQ)))}function gQ(n){mQ(n,(e,t)=>new T_(e,t,new hD)),n.registerVersion(lQ,dQ)}gQ(X);var xV="firebasestorage.googleapis.com",NV="storageBucket",_Q=2*60*1e3,yQ=10*60*1e3,vQ=1e3;var rt=class n extends at{constructor(e,t,r=0){super(_D(e),`Firebase Storage: ${t} (${_D(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return _D(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Ze=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Ze||{});function _D(n){return"storage/"+n}function CD(){let n="An unknown error occurred, please check the error payload for server response.";return new rt(Ze.UNKNOWN,n)}function wQ(n){return new rt(Ze.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function IQ(n){return new rt(Ze.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function EQ(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new rt(Ze.UNAUTHENTICATED,n)}function TQ(){return new rt(Ze.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function bQ(n){return new rt(Ze.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function PV(){return new rt(Ze.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function MV(){return new rt(Ze.CANCELED,"User canceled the upload/download.")}function CQ(n){return new rt(Ze.INVALID_URL,"Invalid URL '"+n+"'.")}function DQ(n){return new rt(Ze.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function SQ(){return new rt(Ze.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+NV+"' property when initializing the app?")}function kV(){return new rt(Ze.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function AQ(){return new rt(Ze.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function RQ(){return new rt(Ze.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function xQ(n){return new rt(Ze.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function sa(n){return new rt(Ze.INVALID_ARGUMENT,n)}function OV(){return new rt(Ze.APP_DELETED,"The Firebase app was deleted.")}function DD(n){return new rt(Ze.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function mh(n,e){return new rt(Ze.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function ph(n){throw new rt(Ze.INTERNAL_ERROR,"Internal error: "+n)}var gn=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw DQ(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(Q){Q.path.charAt(Q.path.length-1)==="/"&&(Q.path_=Q.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function u(Q){Q.path_=decodeURIComponent(Q.path)}let d="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",_=new RegExp(`^https?://${h}/${d}/b/${i}/o${p}`,"i"),w={bucket:1,path:3},C=t===xV?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",F=new RegExp(`^https?://${C}/${i}/${A}`,"i"),U=[{regex:a,indices:c,postModify:s},{regex:_,indices:w,postModify:u},{regex:F,indices:{bucket:1,path:2},postModify:u}];for(let Q=0;Q<U.length;Q++){let se=U[Q],J=se.regex.exec(e);if(J){let T=J[se.indices.bucket],v=J[se.indices.path];v||(v=""),r=new n(T,v),se.postModify(r);break}}if(r==null)throw CQ(e);return r}},vD=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function NQ(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let u=!1;function d(...A){u||(u=!0,e.apply(null,A))}function h(A){i=setTimeout(()=>{i=null,n(_,c())},A)}function p(){s&&clearTimeout(s)}function _(A,...F){if(u){p();return}if(A){p(),d.call(null,A,...F);return}if(c()||o){p(),d.call(null,A,...F);return}r<64&&(r*=2);let U;a===1?(a=2,U=0):U=(r+Math.random())*1e3,h(U)}let w=!1;function C(A){w||(w=!0,p(),!u&&(i!==null?(A||(a=2),clearTimeout(i),h(0)):A||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,C(!0)},t),C}function PQ(n){n(!1)}function MQ(n){return n!==void 0}function kQ(n){return typeof n=="function"}function OQ(n){return typeof n=="object"&&!Array.isArray(n)}function A_(n){return typeof n=="string"||n instanceof String}function EV(n){return SD()&&n instanceof Blob}function SD(){return typeof Blob<"u"}function wD(n,e,t,r){if(r<e)throw sa(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw sa(`Invalid value for '${n}'. Expected ${t} or less.`)}function Fs(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function LV(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var hu=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(hu||{});function FV(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var ID=class{constructor(e,t,r,i,s,o,a,c,u,d,h,p=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,w)=>{this.resolve_=_,this.reject_=w,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new du(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===hu.NO_ERROR,c=s.getStatus();if(!a||FV(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===hu.ABORT;r(!1,new du(!1,null,d));return}let u=this.successCodes_.indexOf(c)!==-1;r(!0,new du(u,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());MQ(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=CD();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?OV():MV();o(c)}else{let c=PV();o(c)}};this.canceled_?t(!1,new du(!1,null,!0)):this.backoffId_=NQ(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&PQ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},du=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function LQ(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function FQ(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function VQ(n,e){e&&(n["X-Firebase-GMPID"]=e)}function UQ(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function BQ(n,e,t,r,i,s,o=!0){let a=LV(n.urlParams),c=n.url+a,u=Object.assign({},n.headers);return VQ(u,e),LQ(u,t),FQ(u,s),UQ(u,r),new ID(c,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function jQ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function $Q(...n){let e=jQ();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(SD())return new Blob(n);throw new rt(Ze.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function HQ(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function qQ(n){if(typeof atob>"u")throw xQ("base-64");return atob(n)}var Ln={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},gh=class{constructor(e,t){this.data=e,this.contentType=t||null}};function AD(n,e){switch(n){case Ln.RAW:return new gh(VV(e));case Ln.BASE64:case Ln.BASE64URL:return new gh(UV(n,e));case Ln.DATA_URL:return new gh(GQ(e),WQ(e))}throw CD()}function VV(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function zQ(n){let e;try{e=decodeURIComponent(n)}catch{throw mh(Ln.DATA_URL,"Malformed data URL.")}return VV(e)}function UV(n,e){switch(n){case Ln.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw mh(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Ln.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw mh(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=qQ(e)}catch(i){throw i.message.includes("polyfill")?i:mh(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var S_=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw mh(Ln.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=KQ(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function GQ(n){let e=new S_(n);return e.base64?UV(Ln.BASE64,e.rest):zQ(e.rest)}function WQ(n){return new S_(n).contentType}function KQ(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var fu=class n{constructor(e,t){let r=0,i="";EV(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(EV(this.data_)){let r=this.data_,i=HQ(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(SD()){let t=e.map(r=>r instanceof n?r.data_:r);return new n($Q.apply(null,t))}else{let t=e.map(o=>A_(o)?AD(Ln.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function RD(n){let e;try{e=JSON.parse(n)}catch{return null}return OQ(e)?e:null}function QQ(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function YQ(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function BV(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function JQ(n,e){return e}var qt=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||JQ}},D_=null;function XQ(n){return!A_(n)||n.length<2?n:BV(n)}function R_(){if(D_)return D_;let n=[];n.push(new qt("bucket")),n.push(new qt("generation")),n.push(new qt("metageneration")),n.push(new qt("name","fullPath",!0));function e(s,o){return XQ(o)}let t=new qt("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new qt("size");return i.xform=r,n.push(i),n.push(new qt("timeCreated")),n.push(new qt("updated")),n.push(new qt("md5Hash",null,!0)),n.push(new qt("cacheControl",null,!0)),n.push(new qt("contentDisposition",null,!0)),n.push(new qt("contentEncoding",null,!0)),n.push(new qt("contentLanguage",null,!0)),n.push(new qt("contentType",null,!0)),n.push(new qt("metadata","customMetadata",!0)),D_=n,D_}function ZQ(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new gn(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function e7(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return ZQ(r,n),r}function jV(n,e,t){let r=RD(e);return r===null?null:e7(n,r,t)}function t7(n,e,t,r){let i=RD(e);if(i===null||!A_(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(u=>{let d=n.bucket,h=n.fullPath,p="/b/"+o(d)+"/o/"+o(h),_=Fs(p,t,r),w=LV({alt:"media",token:u});return _+w})[0]}function xD(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var TV="prefixes",bV="items";function n7(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[TV])for(let i of t[TV]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new gn(e,s));r.prefixes.push(o)}if(t[bV])for(let i of t[bV]){let s=n._makeStorageReference(new gn(e,i.name));r.items.push(s)}return r}function r7(n,e,t){let r=RD(t);return r===null?null:n7(n,e,r)}var Tr=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function ai(n){if(!n)throw CD()}function x_(n,e){function t(r,i){let s=jV(n,i,e);return ai(s!==null),s}return t}function i7(n,e){function t(r,i){let s=r7(n,e,i);return ai(s!==null),s}return t}function s7(n,e){function t(r,i){let s=jV(n,i,e);return ai(s!==null),t7(s,i,n.host,n._protocol)}return t}function gu(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=TQ():i=EQ():t.getStatus()===402?i=IQ(n.bucket):t.getStatus()===403?i=bQ(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function N_(n){let e=gu(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=wQ(n.path)),s.serverResponse=i.serverResponse,s}return t}function $V(n,e,t){let r=e.fullServerUrl(),i=Fs(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Tr(i,s,x_(n,t),o);return a.errorHandler=N_(e),a}function o7(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=Fs(o,n.host,n._protocol),c="GET",u=n.maxOperationRetryTime,d=new Tr(a,c,i7(n,e.bucket),u);return d.urlParams=s,d.errorHandler=gu(e),d}function a7(n,e,t){let r=e.fullServerUrl(),i=Fs(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Tr(i,s,s7(n,t),o);return a.errorHandler=N_(e),a}function c7(n,e,t,r){let i=e.fullServerUrl(),s=Fs(i,n.host,n._protocol),o="PATCH",a=xD(t,r),c={"Content-Type":"application/json; charset=utf-8"},u=n.maxOperationRetryTime,d=new Tr(s,o,x_(n,r),u);return d.headers=c,d.body=a,d.errorHandler=N_(e),d}function u7(n,e){let t=e.fullServerUrl(),r=Fs(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,u){}let a=new Tr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=N_(e),a}function l7(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function HV(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=l7(null,e)),r}function d7(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let U="";for(let Q=0;Q<2;Q++)U=U+Math.random().toString().slice(2);return U}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let u=HV(e,r,i),d=xD(u,t),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+c+"--",_=fu.getBlob(h,r,p);if(_===null)throw kV();let w={name:u.fullPath},C=Fs(s,n.host,n._protocol),A="POST",F=n.maxUploadRetryTime,G=new Tr(C,A,x_(n,t),F);return G.urlParams=w,G.headers=o,G.body=_.uploadData(),G.errorHandler=gu(e),G}var pu=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function ND(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{ai(!1)}return ai(!!t&&(e||["active"]).indexOf(t)!==-1),t}function h7(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=HV(e,r,i),a={name:o.fullPath},c=Fs(s,n.host,n._protocol),u="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=xD(o,t),p=n.maxUploadRetryTime;function _(C){ND(C);let A;try{A=C.getResponseHeader("X-Goog-Upload-URL")}catch{ai(!1)}return ai(A_(A)),A}let w=new Tr(c,u,_,p);return w.urlParams=a,w.headers=d,w.body=h,w.errorHandler=gu(e),w}function f7(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(u){let d=ND(u,["active","final"]),h=null;try{h=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{ai(!1)}h||ai(!1);let p=Number(h);return ai(!isNaN(p)),new pu(p,r.size(),d==="final")}let o="POST",a=n.maxUploadRetryTime,c=new Tr(t,o,s,a);return c.headers=i,c.errorHandler=gu(e),c}var CV=256*1024;function p7(n,e,t,r,i,s,o,a){let c=new pu(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw AQ();let u=c.total-c.current,d=u;i>0&&(d=Math.min(d,i));let h=c.current,p=h+d,_="";d===0?_="finalize":u===d?_="upload, finalize":_="upload";let w={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${c.current}`},C=r.slice(h,p);if(C===null)throw kV();function A(Q,se){let J=ND(Q,["active","final"]),T=c.current+d,v=r.size(),I;return J==="final"?I=x_(e,s)(Q,se):I=null,new pu(T,v,J==="final",I)}let F="POST",G=e.maxUploadRetryTime,U=new Tr(t,F,A,G);return U.headers=w,U.body=C.uploadData(),U.progressCallback=a||null,U.errorHandler=gu(n),U}var qV={STATE_CHANGED:"state_changed"},tn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function yD(n){switch(n){case"running":case"pausing":case"canceling":return tn.RUNNING;case"paused":return tn.PAUSED;case"success":return tn.SUCCESS;case"canceled":return tn.CANCELED;case"error":return tn.ERROR;default:return tn.ERROR}}var ED=class{constructor(e,t,r){if(kQ(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function lu(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var DV=null,TD=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=hu.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=hu.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=hu.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw ph("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ph("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ph("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ph("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ph("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},bD=class extends TD{initXhr(){this.xhr_.responseType="text"}};function oi(){return DV?DV():new bD}var _h=class{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=R_(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Ze.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(FV(i.status,[]))if(s)i=PV();else{this.sleepTime=Math.max(this.sleepTime*2,vQ),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Ze.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=h7(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,oi,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=f7(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,oi,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=CV*this._chunkMultiplier,t=new pu(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=p7(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,oi,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){CV*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=$V(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,oi,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=d7(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,oi,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=MV(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=yD(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new ED(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(yD(this._state)){case tn.SUCCESS:lu(this._resolve.bind(null,this.snapshot))();break;case tn.CANCELED:case tn.ERROR:let t=this._reject;lu(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(yD(this._state)){case tn.RUNNING:case tn.PAUSED:e.next&&lu(e.next.bind(e,this.snapshot))();break;case tn.SUCCESS:e.complete&&lu(e.complete.bind(e))();break;case tn.CANCELED:case tn.ERROR:e.error&&lu(e.error.bind(e,this._error))();break;default:e.error&&lu(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var mu=class n{constructor(e,t){this._service=e,t instanceof gn?this._location=t:this._location=gn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new gn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return BV(this._location.path)}get storage(){return this._service}get parent(){let e=QQ(this._location.path);if(e===null)return null;let t=new gn(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw DD(e)}};function m7(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new _h(n,new fu(e),t)}function g7(n){let e={prefixes:[],items:[]};return zV(n,e).then(()=>e)}function zV(n,e,t){return g(this,null,function*(){let i=yield GV(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield zV(n,e,i.nextPageToken))})}function GV(n,e){e!=null&&typeof e.maxResults=="number"&&wD("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=o7(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,oi)}function _7(n){n._throwIfRoot("getMetadata");let e=$V(n.storage,n._location,R_());return n.storage.makeRequestWithTokens(e,oi)}function y7(n,e){n._throwIfRoot("updateMetadata");let t=c7(n.storage,n._location,e,R_());return n.storage.makeRequestWithTokens(t,oi)}function v7(n){n._throwIfRoot("getDownloadURL");let e=a7(n.storage,n._location,R_());return n.storage.makeRequestWithTokens(e,oi).then(t=>{if(t===null)throw RQ();return t})}function w7(n){n._throwIfRoot("deleteObject");let e=u7(n.storage,n._location);return n.storage.makeRequestWithTokens(e,oi)}function WV(n,e){let t=YQ(n._location.path,e),r=new gn(n._location.bucket,t);return new mu(n.storage,r)}function I7(n){return/^[A-Za-z]+:\/\//.test(n)}function E7(n,e){return new mu(n,e)}function KV(n,e){if(n instanceof yh){let t=n;if(t._bucket==null)throw SQ();let r=new mu(t,t._bucket);return e!=null?KV(r,e):r}else return e!==void 0?WV(n,e):n}function T7(n,e){if(e&&I7(e)){if(n instanceof yh)return E7(n,e);throw sa("To use ref(service, url), the first argument must be a Storage instance.")}else return KV(n,e)}function SV(n,e){let t=e?.[NV];return t==null?null:gn.makeFromBucketSpec(t,n)}function b7(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:cc(i,n.app.options.projectId))}var yh=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=xV,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=_Q,this._maxUploadRetryTime=yQ,this._requests=new Set,i!=null?this._bucket=gn.makeFromBucketSpec(i,this._host):this._bucket=SV(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=gn.makeFromBucketSpec(this._url,e):this._bucket=SV(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){wD("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){wD("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return g(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return g(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new mu(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new vD(OV());{let o=BQ(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return g(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},AV="@firebase/storage",RV="0.12.5";var C7="storage";function QV(n,e,t){return n=H(n),m7(n,e,t)}function YV(n){return n=H(n),_7(n)}function JV(n,e){return n=H(n),y7(n,e)}function XV(n,e){return n=H(n),GV(n,e)}function ZV(n){return n=H(n),g7(n)}function eU(n){return n=H(n),v7(n)}function tU(n){return n=H(n),w7(n)}function PD(n,e){return n=H(n),T7(n,e)}function nU(n,e){return WV(n,e)}function rU(n,e,t,r={}){b7(n,e,t,r)}function D7(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new yh(t,r,i,e,hn)}function S7(){dn(new Ve(C7,D7,"PUBLIC").setMultipleInstances(!0)),ft(AV,RV,""),ft(AV,RV,"esm2017")}S7();var _u=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var P_=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new _u(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new _u(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new _u(o,this,this._ref)):s={next:t.next?o=>t.next(new _u(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},M_=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new oa(e,this._service))}get items(){return this._delegate.items.map(e=>new oa(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var oa=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=nU(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new P_(QV(this._delegate,e,t),this)}putString(e,t=Ln.RAW,r){this._throwIfRoot("putString");let i=AD(t,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new P_(new _h(this._delegate,new fu(i.data,!0),s),this)}listAll(){return ZV(this._delegate).then(e=>new M_(e,this.storage))}list(e){return XV(this._delegate,e||void 0).then(t=>new M_(t,this.storage))}getMetadata(){return YV(this._delegate)}updateMetadata(e){return JV(this._delegate,e)}getDownloadURL(){return eU(this._delegate)}delete(){return this._throwIfRoot("delete"),tU(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw DD(e)}};var k_=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(iU(e))throw sa("ref() expected a child path but got a URL, use refFromURL instead.");return new oa(PD(this._delegate,e),this)}refFromURL(e){if(!iU(e))throw sa("refFromURL() expected a full URL but got a child path, use ref() instead.");try{gn.makeFromUrl(e,this._delegate.host)}catch{throw sa("refFromUrl() expected a valid full URL but got an invalid one.")}return new oa(PD(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){rU(this._delegate,e,t,r)}};function iU(n){return/^[A-Za-z]+:\/\//.test(n)}var A7="@firebase/storage-compat",R7="0.3.8";var x7="storage-compat";function N7(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new k_(t,r)}function P7(n){let e={TaskState:tn,TaskEvent:qV,StringFormat:Ln,Storage:k_,Reference:oa};n.INTERNAL.registerComponent(new Ve(x7,N7,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(A7,R7)}P7(X);var sU="@firebase/database",oU="1.0.5";var qS="";function zS(n){qS=n}var BD=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),wt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:oc(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var jD=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return ln(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var FU=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new BD(e)}}catch{}return new jD},ca=FU("localStorage"),$D=FU("sessionStorage");var Iu=new Cn("@firebase/database"),VU=function(){let n=1;return function(){return n++}}(),UU=function(n){let e=yk(n),t=new wm;t.update(e);let r=t.digest();return Im.encodeByteArray(r)},$h=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=$h.apply(null,r):typeof r=="object"?e+=wt(r):e+=r,e+=" "}return e},ua=null,aU=!0,BU=function(n,e){B(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Iu.logLevel=ge.VERBOSE,ua=Iu.log.bind(Iu),e&&$D.set("logging_enabled",!0)):typeof n=="function"?ua=n:(ua=null,$D.remove("logging_enabled"))},Vt=function(...n){if(aU===!0&&(aU=!1,ua===null&&$D.get("logging_enabled")===!0&&BU(!0)),ua){let e=$h.apply(null,n);ua(e)}},Hh=function(n){return function(...e){Vt(n,...e)}},HD=function(...n){let e="FIREBASE INTERNAL ERROR: "+$h(...n);Iu.error(e)},li=function(...n){let e=`FIREBASE FATAL ERROR: ${$h(...n)}`;throw Iu.error(e),new Error(e)},nn=function(...n){let e="FIREBASE WARNING: "+$h(...n);Iu.warn(e)},M7=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&nn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},cy=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},k7=function(n){if($r()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},js="[MIN_NAME]",ji="[MAX_NAME]",da=function(n,e){if(n===e)return 0;if(n===js||e===ji)return-1;if(e===js||n===ji)return 1;{let t=cU(n),r=cU(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},O7=function(n,e){return n===e?0:n<e?-1:1},vh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+wt(e))},GS=function(n){if(typeof n!="object"||n===null)return wt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=wt(e[r]),t+=":",t+=GS(n[e[r]]);return t+="}",t},jU=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Ut(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var $U=function(n){B(!cy(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let u=[];for(c=t;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();let d=u.join(""),h="";for(c=0;c<64;c+=8){let p=parseInt(d.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),h=h+p}return h.toLowerCase()},L7=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},F7=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function V7(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var U7=new RegExp("^-?(0*)\\d{1,10}$"),B7=-2147483648,j7=2147483647,cU=function(n){if(U7.test(n)){let e=Number(n);if(e>=B7&&e<=j7)return e}return null},xu=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw nn("Exception was thrown by user callback.",t),e},Math.floor(0))}},$7=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Th=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var qD=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){nn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var zD=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Vt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',nn(e)}},bh=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),L_="5",HU="v",qU="s",zU="r",GU="f",WU=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,KU="ls",QU="p",GD="ac",YU="websocket",JU="long_polling";var F_=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ca.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ca.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function H7(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function XU(n,e,t){B(typeof e=="string","typeof type must == string"),B(typeof t=="object","typeof params must == object");let r;if(e===YU)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===JU)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);H7(n)&&(t.ns=n.namespace);let i=[];return Ut(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var WD=class{constructor(){this.counters_={}}incrementCounter(e,t=1){ln(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return hk(this.counters_)}};var MD={},kD={};function WS(n){let e=n.toString();return MD[e]||(MD[e]=new WD),MD[e]}function q7(n,e){let t=n.toString();return kD[t]||(kD[t]=e()),kD[t]}var KD=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&xu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var uU="start",z7="close",G7="pLPCommand",W7="pRTLPCB",ZU="id",e2="pw",t2="ser",K7="cb",Q7="seg",Y7="ts",J7="d",X7="dframe",n2=1870,r2=30,Z7=n2-r2,eY=25e3,tY=3e4,Ah=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Hh(e),this.stats_=WS(t),this.urlFn=c=>(this.appCheckToken&&(c[GD]=this.appCheckToken),XU(t,JU,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new KD(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(tY)),k7(()=>{if(this.isClosed_)return;this.scriptTagHolder=new QD((...s)=>{let[o,a,c,u,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===uU)this.id=a,this.password=c;else if(o===z7)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[uU]="t",r[t2]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[K7]=this.scriptTagHolder.uniqueCallbackIdentifier),r[HU]=L_,this.transportSessionId&&(r[qU]=this.transportSessionId),this.lastSessionId&&(r[KU]=this.lastSessionId),this.applicationId&&(r[QU]=this.applicationId),this.appCheckToken&&(r[GD]=this.appCheckToken),typeof location<"u"&&location.hostname&&WU.test(location.hostname)&&(r[zU]=GU);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return $r()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!L7()&&!F7()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=wt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=pE(t),i=jU(r,Z7);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if($r())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[X7]="t",r[ZU]=e,r[e2]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=wt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},QD=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,$r())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=VU(),window[G7+this.uniqueCallbackIdentifier]=e,window[W7+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Vt("frame writing exception"),a.stack&&Vt(a.stack),Vt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Vt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[ZU]=this.myID,e[e2]=this.myPW,e[t2]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+r2+r.length<=n2;){let o=this.pendingSegs.shift();r=r+"&"+Q7+i+"="+o.seg+"&"+Y7+i+"="+o.ts+"&"+J7+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(eY)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){$r()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Vt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var nY=16384,rY=45e3,V_=null;typeof MozWebSocket<"u"?V_=MozWebSocket:typeof WebSocket<"u"&&(V_=WebSocket);var vu=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Hh(this.connId),this.stats_=WS(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[HU]=L_,!$r()&&typeof location<"u"&&location.hostname&&WU.test(location.hostname)&&(a[zU]=GU),r&&(a[qU]=r),i&&(a[KU]=i),s&&(a[GD]=s),o&&(a[QU]=o),XU(t,YU,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ca.set("previous_websocket_failure",!0);try{let i;if($r()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${L_}/${qS}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new V_(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&V_!==null&&!n.forceDisallow_}static previouslyFailed(){return ca.isInMemoryStorage||ca.get("previous_websocket_failure")===!0}markConnectionHealthy(){ca.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=oc(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(B(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=wt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=jU(r,nY);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(rY))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),i2=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Ah,vu]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=vu&&vu.isAvailable(),i=r&&!vu.previouslyFailed();if(t.webSocketOnly&&(r||nn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[vu];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),iY=6e4,sY=5e3,oY=10*1024,aY=100*1024,OD="t",lU="d",cY="s",dU="r",uY="e",hU="o",fU="a",pU="n",mU="p",lY="h",YD=class{constructor(e,t,r,i,s,o,a,c,u,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Hh("c:"+this.id+":"),this.transportManager_=new i2(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Th(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>aY?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>oY?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(OD in e){let t=e[OD];t===fU?this.upgradeIfSecondaryHealthy_():t===dU?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===hU&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=vh("t",e),r=vh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:mU,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:fU,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:pU,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=vh("t",e),r=vh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=vh(OD,e);if(lU in e){let r=e[lU];if(t===lY){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===pU){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===cY?this.onConnectionShutdown_(r):t===dU?this.onReset_(r):t===uY?HD("Server Error: "+r):t===hU?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):HD("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),L_!==r&&nn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Th(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(iY))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Th(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(sY))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:mU,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ca.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var U_=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var B_=class{constructor(e){this.allowedEvents_=e,this.listeners_={},B(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){B(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var j_=class n extends B_{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Xl()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return B(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var gU=32,_U=768,ke=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Me(){return new ke("")}function _e(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function $s(n){return n.pieces_.length-n.pieceNum_}function He(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ke(n.pieces_,e)}function KS(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function dY(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Rh(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function s2(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ke(e,0)}function et(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof ke)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new ke(t,0)}function ye(n){return n.pieceNum_>=n.pieces_.length}function _n(n,e){let t=_e(n),r=_e(e);if(t===null)return e;if(t===r)return _n(He(n),He(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function hY(n,e){let t=Rh(n,0),r=Rh(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=da(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function QS(n,e){if($s(n)!==$s(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function tr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if($s(n)>$s(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var JD=class{constructor(e,t){this.errorPrefix_=t,this.parts_=Rh(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=ed(this.parts_[r]);o2(this)}};function fY(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=ed(e),o2(n)}function pY(n){let e=n.parts_.pop();n.byteLength_-=ed(e),n.parts_.length>0&&(n.byteLength_-=1)}function o2(n){if(n.byteLength_>_U)throw new Error(n.errorPrefix_+"has a key path longer than "+_U+" bytes ("+n.byteLength_+").");if(n.parts_.length>gU)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+gU+") or object contains a cycle "+aa(n))}function aa(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var XD=class n extends B_{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return B(e==="visible","Unknown event type: "+e),[this.visible_]}};var wh=1e3,mY=60*5*1e3,yU=30*1e3,gY=1.3,_Y=3e4,yY="server_kill",vU=3,YS=(()=>{class n extends U_{constructor(t,r,i,s,o,a,c,u){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=Hh("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=wh,this.maxReconnectDelay_=mY,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!$r())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");XD.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&j_.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(wt(o)),B(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new xt,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),B(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),B(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let u=c.d,d=c.s;n.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,u))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&ln(t,"w")){let i=as(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();nn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||_k(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=yU)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=gk(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),B(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+wt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):HD("Unrecognized action received from server: "+wt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){B(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=wh,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=wh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>_Y&&(this.reconnectDelay_=wh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*gY)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},d=function(p){B(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(p)};this.realtime_={close:u,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[p,_]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?Vt("getToken() completed but was canceled"):(Vt("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=_&&_.token,c=new YD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,w=>{nn(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(yY)},o))}catch(p){this.log_("Failed to get token: "+p),a||(this.repoInfo_.nodeAdmin&&nn(p),u())}}})}interrupt(t){Vt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Vt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],uc(this.interruptReasons_)&&(this.reconnectDelay_=wh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>GS(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new ke(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Vt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=vU&&(this.reconnectDelay_=yU,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Vt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=vU&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";$r()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+qS.replace(/\./g,"-")]=1,Xl()?t["framework.cordova"]=1:go()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=j_.getInstance().currentlyOnline();return uc(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),we=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Eu=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new we(js,e),i=new we(js,t);return this.compare(r,i)!==0}minPost(){return we.MIN}};var O_,$_=class extends Eu{static get __EMPTY_NODE(){return O_}static set __EMPTY_NODE(e){O_=e}compare(e,t){return da(e.name,t.name)}isDefinedOn(e){throw mo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return we.MIN}maxPost(){return new we(ji,O_)}makePost(e,t){return B(typeof e=="string","KeyIndex indexValue must always be a string."),new we(e,O_)}toString(){return".key"}},ui=new $_;var wu=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},br=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??nr.EMPTY_NODE,this.right=o??nr.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return nr.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return nr.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),ZD=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new br(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},nr=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,br.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,br.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new wu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new wu(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new wu(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new wu(this.root_,null,this.comparator_,!0,e)}};nr.EMPTY_NODE=new ZD;function vY(n,e){return da(n.name,e.name)}function JS(n,e){return da(n,e)}var eS;function wY(n){eS=n}var a2=function(n){return typeof n=="number"?"number:"+$U(n):"string:"+n},c2=function(n){if(n.isLeafNode()){let e=n.val();B(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ln(e,".sv"),"Priority must be a string or number.")}else B(n===eS||n.isEmpty(),"priority of unexpected type.");B(n===eS||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var wU,Tu=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,B(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),c2(this.priorityNode_)}static set __childrenNodeConstructor(t){wU=t}static get __childrenNodeConstructor(){return wU}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return ye(t)?this:_e(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=_e(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(B(i!==".priority"||$s(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(He(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+a2(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=$U(this.value_):t+=this.value_,this.lazyHash_=UU(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(B(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return B(s>=0,"Unknown leaf type: "+r),B(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),u2,l2;function IY(n){u2=n}function EY(n){l2=n}var tS=class extends Eu{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?da(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return we.MIN}maxPost(){return new we(ji,new Tu("[PRIORITY-POST]",l2))}makePost(e,t){let r=u2(e);return new we(t,new Tu("[PRIORITY-POST]",r))}toString(){return".priority"}},Ge=new tS;var TY=Math.log(2),nS=class{constructor(e){let t=s=>parseInt(Math.log(s)/TY,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},H_=function(n,e,t,r){n.sort(e);let i=function(c,u){let d=u-c,h,p;if(d===0)return null;if(d===1)return h=n[c],p=t?t(h):h,new br(p,h.node,br.BLACK,null,null);{let _=parseInt(d/2,10)+c,w=i(c,_),C=i(_+1,u);return h=n[_],p=t?t(h):h,new br(p,h.node,br.BLACK,w,C)}},s=function(c){let u=null,d=null,h=n.length,p=function(w,C){let A=h-w,F=h;h-=w;let G=i(A+1,F),U=n[A],Q=t?t(U):U;_(new br(Q,U.node,C,null,G))},_=function(w){u?(u.left=w,u=w):(d=w,u=w)};for(let w=0;w<c.count;++w){let C=c.nextBitIsOne(),A=Math.pow(2,c.count-(w+1));C?p(A,br.BLACK):(p(A,br.BLACK),p(A,br.RED))}return d},o=new nS(n.length),a=s(o);return new nr(r||e,a)};var LD,yu={},bu=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return B(yu&&Ge,"ChildrenNode.ts has not been loaded"),LD=LD||new n({".priority":yu},{".priority":Ge}),LD}get(e){let t=as(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof nr?t:null}hasIndex(e){return ln(this.indexSet_,e.toString())}addIndex(e,t){B(e!==ui,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(we.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=H_(r,e.getCompare()):a=yu;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,u)}addToIndexes(e,t){let r=Zl(this.indexes_,(i,s)=>{let o=as(this.indexSet_,s);if(B(o,"Missing index implementation for "+s),i===yu)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(we.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),H_(a,o.getCompare())}else return yu;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new we(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Zl(this.indexes_,i=>{if(i===yu)return i;{let s=t.get(e.name);return s?i.remove(new we(e.name,s)):i}});return new n(r,this.indexSet_)}};var Ih,he=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&c2(this.priorityNode_),this.children_.isEmpty()&&B(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ih||(Ih=new n(new nr(JS),null,bu.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ih}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Ih:r}}getChild(t){let r=_e(t);return r===null?this:this.getImmediateChild(r).getChild(He(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(B(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new we(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Ih:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=_e(t);if(i===null)return r;{B(_e(t)!==".priority"||$s(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(He(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Ge,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+a2(this.getPriority().val())+":"),this.forEachChild(Ge,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":UU(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new we(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new we(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new we(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,we.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,we.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===qh?-1:0}withIndex(t){if(t===ui||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===ui||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ge),s=r.getIterator(Ge),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===ui?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),rS=class extends he{constructor(){super(new nr(JS),he.EMPTY_NODE,bu.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return he.EMPTY_NODE}isEmpty(){return!1}},qh=new rS;Object.defineProperties(we,{MIN:{value:new we(js,he.EMPTY_NODE)},MAX:{value:new we(ji,qh)}});$_.__EMPTY_NODE=he.EMPTY_NODE;Tu.__childrenNodeConstructor=he;wY(qh);EY(qh);var bY=!0;function it(n,e=null){if(n===null)return he.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),B(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Tu(t,it(e))}if(!(n instanceof Array)&&bY){let t=[],r=!1;if(Ut(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=it(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new we(o,c)))}}),t.length===0)return he.EMPTY_NODE;let s=H_(t,vY,o=>o.name,JS);if(r){let o=H_(t,Ge.getCompare());return new he(s,it(e),new bu({".priority":o},{".priority":Ge}))}else return new he(s,it(e),bu.Default)}else{let t=he.EMPTY_NODE;return Ut(n,(r,i)=>{if(ln(n,r)&&r.substring(0,1)!=="."){let s=it(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(it(e))}}IY(it);var xh=class extends Eu{constructor(e){super(),this.indexPath_=e,B(!ye(e)&&_e(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?da(e.name,t.name):s}makePost(e,t){let r=it(e),i=he.EMPTY_NODE.updateChild(this.indexPath_,r);return new we(t,i)}maxPost(){let e=he.EMPTY_NODE.updateChild(this.indexPath_,qh);return new we(ji,e)}toString(){return Rh(this.indexPath_,0).join("/")}};var iS=class extends Eu{compare(e,t){let r=e.node.compareTo(t.node);return r===0?da(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return we.MIN}maxPost(){return we.MAX}makePost(e,t){let r=it(e);return new we(t,r)}toString(){return".value"}},XS=new iS;function d2(n){return{type:"value",snapshotNode:n}}function Cu(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Nh(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Ph(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function CY(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var Mh=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){B(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(Nh(t,a)):B(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Cu(t,r)):o.trackChildChange(Ph(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ge,(i,s)=>{t.hasChild(i)||r.trackChildChange(Nh(i,s))}),t.isLeafNode()||t.forEachChild(Ge,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Ph(i,s,o))}else r.trackChildChange(Cu(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?he.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var q_=class n{constructor(e){this.indexedFilter_=new Mh(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new we(t,r))||(r=he.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=he.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(he.EMPTY_NODE);let s=this;return t.forEachChild(Ge,(o,a)=>{s.matches(new we(o,a))||(i=i.updateImmediateChild(o,he.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var sS=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new q_(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new we(t,r))||(r=he.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=he.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=he.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(he.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,he.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(p,_)=>h(_,p)}else o=this.index_.getCompare();let a=e;B(a.numChildren()===this.limit_,"");let c=new we(t,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(t)){let h=a.getImmediateChild(t),p=i.getChildAfterChild(this.index_,u,this.reverse_);for(;p!=null&&(p.name===t||a.hasChild(p.name));)p=i.getChildAfterChild(this.index_,p,this.reverse_);let _=p==null?1:o(p,c);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(Ph(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(Nh(t,h));let C=a.updateImmediateChild(t,he.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(s?.trackChildChange(Cu(p.name,p.node)),C.updateImmediateChild(p.name,p.node)):C}}else return r.isEmpty()?e:d&&o(u,c)>=0?(s!=null&&(s.trackChildChange(Nh(u.name,u.node)),s.trackChildChange(Cu(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(u.name,he.EMPTY_NODE)):e}};var kh=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ge}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return B(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return B(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:js}hasEnd(){return this.endSet_}getIndexEndValue(){return B(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return B(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ji}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return B(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ge}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function DY(n){return n.loadsAllData()?new Mh(n.getIndex()):n.hasLimit()?new sS(n):new q_(n)}function SY(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function AY(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function oS(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function RY(n,e,t){let r;return n.index_===ui||t?r=oS(n,e,t):r=oS(n,e,ji),r.startAfterSet_=!0,r}function aS(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function xY(n,e,t){let r;return n.index_===ui||t?r=aS(n,e,t):r=aS(n,e,js),r.endBeforeSet_=!0,r}function uy(n,e){let t=n.copy();return t.index_=e,t}function IU(n){let e={};if(n.isDefault())return e;let t;if(n.index_===Ge?t="$priority":n.index_===XS?t="$value":n.index_===ui?t="$key":(B(n.index_ instanceof xh,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=wt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=wt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+wt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=wt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+wt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function EU(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ge&&(e.i=n.index_.toString()),e}var cS=class n extends U_{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Hh("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(B(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=IU(e._queryParams);this.restRequest_(s+".json",c,(u,d)=>{let h=d;if(u===404&&(h=null,u=null),u===null&&this.onDataUpdate_(s,h,!1,r),as(this.listens_,o)===a){let p;u?u===401?p="permission_denied":p="rest_error:"+u:p="ok",i(p,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=IU(e._queryParams),r=e._path.toString(),i=new xt;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Si(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=oc(a.responseText)}catch{nn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&nn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var uS=class{constructor(){this.rootNode_=he.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function z_(){return{value:null,children:new Map}}function Nu(n,e,t){if(ye(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=_e(e);n.children.has(r)||n.children.set(r,z_());let i=n.children.get(r);e=He(e),Nu(i,e,t)}}function lS(n,e){if(ye(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(Ge,(r,i)=>{Nu(n,new ke(r),i)}),lS(n,e)}}else if(n.children.size>0){let t=_e(e);return e=He(e),n.children.has(t)&&lS(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function dS(n,e,t){n.value!==null?t(e,n.value):NY(n,(r,i)=>{let s=new ke(e.toString()+"/"+r);dS(i,s,t)})}function NY(n,e){n.children.forEach((t,r)=>{e(r,t)})}var hS=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Ut(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var TU=10*1e3,PY=30*1e3,MY=5*60*1e3,fS=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new hS(e);let r=TU+(PY-TU)*Math.random();Th(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Ut(e,(i,s)=>{s>0&&ln(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Th(this.reportStats_.bind(this),Math.floor(Math.random()*2*MY))}};var ci=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(ci||{});function ZS(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function eA(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function tA(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var pS=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=ci.ACK_USER_WRITE,this.source=ZS()}operationForChild(e){if(ye(this.path)){if(this.affectedTree.value!=null)return B(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new ke(e));return new n(Me(),t,this.revert)}}else return B(_e(this.path)===e,"operationForChild called for unrelated child."),new n(He(this.path),this.affectedTree,this.revert)}};var G_=class n{constructor(e,t){this.source=e,this.path=t,this.type=ci.LISTEN_COMPLETE}operationForChild(e){return ye(this.path)?new n(this.source,Me()):new n(this.source,He(this.path))}};var Du=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=ci.OVERWRITE}operationForChild(e){return ye(this.path)?new n(this.source,Me(),this.snap.getImmediateChild(e)):new n(this.source,He(this.path),this.snap)}};var Oh=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=ci.MERGE}operationForChild(e){if(ye(this.path)){let t=this.children.subtree(new ke(e));return t.isEmpty()?null:t.value?new Du(this.source,Me(),t.value):new n(this.source,Me(),t)}else return B(_e(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,He(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var di=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ye(e))return this.isFullyInitialized()&&!this.filtered_;let t=_e(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var mS=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function kY(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(CY(o.childName,o.snapshotNode))}),Eh(n,i,"child_removed",e,r,t),Eh(n,i,"child_added",e,r,t),Eh(n,i,"child_moved",s,r,t),Eh(n,i,"child_changed",e,r,t),Eh(n,i,"value",e,r,t),i}function Eh(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>LY(n,a,c)),o.forEach(a=>{let c=OY(n,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,n.query_))})})}function OY(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function LY(n,e,t){if(e.childName==null||t.childName==null)throw mo("Should only compare child_ events.");let r=new we(e.childName,e.snapshotNode),i=new we(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function ly(n,e){return{eventCache:n,serverCache:e}}function Ch(n,e,t,r){return ly(new di(e,t,r),n.serverCache)}function h2(n,e,t,r){return ly(n.eventCache,new di(e,t,r))}function W_(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function la(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var FD,FY=()=>(FD||(FD=new nr(O7)),FD),yn=class n{constructor(e,t=FY()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Ut(e,(r,i)=>{t=t.set(new ke(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Me(),value:this.value};if(ye(e))return null;{let r=_e(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(He(e),t);return s!=null?{path:et(new ke(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ye(e))return this;{let t=_e(e),r=this.children.get(t);return r!==null?r.subtree(He(e)):new n(null)}}set(e,t){if(ye(e))return new n(t,this.children);{let r=_e(e),s=(this.children.get(r)||new n(null)).set(He(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(ye(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=_e(e),r=this.children.get(t);if(r){let i=r.remove(He(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(ye(e))return this.value;{let t=_e(e),r=this.children.get(t);return r?r.get(He(e)):null}}setTree(e,t){if(ye(e))return t;{let r=_e(e),s=(this.children.get(r)||new n(null)).setTree(He(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Me(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(et(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Me(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(ye(e))return null;{let s=_e(e),o=this.children.get(s);return o?o.findOnPath_(He(e),et(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Me(),t)}foreachOnPath_(e,t,r){if(ye(e))return this;{this.value&&r(t,this.value);let i=_e(e),s=this.children.get(i);return s?s.foreachOnPath_(He(e),et(t,i),r):new n(null)}}foreach(e){this.foreach_(Me(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(et(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Cr=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new yn(null))}};function Dh(n,e,t){if(ye(e))return new Cr(new yn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=_n(i,e);return s=s.updateChild(o,t),new Cr(n.writeTree_.set(i,s))}else{let i=new yn(t),s=n.writeTree_.setTree(e,i);return new Cr(s)}}}function gS(n,e,t){let r=n;return Ut(t,(i,s)=>{r=Dh(r,et(e,i),s)}),r}function bU(n,e){if(ye(e))return Cr.empty();{let t=n.writeTree_.setTree(e,new yn(null));return new Cr(t)}}function _S(n,e){return ha(n,e)!=null}function ha(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(_n(t.path,e)):null}function CU(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ge,(r,i)=>{e.push(new we(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new we(r,i.value))}),e}function Us(n,e){if(ye(e))return n;{let t=ha(n,e);return t!=null?new Cr(new yn(t)):new Cr(n.writeTree_.subtree(e))}}function yS(n){return n.writeTree_.isEmpty()}function Su(n,e){return f2(Me(),n.writeTree_,e)}function f2(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(B(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=f2(et(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(et(n,".priority"),r)),t}}function dy(n,e){return _2(e,n)}function VY(n,e,t,r,i){B(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Dh(n.visibleWrites,e,t)),n.lastWriteId=r}function UY(n,e,t,r){B(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=gS(n.visibleWrites,e,t),n.lastWriteId=r}function BY(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function jY(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);B(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&$Y(a,r.path)?i=!1:tr(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return HY(n),!0;if(r.snap)n.visibleWrites=bU(n.visibleWrites,r.path);else{let a=r.children;Ut(a,c=>{n.visibleWrites=bU(n.visibleWrites,et(r.path,c))})}return!0}else return!1}function $Y(n,e){if(n.snap)return tr(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&tr(et(n.path,t),e))return!0;return!1}function HY(n){n.visibleWrites=p2(n.allWrites,qY,Me()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function qY(n){return n.visible}function p2(n,e,t){let r=Cr.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)tr(t,o)?(a=_n(t,o),r=Dh(r,a,s.snap)):tr(o,t)&&(a=_n(o,t),r=Dh(r,Me(),s.snap.getChild(a)));else if(s.children){if(tr(t,o))a=_n(t,o),r=gS(r,a,s.children);else if(tr(o,t))if(a=_n(o,t),ye(a))r=gS(r,Me(),s.children);else{let c=as(s.children,_e(a));if(c){let u=c.getChild(He(a));r=Dh(r,Me(),u)}}}else throw mo("WriteRecord should have .snap or .children")}}return r}function m2(n,e,t,r,i){if(!r&&!i){let s=ha(n.visibleWrites,e);if(s!=null)return s;{let o=Us(n.visibleWrites,e);if(yS(o))return t;if(t==null&&!_S(o,Me()))return null;{let a=t||he.EMPTY_NODE;return Su(o,a)}}}else{let s=Us(n.visibleWrites,e);if(!i&&yS(s))return t;if(!i&&t==null&&!_S(s,Me()))return null;{let o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(tr(u.path,e)||tr(e,u.path))},a=p2(n.allWrites,o,e),c=t||he.EMPTY_NODE;return Su(a,c)}}}function zY(n,e,t){let r=he.EMPTY_NODE,i=ha(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ge,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=Us(n.visibleWrites,e);return t.forEachChild(Ge,(o,a)=>{let c=Su(Us(s,new ke(o)),a);r=r.updateImmediateChild(o,c)}),CU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Us(n.visibleWrites,e);return CU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function GY(n,e,t,r,i){B(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=et(e,t);if(_S(n.visibleWrites,s))return null;{let o=Us(n.visibleWrites,s);return yS(o)?i.getChild(t):Su(o,i.getChild(t))}}function WY(n,e,t,r){let i=et(e,t),s=ha(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=Us(n.visibleWrites,i);return Su(o,r.getNode().getImmediateChild(t))}else return null}function KY(n,e){return ha(n.visibleWrites,e)}function QY(n,e,t,r,i,s,o){let a,c=Us(n.visibleWrites,e),u=ha(c,Me());if(u!=null)a=u;else if(t!=null)a=Su(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),p=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=p.getNext();for(;_&&d.length<i;)h(_,r)!==0&&d.push(_),_=p.getNext();return d}else return[]}function YY(){return{visibleWrites:Cr.empty(),allWrites:[],lastWriteId:-1}}function K_(n,e,t,r){return m2(n.writeTree,n.treePath,e,t,r)}function nA(n,e){return zY(n.writeTree,n.treePath,e)}function DU(n,e,t,r){return GY(n.writeTree,n.treePath,e,t,r)}function Q_(n,e){return KY(n.writeTree,et(n.treePath,e))}function JY(n,e,t,r,i,s){return QY(n.writeTree,n.treePath,e,t,r,i,s)}function rA(n,e,t){return WY(n.writeTree,n.treePath,e,t)}function g2(n,e){return _2(et(n.treePath,e),n.writeTree)}function _2(n,e){return{treePath:n,writeTree:e}}var vS=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;B(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),B(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,Ph(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,Nh(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,Cu(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,Ph(r,e.snapshotNode,i.oldSnap));else throw mo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var wS=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},y2=new wS,Lh=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new di(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return rA(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:la(this.viewCache_),s=JY(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function XY(n){return{filter:n}}function ZY(n,e){B(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),B(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function eJ(n,e,t,r,i){let s=new vS,o,a;if(t.type===ci.OVERWRITE){let u=t;u.source.fromUser?o=IS(n,e,u.path,u.snap,r,i,s):(B(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!ye(u.path),o=Y_(n,e,u.path,u.snap,r,i,a,s))}else if(t.type===ci.MERGE){let u=t;u.source.fromUser?o=nJ(n,e,u.path,u.children,r,i,s):(B(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=ES(n,e,u.path,u.children,r,i,a,s))}else if(t.type===ci.ACK_USER_WRITE){let u=t;u.revert?o=sJ(n,e,u.path,r,i,s):o=rJ(n,e,u.path,u.affectedTree,r,i,s)}else if(t.type===ci.LISTEN_COMPLETE)o=iJ(n,e,t.path,r,s);else throw mo("Unknown operation type: "+t.type);let c=s.getChanges();return tJ(e,o,c),{viewCache:o,changes:c}}function tJ(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=W_(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(d2(W_(e)))}}function v2(n,e,t,r,i,s){let o=e.eventCache;if(Q_(r,t)!=null)return e;{let a,c;if(ye(t))if(B(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=la(e),d=u instanceof he?u:he.EMPTY_NODE,h=nA(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let u=K_(r,la(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=_e(t);if(u===".priority"){B($s(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let h=DU(r,t,d,c);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=He(t),h;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();let p=DU(r,t,o.getNode(),c);p!=null?h=o.getNode().getImmediateChild(u).updateChild(d,p):h=o.getNode().getImmediateChild(u)}else h=rA(r,u,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),u,h,d,i,s):a=o.getNode()}}return Ch(e,a,o.isFullyInitialized()||ye(t),n.filter.filtersNodes())}}function Y_(n,e,t,r,i,s,o,a){let c=e.serverCache,u,d=o?n.filter:n.filter.getIndexedFilter();if(ye(t))u=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);u=d.updateFullNode(c.getNode(),_,null)}else{let _=_e(t);if(!c.isCompleteForPath(t)&&$s(t)>1)return e;let w=He(t),A=c.getNode().getImmediateChild(_).updateChild(w,r);_===".priority"?u=d.updatePriority(c.getNode(),A):u=d.updateChild(c.getNode(),_,A,w,y2,null)}let h=h2(e,u,c.isFullyInitialized()||ye(t),d.filtersNodes()),p=new Lh(i,h,s);return v2(n,h,t,i,p,a)}function IS(n,e,t,r,i,s,o){let a=e.eventCache,c,u,d=new Lh(i,e,s);if(ye(t))u=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Ch(e,u,!0,n.filter.filtersNodes());else{let h=_e(t);if(h===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),r),c=Ch(e,u,a.isFullyInitialized(),a.isFiltered());else{let p=He(t),_=a.getNode().getImmediateChild(h),w;if(ye(p))w=r;else{let C=d.getCompleteChild(h);C!=null?KS(p)===".priority"&&C.getChild(s2(p)).isEmpty()?w=C:w=C.updateChild(p,r):w=he.EMPTY_NODE}if(_.equals(w))c=e;else{let C=n.filter.updateChild(a.getNode(),h,w,p,d,o);c=Ch(e,C,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function SU(n,e){return n.eventCache.isCompleteForChild(e)}function nJ(n,e,t,r,i,s,o){let a=e;return r.foreach((c,u)=>{let d=et(t,c);SU(e,_e(d))&&(a=IS(n,a,d,u,i,s,o))}),r.foreach((c,u)=>{let d=et(t,c);SU(e,_e(d))||(a=IS(n,a,d,u,i,s,o))}),a}function AU(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function ES(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;ye(t)?u=r:u=new yn(null).setTree(t,r);let d=e.serverCache.getNode();return u.children.inorderTraversal((h,p)=>{if(d.hasChild(h)){let _=e.serverCache.getNode().getImmediateChild(h),w=AU(n,_,p);c=Y_(n,c,new ke(h),w,i,s,o,a)}}),u.children.inorderTraversal((h,p)=>{let _=!e.serverCache.isCompleteForChild(h)&&p.value===null;if(!d.hasChild(h)&&!_){let w=e.serverCache.getNode().getImmediateChild(h),C=AU(n,w,p);c=Y_(n,c,new ke(h),C,i,s,o,a)}}),c}function rJ(n,e,t,r,i,s,o){if(Q_(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(ye(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return Y_(n,e,t,c.getNode().getChild(t),i,s,a,o);if(ye(t)){let u=new yn(null);return c.getNode().forEachChild(ui,(d,h)=>{u=u.set(new ke(d),h)}),ES(n,e,t,u,i,s,a,o)}else return e}else{let u=new yn(null);return r.foreach((d,h)=>{let p=et(t,d);c.isCompleteForPath(p)&&(u=u.set(d,c.getNode().getChild(p)))}),ES(n,e,t,u,i,s,a,o)}}function iJ(n,e,t,r,i){let s=e.serverCache,o=h2(e,s.getNode(),s.isFullyInitialized()||ye(t),s.isFiltered());return v2(n,o,t,r,y2,i)}function sJ(n,e,t,r,i,s){let o;if(Q_(r,t)!=null)return e;{let a=new Lh(r,e,i),c=e.eventCache.getNode(),u;if(ye(t)||_e(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=K_(r,la(e));else{let h=e.serverCache.getNode();B(h instanceof he,"serverChildren would be complete if leaf node"),d=nA(r,h)}d=d,u=n.filter.updateFullNode(c,d,s)}else{let d=_e(t),h=rA(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?u=n.filter.updateChild(c,d,h,He(t),a,s):e.eventCache.getNode().hasChild(d)?u=n.filter.updateChild(c,d,he.EMPTY_NODE,He(t),a,s):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=K_(r,la(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||Q_(r,Me())!=null,Ch(e,u,o,n.filter.filtersNodes())}}var TS=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Mh(r.getIndex()),s=DY(r);this.processor_=XY(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(he.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(he.EMPTY_NODE,a.getNode(),null),d=new di(c,o.isFullyInitialized(),i.filtersNodes()),h=new di(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=ly(h,d),this.eventGenerator_=new mS(this.query_)}get query(){return this.query_}};function oJ(n){return n.viewCache_.serverCache.getNode()}function aJ(n){return W_(n.viewCache_)}function cJ(n,e){let t=la(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!ye(e)&&!t.getImmediateChild(_e(e)).isEmpty())?t.getChild(e):null}function RU(n){return n.eventRegistrations_.length===0}function uJ(n,e){n.eventRegistrations_.push(e)}function xU(n,e,t){let r=[];if(t){B(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function NU(n,e,t,r){e.type===ci.MERGE&&e.source.queryId!==null&&(B(la(n.viewCache_),"We should always have a full cache before handling merges"),B(W_(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=eJ(n.processor_,i,e,t,r);return ZY(n.processor_,s.viewCache),B(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,w2(n,s.changes,s.viewCache.eventCache.getNode(),null)}function lJ(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Ge,(s,o)=>{r.push(Cu(s,o))}),t.isFullyInitialized()&&r.push(d2(t.getNode())),w2(n,r,t.getNode(),e)}function w2(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return kY(n.eventGenerator_,e,t,i)}var J_,X_=class{constructor(){this.views=new Map}};function dJ(n){B(!J_,"__referenceConstructor has already been defined"),J_=n}function hJ(){return B(J_,"Reference.ts has not been loaded"),J_}function fJ(n){return n.views.size===0}function iA(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return B(s!=null,"SyncTree gave us an op for an invalid query."),NU(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(NU(o,e,t,r));return s}}function I2(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=K_(t,i?r:null),c=!1;a?c=!0:r instanceof he?(a=nA(t,r),c=!1):(a=he.EMPTY_NODE,c=!1);let u=ly(new di(a,c,!1),new di(r,i,!1));return new TS(e,u)}return o}function pJ(n,e,t,r,i,s){let o=I2(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),uJ(o,t),lJ(o,t)}function mJ(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=Hs(n);if(i==="default")for(let[c,u]of n.views.entries())o=o.concat(xU(u,t,r)),RU(u)&&(n.views.delete(c),u.query._queryParams.loadsAllData()||s.push(u.query));else{let c=n.views.get(i);c&&(o=o.concat(xU(c,t,r)),RU(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!Hs(n)&&s.push(new(hJ())(e._repo,e._path)),{removed:s,events:o}}function E2(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Bs(n,e){let t=null;for(let r of n.views.values())t=t||cJ(r,e);return t}function T2(n,e){if(e._queryParams.loadsAllData())return hy(n);{let r=e._queryIdentifier;return n.views.get(r)}}function b2(n,e){return T2(n,e)!=null}function Hs(n){return hy(n)!=null}function hy(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Z_;function gJ(n){B(!Z_,"__referenceConstructor has already been defined"),Z_=n}function _J(){return B(Z_,"Reference.ts has not been loaded"),Z_}var yJ=1,ey=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new yn(null),this.pendingWriteTree_=YY(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function sA(n,e,t,r,i){return VY(n.pendingWriteTree_,e,t,r,i),i?Pu(n,new Du(ZS(),e,t)):[]}function vJ(n,e,t,r){UY(n.pendingWriteTree_,e,t,r);let i=yn.fromObject(t);return Pu(n,new Oh(ZS(),e,i))}function Vs(n,e,t=!1){let r=BY(n.pendingWriteTree_,e);if(jY(n.pendingWriteTree_,e)){let s=new yn(null);return r.snap!=null?s=s.set(Me(),!0):Ut(r.children,o=>{s=s.set(new ke(o),!0)}),Pu(n,new pS(r.path,s,t))}else return[]}function zh(n,e,t){return Pu(n,new Du(eA(),e,t))}function wJ(n,e,t){let r=yn.fromObject(t);return Pu(n,new Oh(eA(),e,r))}function IJ(n,e){return Pu(n,new G_(eA(),e))}function EJ(n,e,t){let r=oA(n,t);if(r){let i=aA(r),s=i.path,o=i.queryId,a=_n(s,e),c=new G_(tA(o),a);return cA(n,s,c)}else return[]}function ty(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||b2(o,e))){let c=mJ(o,e,t,r);fJ(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let u=c.removed;if(a=c.events,!i){let d=u.findIndex(p=>p._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(p,_)=>Hs(_));if(d&&!h){let p=n.syncPointTree_.subtree(s);if(!p.isEmpty()){let _=CJ(p);for(let w=0;w<_.length;++w){let C=_[w],A=C.query,F=A2(n,C);n.listenProvider_.startListening(Sh(A),Fh(n,A),F.hashFn,F.onComplete)}}}!h&&u.length>0&&!r&&(d?n.listenProvider_.stopListening(Sh(e),null):u.forEach(p=>{let _=n.queryToTagMap.get(py(p));n.listenProvider_.stopListening(Sh(p),_)}))}DJ(n,u)}return a}function C2(n,e,t,r){let i=oA(n,r);if(i!=null){let s=aA(i),o=s.path,a=s.queryId,c=_n(o,e),u=new Du(tA(a),c,t);return cA(n,o,u)}else return[]}function TJ(n,e,t,r){let i=oA(n,r);if(i){let s=aA(i),o=s.path,a=s.queryId,c=_n(o,e),u=yn.fromObject(t),d=new Oh(tA(a),c,u);return cA(n,o,d)}else return[]}function bS(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(p,_)=>{let w=_n(p,i);s=s||Bs(_,w),o=o||Hs(_)});let a=n.syncPointTree_.get(i);a?(o=o||Hs(a),s=s||Bs(a,Me())):(a=new X_,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=he.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,w)=>{let C=Bs(w,Me());C&&(s=s.updateImmediateChild(_,C))}));let u=b2(a,e);if(!u&&!e._queryParams.loadsAllData()){let p=py(e);B(!n.queryToTagMap.has(p),"View does not exist, but we have a tag");let _=SJ();n.queryToTagMap.set(p,_),n.tagToQueryMap.set(_,p)}let d=dy(n.pendingWriteTree_,i),h=pJ(a,e,t,d,s,c);if(!u&&!o&&!r){let p=T2(a,e);h=h.concat(AJ(n,e,p))}return h}function fy(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=_n(o,e),u=Bs(a,c);if(u)return u});return m2(i,e,s,t,!0)}function bJ(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(u,d)=>{let h=_n(u,t);r=r||Bs(d,h)});let i=n.syncPointTree_.get(t);i?r=r||Bs(i,Me()):(i=new X_,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new di(r,!0,!1):null,a=dy(n.pendingWriteTree_,e._path),c=I2(i,e,a,s?o.getNode():he.EMPTY_NODE,s);return aJ(c)}function Pu(n,e){return D2(e,n.syncPointTree_,null,dy(n.pendingWriteTree_,Me()))}function D2(n,e,t,r){if(ye(n.path))return S2(n,e,t,r);{let i=e.get(Me());t==null&&i!=null&&(t=Bs(i,Me()));let s=[],o=_e(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let u=t?t.getImmediateChild(o):null,d=g2(r,o);s=s.concat(D2(a,c,u,d))}return i&&(s=s.concat(iA(i,n,r,t))),s}}function S2(n,e,t,r){let i=e.get(Me());t==null&&i!=null&&(t=Bs(i,Me()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,u=g2(r,o),d=n.operationForChild(o);d&&(s=s.concat(S2(d,a,c,u)))}),i&&(s=s.concat(iA(i,n,r,t))),s}function A2(n,e){let t=e.query,r=Fh(n,t);return{hashFn:()=>(oJ(e)||he.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?EJ(n,t._path,r):IJ(n,t._path);{let s=V7(i,t);return ty(n,t,null,s)}}}}function Fh(n,e){let t=py(e);return n.queryToTagMap.get(t)}function py(n){return n._path.toString()+"$"+n._queryIdentifier}function oA(n,e){return n.tagToQueryMap.get(e)}function aA(n){let e=n.indexOf("$");return B(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ke(n.substr(0,e))}}function cA(n,e,t){let r=n.syncPointTree_.get(e);B(r,"Missing sync point for query tag that we're tracking");let i=dy(n.pendingWriteTree_,e);return iA(r,t,i,null)}function CJ(n){return n.fold((e,t,r)=>{if(t&&Hs(t))return[hy(t)];{let i=[];return t&&(i=E2(t)),Ut(r,(s,o)=>{i=i.concat(o)}),i}})}function Sh(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(_J())(n._repo,n._path):n}function DJ(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=py(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function SJ(){return yJ++}function AJ(n,e,t){let r=e._path,i=Fh(n,e),s=A2(n,t),o=n.listenProvider_.startListening(Sh(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)B(!Hs(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((u,d,h)=>{if(!ye(u)&&d&&Hs(d))return[hy(d).query];{let p=[];return d&&(p=p.concat(E2(d).map(_=>_.query))),Ut(h,(_,w)=>{p=p.concat(w)}),p}});for(let u=0;u<c.length;++u){let d=c[u];n.listenProvider_.stopListening(Sh(d),Fh(n,d))}}return o}var CS=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},DS=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=et(this.path_,e);return new n(this.syncTree_,t)}node(){return fy(this.syncTree_,this.path_)}},RJ=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},PU=function(n,e,t){if(!n||typeof n!="object")return n;if(B(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return xJ(n[".sv"],e,t);if(typeof n[".sv"]=="object")return NJ(n[".sv"],e);B(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},xJ=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:B(!1,"Unexpected server value: "+n)}},NJ=function(n,e,t){n.hasOwnProperty("increment")||B(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&B(!1,"Unexpected increment value: "+r);let i=e.node();if(B(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},R2=function(n,e,t,r){return lA(e,new DS(t,n),r)},uA=function(n,e,t){return lA(n,new CS(e),t)};function lA(n,e,t){let r=n.getPriority().val(),i=PU(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=PU(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Tu(a,it(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Tu(i))),o.forEachChild(Ge,(a,c)=>{let u=lA(c,e.getImmediateChild(a),t);u!==c&&(s=s.updateImmediateChild(a,u))}),s}}var Vh=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function my(n,e){let t=e instanceof ke?e:new ke(e),r=n,i=_e(t);for(;i!==null;){let s=as(r.node.children,i)||{children:{},childCount:0};r=new Vh(i,r,s),t=He(t),i=_e(t)}return r}function fa(n){return n.node.value}function dA(n,e){n.node.value=e,SS(n)}function x2(n){return n.node.childCount>0}function PJ(n){return fa(n)===void 0&&!x2(n)}function gy(n,e){Ut(n.node.children,(t,r)=>{e(new Vh(t,n,r))})}function N2(n,e,t,r){t&&!r&&e(n),gy(n,i=>{N2(i,e,!0,r)}),t&&r&&e(n)}function MJ(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Gh(n){return new ke(n.parent===null?n.name:Gh(n.parent)+"/"+n.name)}function SS(n){n.parent!==null&&kJ(n.parent,n.name,n)}function kJ(n,e,t){let r=PJ(t),i=ln(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,SS(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,SS(n))}var OJ=/[\[\].#$\/\u0000-\u001F\u007F]/,LJ=/[\[\].#$\u0000-\u001F\u007F]/,VD=10*1024*1024,_y=function(n){return typeof n=="string"&&n.length!==0&&!OJ.test(n)},P2=function(n){return typeof n=="string"&&n.length!==0&&!LJ.test(n)},FJ=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),P2(n)},Uh=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!cy(n)||n&&typeof n=="object"&&ln(n,".sv")},hi=function(n,e,t,r){r&&e===void 0||Wh(Jt(n,"value"),e,t)},Wh=function(n,e,t){let r=t instanceof ke?new JD(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+aa(r));if(typeof e=="function")throw new Error(n+"contains a function "+aa(r)+" with contents = "+e.toString());if(cy(e))throw new Error(n+"contains "+e.toString()+" "+aa(r));if(typeof e=="string"&&e.length>VD/3&&ed(e)>VD)throw new Error(n+"contains a string greater than "+VD+" utf8 bytes "+aa(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Ut(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!_y(o)))throw new Error(n+" contains an invalid key ("+o+") "+aa(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);fY(r,o),Wh(n,a,r),pY(r)}),i&&s)throw new Error(n+' contains ".value" child '+aa(r)+" in addition to actual children.")}},VJ=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=Rh(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!_y(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(hY);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&tr(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},M2=function(n,e,t,r){if(r&&e===void 0)return;let i=Jt(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Ut(e,(o,a)=>{let c=new ke(o);if(Wh(i,a,et(t,c)),KS(c)===".priority"&&!Uh(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),VJ(i,s)},hA=function(n,e,t){if(!(t&&e===void 0)){if(cy(e))throw new Error(Jt(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Uh(e))throw new Error(Jt(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Kh=function(n,e,t,r){if(!(r&&t===void 0)&&!_y(t))throw new Error(Jt(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Mu=function(n,e,t,r){if(!(r&&t===void 0)&&!P2(t))throw new Error(Jt(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},UJ=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Mu(n,e,t,r)},Fn=function(n,e){if(_e(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},k2=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!_y(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!FJ(t))throw new Error(Jt(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var AS=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function yy(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!QS(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function O2(n,e,t){yy(n,t),L2(n,r=>QS(r,e))}function Vn(n,e,t){yy(n,t),L2(n,r=>tr(r,e)||tr(e,r))}function L2(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(BJ(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function BJ(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();ua&&Vt("event: "+t.toString()),xu(r)}}}var F2="repo_interrupt",jJ=25,RS=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new AS,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=z_(),this.transactionQueueTree_=new Vh,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function $J(n,e,t){if(n.stats_=WS(n.repoInfo_),n.forceRestClient_||$7())n.server_=new cS(n.repoInfo_,(r,i,s,o)=>{MU(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>kU(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{wt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new YS(n.repoInfo_,e,(r,i,s,o)=>{MU(n,r,i,s,o)},r=>{kU(n,r)},r=>{HJ(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=q7(n.repoInfo_,()=>new fS(n.stats_,n.server_)),n.infoData_=new uS,n.infoSyncTree_=new ey({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=zh(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),fA(n,"connected",!1),n.serverSyncTree_=new ey({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let u=o(a,c);Vn(n.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function V2(n){let t=n.infoData_.getNode(new ke(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Qh(n){return RJ({timestamp:V2(n)})}function MU(n,e,t,r,i){n.dataUpdateCount++;let s=new ke(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=Zl(t,u=>it(u));o=TJ(n.serverSyncTree_,s,c,i)}else{let c=it(t);o=C2(n.serverSyncTree_,s,c,i)}else if(r){let c=Zl(t,u=>it(u));o=wJ(n.serverSyncTree_,s,c)}else{let c=it(t);o=zh(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Au(n,s)),Vn(n.eventQueue_,a,o)}function kU(n,e){fA(n,"connected",e),e===!1&&GJ(n)}function HJ(n,e){Ut(e,(t,r)=>{fA(n,t,r)})}function fA(n,e,t){let r=new ke("/.info/"+e),i=it(t);n.infoData_.updateSnapshot(r,i);let s=zh(n.infoSyncTree_,r,i);Vn(n.eventQueue_,r,s)}function vy(n){return n.nextWriteId_++}function qJ(n,e,t){let r=bJ(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=it(i).withIndex(e._queryParams.getIndex());bS(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=zh(n.serverSyncTree_,e._path,s);else{let a=Fh(n.serverSyncTree_,e);o=C2(n.serverSyncTree_,e._path,s,a)}return Vn(n.eventQueue_,e._path,o),ty(n.serverSyncTree_,e,t,null,!0),s},i=>(ku(n,"get for query "+wt(e)+" failed: "+i),Promise.reject(new Error(i))))}function pA(n,e,t,r,i){ku(n,"set",{path:e.toString(),value:t,priority:r});let s=Qh(n),o=it(t,r),a=fy(n.serverSyncTree_,e),c=uA(o,a,s),u=vy(n),d=sA(n.serverSyncTree_,e,c,u,!0);yy(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(p,_)=>{let w=p==="ok";w||nn("set at "+e+" failed: "+p);let C=Vs(n.serverSyncTree_,u,!w);Vn(n.eventQueue_,e,C),qs(n,i,p,_)});let h=gA(n,e);Au(n,h),Vn(n.eventQueue_,h,[])}function zJ(n,e,t,r){ku(n,"update",{path:e.toString(),value:t});let i=!0,s=Qh(n),o={};if(Ut(t,(a,c)=>{i=!1,o[a]=R2(et(e,a),it(c),n.serverSyncTree_,s)}),i)Vt("update() called with empty data.  Don't do anything."),qs(n,r,"ok",void 0);else{let a=vy(n),c=vJ(n.serverSyncTree_,e,o,a);yy(n.eventQueue_,c),n.server_.merge(e.toString(),t,(u,d)=>{let h=u==="ok";h||nn("update at "+e+" failed: "+u);let p=Vs(n.serverSyncTree_,a,!h),_=p.length>0?Au(n,e):e;Vn(n.eventQueue_,_,p),qs(n,r,u,d)}),Ut(t,u=>{let d=gA(n,et(e,u));Au(n,d)}),Vn(n.eventQueue_,e,[])}}function GJ(n){ku(n,"onDisconnectEvents");let e=Qh(n),t=z_();dS(n.onDisconnect_,Me(),(i,s)=>{let o=R2(i,s,n.serverSyncTree_,e);Nu(t,i,o)});let r=[];dS(t,Me(),(i,s)=>{r=r.concat(zh(n.serverSyncTree_,i,s));let o=gA(n,i);Au(n,o)}),n.onDisconnect_=z_(),Vn(n.eventQueue_,Me(),r)}function WJ(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&lS(n.onDisconnect_,e),qs(n,t,r,i)})}function OU(n,e,t,r){let i=it(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Nu(n.onDisconnect_,e,i),qs(n,r,s,o)})}function KJ(n,e,t,r,i){let s=it(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Nu(n.onDisconnect_,e,s),qs(n,i,o,a)})}function QJ(n,e,t,r){if(uc(t)){Vt("onDisconnect().update() called with empty data.  Don't do anything."),qs(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Ut(t,(o,a)=>{let c=it(a);Nu(n.onDisconnect_,et(e,o),c)}),qs(n,r,i,s)})}function YJ(n,e,t){let r;_e(e._path)===".info"?r=bS(n.infoSyncTree_,e,t):r=bS(n.serverSyncTree_,e,t),O2(n.eventQueue_,e._path,r)}function xS(n,e,t){let r;_e(e._path)===".info"?r=ty(n.infoSyncTree_,e,t):r=ty(n.serverSyncTree_,e,t),O2(n.eventQueue_,e._path,r)}function U2(n){n.persistentConnection_&&n.persistentConnection_.interrupt(F2)}function JJ(n){n.persistentConnection_&&n.persistentConnection_.resume(F2)}function ku(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Vt(t,...e)}function qs(n,e,t,r){e&&xu(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function XJ(n,e,t,r,i,s){ku(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:VU(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=mA(n,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Wh("transaction failed: Data returned ",c,o.path),o.status=0;let u=my(n.transactionQueueTree_,e),d=fa(u)||[];d.push(o),dA(u,d);let h;typeof c=="object"&&c!==null&&ln(c,".priority")?(h=as(c,".priority"),B(Uh(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(fy(n.serverSyncTree_,e)||he.EMPTY_NODE).getPriority().val();let p=Qh(n),_=it(c,h),w=uA(_,a,p);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=w,o.currentWriteId=vy(n);let C=sA(n.serverSyncTree_,e,w,o.currentWriteId,o.applyLocally);Vn(n.eventQueue_,e,C),wy(n,n.transactionQueueTree_)}}function mA(n,e,t){return fy(n.serverSyncTree_,e,t)||he.EMPTY_NODE}function wy(n,e=n.transactionQueueTree_){if(e||Iy(n,e),fa(e)){let t=j2(n,e);B(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&ZJ(n,Gh(e),t)}else x2(e)&&gy(e,t=>{wy(n,t)})}function ZJ(n,e,t){let r=t.map(u=>u.currentWriteId),i=mA(n,e,r),s=i,o=i.hash();for(let u=0;u<t.length;u++){let d=t[u];B(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=_n(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,u=>{ku(n,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){let h=[];for(let p=0;p<t.length;p++)t[p].status=2,d=d.concat(Vs(n.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&h.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();Iy(n,my(n.transactionQueueTree_,e)),wy(n,n.transactionQueueTree_),Vn(n.eventQueue_,e,d);for(let p=0;p<h.length;p++)xu(h[p])}else{if(u==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{nn("transaction at "+c.toString()+" failed: "+u);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=u}Au(n,e)}},o)}function Au(n,e){let t=B2(n,e),r=Gh(t),i=j2(n,t);return eX(n,i,r),r}function eX(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=_n(t,c.path),d=!1,h;if(B(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,i=i.concat(Vs(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=jJ)d=!0,h="maxretry",i=i.concat(Vs(n.serverSyncTree_,c.currentWriteId,!0));else{let p=mA(n,c.path,o);c.currentInputSnapshot=p;let _=e[a].update(p.val());if(_!==void 0){Wh("transaction failed: Data returned ",_,c.path);let w=it(_);typeof _=="object"&&_!=null&&ln(_,".priority")||(w=w.updatePriority(p.getPriority()));let A=c.currentWriteId,F=Qh(n),G=uA(w,p,F);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=G,c.currentWriteId=vy(n),o.splice(o.indexOf(A),1),i=i.concat(sA(n.serverSyncTree_,c.path,G,c.currentWriteId,c.applyLocally)),i=i.concat(Vs(n.serverSyncTree_,A,!0))}else d=!0,h="nodata",i=i.concat(Vs(n.serverSyncTree_,c.currentWriteId,!0))}Vn(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}Iy(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)xu(r[a]);wy(n,n.transactionQueueTree_)}function B2(n,e){let t,r=n.transactionQueueTree_;for(t=_e(e);t!==null&&fa(r)===void 0;)r=my(r,t),e=He(e),t=_e(e);return r}function j2(n,e){let t=[];return $2(n,e,t),t.sort((r,i)=>r.order-i.order),t}function $2(n,e,t){let r=fa(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);gy(e,i=>{$2(n,i,t)})}function Iy(n,e){let t=fa(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,dA(e,t.length>0?t:void 0)}gy(e,r=>{Iy(n,r)})}function gA(n,e){let t=Gh(B2(n,e)),r=my(n.transactionQueueTree_,e);return MJ(r,i=>{UD(n,i)}),UD(n,r),N2(r,i=>{UD(n,i)}),t}function UD(n,e){let t=fa(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(B(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(B(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Vs(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?dA(e,void 0):t.length=s+1,Vn(n.eventQueue_,Gh(e),i);for(let o=0;o<r.length;o++)xu(r[o])}}function tX(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function nX(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):nn(`Invalid query segment '${t}' in query '${n}'`)}return e}var NS=function(n,e){let t=rX(n),r=t.namespace;t.domain==="firebase.com"&&li(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&li("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||M7();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new F_(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new ke(t.pathString)}},rX=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=tX(n.substring(d,h)));let p=nX(n.substring(Math.min(n.length,h)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let _=e.slice(0,u);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),t=e.substring(w+1),s=r}"ns"in p&&(s=p.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var LU="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",iX=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=LU.charAt(t%64),t=Math.floor(t/64);B(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=LU.charAt(e[i]);return B(o.length===20,"nextPushId: Length should be 20."),o}}();var ny=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+wt(this.snapshot.exportVal())}},ry=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Bh=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return B(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var iy=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new xt;return WJ(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Fn("OnDisconnect.remove",this._path);let e=new xt;return OU(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Fn("OnDisconnect.set",this._path),hi("OnDisconnect.set",e,this._path,!1);let t=new xt;return OU(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Fn("OnDisconnect.setWithPriority",this._path),hi("OnDisconnect.setWithPriority",e,this._path,!1),hA("OnDisconnect.setWithPriority",t,!1);let r=new xt;return KJ(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Fn("OnDisconnect.update",this._path),M2("OnDisconnect.update",e,this._path,!1);let t=new xt;return QJ(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var vn=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return ye(this._path)?null:KS(this._path)}get ref(){return new Un(this._repo,this._path)}get _queryIdentifier(){let e=EU(this._queryParams),t=GS(e);return t==="{}"?"default":t}get _queryObject(){return EU(this._queryParams)}isEqual(e){if(e=H(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=QS(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+dY(this._path)}};function Ey(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Gs(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===ui){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==js)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==ji)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===Ge){if(e!=null&&!Uh(e)||t!=null&&!Uh(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(B(n.getIndex()instanceof xh||n.getIndex()===XS,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Ty(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Un=class n extends vn{constructor(e,t){super(e,t,new kh,!1)}get parent(){let e=s2(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Ru=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new ke(e),r=zs(this.ref,e);return new n(this._node.getChild(t),r,Ge)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,zs(this.ref,r),Ge)))}hasChild(e){let t=new ke(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Ou(n,e){return n=H(n),n._checkNotDeleted("ref"),e!==void 0?zs(n._root,e):n._root}function _A(n,e){n=H(n),n._checkNotDeleted("refFromURL");let t=NS(e,n._repo.repoInfo_.nodeAdmin);k2("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&li("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),Ou(n,t.path.toString())}function zs(n,e){return n=H(n),_e(n._path)===null?UJ("child","path",e,!1):Mu("child","path",e,!1),new Un(n._repo,et(n._path,e))}function by(n,e){n=H(n),Fn("push",n._path),hi("push",e,n._path,!0);let t=V2(n._repo),r=iX(t),i=zs(n,r),s=zs(n,r),o;return e!=null?o=Cy(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function H2(n){return Fn("remove",n._path),Cy(n,null)}function Cy(n,e){n=H(n),Fn("set",n._path),hi("set",e,n._path,!1);let t=new xt;return pA(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function q2(n,e){n=H(n),Fn("setPriority",n._path),hA("setPriority",e,!1);let t=new xt;return pA(n._repo,et(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function z2(n,e,t){if(Fn("setWithPriority",n._path),hi("setWithPriority",e,n._path,!1),hA("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new xt;return pA(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function G2(n,e){M2("update",e,n._path,!1);let t=new xt;return zJ(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function W2(n){n=H(n);let e=new Bh(()=>{}),t=new jh(e);return qJ(n._repo,n,t).then(r=>new Ru(r,new Un(n._repo,n._path),n._queryParams.getIndex()))}var jh=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new ny("value",this,new Ru(e.snapshotNode,new Un(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ry(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},sy=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ry(this,e,t):null}createEvent(e,t){B(e.childName!=null,"Child events should have a childName.");let r=zs(new Un(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new ny(e.type,this,new Ru(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Yh(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,u=(d,h)=>{xS(n._repo,n,a),c(d,h)};u.userCallback=t.userCallback,u.context=t.context,t=u}let o=new Bh(t,s||void 0),a=e==="value"?new jh(o):new sy(e,o);return YJ(n._repo,n,a),()=>xS(n._repo,n,a)}function Dy(n,e,t,r){return Yh(n,"value",e,t,r)}function Jh(n,e,t,r){return Yh(n,"child_added",e,t,r)}function yA(n,e,t,r){return Yh(n,"child_changed",e,t,r)}function vA(n,e,t,r){return Yh(n,"child_moved",e,t,r)}function wA(n,e,t,r){return Yh(n,"child_removed",e,t,r)}function IA(n,e,t){let r=null,i=t?new Bh(t):null;e==="value"?r=new jh(i):e&&(r=new sy(e,i)),xS(n._repo,n,r)}var Bn=class{},oy=class extends Bn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){hi("endAt",this._value,e._path,!0);let t=aS(e._queryParams,this._value,this._key);if(Ty(t),Gs(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new vn(e._repo,e._path,t,e._orderByCalled)}};function K2(n,e){return Kh("endAt","key",e,!0),new oy(n,e)}var PS=class extends Bn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){hi("endBefore",this._value,e._path,!1);let t=xY(e._queryParams,this._value,this._key);if(Ty(t),Gs(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new vn(e._repo,e._path,t,e._orderByCalled)}};function Q2(n,e){return Kh("endBefore","key",e,!0),new PS(n,e)}var ay=class extends Bn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){hi("startAt",this._value,e._path,!0);let t=oS(e._queryParams,this._value,this._key);if(Ty(t),Gs(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new vn(e._repo,e._path,t,e._orderByCalled)}};function Y2(n=null,e){return Kh("startAt","key",e,!0),new ay(n,e)}var MS=class extends Bn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){hi("startAfter",this._value,e._path,!1);let t=RY(e._queryParams,this._value,this._key);if(Ty(t),Gs(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new vn(e._repo,e._path,t,e._orderByCalled)}};function J2(n,e){return Kh("startAfter","key",e,!0),new MS(n,e)}var kS=class extends Bn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new vn(e._repo,e._path,SY(e._queryParams,this._limit),e._orderByCalled)}};function X2(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new kS(n)}var OS=class extends Bn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new vn(e._repo,e._path,AY(e._queryParams,this._limit),e._orderByCalled)}};function Z2(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new OS(n)}var LS=class extends Bn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Ey(e,"orderByChild");let t=new ke(this._path);if(ye(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new xh(t),i=uy(e._queryParams,r);return Gs(i),new vn(e._repo,e._path,i,!0)}};function eB(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Mu("orderByChild","path",n,!1),new LS(n)}var FS=class extends Bn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Ey(e,"orderByKey");let t=uy(e._queryParams,ui);return Gs(t),new vn(e._repo,e._path,t,!0)}};function tB(){return new FS}var VS=class extends Bn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Ey(e,"orderByPriority");let t=uy(e._queryParams,Ge);return Gs(t),new vn(e._repo,e._path,t,!0)}};function nB(){return new VS}var US=class extends Bn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Ey(e,"orderByValue");let t=uy(e._queryParams,XS);return Gs(t),new vn(e._repo,e._path,t,!0)}};function rB(){return new US}var BS=class extends Bn{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(hi("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new oy(this._value,this._key)._apply(new ay(this._value,this._key)._apply(e))}};function iB(n,e){return Kh("equalTo","key",e,!0),new BS(n,e)}function rr(n,...e){let t=H(n);for(let r of e)t=r._apply(t);return t}dJ(Un);gJ(Un);var sX="FIREBASE_DATABASE_EMULATOR_HOST",jS={},oX=!1;function aX(n,e,t,r){n.repoInfo_=new F_(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function EA(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||li("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Vt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=NS(s,i),a=o.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[sX]),u?(c=!0,s=`http://${u}?ns=${a.namespace}`,o=NS(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new bh(bh.OWNER):new zD(n.name,n.options,e);k2("Invalid Firebase Database URL",o),ye(o.path)||li("Database URL must point to the root of a Firebase Database (not including a child path).");let h=uX(a,n,d,new qD(n.name,t));return new $S(h,n)}function cX(n,e){let t=jS[e];(!t||t[n.key]!==n)&&li(`Database ${e}(${n.repoInfo_}) has already been deleted.`),U2(n),delete t[n.key]}function uX(n,e,t,r){let i=jS[e.name];i||(i={},jS[e.name]=i);let s=i[n.toURLString()];return s&&li("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new RS(n,oX,t,r),i[n.toURLString()]=s,s}var $S=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||($J(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Un(this._repo,Me())),this._rootInternal}_delete(){return this._rootInternal!==null&&(cX(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&li("Cannot call "+e+" on a deleted database.")}};function sB(){i2.IS_TRANSPORT_INITIALIZED&&nn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function oB(){sB(),Ah.forceDisallow()}function aB(){sB(),vu.forceDisallow(),Ah.forceAllow()}function cB(n,e,t,r={}){n=H(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&li("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&li('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new bh(bh.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:cc(r.mockUserToken,n.app.options.projectId);s=new bh(o)}aX(i,e,t,s)}function uB(n){n=H(n),n._checkNotDeleted("goOffline"),U2(n._repo)}function lB(n){n=H(n),n._checkNotDeleted("goOnline"),JJ(n._repo)}function dB(n,e){BU(n,e)}function lX(n){zS(hn),dn(new Ve("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return EA(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),ft(sU,oU,n),ft(sU,oU,"esm2017")}var dX={".sv":"timestamp"};function hB(){return dX}function fB(n){return{".sv":{increment:n}}}var HS=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function pB(n,e,t){var r;if(n=H(n),Fn("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new xt,o=(c,u,d)=>{let h=null;c?s.reject(c):(h=new Ru(d,new Un(n._repo,n._path),Ge),s.resolve(new HS(u,h)))},a=Dy(n,()=>{});return XJ(n._repo,n._path,e,o,a,i),s.promise}YS.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};YS.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};lX();var hX="@firebase/database-compat",fX="1.0.5";var pX=new Cn("@firebase/database-compat"),mB=function(n){let e="FIREBASE WARNING: "+n;pX.warn(e)};var mX=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(Jt(n,e)+"must be a boolean.")},gX=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Jt(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var TA=class{constructor(e){this._delegate=e}cancel(e){ie("OnDisconnect.cancel",0,1,arguments.length),Nt("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){ie("OnDisconnect.remove",0,1,arguments.length),Nt("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){ie("OnDisconnect.set",1,2,arguments.length),Nt("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ie("OnDisconnect.setWithPriority",2,3,arguments.length),Nt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(ie("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,mB("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Nt("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var bA=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ie("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var pa=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return ie("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ie("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ie("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ie("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ie("DataSnapshot.child",0,1,arguments.length),e=String(e),Mu("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return ie("DataSnapshot.hasChild",1,1,arguments.length),Mu("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ie("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ie("DataSnapshot.forEach",1,1,arguments.length),Nt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return ie("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ie("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ie("DataSnapshot.ref",0,0,arguments.length),new $i(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Sy=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;ie("Query.on",2,4,arguments.length),Nt("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(u,d)=>{t.call(o.context,new pa(this.database,u),d)};a.userCallback=t,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Dy(this._delegate,a,c),t;case"child_added":return Jh(this._delegate,a,c),t;case"child_removed":return wA(this._delegate,a,c),t;case"child_changed":return yA(this._delegate,a,c),t;case"child_moved":return vA(this._delegate,a,c),t;default:throw new Error(Jt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(ie("Query.off",0,3,arguments.length),gX("Query.off",e,!0),Nt("Query.off","callback",t,!0),yE("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,IA(this._delegate,e,i)}else IA(this._delegate,e)}get(){return W2(this._delegate).then(e=>new pa(this.database,e))}once(e,t,r,i){ie("Query.once",1,4,arguments.length),Nt("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new xt,a=(u,d)=>{let h=new pa(this.database,u);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let c=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(e){case"value":Dy(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":Jh(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":wA(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":yA(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":vA(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(Jt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ie("Query.limitToFirst",1,1,arguments.length),new n(this.database,rr(this._delegate,X2(e)))}limitToLast(e){return ie("Query.limitToLast",1,1,arguments.length),new n(this.database,rr(this._delegate,Z2(e)))}orderByChild(e){return ie("Query.orderByChild",1,1,arguments.length),new n(this.database,rr(this._delegate,eB(e)))}orderByKey(){return ie("Query.orderByKey",0,0,arguments.length),new n(this.database,rr(this._delegate,tB()))}orderByPriority(){return ie("Query.orderByPriority",0,0,arguments.length),new n(this.database,rr(this._delegate,nB()))}orderByValue(){return ie("Query.orderByValue",0,0,arguments.length),new n(this.database,rr(this._delegate,rB()))}startAt(e=null,t){return ie("Query.startAt",0,2,arguments.length),new n(this.database,rr(this._delegate,Y2(e,t)))}startAfter(e=null,t){return ie("Query.startAfter",0,2,arguments.length),new n(this.database,rr(this._delegate,J2(e,t)))}endAt(e=null,t){return ie("Query.endAt",0,2,arguments.length),new n(this.database,rr(this._delegate,K2(e,t)))}endBefore(e=null,t){return ie("Query.endBefore",0,2,arguments.length),new n(this.database,rr(this._delegate,Q2(e,t)))}equalTo(e,t){return ie("Query.equalTo",1,2,arguments.length),new n(this.database,rr(this._delegate,iB(e,t)))}toString(){return ie("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ie("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ie("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,Nt(e,"cancel",i.cancel,!0),i.context=r,yE(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(Jt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new $i(this.database,new Un(this._delegate._repo,this._delegate._path))}},$i=class n extends Sy{constructor(e,t){super(e,new vn(t._repo,t._path,new kh,!1)),this.database=e,this._delegate=t}getKey(){return ie("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ie("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,zs(this._delegate,e))}getParent(){ie("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return ie("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){ie("Reference.set",1,2,arguments.length),Nt("Reference.set","onComplete",t,!0);let r=Cy(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(ie("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,mB("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Fn("Reference.update",this._delegate._path),Nt("Reference.update","onComplete",t,!0);let r=G2(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ie("Reference.setWithPriority",2,3,arguments.length),Nt("Reference.setWithPriority","onComplete",r,!0);let i=z2(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){ie("Reference.remove",0,1,arguments.length),Nt("Reference.remove","onComplete",e,!0);let t=H2(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){ie("Reference.transaction",1,3,arguments.length),Nt("Reference.transaction","transactionUpdate",e,!1),Nt("Reference.transaction","onComplete",t,!0),mX("Reference.transaction","applyLocally",r,!0);let i=pB(this._delegate,e,{applyLocally:r}).then(s=>new bA(s.committed,new pa(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){ie("Reference.setPriority",1,2,arguments.length),Nt("Reference.setPriority","onComplete",t,!0);let r=q2(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){ie("Reference.push",0,2,arguments.length),Nt("Reference.push","onComplete",t,!0);let r=by(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Fn("Reference.onDisconnect",this._delegate._path),new TA(new iy(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var ma=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:oB,forceLongPolling:aB}}useEmulator(e,t,r={}){cB(this._delegate,e,t,r)}ref(e){if(ie("database.ref",0,1,arguments.length),e instanceof $i){let t=_A(this._delegate,e.toString());return new $i(this,t)}else{let t=Ou(this._delegate,e);return new $i(this,t)}}refFromURL(e){ie("database.refFromURL",1,1,arguments.length);let r=_A(this._delegate,e);return new $i(this,r)}goOffline(){return ie("database.goOffline",0,0,arguments.length),uB(this._delegate)}goOnline(){return ie("database.goOnline",0,0,arguments.length),lB(this._delegate)}};ma.ServerValue={TIMESTAMP:hB(),increment:n=>fB(n)};function _X({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){zS(t);let a=new ls("database-standalone"),c=new yo("auth-internal",a);c.setComponent(new Ve("auth-internal",()=>r,"PRIVATE"));let u;return i&&(u=new yo("app-check-internal",a),u.setComponent(new Ve("app-check-internal",()=>i,"PRIVATE"))),{instance:new ma(EA(n,c,u,e,o),n),namespace:s}}var yX=Object.freeze({__proto__:null,initStandalone:_X});var vX=ma.ServerValue;function wX(n){n.INTERNAL.registerComponent(new Ve("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new ma(i,r)},"PUBLIC").setServiceProps({Reference:$i,Query:Sy,Database:ma,DataSnapshot:pa,enableLogging:dB,INTERNAL:yX,ServerValue:vX}).setMultipleInstances(!0)),n.registerVersion(hX,fX)}wX(X);var IX="firebase",EX="10.12.2";X.registerVersion(IX,EX,"app-compat");var gB=(()=>{let e=class e{constructor(r){this.router=r}ngOnInit(){X.auth().onAuthStateChanged(r=>{r?this.router.navigate(["/chat"]):(this.router.navigate(["/log"]),document.getElementById("sidebar-container").style.display="none",document.getElementById("sidebar").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%")})}};e.\u0275fac=function(i){return new(i||e)(Se(vt))},e.\u0275cmp=yt({type:e,selectors:[["app-log"]],decls:9,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],["routerLink","/login",1,"button"],["routerLink","/register",1,"button"]],template:function(i,s){i&1&&(O(0,"div",0),ce(1,"div",1),O(2,"div",2),ce(3,"img",3),O(4,"button",4),j(5,"Accedi"),M(),O(6,"button",5),j(7,"Registrati"),M()(),ce(8,"div",1),M())},dependencies:[vm]});let n=e;return n})();var ir=(()=>{let e=class e{constructor(r){this.router=r,this.messageQueue=[]}initSector(){document.getElementById("sector-name").innerText=this.currentSector.name,document.getElementById("sector-description").innerText=this.currentSector.description}getUserData(){X.auth().onAuthStateChanged(r=>{r?X.firestore().collection("users_data").doc(r.uid).get().then(i=>{if(i.exists){var s=i.data();this.currentUser=s,document.getElementById("header-name-display").innerText=this.currentUser.name,document.getElementById("header-email-display").innerText=this.currentUser.email,document.getElementById("header-agency-display").innerText=this.currentUser.agencyName}else this.presentToast("Nessun utente trovato"),this.router.navigate(["/log"])}).catch(i=>{this.presentToast("Errore durante il recupero dell'utente:"+i.message)}):(console.log("Nessun utente loggato."),this.router.navigate(["/log"]))})}convertTimestamp(r){let i=new Date(r),s=i.getDate(),o=i.getMonth()+1,a=i.getFullYear(),c=i.getHours(),u=i.getMinutes(),d=i.getSeconds(),h=s<10?`0${s}`:`${s}`,p=o<10?`0${o}`:`${o}`,_=c<10?`0${c}`:`${c}`,w=u<10?`0${u}`:`${u}`,C=d<10?`0${d}`:`${d}`;return`${h}/${p}/${a} ${_}:${w}:${C}`}presentToast(r){this.animate1("toast-message"),this.messageQueue.push(r),this.messageQueue.length===1&&this.showMessageFromQueue()}showMessageFromQueue(){let r=this.messageQueue[0];document.getElementById("toast-message").style.display="flex",document.getElementById("toast-message-text").innerText=r,setTimeout(()=>{this.hideToastMessage()},3e3)}hideToastMessage(){this.animateFadeOut("toast-message"),setTimeout(()=>{document.getElementById("toast-message").style.display="none"},100),this.messageQueue.shift(),this.messageQueue.length>0&&(this.showMessageFromQueue(),this.animate1("toast-message"))}animate1(r){var i=document.getElementById(r),s=[{opacity:0},{opacity:1}],o={duration:150,easing:"ease-in-out"};i.animate(s,o)}animateFadeOut(r){var i=document.getElementById(r),s=[{opacity:1},{opacity:0}],o={duration:150,easing:"ease-out"};i.animate(s,o)}};e.\u0275fac=function(i){return new(i||e)(re(vt))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var _B=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}login(){var r=document.getElementById("email-login-input").value,i=document.getElementById("password-login-input").value;X.auth().signInWithEmailAndPassword(r,i).then(s=>{var o=s.user;this.generalService.presentToast("Login effettuato con successo"),this.router.navigate(["/chat"])}).catch(s=>{s.code=="auth/invalid-credential"&&this.generalService.presentToast("Email o password non validi")})}};e.\u0275fac=function(i){return new(i||e)(Se(ir),Se(vt))},e.\u0275cmp=yt({type:e,selectors:[["app-login"]],decls:15,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate",2,"color","#333"],["id","email-login-input","type","text","placeholder","Email",1,"input"],["id","password-login-input","type","text","placeholder","Password",1,"input"],[1,"button",3,"click"]],template:function(i,s){i&1&&(O(0,"div",0),ce(1,"div",1),O(2,"div",2),ce(3,"img",3),O(4,"div",4)(5,"span",5),j(6,"mail"),M(),ce(7,"input",6),M(),O(8,"div",4)(9,"span",5),j(10,"key"),M(),ce(11,"input",7),M(),O(12,"button",8),fe("click",function(){return s.login()}),j(13,"Accedi"),M()(),ce(14,"div",1),M())}});let n=e;return n})();var yB=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}register(){var r=document.getElementById("email-register-input").value,i=document.getElementById("password-register-input").value,s=document.getElementById("confirm-password-register-input").value,o=document.getElementById("name-register-input").value,a=document.getElementById("surname-register-input").value,c=document.getElementById("agency-name-register-input").value;i==s?X.auth().createUserWithEmailAndPassword(r,i).then(u=>{let d=u.user;var h=X.firestore();h.collection("users_data").doc(d.uid).set({uid:d.uid,name:o,surname:a,agencyName:c,email:r,registration_date:X.firestore.FieldValue.serverTimestamp()}).catch(p=>{this.generalService.presentToast("Errore nel salvataggio dei dati dell'utente durante la registrazione: "+p.message)}),this.generalService.presentToast("Registrazione completata con successo"),this.router.navigate(["/chat"])}).catch(u=>{u.code=="auth/invalid-email"&&this.generalService.presentToast("Email non valida"),u.code=="auth/weak-password"&&this.generalService.presentToast("Password troppo debole")}):this.generalService.presentToast("Le password inserite non corrispondono")}};e.\u0275fac=function(i){return new(i||e)(Se(ir),Se(vt))},e.\u0275cmp=yt({type:e,selectors:[["app-register"]],decls:47,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate"],["id","name-register-input","type","text","placeholder","Nome",1,"input"],["id","surname-register-input","type","text","placeholder","Cognome",1,"input"],["id","agency-name-register-input",2,"width","100%","height","100%","background","transparent","border","1px solid transparent"],["value","TORINO"],["value","ALBA"],["value","GRINZANE CAVOUR"],["value","ASTI"],["value","BRA"],["value","VAD\xD3 LIGURE"],["value","PIOBESI TORINESE"],["value","ORTOVERO"],["id","email-register-input","type","email","placeholder","Email",1,"input"],["id","password-register-input","type","email","placeholder","Password",1,"input"],["id","confirm-password-register-input","type","email","placeholder","Conferma password",1,"input"],[1,"button",2,"width","100%","height","2.5rem",3,"click"]],template:function(i,s){i&1&&(O(0,"div",0),ce(1,"div",1),O(2,"div",2),ce(3,"img",3),O(4,"div",4)(5,"span",5),j(6,"person"),M(),ce(7,"input",6),M(),O(8,"div",4)(9,"span",5),j(10,"person"),M(),ce(11,"input",7),M(),O(12,"div",4)(13,"span",5),j(14,"store"),M(),O(15,"select",8)(16,"option",9),j(17,"TORINO"),M(),O(18,"option",10),j(19,"ALBA"),M(),O(20,"option",11),j(21,"GRINZANE CAVOUR"),M(),O(22,"option",12),j(23,"ASTI"),M(),O(24,"option",13),j(25,"BRA"),M(),O(26,"option",14),j(27,"VAD\xD3 LIGURE"),M(),O(28,"option",15),j(29,"PIOBESI TORINESE"),M(),O(30,"option",16),j(31,"ORTOVERO"),M()()(),O(32,"div",4)(33,"span",5),j(34,"mail"),M(),ce(35,"input",17),M(),O(36,"div",4)(37,"span",5),j(38,"lock"),M(),ce(39,"input",18),M(),O(40,"div",4)(41,"span",5),j(42,"lock"),M(),ce(43,"input",19),M(),O(44,"button",20),fe("click",function(){return s.register()}),j(45,"Register"),M()(),ce(46,"div",1),M())}});let n=e;return n})();var vB=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){document.getElementById("sidebar").style.display="flex",document.getElementById("header").style.display="flex",document.getElementById("router-outlet-container").style.height="calc(100% - 3.5rem)",document.getElementById("router-outlet-container").style.width="calc(100% - 18rem)";let r=X.database(),i=document.getElementById("messages"),s=Ou(r,"messages");Jh(s,o=>{let a=o.val().text,c=document.createElement("div");c.className="chat-card";let u=document.createElement("div");u.style.display="flex",u.style.flexDirection="row",u.style.alignItems="center",u.style.justifyContent="space-between",c.appendChild(u);let d=document.createElement("p");d.style.marginBottom="0.5rem",d.style.marginTop="0.5rem",d.textContent=o.val().name+" | "+o.val().agencyName+" | "+this.convertTimestamp(o.val().timestamp),u.appendChild(d);let h=document.createElement("p");h.style.color="#333",h.style.marginLeft="0.5rem",h.style.cursor="pointer",h.className="material-symbols-outlined",h.textContent="delete",u.appendChild(h),h.addEventListener("click",()=>{this.deleteMessage(o.key)});let p=document.createElement("p");p.style.marginTop="0rem",p.textContent=a,c.appendChild(p),i.appendChild(c)})}deleteMessage(r){window.confirm("Sei sicuro di voler eliminare questo messaggio?")&&X.database().ref("/messages/"+r+"/").remove().then(()=>{this.generalService.presentToast("Messaggio eliminato con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione del messaggio: "+i.message)})}sendMessage(){let r=X.database();var i=X.auth().currentUser;let s=document.getElementById("message-input"),o=s.value;if(o){let a=Ou(r,"messages");by(a,{text:o,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:i.email,uid:i.uid,timestamp:X.database.ServerValue.TIMESTAMP}),s.value=""}}convertTimestamp(r){let i=new Date(r),s=i.getDate(),o=i.getMonth()+1,a=i.getFullYear(),c=i.getHours(),u=i.getMinutes(),d=i.getSeconds(),h=s<10?`0${s}`:`${s}`,p=o<10?`0${o}`:`${o}`,_=c<10?`0${c}`:`${c}`,w=u<10?`0${u}`:`${u}`,C=d<10?`0${d}`:`${d}`;return`${h}/${p}/${a} ${_}:${w}:${C}`}};e.\u0275fac=function(i){return new(i||e)(Se(ir))},e.\u0275cmp=yt({type:e,selectors:[["app-chat"]],decls:9,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden","padding-right","1rem"],["id","messages",2,"width","100%","height","calc(100% - 6rem)","display","flex","flex-direction","column","gap","1rem","overflow-x","hidden","overflow-y","auto","padding-right","1rem","padding-bottom","1rem"],[2,"width","100%","height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem"],["id","message-input","type","text","placeholder","Inserisci qui il tuo messaggio",2,"width","calc(100% - 3.5rem)","border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'",3,"keydown.enter"],["id","send-button",2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"]],template:function(i,s){i&1&&(O(0,"div",0)(1,"h2"),j(2,"Chat Generale"),M(),ce(3,"div",1),O(4,"div",2)(5,"input",3),fe("keydown.enter",function(){return s.sendMessage()}),M(),O(6,"button",4),fe("click",function(){return s.sendMessage()}),O(7,"span",5),j(8,"send"),M()()()())}});let n=e;return n})();var wB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=yt({type:e,selectors:[["app-company"]],decls:14,vars:0,consts:[[2,"height","100%","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[1,"card",2,"padding","1rem","margin-top","1rem"],[2,"max-width","80%"]],template:function(i,s){i&1&&(O(0,"div",0)(1,"div",1)(2,"h3"),j(3,"L'azienda | Mission"),M(),O(4,"p",2)(5,"strong"),j(6,"CI SONO MOLTE AGENZIE DI PRATICHE AUTO, INFINITE POSSIBILIT\xC0 PER AUTOMOBILISTI E ADDETTI AI LAVORI. CHE COSA RENDE AUTOTEAM DIVERSA E UNICA?"),M()(),O(7,"p"),j(8,"NON CI SONO RICETTE SEGRETE: TUTTO PARTE DALLA PRECISA VOLONT\xC0 DI COSTRUIRE SOLIDE RELAZIONI CON I CLIENTI. DIALOGO, ASSISTENZA, PRESENZA: IN OGNI FASE DEL LAVORO, IN OGNI OCCASIONE, PER QUALSIASI NECESSIT\xC0, AUTOTEAM C'\xC8. UN'AMPIA GAMMA DI SERVIZI E UNA COSTANTE FORMAZIONE DEI COLLABORATORI GARANTISCE TEMPESTIVIT\xC0 E QUALIT\xC0 DEI SERVIZI, METTENDO A DISPOSIZIONE DELLA CLIENTELA PERSONALE ALTAMENTE QUALIFICATO E, DAL PUNTO DI VISTA UMANO, PERSONE DISPOSTE AD ASCOLTARE E A TROVARE LA SOLUZIONE MIGLIORE PER OGNI TIPO DI ESIGENZA."),M(),O(9,"p")(10,"strong"),j(11,"UN TEAM FUNZIONA SE ALLA BASE CI SONO VALORI SOLIDI ECONDIVISI. AGENZIA AUTOTEAM CREDE PROFONDAMENTE NEL PROPRIO GRUPPO: STIMA, FIDUCIA, RISPETTO PER I COLLABORATORI SONO LE FONDAMENTA SULLE QUALI SI BASA LA NOSTRA IDEA DI GRUPPO."),M()(),O(12,"p"),j(13,"OGNUNO \xC8 IMPORTANTE, IL CONTRIBUTO DI TUTTI CONTRIBUISCE ALLA CRESCITA E AL SUCCESSO. SENZA ANTONIA, SENZA LILIANA E SENZA ROSANNA UNA REALT\xC0 COME AUTOTEAM NON SAREBBE MAI NATA: PERCH\xC9 \xC8 DAL VALORE DELLE PERSONE CHE NASCONO STORIE DI SUCCESSO. PER QUESTO MOTIVO CREDIAMO CHE UN AMBIENTE SERENO, VIVIBILE E DOVE LA MERITOCRAZIA SIA CENTRALE, POSSA ESSERE TERRENO FERTILE PER RAGGIUNGERE AMBIZIOSI TRAGUARDI"),M()()())}});let n=e;return n})();function TX(n,e){if(n&1){let t=lo();O(0,"button",7),fe("click",function(){Ii(t);let i=bi();return Ei(i.getMoreSectorProcedures())}),j(1,"Recupera altre procedure"),M()}}var IB=(()=>{let e=class e{constructor(r,i,s){this.generalService=r,this.router=i,this.route=s,this.documents=new Ye([]),this.nextPageAvailable=!1}ngOnInit(){}getMoreSectorProcedures(){!this.lastVisible||!this.nextPageAvailable||X.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSector.id).orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(K({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+r.message),this.nextPageAvailable=!1})}showAddProcedurePopup(){document.getElementById("add-new-procedure-popup").style.display="flex"}};e.\u0275fac=function(i){return new(i||e)(Se(ir),Se(vt),Se(Di))},e.\u0275cmp=yt({type:e,selectors:[["app-settori"]],decls:9,vars:1,consts:[[2,"width","100%","height","100%","overflow-y","auto","overflow-x","hidden","display","flex","flex-direction","column","padding-left","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.5rem"],["id","sector-name"],[1,"material-symbols-outlined","notranslate",2,"color","black","cursor","pointer","font-size","1.8rem",3,"click"],["id","sector-description",2,"margin-top","0rem"],["id","procedure",2,"display","flex","flex-direction","column","gap","1rem"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(O(0,"div",0)(1,"h2",1),ce(2,"span",2),j(3," | "),O(4,"span",3),fe("click",function(){return s.showAddProcedurePopup()}),j(5,"add_circle"),M()(),ce(6,"p",4)(7,"div",5),Ti(8,TX,2,0,"button",6),M()),i&2&&(cn(8),Vr("ngIf",s.nextPageAvailable))},dependencies:[Qp]});let n=e;return n})();var EB=(()=>{let e=class e{ngOnInit(){document.getElementById("sidebar").style.display="flex",document.getElementById("header").style.display="flex",document.getElementById("router-outlet-container").style.height="calc(100% - 3.5rem)",document.getElementById("router-outlet-container").style.width="calc(100% - 18rem)"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=yt({type:e,selectors:[["app-home"]],decls:1,vars:0,consts:[[2,"height","100%","padding-left","1rem","display","flex","flex-direction","row","flex-wrap","wrap"]],template:function(i,s){i&1&&ce(0,"div",0)}});let n=e;return n})();function bX(n,e){n&1&&(O(0,"span"),j(1,"Aperto"),M())}function CX(n,e){n&1&&(O(0,"span"),j(1,"Chiuso"),M())}function DX(n,e){if(n&1){let t=lo();O(0,"div",12)(1,"div",13)(2,"span",14),j(3,"account_circle"),M(),O(4,"p"),j(5),M(),ce(6,"div",11),O(7,"span",15),fe("click",function(){let i=Ii(t).$implicit,s=bi();return Ei(s.openTicketMenuPopup(i))}),j(8,"more_vert"),M()(),O(9,"h3",16),j(10),Ti(11,bX,2,0,"span",17)(12,CX,2,0,"span",17),M(),O(13,"p",18),j(14),M(),O(15,"div",19)(16,"div",20)(17,"span",21),j(18,"forum"),M(),O(19,"input",22),fe("keydown.enter",function(){let i=Ii(t).$implicit,s=bi();return Ei(s.addComment(i))}),M()(),O(20,"p",23),fe("click",function(){let i=Ii(t).$implicit,s=bi();return Ei(s.getComments(i))}),O(21,"span",24),j(22,"keyboard_arrow_down"),M(),j(23,"Commenti"),M(),ce(24,"div",25),M()()}if(n&2){let t=e.$implicit;cn(5),za(t.email),cn(5),Fp("",t.argomento," | "),cn(),Vr("ngIf",t.status=="open"),cn(),Vr("ngIf",t.status=="close"),cn(2),za(t.descrizione),cn(5),Lp("id","comment-input-",t.id,""),cn(5),Lp("id","comment-section-",t.id,"")}}function SX(n,e){if(n&1){let t=lo();O(0,"button",26),fe("click",function(){Ii(t);let i=bi();return Ei(i.getMoreTickets())}),j(1,"Recupera altri ticket"),M()}}var TB=(()=>{let e=class e{constructor(r){this.generalService=r,this.documents=new Ye([]),this.nextPageAvailable=!1,this.comments=new Ye([])}ngOnInit(){this.getOpenTickets()}openAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="flex"}openTicketMenuPopup(r){this.generalService.currentTicket=r,document.getElementById("edit-menu-ticket-popup").style.display="flex",r.status=="open"&&(document.getElementById("open-ticket-button").style.display="none",document.getElementById("close-ticket-button").style.display="flex"),r.status=="close"&&(document.getElementById("open-ticket-button").style.display="flex",document.getElementById("close-ticket-button").style.display="none")}showCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="flex"}hideCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="none"}addComment(r){var i=X.auth().currentUser;let s=document.getElementById("comment-input-"+r.id),o=s.value;o.trim()&&(X.database().ref("/comments/"+r.id+"/").push({text:o,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,timestamp:X.database.ServerValue.TIMESTAMP,creator_uid:i.uid}),s.value="")}getComments(r){let i=document.getElementById("comment-section-"+r.id);i.style.display=="none"?X.database().ref(`/comments/${r.id}/`).once("value").then(s=>{s.forEach(a=>{let c=a.key,u=a.val(),d=document.getElementById("comment-section-"+r.id),h=document.createElement("div");h.className="comment";let p=document.createElement("p");p.style.marginBottom="0.5rem",p.textContent=u.name+u.surname+" | "+this.convertTimestamp(u.timestamp);let _=document.createElement("p");_.style.marginBottom="0.5rem",_.textContent=u.text,h.appendChild(p),h.appendChild(_),d.appendChild(h)});let o=document.getElementById("comment-section-"+r.id);o&&(o.style.display="flex")}).catch(s=>{console.error("Errore durante il recupero dei commenti:",s)}):i.style.display="none"}convertTimestamp(r){let s=new Date(r).toISOString(),[o,a]=s.split("T"),[c,u,d]=o.split("-"),[h]=a.split(".");return`${d}/${u}/${c} ${h}`}getTickets(){return X.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(K({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{console.error("Error getting documents: ",r)})}getOpenTickets(){return X.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","open").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(K({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket aperti: "+r.message)})}getClosedTickets(){return X.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","close").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(K({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket chiusi: "+r.message)})}getMyTickets(){var r=X.auth().currentUser;return X.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("creator_id","==",r.uid).onSnapshot(i=>{let s=[];i.forEach(o=>{s.push(K({id:o.id},o.data()))}),s.length===4?(this.lastVisible=i.docs[i.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(s)},i=>{this.generalService.presentToast("Errore nel recuperare i tuoi ticket: "+i.message)})}getMoreTickets(){!this.lastVisible||!this.nextPageAvailable||X.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(K({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}};e.\u0275fac=function(i){return new(i||e)(Se(ir))},e.\u0275cmp=yt({type:e,selectors:[["app-tickets"]],decls:24,vars:4,consts:[[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","flex-wrap","wrap"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","black","font-size","1.8rem","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","border","1px solid rgba(0, 0, 0, 0.192)","border-radius","2rem","padding-left","1rem","padding-right","1rem","height","2.5rem","overflow-y","hidden","overflow-x","auto","margin-bottom","1rem"],[2,"cursor","pointer",3,"click"],[2,"height","100%","width","1px","background","rgba(0, 0, 0, 0.192)"],[2,"overflow-y","auto","overflow-x","hidden","padding-bottom","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","card","style","padding-left: 1rem; padding-bottom: 1rem;",4,"ngFor","ngForOf"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],[2,"flex","1"],[1,"card",2,"padding-left","1rem","padding-bottom","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","padding-right","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem",3,"click"],[2,"margin-top","0rem","margin-bottom","0rem"],[4,"ngIf"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","column","align-items","center","padding-right","1rem"],[1,"input-group",2,"width","100%"],[1,"material-symbols-outlined","notranslate"],["type","text","placeholder","Scrivi un commento",1,"input",3,"keydown.enter","id"],[2,"cursor","pointer","display","flex","flex-direction","row","align-items","center","width","100%",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[2,"display","none","flex-direction","column","gap","1rem","width","100%",3,"id"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(O(0,"div",0)(1,"div",1)(2,"h2",2),j(3,"Tickets"),O(4,"span",3),fe("click",function(){return s.openAddTicketPopup()}),j(5,"add_circle"),M()(),O(6,"div",4)(7,"h3",5),fe("click",function(){return s.getOpenTickets()}),j(8,"Aperti"),M(),ce(9,"div",6),O(10,"h3",5),fe("click",function(){return s.getClosedTickets()}),j(11,"Chiusi"),M(),ce(12,"div",6),O(13,"h3",5),fe("click",function(){return s.getTickets()}),j(14,"Tutti"),M(),ce(15,"div",6),O(16,"h3",5),fe("click",function(){return s.getMyTickets()}),j(17,"Pubblicati da me"),M()()(),O(18,"div",7)(19,"div",8),Ti(20,DX,25,9,"div",9),Vp(21,"async"),Ti(22,SX,2,0,"button",10),M()(),ce(23,"div",11),M()),i&2&&(cn(20),Vr("ngForOf",Up(21,2,s.documents)),cn(2),Vr("ngIf",s.nextPageAvailable))},dependencies:[Kp,Qp,Yp]});let n=e;return n})();var AX=[{path:"",redirectTo:"chat",pathMatch:"full"},{path:"log",component:gB},{path:"login",component:_B},{path:"register",component:yB},{path:"company",component:wB},{path:"chat",component:vB},{path:"settori_e_procedure",component:IB},{path:"home",component:EB},{path:"tickets",component:TB}],bB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=fr({type:e}),e.\u0275inj=hr({imports:[uE.forRoot(AX),uE]});let n=e;return n})();function RX(n,e){if(n&1){let t=lo();O(0,"button",41),fe("click",function(){let i=Ii(t).$implicit,s=bi();return Ei(s.showSectorProcedures(i))}),O(1,"span",42),j(2,"library_books"),M(),j(3),M()}if(n&2){let t=e.$implicit;cn(3),za(t.name)}}var CB=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.documents=new Ye([]),this.initFirebase(),this.generalService.getUserData()}ngOnInit(){}initFirebase(){let r={apiKey:"AIzaSyCsD3AG7Zq7Aw_VAhn6N9ZGqVdabUrcFZU",authDomain:"tenquestion-6e3dd.firebaseapp.com",databaseURL:"https://tenquestion-6e3dd-default-rtdb.europe-west1.firebasedatabase.app",projectId:"tenquestion-6e3dd",storageBucket:"tenquestion-6e3dd.appspot.com",messagingSenderId:"438469942447",appId:"1:438469942447:web:97b3e3a5bf4620aa4f485a",measurementId:"G-3XVQGB22FD"};X.initializeApp(r)}logout(){window.confirm("Sei sicuro di volerti disconnettere?")&&X.auth().signOut().then(()=>{this.generalService.presentToast("Disconnessione effettuata con successo"),this.router.navigate(["/log"])}).catch(r=>{this.generalService.presentToast("Errore durante la disconnessione: "+r.message)})}closeAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="none"}closeTicketMenuPopup(){document.getElementById("edit-menu-ticket-popup").style.display="none"}closeAddNewSectorPopup(){document.getElementById("add-new-sector-popup").style.display="none"}closeAddNewProcedurePopup(){document.getElementById("add-new-procedure-popup").style.display="none"}deleteTicket(){window.confirm("Sei sicuro di voler eliminare questo ticket?")&&X.firestore().collection("tickets").doc(this.generalService.currentTicket.id).delete().then(()=>{this.generalService.presentToast("Ticket eliminato con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'eliminazione del ticket: "+r.message)})}openTicket(){X.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"open"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aperto con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'apertura del ticket: "+r.message)})}closeTicket(){X.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"close"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket chiuso con successo")}).catch(r=>{this.generalService.presentToast("Errore durante la chiusura del ticket: "+r.message)})}addTicket(){let r=document.getElementById("add-ticket-argomento-input").value,i=document.getElementById("add-ticket-description-input").value;var s=X.auth().currentUser;X.firestore().collection("tickets").add({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:s.email,creator_id:s.uid,timestamp:X.firestore.FieldValue.serverTimestamp(),status:"open"}).then(o=>{document.getElementById("add-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del ticket: "+o.message)})}openCloseSettoriEProcedure(){let r=document.getElementById("settori-menu-container"),i=document.getElementById("open-menu-icon1");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):X.firestore().collection("settori").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(K({id:a.id},a.data()))}),this.documents.next(o),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero dei settori: "+s.message)})}hideOrShowSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}showSectorProcedures(r){this.router.navigate(["/settori_e_procedure"]),setTimeout(()=>{this.generalService.currentSector=r,this.getSectorProcedures(r),this.generalService.initSector(),window.innerWidth<=799&&this.hideOrShowSidebar()},200)}newSector(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-sector-popup").style.display="flex"}addNewSector(){let r=document.getElementById("add-sector-name-input"),i=document.getElementById("add-sector-description-input");var s=X.auth().currentUser;X.firestore().collection("settori").doc().set({name:r.value,description:i.value,timestamp:X.firestore.FieldValue.serverTimestamp(),creator_id:s.uid}).then(()=>{document.getElementById("add-new-sector-popup").style.display="none",this.generalService.presentToast("Settore aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del settore: "+o.message)})}addNewProcedure(){let r=document.getElementById("add-procedure-name-input"),i=document.getElementById("add-procedure-description-input"),s=document.getElementById("add-procedure-link-input");X.firestore().collection("procedure").doc().set({name:r.value,description:i.value,link:s.value,sector_id:this.generalService.currentSector.id,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,timestamp:X.firestore.FieldValue.serverTimestamp()}).then(()=>{document.getElementById("add-new-procedure-popup").style.display="none",this.generalService.presentToast("Procedura aggiunta con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+o.message)})}getSectorProcedures(r){let i=document.getElementById("procedure");return i.innerHTML="",X.firestore().collection("procedure").where("sector_id","==",r.id).orderBy("timestamp","desc").onSnapshot(s=>{let o=[];s.forEach(a=>{var c=a.data();let u=document.createElement("div");u.className="card",u.style.paddingLeft="1rem";let d=document.createElement("h4");d.style.marginBottom="0.5rem",d.textContent=c.name+" | "+c.creator_name+c.creator_surname+" | "+this.generalService.convertTimestamp(Number(c.timestamp)),u.appendChild(d);let h=document.createElement("p");h.style.marginTop="0rem",h.textContent=c.description,u.appendChild(h);let p=document.createElement("p");p.id="link-"+r.id,p.style.marginTop="0rem",p.textContent=c.link,u.appendChild(p),i.appendChild(u)})},s=>{this.generalService.presentToast("Errore nel recuperare le procedure del settore selezionato: "+s.message)})}};e.\u0275fac=function(i){return new(i||e)(Se(ir),Se(vt))},e.\u0275cmp=yt({type:e,selectors:[["app-root"]],decls:107,vars:3,consts:[["id","toast-message",2,"height","100%","width","100%","display","none","flex-direction","column","pointer-events","none","background","transparent","z-index","99999999","position","absolute","align-items","center","justify-content","end"],[1,"toastMessage",2,"pointer-events","all"],["id","toast-message-text"],["id","add-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"min-width","18rem","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","space-between"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","black","cursor","pointer",3,"click"],[2,"width","100%","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-ticket-argomento-input","type","text","placeholder","Argomento",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-ticket-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[1,"button",3,"click"],["id","edit-menu-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[2,"display","flex","flex-direction","column","gap","1rem"],["id","open-ticket-button",1,"button",3,"click"],["id","close-ticket-button",1,"button",3,"click"],["id","add-new-sector-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-sector-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-sector-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-procedure-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-procedure-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-procedure-link-input","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","header",2,"height","3.5rem","border-bottom","1px solid rgba(0, 0, 0, 0.192)","display","flex","flex-direction","row","align-items","center","flex-shrink","0","justify-content","space-between","padding-left","1rem","padding-right","1rem"],[1,"desktop-element",2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2rem","color","#333","cursor","pointer"],["id","header-name-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-email-display",2,"margin-top","0rem","margin-bottom","0rem"],["id","header-agency-display",2,"margin-bottom","0rem","margin-top","0rem"],[1,"mobile-element",2,"display","none","flex-direction","row","align-items","center","gap","1rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2rem","color","#333","cursor","pointer",3,"click"],[2,"width","100%","height","100%","display","flex","flex-direction","row"],["id","sidebar-container",2,"display","flex"],["id","sidebar",1,"desktop-element",2,"display","flex","flex-direction","column","width","18rem","flex-shrink","0","height","calc(100% - 3.5rem)","background","white","border-right","1px solid rgba(0, 0, 0, 0.192)","overflow-y","auto","overflow-x","hidden"],["src","assets\\imgs\\logo.png",2,"width","100%","margin-top","1rem"],["routerLink","/company",1,"sidebar-button"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["routerLink","/tickets",1,"sidebar-button"],["routerLink","/chat",1,"sidebar-button"],[1,"sidebar-button",3,"click"],["id","open-menu-icon1",1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","settori-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem","margin-bottom","2rem"],[1,"sidebar-button",2,"width","100%",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.8rem"],["class","sidebar-button","style","width: 100%;",3,"click",4,"ngFor","ngForOf"],[2,"flex","1"],[1,"sidebar-button",2,"margin-bottom","1rem",3,"click"],["id","router-outlet-container",2,"width","calc(100% - 18rem)","height","calc(100% - 3.5rem)"]],template:function(i,s){i&1&&(O(0,"div",0)(1,"div",1),ce(2,"p",2),M()(),O(3,"div",3)(4,"div",4)(5,"h3",5),j(6,"Nuovo Ticket"),O(7,"span",6),fe("click",function(){return s.closeAddTicketPopup()}),j(8,"close"),M()(),O(9,"div",7),ce(10,"input",8)(11,"textarea",9),M(),O(12,"div",5)(13,"button",10),fe("click",function(){return s.closeAddTicketPopup()}),j(14,"Annulla"),M(),O(15,"button",10),fe("click",function(){return s.addTicket()}),j(16,"Pubblica"),M()()()(),O(17,"div",11)(18,"div",4)(19,"h3",5),j(20,"Men\xF9 ticket"),O(21,"span",6),fe("click",function(){return s.closeTicketMenuPopup()}),j(22,"close"),M()(),O(23,"div",12)(24,"button",10),fe("click",function(){return s.deleteTicket()}),j(25,"Elimina"),M(),O(26,"button",13),fe("click",function(){return s.openTicket()}),j(27,"Apri"),M(),O(28,"button",14),fe("click",function(){return s.closeTicket()}),j(29,"Chiudi"),M()()()(),O(30,"div",15)(31,"div",4)(32,"h3",5),j(33,"Nuovo settore"),O(34,"span",6),fe("click",function(){return s.closeAddNewSectorPopup()}),j(35,"close"),M()(),O(36,"div",7),ce(37,"input",16)(38,"textarea",17),M(),O(39,"div",5)(40,"button",10),fe("click",function(){return s.closeAddNewSectorPopup()}),j(41,"Annulla"),M(),O(42,"button",10),fe("click",function(){return s.addNewSector()}),j(43,"Aggiungi"),M()()()(),O(44,"div",18)(45,"div",4)(46,"h3",5),j(47,"Nuova procedura"),O(48,"span",6),fe("click",function(){return s.closeAddNewProcedurePopup()}),j(49,"close"),M()(),O(50,"div",7),ce(51,"input",19)(52,"textarea",20)(53,"textarea",21),M(),O(54,"div",5)(55,"button",10),fe("click",function(){return s.closeAddNewProcedurePopup()}),j(56,"Annulla"),M(),O(57,"button",10),fe("click",function(){return s.addNewProcedure()}),j(58,"Aggiungi"),M()()()(),O(59,"div",22)(60,"div",23)(61,"span",24),j(62,"account_circle"),M(),O(63,"div"),ce(64,"h3",25)(65,"p",26),M(),O(66,"p"),j(67," | "),M(),O(68,"div"),ce(69,"h3",27),M()(),O(70,"div",28)(71,"span",29),fe("click",function(){return s.hideOrShowSidebar()}),j(72,"menu"),M()()(),O(73,"div",30)(74,"div",31)(75,"div",32),ce(76,"img",33),O(77,"button",34)(78,"span",35),j(79,"apartment"),M(),j(80,"L'azienda"),M(),O(81,"button",36)(82,"span",35),j(83,"style"),M(),j(84,"Tickets"),M(),O(85,"button",37)(86,"span",35),j(87,"chat"),M(),j(88,"Chat"),M(),O(89,"button",38),fe("click",function(){return s.openCloseSettoriEProcedure()}),O(90,"span",39),j(91,"keyboard_arrow_down"),M(),j(92,"Settori e procedure"),M(),O(93,"div",40)(94,"button",41),fe("click",function(){return s.newSector()}),O(95,"span",42),j(96,"add_circle"),M(),j(97,"Nuovo settore"),M(),Ti(98,RX,4,1,"button",43),Vp(99,"async"),M(),ce(100,"div",44),O(101,"button",45),fe("click",function(){return s.logout()}),O(102,"span",35),j(103,"logout"),M(),j(104,"Disconnetti"),M()()(),O(105,"div",46),ce(106,"router-outlet"),M()()),i&2&&(cn(98),Vr("ngForOf",Up(99,1,s.documents)))},dependencies:[Kp,nE,vm,Yp]});let n=e;return n})();var DB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=fr({type:e,bootstrap:[CB]}),e.\u0275inj=hr({providers:[{provide:mr,useClass:Wp}],imports:[vM,bB]});let n=e;return n})();yM().bootstrapModule(DB).catch(n=>console.error(n));
