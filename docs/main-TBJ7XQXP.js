var MR=Object.defineProperty,mj=Object.defineProperties;var gj=Object.getOwnPropertyDescriptors;var NR=Object.getOwnPropertySymbols,_j=Object.getPrototypeOf,yj=Object.prototype.hasOwnProperty,vj=Object.prototype.propertyIsEnumerable,wj=Reflect.get;var PR=(n,e,t)=>e in n?MR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,K=(n,e)=>{for(var t in e||={})yj.call(e,t)&&PR(n,t,e[t]);if(NR)for(var t of NR(e))vj.call(e,t)&&PR(n,t,e[t]);return n},ot=(n,e)=>mj(n,gj(e));var Ij=(n,e)=>{for(var t in e)MR(n,t,{get:e[t],enumerable:!0})};var Ar=(n,e,t)=>wj(_j(n),t,e);var g=(n,e,t)=>new Promise((r,i)=>{var s=c=>{try{a(t.next(c))}catch(l){i(l)}},o=c=>{try{a(t.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(n,e)).next())});var kR=null;var rv=1,OR=Symbol("SIGNAL");function Ne(n){let e=kR;return kR=n,e}var LR={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Ej(n){if(!(ov(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===rv)){if(!n.producerMustRecompute(n)&&!iv(n)){n.dirty=!1,n.lastCleanEpoch=rv;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=rv}}function FR(n){return n&&(n.nextProducerIndex=0),Ne(n)}function VR(n,e){if(Ne(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(ov(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)sv(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function iv(n){Ef(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(Ej(t),r!==t.version))return!0}return!1}function UR(n){if(Ef(n),ov(n))for(let e=0;e<n.producerNode.length;e++)sv(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function sv(n,e){if(Tj(n),Ef(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)sv(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Ef(i),i.producerIndexOfThis[r]=e}}function ov(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Ef(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function Tj(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function bj(){throw new Error}var Cj=bj;function BR(n){Cj=n}function ue(n){return typeof n=="function"}function Sa(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Tf=Sa(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ou(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var xt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ue(r))try{r()}catch(s){e=s instanceof Tf?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{jR(s)}catch(o){e=e??[],o instanceof Tf?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Tf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)jR(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ou(t,e)}remove(e){let{_finalizers:t}=this;t&&ou(t,e),e instanceof n&&e._removeParent(this)}};xt.EMPTY=(()=>{let n=new xt;return n.closed=!0,n})();var av=xt.EMPTY;function bf(n){return n instanceof xt||n&&"closed"in n&&ue(n.remove)&&ue(n.add)&&ue(n.unsubscribe)}function jR(n){ue(n)?n():n.unsubscribe()}var or={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Da={setTimeout(n,e,...t){let{delegate:r}=Da;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Da;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Cf(n){Da.setTimeout(()=>{let{onUnhandledError:e}=or;if(e)e(n);else throw n})}function au(){}var $R=cv("C",void 0,void 0);function HR(n){return cv("E",void 0,n)}function qR(n){return cv("N",n,void 0)}function cv(n,e,t){return{kind:n,value:e,error:t}}var to=null;function Aa(n){if(or.useDeprecatedSynchronousErrorHandling){let e=!to;if(e&&(to={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=to;if(to=null,t)throw r}}else n()}function zR(n){or.useDeprecatedSynchronousErrorHandling&&to&&(to.errorThrown=!0,to.error=n)}var no=class extends xt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,bf(e)&&e.add(this)):this.destination=Aj}static create(e,t,r){return new Ra(e,t,r)}next(e){this.isStopped?uv(qR(e),this):this._next(e)}error(e){this.isStopped?uv(HR(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?uv($R,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Sj=Function.prototype.bind;function lv(n,e){return Sj.call(n,e)}var dv=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Sf(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Sf(r)}else Sf(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Sf(t)}}},Ra=class extends no{constructor(e,t,r){super();let i;if(ue(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&or.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&lv(e.next,s),error:e.error&&lv(e.error,s),complete:e.complete&&lv(e.complete,s)}):i=e}this.destination=new dv(i)}};function Sf(n){or.useDeprecatedSynchronousErrorHandling?zR(n):Cf(n)}function Dj(n){throw n}function uv(n,e){let{onStoppedNotification:t}=or;t&&Da.setTimeout(()=>t(n,e))}var Aj={closed:!0,next:au,error:Dj,complete:au};var xa=typeof Symbol=="function"&&Symbol.observable||"@@observable";function xn(n){return n}function hv(...n){return fv(n)}function fv(n){return n.length===0?xn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Fe=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=xj(t)?t:new Ra(t,r,i);return Aa(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=GR(r),new r((i,s)=>{let o=new Ra({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[xa](){return this}pipe(...t){return fv(t)(this)}toPromise(t){return t=GR(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function GR(n){var e;return(e=n??or.Promise)!==null&&e!==void 0?e:Promise}function Rj(n){return n&&ue(n.next)&&ue(n.error)&&ue(n.complete)}function xj(n){return n&&n instanceof no||Rj(n)&&bf(n)}function pv(n){return ue(n?.lift)}function Se(n){return e=>{if(pv(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function De(n,e,t,r,i){return new mv(n,e,t,r,i)}var mv=class extends no{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Na(){return Se((n,e)=>{let t=null;n._refCount++;let r=De(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Pa=class extends Fe{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,pv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new xt;let t=this.getSubject();e.add(this.source.subscribe(De(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=xt.EMPTY)}return e}refCount(){return Na()(this)}};var WR=Sa(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Yt=(()=>{class n extends Fe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Df(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new WR}next(t){Aa(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Aa(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Aa(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?av:(this.currentObservers=null,s.push(t),new xt(()=>{this.currentObservers=null,ou(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new Fe;return t.source=this,t}}return n.create=(e,t)=>new Df(e,t),n})(),Df=class extends Yt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:av}};var Xe=class extends Yt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Nn=new Fe(n=>n.complete());function KR(n){return n&&ue(n.schedule)}function QR(n){return n[n.length-1]}function YR(n){return ue(QR(n))?n.pop():void 0}function Wi(n){return KR(QR(n))?n.pop():void 0}function Af(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function XR(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{l(r.next(d))}catch(h){o(h)}}function c(d){try{l(r.throw(d))}catch(h){o(h)}}function l(d){d.done?s(d.value):i(d.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function JR(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ro(n){return this instanceof ro?(this.v=n,this):new ro(n)}function ZR(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(w){return Promise.resolve(w).then(_,h)}}function a(_,w){r[_]&&(i[_]=function(b){return new Promise(function(S,O){s.push([_,b,S,O])>1||c(_,b)})},w&&(i[_]=w(i[_])))}function c(_,w){try{l(r[_](w))}catch(b){p(s[0][3],b)}}function l(_){_.value instanceof ro?Promise.resolve(_.value.v).then(d,h):p(s[0][2],_)}function d(_){c("next",_)}function h(_){c("throw",_)}function p(_,w){_(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function ex(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof JR=="function"?JR(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Rf=n=>n&&typeof n.length=="number"&&typeof n!="function";function xf(n){return ue(n?.then)}function Nf(n){return ue(n[xa])}function Pf(n){return Symbol.asyncIterator&&ue(n?.[Symbol.asyncIterator])}function Mf(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Nj(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var kf=Nj();function Of(n){return ue(n?.[kf])}function Lf(n){return ZR(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield ro(t.read());if(i)return yield ro(void 0);yield yield ro(r)}}finally{t.releaseLock()}})}function Ff(n){return ue(n?.getReader)}function Mt(n){if(n instanceof Fe)return n;if(n!=null){if(Nf(n))return Pj(n);if(Rf(n))return Mj(n);if(xf(n))return kj(n);if(Pf(n))return tx(n);if(Of(n))return Oj(n);if(Ff(n))return Lj(n)}throw Mf(n)}function Pj(n){return new Fe(e=>{let t=n[xa]();if(ue(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Mj(n){return new Fe(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function kj(n){return new Fe(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Cf)})}function Oj(n){return new Fe(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function tx(n){return new Fe(e=>{Fj(n,e).catch(t=>e.error(t))})}function Lj(n){return tx(Lf(n))}function Fj(n,e){var t,r,i,s;return XR(this,void 0,void 0,function*(){try{for(t=ex(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function In(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function Vf(n,e=0){return Se((t,r)=>{t.subscribe(De(r,i=>In(r,n,()=>r.next(i),e),()=>In(r,n,()=>r.complete(),e),i=>In(r,n,()=>r.error(i),e)))})}function Uf(n,e=0){return Se((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function nx(n,e){return Mt(n).pipe(Uf(e),Vf(e))}function rx(n,e){return Mt(n).pipe(Uf(e),Vf(e))}function ix(n,e){return new Fe(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function sx(n,e){return new Fe(t=>{let r;return In(t,e,()=>{r=n[kf](),In(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>ue(r?.return)&&r.return()})}function Bf(n,e){if(!n)throw new Error("Iterable cannot be null");return new Fe(t=>{In(t,e,()=>{let r=n[Symbol.asyncIterator]();In(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function ox(n,e){return Bf(Lf(n),e)}function ax(n,e){if(n!=null){if(Nf(n))return nx(n,e);if(Rf(n))return ix(n,e);if(xf(n))return rx(n,e);if(Pf(n))return Bf(n,e);if(Of(n))return sx(n,e);if(Ff(n))return ox(n,e)}throw Mf(n)}function ht(n,e){return e?ax(n,e):Mt(n)}function ce(...n){let e=Wi(n);return ht(n,e)}function Ma(n,e){let t=ue(n)?n:()=>n,r=i=>i.error(t());return new Fe(e?i=>e.schedule(r,0,i):r)}function gv(n){return!!n&&(n instanceof Fe||ue(n.lift)&&ue(n.subscribe))}var Ii=Sa(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Ae(n,e){return Se((t,r)=>{let i=0;t.subscribe(De(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:Vj}=Array;function Uj(n,e){return Vj(e)?n(...e):n(e)}function cx(n){return Ae(e=>Uj(n,e))}var{isArray:Bj}=Array,{getPrototypeOf:jj,prototype:$j,keys:Hj}=Object;function lx(n){if(n.length===1){let e=n[0];if(Bj(e))return{args:e,keys:null};if(qj(e)){let t=Hj(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function qj(n){return n&&typeof n=="object"&&jj(n)===$j}function ux(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function cu(...n){let e=Wi(n),t=YR(n),{args:r,keys:i}=lx(n);if(r.length===0)return ht([],e);let s=new Fe(zj(r,e,i?o=>ux(i,o):xn));return t?s.pipe(cx(t)):s}function zj(n,e,t=xn){return r=>{dx(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)dx(e,()=>{let l=ht(n[c],e),d=!1;l.subscribe(De(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function dx(n,e,t){n?In(t,n,e):e()}function hx(n,e,t,r,i,s,o,a){let c=[],l=0,d=0,h=!1,p=()=>{h&&!c.length&&!l&&e.complete()},_=b=>l<r?w(b):c.push(b),w=b=>{s&&e.next(b),l++;let S=!1;Mt(t(b,d++)).subscribe(De(e,O=>{i?.(O),s?_(O):e.next(O)},()=>{S=!0},void 0,()=>{if(S)try{for(l--;c.length&&l<r;){let O=c.shift();o?In(e,o,()=>w(O)):w(O)}p()}catch(O){e.error(O)}}))};return n.subscribe(De(e,_,()=>{h=!0,p()})),()=>{a?.()}}function yt(n,e,t=1/0){return ue(e)?yt((r,i)=>Ae((s,o)=>e(r,s,i,o))(Mt(n(r,i))),t):(typeof e=="number"&&(t=e),Se((r,i)=>hx(r,i,n,t)))}function ka(n=1/0){return yt(xn,n)}function fx(){return ka(1)}function Oa(...n){return fx()(ht(n,Wi(n)))}function jf(n){return new Fe(e=>{Mt(n()).subscribe(e)})}function $n(n,e){return Se((t,r)=>{let i=0;t.subscribe(De(r,s=>n.call(e,s,i++)&&r.next(s)))})}function Ki(n){return Se((e,t)=>{let r=null,i=!1,s;r=e.subscribe(De(t,void 0,void 0,o=>{s=Mt(n(o,Ki(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function px(n,e,t,r,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(De(o,d=>{let h=l++;c=a?n(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function io(n,e){return ue(e)?yt(n,e,1):yt(n,1)}function Qi(n){return Se((e,t)=>{let r=!1;e.subscribe(De(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Ei(n){return n<=0?()=>Nn:Se((e,t)=>{let r=0;e.subscribe(De(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function _v(n){return Ae(()=>n)}function $f(n=Gj){return Se((e,t)=>{let r=!1;e.subscribe(De(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function Gj(){return new Ii}function lu(n){return Se((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Rr(n,e){let t=arguments.length>=2;return r=>r.pipe(n?$n((i,s)=>n(i,s,r)):xn,Ei(1),t?Qi(e):$f(()=>new Ii))}function La(n){return n<=0?()=>Nn:Se((e,t)=>{let r=[];e.subscribe(De(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function yv(n,e){let t=arguments.length>=2;return r=>r.pipe(n?$n((i,s)=>n(i,s,r)):xn,La(1),t?Qi(e):$f(()=>new Ii))}function vv(n,e){return Se(px(n,e,arguments.length>=2,!0))}function wv(...n){let e=Wi(n);return Se((t,r)=>{(e?Oa(n,t,e):Oa(n,t)).subscribe(r)})}function Hn(n,e){return Se((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(De(r,c=>{i?.unsubscribe();let l=0,d=s++;Mt(n(c,d)).subscribe(i=De(r,h=>r.next(e?e(c,h,d,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Iv(n){return Se((e,t)=>{Mt(n).subscribe(De(t,()=>t.complete(),au)),!t.closed&&e.subscribe(t)})}function jt(n,e,t){let r=ue(n)||e||t?{next:n,error:e,complete:t}:n;return r?Se((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(De(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):xn}var Jx="https://g.co/ng/security#xss",te=class extends Error{constructor(e,t){super(pw(e,t)),this.code=e}};function pw(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function Tu(n){return{toString:n}.toString()}var Hf="__parameters__";function Wj(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function Xx(n,e,t){return Tu(()=>{let r=Wj(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let h=c.hasOwnProperty(Hf)?c[Hf]:Object.defineProperty(c,Hf,{value:[]})[Hf];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var ln=globalThis;function Be(n){for(let e in n)if(n[e]===Be)return e;throw Error("Could not find renamed property on target object.")}function Tn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Tn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function mx(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var Kj=Be({__forward_ref__:Be});function Zx(n){return n.__forward_ref__=Zx,n.toString=function(){return Tn(this())},n}function qn(n){return eN(n)?n():n}function eN(n){return typeof n=="function"&&n.hasOwnProperty(Kj)&&n.__forward_ref__===Zx}function ne(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function hr(n){return{providers:n.providers||[],imports:n.imports||[]}}function vp(n){return gx(n,nN)||gx(n,rN)}function tN(n){return vp(n)!==null}function gx(n,e){return n.hasOwnProperty(e)?n[e]:null}function Qj(n){let e=n&&(n[nN]||n[rN]);return e||null}function _x(n){return n&&(n.hasOwnProperty(yx)||n.hasOwnProperty(Yj))?n[yx]:null}var nN=Be({\u0275prov:Be}),yx=Be({\u0275inj:Be}),rN=Be({ngInjectableDef:Be}),Yj=Be({ngInjectorDef:Be}),de=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ne({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function iN(n){return n&&!!n.\u0275providers}var Jj=Be({\u0275cmp:Be}),Xj=Be({\u0275dir:Be}),Zj=Be({\u0275pipe:Be}),e$=Be({\u0275mod:Be}),Jf=Be({\u0275fac:Be}),uu=Be({__NG_ELEMENT_ID__:Be}),vx=Be({__NG_ENV_ID__:Be});function so(n){return typeof n=="string"?n:n==null?"":String(n)}function t$(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():so(n)}function n$(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new te(-200,n)}function mw(n,e){throw new te(-201,!1)}var ve=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ve||{}),Nv;function sN(){return Nv}function En(n){let e=Nv;return Nv=n,e}function oN(n,e,t){let r=vp(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ve.Optional)return null;if(e!==void 0)return e;mw(n,"Injector")}var r$={},hu=r$,Pv="__NG_DI_FLAG__",Xf="ngTempTokenPath",i$="ngTokenPath",s$=/\n/gm,o$="\u0275",wx="__source",ja;function a$(){return ja}function Yi(n){let e=ja;return ja=n,e}function c$(n,e=ve.Default){if(ja===void 0)throw new te(-203,!1);return ja===null?oN(n,void 0,e):ja.get(n,e&ve.Optional?null:void 0,e)}function ie(n,e=ve.Default){return(sN()||c$)(qn(n),e)}function W(n,e=ve.Default){return ie(n,wp(e))}function wp(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Mv(n){let e=[];for(let t=0;t<n.length;t++){let r=qn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new te(900,!1);let i,s=ve.Default;for(let o=0;o<r.length;o++){let a=r[o],c=l$(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(ie(i,s))}else e.push(ie(r))}return e}function aN(n,e){return n[Pv]=e,n.prototype[Pv]=e,n}function l$(n){return n[Pv]}function u$(n,e,t,r){let i=n[Xf];throw e[wx]&&i.unshift(e[wx]),n.message=d$(`
`+n.message,i,t,r),n[i$]=i,n[Xf]=null,n}function d$(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==o$?n.slice(2):n;let i=Tn(e);if(Array.isArray(e))i=e.map(Tn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Tn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(s$,`
  `)}`}var Ip=aN(Xx("Optional"),8);var gw=aN(Xx("SkipSelf"),4);function co(n,e){let t=n.hasOwnProperty(Jf);return t?n[Jf]:null}function _w(n,e){n.forEach(t=>Array.isArray(t)?_w(t,e):e(t))}function cN(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Zf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var fu={},xr=[],Ha=new de(""),lN=new de("",-1),uN=new de(""),ep=class{get(e,t=hu){if(t===hu){let r=new Error(`NullInjectorError: No provider for ${Tn(e)}!`);throw r.name="NullInjectorError",r}return t}},dN=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(dN||{}),Mr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Mr||{}),lr=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(lr||{});function h$(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function kv(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];f$(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function hN(n){return n===3||n===4||n===6}function f$(n){return n.charCodeAt(0)===64}function yw(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?Ix(n,t,i,null,e[++r]):Ix(n,t,i,null,null))}}return n}function Ix(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var fN="ng-template";function p$(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&h$(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(vw(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function vw(n){return n.type===4&&n.value!==fN}function m$(n,e,t){let r=n.type===4&&!t?fN:n.value;return e===r}function g$(n,e,t){let r=4,i=n.attrs,s=i!==null?v$(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!ar(r)&&!ar(c))return!1;if(o&&ar(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!m$(n,c,t)||c===""&&e.length===1){if(ar(r))return!1;o=!0}}else if(r&8){if(i===null||!p$(n,i,c,t)){if(ar(r))return!1;o=!0}}else{let l=e[++a],d=_$(c,i,vw(n),t);if(d===-1){if(ar(r))return!1;o=!0;continue}if(l!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(ar(r))return!1;o=!0}}}}return ar(r)||o}function ar(n){return(n&1)===0}function _$(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return w$(e,n)}function y$(n,e,t=!1){for(let r=0;r<e.length;r++)if(g$(n,e[r],t))return!0;return!1}function v$(n){for(let e=0;e<n.length;e++){let t=n[e];if(hN(t))return e}return n.length}function w$(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function Ex(n,e){return n?":not("+e.trim()+")":e}function I$(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!ar(o)&&(e+=Ex(s,i),i=""),r=o,s=s||!ar(r);t++}return i!==""&&(e+=Ex(s,i)),e}function E$(n){return n.map(I$).join(",")}function T$(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!ar(i))break;i=s}r++}return{attrs:e,classes:t}}function vt(n){return Tu(()=>{let e=vN(n),t=ot(K({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===dN.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Mr.Emulated,styles:n.styles||xr,_:null,schemas:n.schemas||null,tView:null,id:""});wN(t);let r=n.dependencies;return t.directiveDefs=bx(r,!1),t.pipeDefs=bx(r,!0),t.id=S$(t),t})}function b$(n){return Xi(n)||mN(n)}function C$(n){return n!==null}function fr(n){return Tu(()=>({type:n.type,bootstrap:n.bootstrap||xr,declarations:n.declarations||xr,imports:n.imports||xr,exports:n.exports||xr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Tx(n,e){if(n==null)return fu;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=lr.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==lr.None?[r,a]:r,e[s]=o):t[s]=r}return t}function Wa(n){return Tu(()=>{let e=vN(n);return wN(e),e})}function pN(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function Xi(n){return n[Jj]||null}function mN(n){return n[Xj]||null}function gN(n){return n[Zj]||null}function _N(n){let e=Xi(n)||mN(n)||gN(n);return e!==null?e.standalone:!1}function yN(n,e){let t=n[e$]||null;if(!t&&e===!0)throw new Error(`Type ${Tn(n)} does not have '\u0275mod' property.`);return t}function vN(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||fu,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||xr,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Tx(n.inputs,e),outputs:Tx(n.outputs),debugInfo:null}}function wN(n){n.features?.forEach(e=>e(n))}function bx(n,e){if(!n)return null;let t=e?gN:b$;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(C$)}function S$(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function D$(...n){return{\u0275providers:IN(!0,n),\u0275fromNgModule:!0}}function IN(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return _w(e,o=>{let a=o;Ov(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&EN(i,s),t}function EN(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];ww(i,s=>{e(s,r)})}}function Ov(n,e,t,r){if(n=qn(n),!n)return!1;let i=null,s=_x(n),o=!s&&Xi(n);if(!s&&!o){let c=n.ngModule;if(s=_x(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)Ov(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{_w(s.imports,d=>{Ov(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&EN(l,e)}if(!a){let l=co(i)||(()=>new i);e({provide:i,useFactory:l,deps:xr},i),e({provide:uN,useValue:i,multi:!0},i),e({provide:Ha,useValue:()=>ie(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;ww(c,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function ww(n,e){for(let t of n)iN(t)&&(t=t.\u0275providers),Array.isArray(t)?ww(t,e):e(t)}var A$=Be({provide:String,useValue:Be});function TN(n){return n!==null&&typeof n=="object"&&A$ in n}function R$(n){return!!(n&&n.useExisting)}function x$(n){return!!(n&&n.useFactory)}function Lv(n){return typeof n=="function"}var Ep=new de(""),Gf={},N$={},Ev;function Iw(){return Ev===void 0&&(Ev=new ep),Ev}var bn=class{},pu=class extends bn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Vv(e,o=>this.processProvider(o)),this.records.set(lN,Fa(void 0,this)),i.has("environment")&&this.records.set(bn,Fa(void 0,this));let s=this.records.get(Ep);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(uN,xr,ve.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Ne(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ne(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Yi(this),r=En(void 0),i;try{return e()}finally{Yi(t),En(r)}}get(e,t=hu,r=ve.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(vx))return e[vx](this);r=wp(r);let i,s=Yi(this),o=En(void 0);try{if(!(r&ve.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=F$(e)&&vp(e);l&&this.injectableDefInScope(l)?c=Fa(Fv(e),Gf):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ve.Self?Iw():this.parent;return t=r&ve.Optional&&t===hu?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Xf]=a[Xf]||[]).unshift(Tn(e)),s)throw a;return u$(a,e,"R3InjectorError",this.source)}else throw a}finally{En(o),Yi(s)}}resolveInjectorInitializers(){let e=Ne(null),t=Yi(this),r=En(void 0),i;try{let s=this.get(Ha,xr,ve.Self);for(let o of s)o()}finally{Yi(t),En(r),Ne(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Tn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new te(205,!1)}processProvider(e){e=qn(e);let t=Lv(e)?e:qn(e&&e.provide),r=M$(e);if(!Lv(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Fa(void 0,Gf,!0),i.factory=()=>Mv(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Ne(null);try{return t.value===Gf&&(t.value=N$,t.value=t.factory()),typeof t.value=="object"&&t.value&&L$(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ne(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=qn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Fv(n){let e=vp(n),t=e!==null?e.factory:co(n);if(t!==null)return t;if(n instanceof de)throw new te(204,!1);if(n instanceof Function)return P$(n);throw new te(204,!1)}function P$(n){if(n.length>0)throw new te(204,!1);let t=Qj(n);return t!==null?()=>t.factory(n):()=>new n}function M$(n){if(TN(n))return Fa(void 0,n.useValue);{let e=k$(n);return Fa(e,Gf)}}function k$(n,e,t){let r;if(Lv(n)){let i=qn(n);return co(i)||Fv(i)}else if(TN(n))r=()=>qn(n.useValue);else if(x$(n))r=()=>n.useFactory(...Mv(n.deps||[]));else if(R$(n))r=()=>ie(qn(n.useExisting));else{let i=qn(n&&(n.useClass||n.provide));if(O$(n))r=()=>new i(...Mv(n.deps));else return co(i)||Fv(i)}return r}function Fa(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function O$(n){return!!n.deps}function L$(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function F$(n){return typeof n=="function"||typeof n=="object"&&n instanceof de}function Vv(n,e){for(let t of n)Array.isArray(t)?Vv(t,e):t&&iN(t)?Vv(t.\u0275providers,e):e(t)}function Ti(n,e){n instanceof pu&&n.assertNotDestroyed();let t,r=Yi(n),i=En(void 0);try{return e()}finally{Yi(r),En(i)}}function bN(){return sN()!==void 0||a$()!=null}function V$(n){if(!bN())throw new te(-203,!1)}function U$(n){let e=ln.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function B$(n){return typeof n=="function"}var bi=0,be=1,le=2,Jt=3,cr=4,pr=5,tp=6,mu=7,ur=8,qa=9,dr=10,$t=11,gu=12,Cx=13,Ka=14,kr=15,Tp=16,Va=17,za=18,bp=19,CN=20,Ji=21,Tv=22,lo=23,Or=25,SN=1;var uo=7,np=8,rp=9,zn=10,Ew=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Ew||{});function oo(n){return Array.isArray(n)&&typeof n[SN]=="object"}function Ci(n){return Array.isArray(n)&&n[SN]===!0}function DN(n){return(n.flags&4)!==0}function Cp(n){return n.componentOffset>-1}function Tw(n){return(n.flags&1)===1}function bu(n){return!!n.template}function j$(n){return(n[le]&512)!==0}var Uv=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function AN(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function Cu(){return RN}function RN(n){return n.type.prototype.ngOnChanges&&(n.setInput=H$),$$}Cu.ngInherit=!0;function $$(){let n=NN(this),e=n?.current;if(e){let t=n.previous;if(t===fu)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function H$(n,e,t,r,i){let s=this.declaredInputs[r],o=NN(n)||q$(n,{previous:fu,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new Uv(l&&l.currentValue,t,c===fu),AN(n,e,i,t)}var xN="__ngSimpleChanges__";function NN(n){return n[xN]||null}function q$(n,e){return n[xN]=e}var Sx=null;var Nr=function(n,e,t){Sx?.(n,e,t)},z$="svg",G$="math",W$=!1;function K$(){return W$}function Lr(n){for(;Array.isArray(n);)n=n[bi];return n}function Q$(n,e){return Lr(e[n])}function Gn(n,e){return Lr(e[n.index])}function PN(n,e){return n.data[e]}function Y$(n,e){return n[e]}function es(n,e){let t=e[n];return oo(t)?t:t[bi]}function bw(n){return(n[le]&128)===128}function J$(n){return Ci(n[Jt])}function ip(n,e){return e==null?null:n[e]}function MN(n){n[Va]=0}function X$(n){n[le]&1024||(n[le]|=1024,bw(n)&&_u(n))}function Z$(n,e){for(;n>0;)e=e[Ka],n--;return e}function Cw(n){return!!(n[le]&9216||n[lo]?.dirty)}function Bv(n){n[dr].changeDetectionScheduler?.notify(1),Cw(n)?_u(n):n[le]&64&&(K$()?(n[le]|=1024,_u(n)):n[dr].changeDetectionScheduler?.notify())}function _u(n){n[dr].changeDetectionScheduler?.notify();let e=yu(n);for(;e!==null&&!(e[le]&8192||(e[le]|=8192,!bw(e)));)e=yu(e)}function kN(n,e){if((n[le]&256)===256)throw new te(911,!1);n[Ji]===null&&(n[Ji]=[]),n[Ji].push(e)}function eH(n,e){if(n[Ji]===null)return;let t=n[Ji].indexOf(e);t!==-1&&n[Ji].splice(t,1)}function yu(n){let e=n[Jt];return Ci(e)?e[Jt]:e}var Ee={lFrame:jN(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function tH(){return Ee.lFrame.elementDepthCount}function nH(){Ee.lFrame.elementDepthCount++}function rH(){Ee.lFrame.elementDepthCount--}function ON(){return Ee.bindingsEnabled}function iH(){return Ee.skipHydrationRootTNode!==null}function sH(n){return Ee.skipHydrationRootTNode===n}function oH(){Ee.skipHydrationRootTNode=null}function Ke(){return Ee.lFrame.lView}function Vr(){return Ee.lFrame.tView}function Ur(n){return Ee.lFrame.contextLView=n,n[ur]}function Br(n){return Ee.lFrame.contextLView=null,n}function Wn(){let n=LN();for(;n!==null&&n.type===64;)n=n.parent;return n}function LN(){return Ee.lFrame.currentTNode}function aH(){let n=Ee.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Su(n,e){let t=Ee.lFrame;t.currentTNode=n,t.isParent=e}function FN(){return Ee.lFrame.isParent}function cH(){Ee.lFrame.isParent=!1}function lH(){let n=Ee.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function uH(){return Ee.lFrame.bindingIndex}function dH(n){return Ee.lFrame.bindingIndex=n}function Sw(){return Ee.lFrame.bindingIndex++}function hH(n){let e=Ee.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function fH(){return Ee.lFrame.inI18n}function pH(n,e){let t=Ee.lFrame;t.bindingIndex=t.bindingRootIndex=n,jv(e)}function mH(){return Ee.lFrame.currentDirectiveIndex}function jv(n){Ee.lFrame.currentDirectiveIndex=n}function VN(n){Ee.lFrame.currentQueryIndex=n}function gH(n){let e=n[be];return e.type===2?e.declTNode:e.type===1?n[pr]:null}function UN(n,e,t){if(t&ve.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&ve.Host);)if(i=gH(s),i===null||(s=s[Ka],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=Ee.lFrame=BN();return r.currentTNode=e,r.lView=n,!0}function Dw(n){let e=BN(),t=n[be];Ee.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function BN(){let n=Ee.lFrame,e=n===null?null:n.child;return e===null?jN(n):e}function jN(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function $N(){let n=Ee.lFrame;return Ee.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var HN=$N;function Aw(){let n=$N();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function _H(n){return(Ee.lFrame.contextLView=Z$(n,Ee.lFrame.contextLView))[ur]}function Sp(){return Ee.lFrame.selectedIndex}function ho(n){Ee.lFrame.selectedIndex=n}function Rw(){let n=Ee.lFrame;return PN(n.tView,n.selectedIndex)}function yH(){return Ee.lFrame.currentNamespace}var qN=!0;function xw(){return qN}function Nw(n){qN=n}function vH(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=RN(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function Pw(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Wf(n,e,t){zN(n,e,3,t)}function Kf(n,e,t,r){(n[le]&3)===t&&zN(n,e,t,r)}function bv(n,e){let t=n[le];(t&3)===e&&(t&=16383,t+=1,n[le]=t)}function zN(n,e,t,r){let i=r!==void 0?n[Va]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Va]+=65536),(a<s||s==-1)&&(wH(n,t,e,c),n[Va]=(n[Va]&4294901760)+c+2),c++}function Dx(n,e){Nr(4,n,e);let t=Ne(null);try{e.call(n)}finally{Ne(t),Nr(5,n,e)}}function wH(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[le]>>14<n[Va]>>16&&(n[le]&3)===e&&(n[le]+=16384,Dx(a,s)):Dx(a,s)}var $a=-1,vu=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function IH(n){return n instanceof vu}function EH(n){return(n.flags&8)!==0}function TH(n){return(n.flags&16)!==0}function GN(n){return n!==$a}function sp(n){return n&32767}function bH(n){return n>>16}function op(n,e){let t=bH(n),r=e;for(;t>0;)r=r[Ka],t--;return r}var $v=!0;function ap(n){let e=$v;return $v=n,e}var CH=256,WN=CH-1,KN=5,SH=0,Pr={};function DH(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(uu)&&(r=t[uu]),r==null&&(r=t[uu]=SH++);let i=r&WN,s=1<<i;e.data[n+(i>>KN)]|=s}function QN(n,e){let t=YN(n,e);if(t!==-1)return t;let r=e[be];r.firstCreatePass&&(n.injectorIndex=e.length,Cv(r.data,n),Cv(e,null),Cv(r.blueprint,null));let i=Mw(n,e),s=n.injectorIndex;if(GN(i)){let o=sp(i),a=op(i,e),c=a[be].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function Cv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function YN(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Mw(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=tP(i),r===null)return $a;if(t++,i=i[Ka],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return $a}function AH(n,e,t){DH(n,e,t)}function RH(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(hN(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function JN(n,e,t){if(t&ve.Optional||n!==void 0)return n;mw(e,"NodeInjector")}function XN(n,e,t,r){if(t&ve.Optional&&r===void 0&&(r=null),!(t&(ve.Self|ve.Host))){let i=n[qa],s=En(void 0);try{return i?i.get(e,r,t&ve.Optional):oN(e,r,t&ve.Optional)}finally{En(s)}}return JN(r,e,t)}function ZN(n,e,t,r=ve.Default,i){if(n!==null){if(e[le]&2048&&!(r&ve.Self)){let o=kH(n,e,t,r,Pr);if(o!==Pr)return o}let s=eP(n,e,t,r,Pr);if(s!==Pr)return s}return XN(e,t,r,i)}function eP(n,e,t,r,i){let s=PH(t);if(typeof s=="function"){if(!UN(e,n,r))return r&ve.Host?JN(i,t,r):XN(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&ve.Optional))mw(t);else return o}finally{HN()}}else if(typeof s=="number"){let o=null,a=YN(n,e),c=$a,l=r&ve.Host?e[kr][pr]:null;for((a===-1||r&ve.SkipSelf)&&(c=a===-1?Mw(n,e):e[a+8],c===$a||!Rx(r,!1)?a=-1:(o=e[be],a=sp(c),e=op(c,e)));a!==-1;){let d=e[be];if(Ax(s,a,d.data)){let h=xH(a,e,t,o,r,l);if(h!==Pr)return h}c=e[a+8],c!==$a&&Rx(r,e[be].data[a+8]===l)&&Ax(s,a,e)?(o=d,a=sp(c),e=op(c,e)):a=-1}}return i}function xH(n,e,t,r,i,s){let o=e[be],a=o.data[n+8],c=r==null?Cp(a)&&$v:r!=o&&(a.type&3)!==0,l=i&ve.Host&&s===a,d=NH(a,o,t,c,l);return d!==null?wu(e,o,d,a):Pr}function NH(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,d=s>>20,h=r?a:a+d,p=i?a+d:l;for(let _=h;_<p;_++){let w=o[_];if(_<c&&t===w||_>=c&&w.type===t)return _}if(i){let _=o[c];if(_&&bu(_)&&_.type===t)return c}return null}function wu(n,e,t,r){let i=n[t],s=e.data;if(IH(i)){let o=i;o.resolving&&n$(t$(s[t]));let a=ap(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?En(o.injectImpl):null,d=UN(n,r,ve.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&vH(t,s[t],e)}finally{l!==null&&En(l),ap(a),o.resolving=!1,HN()}}return i}function PH(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(uu)?n[uu]:void 0;return typeof e=="number"?e>=0?e&WN:MH:e}function Ax(n,e,t){let r=1<<n;return!!(t[e+(n>>KN)]&r)}function Rx(n,e){return!(n&ve.Self)&&!(n&ve.Host&&e)}var ao=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return ZN(this._tNode,this._lView,e,wp(r),t)}};function MH(){return new ao(Wn(),Ke())}function kw(n){return Tu(()=>{let e=n.prototype.constructor,t=e[Jf]||Hv(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Jf]||Hv(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Hv(n){return eN(n)?()=>{let e=Hv(qn(n));return e&&e()}:co(n)}function kH(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[le]&2048&&!(o[le]&512);){let a=eP(s,o,t,r|ve.Self,Pr);if(a!==Pr)return a;let c=s.parent;if(!c){let l=o[CN];if(l){let d=l.get(t,Pr,r);if(d!==Pr)return d}c=tP(o),o=o[Ka]}s=c}return i}function tP(n){let e=n[be],t=e.type;return t===2?e.declTNode:t===1?n[pr]:null}function Ow(n){return RH(Wn(),n)}function xx(n,e=null,t=null,r){let i=nP(n,e,t,r);return i.resolveInjectorInitializers(),i}function nP(n,e=null,t=null,r,i=new Set){let s=[t||xr,D$(n)];return r=r||(typeof n=="object"?void 0:Tn(n)),new pu(s,e||Iw(),r||null,i)}var jr=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return xx({name:""},i,r,"");{let s=r.name??"";return xx({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=hu,e.NULL=new ep,e.\u0275prov=ne({token:e,providedIn:"any",factory:()=>ie(lN)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var OH="ngOriginalError";function Sv(n){return n[OH]}var Fr=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Sv(e);for(;t&&Sv(t);)t=Sv(t);return t||null}},rP=new de("",{providedIn:"root",factory:()=>W(Fr).handleError.bind(void 0)}),Lw=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=LH,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),qv=class extends Lw{constructor(e){super(),this._lView=e}onDestroy(e){return kN(this._lView,e),()=>eH(this._lView,e)}};function LH(){return new qv(Ke())}function FH(){return Dp(Wn(),Ke())}function Dp(n,e){return new Du(Gn(n,e))}var Du=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=FH;let n=e;return n})();var zv=class extends Yt{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,bN()&&(this.destroyRef=W(Lw,{optional:!0})??void 0)}emit(e){let t=Ne(null);try{super.next(e)}finally{Ne(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Dv(s),i&&(i=Dv(i)),o&&(o=Dv(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof xt&&e.add(a),a}};function Dv(n){return e=>{setTimeout(n,void 0,e)}}var cn=zv;function iP(n){return(n.flags&128)===128}var sP=new Map,VH=0;function UH(){return VH++}function BH(n){sP.set(n[bp],n)}function jH(n){sP.delete(n[bp])}var Nx="__ngContext__";function fo(n,e){oo(e)?(n[Nx]=e[bp],BH(e)):n[Nx]=e}function oP(n){return cP(n[gu])}function aP(n){return cP(n[cr])}function cP(n){for(;n!==null&&!Ci(n);)n=n[cr];return n}var Gv;function lP(n){Gv=n}function $H(){if(Gv!==void 0)return Gv;if(typeof document<"u")return document;throw new te(210,!1)}var Ap=new de("",{providedIn:"root",factory:()=>HH}),HH="ng",Fw=new de(""),ts=new de("",{providedIn:"platform",factory:()=>"unknown"});var Vw=new de("",{providedIn:"root",factory:()=>$H().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var qH="h",zH="b";var GH=()=>null;function Uw(n,e,t=!1){return GH(n,e,t)}var uP=!1,WH=new de("",{providedIn:"root",factory:()=>uP});var qf;function KH(){if(qf===void 0&&(qf=null,ln.trustedTypes))try{qf=ln.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return qf}function Px(n){return KH()?.createScriptURL(n)||n}var cp=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Jx})`}};function Rp(n){return n instanceof cp?n.changingThisBreaksApplicationSecurity:n}function Bw(n,e){let t=QH(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Jx})`)}return t===e}function QH(n){return n instanceof cp&&n.getTypeName()||null}var YH=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function dP(n){return n=String(n),n.match(YH)?n:"unsafe:"+n}var xp=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(xp||{});function JH(n){let e=fP();return e?e.sanitize(xp.URL,n)||"":Bw(n,"URL")?Rp(n):dP(so(n))}function XH(n){let e=fP();if(e)return Px(e.sanitize(xp.RESOURCE_URL,n)||"");if(Bw(n,"ResourceURL"))return Px(Rp(n));throw new te(904,!1)}function ZH(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?XH:JH}function hP(n,e,t){return ZH(e,t)(n)}function fP(){let n=Ke();return n&&n[dr].sanitizer}function pP(n){return n instanceof Function?n():n}function eq(n){return(n??W(jr)).get(ts)==="browser"}var go=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(go||{}),tq;function jw(n,e){return tq(n,e)}function Ua(n,e,t,r,i){if(r!=null){let s,o=!1;Ci(r)?s=r:oo(r)&&(o=!0,r=r[bi]);let a=Lr(r);n===0&&t!==null?i==null?vP(e,t,a):lp(e,t,a,i||null,!0):n===1&&t!==null?lp(e,t,a,i||null,!0):n===2?yq(e,a,o):n===3&&e.destroyNode(a),s!=null&&wq(e,n,s,t,i)}}function nq(n,e){return n.createText(e)}function rq(n,e,t){n.setValue(e,t)}function mP(n,e,t){return n.createElement(e,t)}function iq(n,e){gP(n,e),e[bi]=null,e[pr]=null}function sq(n,e,t,r,i,s){r[bi]=i,r[pr]=e,Np(n,r,t,1,i,s)}function gP(n,e){e[dr].changeDetectionScheduler?.notify(1),Np(n,e,e[$t],2,null,null)}function oq(n){let e=n[gu];if(!e)return Av(n[be],n);for(;e;){let t=null;if(oo(e))t=e[gu];else{let r=e[zn];r&&(t=r)}if(!t){for(;e&&!e[cr]&&e!==n;)oo(e)&&Av(e[be],e),e=e[Jt];e===null&&(e=n),oo(e)&&Av(e[be],e),t=e&&e[cr]}e=t}}function aq(n,e,t,r){let i=zn+r,s=t.length;r>0&&(t[i-1][cr]=e),r<s-zn?(e[cr]=t[i],cN(t,zn+r,e)):(t.push(e),e[cr]=null),e[Jt]=t;let o=e[Tp];o!==null&&t!==o&&cq(o,e);let a=e[za];a!==null&&a.insertView(n),Bv(e),e[le]|=128}function cq(n,e){let t=n[rp],i=e[Jt][Jt][kr];e[kr]!==i&&(n[le]|=Ew.HasTransplantedViews),t===null?n[rp]=[e]:t.push(e)}function _P(n,e){let t=n[rp],r=t.indexOf(e);t.splice(r,1)}function Wv(n,e){if(n.length<=zn)return;let t=zn+e,r=n[t];if(r){let i=r[Tp];i!==null&&i!==n&&_P(i,r),e>0&&(n[t-1][cr]=r[cr]);let s=Zf(n,zn+e);iq(r[be],r);let o=s[za];o!==null&&o.detachView(s[be]),r[Jt]=null,r[cr]=null,r[le]&=-129}return r}function yP(n,e){if(!(e[le]&256)){let t=e[$t];t.destroyNode&&Np(n,e,t,3,null,null),oq(e)}}function Av(n,e){if(e[le]&256)return;let t=Ne(null);try{e[le]&=-129,e[le]|=256,e[lo]&&UR(e[lo]),uq(n,e),lq(n,e),e[be].type===1&&e[$t].destroy();let r=e[Tp];if(r!==null&&Ci(e[Jt])){r!==e[Jt]&&_P(r,e);let i=e[za];i!==null&&i.detachView(n)}jH(e)}finally{Ne(t)}}function lq(n,e){let t=n.cleanup,r=e[mu];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[mu]=null);let i=e[Ji];if(i!==null){e[Ji]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function uq(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof vu)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Nr(4,a,c);try{c.call(a)}finally{Nr(5,a,c)}}else{Nr(4,i,s);try{s.call(i)}finally{Nr(5,i,s)}}}}}function dq(n,e,t){return hq(n,e.parent,t)}function hq(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[bi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===Mr.None||s===Mr.Emulated)return null}return Gn(r,t)}}function lp(n,e,t,r,i){n.insertBefore(e,t,r,i)}function vP(n,e,t){n.appendChild(e,t)}function Mx(n,e,t,r,i){r!==null?lp(n,e,t,r,i):vP(n,e,t)}function fq(n,e,t,r){n.removeChild(e,t,r)}function $w(n,e){return n.parentNode(e)}function pq(n,e){return n.nextSibling(e)}function mq(n,e,t){return _q(n,e,t)}function gq(n,e,t){return n.type&40?Gn(n,t):null}var _q=gq,kx;function Hw(n,e,t,r){let i=dq(n,r,e),s=e[$t],o=r.parent||e[pr],a=mq(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)Mx(s,i,t[c],a,!1);else Mx(s,i,t,a,!1);kx!==void 0&&kx(s,r,e,t,i)}function Qf(n,e){if(e!==null){let t=e.type;if(t&3)return Gn(e,n);if(t&4)return Kv(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Qf(n,r);{let i=n[e.index];return Ci(i)?Kv(-1,i):Lr(i)}}else{if(t&32)return jw(e,n)()||Lr(n[e.index]);{let r=wP(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=yu(n[kr]);return Qf(i,r)}else return Qf(n,e.next)}}}return null}function wP(n,e){if(e!==null){let r=n[kr][pr],i=e.projection;return r.projection[i]}return null}function Kv(n,e){let t=zn+n+1;if(t<e.length){let r=e[t],i=r[be].firstChild;if(i!==null)return Qf(r,i)}return e[uo]}function yq(n,e,t){let r=$w(n,e);r&&fq(n,r,e,t)}function qw(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&e===0&&(a&&fo(Lr(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)qw(n,e,t.child,r,i,s,!1),Ua(e,n,i,a,s);else if(c&32){let l=jw(t,r),d;for(;d=l();)Ua(e,n,i,d,s);Ua(e,n,i,a,s)}else c&16?vq(n,e,r,t,i,s):Ua(e,n,i,a,s);t=o?t.projectionNext:t.next}}function Np(n,e,t,r,i,s){qw(t,r,n.firstChild,e,i,s,!1)}function vq(n,e,t,r,i,s){let o=t[kr],c=o[pr].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];Ua(e,n,i,d,s)}else{let l=c,d=o[Jt];iP(r)&&(l.flags|=128),qw(n,e,l,d,i,s,!0)}}function wq(n,e,t,r,i){let s=t[uo],o=Lr(t);s!==o&&Ua(e,n,r,s,i);for(let a=zn;a<t.length;a++){let c=t[a];Np(c[be],c,n,e,r,s)}}function Iq(n,e,t){n.setAttribute(e,"style",t)}function IP(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function EP(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&kv(n,e,r),i!==null&&IP(n,e,i),s!==null&&Iq(n,e,s)}var ns={};function Ht(n=1){TP(Vr(),Ke(),Sp()+n,!1)}function TP(n,e,t,r){if(!r)if((e[le]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Wf(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Kf(e,s,0,t)}ho(t)}function we(n,e=ve.Default){let t=Ke();if(t===null)return ie(n,e);let r=Wn();return ZN(r,t,qn(n),e)}function bP(){let n="invalid";throw new Error(n)}function CP(n,e,t,r,i,s){let o=Ne(null);try{let a=null;i&lr.SignalBased&&(a=e[r][OR]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&lr.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):AN(e,a,r,s)}finally{Ne(o)}}function Eq(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)ho(~i);else{let s=i,o=t[++r],a=t[++r];pH(o,s);let c=e[s];a(2,c)}}}finally{ho(-1)}}function Pp(n,e,t,r,i,s,o,a,c,l,d){let h=e.blueprint.slice();return h[bi]=i,h[le]=r|4|128|8|64,(l!==null||n&&n[le]&2048)&&(h[le]|=2048),MN(h),h[Jt]=h[Ka]=n,h[ur]=t,h[dr]=o||n&&n[dr],h[$t]=a||n&&n[$t],h[qa]=c||n&&n[qa]||null,h[pr]=s,h[bp]=UH(),h[tp]=d,h[CN]=l,h[kr]=e.type==2?n[kr]:h,h}function Mp(n,e,t,r,i){let s=n.data[e];if(s===null)s=Tq(n,e,t,r,i),fH()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=aH();s.injectorIndex=o===null?-1:o.injectorIndex}return Su(s,!0),s}function Tq(n,e,t,r,i){let s=LN(),o=FN(),a=o?s:s&&s.parent,c=n.data[e]=Aq(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function SP(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function DP(n,e,t,r,i){let s=Sp(),o=r&2;try{ho(-1),o&&e.length>Or&&TP(n,e,Or,!1),Nr(o?2:0,i),t(r,i)}finally{ho(s),Nr(o?3:1,i)}}function AP(n,e,t){if(DN(e)){let r=Ne(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Ne(r)}}}function RP(n,e,t){ON()&&(kq(n,e,t,Gn(t,e)),(t.flags&64)===64&&OP(n,e,t))}function xP(n,e,t=Gn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function NP(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=zw(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function zw(n,e,t,r,i,s,o,a,c,l,d){let h=Or+r,p=h+i,_=bq(h,p),w=typeof l=="function"?l():l;return _[be]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:d}}function bq(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:ns);return t}function Cq(n,e,t,r){let s=r.get(WH,uP)||t===Mr.ShadowDom,o=n.selectRootElement(e,s);return Sq(o),o}function Sq(n){Dq(n)}var Dq=()=>null;function Aq(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return iH()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Ox(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=lr.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?Lx(r,t,l,a,c):Lx(r,t,l,a)}return r}function Lx(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function Rq(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,l=null;for(let d=r;d<i;d++){let h=s[d],p=t?t.get(h):null,_=p?p.inputs:null,w=p?p.outputs:null;c=Ox(0,h.inputs,d,c,_),l=Ox(1,h.outputs,d,l,w);let b=c!==null&&o!==null&&!vw(e)?zq(c,d,o):null;a.push(b)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function xq(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function PP(n,e,t,r,i,s,o,a){let c=Gn(e,t),l=e.inputs,d;!a&&l!=null&&(d=l[r])?(Gw(n,t,d,r,i),Cp(e)&&Nq(t,e.index)):e.type&3?(r=xq(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function Nq(n,e){let t=es(e,n);t[le]&16||(t[le]|=64)}function MP(n,e,t,r){if(ON()){let i=r===null?null:{"":-1},s=Lq(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&kP(n,e,t,o,i,a),i&&Fq(t,r,i)}t.mergedAttrs=yw(t.mergedAttrs,t.attrs)}function kP(n,e,t,r,i,s){for(let l=0;l<r.length;l++)AH(QN(t,e),n,r[l].type);Uq(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=SP(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=yw(t.mergedAttrs,d.hostAttrs),Bq(n,t,e,c,d),Vq(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}Rq(n,t,s)}function Pq(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;Mq(o)!=a&&o.push(a),o.push(t,r,s)}}function Mq(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function kq(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;Cp(t)&&jq(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||QN(t,e),fo(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],l=wu(e,n,a,t);if(fo(l,e),o!==null&&qq(e,a-i,l,c,t,o),bu(c)){let d=es(t.index,e);d[ur]=wu(e,n,a,t)}}}function OP(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=mH();try{ho(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];jv(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&Oq(c,l)}}finally{ho(-1),jv(o)}}function Oq(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function Lq(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(y$(e,o.selectors,!1))if(r||(r=[]),bu(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;Qv(n,e,c)}else r.unshift(o),Qv(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function Qv(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function Fq(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new te(-301,!1);r.push(e[i],s)}}}function Vq(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;bu(e)&&(t[""]=n)}}function Uq(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function Bq(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=co(i.type,!0)),o=new vu(s,bu(i),we);n.blueprint[r]=o,t[r]=o,Pq(n,e,r,SP(n,t,i.hostVars,ns),i)}function jq(n,e,t){let r=Gn(e,n),i=NP(t),s=n[dr].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=kp(n,Pp(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function $q(n,e,t,r,i,s){let o=Gn(n,e);Hq(e[$t],o,s,n.value,t,r,i)}function Hq(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?so(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function qq(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],d=o[a++],h=o[a++];CP(r,t,c,l,d,h)}}function zq(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function LP(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function FP(n,e){let t=n.contentQueries;if(t!==null){let r=Ne(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];VN(s),a.contentQueries(2,e[o],o)}}}finally{Ne(r)}}}function kp(n,e){return n[gu]?n[Cx][cr]=e:n[gu]=e,n[Cx]=e,e}function Yv(n,e,t){VN(0);let r=Ne(null);try{e(n,t)}finally{Ne(r)}}function Gq(n){return n[mu]||(n[mu]=[])}function Wq(n){return n.cleanup||(n.cleanup=[])}function VP(n,e){let t=n[qa],r=t?t.get(Fr,null):null;r&&r.handleError(e)}function Gw(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],d=n.data[o];CP(d,l,r,a,c,i)}}function UP(n,e,t){let r=Q$(e,n);rq(n[$t],r,t)}function Kq(n,e){let t=es(e,n),r=t[be];Qq(r,t);let i=t[bi];i!==null&&t[tp]===null&&(t[tp]=Uw(i,t[qa])),Ww(r,t,t[ur])}function Qq(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function Ww(n,e,t){Dw(e);try{let r=n.viewQuery;r!==null&&Yv(1,r,t);let i=n.template;i!==null&&DP(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[za]?.finishViewCreation(n),n.staticContentQueries&&FP(n,e),n.staticViewQueries&&Yv(2,n.viewQuery,t);let s=n.components;s!==null&&Yq(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[le]&=-5,Aw()}}function Yq(n,e){for(let t=0;t<e.length;t++)Kq(n,e[t])}function Jq(n,e,t,r){let i=Ne(null);try{let s=e.tView,a=n[le]&4096?4096:16,c=Pp(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[Tp]=l;let d=n[za];return d!==null&&(c[za]=d.createEmbeddedView(s)),Ww(s,c,t),c}finally{Ne(i)}}function Fx(n,e){return!e||e.firstChild===null||iP(n)}function Xq(n,e,t,r=!0){let i=e[be];if(aq(i,e,n,t),r){let o=Kv(t,n),a=e[$t],c=$w(a,n[uo]);c!==null&&sq(i,n[pr],a,e,c,o)}let s=e[tp];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function up(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(Lr(s)),Ci(s)&&Zq(s,r);let o=t.type;if(o&8)up(n,e,t.child,r);else if(o&32){let a=jw(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=wP(e,t);if(Array.isArray(a))r.push(...a);else{let c=yu(e[kr]);up(c[be],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function Zq(n,e){for(let t=zn;t<n.length;t++){let r=n[t],i=r[be].firstChild;i!==null&&up(r[be],r,i,e)}n[uo]!==n[bi]&&e.push(n[uo])}var BP=[];function e4(n){return n[lo]??t4(n)}function t4(n){let e=BP.pop()??Object.create(r4);return e.lView=n,e}function n4(n){n.lView[lo]!==n&&(n.lView=null,BP.push(n))}var r4=ot(K({},LR),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{_u(n.lView)},consumerOnSignalRead(){this.lView[lo]=this}}),jP=100;function $P(n,e=!0,t=0){let r=n[dr],i=r.rendererFactory,s=!1;s||i.begin?.();try{i4(n,t)}catch(o){throw e&&VP(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function i4(n,e){Jv(n,e);let t=0;for(;Cw(n);){if(t===jP)throw new te(103,!1);t++,Jv(n,1)}}function s4(n,e,t,r){let i=e[le];if((i&256)===256)return;let s=!1;!s&&e[dr].inlineEffectRunner?.flush(),Dw(e);let o=null,a=null;!s&&o4(n)&&(a=e4(e),o=FR(a));try{MN(e),dH(n.bindingStartIndex),t!==null&&DP(n,e,t,2,r);let c=(i&3)===3;if(!s)if(c){let h=n.preOrderCheckHooks;h!==null&&Wf(e,h,null)}else{let h=n.preOrderHooks;h!==null&&Kf(e,h,0,null),bv(e,0)}if(a4(e),HP(e,0),n.contentQueries!==null&&FP(n,e),!s)if(c){let h=n.contentCheckHooks;h!==null&&Wf(e,h)}else{let h=n.contentHooks;h!==null&&Kf(e,h,1),bv(e,1)}Eq(n,e);let l=n.components;l!==null&&zP(e,l,0);let d=n.viewQuery;if(d!==null&&Yv(2,d,r),!s)if(c){let h=n.viewCheckHooks;h!==null&&Wf(e,h)}else{let h=n.viewHooks;h!==null&&Kf(e,h,2),bv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Tv]){for(let h of e[Tv])h();e[Tv]=null}s||(e[le]&=-73)}catch(c){throw _u(e),c}finally{a!==null&&(VR(a,o),n4(a)),Aw()}}function o4(n){return n.type!==2}function HP(n,e){for(let t=oP(n);t!==null;t=aP(t))for(let r=zn;r<t.length;r++){let i=t[r];qP(i,e)}}function a4(n){for(let e=oP(n);e!==null;e=aP(e)){if(!(e[le]&Ew.HasTransplantedViews))continue;let t=e[rp];for(let r=0;r<t.length;r++){let i=t[r],s=i[Jt];X$(i)}}}function c4(n,e,t){let r=es(e,n);qP(r,t)}function qP(n,e){bw(n)&&Jv(n,e)}function Jv(n,e){let r=n[be],i=n[le],s=n[lo],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&iv(s)),s&&(s.dirty=!1),n[le]&=-9217,o)s4(r,n,r.template,n[ur]);else if(i&8192){HP(n,1);let a=r.components;a!==null&&zP(n,a,1)}}function zP(n,e,t){for(let r=0;r<e.length;r++)c4(n,e[r],t)}function Kw(n){for(n[dr].changeDetectionScheduler?.notify();n;){n[le]|=64;let e=yu(n);if(j$(n)&&!e)return n;n=e}return null}var po=class{get rootNodes(){let e=this._lView,t=e[be];return up(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[ur]}set context(e){this._lView[ur]=e}get destroyed(){return(this._lView[le]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Jt];if(Ci(e)){let t=e[np],r=t?t.indexOf(this):-1;r>-1&&(Wv(e,r),Zf(t,r))}this._attachedToViewContainer=!1}yP(this._lView[be],this._lView)}onDestroy(e){kN(this._lView,e)}markForCheck(){Kw(this._cdRefInjectingView||this._lView)}detach(){this._lView[le]&=-129}reattach(){Bv(this._lView),this._lView[le]|=128}detectChanges(){this._lView[le]|=1024,$P(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new te(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,gP(this._lView[be],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new te(902,!1);this._appRef=e,Bv(this._lView)}},Op=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=d4;let n=e;return n})(),l4=Op,u4=class extends l4{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=Jq(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new po(i)}};function d4(){return h4(Wn(),Ke())}function h4(n,e){return n.type&4?new u4(e,n,Dp(n,e)):null}var kie=new RegExp(`^(\\d+)*(${zH}|${qH})*(.*)`);var f4=()=>null;function Vx(n,e){return f4(n,e)}var dp=class{},Xv=class{},hp=class{};function p4(n){let e=Error(`No component factory found for ${Tn(n)}.`);return e[m4]=n,e}var m4="ngComponent";var Zv=class{resolveComponentFactory(e){throw p4(e)}},Lp=(()=>{let e=class e{};e.NULL=new Zv;let n=e;return n})(),Iu=class{},Fp=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>g4();let n=e;return n})();function g4(){let n=Ke(),e=Wn(),t=es(e.index,n);return(oo(t)?t:n)[$t]}var _4=(()=>{let e=class e{};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),Rv={};var Ux=new Set;function Qw(n){Ux.has(n)||(Ux.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function Bx(...n){}function y4(){let n=typeof ln.requestAnimationFrame=="function",e=ln[n?"requestAnimationFrame":"setTimeout"],t=ln[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var qe=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new cn(!1),this.onMicrotaskEmpty=new cn(!1),this.onStable=new cn(!1),this.onError=new cn(!1),typeof Zone>"u")throw new te(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=y4().nativeRequestAnimationFrame,I4(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new te(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new te(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,v4,Bx,Bx);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},v4={};function Yw(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function w4(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ln,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,ew(n),n.isCheckStableRunning=!0,Yw(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),ew(n))}function I4(n){let e=()=>{w4(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(E4(a))return t.invokeTask(i,s,o,a);try{return jx(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),$x(n)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return jx(n),t.invoke(i,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),$x(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,ew(n),Yw(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function ew(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function jx(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function $x(n){n._nesting--,Yw(n)}var tw=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new cn,this.onMicrotaskEmpty=new cn,this.onStable=new cn,this.onError=new cn}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function E4(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}function T4(n="zone.js",e){return n==="noop"?new tw:n==="zone.js"?new qe(e):n}var Ba=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Ba||{}),b4={destroy(){}};function Vp(n,e){!e&&V$(Vp);let t=e?.injector??W(jr);if(!eq(t))return b4;Qw("NgAfterNextRender");let r=t.get(Jw),i=r.handler??=new rw,s=e?.phase??Ba.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(Lw).onDestroy(o),c=Ti(t,()=>new nw(s,()=>{o(),n()}));return i.register(c),{destroy:o}}var nw=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=W(qe),this.errorHandler=W(Fr,{optional:!0}),W(dp,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},rw=class{constructor(){this.executingCallbacks=!1,this.buckets={[Ba.EarlyRead]:new Set,[Ba.Write]:new Set,[Ba.MixedReadWrite]:new Set,[Ba.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},Jw=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function iw(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=mx(i,a);else if(s==2){let c=a,l=e[++o];r=mx(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var fp=class extends Lp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Xi(e);return new Ga(t,this.ngModule)}};function Hx(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function C4(n){let e=n.toLowerCase();return e==="svg"?z$:e==="math"?G$:null}var sw=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=wp(r);let i=this.injector.get(e,Rv,r);return i!==Rv||t===Rv?i:this.parentInjector.get(e,t,r)}},Ga=class extends hp{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=Hx(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return Hx(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=E$(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Ne(null);try{i=i||this.ngModule;let o=i instanceof bn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new sw(e,o):e,c=a.get(Iu,null);if(c===null)throw new te(407,!1);let l=a.get(_4,null),d=a.get(Jw,null),h=a.get(dp,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},_=c.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",b=r?Cq(_,r,this.componentDef.encapsulation,a):mP(_,w,C4(w)),S=512;this.componentDef.signals?S|=4096:this.componentDef.onPush||(S|=16);let O=null;b!==null&&(O=Uw(b,a,!0));let H=zw(0,null,null,1,0,null,null,null,null,null,null),V=Pp(null,H,null,S,null,null,p,_,a,null,O);Dw(V);let Q,ae;try{let J=this.componentDef,T,v=null;J.findHostDirectiveDefs?(T=[],v=new Map,J.findHostDirectiveDefs(J,T,v),T.push(J)):T=[J];let I=S4(V,b),C=D4(I,b,J,T,V,p,_);ae=PN(H,Or),b&&x4(_,J,b,r),t!==void 0&&N4(ae,this.ngContentSelectors,t),Q=R4(C,J,T,v,V,[P4]),Ww(H,V,null)}finally{Aw()}return new ow(this.componentType,Q,Dp(ae,V),V,ae)}finally{Ne(s)}}},ow=class extends Xv{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new po(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;Gw(s[be],s,i,e,t),this.previousInputValues.set(e,t);let o=es(this._tNode.index,s);Kw(o)}}get injector(){return new ao(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function S4(n,e){let t=n[be],r=Or;return n[r]=e,Mp(t,r,2,"#host",null)}function D4(n,e,t,r,i,s,o){let a=i[be];A4(r,n,e,o);let c=null;e!==null&&(c=Uw(e,i[qa]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=Pp(i,NP(t),null,d,i[n.index],n,s,l,null,null,c);return a.firstCreatePass&&Qv(a,n,r.length-1),kp(i,h),i[n.index]=h}function A4(n,e,t,r){for(let i of n)e.mergedAttrs=yw(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(iw(e,e.mergedAttrs,!0),t!==null&&EP(r,t,e))}function R4(n,e,t,r,i,s){let o=Wn(),a=i[be],c=Gn(o,i);kP(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,p=wu(i,a,h,o);fo(p,i)}OP(a,i,o),c&&fo(c,i);let l=wu(i,a,o.directiveStart+o.componentOffset,o);if(n[ur]=i[ur]=l,s!==null)for(let d of s)d(l,e);return AP(a,o,i),l}function x4(n,e,t,r){if(r)kv(n,t,["ng-version","17.3.11"]);else{let{attrs:i,classes:s}=T$(e.selectors[0]);i&&kv(n,t,i),s&&s.length>0&&IP(n,t,s.join(" "))}}function N4(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function P4(){let n=Wn();Pw(Ke()[be],n)}var Qa=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=M4;let n=e;return n})();function M4(){let n=Wn();return O4(n,Ke())}var k4=Qa,GP=class extends k4{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Dp(this._hostTNode,this._hostLView)}get injector(){return new ao(this._hostTNode,this._hostLView)}get parentInjector(){let e=Mw(this._hostTNode,this._hostLView);if(GN(e)){let t=op(e,this._hostLView),r=sp(e),i=t[be].data[r+8];return new ao(i,t)}else return new ao(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=qx(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-zn}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Vx(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,Fx(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!B$(e),a;if(o)a=t;else{let w=t||{};a=w.index,r=w.injector,i=w.projectableNodes,s=w.environmentInjector||w.ngModuleRef}let c=o?e:new Ga(Xi(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let b=(o?l:this.parentInjector).get(bn,null);b&&(s=b)}let d=Xi(c.componentType??{}),h=Vx(this._lContainer,d?.id??null),p=h?.firstChild??null,_=c.create(l,i,p,s);return this.insertImpl(_.hostView,a,Fx(this._hostTNode,h)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(J$(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Jt],l=new GP(c,c[pr],c[Jt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return Xq(o,i,s,r),e.attachToViewContainerRef(),cN(xv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=qx(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Wv(this._lContainer,t);r&&(Zf(xv(this._lContainer),t),yP(r[be],r))}detach(e){let t=this._adjustIndex(e,-1),r=Wv(this._lContainer,t);return r&&Zf(xv(this._lContainer),t)!=null?new po(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function qx(n){return n[np]}function xv(n){return n[np]||(n[np]=[])}function O4(n,e){let t,r=e[n.index];return Ci(r)?t=r:(t=LP(r,e,null,n),e[n.index]=t,kp(e,t)),F4(t,e,n,r),new GP(t,n,e)}function L4(n,e){let t=n[$t],r=t.createComment(""),i=Gn(e,n),s=$w(t,i);return lp(t,s,r,pq(t,i),!1),r}var F4=B4,V4=()=>!1;function U4(n,e,t){return V4(n,e,t)}function B4(n,e,t,r){if(n[uo])return;let i;t.type&8?i=Lr(r):i=L4(e,t),n[uo]=i}function j4(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(z4))}return s}return pp.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,d=i.styleUrls;i.styleUrls.forEach((h,p)=>{a.push(""),o.push(r(h).then(_=>{a[l+p]=_,d.splice(d.indexOf(h),1),d.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>G4(s));e.push(c)}),H4(),Promise.all(e).then(()=>{})}var pp=new Map,$4=new Set;function H4(){let n=pp;return pp=new Map,n}function q4(){return pp.size===0}function z4(n){return typeof n=="string"?n:n.text()}function G4(n){$4.delete(n)}function Xw(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var Zi=class{},Eu=class{};var mp=class extends Zi{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new fp(this);let i=yN(e);this._bootstrapComponents=pP(i.bootstrap),this._r3Injector=nP(e,t,[{provide:Zi,useValue:this},{provide:Lp,useValue:this.componentFactoryResolver},...r],Tn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},gp=class extends Eu{constructor(e){super(),this.moduleType=e}create(e){return new mp(this.moduleType,e,[])}};function W4(n,e,t){return new mp(n,e,t)}var aw=class extends Zi{constructor(e){super(),this.componentFactoryResolver=new fp(this),this.instance=null;let t=new pu([...e.providers,{provide:Zi,useValue:this},{provide:Lp,useValue:this.componentFactoryResolver}],e.parent||Iw(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Up(n,e,t=null){return new aw({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var Bp=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Xe(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function WP(n){return Q4(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function K4(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function Q4(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Y4(n,e,t){return n[e]=t}function mo(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function J4(n,e,t,r){let i=mo(n,e,t);return mo(n,e+1,r)||i}function X4(n,e,t,r,i){let s=J4(n,e,t,r);return mo(n,e+2,i)||s}function Z4(n){return(n.flags&32)===32}function ez(n,e,t,r,i,s,o,a,c){let l=e.consts,d=Mp(e,n,4,o||null,ip(l,a));MP(e,t,d,ip(l,c)),Pw(e,d);let h=d.tView=zw(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}function $r(n,e,t,r,i,s,o,a){let c=Ke(),l=Vr(),d=n+Or,h=l.firstCreatePass?ez(d,l,c,e,t,r,i,s,o):l.data[d];Su(h,!1);let p=tz(l,c,h,n);xw()&&Hw(l,c,p,h),fo(p,c);let _=LP(p,c,p,h);return c[d]=_,kp(c,_),U4(_,h,c),Tw(h)&&RP(l,c,h),o!=null&&xP(c,h,a),$r}var tz=nz;function nz(n,e,t,r){return Nw(!0),e[$t].createComment("")}function Zw(n,e,t,r){let i=Ke(),s=Sw();if(mo(i,s,e)){let o=Vr(),a=Rw();$q(a,i,n,e,t,r)}return Zw}function KP(n,e,t,r){return mo(n,Sw(),t)?e+so(t)+r:ns}function rz(n,e,t,r,i,s,o,a){let c=uH(),l=X4(n,c,t,i,o);return hH(3),l?e+so(t)+r+so(i)+s+so(o)+a:ns}function mr(n,e,t){let r=Ke(),i=Sw();if(mo(r,i,e)){let s=Vr(),o=Rw();PP(s,o,r,n,e,r[$t],t,!1)}return mr}function zx(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";Gw(n,t,s[o],o,r)}function iz(n,e,t,r,i,s){let o=e.consts,a=ip(o,i),c=Mp(e,n,2,r,a);return MP(e,t,c,ip(o,s)),c.attrs!==null&&iw(c,c.attrs,!1),c.mergedAttrs!==null&&iw(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function M(n,e,t,r){let i=Ke(),s=Vr(),o=Or+n,a=i[$t],c=s.firstCreatePass?iz(o,s,i,e,t,r):s.data[o],l=sz(s,i,c,a,e,n);i[o]=l;let d=Tw(c);return Su(c,!0),EP(a,l,c),!Z4(c)&&xw()&&Hw(s,i,l,c),tH()===0&&fo(l,i),nH(),d&&(RP(s,i,c),AP(s,c,i)),r!==null&&xP(i,c),M}function k(){let n=Wn();FN()?cH():(n=n.parent,Su(n,!1));let e=n;sH(e)&&oH(),rH();let t=Vr();return t.firstCreatePass&&(Pw(t,n),DN(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&EH(e)&&zx(t,e,Ke(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&TH(e)&&zx(t,e,Ke(),e.stylesWithoutHost,!1),k}function re(n,e,t,r){return M(n,e,t,r),k(),re}var sz=(n,e,t,r,i,s)=>(Nw(!0),mP(r,i,yH()));function _o(){return Ke()}var _p="en-US";var oz=_p;function az(n){typeof n=="string"&&(oz=n.toLowerCase().replace(/_/g,"-"))}function oe(n,e,t,r){let i=Ke(),s=Vr(),o=Wn();return lz(s,i,i[$t],o,n,e,r),oe}function cz(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[mu],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function lz(n,e,t,r,i,s,o){let a=Tw(r),l=n.firstCreatePass&&Wq(n),d=e[ur],h=Gq(e),p=!0;if(r.type&3||o){let b=Gn(r,e),S=o?o(b):b,O=h.length,H=o?Q=>o(Lr(Q[r.index])):r.index,V=null;if(!o&&a&&(V=cz(n,e,i,r.index)),V!==null){let Q=V.__ngLastListenerFn__||V;Q.__ngNextListenerFn__=s,V.__ngLastListenerFn__=s,p=!1}else{s=Wx(r,e,d,s,!1);let Q=t.listen(S,i,s);h.push(s,Q),l&&l.push(i,H,O,O+1)}}else s=Wx(r,e,d,s,!1);let _=r.outputs,w;if(p&&_!==null&&(w=_[i])){let b=w.length;if(b)for(let S=0;S<b;S+=2){let O=w[S],H=w[S+1],ae=e[O][H].subscribe(s),J=h.length;h.push(s,ae),l&&l.push(i,r.index,J,-(J+1))}}}function Gx(n,e,t,r){let i=Ne(null);try{return Nr(6,e,t),t(r)!==!1}catch(s){return VP(n,s),!1}finally{Nr(7,e,t),Ne(i)}}function Wx(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?es(n.index,e):e;Kw(a);let c=Gx(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)c=Gx(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function gr(n=1){return _H(n)}function jp(n,e,t,r,i){let s=Ke(),o=KP(s,e,t,r);if(o!==ns){let a=Vr(),c=Rw();PP(a,c,s,n,o,s[$t],i,!1)}return jp}function uz(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function B(n,e=""){let t=Ke(),r=Vr(),i=n+Or,s=r.firstCreatePass?Mp(r,i,1,e,null):r.data[i],o=dz(r,t,s,e,n);t[i]=o,xw()&&Hw(r,t,o,s),Su(s,!1)}var dz=(n,e,t,r,i)=>(Nw(!0),nq(e[$t],r));function Ya(n){return $p("",n,""),Ya}function $p(n,e,t){let r=Ke(),i=KP(r,n,e,t);return i!==ns&&UP(r,Sp(),i),$p}function eI(n,e,t,r,i,s,o){let a=Ke(),c=rz(a,n,e,t,r,i,s,o);return c!==ns&&UP(a,Sp(),c),eI}var hz=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=IN(!1,r.type),s=i.length>0?Up([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=ne({token:e,providedIn:"environment",factory:()=>new e(ie(bn))});let n=e;return n})();function QP(n){Qw("NgStandalone"),n.getStandaloneInjector=e=>e.get(hz).getOrCreateStandaloneInjector(n)}function fz(n,e){let t=n[e];return t===ns?void 0:t}function pz(n,e,t,r,i,s){let o=e+t;return mo(n,o,i)?Y4(n,o+1,s?r.call(s,i):r(i)):fz(n,o+1)}function Hp(n,e){let t=Vr(),r,i=n+Or;t.firstCreatePass?(r=mz(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=co(r.type,!0)),o,a=En(we);try{let c=ap(!1),l=s();return ap(c),uz(t,Ke(),i,l),l}finally{En(a)}}function mz(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function qp(n,e,t){let r=n+Or,i=Ke(),s=Y$(i,r);return gz(i,r)?pz(i,lH(),e,s.transform,t,s):s.transform(t)}function gz(n,e){return n[be].data[e].pure}var zf=null;function _z(n){zf!==null&&(n.defaultEncapsulation!==zf.defaultEncapsulation||n.preserveWhitespaces!==zf.preserveWhitespaces)||(zf=n)}var zp=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var tI=new de(""),Au=new de(""),Gp=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,nI||(yz(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{qe.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(ie(qe),ie(Wp),ie(Au))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Wp=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return nI?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function yz(n){nI=n}var nI;function Ja(n){return!!n&&typeof n.then=="function"}function rI(n){return!!n&&typeof n.subscribe=="function"}var Kp=new de(""),YP=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=W(Kp,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Ja(o))r.push(o);else if(rI(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),iI=new de("");function vz(){BR(()=>{throw new te(600,!1)})}function wz(n){return n.isBoundToModule}function Iz(n,e,t){try{let r=t();return Ja(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function JP(n,e){return Array.isArray(e)?e.reduce(JP,n):K(K({},n),e)}var Xa=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=W(rP),this.afterRenderEffectManager=W(Jw),this.externalTestViews=new Set,this.beforeRender=new Yt,this.afterTick=new Yt,this.componentTypes=[],this.components=[],this.isStable=W(Bp).hasPendingTasks.pipe(Ae(r=>!r)),this._injector=W(bn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof hp;if(!this._injector.get(YP).done){let _=!s&&_N(r),w=!1;throw new te(405,w)}let a;s?a=r:a=this._injector.get(Lp).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=wz(a)?void 0:this._injector.get(Zi),l=i||a.selector,d=a.create(jr.NULL,[],l,c),h=d.location.nativeElement,p=d.injector.get(tI,null);return p?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),Yf(this.components,d),p?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new te(101,!1);let i=Ne(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Ne(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===jP)throw new te(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)Ez(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>cw(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>cw(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Yf(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(iI,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Yf(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new te(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Yf(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Ez(n,e,t){!e&&!cw(n)||Tz(n,t,e)}function cw(n){return Cw(n)}function Tz(n,e,t){let r;t?(r=0,n[le]|=1024):n[le]&64?r=0:r=1,$P(n,e,r)}var lw=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Qp=(()=>{let e=class e{compileModuleSync(r){return new gp(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=yN(r),o=pP(s.declarations).reduce((a,c)=>{let l=Xi(c);return l&&a.push(new Ga(l)),a},[]);return new lw(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),bz=new de("");function Cz(n,e,t){let r=new gp(t);return Promise.resolve(r)}function Kx(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var Sz=(()=>{let e=class e{constructor(){this.zone=W(qe),this.applicationRef=W(Xa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Dz(n){return[{provide:qe,useFactory:n},{provide:Ha,multi:!0,useFactory:()=>{let e=W(Sz,{optional:!0});return()=>e.initialize()}},{provide:Ha,multi:!0,useFactory:()=>{let e=W(xz);return()=>{e.initialize()}}},{provide:rP,useFactory:Az}]}function Az(){let n=W(qe),e=W(Fr);return t=>n.runOutsideAngular(()=>e.handleError(t))}function Rz(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var xz=(()=>{let e=class e{constructor(){this.subscription=new xt,this.initialized=!1,this.zone=W(qe),this.pendingTasks=W(Bp)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{qe.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{qe.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Nz(){return typeof $localize<"u"&&$localize.locale||_p}var sI=new de("",{providedIn:"root",factory:()=>W(sI,ve.Optional|ve.SkipSelf)||Nz()});var XP=new de(""),ZP=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=T4(i?.ngZone,Rz({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=W4(r.moduleType,this.injector,Dz(()=>s)),a=o.injector.get(Fr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{Yf(this._modules,o),c.unsubscribe()})}),Iz(a,s,()=>{let c=o.injector.get(YP);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(sI,_p);return az(l||_p),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=JP({},i);return Cz(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(Xa);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new te(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new te(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(XP,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(ie(jr))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),du=null,eM=new de("");function Pz(n){if(du&&!du.get(eM,!1))throw new te(400,!1);vz(),du=n;let e=n.get(ZP);return Oz(n),e}function oI(n,e,t=[]){let r=`Platform: ${e}`,i=new de(r);return(s=[])=>{let o=tM();if(!o||o.injector.get(eM,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):Pz(Mz(a,r))}return kz(i)}}function Mz(n=[],e){return jr.create({name:e,providers:[{provide:Ep,useValue:"platform"},{provide:XP,useValue:new Set([()=>du=null])},...n]})}function kz(n){let e=tM();if(!e)throw new te(401,!1);return e}function tM(){return du?.get(ZP)??null}function Oz(n){n.get(Fw,null)?.forEach(t=>t())}var Za=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Lz;let n=e;return n})();function Lz(n){return Fz(Wn(),Ke(),(n&16)===16)}function Fz(n,e,t){if(Cp(n)&&!t){let r=es(n.index,e);return new po(r,r)}else if(n.type&47){let r=e[kr];return new po(r,e)}return null}var uw=class{constructor(){}supports(e){return WP(e)}create(e){return new dw(e)}},Vz=(n,e)=>e,dw=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Vz}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<Qx(r,i,s)?t:r,a=Qx(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,d=c-i;if(l!=d){for(let p=0;p<l;p++){let _=p<s.length?s[p]:s[p]=0,w=_+p;d<=w&&w<l&&(s[p]=_+1)}let h=o.previousIndex;s[h]=d-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!WP(e))throw new te(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,K4(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new hw(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new yp),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new yp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},hw=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},fw=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},yp=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new fw,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function Qx(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function Yx(){return new aI([new uw])}var aI=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||Yx()),deps:[[e,new gw,new Ip]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new te(901,!1)}};e.\u0275prov=ne({token:e,providedIn:"root",factory:Yx});let n=e;return n})();var nM=oI(null,"core",[]),rM=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(ie(Xa))},e.\u0275mod=fr({type:e}),e.\u0275inj=hr({});let n=e;return n})();function Ru(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function cI(n){let e=Ne(null);try{return n()}finally{Ne(e)}}function iM(n){let e=Xi(n);if(!e)return null;let t=new Ga(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var uM=null;function yo(){return uM}function dM(n){uM??=n}var Yp=class{};var Cn=new de(""),mI=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(Uz),providedIn:"platform"});let n=e;return n})(),hM=new de(""),Uz=(()=>{let e=class e extends mI{constructor(){super(),this._doc=W(Cn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return yo().getBaseHref(this._doc)}onPopState(r){let i=yo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=yo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function gI(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function sM(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Si(n){return n&&n[0]!=="?"?"?"+n:n}var _r=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(_I),providedIn:"root"});let n=e;return n})(),fM=new de(""),_I=(()=>{let e=class e extends _r{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??W(Cn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return gI(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Si(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Si(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Si(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(ie(mI),ie(fM,8))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Xp=(()=>{let e=class e extends _r{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=gI(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Si(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Si(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(ie(mI),ie(fM,8))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),ec=(()=>{let e=class e{constructor(r){this._subject=new cn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=$z(sM(oM(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Si(i))}normalize(r){return e.stripTrailingSlash(jz(this._basePath,oM(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Si(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Si(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Si,e.joinWithSlash=gI,e.stripTrailingSlash=sM,e.\u0275fac=function(i){return new(i||e)(ie(_r))},e.\u0275prov=ne({token:e,factory:()=>Bz(),providedIn:"root"});let n=e;return n})();function Bz(){return new ec(ie(_r))}function jz(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function oM(n){return n.replace(/\/index.html$/,"")}function $z(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function pM(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var lI=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Zp=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new lI(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),aM(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);aM(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(we(Qa),we(Op),we(aI))},e.\u0275dir=Wa({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let n=e;return n})();function aM(n,e){n.context.$implicit=e.item}var tc=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new uI,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){cM("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){cM("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(we(Qa),we(Op))},e.\u0275dir=Wa({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let n=e;return n})(),uI=class{constructor(){this.$implicit=null,this.ngIf=null}};function cM(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${Tn(e)}'.`)}function Hz(n,e){return new te(2100,!1)}var dI=class{createSubscription(e,t){return cI(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){cI(()=>e.unsubscribe())}},hI=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},qz=new hI,zz=new dI,em=(()=>{let e=class e{constructor(r){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=r}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(r){if(!this._obj){if(r)try{this.markForCheckOnValueUpdate=!1,this._subscribe(r)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return r!==this._obj?(this._dispose(),this.transform(r)):this._latestValue}_subscribe(r){this._obj=r,this._strategy=this._selectStrategy(r),this._subscription=this._strategy.createSubscription(r,i=>this._updateLatestValue(r,i))}_selectStrategy(r){if(Ja(r))return qz;if(rI(r))return zz;throw Hz(e,r)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(r,i){r===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}};e.\u0275fac=function(i){return new(i||e)(we(Za,16))},e.\u0275pipe=pN({name:"async",type:e,pure:!1,standalone:!0});let n=e;return n})();var mM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=fr({type:e}),e.\u0275inj=hr({});let n=e;return n})(),yI="browser",Gz="server";function Wz(n){return n===yI}function vI(n){return n===Gz}var gM=(()=>{let e=class e{};e.\u0275prov=ne({token:e,providedIn:"root",factory:()=>Wz(W(ts))?new fI(W(Cn),window):new pI});let n=e;return n})(),fI=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=Kz(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function Kz(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var pI=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Jp=class{};var EI=class extends Yp{constructor(){super(...arguments),this.supportsDOMEvents=!0}},TI=class n extends EI{static makeCurrent(){dM(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Yz();return t==null?null:Jz(t)}resetBaseElement(){xu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return pM(document.cookie,e)}},xu=null;function Yz(){return xu=xu||document.querySelector("base"),xu?xu.getAttribute("href"):null}function Jz(n){return new URL(n,document.baseURI).pathname}var bI=class{addToWindow(e){ln.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new te(5103,!1);return s},ln.getAllAngularTestabilities=()=>e.getAllTestabilities(),ln.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=ln.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};ln.frameworkStabilizers||(ln.frameworkStabilizers=[]),ln.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?yo().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},Xz=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),CI=new de(""),wM=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new te(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(ie(CI),ie(qe))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),nm=class{constructor(e){this._doc=e}},wI="ng-app-id",IM=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=vI(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${wI}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(wI),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(wI,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(ie(Cn),ie(Ap),ie(Vw,8),ie(ts))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),II={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},DI=/%COMP%/g,EM="%COMP%",Zz=`_nghost-${EM}`,eG=`_ngcontent-${EM}`,tG=!0,nG=new de("",{providedIn:"root",factory:()=>tG});function rG(n){return eG.replace(DI,n)}function iG(n){return Zz.replace(DI,n)}function TM(n,e){return e.map(t=>t.replace(DI,n))}var _M=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=vI(c),this.defaultRenderer=new Nu(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Mr.ShadowDom&&(i=ot(K({},i),{encapsulation:Mr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof rm?s.applyToHost(r):s instanceof Pu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(i.encapsulation){case Mr.Emulated:o=new rm(l,d,i,this.appId,h,a,c,p);break;case Mr.ShadowDom:return new SI(l,d,r,i,a,c,this.nonce,p);default:o=new Pu(l,d,i,h,a,c,p);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(ie(wM),ie(IM),ie(Ap),ie(nG),ie(Cn),ie(ts),ie(qe),ie(Vw))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),Nu=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(II[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(yM(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(yM(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new te(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=II[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=II[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(go.DashCase|go.Important)?e.style.setProperty(t,r,i&go.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&go.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=yo().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function yM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var SI=class extends Nu{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=TM(i.id,i.styles);for(let d of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Pu=class extends Nu{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?TM(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},rm=class extends Pu{constructor(e,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,l),this.contentAttr=rG(l),this.hostAttr=iG(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},sG=(()=>{let e=class e extends nm{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(ie(Cn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})(),vM=["alt","control","meta","shift"],oG={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},aG={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},cG=(()=>{let e=class e extends nm{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>yo().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),vM.forEach(d=>{let h=i.indexOf(d);h>-1&&(i.splice(h,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=oG[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),vM.forEach(a=>{if(a!==s){let c=aG[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(ie(Cn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function lG(){TI.makeCurrent()}function uG(){return new Fr}function dG(){return lP(document),document}var hG=[{provide:ts,useValue:yI},{provide:Fw,useValue:lG,multi:!0},{provide:Cn,useFactory:dG,deps:[]}],bM=oI(nM,"browser",hG),fG=new de(""),pG=[{provide:Au,useClass:bI,deps:[]},{provide:tI,useClass:Gp,deps:[qe,Wp,Au]},{provide:Gp,useClass:Gp,deps:[qe,Wp,Au]}],mG=[{provide:Ep,useValue:"root"},{provide:Fr,useFactory:uG,deps:[]},{provide:CI,useClass:sG,multi:!0,deps:[Cn,qe,ts]},{provide:CI,useClass:cG,multi:!0,deps:[Cn]},_M,IM,wM,{provide:Iu,useExisting:_M},{provide:Jp,useClass:Xz,deps:[]},[]],CM=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Ap,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(ie(fG,12))},e.\u0275mod=fr({type:e}),e.\u0275inj=hr({providers:[...mG,...pG],imports:[mM,rM]});let n=e;return n})();var SM=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(ie(Cn))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var me="primary",Wu=Symbol("RouteTitle"),PI=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function oc(n){return new PI(n)}function gG(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function _G(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Hr(n[t],e[t]))return!1;return!0}function Hr(n,e){let t=n?MI(n):void 0,r=e?MI(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!LM(n[i],e[i]))return!1;return!0}function MI(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function LM(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function FM(n){return n.length>0?n[n.length-1]:null}function os(n){return gv(n)?n:Ja(n)?ht(Promise.resolve(n)):ce(n)}var yG={exact:UM,subset:BM},VM={exact:vG,subset:wG,ignored:()=>!0};function AM(n,e,t){return yG[t.paths](n.root,e.root,t.matrixParams)&&VM[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function vG(n,e){return Hr(n,e)}function UM(n,e,t){if(!wo(n.segments,e.segments)||!om(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!UM(n.children[r],e.children[r],t))return!1;return!0}function wG(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>LM(n[t],e[t]))}function BM(n,e,t){return jM(n,e,e.segments,t)}function jM(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!wo(i,t)||e.hasChildren()||!om(i,t,r))}else if(n.segments.length===t.length){if(!wo(n.segments,t)||!om(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!BM(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!wo(n.segments,i)||!om(n.segments,i,r)||!n.children[me]?!1:jM(n.children[me],e,s,r)}}function om(n,e,t){return e.every((r,i)=>VM[t](n[i].parameters,r.parameters))}var rs=class{constructor(e=new Oe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=oc(this.queryParams),this._queryParamMap}toString(){return TG.serialize(this)}},Oe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return am(this)}},vo=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=oc(this.parameters),this._parameterMap}toString(){return HM(this)}};function IG(n,e){return wo(n,e)&&n.every((t,r)=>Hr(t.parameters,e[r].parameters))}function wo(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function EG(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===me&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==me&&(t=t.concat(e(i,r)))}),t}var Ku=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>new Uu,providedIn:"root"});let n=e;return n})(),Uu=class{parse(e){let t=new OI(e);return new rs(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Mu(e.root,!0)}`,r=SG(e.queryParams),i=typeof e.fragment=="string"?`#${bG(e.fragment)}`:"";return`${t}${r}${i}`}},TG=new Uu;function am(n){return n.segments.map(e=>HM(e)).join("/")}function Mu(n,e){if(!n.hasChildren())return am(n);if(e){let t=n.children[me]?Mu(n.children[me],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==me&&r.push(`${i}:${Mu(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=EG(n,(r,i)=>i===me?[Mu(n.children[me],!1)]:[`${i}:${Mu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[me]!=null?`${am(n)}/${t[0]}`:`${am(n)}/(${t.join("//")})`}}function $M(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function im(n){return $M(n).replace(/%3B/gi,";")}function bG(n){return encodeURI(n)}function kI(n){return $M(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function cm(n){return decodeURIComponent(n)}function RM(n){return cm(n.replace(/\+/g,"%20"))}function HM(n){return`${kI(n.path)}${CG(n.parameters)}`}function CG(n){return Object.entries(n).map(([e,t])=>`;${kI(e)}=${kI(t)}`).join("")}function SG(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${im(t)}=${im(i)}`).join("&"):`${im(t)}=${im(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var DG=/^[^\/()?;#]+/;function AI(n){let e=n.match(DG);return e?e[0]:""}var AG=/^[^\/()?;=#]+/;function RG(n){let e=n.match(AG);return e?e[0]:""}var xG=/^[^=?&#]+/;function NG(n){let e=n.match(xG);return e?e[0]:""}var PG=/^[^&#]+/;function MG(n){let e=n.match(PG);return e?e[0]:""}var OI=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Oe([],{}):new Oe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[me]=new Oe(e,t)),r}parseSegment(){let e=AI(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new te(4009,!1);return this.capture(e),new vo(cm(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=RG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=AI(this.remaining);i&&(r=i,this.capture(r))}e[cm(t)]=cm(r)}parseQueryParam(e){let t=NG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=MG(this.remaining);o&&(r=o,this.capture(r))}let i=RM(t),s=RM(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=AI(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new te(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=me);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[me]:new Oe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new te(4011,!1)}};function qM(n){return n.segments.length>0?new Oe([],{[me]:n}):n}function zM(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=zM(i);if(r===me&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Oe(n.segments,e);return kG(t)}function kG(n){if(n.numberOfChildren===1&&n.children[me]){let e=n.children[me];return new Oe(n.segments.concat(e.segments),e.children)}return n}function ac(n){return n instanceof rs}function OG(n,e,t=null,r=null){let i=GM(n);return WM(i,e,t,r)}function GM(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new Oe(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=qM(r);return e??i}function WM(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return RI(i,i,i,t,r);let s=LG(e);if(s.toRoot())return RI(i,i,new Oe([],{}),t,r);let o=FG(s,i,n),a=o.processChildren?Lu(o.segmentGroup,o.index,s.commands):QM(o.segmentGroup,o.index,s.commands);return RI(i,o.segmentGroup,a,t,r)}function lm(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Bu(n){return typeof n=="object"&&n!=null&&n.outlets}function RI(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=KM(n,e,t);let a=qM(zM(o));return new rs(a,s,i)}function KM(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=KM(s,e,t)}),new Oe(n.segments,r)}var um=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&lm(r[0]))throw new te(4003,!1);let i=r.find(Bu);if(i&&i!==FM(r))throw new te(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function LG(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new um(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new um(t,e,r)}var ic=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function FG(n,e,t){if(n.isAbsolute)return new ic(e,!0,0);if(!t)return new ic(e,!1,NaN);if(t.parent===null)return new ic(t,!0,0);let r=lm(n.commands[0])?0:1,i=t.segments.length-1+r;return VG(t,i,n.numberOfDoubleDots)}function VG(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new te(4005,!1);i=r.segments.length}return new ic(r,!1,i-s)}function UG(n){return Bu(n[0])?n[0].outlets:{[me]:n}}function QM(n,e,t){if(n??=new Oe([],{}),n.segments.length===0&&n.hasChildren())return Lu(n,e,t);let r=BG(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Oe(n.segments.slice(0,r.pathIndex),{});return s.children[me]=new Oe(n.segments.slice(r.pathIndex),n.children),Lu(s,0,i)}else return r.match&&i.length===0?new Oe(n.segments,{}):r.match&&!n.hasChildren()?LI(n,e,t):r.match?Lu(n,0,i):LI(n,e,t)}function Lu(n,e,t){if(t.length===0)return new Oe(n.segments,{});{let r=UG(t),i={};if(Object.keys(r).some(s=>s!==me)&&n.children[me]&&n.numberOfChildren===1&&n.children[me].segments.length===0){let s=Lu(n.children[me],e,t);return new Oe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=QM(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Oe(n.segments,i)}}function BG(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(Bu(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!NM(c,l,o))return s;r+=2}else{if(!NM(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function LI(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Bu(s)){let c=jG(s.outlets);return new Oe(r,c)}if(i===0&&lm(t[0])){let c=n.segments[e];r.push(new vo(c.path,xM(t[0]))),i++;continue}let o=Bu(s)?s.outlets[me]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&lm(a)?(r.push(new vo(o,xM(a))),i+=2):(r.push(new vo(o,{})),i++)}return new Oe(r,{})}function jG(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=LI(new Oe([],{}),0,r))}),e}function xM(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function NM(n,e,t){return n==t.path&&Hr(e,t.parameters)}var Fu="imperative",kt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(kt||{}),Kn=class{constructor(e,t){this.id=e,this.url=t}},cc=class extends Kn{constructor(e,t,r="imperative",i=null){super(e,t),this.type=kt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},qr=class extends Kn{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=kt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Mn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Mn||{}),dm=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(dm||{}),is=class extends Kn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=kt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ss=class extends Kn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=kt.NavigationSkipped}},ju=class extends Kn{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=kt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},hm=class extends Kn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=kt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},FI=class extends Kn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=kt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},VI=class extends Kn{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=kt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},UI=class extends Kn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=kt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},BI=class extends Kn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=kt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},jI=class{constructor(e){this.route=e,this.type=kt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},$I=class{constructor(e){this.route=e,this.type=kt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},HI=class{constructor(e){this.snapshot=e,this.type=kt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qI=class{constructor(e){this.snapshot=e,this.type=kt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},zI=class{constructor(e){this.snapshot=e,this.type=kt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},GI=class{constructor(e){this.snapshot=e,this.type=kt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},fm=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=kt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},$u=class{},Hu=class{constructor(e){this.url=e}};var WI=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Qu,this.attachRef=null}},Qu=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new WI,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),pm=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=KI(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=KI(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=QI(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return QI(e,this._root).map(t=>t.value)}};function KI(n,e){if(n===e.value)return e;for(let t of e.children){let r=KI(n,t);if(r)return r}return null}function QI(n,e){if(n===e.value)return[e];for(let t of e.children){let r=QI(n,t);if(r.length)return r.unshift(e),r}return[]}var Pn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function rc(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var mm=class extends pm{constructor(e,t){super(e),this.snapshot=t,sE(this,e)}toString(){return this.snapshot.toString()}};function YM(n){let e=$G(n),t=new Xe([new vo("",{})]),r=new Xe({}),i=new Xe({}),s=new Xe({}),o=new Xe(""),a=new Di(t,r,s,o,i,me,n,e.root);return a.snapshot=e.root,new mm(new Pn(a,[]),e)}function $G(n){let e={},t={},r={},i="",s=new qu([],e,r,i,t,me,n,null,{});return new gm("",new Pn(s,[]))}var Di=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Ae(l=>l[Wu]))??ce(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Ae(e=>oc(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Ae(e=>oc(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function iE(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:K(K({},e.params),n.params),data:K(K({},e.data),n.data),resolve:K(K(K(K({},n.data),e.data),i?.data),n._resolvedData)}:r={params:K({},n.params),data:K({},n.data),resolve:K(K({},n.data),n._resolvedData??{})},i&&XM(i)&&(r.resolve[Wu]=i.title),r}var qu=class{get title(){return this.data?.[Wu]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=oc(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=oc(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},gm=class extends pm{constructor(e,t){super(t),this.url=e,sE(this,t)}toString(){return JM(this._root)}};function sE(n,e){e.value._routerState=n,e.children.forEach(t=>sE(n,t))}function JM(n){let e=n.children.length>0?` { ${n.children.map(JM).join(", ")} } `:"";return`${n.value}${e}`}function xI(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Hr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Hr(e.params,t.params)||n.paramsSubject.next(t.params),_G(e.url,t.url)||n.urlSubject.next(t.url),Hr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function YI(n,e){let t=Hr(n.params,e.params)&&IG(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||YI(n.parent,e.parent))}function XM(n){return typeof n.title=="string"||n.title===null}var oE=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=me,this.activateEvents=new cn,this.deactivateEvents=new cn,this.attachEvents=new cn,this.detachEvents=new cn,this.parentContexts=W(Qu),this.location=W(Qa),this.changeDetector=W(Za),this.environmentInjector=W(bn),this.inputBinder=W(Im,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new te(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new te(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new te(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new te(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new JI(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Wa({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Cu]});let n=e;return n})(),JI=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Di?this.route:e===Qu?this.childContexts:this.parent.get(e,t)}},Im=new de(""),PM=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=cu([i.queryParams,i.params,i.data]).pipe(Hn(([o,a,c],l)=>(c=K(K(K({},o),a),c),l===0?ce(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=iM(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function HG(n,e,t){let r=zu(n,e._root,t?t._root:void 0);return new mm(r,e)}function zu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=qG(n,e,t);return new Pn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>zu(n,a)),o}}let r=zG(e.value),i=e.children.map(s=>zu(n,s));return new Pn(r,i)}}function qG(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return zu(n,r,i);return zu(n,r)})}function zG(n){return new Di(new Xe(n.url),new Xe(n.params),new Xe(n.queryParams),new Xe(n.fragment),new Xe(n.data),n.outlet,n.component,n)}var ZM="ngNavigationCancelingError";function ek(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=ac(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=tk(!1,Mn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function tk(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[ZM]=!0,t.cancellationCode=e,t}function GG(n){return nk(n)&&ac(n.url)}function nk(n){return!!n&&n[ZM]}var WG=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=vt({type:e,selectors:[["ng-component"]],standalone:!0,features:[QP],decls:1,vars:0,template:function(i,s){i&1&&re(0,"router-outlet")},dependencies:[oE],encapsulation:2});let n=e;return n})();function KG(n,e){return n.providers&&!n._injector&&(n._injector=Up(n.providers,e,`Route: ${n.path}`)),n._injector??e}function aE(n){let e=n.children&&n.children.map(aE),t=e?ot(K({},n),{children:e}):K({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==me&&(t.component=WG),t}function zr(n){return n.outlet||me}function QG(n,e){let t=n.filter(r=>zr(r)===e);return t.push(...n.filter(r=>zr(r)!==e)),t}function Yu(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var YG=(n,e,t,r)=>Ae(i=>(new XI(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),XI=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),xI(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=rc(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=rc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=rc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=rc(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new GI(s.value.snapshot))}),e.children.length&&this.forwardEvent(new qI(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(xI(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),xI(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Yu(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},_m=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},sc=class{constructor(e,t){this.component=e,this.route=t}};function JG(n,e,t){let r=n._root,i=e?e._root:null;return ku(r,i,t,[r.value])}function XG(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function uc(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!tN(n)?n:e.get(n):r}function ku(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=rc(e);return n.children.forEach(o=>{ZG(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Vu(a,t.getContext(o),i)),i}function ZG(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=eW(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new _m(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?ku(n,e,a?a.children:null,r,i):ku(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new sc(a.outlet.component,o))}else o&&Vu(e,a,i),i.canActivateChecks.push(new _m(r)),s.component?ku(n,null,a?a.children:null,r,i):ku(n,null,t,r,i);return i}function eW(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!wo(n.url,e.url);case"pathParamsOrQueryParamsChange":return!wo(n.url,e.url)||!Hr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!YI(n,e)||!Hr(n.queryParams,e.queryParams);case"paramsChange":default:return!YI(n,e)}}function Vu(n,e,t){let r=rc(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Vu(o,e.children.getContext(s),t):Vu(o,null,t):Vu(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new sc(e.outlet.component,i)):t.canDeactivateChecks.push(new sc(null,i)):t.canDeactivateChecks.push(new sc(null,i))}function Ju(n){return typeof n=="function"}function tW(n){return typeof n=="boolean"}function nW(n){return n&&Ju(n.canLoad)}function rW(n){return n&&Ju(n.canActivate)}function iW(n){return n&&Ju(n.canActivateChild)}function sW(n){return n&&Ju(n.canDeactivate)}function oW(n){return n&&Ju(n.canMatch)}function rk(n){return n instanceof Ii||n?.name==="EmptyError"}var sm=Symbol("INITIAL_VALUE");function lc(){return Hn(n=>cu(n.map(e=>e.pipe(Ei(1),wv(sm)))).pipe(Ae(e=>{for(let t of e)if(t!==!0){if(t===sm)return sm;if(t===!1||t instanceof rs)return t}return!0}),$n(e=>e!==sm),Ei(1)))}function aW(n,e){return yt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?ce(ot(K({},t),{guardsResult:!0})):cW(o,r,i,n).pipe(yt(a=>a&&tW(a)?lW(r,s,n,e):ce(a)),Ae(a=>ot(K({},t),{guardsResult:a})))})}function cW(n,e,t,r){return ht(n).pipe(yt(i=>pW(i.component,i.route,t,e,r)),Rr(i=>i!==!0,!0))}function lW(n,e,t,r){return ht(e).pipe(io(i=>Oa(dW(i.route.parent,r),uW(i.route,r),fW(n,i.path,t),hW(n,i.route,t))),Rr(i=>i!==!0,!0))}function uW(n,e){return n!==null&&e&&e(new zI(n)),ce(!0)}function dW(n,e){return n!==null&&e&&e(new HI(n)),ce(!0)}function hW(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return ce(!0);let i=r.map(s=>jf(()=>{let o=Yu(e)??t,a=uc(s,o),c=rW(a)?a.canActivate(e,n):Ti(o,()=>a(e,n));return os(c).pipe(Rr())}));return ce(i).pipe(lc())}function fW(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>XG(o)).filter(o=>o!==null).map(o=>jf(()=>{let a=o.guards.map(c=>{let l=Yu(o.node)??t,d=uc(c,l),h=iW(d)?d.canActivateChild(r,n):Ti(l,()=>d(r,n));return os(h).pipe(Rr())});return ce(a).pipe(lc())}));return ce(s).pipe(lc())}function pW(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return ce(!0);let o=s.map(a=>{let c=Yu(e)??i,l=uc(a,c),d=sW(l)?l.canDeactivate(n,e,t,r):Ti(c,()=>l(n,e,t,r));return os(d).pipe(Rr())});return ce(o).pipe(lc())}function mW(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return ce(!0);let s=i.map(o=>{let a=uc(o,n),c=nW(a)?a.canLoad(e,t):Ti(n,()=>a(e,t));return os(c)});return ce(s).pipe(lc(),ik(r))}function ik(n){return hv(jt(e=>{if(ac(e))throw ek(n,e)}),Ae(e=>e===!0))}function gW(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return ce(!0);let s=i.map(o=>{let a=uc(o,n),c=oW(a)?a.canMatch(e,t):Ti(n,()=>a(e,t));return os(c)});return ce(s).pipe(lc(),ik(r))}var Gu=class{constructor(e){this.segmentGroup=e||null}},ym=class extends Error{constructor(e){super(),this.urlTree=e}};function nc(n){return Ma(new Gu(n))}function _W(n){return Ma(new te(4e3,!1))}function yW(n){return Ma(tk(!1,Mn.GuardRejected))}var ZI=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return ce(r);if(i.numberOfChildren>1||!i.children[me])return _W(e.redirectTo);i=i.children[me]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new ym(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new rs(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Oe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new te(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},eE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function vW(n,e,t,r,i){let s=cE(n,e,t);return s.matched?(r=KG(e,r),gW(r,e,t,i).pipe(Ae(o=>o===!0?s:K({},eE)))):ce(s)}function cE(n,e,t){if(e.path==="**")return wW(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?K({},eE):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||gG)(t,n,e);if(!i)return K({},eE);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?K(K({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function wW(n){return{matched:!0,parameters:n.length>0?FM(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function MM(n,e,t,r){return t.length>0&&TW(n,t,r)?{segmentGroup:new Oe(e,EW(r,new Oe(t,n.children))),slicedSegments:[]}:t.length===0&&bW(n,t,r)?{segmentGroup:new Oe(n.segments,IW(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Oe(n.segments,n.children),slicedSegments:t}}function IW(n,e,t,r){let i={};for(let s of t)if(Em(n,e,s)&&!r[zr(s)]){let o=new Oe([],{});i[zr(s)]=o}return K(K({},r),i)}function EW(n,e){let t={};t[me]=e;for(let r of n)if(r.path===""&&zr(r)!==me){let i=new Oe([],{});t[zr(r)]=i}return t}function TW(n,e,t){return t.some(r=>Em(n,e,r)&&zr(r)!==me)}function bW(n,e,t){return t.some(r=>Em(n,e,r))}function Em(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function CW(n,e,t,r){return zr(n)!==r&&(r===me||!Em(e,t,n))?!1:cE(e,n,t).matched}function SW(n,e,t){return e.length===0&&!n.children[t]}var tE=class{};function DW(n,e,t,r,i,s,o="emptyOnly"){return new nE(n,e,t,r,i,o,s).recognize()}var AW=31,nE=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new ZI(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new te(4002,`'${e.segmentGroup}'`)}recognize(){let e=MM(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Ae(t=>{let r=new qu([],Object.freeze({}),Object.freeze(K({},this.urlTree.queryParams)),this.urlTree.fragment,{},me,this.rootComponentType,null,{}),i=new Pn(r,t),s=new gm("",i),o=OG(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,me).pipe(Ki(r=>{if(r instanceof ym)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Gu?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=iE(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Ae(s=>s instanceof Pn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ht(i).pipe(io(s=>{let o=r.children[s],a=QG(t,s);return this.processSegmentGroup(e,a,o,s)}),vv((s,o)=>(s.push(...o),s)),Qi(null),yv(),yt(s=>{if(s===null)return nc(r);let o=sk(s);return RW(o),ce(o)}))}processSegment(e,t,r,i,s,o){return ht(t).pipe(io(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(Ki(c=>{if(c instanceof Gu)return ce(null);throw c}))),Rr(a=>!!a),Ki(a=>{if(rk(a))return SW(r,i,s)?ce(new tE):nc(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return CW(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):nc(i):nc(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:d}=cE(t,i,s);if(!a)return nc(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>AW&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,h).pipe(yt(p=>this.processSegment(e,r,t,p.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=vW(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(Hn(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Hn(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:p}=a,_=new qu(d,p,Object.freeze(K({},this.urlTree.queryParams)),this.urlTree.fragment,NW(r),zr(r),r.component??r._loadedComponent??null,r,PW(r)),{segmentGroup:w,slicedSegments:b}=MM(t,d,h,c);if(b.length===0&&w.hasChildren())return this.processChildren(l,c,w).pipe(Ae(O=>O===null?null:new Pn(_,O)));if(c.length===0&&b.length===0)return ce(new Pn(_,[]));let S=zr(r)===s;return this.processSegment(l,c,w,b,S?me:s,!0).pipe(Ae(O=>new Pn(_,O instanceof Pn?[O]:[])))}))):nc(t)))}getChildConfig(e,t,r){return t.children?ce({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ce({routes:t._loadedRoutes,injector:t._loadedInjector}):mW(e,t,r,this.urlSerializer).pipe(yt(i=>i?this.configLoader.loadChildren(e,t).pipe(jt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):yW(t))):ce({routes:[],injector:e})}};function RW(n){n.sort((e,t)=>e.value.outlet===me?-1:t.value.outlet===me?1:e.value.outlet.localeCompare(t.value.outlet))}function xW(n){let e=n.value.routeConfig;return e&&e.path===""}function sk(n){let e=[],t=new Set;for(let r of n){if(!xW(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=sk(r.children);e.push(new Pn(r.value,i))}return e.filter(r=>!t.has(r))}function NW(n){return n.data||{}}function PW(n){return n.resolve||{}}function MW(n,e,t,r,i,s){return yt(o=>DW(n,e,t,r,o.extractedUrl,i,s).pipe(Ae(({state:a,tree:c})=>ot(K({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function kW(n,e){return yt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return ce(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of ok(c))o.add(l);let a=0;return ht(o).pipe(io(c=>s.has(c)?OW(c,r,n,e):(c.data=iE(c,c.parent,n).resolve,ce(void 0))),jt(()=>a++),La(1),yt(c=>a===o.size?ce(t):Nn))})}function ok(n){let e=n.children.map(t=>ok(t)).flat();return[n,...e]}function OW(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!XM(i)&&(s[Wu]=i.title),LW(s,n,e,r).pipe(Ae(o=>(n._resolvedData=o,n.data=iE(n,n.parent,t).resolve,null)))}function LW(n,e,t,r){let i=MI(n);if(i.length===0)return ce({});let s={};return ht(i).pipe(yt(o=>FW(n[o],e,t,r).pipe(Rr(),jt(a=>{s[o]=a}))),La(1),_v(s),Ki(o=>rk(o)?Nn:Ma(o)))}function FW(n,e,t,r){let i=Yu(e)??r,s=uc(n,i),o=s.resolve?s.resolve(e,t):Ti(i,()=>s(e,t));return os(o)}function NI(n){return Hn(e=>{let t=n(e);return t?ht(t).pipe(Ae(()=>e)):ce(e)})}var ak=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===me);return i}getResolvedTitleForRoute(r){return r.data[Wu]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(VW),providedIn:"root"});let n=e;return n})(),VW=(()=>{let e=class e extends ak{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(ie(SM))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Xu=new de("",{providedIn:"root",factory:()=>({})}),vm=new de(""),lE=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=W(Qp)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return ce(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=os(r.loadComponent()).pipe(Ae(ck),jt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),lu(()=>{this.componentLoaders.delete(r)})),s=new Pa(i,()=>new Yt).pipe(Na());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ce({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=UW(i,this.compiler,r,this.onLoadEndListener).pipe(lu(()=>{this.childrenLoaders.delete(i)})),a=new Pa(o,()=>new Yt).pipe(Na());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function UW(n,e,t,r){return os(n.loadChildren()).pipe(Ae(ck),yt(i=>i instanceof Eu||Array.isArray(i)?ce(i):ht(e.compileModuleAsync(i))),Ae(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(vm,[],{optional:!0,self:!0}).flat()),{routes:o.map(aE),injector:s}}))}function BW(n){return n&&typeof n=="object"&&"default"in n}function ck(n){return BW(n)?n.default:n}var uE=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(jW),providedIn:"root"});let n=e;return n})(),jW=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),lk=new de(""),uk=new de("");function $W(n,e,t){let r=n.get(uk),i=n.get(Cn);return n.get(qe).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),HW(n))),{onViewTransitionCreated:c}=r;return c&&Ti(n,()=>c({transition:a,from:e,to:t})),o})}function HW(n){return new Promise(e=>{Vp(e,{injector:n})})}var dE=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Yt,this.transitionAbortSubject=new Yt,this.configLoader=W(lE),this.environmentInjector=W(bn),this.urlSerializer=W(Ku),this.rootContexts=W(Qu),this.location=W(ec),this.inputBindingEnabled=W(Im,{optional:!0})!==null,this.titleStrategy=W(ak),this.options=W(Xu,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=W(uE),this.createViewTransition=W(lk,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ce(void 0),this.rootComponentType=null;let r=s=>this.events.next(new jI(s)),i=s=>this.events.next(new $I(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ot(K(K({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Xe({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Fu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe($n(o=>o.id!==0),Ae(o=>ot(K({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Hn(o=>{let a=!1,c=!1;return ce(o).pipe(Hn(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Mn.SupersededByNewNavigation),Nn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?ot(K({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&h!=="reload"){let p="";return this.events.next(new ss(l.id,this.urlSerializer.serialize(l.rawUrl),p,dm.IgnoredSameUrlNavigation)),l.resolve(null),Nn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return ce(l).pipe(Hn(p=>{let _=this.transitions?.getValue();return this.events.next(new cc(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),_!==this.transitions?.getValue()?Nn:Promise.resolve(p)}),MW(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),jt(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=ot(K({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let _=new hm(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(_)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:_,source:w,restoredState:b,extras:S}=l,O=new cc(p,this.urlSerializer.serialize(_),w,b);this.events.next(O);let H=YM(this.rootComponentType).snapshot;return this.currentTransition=o=ot(K({},l),{targetSnapshot:H,urlAfterRedirects:_,extras:ot(K({},S),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=_,ce(o)}else{let p="";return this.events.next(new ss(l.id,this.urlSerializer.serialize(l.extractedUrl),p,dm.IgnoredByUrlHandlingStrategy)),l.resolve(null),Nn}}),jt(l=>{let d=new FI(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Ae(l=>(this.currentTransition=o=ot(K({},l),{guards:JG(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),aW(this.environmentInjector,l=>this.events.next(l)),jt(l=>{if(o.guardsResult=l.guardsResult,ac(l.guardsResult))throw ek(this.urlSerializer,l.guardsResult);let d=new VI(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),$n(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Mn.GuardRejected),!1)),NI(l=>{if(l.guards.canActivateChecks.length)return ce(l).pipe(jt(d=>{let h=new UI(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),Hn(d=>{let h=!1;return ce(d).pipe(kW(this.paramsInheritanceStrategy,this.environmentInjector),jt({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",Mn.NoDataFromResolver)}}))}),jt(d=>{let h=new BI(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),NI(l=>{let d=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(jt(_=>{h.component=_}),Ae(()=>{})));for(let _ of h.children)p.push(...d(_));return p};return cu(d(l.targetSnapshot.root)).pipe(Qi(null),Ei(1))}),NI(()=>this.afterPreactivation()),Hn(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return h?ht(h).pipe(Ae(()=>o)):ce(o)}),Ae(l=>{let d=HG(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=ot(K({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),jt(()=>{this.events.next(new $u)}),YG(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Ei(1),jt({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new qr(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Iv(this.transitionAbortSubject.pipe(jt(l=>{throw l}))),lu(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Mn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Ki(l=>{if(c=!0,nk(l))this.events.next(new is(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),GG(l)?this.events.next(new Hu(l.url)):o.resolve(!1);else{this.events.next(new ju(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Nn}))}))}cancelNavigationTransition(r,i,s){let o=new is(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function qW(n){return n!==Fu}var zW=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(GW),providedIn:"root"});let n=e;return n})(),rE=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},GW=(()=>{let e=class e extends rE{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=kw(e)))(s||e)}})(),e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),dk=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:()=>W(WW),providedIn:"root"});let n=e;return n})(),WW=(()=>{let e=class e extends dk{constructor(){super(...arguments),this.location=W(ec),this.urlSerializer=W(Ku),this.options=W(Xu,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=W(uE),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new rs,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=YM(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof cc)this.stateMemento=this.createStateMemento();else if(r instanceof ss)this.rawUrlTree=i.initialUrl;else if(r instanceof hm){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof $u?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof is&&(r.code===Mn.GuardRejected||r.code===Mn.NoDataFromResolver)?this.restoreHistory(i):r instanceof ju?this.restoreHistory(i,!0):r instanceof qr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=K(K({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=K(K({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=kw(e)))(s||e)}})(),e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ou=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Ou||{});function hk(n,e){n.events.pipe($n(t=>t instanceof qr||t instanceof is||t instanceof ju||t instanceof ss),Ae(t=>t instanceof qr||t instanceof ss?Ou.COMPLETE:(t instanceof is?t.code===Mn.Redirect||t.code===Mn.SupersededByNewNavigation:!1)?Ou.REDIRECTING:Ou.FAILED),$n(t=>t!==Ou.REDIRECTING),Ei(1)).subscribe(()=>{e()})}function KW(n){throw n}var QW={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},YW={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},wt=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=W(zp),this.stateManager=W(dk),this.options=W(Xu,{optional:!0})||{},this.pendingTasks=W(Bp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=W(dE),this.urlSerializer=W(Ku),this.location=W(ec),this.urlHandlingStrategy=W(uE),this._events=new Yt,this.errorHandler=this.options.errorHandler||KW,this.navigated=!1,this.routeReuseStrategy=W(zW),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=W(vm,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!W(Im,{optional:!0}),this.eventsSubscription=new xt,this.isNgZoneEnabled=W(qe)instanceof qe&&qe.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof is&&i.code!==Mn.Redirect&&i.code!==Mn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof qr)this.navigated=!0;else if(i instanceof Hu){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||qW(s.source)};this.scheduleNavigation(a,Fu,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}XW(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Fu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=K({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(aE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=K(K({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let _=s?s.snapshot:this.routerState.snapshot.root;p=GM(_)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),p=this.currentUrlTree.root}return WM(p,r,h,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=ac(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Fu,null,i)}navigate(r,i={skipLocationChange:!1}){return JW(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=K({},QW):i===!1?s=K({},YW):s=i,ac(r))return AM(this.currentUrlTree,r,s);let o=this.parseUrl(r);return AM(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,d;a?(c=a.resolve,l=a.reject,d=a.promise):d=new Promise((p,_)=>{c=p,l=_});let h=this.pendingTasks.add();return hk(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function JW(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new te(4008,!1)}function XW(n){return!(n instanceof $u)&&!(n instanceof Hu)}var fk=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Yt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof qr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:hP(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(we(wt),we(Di),Ow("tabindex"),we(Fp),we(Du),we(_r))},e.\u0275dir=Wa({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&oe("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&Zw("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[lr.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Ru],skipLocationChange:[lr.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Ru],replaceUrl:[lr.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Ru],routerLink:"routerLink"},standalone:!0,features:[Xw,Cu]});let n=e;return n})();var wm=class{};var ZW=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe($n(r=>r instanceof qr),io(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Up(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return ht(s).pipe(ka())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=ce(null);let o=s.pipe(yt(a=>a===null?ce(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return ht([o,a]).pipe(ka())}else return o})}};e.\u0275fac=function(i){return new(i||e)(ie(wt),ie(Qp),ie(bn),ie(wm),ie(lE))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),pk=new de(""),e3=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=W(bn),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof cc?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof qr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof ss&&r.code===dm.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof fm&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>g(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),Vp(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new fm(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){bP()},e.\u0275prov=ne({token:e,factory:e.\u0275fac});let n=e;return n})();function t3(n){return n.routerState.root}function Zu(n,e){return{\u0275kind:n,\u0275providers:e}}function n3(){let n=W(jr);return e=>{let t=n.get(Xa);if(e!==t.components[0])return;let r=n.get(wt),i=n.get(mk);n.get(hE)===1&&r.initialNavigation(),n.get(gk,null,ve.Optional)?.setUpPreloading(),n.get(pk,null,ve.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var mk=new de("",{factory:()=>new Yt}),hE=new de("",{providedIn:"root",factory:()=>1});function r3(){return Zu(2,[{provide:hE,useValue:0},{provide:Kp,multi:!0,deps:[jr],useFactory:e=>{let t=e.get(hM,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(wt),s=e.get(mk);hk(i,()=>{r(!0)}),e.get(dE).afterPreactivation=()=>(r(!0),s.closed?ce(void 0):s),i.initialNavigation()}))}}])}function i3(){return Zu(3,[{provide:Kp,multi:!0,useFactory:()=>{let e=W(wt);return()=>{e.setUpLocationChangeListener()}}},{provide:hE,useValue:2}])}var gk=new de("");function s3(n){return Zu(0,[{provide:gk,useExisting:ZW},{provide:wm,useExisting:n}])}function o3(){return Zu(8,[PM,{provide:Im,useExisting:PM}])}function a3(n){let e=[{provide:lk,useValue:$W},{provide:uk,useValue:K({skipNextTransition:!!n?.skipInitialTransition},n)}];return Zu(9,e)}var kM=new de("ROUTER_FORROOT_GUARD"),c3=[ec,{provide:Ku,useClass:Uu},wt,Qu,{provide:Di,useFactory:t3,deps:[wt]},lE,[]],fE=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[c3,[],{provide:vm,multi:!0,useValue:r},{provide:kM,useFactory:h3,deps:[[wt,new Ip,new gw]]},{provide:Xu,useValue:i||{}},i?.useHash?u3():d3(),l3(),i?.preloadingStrategy?s3(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?f3(i):[],i?.bindToComponentInputs?o3().\u0275providers:[],i?.enableViewTransitions?a3().\u0275providers:[],p3()]}}static forChild(r){return{ngModule:e,providers:[{provide:vm,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(ie(kM,8))},e.\u0275mod=fr({type:e}),e.\u0275inj=hr({});let n=e;return n})();function l3(){return{provide:pk,useFactory:()=>{let n=W(gM),e=W(qe),t=W(Xu),r=W(dE),i=W(Ku);return t.scrollOffset&&n.setOffset(t.scrollOffset),new e3(i,r,n,e,t)}}}function u3(){return{provide:_r,useClass:Xp}}function d3(){return{provide:_r,useClass:_I}}function h3(n){return"guarded"}function f3(n){return[n.initialNavigation==="disabled"?i3().\u0275providers:[],n.initialNavigation==="enabledBlocking"?r3().\u0275providers:[]]}var OM=new de("");function p3(){return[{provide:OM,useFactory:n3},{provide:iI,multi:!0,useExisting:OM}]}var mE={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var j=function(n,e){if(!n)throw Io(e)},Io=function(n){return new Error("Firebase Database ("+mE.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var yk=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},m3=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},bm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4,p=(a&15)<<2|l>>6,_=l&63;c||(_=64,o||(p=64)),r.push(t[d],t[h],t[p],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(yk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):m3(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new gE;let p=s<<2|a>>4;if(r.push(p),l!==64){let _=a<<4&240|l>>2;if(r.push(_),h!==64){let w=l<<6&192|h;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},gE=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},yE=function(n){let e=yk(n);return bm.encodeByteArray(e,!0)},ed=function(n){return yE(n).replace(/\./g,"")},td=function(n){try{return bm.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function vk(n){return fc(void 0,n)}function fc(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!g3(t)||(n[t]=fc(n[t],e[t]));return n}function g3(n){return n!=="__proto__"}function _3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var y3=()=>_3().__FIREBASE_DEFAULTS__,v3=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},w3=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&td(n[1]);return e&&JSON.parse(e)},vE=()=>{try{return y3()||v3()||w3()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var wE=()=>{var n;return(n=vE())===null||n===void 0?void 0:n.config},wk=n=>{var e;return(e=vE())===null||e===void 0?void 0:e[`_${n}`]};var Nt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function pc(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[ed(JSON.stringify(t)),ed(JSON.stringify(o)),""].join(".")}function je(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nd(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(je())}function Cm(){var n;let e=(n=vE())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Sm(){return typeof self=="object"&&self.self===self}function Dm(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Eo(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Am(){let n=je();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Gr(){return mE.NODE_CLIENT===!0||mE.NODE_ADMIN===!0}function IE(){return!Cm()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function as(){try{return typeof indexedDB=="object"}catch{return!1}}function Ik(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var I3="FirebaseError",at=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=I3,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qn.prototype.create)}},Qn=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?E3(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new at(i,a,r)}};function E3(n,e){return n.replace(T3,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var T3=/\{\$([^}]+)}/g;function hc(n){return JSON.parse(n)}function It(n){return JSON.stringify(n)}var Ek=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=hc(td(s[0])||""),t=hc(td(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var Tk=function(n){let e=Ek(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},bk=function(n){let e=Ek(n).claims;return typeof e=="object"&&e.admin===!0};function dn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function cs(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function mc(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function rd(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function ls(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(_k(s)&&_k(o)){if(!ls(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function _k(n){return n!==null&&typeof n=="object"}function Ai(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function us(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function gc(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var Tm=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){let p=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(p<<1|p>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,d;for(let h=0;h<80;h++){h<40?h<20?(l=a^s&(o^a),d=1518500249):(l=s^o^a,d=1859775393):h<60?(l=s&o|a&(s|o),d=2400959708):(l=s^o^a,d=3395469782);let p=(i<<5|i>>>27)+l+c+d+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=p}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function Rm(n,e){let t=new _E(n,e);return t.subscribe.bind(t)}var _E=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");b3(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=pE),i.error===void 0&&(i.error=pE),i.complete===void 0&&(i.complete=pE);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function b3(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function pE(){}var se=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){let s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function Xt(n,e){return`${n} failed: ${e} argument `}function Pt(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(Xt(n,e)+"must be a valid function.")}function EE(n,e,t,r){if(!(r&&!t)&&(typeof t!="object"||t===null))throw new Error(Xt(n,e)+"must be a valid context object.")}var Ck=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,j(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},id=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var zse=4*60*60*1e3;function q(n){return n&&n._delegate?n._delegate:n}var Ve=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var To="[DEFAULT]";var bo=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Nt;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(S3(e))try{this.getOrInitializeService({instanceIdentifier:To})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=To){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=To){return this.instances.has(e)}getOptions(e=To){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:C3(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=To){return this.component?this.component.multipleInstances?e:To:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function C3(n){return n===To?void 0:n}function S3(n){return n.instantiationMode==="EAGER"}var ds=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new bo(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var VE={};Ij(VE,{FirebaseError:()=>at,SDK_VERSION:()=>fn,_DEFAULT_ENTRY_NAME:()=>Kr,_addComponent:()=>vc,_addOrOverwriteComponent:()=>OE,_apps:()=>hs,_clearComponents:()=>f9,_components:()=>yc,_getProvider:()=>wc,_isFirebaseApp:()=>Bk,_isFirebaseServerApp:()=>tt,_registerComponent:()=>hn,_removeServiceInstance:()=>Uk,_serverApps:()=>_c,deleteApp:()=>km,getApp:()=>od,getApps:()=>g9,initializeApp:()=>Mm,initializeServerApp:()=>m9,onLog:()=>LE,registerVersion:()=>ft,setLogLevel:()=>FE});var TE=[],ge=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(ge||{}),Sk={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},D3=ge.INFO,A3={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},R3=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=A3[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Sn=class{constructor(e){this.name=e,this._logLevel=D3,this._logHandler=R3,this._userLogHandler=null,TE.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Sk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}};function Dk(n){TE.forEach(e=>{e.setLogLevel(n)})}function Ak(n,e){for(let t of TE){let r=null;e&&e.level&&(r=Sk[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:ge[s].toLowerCase(),message:a,args:o,type:i.name})}}}var x3=(n,e)=>e.some(t=>n instanceof t),Rk,xk;function N3(){return Rk||(Rk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function P3(){return xk||(xk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Nk=new WeakMap,CE=new WeakMap,Pk=new WeakMap,bE=new WeakMap,DE=new WeakMap;function M3(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Wr(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Nk.set(t,n)}).catch(()=>{}),DE.set(e,n),e}function k3(n){if(CE.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});CE.set(n,e)}var SE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return CE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Pk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Wr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Mk(n){SE=n(SE)}function O3(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(xm(this),e,...t);return Pk.set(r,e.sort?e.sort():[e]),Wr(r)}:P3().includes(n)?function(...e){return n.apply(xm(this),e),Wr(Nk.get(this))}:function(...e){return Wr(n.apply(xm(this),e))}}function L3(n){return typeof n=="function"?O3(n):(n instanceof IDBTransaction&&k3(n),x3(n,N3())?new Proxy(n,SE):n)}function Wr(n){if(n instanceof IDBRequest)return M3(n);if(bE.has(n))return bE.get(n);let e=L3(n);return e!==n&&(bE.set(n,e),DE.set(e,n)),e}var xm=n=>DE.get(n);function Ok(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=Wr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Wr(o.result),c.oldVersion,c.newVersion,Wr(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var F3=["get","getKey","getAll","getAllKeys","count"],V3=["put","add","delete","clear"],AE=new Map;function kk(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(AE.get(e))return AE.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=V3.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||F3.includes(t)))return;let s=function(o,...a){return g(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return AE.set(e,s),s}Mk(n=>ot(K({},n),{get:(e,t,r)=>kk(e,t)||n.get(e,t,r),has:(e,t)=>!!kk(e,t)||n.has(e,t)}));var xE=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(U3(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function U3(n){let e=n.getComponent();return e?.type==="VERSION"}var Nm="@firebase/app",NE="0.10.5";var Co=new Sn("@firebase/app"),B3="@firebase/app-compat",j3="@firebase/analytics-compat",$3="@firebase/analytics",H3="@firebase/app-check-compat",q3="@firebase/app-check",z3="@firebase/auth",G3="@firebase/auth-compat",W3="@firebase/database",K3="@firebase/database-compat",Q3="@firebase/functions",Y3="@firebase/functions-compat",J3="@firebase/installations",X3="@firebase/installations-compat",Z3="@firebase/messaging",e9="@firebase/messaging-compat",t9="@firebase/performance",n9="@firebase/performance-compat",r9="@firebase/remote-config",i9="@firebase/remote-config-compat",s9="@firebase/storage",o9="@firebase/storage-compat",a9="@firebase/firestore",c9="@firebase/vertexai-preview",l9="@firebase/firestore-compat",u9="firebase",d9="10.12.2";var Kr="[DEFAULT]",h9={[Nm]:"fire-core",[B3]:"fire-core-compat",[$3]:"fire-analytics",[j3]:"fire-analytics-compat",[q3]:"fire-app-check",[H3]:"fire-app-check-compat",[z3]:"fire-auth",[G3]:"fire-auth-compat",[W3]:"fire-rtdb",[K3]:"fire-rtdb-compat",[Q3]:"fire-fn",[Y3]:"fire-fn-compat",[J3]:"fire-iid",[X3]:"fire-iid-compat",[Z3]:"fire-fcm",[e9]:"fire-fcm-compat",[t9]:"fire-perf",[n9]:"fire-perf-compat",[r9]:"fire-rc",[i9]:"fire-rc-compat",[s9]:"fire-gcs",[o9]:"fire-gcs-compat",[a9]:"fire-fst",[l9]:"fire-fst-compat",[c9]:"fire-vertex","fire-js":"fire-js",[u9]:"fire-js-all"};var hs=new Map,_c=new Map,yc=new Map;function vc(n,e){try{n.container.addComponent(e)}catch(t){Co.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function OE(n,e){n.container.addOrOverwriteComponent(e)}function hn(n){let e=n.name;if(yc.has(e))return Co.debug(`There were multiple attempts to register component ${e}.`),!1;yc.set(e,n);for(let t of hs.values())vc(t,n);for(let t of _c.values())vc(t,n);return!0}function wc(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Uk(n,e,t=Kr){wc(n,e).clearInstance(t)}function Bk(n){return n.options!==void 0}function tt(n){return n.settings!==void 0}function f9(){yc.clear()}var p9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Yn=new Qn("app","Firebase",p9);var Pm=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ve("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yn.create("app-deleted",{appName:this._name})}};var PE=class extends Pm{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,ft(Nm,NE,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){km(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Yn.create("server-app-deleted")}};var fn=d9;function Mm(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Kr,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Yn.create("bad-app-name",{appName:String(i)});if(t||(t=wE()),!t)throw Yn.create("no-options");let s=hs.get(i);if(s){if(ls(t,s.options)&&ls(r,s.config))return s;throw Yn.create("duplicate-app",{appName:i})}let o=new ds(i);for(let c of yc.values())o.addComponent(c);let a=new Pm(t,r,o);return hs.set(i,a),a}function m9(n,e){if(Sm())throw Yn.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;Bk(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=l=>[...l].reduce((d,h)=>Math.imul(31,d)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Yn.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=_c.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new ds(s);for(let l of yc.values())a.addComponent(l);let c=new PE(t,e,s,a);return _c.set(s,c),c}function od(n=Kr){let e=hs.get(n);if(!e&&n===Kr&&wE())return Mm();if(!e)throw Yn.create("no-app",{appName:n});return e}function g9(){return Array.from(hs.values())}function km(n){return g(this,null,function*(){let e=!1,t=n.name;hs.has(t)?(e=!0,hs.delete(t)):_c.has(t)&&n.decRefCount()<=0&&(_c.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function ft(n,e,t){var r;let i=(r=h9[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Co.warn(a.join(" "));return}hn(new Ve(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function LE(n,e){if(n!==null&&typeof n!="function")throw Yn.create("invalid-log-argument");Ak(n,e)}function FE(n){Dk(n)}var _9="firebase-heartbeat-database",y9=1,sd="firebase-heartbeat-store",RE=null;function jk(){return RE||(RE=Ok(_9,y9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(sd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Yn.create("idb-open",{originalErrorMessage:n.message})})),RE}function v9(n){return g(this,null,function*(){try{let t=(yield jk()).transaction(sd),r=yield t.objectStore(sd).get($k(n));return yield t.done,r}catch(e){if(e instanceof at)Co.warn(e.message);else{let t=Yn.create("idb-get",{originalErrorMessage:e?.message});Co.warn(t.message)}}})}function Lk(n,e){return g(this,null,function*(){try{let r=(yield jk()).transaction(sd,"readwrite");yield r.objectStore(sd).put(e,$k(n)),yield r.done}catch(t){if(t instanceof at)Co.warn(t.message);else{let r=Yn.create("idb-set",{originalErrorMessage:t?.message});Co.warn(r.message)}}})}function $k(n){return`${n.name}!${n.options.appId}`}var w9=1024,I9=30*24*60*60*1e3,ME=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new kE(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return g(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Fk();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=I9}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return g(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Fk(),{heartbeatsToSend:r,unsentEntries:i}=E9(this._heartbeatsCache.heartbeats),s=ed(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function Fk(){return new Date().toISOString().substring(0,10)}function E9(n,e=w9){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Vk(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Vk(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var kE=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return as()?Ik().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield v9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Lk(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Lk(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Vk(n){return ed(JSON.stringify({version:2,heartbeats:n})).length}function T9(n){hn(new Ve("platform-logger",e=>new xE(e),"PRIVATE")),hn(new Ve("heartbeat",e=>new ME(e),"PRIVATE")),ft(Nm,NE,n),ft(Nm,NE,"esm2017"),ft("fire-js","")}T9("");var UE=class{constructor(e,t){this._delegate=e,this.firebase=t,vc(e,new Ve("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),km(this._delegate)))}_getService(e,t=Kr){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=Kr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){vc(this._delegate,e)}_addOrOverwriteComponent(e){OE(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var b9={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Hk=new Qn("app-compat","Firebase",b9);function C9(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:ft,setLogLevel:FE,onLog:LE,apps:null,SDK_VERSION:fn,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:VE}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||Kr,!dn(e,l))throw Hk.create("no-app",{appName:l});return e[l]}i.App=n;function s(l,d={}){let h=Mm(l,d);if(dn(e,h.name))return e[h.name];let p=new n(h,t);return e[h.name]=p,p}function o(){return Object.keys(e).map(l=>e[l])}function a(l){let d=l.name,h=d.replace("-compat","");if(hn(l)&&l.type==="PUBLIC"){let p=(_=i())=>{if(typeof _[h]!="function")throw Hk.create("invalid-app-argument",{appName:d});return _[h]()};l.serviceProps!==void 0&&fc(p,l.serviceProps),t[h]=p,n.prototype[h]=function(..._){return this._getService.bind(this,d).apply(this,l.multipleInstances?_:[])}}return l.type==="PUBLIC"?t[h]:null}function c(l,d){return d==="serverAuth"?null:d}return t}function zk(){let n=C9(UE);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:zk,extendNamespace:e,createSubscribe:Rm,ErrorFactory:Qn,deepExtend:fc});function e(t){fc(n,t)}return n}var S9=zk();var qk=new Sn("@firebase/app-compat"),D9="@firebase/app-compat",A9="0.2.35";function R9(n){ft(D9,A9,n)}if(Sm()&&self.firebase!==void 0){qk.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);let n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&qk.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var X=S9;R9();var No={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var _s={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function x9(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function aO(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var gT=x9,cO=aO,lO=new Qn("auth","Firebase",aO());var Vm=new Sn("@firebase/auth");function N9(n,...e){Vm.logLevel<=ge.WARN&&Vm.warn(`Auth (${fn}): ${n}`,...e)}function Lm(n,...e){Vm.logLevel<=ge.ERROR&&Vm.error(`Auth (${fn}): ${n}`,...e)}function bt(n,...e){throw yT(n,...e)}function Tt(n,...e){return yT(n,...e)}function _T(n,e,t){let r=Object.assign(Object.assign({},cO()),{[e]:t});return new Qn("auth","Firebase",r).create(e,{appName:n.name})}function Ot(n){return _T(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Tc(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&bt(n,"argument-error"),_T(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function yT(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return lO.create(n,...e)}function U(n,e,...t){if(!n)throw yT(e,...t)}function Qr(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Lm(e),new Error(e)}function Jn(n,e){n||Qr(e)}function dd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function vT(){return Gk()==="http:"||Gk()==="https:"}function Gk(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function P9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(vT()||Dm()||"connection"in navigator)?navigator.onLine:!0}function M9(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var So=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Jn(t>e,"Short delay should be less than long delay!"),this.isMobile=nd()||Eo()}get(){return P9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function wT(n,e){Jn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var hd=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Qr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Qr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Qr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var k9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var O9=new So(3e4,6e4);function ct(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function lt(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){return uO(n,i,()=>g(this,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let h=Ai(Object.assign({key:n.config.apiKey},d)).slice(1),p=yield n._getAdditionalHeaders();return p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode),hd.fetch()(dO(n,n.config.apiHost,t,h),Object.assign({method:e,headers:p,referrerPolicy:"no-referrer"},l))}))})}function uO(n,e,t){return g(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},k9),e);try{let i=new qE(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw ad(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw ad(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw ad(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw ad(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw _T(n,d,l);bt(n,d)}}catch(i){if(i instanceof at)throw i;bt(n,"network-request-failed",{message:String(i)})}})}function Ni(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){let l=yield lt(n,e,t,r,i);return"mfaPendingCredential"in l&&bt(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function dO(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?wT(n.config,i):`${n.config.apiScheme}://${i}`}function L9(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var qE=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Tt(this.auth,"network-request-failed")),O9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function ad(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Tt(n,e,r);return i.customData._tokenResponse=t,i}function Wk(n){return n!==void 0&&n.getResponse!==void 0}function Kk(n){return n!==void 0&&n.enterprise!==void 0}var zE=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return L9(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function F9(n){return g(this,null,function*(){return(yield lt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})}function V9(n,e){return g(this,null,function*(){return lt(n,"GET","/v2/recaptchaConfig",ct(n,e))})}function U9(n,e){return g(this,null,function*(){return lt(n,"POST","/v1/accounts:delete",e)})}function B9(n,e){return g(this,null,function*(){return lt(n,"POST","/v1/accounts:update",e)})}function hO(n,e){return g(this,null,function*(){return lt(n,"POST","/v1/accounts:lookup",e)})}function cd(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function fO(n,e=!1){return g(this,null,function*(){let t=q(n),r=yield t.getIdToken(e),i=Qm(r);U(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:cd(BE(i.auth_time)),issuedAtTime:cd(BE(i.iat)),expirationTime:cd(BE(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function BE(n){return Number(n)*1e3}function Qm(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Lm("JWT malformed, contained fewer than 3 sections"),null;try{let i=td(t);return i?JSON.parse(i):(Lm("Failed to decode base64 JWT payload"),null)}catch(i){return Lm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Qk(n){let e=Qm(n);return U(e,"internal-error"),U(typeof e.exp<"u","internal-error"),U(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function xi(n,e,t=!1){return g(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof at&&j9(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function j9({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var GE=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var fd=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=cd(this.lastLoginAt),this.creationTime=cd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function pd(n){return g(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield xi(n,hO(t,{idToken:r}));U(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?mO(s.providerUserInfo):[],a=$9(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,d=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new fd(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,h)})}function pO(n){return g(this,null,function*(){let e=q(n);yield pd(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function $9(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function mO(n){return n.map(e=>{var{providerId:t}=e,r=Af(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function H9(n,e){return g(this,null,function*(){let t=yield uO(n,{},()=>g(this,null,function*(){let r=Ai({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=dO(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",hd.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function q9(n,e){return g(this,null,function*(){return lt(n,"POST","/v2/accounts:revokeToken",ct(n,e))})}var ld=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){U(e.idToken,"internal-error"),U(typeof e.idToken<"u","internal-error"),U(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Qk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){U(e.length!==0,"internal-error");let t=Qk(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return g(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(U(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield H9(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(U(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(U(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(U(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Qr("not implemented")}};function fs(n,e){U(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Do=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Af(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new GE(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new fd(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let t=yield xi(this,this.stsTokenManager.getToken(this.auth,e));return U(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return fO(this,e)}reload(){return pO(this)}_assign(e){this!==e&&(U(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield pd(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(tt(this.auth.app))return Promise.reject(Ot(this.auth));let e=yield this.getIdToken();return yield xi(this,U9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,d;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,w=(o=t.photoURL)!==null&&o!==void 0?o:void 0,b=(a=t.tenantId)!==null&&a!==void 0?a:void 0,S=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,O=(l=t.createdAt)!==null&&l!==void 0?l:void 0,H=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:V,emailVerified:Q,isAnonymous:ae,providerData:J,stsTokenManager:T}=t;U(V&&T,e,"internal-error");let v=ld.fromJSON(this.name,T);U(typeof V=="string",e,"internal-error"),fs(h,e.name),fs(p,e.name),U(typeof Q=="boolean",e,"internal-error"),U(typeof ae=="boolean",e,"internal-error"),fs(_,e.name),fs(w,e.name),fs(b,e.name),fs(S,e.name),fs(O,e.name),fs(H,e.name);let I=new n({uid:V,auth:e,email:p,emailVerified:Q,displayName:h,isAnonymous:ae,photoURL:w,phoneNumber:_,tenantId:b,stsTokenManager:v,createdAt:O,lastLoginAt:H});return J&&Array.isArray(J)&&(I.providerData=J.map(C=>Object.assign({},C))),S&&(I._redirectEventId=S),I}static _fromIdTokenResponse(e,t,r=!1){return g(this,null,function*(){let i=new ld;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield pd(s),s})}static _fromGetAccountInfoResponse(e,t,r){return g(this,null,function*(){let i=t.users[0];U(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?mO(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new ld;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new fd(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var Yk=new Map;function Zt(n){Jn(n instanceof Function,"Expected a class definition");let e=Yk.get(n);return e?(Jn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Yk.set(n,e),e)}var z9=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(t,r){return g(this,null,function*(){this.storage[t]=r})}_get(t){return g(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return g(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),ms=z9;function Yr(n,e,t){return`firebase:${n}:${e}:${t}`}var Um=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Yr(this.userKey,i.apiKey,s),this.fullPersistenceKey=Yr("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Do._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return g(this,null,function*(){if(!t.length)return new n(Zt(ms),e,r);let i=(yield Promise.all(t.map(l=>g(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||Zt(ms),o=Yr(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let d=yield l._get(o);if(d){let h=Do._fromJSON(e,d);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>g(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,r))})}};function Jk(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(yO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(vO(e))return"Blackberry";if(wO(e))return"Webos";if(IT(e))return"Safari";if((e.includes("chrome/")||_O(e))&&!e.includes("edge/"))return"Chrome";if(bc(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function gO(n=je()){return/firefox\//i.test(n)}function IT(n=je()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _O(n=je()){return/crios\//i.test(n)}function yO(n=je()){return/iemobile/i.test(n)}function bc(n=je()){return/android/i.test(n)}function vO(n=je()){return/blackberry/i.test(n)}function wO(n=je()){return/webos/i.test(n)}function Po(n=je()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function IO(n=je()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function G9(n=je()){var e;return Po(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function W9(){return Am()&&document.documentMode===10}function EO(n=je()){return Po(n)||bc(n)||wO(n)||vO(n)||/windows phone/i.test(n)||yO(n)}function K9(){try{return!!(window&&window!==window.top)}catch{return!1}}function ET(n,e=[]){let t;switch(n){case"Browser":t=Jk(je());break;case"Worker":t=`${Jk(je())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${fn}/${r}`}var WE=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function Q9(t){return g(this,arguments,function*(n,e={}){return lt(n,"GET","/v2/passwordPolicy",ct(n,e))})}var Y9=6,KE=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:Y9,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Bm=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jm(this),this.idTokenSubscription=new jm(this),this.beforeStateQueue=new WE(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=lO,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Zt(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Um.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let t=yield hO(this,{idToken:e}),r=yield Do._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var t;if(tt(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return U(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield pd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=M9()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(tt(this.app))return Promise.reject(Ot(this));let t=e?q(e):null;return t&&U(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&U(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return tt(this.app)?Promise.reject(Ot(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return tt(this.app)?Promise.reject(Ot(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(Zt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield Q9(this),t=new KE(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Qn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield q9(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Zt(e)||this._popupRedirectResolver;U(t,this,"argument-error"),this.redirectPersistenceManager=yield Um.create(this,[Zt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(U(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ET(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return g(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&N9(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Qe(n){return q(n)}var jm=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Rm(t=>this.observer=t)}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var bd={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function J9(n){bd=n}function TT(n){return bd.loadJS(n)}function X9(){return bd.recaptchaV2Script}function Z9(){return bd.recaptchaEnterpriseScript}function e6(){return bd.gapiScript}function TO(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var t6="recaptcha-enterprise",n6="NO_RECAPTCHA",QE=class{constructor(e){this.type=t6,this.auth=Qe(e)}verify(e="verify",t=!1){return g(this,null,function*(){function r(s){return g(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>g(this,null,function*(){V9(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let l=new zE(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;Kk(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(n6)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&Kk(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Z9();c.length!==0&&(c+=a),TT(c).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})})}};function Xk(n,e,t,r=!1){return g(this,null,function*(){let i=new QE(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function md(n,e,t,r){return g(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield Xk(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>g(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield Xk(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function r6(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Zt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function bT(n,e,t){let r=Qe(n);U(r._canInitEmulator,r,"emulator-config-failed"),U(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=bO(e),{host:o,port:a}=i6(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||s6()}function bO(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function i6(n){let e=bO(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:Zk(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:Zk(o)}}}function Zk(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function s6(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Jr=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Qr("not implemented")}_getIdTokenResponse(e){return Qr("not implemented")}_linkToIdToken(e,t){return Qr("not implemented")}_getReauthenticationResolver(e){return Qr("not implemented")}};function CO(n,e){return g(this,null,function*(){return lt(n,"POST","/v1/accounts:resetPassword",ct(n,e))})}function o6(n,e){return g(this,null,function*(){return lt(n,"POST","/v1/accounts:update",e)})}function a6(n,e){return g(this,null,function*(){return lt(n,"POST","/v1/accounts:signUp",e)})}function c6(n,e){return g(this,null,function*(){return lt(n,"POST","/v1/accounts:update",ct(n,e))})}function l6(n,e){return g(this,null,function*(){return Ni(n,"POST","/v1/accounts:signInWithPassword",ct(n,e))})}function Ym(n,e){return g(this,null,function*(){return lt(n,"POST","/v1/accounts:sendOobCode",ct(n,e))})}function u6(n,e){return g(this,null,function*(){return Ym(n,e)})}function d6(n,e){return g(this,null,function*(){return Ym(n,e)})}function h6(n,e){return g(this,null,function*(){return Ym(n,e)})}function f6(n,e){return g(this,null,function*(){return Ym(n,e)})}function p6(n,e){return g(this,null,function*(){return Ni(n,"POST","/v1/accounts:signInWithEmailLink",ct(n,e))})}function m6(n,e){return g(this,null,function*(){return Ni(n,"POST","/v1/accounts:signInWithEmailLink",ct(n,e))})}var gd=class n extends Jr{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return g(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return md(e,t,"signInWithPassword",l6);case"emailLink":return p6(e,{email:this._email,oobCode:this._password});default:bt(e,"internal-error")}})}_linkToIdToken(e,t){return g(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return md(e,r,"signUpPassword",a6);case"emailLink":return m6(e,{idToken:t,email:this._email,oobCode:this._password});default:bt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Ri(n,e){return g(this,null,function*(){return Ni(n,"POST","/v1/accounts:signInWithIdp",ct(n,e))})}var g6="http://localhost",yr=class n extends Jr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):bt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Af(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return Ri(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Ri(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Ri(e,t)}buildRequest(){let e={requestUri:g6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ai(t)}return e}};function _6(n,e){return g(this,null,function*(){return lt(n,"POST","/v1/accounts:sendVerificationCode",ct(n,e))})}function y6(n,e){return g(this,null,function*(){return Ni(n,"POST","/v1/accounts:signInWithPhoneNumber",ct(n,e))})}function v6(n,e){return g(this,null,function*(){let t=yield Ni(n,"POST","/v1/accounts:signInWithPhoneNumber",ct(n,e));if(t.temporaryProof)throw ad(n,"account-exists-with-different-credential",t);return t})}var w6={USER_NOT_FOUND:"user-not-found"};function I6(n,e){return g(this,null,function*(){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Ni(n,"POST","/v1/accounts:signInWithPhoneNumber",ct(n,t),w6)})}var Ic=class n extends Jr{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return y6(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return v6(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return I6(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function E6(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function T6(n){let e=us(gc(n)).link,t=e?us(gc(e)).deep_link_id:null,r=us(gc(n)).deep_link_id;return(r?us(gc(r)).link:null)||r||t||e||n}var _d=class n{constructor(e){var t,r,i,s,o,a;let c=us(gc(e)),l=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=E6((i=c.mode)!==null&&i!==void 0?i:null);U(l&&d&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=T6(e);try{return new n(t)}catch{return null}}};var Cd=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return gd._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=_d.parseLink(r);return U(i,"argument-error"),gd._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),vr=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var gs=class extends vr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},Ec=class n extends gs{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return U("providerId"in t&&"signInMethod"in t,"argument-error"),yr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return U(e.idToken||e.accessToken,"argument-error"),yr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var Jm=(()=>{class n extends gs{constructor(){super("facebook.com")}static credential(t){return yr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.FACEBOOK_SIGN_IN_METHOD="facebook.com",n.PROVIDER_ID="facebook.com";return n})(),Xm=(()=>{class n extends gs{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return yr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})(),Zm=(()=>{class n extends gs{constructor(){super("github.com")}static credential(t){return yr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.GITHUB_SIGN_IN_METHOD="github.com",n.PROVIDER_ID="github.com";return n})(),b6="http://localhost",Ao=class n extends Jr{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return Ri(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Ri(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Ri(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:b6,returnSecureToken:!0,pendingToken:this.pendingToken}}};var C6="saml.",yd=class n extends vr{constructor(e){U(e.startsWith(C6),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=Ao.fromJSON(e);return U(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Ao._create(r,t)}catch{return null}}};var eg=(()=>{class n extends gs{constructor(){super("twitter.com")}static credential(t,r){return yr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return n.credential(r,i)}catch{return null}}}n.TWITTER_SIGN_IN_METHOD="twitter.com",n.PROVIDER_ID="twitter.com";return n})();function SO(n,e){return g(this,null,function*(){return Ni(n,"POST","/v1/accounts:signUp",ct(n,e))})}var wr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return g(this,null,function*(){let s=yield Do._fromIdTokenResponse(e,r,i),o=eO(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return g(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=eO(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function eO(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function CT(n){return g(this,null,function*(){var e;if(tt(n.app))return Promise.reject(Ot(n));let t=Qe(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new wr({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield SO(t,{returnSecureToken:!0}),i=yield wr._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var YE=class n extends at{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function DO(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?YE._fromErrorAndOperation(n,s,e,r):s})}function AO(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}function ST(n,e){return g(this,null,function*(){let t=q(n);yield tg(!0,t,e);let{providerUserInfo:r}=yield B9(t.auth,{idToken:yield t.getIdToken(),deleteProvider:[e]}),i=AO(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),yield t.auth._persistUserIfCurrent(t),t})}function DT(n,e,t=!1){return g(this,null,function*(){let r=yield xi(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return wr._forOperation(n,"link",r)})}function tg(n,e,t){return g(this,null,function*(){yield pd(e);let r=AO(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";U(r.has(t)===n,e.auth,i)})}function RO(n,e,t=!1){return g(this,null,function*(){let{auth:r}=n;if(tt(r.app))return Promise.reject(Ot(r));let i="reauthenticate";try{let s=yield xi(n,DO(r,i,e,n),t);U(s.idToken,r,"internal-error");let o=Qm(s.idToken);U(o,r,"internal-error");let{sub:a}=o;return U(n.uid===a,r,"user-mismatch"),wr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&bt(r,"user-mismatch"),s}})}function xO(n,e,t=!1){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r="signIn",i=yield DO(n,r,e),s=yield wr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Cc(n,e){return g(this,null,function*(){return xO(Qe(n),e)})}function ng(n,e){return g(this,null,function*(){let t=q(n);return yield tg(!1,t,e.providerId),DT(t,e)})}function rg(n,e){return g(this,null,function*(){return RO(q(n),e)})}function S6(n,e){return g(this,null,function*(){return Ni(n,"POST","/v1/accounts:signInWithCustomToken",ct(n,e))})}function AT(n,e){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let t=Qe(n),r=yield S6(t,{token:e,returnSecureToken:!0}),i=yield wr._fromIdTokenResponse(t,"signIn",r);return yield t._updateCurrentUser(i.user),i})}var Ro=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?JE._fromServerResponse(e,t):"totpInfo"in t?XE._fromServerResponse(e,t):bt(e,"internal-error")}},JE=class n extends Ro{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},XE=class n extends Ro{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function ig(n,e,t){var r;U(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),U(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(U(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(U(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function RT(n){return g(this,null,function*(){let e=Qe(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function xT(n,e,t){return g(this,null,function*(){let r=Qe(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&ig(r,i,t),yield md(r,i,"getOobCode",d6)})}function NT(n,e,t){return g(this,null,function*(){yield CO(q(n),{oobCode:e,newPassword:t}).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&RT(n),r}))})}function PT(n,e){return g(this,null,function*(){yield c6(q(n),{oobCode:e})})}function sg(n,e){return g(this,null,function*(){let t=q(n),r=yield CO(t,{oobCode:e}),i=r.requestType;switch(U(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":U(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":U(r.mfaInfo,t,"internal-error");default:U(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=Ro._fromServerResponse(Qe(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}})}function MT(n,e){return g(this,null,function*(){let{data:t}=yield sg(q(n),e);return t.email})}function kT(n,e,t){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r=Qe(n),o=yield md(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",SO).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&RT(n),c}),a=yield wr._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function OT(n,e,t){return tt(n.app)?Promise.reject(Ot(n)):Cc(q(n),Cd.credential(e,t)).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&RT(n),r}))}function LT(n,e,t){return g(this,null,function*(){let r=Qe(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){U(a.handleCodeInApp,r,"argument-error"),a&&ig(r,o,a)}s(i,t),yield md(r,i,"getOobCode",h6)})}function FT(n,e){let t=_d.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}function VT(n,e,t){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r=q(n),i=Cd.credentialWithLink(e,t||dd());return U(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Cc(r,i)})}function D6(n,e){return g(this,null,function*(){return lt(n,"POST","/v1/accounts:createAuthUri",ct(n,e))})}function UT(n,e){return g(this,null,function*(){let t=vT()?dd():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=yield D6(q(n),r);return i||[]})}function BT(n,e){return g(this,null,function*(){let t=q(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&ig(t.auth,i,e);let{email:s}=yield u6(t.auth,i);s!==n.email&&(yield n.reload())})}function jT(n,e,t){return g(this,null,function*(){let r=q(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield n.getIdToken(),newEmail:e};t&&ig(r.auth,s,t);let{email:o}=yield f6(r.auth,s);o!==n.email&&(yield n.reload())})}function A6(n,e){return g(this,null,function*(){return lt(n,"POST","/v1/accounts:update",e)})}function $T(r,i){return g(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=q(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield xi(s,A6(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let l=s.providerData.find(({providerId:d})=>d==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function HT(n,e){let t=q(n);return tt(t.auth.app)?Promise.reject(Ot(t.auth)):NO(t,e,null)}function qT(n,e){return NO(q(n),null,e)}function NO(n,e,t){return g(this,null,function*(){let{auth:r}=n,s={idToken:yield n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=yield xi(n,o6(r,s));yield n._updateTokensIfNecessary(o,!0)})}function R6(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=Qm(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new ps(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new ZE(s,i);case"github.com":return new eT(s,i);case"google.com":return new tT(s,i);case"twitter.com":return new nT(s,i,n.screenName||null);case"custom":case"anonymous":return new ps(s,null);default:return new ps(s,r,i)}}var ps=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},$m=class extends ps{constructor(e,t,r,i){super(e,t,r),this.username=i}},ZE=class extends ps{constructor(e,t){super(e,"facebook.com",t)}},eT=class extends $m{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},tT=class extends ps{constructor(e,t){super(e,"google.com",t)}},nT=class extends $m{constructor(e,t,r){super(e,"twitter.com",t,r)}};function zT(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:R6(t)}var Hm=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var rT=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=Qe(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>Ro._fromServerResponse(r,a));U(i.mfaPendingCredential,r,"internal-error");let o=Hm._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,a=>g(this,null,function*(){let c=yield a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let l=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let d=yield wr._fromIdTokenResponse(r,t.operationType,l);return yield r._updateCurrentUser(d.user),d;case"reauthenticate":return U(t.user,r,"internal-error"),wr._forOperation(t.user,t.operationType,l);default:bt(r,"internal-error")}}))}resolveSignIn(e){return g(this,null,function*(){let t=e;return this.signInResolver(t)})}};function GT(n,e){var t;let r=q(n),i=e;return U(e.customData.operationType,r,"argument-error"),U((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),rT._fromError(r,i)}function x6(n,e){return lt(n,"POST","/v2/accounts/mfaEnrollment:start",ct(n,e))}function N6(n,e){return lt(n,"POST","/v2/accounts/mfaEnrollment:finalize",ct(n,e))}function P6(n,e){return lt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",ct(n,e))}var iT=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Ro._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}getSession(){return g(this,null,function*(){return Hm._fromIdtoken(yield this.user.getIdToken(),this.user)})}enroll(e,t){return g(this,null,function*(){let r=e,i=yield this.getSession(),s=yield xi(this.user,r._process(this.user.auth,i,t));return yield this.user._updateTokensIfNecessary(s),this.user.reload()})}unenroll(e){return g(this,null,function*(){let t=typeof e=="string"?e:e.uid,r=yield this.user.getIdToken();try{let i=yield xi(this.user,P6(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),yield this.user._updateTokensIfNecessary(i),yield this.user.reload()}catch(i){throw i}})}},jE=new WeakMap;function WT(n){let e=q(n);return jE.has(e)||jE.set(e,iT._fromUser(e)),jE.get(e)}var qm="__sak";var zm=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(qm,"1"),this.storage.removeItem(qm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function M6(){let n=je();return IT(n)||Po(n)}var k6=1e3,O6=10,L6=(()=>{class n extends zm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=M6()&&K9(),this.fallbackToPolling=EO(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(i);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);W9()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,O6):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},k6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return g(this,null,function*(){yield Ar(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return g(this,null,function*(){let r=yield Ar(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return g(this,null,function*(){yield Ar(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Sc=L6;var F6=(()=>{class n extends zm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Xr=F6;function V6(n){return Promise.all(n.map(e=>g(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var U6=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return g(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>g(this,null,function*(){return d(r.origin,o)})),l=yield V6(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Mo(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var sT=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return g(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=Mo("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let p=h;if(p.data.eventId===l)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function Et(){return window}function B6(n){Et().location.href=n}function KT(){return typeof Et().WorkerGlobalScope<"u"&&typeof Et().importScripts=="function"}function j6(){return g(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function $6(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function H6(){return KT()?self:null}var PO="firebaseLocalStorageDb",q6=1,Gm="firebaseLocalStorage",MO="fbase_key",xo=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function og(n,e){return n.transaction([Gm],e?"readwrite":"readonly").objectStore(Gm)}function z6(){let n=indexedDB.deleteDatabase(PO);return new xo(n).toPromise()}function oT(){let n=indexedDB.open(PO,q6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Gm,{keyPath:MO})}catch(i){t(i)}}),n.addEventListener("success",()=>g(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Gm)?e(r):(r.close(),yield z6(),e(yield oT()))}))})}function tO(n,e,t){return g(this,null,function*(){let r=og(n,!0).put({[MO]:e,value:t});return new xo(r).toPromise()})}function G6(n,e){return g(this,null,function*(){let t=og(n,!1).get(e),r=yield new xo(t).toPromise();return r===void 0?null:r.value})}function nO(n,e){let t=og(n,!0).delete(e);return new xo(t).toPromise()}var W6=800,K6=3,Q6=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db?this.db:(this.db=yield oT(),this.db)})}_withRetries(t){return g(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>K6)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return KT()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=U6._getInstance(H6()),this.receiver._subscribe("keyChanged",(t,r)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var t,r;if(this.activeServiceWorker=yield j6(),!this.activeServiceWorker)return;this.sender=new sT(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return g(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||$6()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;let t=yield oT();return yield tO(t,qm,"1"),yield nO(t,qm),!0}catch{}return!1})}_withPendingWrite(t){return g(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(i=>tO(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return g(this,null,function*(){let r=yield this._withRetries(i=>G6(i,t));return this.localCache[t]=r,r})}_remove(t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(r=>nO(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return g(this,null,function*(){let t=yield this._withRetries(s=>{let o=og(s,!1).getAll();return new xo(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),W6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),ko=Q6;function Y6(n,e){return lt(n,"POST","/v2/accounts/mfaSignIn:start",ct(n,e))}function J6(n,e){return lt(n,"POST","/v2/accounts/mfaSignIn:finalize",ct(n,e))}var X6=500,Z6=6e4,Om=1e12,aT=class{constructor(e){this.auth=e,this.counter=Om,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new cT(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||Om;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||Om;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}execute(e){return g(this,null,function*(){var t;let r=e||Om;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""})}},cT=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;U(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=e5(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},Z6)},X6))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function e5(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var $E=TO("rcb"),t5=new So(3e4,6e4),lT=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Et().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return U(n5(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Wk(Et().grecaptcha)?Promise.resolve(Et().grecaptcha):new Promise((r,i)=>{let s=Et().setTimeout(()=>{i(Tt(e,"network-request-failed"))},t5.get());Et()[$E]=()=>{Et().clearTimeout(s),delete Et()[$E];let a=Et().grecaptcha;if(!a||!Wk(a)){i(Tt(e,"internal-error"));return}let c=a.render;a.render=(l,d)=>{let h=c(l,d);return this.counter++,h},this.hostLanguage=t,r(a)};let o=`${X9()}?${Ai({onload:$E,render:"explicit",hl:t})}`;TT(o).catch(()=>{clearTimeout(s),i(Tt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=Et().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function n5(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var uT=class{load(e){return g(this,null,function*(){return new aT(e)})}clearedOneInstance(){}};var kO="recaptcha",r5={theme:"light",type:"image"},vd=class{constructor(e,t,r=Object.assign({},r5)){this.parameters=r,this.type=kO,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Qe(e),this.isInvisible=this.parameters.size==="invisible",U(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;U(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new uT:new lT,this.validateStartingState()}verify(){return g(this,null,function*(){this.assertNotDestroyed();let e=yield this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){U(!this.parameters.sitekey,this.auth,"argument-error"),U(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),U(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=Et()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){U(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){return g(this,null,function*(){if(yield this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId})}init(){return g(this,null,function*(){U(vT()&&!KT(),this.auth,"internal-error"),yield i5(),this.recaptcha=yield this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=yield F9(this.auth);U(e,this.auth,"internal-error"),this.parameters.sitekey=e})}getAssertedRecaptcha(){return U(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function i5(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var wd=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=Ic._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};function QT(n,e,t){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r=Qe(n),i=yield ag(r,e,q(t));return new wd(i,s=>Cc(r,s))})}function YT(n,e,t){return g(this,null,function*(){let r=q(n);yield tg(!1,r,"phone");let i=yield ag(r.auth,e,q(t));return new wd(i,s=>ng(r,s))})}function JT(n,e,t){return g(this,null,function*(){let r=q(n);if(tt(r.auth.app))return Promise.reject(Ot(r.auth));let i=yield ag(r.auth,e,q(t));return new wd(i,s=>rg(r,s))})}function ag(n,e,t){return g(this,null,function*(){var r;let i=yield t.verify();try{U(typeof i=="string",n,"argument-error"),U(t.type===kO,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return U(o.type==="enroll",n,"internal-error"),(yield x6(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{U(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return U(a,n,"missing-multi-factor-info"),(yield Y6(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=yield _6(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}})}function XT(n,e){return g(this,null,function*(){let t=q(n);if(tt(t.auth.app))return Promise.reject(Ot(t.auth));yield DT(t,e)})}var Oo=(()=>{class n{constructor(t){this.providerId=n.PROVIDER_ID,this.auth=Qe(t)}verifyPhoneNumber(t,r){return ag(this.auth,t,q(r))}static credential(t,r){return Ic._fromVerification(t,r)}static credentialFromResult(t){let r=t;return n.credentialFromTaggedObject(r)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{phoneNumber:r,temporaryProof:i}=t;return r&&i?Ic._fromTokenResponse(r,i):null}}n.PROVIDER_ID="phone",n.PHONE_SIGN_IN_METHOD="phone";return n})();function Lo(n,e){return e?Zt(e):(U(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Id=class extends Jr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ri(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ri(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ri(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function s5(n){return xO(n.auth,new Id(n),n.bypassAuthState)}function o5(n){let{auth:e,user:t}=n;return U(t,e,"internal-error"),RO(t,new Id(n),n.bypassAuthState)}function a5(n){return g(this,null,function*(){let{auth:e,user:t}=n;return U(t,e,"internal-error"),DT(t,new Id(n),n.bypassAuthState)})}var Wm=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return g(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return s5;case"linkViaPopup":case"linkViaRedirect":return a5;case"reauthViaPopup":case"reauthViaRedirect":return o5;default:bt(this.auth,"internal-error")}}resolve(e){Jn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Jn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var c5=new So(2e3,1e4);function ZT(n,e,t){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Tt(n,"operation-not-supported-in-this-environment"));let r=Qe(n);Tc(n,e,vr);let i=Lo(r,t);return new nb(r,"signInViaPopup",e,i).executeNotNull()})}function eb(n,e,t){return g(this,null,function*(){let r=q(n);if(tt(r.auth.app))return Promise.reject(Tt(r.auth,"operation-not-supported-in-this-environment"));Tc(r.auth,e,vr);let i=Lo(r.auth,t);return new nb(r.auth,"reauthViaPopup",e,i,r).executeNotNull()})}function tb(n,e,t){return g(this,null,function*(){let r=q(n);Tc(r.auth,e,vr);let i=Lo(r.auth,t);return new nb(r.auth,"linkViaPopup",e,i,r).executeNotNull()})}var nb=(()=>{class n extends Wm{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return g(this,null,function*(){let t=yield this.execute();return U(t,this.auth,"internal-error"),t})}onExecution(){return g(this,null,function*(){Jn(this.filter.length===1,"Popup operations only handle one event");let t=Mo();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Tt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Tt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Tt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,c5.get())};t()}}n.currentPopupAction=null;return n})(),l5="pendingRedirect",ud=new Map,dT=class n extends Wm{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return g(this,null,function*(){let e=ud.get(this.auth._key());if(!e){try{let r=(yield u5(this.resolver,this.auth))?yield Ar(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}ud.set(this.auth._key(),e)}return this.bypassAuthState||ud.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if(e.type==="signInViaRedirect")return Ar(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Ar(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return g(this,null,function*(){})}cleanUp(){}};function u5(n,e){return g(this,null,function*(){let t=FO(e),r=LO(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function rb(n,e){return g(this,null,function*(){return LO(n)._set(FO(e),"true")})}function OO(){ud.clear()}function Dc(n,e){ud.set(n._key(),e)}function LO(n){return Zt(n._redirectPersistence)}function FO(n){return Yr(l5,n.config.apiKey,n.name)}function ib(n,e,t){return d5(n,e,t)}function d5(n,e,t){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r=Qe(n);Tc(n,e,vr),yield r._initializationPromise;let i=Lo(r,t);return yield rb(i,r),i._openRedirect(r,e,"signInViaRedirect")})}function sb(n,e,t){return h5(n,e,t)}function h5(n,e,t){return g(this,null,function*(){let r=q(n);if(Tc(r.auth,e,vr),tt(r.auth.app))return Promise.reject(Ot(r.auth));yield r.auth._initializationPromise;let i=Lo(r.auth,t);yield rb(i,r.auth);let s=yield VO(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)})}function ob(n,e,t){return f5(n,e,t)}function f5(n,e,t){return g(this,null,function*(){let r=q(n);Tc(r.auth,e,vr),yield r.auth._initializationPromise;let i=Lo(r.auth,t);yield tg(!1,r,e.providerId),yield rb(i,r.auth);let s=yield VO(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)})}function ab(n,e){return g(this,null,function*(){return yield Qe(n)._initializationPromise,Fo(n,e,!1)})}function Fo(n,e,t=!1){return g(this,null,function*(){if(tt(n.app))return Promise.reject(Ot(n));let r=Qe(n),i=Lo(r,e),o=yield new dT(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}function VO(n){return g(this,null,function*(){let e=Mo(`${n.uid}:::`);return n._redirectEventId=e,yield n.auth._setRedirectUser(n),yield n.auth._persistUserIfCurrent(n),e})}var p5=10*60*1e3,Ed=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!m5(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!UO(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Tt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=p5&&this.cachedEventUids.clear(),this.cachedEventUids.has(rO(e))}saveEventToCache(e){this.cachedEventUids.add(rO(e)),this.lastProcessedEventTime=Date.now()}};function rO(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function UO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function m5(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return UO(n);default:return!1}}function cb(t){return g(this,arguments,function*(n,e={}){return lt(n,"GET","/v1/projects",e)})}var g5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_5=/^https?/;function y5(n){return g(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield cb(n);for(let t of e)try{if(v5(t))return}catch{}bt(n,"unauthorized-domain")})}function v5(n){let e=dd(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!_5.test(t))return!1;if(g5.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var w5=new So(3e4,6e4);function iO(){let n=Et().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function I5(n){return new Promise((e,t)=>{var r,i,s;function o(){iO(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iO(),t(Tt(n,"network-request-failed"))},timeout:w5.get()})}if(!((i=(r=Et().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Et().gapi)===null||s===void 0)&&s.load)o();else{let a=TO("iframefcb");return Et()[a]=()=>{gapi.load?o():t(Tt(n,"network-request-failed"))},TT(`${e6()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Fm=null,e})}var Fm=null;function E5(n){return Fm=Fm||I5(n),Fm}var T5=new So(5e3,15e3),b5="__/auth/iframe",C5="emulator/auth/iframe",S5={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},D5=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function A5(n){let e=n.config;U(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?wT(e,C5):`https://${n.config.authDomain}/${b5}`,r={apiKey:e.apiKey,appName:n.name,v:fn},i=D5.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Ai(r).slice(1)}`}function R5(n){return g(this,null,function*(){let e=yield E5(n),t=Et().gapi;return U(t,n,"internal-error"),e.open({where:document.body,url:A5(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:S5,dontclear:!0},r=>new Promise((i,s)=>g(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=Tt(n,"network-request-failed"),a=Et().setTimeout(()=>{s(o)},T5.get());function c(){Et().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var x5={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},N5=500,P5=600,M5="_blank",k5="http://localhost",Td=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function O5(n,e,t,r=N5,i=P5){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},x5),{width:r.toString(),height:i.toString(),top:s,left:o}),l=je().toLowerCase();t&&(a=_O(l)?M5:t),gO(l)&&(e=e||k5,c.scrollbars="yes");let d=Object.entries(c).reduce((p,[_,w])=>`${p}${_}=${w},`,"");if(G9(l)&&a!=="_self")return L5(e||"",a),new Td(null);let h=window.open(e||"",a,d);U(h,n,"popup-blocked");try{h.focus()}catch{}return new Td(h)}function L5(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var F5="__/auth/handler",V5="emulator/auth/handler",U5=encodeURIComponent("fac");function Km(n,e,t,r,i,s){return g(this,null,function*(){U(n.config.authDomain,n,"auth-domain-config-required"),U(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:fn,eventId:i};if(e instanceof vr){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",mc(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(s||{}))o[d]=h}if(e instanceof gs){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),l=c?`#${U5}=${encodeURIComponent(c)}`:"";return`${B5(n)}?${Ai(a).slice(1)}${l}`})}function B5({config:n}){return n.emulator?wT(n,V5):`https://${n.authDomain}/${F5}`}var HE="webStorageSupport",hT=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xr,this._completeRedirectFn=Fo,this._overrideRedirectResult=Dc}_openPopup(e,t,r,i){return g(this,null,function*(){var s;Jn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield Km(e,t,r,dd(),i);return O5(e,o,Mo())})}_openRedirect(e,t,r,i){return g(this,null,function*(){yield this._originValidation(e);let s=yield Km(e,t,r,dd(),i);return B6(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Jn(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return g(this,null,function*(){let t=yield R5(e),r=new Ed(e);return t.register("authEvent",i=>(U(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(HE,{type:HE},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[HE];o!==void 0&&t(!!o),bt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=y5(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return EO()||IT()||Po()}},lb=hT,fT=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Qr("unexpected MultiFactorSessionType")}}},pT=class n extends fT{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return N6(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return J6(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},ub=(()=>{class n{constructor(){}static assertion(t){return pT._fromCredential(t)}}return n.FACTOR_ID="phone",n})();var sO="@firebase/auth",oO="1.7.4";var mT=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function j5(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function $5(n){hn(new Ve("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;U(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ET(n)},l=new Bm(r,i,s,c);return r6(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),hn(new Ve("auth-internal",e=>{let t=Qe(e.getProvider("auth").getImmediate());return(r=>new mT(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ft(sO,oO,j5(n)),ft(sO,oO,"esm2017")}var H5=5*60,voe=wk("authIdTokenMaxAge")||H5;function q5(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}J9({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Tt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",q5().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});$5("Browser");function Vo(){return window}var z5=2e3;function G5(n,e,t){return g(this,null,function*(){var r;let{BuildInfo:i}=Vo();Jn(e.sessionId,"AuthEvent did not contain a session ID");let s=yield J5(e.sessionId),o={};return Po()?o.ibi=i.packageName:bc()?o.apn=i.packageName:bt(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,Km(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)})}function W5(n){return g(this,null,function*(){let{BuildInfo:e}=Vo(),t={};Po()?t.iosBundleId=e.packageName:bc()?t.androidPackageName=e.packageName:bt(n,"operation-not-supported-in-this-environment"),yield cb(n,t)})}function K5(n){let{cordova:e}=Vo();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,IO()?"_blank":"_system","location=yes"),t(i)})})}function Q5(n,e,t){return g(this,null,function*(){let{cordova:r}=Vo(),i=()=>{};try{yield new Promise((s,o)=>{let a=null;function c(){var h;s();let p=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof p=="function"&&p(),typeof t?.close=="function"&&t.close()}function l(){a||(a=window.setTimeout(()=>{o(Tt(n,"redirect-cancelled-by-user"))},z5))}function d(){document?.visibilityState==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),bc()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}})}function Y5(n){var e,t,r,i,s,o,a,c,l,d;let h=Vo();U(typeof((e=h?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),U(typeof((t=h?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),U(typeof((s=(i=(r=h?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U(typeof((c=(a=(o=h?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U(typeof((d=(l=h?.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function J5(n){return g(this,null,function*(){let e=X5(n),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")})}function X5(n){if(Jn(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var Z5=20,db=class extends Ed{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}initialized(){return g(this,null,function*(){yield this.initPromise})}};function e8(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:r8(),postBody:null,tenantId:n.tenantId,error:Tt(n,"no-auth-event")}}function t8(n,e){return hb()._set(fb(n),e)}function BO(n){return g(this,null,function*(){let e=yield hb()._get(fb(n));return e&&(yield hb()._remove(fb(n))),e})}function n8(n,e){var t,r;let i=s8(e);if(i.includes("/__/auth/callback")){let s=cg(i),o=s.firebaseError?i8(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?Tt(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function r8(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<Z5;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function hb(){return Zt(Sc)}function fb(n){return Yr("authEvent",n.config.apiKey,n.name)}function i8(n){try{return JSON.parse(n)}catch{return null}}function s8(n){let e=cg(n),t=e.link?decodeURIComponent(e.link):void 0,r=cg(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return cg(i).link||i||r||t||n}function cg(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return us(t.join("?"))}var o8=500,pb=class{constructor(){this._redirectPersistence=Xr,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Fo,this._overrideRedirectResult=Dc}_initialize(e){return g(this,null,function*(){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new db(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r})}_openPopup(e){bt(e,"operation-not-supported-in-this-environment")}_openRedirect(e,t,r,i){return g(this,null,function*(){Y5(e);let s=yield this._initialize(e);yield s.initialized(),s.resetRedirect(),OO(),yield this._originValidation(e);let o=e8(e,r,i);yield t8(e,o);let a=yield G5(e,o,t),c=yield K5(a);return Q5(e,s,c)})}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=W5(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Vo(),o=setTimeout(()=>g(this,null,function*(){yield BO(e),t.onEvent(jO())}),o8),a=d=>g(this,null,function*(){clearTimeout(o);let h=yield BO(e),p=null;h&&d?.url&&(p=n8(h,d.url)),t.onEvent(p||jO())});typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,l=`${s.packageName.toLowerCase()}://`;Vo().handleOpenURL=d=>g(this,null,function*(){if(d.toLowerCase().startsWith(l)&&a({url:d}),typeof c=="function")try{c(d)}catch(h){console.error(h)}})}},$O=pb;function jO(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Tt("no-auth-event")}}function HO(n,e){Qe(n)._logFramework(e)}var c8="@firebase/auth-compat",l8="0.5.9";var u8=1e3;function Ad(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function d8(){return Ad()==="http:"||Ad()==="https:"}function GO(n=je()){return!!((Ad()==="file:"||Ad()==="ionic:"||Ad()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function h8(){return Eo()||Cm()}function f8(){return Am()&&document?.documentMode===11}function p8(n=je()){return/Edge\/\d+/.test(n)}function m8(n=je()){return f8()||p8(n)}function WO(){try{let n=self.localStorage,e=Mo();if(n)return n.setItem(e,"1"),n.removeItem(e),m8()?as():!0}catch{return wb()&&as()}return!1}function wb(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function mb(){return(d8()||Dm()||GO())&&!h8()&&WO()&&!wb()}function KO(){return GO()&&typeof document<"u"}function g8(){return g(this,null,function*(){return KO()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},u8);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1})}function _8(){return typeof window<"u"?window:null}var kn={LOCAL:"local",NONE:"none",SESSION:"session"},Sd=U,QO="persistence";function y8(n,e){if(Sd(Object.values(kn).includes(e),n,"invalid-persistence-type"),Eo()){Sd(e!==kn.SESSION,n,"unsupported-persistence-type");return}if(Cm()){Sd(e===kn.NONE,n,"unsupported-persistence-type");return}if(wb()){Sd(e===kn.NONE||e===kn.LOCAL&&as(),n,"unsupported-persistence-type");return}Sd(e===kn.NONE||WO(),n,"unsupported-persistence-type")}function gb(n){return g(this,null,function*(){yield n._initializationPromise;let e=YO(),t=Yr(QO,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())})}function v8(n,e){let t=YO();if(!t)return[];let r=Yr(QO,n,e);switch(t.getItem(r)){case kn.NONE:return[ms];case kn.LOCAL:return[ko,Xr];case kn.SESSION:return[Xr];default:return[]}}function YO(){var n;try{return((n=_8())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var w8=U,Zr=class{constructor(){this.browserResolver=Zt(lb),this.cordovaResolver=Zt($O),this.underlyingResolver=null,this._redirectPersistence=Xr,this._completeRedirectFn=Fo,this._overrideRedirectResult=Dc}_initialize(e){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)})}_openPopup(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)})}_openRedirect(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)})}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return KO()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return w8(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){return g(this,null,function*(){if(this.underlyingResolver)return;let e=yield g8();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver})}};function JO(n){return n.unwrap()}function I8(n){return n.wrapped()}function E8(n){return XO(n)}function T8(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new yb(n,GT(n,e))}else if(r){let i=XO(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function XO(n){let{_tokenResponse:e}=n instanceof at?n.customData:n;if(!e)return null;if(!(n instanceof at)&&"temporaryProof"in e&&"phoneNumber"in e)return Oo.credentialFromResult(n);let t=e.providerId;if(!t||t===No.PASSWORD)return null;let r;switch(t){case No.GOOGLE:r=Xm;break;case No.FACEBOOK:r=Jm;break;case No.GITHUB:r=Zm;break;case No.TWITTER:r=eg;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?Ao._create(t,a):yr._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new Ec(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof at?r.credentialFromError(n):r.credentialFromResult(n)}function Dn(n,e){return e.catch(t=>{throw t instanceof at&&T8(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:E8(t),additionalUserInfo:zT(t),user:Ac.getOrCreate(i)}})}function _b(n,e){return g(this,null,function*(){let t=yield e;return{verificationId:t.verificationId,confirm:r=>Dn(n,t.confirm(r))}})}var yb=class{constructor(e,t){this.resolver=t,this.auth=I8(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Dn(JO(this.auth),this.resolver.resolveSignIn(e))}};var Ac=class n{constructor(e){this._delegate=e,this.multiFactor=WT(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}linkWithCredential(e){return g(this,null,function*(){return Dn(this.auth,ng(this._delegate,e))})}linkWithPhoneNumber(e,t){return g(this,null,function*(){return _b(this.auth,YT(this._delegate,e,t))})}linkWithPopup(e){return g(this,null,function*(){return Dn(this.auth,tb(this._delegate,e,Zr))})}linkWithRedirect(e){return g(this,null,function*(){return yield gb(Qe(this.auth)),ob(this._delegate,e,Zr)})}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}reauthenticateWithCredential(e){return g(this,null,function*(){return Dn(this.auth,rg(this._delegate,e))})}reauthenticateWithPhoneNumber(e,t){return _b(this.auth,JT(this._delegate,e,t))}reauthenticateWithPopup(e){return Dn(this.auth,eb(this._delegate,e,Zr))}reauthenticateWithRedirect(e){return g(this,null,function*(){return yield gb(Qe(this.auth)),sb(this._delegate,e,Zr)})}sendEmailVerification(e){return BT(this._delegate,e)}unlink(e){return g(this,null,function*(){return yield ST(this._delegate,e),this})}updateEmail(e){return HT(this._delegate,e)}updatePassword(e){return qT(this._delegate,e)}updatePhoneNumber(e){return XT(this._delegate,e)}updateProfile(e){return $T(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return jT(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Ac.USER_MAP=new WeakMap;var Dd=U,qO=(()=>{class n{constructor(t,r){if(this.app=t,r.isInitialized()){this._delegate=r.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:i}=t.options;Dd(i,"invalid-api-key",{appName:t.name}),Dd(i,"invalid-api-key",{appName:t.name});let s=typeof window<"u"?Zr:void 0;this._delegate=r.initialize({options:{persistence:b8(i,t.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(gT),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Ac.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,r){bT(this._delegate,t,r)}applyActionCode(t){return PT(this._delegate,t)}checkActionCode(t){return sg(this._delegate,t)}confirmPasswordReset(t,r){return NT(this._delegate,t,r)}createUserWithEmailAndPassword(t,r){return g(this,null,function*(){return Dn(this._delegate,kT(this._delegate,t,r))})}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return UT(this._delegate,t)}isSignInWithEmailLink(t){return FT(this._delegate,t)}getRedirectResult(){return g(this,null,function*(){Dd(mb(),this._delegate,"operation-not-supported-in-this-environment");let t=yield ab(this._delegate,Zr);return t?Dn(this._delegate,Promise.resolve(t)):{credential:null,user:null}})}addFrameworkForLogging(t){HO(this._delegate,t)}onAuthStateChanged(t,r,i){let{next:s,error:o,complete:a}=zO(t,r,i);return this._delegate.onAuthStateChanged(s,o,a)}onIdTokenChanged(t,r,i){let{next:s,error:o,complete:a}=zO(t,r,i);return this._delegate.onIdTokenChanged(s,o,a)}sendSignInLinkToEmail(t,r){return LT(this._delegate,t,r)}sendPasswordResetEmail(t,r){return xT(this._delegate,t,r||void 0)}setPersistence(t){return g(this,null,function*(){y8(this._delegate,t);let r;switch(t){case kn.SESSION:r=Xr;break;case kn.LOCAL:r=(yield Zt(ko)._isAvailable())?ko:Sc;break;case kn.NONE:r=ms;break;default:return bt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)})}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return Dn(this._delegate,CT(this._delegate))}signInWithCredential(t){return Dn(this._delegate,Cc(this._delegate,t))}signInWithCustomToken(t){return Dn(this._delegate,AT(this._delegate,t))}signInWithEmailAndPassword(t,r){return Dn(this._delegate,OT(this._delegate,t,r))}signInWithEmailLink(t,r){return Dn(this._delegate,VT(this._delegate,t,r))}signInWithPhoneNumber(t,r){return _b(this._delegate,QT(this._delegate,t,r))}signInWithPopup(t){return g(this,null,function*(){return Dd(mb(),this._delegate,"operation-not-supported-in-this-environment"),Dn(this._delegate,ZT(this._delegate,t,Zr))})}signInWithRedirect(t){return g(this,null,function*(){return Dd(mb(),this._delegate,"operation-not-supported-in-this-environment"),yield gb(this._delegate),ib(this._delegate,t,Zr)})}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return MT(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=kn,n})();function zO(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&Ac.getOrCreate(o)),error:e,complete:t}}function b8(n,e){let t=v8(n,e);if(typeof self<"u"&&!t.includes(ko)&&t.push(ko),typeof window<"u")for(let r of[Sc,Xr])t.includes(r)||t.push(r);return t.includes(ms)||t.push(ms),t}var Rd=class{constructor(){this.providerId="phone",this._delegate=new Oo(JO(X.auth()))}static credential(e,t){return Oo.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};Rd.PHONE_SIGN_IN_METHOD=Oo.PHONE_SIGN_IN_METHOD;Rd.PROVIDER_ID=Oo.PROVIDER_ID;var C8=U,vb=class{constructor(e,t,r=X.app()){var i;C8((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new vd(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var S8="auth-compat";function D8(n){n.INTERNAL.registerComponent(new Ve(S8,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new qO(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:_s.EMAIL_SIGNIN,PASSWORD_RESET:_s.PASSWORD_RESET,RECOVER_EMAIL:_s.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:_s.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:_s.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:_s.VERIFY_EMAIL}},EmailAuthProvider:Cd,FacebookAuthProvider:Jm,GithubAuthProvider:Zm,GoogleAuthProvider:Xm,OAuthProvider:Ec,SAMLAuthProvider:yd,PhoneAuthProvider:Rd,PhoneMultiFactorGenerator:ub,RecaptchaVerifier:vb,TwitterAuthProvider:eg,Auth:qO,AuthCredential:Jr,Error:at}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(c8,l8)}D8(X);var ZO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e1={};var ys,Ib;(function(){var n;function e(T,v){function I(){}I.prototype=v.prototype,T.D=v.prototype,T.prototype=new I,T.prototype.constructor=T,T.C=function(C,D,R){for(var E=Array(arguments.length-2),yi=2;yi<arguments.length;yi++)E[yi-2]=arguments[yi];return v.prototype[D].apply(C,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,v,I){I||(I=0);var C=Array(16);if(typeof v=="string")for(var D=0;16>D;++D)C[D]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(D=0;16>D;++D)C[D]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=T.g[0],I=T.g[1],D=T.g[2];var R=T.g[3],E=v+(R^I&(D^R))+C[0]+3614090360&4294967295;v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+C[1]+3905402710&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+C[2]+606105819&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+C[3]+3250441966&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+C[4]+4118548399&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+C[5]+1200080426&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+C[6]+2821735955&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+C[7]+4249261313&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+C[8]+1770035416&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+C[9]+2336552879&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+C[10]+4294925233&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+C[11]+2304563134&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+C[12]+1804603682&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+C[13]+4254626195&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+C[14]+2792965006&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+C[15]+1236535329&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(D^R&(I^D))+C[1]+4129170786&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+C[6]+3225465664&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+C[11]+643717713&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+C[0]+3921069994&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+C[5]+3593408605&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+C[10]+38016083&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+C[15]+3634488961&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+C[4]+3889429448&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+C[9]+568446438&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+C[14]+3275163606&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+C[3]+4107603335&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+C[8]+1163531501&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+C[13]+2850285829&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+C[2]+4243563512&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+C[7]+1735328473&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+C[12]+2368359562&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(I^D^R)+C[5]+4294588738&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+C[8]+2272392833&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+C[11]+1839030562&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+C[14]+4259657740&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+C[1]+2763975236&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+C[4]+1272893353&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+C[7]+4139469664&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+C[10]+3200236656&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+C[13]+681279174&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+C[0]+3936430074&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+C[3]+3572445317&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+C[6]+76029189&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+C[9]+3654602809&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+C[12]+3873151461&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+C[15]+530742520&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+C[2]+3299628645&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(D^(I|~R))+C[0]+4096336452&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+C[7]+1126891415&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+C[14]+2878612391&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+C[5]+4237533241&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+C[12]+1700485571&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+C[3]+2399980690&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+C[10]+4293915773&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+C[1]+2240044497&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+C[8]+1873313359&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+C[15]+4264355552&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+C[6]+2734768916&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+C[13]+1309151649&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+C[4]+4149444226&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+C[11]+3174756917&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+C[2]+718787259&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+C[9]+3951481745&4294967295,T.g[0]=T.g[0]+v&4294967295,T.g[1]=T.g[1]+(D+(E<<21&4294967295|E>>>11))&4294967295,T.g[2]=T.g[2]+D&4294967295,T.g[3]=T.g[3]+R&4294967295}r.prototype.u=function(T,v){v===void 0&&(v=T.length);for(var I=v-this.blockSize,C=this.B,D=this.h,R=0;R<v;){if(D==0)for(;R<=I;)i(this,T,R),R+=this.blockSize;if(typeof T=="string"){for(;R<v;)if(C[D++]=T.charCodeAt(R++),D==this.blockSize){i(this,C),D=0;break}}else for(;R<v;)if(C[D++]=T[R++],D==this.blockSize){i(this,C),D=0;break}}this.h=D,this.o+=v},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var v=1;v<T.length-8;++v)T[v]=0;var I=8*this.o;for(v=T.length-8;v<T.length;++v)T[v]=I&255,I/=256;for(this.u(T),T=Array(16),v=I=0;4>v;++v)for(var C=0;32>C;C+=8)T[I++]=this.g[v]>>>C&255;return T};function s(T,v){var I=a;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=v(T)}function o(T,v){this.h=v;for(var I=[],C=!0,D=T.length-1;0<=D;D--){var R=T[D]|0;C&&R==v||(I[D]=R,C=!1)}this.g=I}var a={};function c(T){return-128<=T&&128>T?s(T,function(v){return new o([v|0],0>v?-1:0)}):new o([T|0],0>T?-1:0)}function l(T){if(isNaN(T)||!isFinite(T))return h;if(0>T)return S(l(-T));for(var v=[],I=1,C=0;T>=I;C++)v[C]=T/I|0,I*=4294967296;return new o(v,0)}function d(T,v){if(T.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(T.charAt(0)=="-")return S(d(T.substring(1),v));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=l(Math.pow(v,8)),C=h,D=0;D<T.length;D+=8){var R=Math.min(8,T.length-D),E=parseInt(T.substring(D,D+R),v);8>R?(R=l(Math.pow(v,R)),C=C.j(R).add(l(E))):(C=C.j(I),C=C.add(l(E)))}return C}var h=c(0),p=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(b(this))return-S(this).m();for(var T=0,v=1,I=0;I<this.g.length;I++){var C=this.i(I);T+=(0<=C?C:4294967296+C)*v,v*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(w(this))return"0";if(b(this))return"-"+S(this).toString(T);for(var v=l(Math.pow(T,6)),I=this,C="";;){var D=Q(I,v).g;I=O(I,D.j(v));var R=((0<I.g.length?I.g[0]:I.h)>>>0).toString(T);if(I=D,w(I))return R+C;for(;6>R.length;)R="0"+R;C=R+C}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function w(T){if(T.h!=0)return!1;for(var v=0;v<T.g.length;v++)if(T.g[v]!=0)return!1;return!0}function b(T){return T.h==-1}n.l=function(T){return T=O(this,T),b(T)?-1:w(T)?0:1};function S(T){for(var v=T.g.length,I=[],C=0;C<v;C++)I[C]=~T.g[C];return new o(I,~T.h).add(p)}n.abs=function(){return b(this)?S(this):this},n.add=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0,D=0;D<=v;D++){var R=C+(this.i(D)&65535)+(T.i(D)&65535),E=(R>>>16)+(this.i(D)>>>16)+(T.i(D)>>>16);C=E>>>16,R&=65535,E&=65535,I[D]=E<<16|R}return new o(I,I[I.length-1]&-2147483648?-1:0)};function O(T,v){return T.add(S(v))}n.j=function(T){if(w(this)||w(T))return h;if(b(this))return b(T)?S(this).j(S(T)):S(S(this).j(T));if(b(T))return S(this.j(S(T)));if(0>this.l(_)&&0>T.l(_))return l(this.m()*T.m());for(var v=this.g.length+T.g.length,I=[],C=0;C<2*v;C++)I[C]=0;for(C=0;C<this.g.length;C++)for(var D=0;D<T.g.length;D++){var R=this.i(C)>>>16,E=this.i(C)&65535,yi=T.i(D)>>>16,jl=T.i(D)&65535;I[2*C+2*D]+=E*jl,H(I,2*C+2*D),I[2*C+2*D+1]+=R*jl,H(I,2*C+2*D+1),I[2*C+2*D+1]+=E*yi,H(I,2*C+2*D+1),I[2*C+2*D+2]+=R*yi,H(I,2*C+2*D+2)}for(C=0;C<v;C++)I[C]=I[2*C+1]<<16|I[2*C];for(C=v;C<2*v;C++)I[C]=0;return new o(I,0)};function H(T,v){for(;(T[v]&65535)!=T[v];)T[v+1]+=T[v]>>>16,T[v]&=65535,v++}function V(T,v){this.g=T,this.h=v}function Q(T,v){if(w(v))throw Error("division by zero");if(w(T))return new V(h,h);if(b(T))return v=Q(S(T),v),new V(S(v.g),S(v.h));if(b(v))return v=Q(T,S(v)),new V(S(v.g),v.h);if(30<T.g.length){if(b(T)||b(v))throw Error("slowDivide_ only works with positive integers.");for(var I=p,C=v;0>=C.l(T);)I=ae(I),C=ae(C);var D=J(I,1),R=J(C,1);for(C=J(C,2),I=J(I,2);!w(C);){var E=R.add(C);0>=E.l(T)&&(D=D.add(I),R=E),C=J(C,1),I=J(I,1)}return v=O(T,D.j(v)),new V(D,v)}for(D=h;0<=T.l(v);){for(I=Math.max(1,Math.floor(T.m()/v.m())),C=Math.ceil(Math.log(I)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),R=l(I),E=R.j(v);b(E)||0<E.l(T);)I-=C,R=l(I),E=R.j(v);w(R)&&(R=p),D=D.add(R),T=O(T,E)}return new V(D,T)}n.A=function(T){return Q(this,T).h},n.and=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)&T.i(C);return new o(I,this.h&T.h)},n.or=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)|T.i(C);return new o(I,this.h|T.h)},n.xor=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],C=0;C<v;C++)I[C]=this.i(C)^T.i(C);return new o(I,this.h^T.h)};function ae(T){for(var v=T.g.length+1,I=[],C=0;C<v;C++)I[C]=T.i(C)<<1|T.i(C-1)>>>31;return new o(I,T.h)}function J(T,v){var I=v>>5;v%=32;for(var C=T.g.length-I,D=[],R=0;R<C;R++)D[R]=0<v?T.i(R+I)>>>v|T.i(R+I+1)<<32-v:T.i(R+I);return new o(D,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Ib=e1.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,ys=e1.Integer=o}).apply(typeof ZO<"u"?ZO:typeof self<"u"?self:typeof window<"u"?window:{});var lg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Pi={};var Eb,Tb,Rc,bb,xd,ug,Cb,Sb,Db;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,m){return u==Array.prototype||u==Object.prototype||(u[f]=m.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof lg=="object"&&lg];for(var f=0;f<u.length;++f){var m=u[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=t(this);function i(u,f){if(f)e:{var m=r;u=u.split(".");for(var y=0;y<u.length-1;y++){var A=u[y];if(!(A in m))break e;m=m[A]}u=u[u.length-1],y=m[u],f=f(y),f!=y&&f!=null&&e(m,u,{configurable:!0,writable:!0,value:f})}}function s(u,f){u instanceof String&&(u+="");var m=0,y=!1,A={next:function(){if(!y&&m<u.length){var N=m++;return{value:f(N,u[N]),done:!1}}return y=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(u){return u||function(){return s(this,function(f,m){return m})}});var o=o||{},a=this||self;function c(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function l(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function d(u,f,m){return u.call.apply(u.bind,arguments)}function h(u,f,m){if(!u)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,y),u.apply(f,A)}}return function(){return u.apply(f,arguments)}}function p(u,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function _(u,f){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),u.apply(this,y)}}function w(u,f){function m(){}m.prototype=f.prototype,u.aa=f.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(y,A,N){for(var $=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)$[Ue-2]=arguments[Ue];return f.prototype[A].apply(y,$)}}function b(u){let f=u.length;if(0<f){let m=Array(f);for(let y=0;y<f;y++)m[y]=u[y];return m}return[]}function S(u,f){for(let m=1;m<arguments.length;m++){let y=arguments[m];if(c(y)){let A=u.length||0,N=y.length||0;u.length=A+N;for(let $=0;$<N;$++)u[A+$]=y[$]}else u.push(y)}}class O{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function H(u){return/^[\s\xa0]*$/.test(u)}function V(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function Q(u){return Q[" "](u),u}Q[" "]=function(){};var ae=V().indexOf("Gecko")!=-1&&!(V().toLowerCase().indexOf("webkit")!=-1&&V().indexOf("Edge")==-1)&&!(V().indexOf("Trident")!=-1||V().indexOf("MSIE")!=-1)&&V().indexOf("Edge")==-1;function J(u,f,m){for(let y in u)f.call(m,u[y],y,u)}function T(u,f){for(let m in u)f.call(void 0,u[m],m,u)}function v(u){let f={};for(let m in u)f[m]=u[m];return f}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,f){let m,y;for(let A=1;A<arguments.length;A++){y=arguments[A];for(m in y)u[m]=y[m];for(let N=0;N<I.length;N++)m=I[N],Object.prototype.hasOwnProperty.call(y,m)&&(u[m]=y[m])}}function D(u){var f=1;u=u.split(":");let m=[];for(;0<f&&u.length;)m.push(u.shift()),f--;return u.length&&m.push(u.join(":")),m}function R(u){a.setTimeout(()=>{throw u},0)}function E(){var u=Py;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class yi{constructor(){this.h=this.g=null}add(f,m){let y=jl.get();y.set(f,m),this.h?this.h.next=y:this.g=y,this.h=y}}var jl=new O(()=>new OB,u=>u.reset());class OB{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let $l,Hl=!1,Py=new yi,xA=()=>{let u=a.Promise.resolve(void 0);$l=()=>{u.then(LB)}};var LB=()=>{for(var u;u=E();){try{u.h.call(u.g)}catch(m){R(m)}var f=jl;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}Hl=!1};function Hi(){this.s=this.s,this.C=this.C}Hi.prototype.s=!1,Hi.prototype.ma=function(){this.s||(this.s=!0,this.N())},Hi.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Gt(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}Gt.prototype.h=function(){this.defaultPrevented=!0};var FB=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return u}();function ql(u,f){if(Gt.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,y=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(ae){e:{try{Q(f.nodeName);var A=!0;break e}catch{}A=!1}A||(f=null)}}else m=="mouseover"?f=u.fromElement:m=="mouseout"&&(f=u.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:VB[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&ql.aa.h.call(this)}}w(ql,Gt);var VB={2:"touch",3:"pen",4:"mouse"};ql.prototype.h=function(){ql.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var zl="closure_listenable_"+(1e6*Math.random()|0),UB=0;function BB(u,f,m,y,A){this.listener=u,this.proxy=null,this.src=f,this.type=m,this.capture=!!y,this.ha=A,this.key=++UB,this.da=this.fa=!1}function sf(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function of(u){this.src=u,this.g={},this.h=0}of.prototype.add=function(u,f,m,y,A){var N=u.toString();u=this.g[N],u||(u=this.g[N]=[],this.h++);var $=ky(u,f,y,A);return-1<$?(f=u[$],m||(f.fa=!1)):(f=new BB(f,this.src,N,!!y,A),f.fa=m,u.push(f)),f};function My(u,f){var m=f.type;if(m in u.g){var y=u.g[m],A=Array.prototype.indexOf.call(y,f,void 0),N;(N=0<=A)&&Array.prototype.splice.call(y,A,1),N&&(sf(f),u.g[m].length==0&&(delete u.g[m],u.h--))}}function ky(u,f,m,y){for(var A=0;A<u.length;++A){var N=u[A];if(!N.da&&N.listener==f&&N.capture==!!m&&N.ha==y)return A}return-1}var Oy="closure_lm_"+(1e6*Math.random()|0),Ly={};function NA(u,f,m,y,A){if(y&&y.once)return MA(u,f,m,y,A);if(Array.isArray(f)){for(var N=0;N<f.length;N++)NA(u,f[N],m,y,A);return null}return m=By(m),u&&u[zl]?u.K(f,m,l(y)?!!y.capture:!!y,A):PA(u,f,m,!1,y,A)}function PA(u,f,m,y,A,N){if(!f)throw Error("Invalid event type");var $=l(A)?!!A.capture:!!A,Ue=Vy(u);if(Ue||(u[Oy]=Ue=new of(u)),m=Ue.add(f,m,y,$,N),m.proxy)return m;if(y=jB(),m.proxy=y,y.src=u,y.listener=m,u.addEventListener)FB||(A=$),A===void 0&&(A=!1),u.addEventListener(f.toString(),y,A);else if(u.attachEvent)u.attachEvent(OA(f.toString()),y);else if(u.addListener&&u.removeListener)u.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function jB(){function u(m){return f.call(u.src,u.listener,m)}let f=$B;return u}function MA(u,f,m,y,A){if(Array.isArray(f)){for(var N=0;N<f.length;N++)MA(u,f[N],m,y,A);return null}return m=By(m),u&&u[zl]?u.L(f,m,l(y)?!!y.capture:!!y,A):PA(u,f,m,!0,y,A)}function kA(u,f,m,y,A){if(Array.isArray(f))for(var N=0;N<f.length;N++)kA(u,f[N],m,y,A);else y=l(y)?!!y.capture:!!y,m=By(m),u&&u[zl]?(u=u.i,f=String(f).toString(),f in u.g&&(N=u.g[f],m=ky(N,m,y,A),-1<m&&(sf(N[m]),Array.prototype.splice.call(N,m,1),N.length==0&&(delete u.g[f],u.h--)))):u&&(u=Vy(u))&&(f=u.g[f.toString()],u=-1,f&&(u=ky(f,m,y,A)),(m=-1<u?f[u]:null)&&Fy(m))}function Fy(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[zl])My(f.i,u);else{var m=u.type,y=u.proxy;f.removeEventListener?f.removeEventListener(m,y,u.capture):f.detachEvent?f.detachEvent(OA(m),y):f.addListener&&f.removeListener&&f.removeListener(y),(m=Vy(f))?(My(m,u),m.h==0&&(m.src=null,f[Oy]=null)):sf(u)}}}function OA(u){return u in Ly?Ly[u]:Ly[u]="on"+u}function $B(u,f){if(u.da)u=!0;else{f=new ql(f,this);var m=u.listener,y=u.ha||u.src;u.fa&&Fy(u),u=m.call(y,f)}return u}function Vy(u){return u=u[Oy],u instanceof of?u:null}var Uy="__closure_events_fn_"+(1e9*Math.random()>>>0);function By(u){return typeof u=="function"?u:(u[Uy]||(u[Uy]=function(f){return u.handleEvent(f)}),u[Uy])}function Wt(){Hi.call(this),this.i=new of(this),this.M=this,this.F=null}w(Wt,Hi),Wt.prototype[zl]=!0,Wt.prototype.removeEventListener=function(u,f,m,y){kA(this,u,f,m,y)};function on(u,f){var m,y=u.F;if(y)for(m=[];y;y=y.F)m.push(y);if(u=u.M,y=f.type||f,typeof f=="string")f=new Gt(f,u);else if(f instanceof Gt)f.target=f.target||u;else{var A=f;f=new Gt(y,u),C(f,A)}if(A=!0,m)for(var N=m.length-1;0<=N;N--){var $=f.g=m[N];A=af($,y,!0,f)&&A}if($=f.g=u,A=af($,y,!0,f)&&A,A=af($,y,!1,f)&&A,m)for(N=0;N<m.length;N++)$=f.g=m[N],A=af($,y,!1,f)&&A}Wt.prototype.N=function(){if(Wt.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var m=u.g[f],y=0;y<m.length;y++)sf(m[y]);delete u.g[f],u.h--}}this.F=null},Wt.prototype.K=function(u,f,m,y){return this.i.add(String(u),f,!1,m,y)},Wt.prototype.L=function(u,f,m,y){return this.i.add(String(u),f,!0,m,y)};function af(u,f,m,y){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var A=!0,N=0;N<f.length;++N){var $=f[N];if($&&!$.da&&$.capture==m){var Ue=$.listener,Bt=$.ha||$.src;$.fa&&My(u.i,$),A=Ue.call(Bt,y)!==!1&&A}}return A&&!y.defaultPrevented}function LA(u,f,m){if(typeof u=="function")m&&(u=p(u,m));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function FA(u){u.g=LA(()=>{u.g=null,u.i&&(u.i=!1,FA(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class HB extends Hi{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:FA(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gl(u){Hi.call(this),this.h=u,this.g={}}w(Gl,Hi);var VA=[];function UA(u){J(u.g,function(f,m){this.g.hasOwnProperty(m)&&Fy(f)},u),u.g={}}Gl.prototype.N=function(){Gl.aa.N.call(this),UA(this)},Gl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var jy=a.JSON.stringify,qB=a.JSON.parse,zB=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function $y(){}$y.prototype.h=null;function BA(u){return u.h||(u.h=u.i())}function jA(){}var Wl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Hy(){Gt.call(this,"d")}w(Hy,Gt);function qy(){Gt.call(this,"c")}w(qy,Gt);var Js={},$A=null;function cf(){return $A=$A||new Wt}Js.La="serverreachability";function HA(u){Gt.call(this,Js.La,u)}w(HA,Gt);function Kl(u){let f=cf();on(f,new HA(f))}Js.STAT_EVENT="statevent";function qA(u,f){Gt.call(this,Js.STAT_EVENT,u),this.stat=f}w(qA,Gt);function an(u){let f=cf();on(f,new qA(f,u))}Js.Ma="timingevent";function zA(u,f){Gt.call(this,Js.Ma,u),this.size=f}w(zA,Gt);function Ql(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function Yl(){this.g=!0}Yl.prototype.xa=function(){this.g=!1};function GB(u,f,m,y,A,N){u.info(function(){if(u.g)if(N)for(var $="",Ue=N.split("&"),Bt=0;Bt<Ue.length;Bt++){var Pe=Ue[Bt].split("=");if(1<Pe.length){var Kt=Pe[0];Pe=Pe[1];var Qt=Kt.split("_");$=2<=Qt.length&&Qt[1]=="type"?$+(Kt+"="+Pe+"&"):$+(Kt+"=redacted&")}}else $=null;else $=N;return"XMLHTTP REQ ("+y+") [attempt "+A+"]: "+f+`
`+m+`
`+$})}function WB(u,f,m,y,A,N,$){u.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+A+"]: "+f+`
`+m+`
`+N+" "+$})}function Ea(u,f,m,y){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+QB(u,m)+(y?" "+y:"")})}function KB(u,f){u.info(function(){return"TIMEOUT: "+f})}Yl.prototype.info=function(){};function QB(u,f){if(!u.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var y=m[u];if(!(2>y.length)){var A=y[1];if(Array.isArray(A)&&!(1>A.length)){var N=A[0];if(N!="noop"&&N!="stop"&&N!="close")for(var $=1;$<A.length;$++)A[$]=""}}}}return jy(m)}catch{return f}}var lf={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},GA={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},zy;function uf(){}w(uf,$y),uf.prototype.g=function(){return new XMLHttpRequest},uf.prototype.i=function(){return{}},zy=new uf;function qi(u,f,m,y){this.j=u,this.i=f,this.l=m,this.R=y||1,this.U=new Gl(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new WA}function WA(){this.i=null,this.g="",this.h=!1}var KA={},Gy={};function Wy(u,f,m){u.L=1,u.v=pf(vi(f)),u.m=m,u.P=!0,QA(u,null)}function QA(u,f){u.F=Date.now(),df(u),u.A=vi(u.v);var m=u.A,y=u.R;Array.isArray(y)||(y=[String(y)]),lR(m.i,"t",y),u.C=0,m=u.j.J,u.h=new WA,u.g=DR(u.j,m?f:null,!u.m),0<u.O&&(u.M=new HB(p(u.Y,u,u.g),u.O)),f=u.U,m=u.g,y=u.ca;var A="readystatechange";Array.isArray(A)||(A&&(VA[0]=A.toString()),A=VA);for(var N=0;N<A.length;N++){var $=NA(m,A[N],y||f.handleEvent,!1,f.h||f);if(!$)break;f.g[$.key]=$}f=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),Kl(),GB(u.i,u.u,u.A,u.l,u.R,u.m)}qi.prototype.ca=function(u){u=u.target;let f=this.M;f&&wi(u)==3?f.j():this.Y(u)},qi.prototype.Y=function(u){try{if(u==this.g)e:{let Qt=wi(this.g);var f=this.g.Ba();let Ca=this.g.Z();if(!(3>Qt)&&(Qt!=3||this.g&&(this.h.h||this.g.oa()||gR(this.g)))){this.J||Qt!=4||f==7||(f==8||0>=Ca?Kl(3):Kl(2)),Ky(this);var m=this.g.Z();this.X=m;t:if(YA(this)){var y=gR(this.g);u="";var A=y.length,N=wi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Xs(this),Jl(this);var $="";break t}this.h.i=new a.TextDecoder}for(f=0;f<A;f++)this.h.h=!0,u+=this.h.i.decode(y[f],{stream:!(N&&f==A-1)});y.length=0,this.h.g+=u,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=m==200,WB(this.i,this.u,this.A,this.l,this.R,Qt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Ue,Bt=this.g;if((Ue=Bt.g?Bt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Ue)){var Pe=Ue;break t}}Pe=null}if(m=Pe)Ea(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qy(this,m);else{this.o=!1,this.s=3,an(12),Xs(this),Jl(this);break e}}if(this.P){m=!0;let sr;for(;!this.J&&this.C<$.length;)if(sr=YB(this,$),sr==Gy){Qt==4&&(this.s=4,an(14),m=!1),Ea(this.i,this.l,null,"[Incomplete Response]");break}else if(sr==KA){this.s=4,an(15),Ea(this.i,this.l,$,"[Invalid Chunk]"),m=!1;break}else Ea(this.i,this.l,sr,null),Qy(this,sr);if(YA(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qt!=4||$.length!=0||this.h.h||(this.s=1,an(16),m=!1),this.o=this.o&&m,!m)Ea(this.i,this.l,$,"[Invalid Chunked Response]"),Xs(this),Jl(this);else if(0<$.length&&!this.W){this.W=!0;var Kt=this.j;Kt.g==this&&Kt.ba&&!Kt.M&&(Kt.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),tv(Kt),Kt.M=!0,an(11))}}else Ea(this.i,this.l,$,null),Qy(this,$);Qt==4&&Xs(this),this.o&&!this.J&&(Qt==4?TR(this.j,this):(this.o=!1,df(this)))}else fj(this.g),m==400&&0<$.indexOf("Unknown SID")?(this.s=3,an(12)):(this.s=0,an(13)),Xs(this),Jl(this)}}}catch{}finally{}};function YA(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function YB(u,f){var m=u.C,y=f.indexOf(`
`,m);return y==-1?Gy:(m=Number(f.substring(m,y)),isNaN(m)?KA:(y+=1,y+m>f.length?Gy:(f=f.slice(y,y+m),u.C=y+m,f)))}qi.prototype.cancel=function(){this.J=!0,Xs(this)};function df(u){u.S=Date.now()+u.I,JA(u,u.I)}function JA(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ql(p(u.ba,u),f)}function Ky(u){u.B&&(a.clearTimeout(u.B),u.B=null)}qi.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(KB(this.i,this.A),this.L!=2&&(Kl(),an(17)),Xs(this),this.s=2,Jl(this)):JA(this,this.S-u)};function Jl(u){u.j.G==0||u.J||TR(u.j,u)}function Xs(u){Ky(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,UA(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function Qy(u,f){try{var m=u.j;if(m.G!=0&&(m.g==u||Yy(m.h,u))){if(!u.K&&Yy(m.h,u)&&m.G==3){try{var y=m.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var A=y;if(A[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)vf(m),_f(m);else break e;ev(m),an(18)}}else m.za=A[1],0<m.za-m.T&&37500>A[2]&&m.F&&m.v==0&&!m.C&&(m.C=Ql(p(m.Za,m),6e3));if(1>=eR(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else eo(m,11)}else if((u.K||m.g==u)&&vf(m),!H(f))for(A=m.Da.g.parse(f),f=0;f<A.length;f++){let Pe=A[f];if(m.T=Pe[0],Pe=Pe[1],m.G==2)if(Pe[0]=="c"){m.K=Pe[1],m.ia=Pe[2];let Kt=Pe[3];Kt!=null&&(m.la=Kt,m.j.info("VER="+m.la));let Qt=Pe[4];Qt!=null&&(m.Aa=Qt,m.j.info("SVER="+m.Aa));let Ca=Pe[5];Ca!=null&&typeof Ca=="number"&&0<Ca&&(y=1.5*Ca,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;let sr=u.g;if(sr){let If=sr.g?sr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(If){var N=y.h;N.g||If.indexOf("spdy")==-1&&If.indexOf("quic")==-1&&If.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(Jy(N,N.h),N.h=null))}if(y.D){let nv=sr.g?sr.g.getResponseHeader("X-HTTP-Session-Id"):null;nv&&(y.ya=nv,We(y.I,y.D,nv))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var $=u;if(y.qa=SR(y,y.J?y.ia:null,y.W),$.K){tR(y.h,$);var Ue=$,Bt=y.L;Bt&&(Ue.I=Bt),Ue.B&&(Ky(Ue),df(Ue)),y.g=$}else IR(y);0<m.i.length&&yf(m)}else Pe[0]!="stop"&&Pe[0]!="close"||eo(m,7);else m.G==3&&(Pe[0]=="stop"||Pe[0]=="close"?Pe[0]=="stop"?eo(m,7):Zy(m):Pe[0]!="noop"&&m.l&&m.l.ta(Pe),m.v=0)}}Kl(4)}catch{}}var JB=class{constructor(u,f){this.g=u,this.map=f}};function XA(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ZA(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function eR(u){return u.h?1:u.g?u.g.size:0}function Yy(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function Jy(u,f){u.g?u.g.add(f):u.h=f}function tR(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}XA.prototype.cancel=function(){if(this.i=nR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function nR(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let m of u.g.values())f=f.concat(m.D);return f}return b(u.i)}function XB(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var f=[],m=u.length,y=0;y<m;y++)f.push(u[y]);return f}f=[],m=0;for(y in u)f[m++]=u[y];return f}function ZB(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var f=[];u=u.length;for(var m=0;m<u;m++)f.push(m);return f}f=[],m=0;for(let y in u)f[m++]=y;return f}}}function rR(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var m=ZB(u),y=XB(u),A=y.length,N=0;N<A;N++)f.call(void 0,y[N],m&&m[N],u)}var iR=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ej(u,f){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var y=u[m].indexOf("="),A=null;if(0<=y){var N=u[m].substring(0,y);A=u[m].substring(y+1)}else N=u[m];f(N,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function Zs(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Zs){this.h=u.h,hf(this,u.j),this.o=u.o,this.g=u.g,ff(this,u.s),this.l=u.l;var f=u.i,m=new eu;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),sR(this,m),this.m=u.m}else u&&(f=String(u).match(iR))?(this.h=!1,hf(this,f[1]||"",!0),this.o=Xl(f[2]||""),this.g=Xl(f[3]||"",!0),ff(this,f[4]),this.l=Xl(f[5]||"",!0),sR(this,f[6]||"",!0),this.m=Xl(f[7]||"")):(this.h=!1,this.i=new eu(null,this.h))}Zs.prototype.toString=function(){var u=[],f=this.j;f&&u.push(Zl(f,oR,!0),":");var m=this.g;return(m||f=="file")&&(u.push("//"),(f=this.o)&&u.push(Zl(f,oR,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(Zl(m,m.charAt(0)=="/"?rj:nj,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",Zl(m,sj)),u.join("")};function vi(u){return new Zs(u)}function hf(u,f,m){u.j=m?Xl(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function ff(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function sR(u,f,m){f instanceof eu?(u.i=f,oj(u.i,u.h)):(m||(f=Zl(f,ij)),u.i=new eu(f,u.h))}function We(u,f,m){u.i.set(f,m)}function pf(u){return We(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Xl(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Zl(u,f,m){return typeof u=="string"?(u=encodeURI(u).replace(f,tj),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function tj(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var oR=/[#\/\?@]/g,nj=/[#\?:]/g,rj=/[#\?]/g,ij=/[#\?@]/g,sj=/#/g;function eu(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function zi(u){u.g||(u.g=new Map,u.h=0,u.i&&ej(u.i,function(f,m){u.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=eu.prototype,n.add=function(u,f){zi(this),this.i=null,u=Ta(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(f),this.h+=1,this};function aR(u,f){zi(u),f=Ta(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function cR(u,f){return zi(u),f=Ta(u,f),u.g.has(f)}n.forEach=function(u,f){zi(this),this.g.forEach(function(m,y){m.forEach(function(A){u.call(f,A,y,this)},this)},this)},n.na=function(){zi(this);let u=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let y=0;y<f.length;y++){let A=u[y];for(let N=0;N<A.length;N++)m.push(f[y])}return m},n.V=function(u){zi(this);let f=[];if(typeof u=="string")cR(this,u)&&(f=f.concat(this.g.get(Ta(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)f=f.concat(u[m])}return f},n.set=function(u,f){return zi(this),this.i=null,u=Ta(this,u),cR(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function lR(u,f,m){aR(u,f),0<m.length&&(u.i=null,u.g.set(Ta(u,f),b(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var y=f[m];let N=encodeURIComponent(String(y)),$=this.V(y);for(y=0;y<$.length;y++){var A=N;$[y]!==""&&(A+="="+encodeURIComponent(String($[y]))),u.push(A)}}return this.i=u.join("&")};function Ta(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function oj(u,f){f&&!u.j&&(zi(u),u.i=null,u.g.forEach(function(m,y){var A=y.toLowerCase();y!=A&&(aR(this,y),lR(this,A,m))},u)),u.j=f}function aj(u,f){let m=new Yl;if(a.Image){let y=new Image;y.onload=_(Gi,m,"TestLoadImage: loaded",!0,f,y),y.onerror=_(Gi,m,"TestLoadImage: error",!1,f,y),y.onabort=_(Gi,m,"TestLoadImage: abort",!1,f,y),y.ontimeout=_(Gi,m,"TestLoadImage: timeout",!1,f,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=u}else f(!1)}function cj(u,f){let m=new Yl,y=new AbortController,A=setTimeout(()=>{y.abort(),Gi(m,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:y.signal}).then(N=>{clearTimeout(A),N.ok?Gi(m,"TestPingServer: ok",!0,f):Gi(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(A),Gi(m,"TestPingServer: error",!1,f)})}function Gi(u,f,m,y,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),y(m)}catch{}}function lj(){this.g=new zB}function uj(u,f,m){let y=m||"";try{rR(u,function(A,N){let $=A;l(A)&&($=jy(A)),f.push(y+N+"="+encodeURIComponent($))})}catch(A){throw f.push(y+"type="+encodeURIComponent("_badmap")),A}}function tu(u){this.l=u.Ub||null,this.j=u.eb||!1}w(tu,$y),tu.prototype.g=function(){return new mf(this.l,this.j)},tu.prototype.i=function(u){return function(){return u}}({});function mf(u,f){Wt.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(mf,Wt),n=mf.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,ru(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,nu(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,ru(this)),this.g&&(this.readyState=3,ru(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;uR(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function uR(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?nu(this):ru(this),this.readyState==3&&uR(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,nu(this))},n.Qa=function(u){this.g&&(this.response=u,nu(this))},n.ga=function(){this.g&&nu(this)};function nu(u){u.readyState=4,u.l=null,u.j=null,u.v=null,ru(u)}n.setRequestHeader=function(u,f){this.u.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=f.next();return u.join(`\r
`)};function ru(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(mf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function dR(u){let f="";return J(u,function(m,y){f+=y,f+=":",f+=m,f+=`\r
`}),f}function Xy(u,f,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=dR(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):We(u,f,m))}function st(u){Wt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(st,Wt);var dj=/^https?$/i,hj=["POST","PUT"];n=st.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,f,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():zy.g(),this.v=this.o?BA(this.o):BA(zy),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(N){hR(this,N);return}if(u=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var A in y)m.set(A,y[A]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let N of y.keys())m.set(N,y.get(N));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(N=>N.toLowerCase()=="content-type"),A=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(hj,f,void 0))||y||A||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[N,$]of m)this.g.setRequestHeader(N,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{mR(this),this.u=!0,this.g.send(u),this.u=!1}catch(N){hR(this,N)}};function hR(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,fR(u),gf(u)}function fR(u){u.A||(u.A=!0,on(u,"complete"),on(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,on(this,"complete"),on(this,"abort"),gf(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),gf(this,!0)),st.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?pR(this):this.bb())},n.bb=function(){pR(this)};function pR(u){if(u.h&&typeof o<"u"&&(!u.v[1]||wi(u)!=4||u.Z()!=2)){if(u.u&&wi(u)==4)LA(u.Ea,0,u);else if(on(u,"readystatechange"),wi(u)==4){u.h=!1;try{let $=u.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var y;if(y=$===0){var A=String(u.D).match(iR)[1]||null;!A&&a.self&&a.self.location&&(A=a.self.location.protocol.slice(0,-1)),y=!dj.test(A?A.toLowerCase():"")}m=y}if(m)on(u,"complete"),on(u,"success");else{u.m=6;try{var N=2<wi(u)?u.g.statusText:""}catch{N=""}u.l=N+" ["+u.Z()+"]",fR(u)}}finally{gf(u)}}}}function gf(u,f){if(u.g){mR(u);let m=u.g,y=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||on(u,"ready");try{m.onreadystatechange=y}catch{}}}function mR(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function wi(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<wi(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),qB(f)}};function gR(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function fj(u){let f={};u=(u.g&&2<=wi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<u.length;y++){if(H(u[y]))continue;var m=D(u[y]);let A=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let N=f[A]||[];f[A]=N,N.push(m)}T(f,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function iu(u,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||f}function _R(u){this.Aa=0,this.i=[],this.j=new Yl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=iu("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=iu("baseRetryDelayMs",5e3,u),this.cb=iu("retryDelaySeedMs",1e4,u),this.Wa=iu("forwardChannelMaxRetries",2,u),this.wa=iu("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new XA(u&&u.concurrentRequestLimit),this.Da=new lj,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=_R.prototype,n.la=8,n.G=1,n.connect=function(u,f,m,y){an(0),this.W=u,this.H=f||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=SR(this,null,this.W),yf(this)};function Zy(u){if(yR(u),u.G==3){var f=u.U++,m=vi(u.I);if(We(m,"SID",u.K),We(m,"RID",f),We(m,"TYPE","terminate"),su(u,m),f=new qi(u,u.j,f),f.L=2,f.v=pf(vi(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=DR(f.j,null),f.g.ea(f.v)),f.F=Date.now(),df(f)}CR(u)}function _f(u){u.g&&(tv(u),u.g.cancel(),u.g=null)}function yR(u){_f(u),u.u&&(a.clearTimeout(u.u),u.u=null),vf(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function yf(u){if(!ZA(u.h)&&!u.s){u.s=!0;var f=u.Ga;$l||xA(),Hl||($l(),Hl=!0),Py.add(f,u),u.B=0}}function pj(u,f){return eR(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ql(p(u.Ga,u,f),bR(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let A=new qi(this,this.j,u),N=this.o;if(this.S&&(N?(N=v(N),C(N,this.S)):N=this.S),this.m!==null||this.O||(A.H=N,N=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=wR(this,A,f),m=vi(this.I),We(m,"RID",u),We(m,"CVER",22),this.D&&We(m,"X-HTTP-Session-Id",this.D),su(this,m),N&&(this.O?f="headers="+encodeURIComponent(String(dR(N)))+"&"+f:this.m&&Xy(m,this.m,N)),Jy(this.h,A),this.Ua&&We(m,"TYPE","init"),this.P?(We(m,"$req",f),We(m,"SID","null"),A.T=!0,Wy(A,m,null)):Wy(A,m,f),this.G=2}}else this.G==3&&(u?vR(this,u):this.i.length==0||ZA(this.h)||vR(this))};function vR(u,f){var m;f?m=f.l:m=u.U++;let y=vi(u.I);We(y,"SID",u.K),We(y,"RID",m),We(y,"AID",u.T),su(u,y),u.m&&u.o&&Xy(y,u.m,u.o),m=new qi(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),f&&(u.i=f.D.concat(u.i)),f=wR(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Jy(u.h,m),Wy(m,y,f)}function su(u,f){u.H&&J(u.H,function(m,y){We(f,y,m)}),u.l&&rR({},function(m,y){We(f,y,m)})}function wR(u,f,m){m=Math.min(u.i.length,m);var y=u.l?p(u.l.Na,u.l,u):null;e:{var A=u.i;let N=-1;for(;;){let $=["count="+m];N==-1?0<m?(N=A[0].g,$.push("ofs="+N)):N=0:$.push("ofs="+N);let Ue=!0;for(let Bt=0;Bt<m;Bt++){let Pe=A[Bt].g,Kt=A[Bt].map;if(Pe-=N,0>Pe)N=Math.max(0,A[Bt].g-100),Ue=!1;else try{uj(Kt,$,"req"+Pe+"_")}catch{y&&y(Kt)}}if(Ue){y=$.join("&");break e}}}return u=u.i.splice(0,m),f.D=u,y}function IR(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;$l||xA(),Hl||($l(),Hl=!0),Py.add(f,u),u.v=0}}function ev(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ql(p(u.Fa,u),bR(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,ER(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ql(p(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,an(10),_f(this),ER(this))};function tv(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function ER(u){u.g=new qi(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=vi(u.qa);We(f,"RID","rpc"),We(f,"SID",u.K),We(f,"AID",u.T),We(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&We(f,"TO",u.ja),We(f,"TYPE","xmlhttp"),su(u,f),u.m&&u.o&&Xy(f,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=pf(vi(f)),m.m=null,m.P=!0,QA(m,u)}n.Za=function(){this.C!=null&&(this.C=null,_f(this),ev(this),an(19))};function vf(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function TR(u,f){var m=null;if(u.g==f){vf(u),tv(u),u.g=null;var y=2}else if(Yy(u.h,f))m=f.D,tR(u.h,f),y=1;else return;if(u.G!=0){if(f.o)if(y==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var A=u.B;y=cf(),on(y,new zA(y,m)),yf(u)}else IR(u);else if(A=f.s,A==3||A==0&&0<f.X||!(y==1&&pj(u,f)||y==2&&ev(u)))switch(m&&0<m.length&&(f=u.h,f.i=f.i.concat(m)),A){case 1:eo(u,5);break;case 4:eo(u,10);break;case 3:eo(u,6);break;default:eo(u,2)}}}function bR(u,f){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*f}function eo(u,f){if(u.j.info("Error code "+f),f==2){var m=p(u.fb,u),y=u.Xa;let A=!y;y=new Zs(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||hf(y,"https"),pf(y),A?aj(y.toString(),m):cj(y.toString(),m)}else an(2);u.G=0,u.l&&u.l.sa(f),CR(u),yR(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),an(2)):(this.j.info("Failed to ping google.com"),an(1))};function CR(u){if(u.G=0,u.ka=[],u.l){let f=nR(u.h);(f.length!=0||u.i.length!=0)&&(S(u.ka,f),S(u.ka,u.i),u.h.i.length=0,b(u.i),u.i.length=0),u.l.ra()}}function SR(u,f,m){var y=m instanceof Zs?vi(m):new Zs(m);if(y.g!="")f&&(y.g=f+"."+y.g),ff(y,y.s);else{var A=a.location;y=A.protocol,f=f?f+"."+A.hostname:A.hostname,A=+A.port;var N=new Zs(null);y&&hf(N,y),f&&(N.g=f),A&&ff(N,A),m&&(N.l=m),y=N}return m=u.D,f=u.ya,m&&f&&We(y,m,f),We(y,"VER",u.la),su(u,y),y}function DR(u,f,m){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new st(new tu({eb:m})):new st(u.pa),f.Ha(u.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function AR(){}n=AR.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function wf(){}wf.prototype.g=function(u,f){return new Rn(u,f)};function Rn(u,f){Wt.call(this),this.g=new _R(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!H(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!H(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new ba(this)}w(Rn,Wt),Rn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Rn.prototype.close=function(){Zy(this.g)},Rn.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=jy(u),u=m);f.i.push(new JB(f.Ya++,u)),f.G==3&&yf(f)},Rn.prototype.N=function(){this.g.l=null,delete this.j,Zy(this.g),delete this.g,Rn.aa.N.call(this)};function RR(u){Hy.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(let m in f){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}w(RR,Hy);function xR(){qy.call(this),this.status=1}w(xR,qy);function ba(u){this.g=u}w(ba,AR),ba.prototype.ua=function(){on(this.g,"a")},ba.prototype.ta=function(u){on(this.g,new RR(u))},ba.prototype.sa=function(u){on(this.g,new xR)},ba.prototype.ra=function(){on(this.g,"b")},wf.prototype.createWebChannel=wf.prototype.g,Rn.prototype.send=Rn.prototype.o,Rn.prototype.open=Rn.prototype.m,Rn.prototype.close=Rn.prototype.close,Db=Pi.createWebChannelTransport=function(){return new wf},Sb=Pi.getStatEventTarget=function(){return cf()},Cb=Pi.Event=Js,ug=Pi.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},lf.NO_ERROR=0,lf.TIMEOUT=8,lf.HTTP_ERROR=6,xd=Pi.ErrorCode=lf,GA.COMPLETE="complete",bb=Pi.EventType=GA,jA.EventType=Wl,Wl.OPEN="a",Wl.CLOSE="b",Wl.ERROR="c",Wl.MESSAGE="d",Wt.prototype.listen=Wt.prototype.K,Rc=Pi.WebChannel=jA,Tb=Pi.FetchXmlHttpFactory=tu,st.prototype.listenOnce=st.prototype.L,st.prototype.getLastError=st.prototype.Ka,st.prototype.getLastErrorCode=st.prototype.Ba,st.prototype.getStatus=st.prototype.Z,st.prototype.getResponseJson=st.prototype.Oa,st.prototype.getResponseText=st.prototype.oa,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Ha,Eb=Pi.XhrIo=st}).apply(typeof lg<"u"?lg:typeof self<"u"?self:typeof window<"u"?window:{});var t1="@firebase/firestore";var Dt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Dt.UNAUTHENTICATED=new Dt(null),Dt.GOOGLE_CREDENTIALS=new Dt("google-credentials-uid"),Dt.FIRST_PARTY=new Dt("first-party-uid"),Dt.MOCK_USER=new Dt("mock-user");var sl="10.12.1";var Ss=new Sn("@firebase/firestore");function kc(){return Ss.logLevel}function nL(n){Ss.setLogLevel(n)}function F(n,...e){if(Ss.logLevel<=ge.DEBUG){let t=e.map(M0);Ss.debug(`Firestore (${sl}): ${n}`,...t)}}function pt(n,...e){if(Ss.logLevel<=ge.ERROR){let t=e.map(M0);Ss.error(`Firestore (${sl}): ${n}`,...t)}}function Zn(n,...e){if(Ss.logLevel<=ge.WARN){let t=e.map(M0);Ss.warn(`Firestore (${sl}): ${n}`,...t)}}function M0(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function Y(n="Unexpected state"){let e=`FIRESTORE (${sl}) INTERNAL ASSERTION FAILED: `+n;throw pt(e),new Error(e)}function Z(n,e){n||Y()}function rL(n,e){n||Y()}function z(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends at{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var mt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Ig=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Pb=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Dt.UNAUTHENTICATED))}shutdown(){}},Mb=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},kb=class{constructor(e){this.t=e,this.currentUser=Dt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new mt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new mt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new mt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Z(typeof r.accessToken=="string"),new Ig(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return Z(e===null||typeof e=="string"),new Dt(e)}},Ob=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Dt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Lb=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Ob(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Dt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Fb=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Vb=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,F("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Z(typeof t.token=="string"),this.R=t.token,new Fb(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function A8(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Eg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=A8(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function he(n,e){return n<e?-1:n>e?1:0}function $c(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function iL(n){return n+"\0"}var nt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new L(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?he(this.nanoseconds,e.nanoseconds):he(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var ee=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new nt(0,0))}static max(){return new n(new nt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Tg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&Y(),r===void 0?r=e.length-t:r>e.length-t&&Y(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},xe=class n extends Tg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new L(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},R8=/^[_a-zA-Z][_a-zA-Z0-9]*$/,gt=class n extends Tg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return R8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new L(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new L(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new L(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new L(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var G=class n{constructor(e){this.path=e}static fromPath(e){return new n(xe.fromString(e))}static fromName(e){return new n(xe.fromString(e).popFirst(5))}static empty(){return new n(xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return xe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new xe(e.slice()))}};var Hc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function Ub(n){return n.fields.find(e=>e.kind===2)}function Bo(n){return n.fields.filter(e=>e.kind!==2)}Hc.UNKNOWN_ID=-1;var Uc=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var $d=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,er.min())}};function sL(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ee.fromTimestamp(r===1e9?new nt(t+1,0):new nt(t,r));return new er(i,G.empty(),e)}function oL(n){return new er(n.readTime,n.key,-1)}var er=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(ee.min(),G.empty(),-1)}static max(){return new n(ee.max(),G.empty(),-1)}};function k0(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=G.comparator(n.documentKey,e.documentKey),t!==0?t:he(n.largestBatchId,e.largestBatchId))}var aL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",bg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ls(n){return g(this,null,function*(){if(n.code!==P.FAILED_PRECONDITION||n.message!==aL)throw n;F("LocalStore","Unexpectedly lost primary lease")})}var x=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var Cg=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new mt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Go(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=O0(r.target.error);this.V.reject(new Go(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new Go(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(F("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new jb(t)}},Ds=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(je())===12.2&&pt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return F("SimpleDb","Removing database:",e),jo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!as())return!1;if(n.C())return!0;let e=je(),t=n.S(e),r=0<t&&t<10,i=cL(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return g(this,null,function*(){return this.db||(F("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new Go(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new L(P.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new L(P.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Go(e,o))},i.onupgradeneeded=s=>{F("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{F("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return g(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=Cg.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),x.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(F("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function cL(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var Bb=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return jo(this.B.delete())}},Go=class extends L{constructor(e,t){super(P.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Fs(n){return n.name==="IndexedDbTransactionError"}var jb=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(F("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(F("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),jo(r)}add(e){return F("SimpleDb","ADD",this.store.name,e,e),jo(this.store.add(e))}get(e){return jo(this.store.get(e)).next(t=>(t===void 0&&(t=null),F("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return F("SimpleDb","DELETE",this.store.name,e),jo(this.store.delete(e))}count(){return F("SimpleDb","COUNT",this.store.name),jo(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new x((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new x((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){F("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new x((r,i)=>{t.onerror=s=>{let o=O0(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new x((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new Bb(a),l=t(a.primaryKey,a.value,c);if(l instanceof x){let d=l.catch(h=>(c.done(),x.reject(h)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>x.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function jo(n){return new x((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=O0(r.target.error);t(i)}})}var n1=!1;function O0(n){let e=Ds.S(je());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new L("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return n1||(n1=!0,setTimeout(()=>{throw r},0)),r}}return n}var $b=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){F("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{F("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){Fs(t)?F("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield Ls(t)}yield this.X(6e4)}))}},Hb=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return x.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return F("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(F("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=oL(s);k0(o,r)>0&&(r=o)}),new er(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var On=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function uh(n){return n==null}function Hd(n){return n===0&&1/n==-1/0}function lL(n){return typeof n=="number"&&Number.isInteger(n)&&!Hd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function pn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=r1(e)),e=x8(n.get(t),e);return r1(e)}function x8(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function r1(n){return n+""}function ei(n){let e=n.length;if(Z(e>=2),e===2)return Z(n.charAt(0)===""&&n.charAt(1)===""),xe.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&Y(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:Y()}s=o+2}return new xe(r)}var i1=["userId","batchId"];function mg(n,e){return[n,pn(e)]}function uL(n,e,t){return[n,pn(e),t]}var N8={},P8=["prefixPath","collectionGroup","readTime","documentId"],M8=["prefixPath","collectionGroup","documentId"],k8=["collectionGroup","readTime","prefixPath","documentId"],O8=["canonicalId","targetId"],L8=["targetId","path"],F8=["path","targetId"],V8=["collectionId","parent"],U8=["indexId","uid"],B8=["uid","sequenceNumber"],j8=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],$8=["indexId","uid","orderedDocumentKey"],H8=["userId","collectionPath","documentId"],q8=["userId","collectionPath","largestBatchId"],z8=["userId","collectionGroup","largestBatchId"],dL=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],G8=[...dL,"documentOverlays"],hL=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],fL=hL,pL=[...fL,"indexConfiguration","indexState","indexEntries"],W8=pL;var qd=class extends bg{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Ft(n,e){let t=z(n);return Ds.F(t._e,e)}function s1(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ia(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function K8(n,e){let t=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function mL(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ye=class n{constructor(e,t){this.comparator=e,this.root=t||ni.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ni.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ni.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vc(this.root,e,this.comparator,!0)}},Vc=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ni=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Y();let e=this.left.check();if(e!==this.right.check())throw Y();return e+(this.isRed()?0:1)}};ni.EMPTY=null,ni.RED=!0,ni.BLACK=!1;ni.EMPTY=new class{constructor(){this.size=0}get key(){throw Y()}get value(){throw Y()}get color(){throw Y()}get left(){throw Y()}get right(){throw Y()}copy(e,t,r,i,s){return this}insert(e,t,r){return new ni(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var $e=class n{constructor(e){this.comparator=e,this.data=new Ye(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Sg(this.data.getIterator())}getIteratorFrom(e){return new Sg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Sg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function xc(n){return n.hasNext()?n.getNext():void 0}var Ln=class n{constructor(e){this.fields=e,e.sort(gt.comparator)}static empty(){return new n([])}unionWith(e){let t=new $e(gt.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return $c(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Dg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function gL(){return typeof atob<"u"}var Lt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Dg("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return he(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Lt.EMPTY_BYTE_STRING=new Lt("");var Q8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Oi(n){if(Z(!!n),typeof n=="string"){let e=0,t=Q8.exec(n);if(Z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ut(n.seconds),nanos:ut(n.nanos)}}function ut(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function As(n){return typeof n=="string"?Lt.fromBase64String(n):Lt.fromUint8Array(n)}function __(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function L0(n){let e=n.mapValue.fields.__previous_value__;return __(e)?L0(e):e}function zd(n){let e=Oi(n.mapValue.fields.__local_write_time__.timestampValue);return new nt(e.seconds,e.nanos)}var qb=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Rs=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var bs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},gg={nullValue:"NULL_VALUE"};function Wo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?__(n)?4:_L(n)?9007199254740991:10:Y()}function si(n,e){if(n===e)return!0;let t=Wo(n);if(t!==Wo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return zd(n).isEqual(zd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Oi(i.timestampValue),a=Oi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return As(i.bytesValue).isEqual(As(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return ut(i.geoPointValue.latitude)===ut(s.geoPointValue.latitude)&&ut(i.geoPointValue.longitude)===ut(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ut(i.integerValue)===ut(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=ut(i.doubleValue),a=ut(s.doubleValue);return o===a?Hd(o)===Hd(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return $c(n.arrayValue.values||[],e.arrayValue.values||[],si);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(s1(o)!==s1(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!si(o[c],a[c])))return!1;return!0}(n,e);default:return Y()}}function Gd(n,e){return(n.values||[]).find(t=>si(t,e))!==void 0}function xs(n,e){if(n===e)return 0;let t=Wo(n),r=Wo(e);if(t!==r)return he(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return he(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=ut(s.integerValue||s.doubleValue),c=ut(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return o1(n.timestampValue,e.timestampValue);case 4:return o1(zd(n),zd(e));case 5:return he(n.stringValue,e.stringValue);case 6:return function(s,o){let a=As(s),c=As(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=he(a[l],c[l]);if(d!==0)return d}return he(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=he(ut(s.latitude),ut(o.latitude));return a!==0?a:he(ut(s.longitude),ut(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){let d=xs(a[l],c[l]);if(d)return d}return he(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===bs.mapValue&&o===bs.mapValue)return 0;if(s===bs.mapValue)return 1;if(o===bs.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let p=he(c[h],d[h]);if(p!==0)return p;let _=xs(a[c[h]],l[d[h]]);if(_!==0)return _}return he(c.length,d.length)}(n.mapValue,e.mapValue);default:throw Y()}}function o1(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return he(n,e);let t=Oi(n),r=Oi(e),i=he(t.seconds,r.seconds);return i!==0?i:he(t.nanos,r.nanos)}function qc(n){return zb(n)}function zb(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Oi(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return As(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return G.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=zb(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${zb(t.fields[o])}`;return i+"}"}(n.mapValue):Y()}function Ko(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Gb(n){return!!n&&"integerValue"in n}function Wd(n){return!!n&&"arrayValue"in n}function a1(n){return!!n&&"nullValue"in n}function c1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function _g(n){return!!n&&"mapValue"in n}function Fd(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return ia(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Fd(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Fd(n.arrayValue.values[t]);return e}return Object.assign({},n)}function _L(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function Y8(n){return"nullValue"in n?gg:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ko(Rs.empty(),G.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Y()}function J8(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ko(Rs.empty(),G.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?bs:Y()}function l1(n,e){let t=xs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function u1(n,e){let t=xs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var tn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!_g(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fd(t)}setAll(e){let t=gt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Fd(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());_g(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return si(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];_g(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ia(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Fd(this.value))}};function yL(n){let e=[];return ia(n.fields,(t,r)=>{let i=new gt([t]);if(_g(r)){let s=yL(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Ln(e)}var At=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,ee.min(),ee.min(),ee.min(),tn.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,ee.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,ee.min(),ee.min(),tn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ee.min(),ee.min(),tn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=tn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=tn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var oi=class{constructor(e,t){this.position=e,this.inclusive=t}};function d1(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),t.key):r=xs(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function h1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!si(n.position[t],e.position[t]))return!1;return!0}var Qo=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function X8(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ag=class{},Te=class n extends Ag{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Qb(e,t,r):t==="array-contains"?new Xb(e,r):t==="in"?new Rg(e,r):t==="not-in"?new Zb(e,r):t==="array-contains-any"?new eC(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Yb(e,r):new Jb(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(xs(t,this.value)):t!==null&&Wo(this.value)===Wo(t)&&this.matchesComparison(xs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Le=class n extends Ag{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return zc(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function zc(n){return n.op==="and"}function Wb(n){return n.op==="or"}function F0(n){return vL(n)&&zc(n)}function vL(n){for(let e of n.filters)if(e instanceof Le)return!1;return!0}function Kb(n){if(n instanceof Te)return n.field.canonicalString()+n.op.toString()+qc(n.value);if(F0(n))return n.filters.map(e=>Kb(e)).join(",");{let e=n.filters.map(t=>Kb(t)).join(",");return`${n.op}(${e})`}}function wL(n,e){return n instanceof Te?function(r,i){return i instanceof Te&&r.op===i.op&&r.field.isEqual(i.field)&&si(r.value,i.value)}(n,e):n instanceof Le?function(r,i){return i instanceof Le&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&wL(o,i.filters[a]),!0):!1}(n,e):void Y()}function IL(n,e){let t=n.filters.concat(e);return Le.create(t,n.op)}function EL(n){return n instanceof Te?function(t){return`${t.field.canonicalString()} ${t.op} ${qc(t.value)}`}(n):n instanceof Le?function(t){return t.op.toString()+" {"+t.getFilters().map(EL).join(" ,")+"}"}(n):"Filter"}var Qb=class extends Te{constructor(e,t,r){super(e,t,r),this.key=G.fromName(r.referenceValue)}matches(e){let t=G.comparator(e.key,this.key);return this.matchesComparison(t)}},Yb=class extends Te{constructor(e,t){super(e,"in",t),this.keys=TL("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Jb=class extends Te{constructor(e,t){super(e,"not-in",t),this.keys=TL("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function TL(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>G.fromName(r.referenceValue))}var Xb=class extends Te{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Wd(t)&&Gd(t.arrayValue,this.value)}},Rg=class extends Te{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Gd(this.value.arrayValue,t)}},Zb=class extends Te{constructor(e,t){super(e,"not-in",t)}matches(e){if(Gd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Gd(this.value.arrayValue,t)}},eC=class extends Te{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Wd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Gd(this.value.arrayValue,r))}};var tC=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function nC(n,e=null,t=[],r=[],i=null,s=null,o=null){return new tC(n,e,t,r,i,s,o)}function Yo(n){let e=z(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Kb(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),uh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>qc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>qc(r)).join(",")),e.ue=t}return e.ue}function dh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!X8(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!wL(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!h1(n.startAt,e.startAt)&&h1(n.endAt,e.endAt)}function xg(n){return G.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ng(n,e){return n.filters.filter(t=>t instanceof Te&&t.field.isEqual(e))}function f1(n,e,t){let r=gg,i=!0;for(let s of Ng(n,e)){let o=gg,a=!0;switch(s.op){case"<":case"<=":o=Y8(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=gg}l1({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];l1({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function p1(n,e,t){let r=bs,i=!0;for(let s of Ng(n,e)){let o=bs,a=!0;switch(s.op){case">=":case">":o=J8(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=bs}u1({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];u1({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var Ir=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function bL(n,e,t,r,i,s,o,a){return new Ir(n,e,t,r,i,s,o,a)}function ol(n){return new Ir(n)}function m1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function V0(n){return n.collectionGroup!==null}function Bc(n){let e=z(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new $e(gt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Qo(s,r))}),t.has(gt.keyField().canonicalString())||e.ce.push(new Qo(gt.keyField(),r))}return e.ce}function mn(n){let e=z(n);return e.le||(e.le=CL(e,Bc(n))),e.le}function Z8(n){let e=z(n);return e.he||(e.he=CL(e,n.explicitOrderBy)),e.he}function CL(n,e){if(n.limitType==="F")return nC(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Qo(i.field,s)});let t=n.endAt?new oi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new oi(n.startAt.position,n.startAt.inclusive):null;return nC(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function rC(n,e){let t=n.filters.concat([e]);return new Ir(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Pg(n,e,t){return new Ir(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function hh(n,e){return dh(mn(n),mn(e))&&n.limitType===e.limitType}function SL(n){return`${Yo(mn(n))}|lt:${n.limitType}`}function Oc(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>EL(i)).join(", ")}]`),uh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>qc(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>qc(i)).join(",")),`Target(${r})`}(mn(n))}; limitType=${n.limitType})`}function fh(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):G.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of Bc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=d1(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,Bc(r),i)||r.endAt&&!function(o,a,c){let l=d1(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,Bc(r),i))}(n,e)}function DL(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function AL(n){return(e,t)=>{let r=!1;for(let i of Bc(n)){let s=eK(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function eK(n,e,t){let r=n.field.isKeyField()?G.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?xs(c,l):Y()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Y()}}var ai=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ia(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return mL(this.inner)}size(){return this.innerSize}};var tK=new Ye(G.comparator);function An(){return tK}var RL=new Ye(G.comparator);function Od(...n){let e=RL;for(let t of n)e=e.insert(t.key,t);return e}function xL(n){let e=RL;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function ti(){return Vd()}function NL(){return Vd()}function Vd(){return new ai(n=>n.toString(),(n,e)=>n.isEqual(e))}var nK=new Ye(G.comparator),rK=new $e(G.comparator);function pe(...n){let e=rK;for(let t of n)e=e.add(t);return e}var iK=new $e(he);function U0(){return iK}function PL(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hd(e)?"-0":e}}function ML(n){return{integerValue:""+n}}function kL(n,e){return lL(e)?ML(e):PL(n,e)}var Gc=class{constructor(){this._=void 0}};function sK(n,e,t){return n instanceof Ns?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&__(s)&&(s=L0(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Li?LL(n,e):n instanceof Fi?FL(n,e):function(i,s){let o=OL(i,s),a=g1(o)+g1(i.Pe);return Gb(o)&&Gb(i.Pe)?ML(a):PL(i.serializer,a)}(n,e)}function oK(n,e,t){return n instanceof Li?LL(n,e):n instanceof Fi?FL(n,e):t}function OL(n,e){return n instanceof Ps?function(r){return Gb(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Ns=class extends Gc{},Li=class extends Gc{constructor(e){super(),this.elements=e}};function LL(n,e){let t=VL(e);for(let r of n.elements)t.some(i=>si(i,r))||t.push(r);return{arrayValue:{values:t}}}var Fi=class extends Gc{constructor(e){super(),this.elements=e}};function FL(n,e){let t=VL(e);for(let r of n.elements)t=t.filter(i=>!si(i,r));return{arrayValue:{values:t}}}var Ps=class extends Gc{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function g1(n){return ut(n.integerValue||n.doubleValue)}function VL(n){return Wd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Jo=class{constructor(e,t){this.field=e,this.transform=t}};function aK(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Li&&i instanceof Li||r instanceof Fi&&i instanceof Fi?$c(r.elements,i.elements,si):r instanceof Ps&&i instanceof Ps?si(r.Pe,i.Pe):r instanceof Ns&&i instanceof Ns}(n.transform,e.transform)}var iC=class{constructor(e,t){this.version=e,this.transformResults=t}},dt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function yg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Wc=class{};function UL(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ks(n.key,dt.none()):new Ms(n.key,n.data,dt.none());{let t=n.data,r=tn.empty(),i=new $e(gt.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Er(n.key,r,new Ln(i.toArray()),dt.none())}}function cK(n,e,t){n instanceof Ms?function(i,s,o){let a=i.value.clone(),c=y1(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Er?function(i,s,o){if(!yg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=y1(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(BL(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ud(n,e,t,r){return n instanceof Ms?function(s,o,a,c){if(!yg(s.precondition,o))return a;let l=s.value.clone(),d=v1(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof Er?function(s,o,a,c){if(!yg(s.precondition,o))return a;let l=v1(s.fieldTransforms,c,o),d=o.data;return d.setAll(BL(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return yg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function lK(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=OL(r.transform,i||null);s!=null&&(t===null&&(t=tn.empty()),t.set(r.field,s))}return t||null}function _1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&$c(r,i,(s,o)=>aK(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Ms=class extends Wc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Er=class extends Wc{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function BL(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function y1(n,e,t){let r=new Map;Z(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,oK(o,a,t[i]))}return r}function v1(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,sK(s,o,e))}return r}var ks=class extends Wc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Kd=class extends Wc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Qd=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&cK(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ud(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ud(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=NL();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=UL(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(ee.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),pe())}isEqual(e){return this.batchId===e.batchId&&$c(this.mutations,e.mutations,(t,r)=>_1(t,r))&&$c(this.baseMutations,e.baseMutations,(t,r)=>_1(t,r))}},sC=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Z(e.mutations.length===r.length);let i=function(){return nK}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Yd=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var oC=class{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}};var aC=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ct,Re;function jL(n){switch(n){default:return Y();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function $L(n){if(n===void 0)return pt("GRPC error has no .code"),P.UNKNOWN;switch(n){case Ct.OK:return P.OK;case Ct.CANCELLED:return P.CANCELLED;case Ct.UNKNOWN:return P.UNKNOWN;case Ct.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case Ct.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case Ct.INTERNAL:return P.INTERNAL;case Ct.UNAVAILABLE:return P.UNAVAILABLE;case Ct.UNAUTHENTICATED:return P.UNAUTHENTICATED;case Ct.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case Ct.NOT_FOUND:return P.NOT_FOUND;case Ct.ALREADY_EXISTS:return P.ALREADY_EXISTS;case Ct.PERMISSION_DENIED:return P.PERMISSION_DENIED;case Ct.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case Ct.ABORTED:return P.ABORTED;case Ct.OUT_OF_RANGE:return P.OUT_OF_RANGE;case Ct.UNIMPLEMENTED:return P.UNIMPLEMENTED;case Ct.DATA_LOSS:return P.DATA_LOSS;default:return Y()}}(Re=Ct||(Ct={}))[Re.OK=0]="OK",Re[Re.CANCELLED=1]="CANCELLED",Re[Re.UNKNOWN=2]="UNKNOWN",Re[Re.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Re[Re.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Re[Re.NOT_FOUND=5]="NOT_FOUND",Re[Re.ALREADY_EXISTS=6]="ALREADY_EXISTS",Re[Re.PERMISSION_DENIED=7]="PERMISSION_DENIED",Re[Re.UNAUTHENTICATED=16]="UNAUTHENTICATED",Re[Re.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Re[Re.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Re[Re.ABORTED=10]="ABORTED",Re[Re.OUT_OF_RANGE=11]="OUT_OF_RANGE",Re[Re.UNIMPLEMENTED=12]="UNIMPLEMENTED",Re[Re.INTERNAL=13]="INTERNAL",Re[Re.UNAVAILABLE=14]="UNAVAILABLE",Re[Re.DATA_LOSS=15]="DATA_LOSS";var w1=null;function HL(){return new TextEncoder}var uK=new ys([4294967295,4294967295],0);function I1(n){let e=HL().encode(n),t=new Ib;return t.update(e),new Uint8Array(t.digest())}function E1(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ys([t,r],0),new ys([i,s],0)]}var cC=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new zo(`Invalid padding: ${t}`);if(r<0)throw new zo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new zo(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new zo(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ys.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(ys.fromNumber(r)));return i.compare(uK)===1&&(i=new ys([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=I1(e),[r,i]=E1(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=I1(e),[r,i]=E1(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},zo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Jd=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Xd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(ee.min(),i,new Ye(he),An(),pe())}},Xd=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,pe(),pe(),pe())}};var jc=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Mg=class{constructor(e,t){this.targetId=e,this.me=t}},kg=class{constructor(e,t,r=Lt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Og=class{constructor(){this.fe=0,this.ge=b1(),this.pe=Lt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=pe(),t=pe(),r=pe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Y()}}),new Xd(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=b1()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},lC=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=An(),this.qe=T1(),this.Qe=new Ye(he)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Y()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(xg(s))if(r===0){let o=new G(s.path);this.Ue(t,o,At.newNoDocument(o,ee.min()))}else Z(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}w1?.et(function(d,h,p,_,w){var b,S,O,H,V,Q;let ae={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},J=h.unchangedNames;return J&&(ae.bloomFilter={applied:w===0,hashCount:(b=J?.hashCount)!==null&&b!==void 0?b:0,bitmapLength:(H=(O=(S=J?.bits)===null||S===void 0?void 0:S.bitmap)===null||O===void 0?void 0:O.length)!==null&&H!==void 0?H:0,padding:(Q=(V=J?.bits)===null||V===void 0?void 0:V.padding)!==null&&Q!==void 0?Q:0,mightContain:T=>{var v;return(v=_?.mightContain(T))!==null&&v!==void 0&&v}}),ae}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=As(r).toUint8Array()}catch(c){if(c instanceof Dg)return Zn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new cC(o,i,s)}catch(c){return Zn(c instanceof zo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&xg(a.target)){let c=new G(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,At.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let r=pe();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Jd(e,t,this.Qe,this.ke,r);return this.ke=An(),this.qe=T1(),this.Qe=new Ye(he),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Og,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new $e(he),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||F("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Og),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function T1(){return new Ye(G.comparator)}function b1(){return new Ye(G.comparator)}var dK={asc:"ASCENDING",desc:"DESCENDING"},hK={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fK={and:"AND",or:"OR"},uC=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function dC(n,e){return n.useProto3Json||uh(e)?e:{value:e}}function Kc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function pK(n,e){return Kc(n,e.toTimestamp())}function _t(n){return Z(!!n),ee.fromTimestamp(function(t){let r=Oi(t);return new nt(r.seconds,r.nanos)}(n))}function B0(n,e){return hC(n,e).canonicalString()}function hC(n,e){let t=function(i){return new xe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function zL(n){let e=xe.fromString(n);return Z(eF(e)),e}function Zd(n,e){return B0(n.databaseId,e.path)}function ri(n,e){let t=zL(e);if(t.get(1)!==n.databaseId.projectId)throw new L(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new G(KL(t))}function GL(n,e){return B0(n.databaseId,e)}function WL(n){let e=zL(n);return e.length===4?xe.emptyPath():KL(e)}function fC(n){return new xe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function KL(n){return Z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function C1(n,e,t){return{name:Zd(n,e),fields:t.value.mapValue.fields}}function QL(n,e,t){let r=ri(n,e.name),i=_t(e.updateTime),s=e.createTime?_t(e.createTime):ee.min(),o=new tn({mapValue:{fields:e.fields}}),a=At.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function mK(n,e){return"found"in e?function(r,i){Z(!!i.found),i.found.name,i.found.updateTime;let s=ri(r,i.found.name),o=_t(i.found.updateTime),a=i.found.createTime?_t(i.found.createTime):ee.min(),c=new tn({mapValue:{fields:i.found.fields}});return At.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){Z(!!i.missing),Z(!!i.readTime);let s=ri(r,i.missing),o=_t(i.readTime);return At.newNoDocument(s,o)}(n,e):Y()}function gK(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Y()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(Z(d===void 0||typeof d=="string"),Lt.fromBase64String(d||"")):(Z(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Lt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?P.UNKNOWN:$L(l.code);return new L(d,l.message||"")}(o);t=new kg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=ri(n,r.document.name),s=_t(r.document.updateTime),o=r.document.createTime?_t(r.document.createTime):ee.min(),a=new tn({mapValue:{fields:r.document.fields}}),c=At.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new jc(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=ri(n,r.document),s=r.readTime?_t(r.readTime):ee.min(),o=At.newNoDocument(i,s),a=r.removedTargetIds||[];t=new jc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=ri(n,r.document),s=r.removedTargetIds||[];t=new jc([],s,i,null)}else{if(!("filter"in e))return Y();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new aC(i,s),a=r.targetId;t=new Mg(a,o)}}return t}function eh(n,e){let t;if(e instanceof Ms)t={update:C1(n,e.key,e.value)};else if(e instanceof ks)t={delete:Zd(n,e.key)};else if(e instanceof Er)t={update:C1(n,e.key,e.data),updateMask:TK(e.fieldMask)};else{if(!(e instanceof Kd))return Y();t={verify:Zd(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Ns)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Li)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Fi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ps)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Y()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:pK(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Y()}(n,e.precondition)),t}function pC(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?dt.updateTime(_t(s.updateTime)):s.exists!==void 0?dt.exists(s.exists):dt.none()}(e.currentDocument):dt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)Z(a.setToServerValue==="REQUEST_TIME"),c=new Ns;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new Li(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new Fi(d)}else"increment"in a?c=new Ps(o,a.increment):Y();let l=gt.fromServerFormat(a.fieldPath);return new Jo(l,c)}(n,i)):[];if(e.update){e.update.name;let i=ri(n,e.update.name),s=new tn({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new Ln(l.map(d=>gt.fromServerFormat(d)))}(e.updateMask);return new Er(i,s,o,t,r)}return new Ms(i,s,t,r)}if(e.delete){let i=ri(n,e.delete);return new ks(i,t)}if(e.verify){let i=ri(n,e.verify);return new Kd(i,t)}return Y()}function _K(n,e){return n&&n.length>0?(Z(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?_t(i.updateTime):_t(s);return o.isEqual(ee.min())&&(o=_t(s)),new iC(o,i.transformResults||[])}(t,e))):[]}function YL(n,e){return{documents:[GL(n,e.path)]}}function j0(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=GL(n,i);let s=function(l){if(l.length!==0)return ZL(Le.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(p){return{field:Is(p.field),direction:wK(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=dC(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function yK(n,e,t,r){let{_t:i,parent:s}=j0(n,e),o={},a=[],c=0;return t.forEach(l=>{let d=r?l.alias:"aggregate_"+c++;o[d]=l.alias,l.aggregateType==="count"?a.push({alias:d,count:{}}):l.aggregateType==="avg"?a.push({alias:d,avg:{field:Is(l.fieldPath)}}):l.aggregateType==="sum"&&a.push({alias:d,sum:{field:Is(l.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},ut:o,parent:s}}function JL(n){let e=WL(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Z(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let p=XL(h);return p instanceof Le&&F0(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(p=>function(w){return new Qo(Lc(w.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,uh(p)?null:p}(t.limit));let c=null;t.startAt&&(c=function(h){let p=!!h.before,_=h.values||[];return new oi(_,p)}(t.startAt));let l=null;return t.endAt&&(l=function(h){let p=!h.before,_=h.values||[];return new oi(_,p)}(t.endAt)),bL(e,i,o,s,a,"F",c,l)}function vK(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function XL(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Lc(t.unaryFilter.field);return Te.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Lc(t.unaryFilter.field);return Te.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Lc(t.unaryFilter.field);return Te.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Lc(t.unaryFilter.field);return Te.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Y()}}(n):n.fieldFilter!==void 0?function(t){return Te.create(Lc(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Y()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Le.create(t.compositeFilter.filters.map(r=>XL(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Y()}}(t.compositeFilter.op))}(n):Y()}function wK(n){return dK[n]}function IK(n){return hK[n]}function EK(n){return fK[n]}function Is(n){return{fieldPath:n.canonicalString()}}function Lc(n){return gt.fromServerFormat(n.fieldPath)}function ZL(n){return n instanceof Te?function(t){if(t.op==="=="){if(c1(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NAN"}};if(a1(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(c1(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NAN"}};if(a1(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Is(t.field),op:IK(t.op),value:t.value}}}(n):n instanceof Le?function(t){let r=t.getFilters().map(i=>ZL(i));return r.length===1?r[0]:{compositeFilter:{op:EK(t.op),filters:r}}}(n):Y()}function TK(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function eF(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Qc=class n{constructor(e,t,r,i,s=ee.min(),o=ee.min(),a=Lt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Lg=class{constructor(e){this.ct=e}};function bK(n,e){let t;if(e.document)t=QL(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=G.fromSegments(e.noDocument.path),i=Zo(e.noDocument.readTime);t=At.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Y();{let r=G.fromSegments(e.unknownDocument.path),i=Zo(e.unknownDocument.version);t=At.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new nt(i[0],i[1]);return ee.fromTimestamp(s)}(e.readTime)),t}function S1(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Fg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Zd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Kc(s,o.version.toTimestamp()),createTime:Kc(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Xo(e.version)};else{if(!e.isUnknownDocument())return Y();r.unknownDocument={path:t.path.toArray(),version:Xo(e.version)}}return r}function Fg(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Xo(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Zo(n){let e=new nt(n.seconds,n.nanoseconds);return ee.fromTimestamp(e)}function $o(n,e){let t=(e.baseMutations||[]).map(s=>pC(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>pC(n.ct,s)),i=nt.fromMillis(e.localWriteTimeMs);return new Qd(e.batchId,i,t,r)}function Ld(n){let e=Zo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Zo(n.lastLimboFreeSnapshotVersion):ee.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return Z(s.documents.length===1),mn(ol(WL(s.documents[0])))}(n.query):function(s){return mn(JL(s))}(n.query),new Qc(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Lt.fromBase64String(n.resumeToken))}function tF(n,e){let t=Xo(e.snapshotVersion),r=Xo(e.lastLimboFreeSnapshotVersion),i;i=xg(e.target)?YL(n.ct,e.target):j0(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Yo(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function $0(n){let e=JL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Pg(e,e.limit,"L"):e}function Ab(n,e){return new Yd(e.largestBatchId,pC(n.ct,e.overlayMutation))}function D1(n,e){let t=e.path.lastSegment();return[n,pn(e.path.popLast()),t]}function A1(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Xo(r.readTime),documentKey:pn(r.documentKey.path),largestBatchId:r.largestBatchId}}var mC=class{getBundleMetadata(e,t){return R1(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Zo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return R1(e).put(function(i){return{bundleId:i.id,createTime:Xo(_t(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return x1(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:$0(s.bundledQuery),readTime:Zo(s.readTime)}}(r)})}saveNamedQuery(e,t){return x1(e).put(function(i){return{name:i.name,readTime:Xo(_t(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function R1(n){return Ft(n,"bundles")}function x1(n){return Ft(n,"namedQueries")}var Vg=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Nd(e).get(D1(this.userId,t)).next(r=>r?Ab(this.serializer,r):null)}getOverlays(e,t){let r=ti();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new Yd(t,o);i.push(this.ht(e,a))}),x.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(pn(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Nd(e).j("collectionPathOverlayIndex",a))}),x.waitFor(s)}getOverlaysForCollection(e,t,r){let i=ti(),s=pn(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Nd(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=Ab(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=ti(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Nd(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,d)=>{let h=Ab(this.serializer,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return Nd(e).put(function(i,s,o){let[a,c,l]=D1(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:eh(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function Nd(n){return Ft(n,"documentOverlays")}var Mi=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(ut(e.integerValue));else if("doubleValue"in e){let r=ut(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),Hd(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=Oi(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(As(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?_L(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):Y()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),G.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};Mi.bt=new Mi;function CK(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function N1(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=CK(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var gC=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ct(r.value),r=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Mt(r.value),r=t.next();this.xt()}Ot(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let t=this.Bt(e),r=N1(t);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){let t=this.Bt(e),r=N1(t);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},_C=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},yC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Ho=class{constructor(){this.Gt=new gC,this.zt=new _C(this.Gt),this.jt=new yC(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var qo=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function vs(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=P1(n.arrayValue,e.arrayValue),t!==0?t:(t=P1(n.directionalValue,e.directionalValue),t!==0?t:G.comparator(n.documentKey,e.documentKey)))}function P1(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Ug=class{constructor(e){this.Yt=new $e((t,r)=>gt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let r=t;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(Z(e.collectionGroup===this.collectionId),this.en)return!1;let t=Ub(e);if(t!==void 0&&!this.nn(t))return!1;let r=Bo(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new $e(gt.comparator),t=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Uc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Uc(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Uc(r.field,r.dir==="asc"?0:1)));return new Hc(Hc.UNKNOWN_ID,this.collectionId,t,$d.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function nF(n){var e,t;if(Z(n instanceof Te||n instanceof Le),n instanceof Te){if(n instanceof Rg){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Te.create(n.field,"==",s)))||[];return Le.create(i,"or")}return n}let r=n.filters.map(i=>nF(i));return Le.create(r,n.op)}function SK(n){if(n.getFilters().length===0)return[];let e=IC(nF(n));return Z(rF(e)),vC(e)||wC(e)?[e]:e.getFilters()}function vC(n){return n instanceof Te}function wC(n){return n instanceof Le&&F0(n)}function rF(n){return vC(n)||wC(n)||function(t){if(t instanceof Le&&Wb(t)){for(let r of t.getFilters())if(!vC(r)&&!wC(r))return!1;return!0}return!1}(n)}function IC(n){if(Z(n instanceof Te||n instanceof Le),n instanceof Te)return n;if(n.filters.length===1)return IC(n.filters[0]);let e=n.filters.map(r=>IC(r)),t=Le.create(e,n.op);return t=Bg(t),rF(t)?t:(Z(t instanceof Le),Z(zc(t)),Z(t.filters.length>1),t.filters.reduce((r,i)=>H0(r,i)))}function H0(n,e){let t;return Z(n instanceof Te||n instanceof Le),Z(e instanceof Te||e instanceof Le),t=n instanceof Te?e instanceof Te?function(i,s){return Le.create([i,s],"and")}(n,e):M1(n,e):e instanceof Te?M1(e,n):function(i,s){if(Z(i.filters.length>0&&s.filters.length>0),zc(i)&&zc(s))return IL(i,s.getFilters());let o=Wb(i)?i:s,a=Wb(i)?s:i,c=o.filters.map(l=>H0(l,a));return Le.create(c,"or")}(n,e),Bg(t)}function M1(n,e){if(zc(e))return IL(e,n.getFilters());{let t=e.filters.map(r=>H0(n,r));return Le.create(t,"or")}}function Bg(n){if(Z(n instanceof Te||n instanceof Le),n instanceof Te)return n;let e=n.getFilters();if(e.length===1)return Bg(e[0]);if(vL(n))return n;let t=e.map(i=>Bg(i)),r=[];return t.forEach(i=>{i instanceof Te?r.push(i):i instanceof Le&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Le.create(r,n.op)}var EC=class{constructor(){this._n=new th}addToCollectionParentIndex(e,t){return this._n.add(t),x.resolve()}getCollectionParents(e,t){return x.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return x.resolve()}deleteFieldIndex(e,t){return x.resolve()}deleteAllFieldIndexes(e){return x.resolve()}createTargetIndexes(e,t){return x.resolve()}getDocumentsMatchingTarget(e,t){return x.resolve(null)}getIndexType(e,t){return x.resolve(0)}getFieldIndexes(e,t){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,t){return x.resolve(er.min())}getMinOffsetFromCollectionGroup(e,t){return x.resolve(er.min())}updateCollectionGroup(e,t,r){return x.resolve()}updateIndexEntries(e,t){return x.resolve()}},th=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new $e(xe.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new $e(xe.comparator)).toArray()}};var dg=new Uint8Array(0),TC=class{constructor(e,t){this.databaseId=t,this.an=new th,this.un=new ai(r=>Yo(r),(r,i)=>dh(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:r,parent:pn(i)};return k1(e).put(s)}return x.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[iL(t),""],!1,!0);return k1(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(ei(o.parent))}return r})}addFieldIndex(e,t){let r=Pd(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=Pc(e);return s.next(a=>{o.put(A1(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=Pd(e),i=Pc(e),s=Nc(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Pd(e),r=Nc(e),i=Pc(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return x.forEach(this.cn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Ug(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=Nc(e),i=!0,s=new Map;return x.forEach(this.cn(t),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=pe(),a=[];return x.forEach(s,(c,l)=>{F("IndexedDbIndexManager",`Using index ${function(V){return`id=${V.indexId}|cg=${V.collectionGroup}|f=${V.fields.map(Q=>`${Q.fieldPath}:${Q.kind}`).join(",")}`}(c)} to execute ${Yo(t)}`);let d=function(V,Q){let ae=Ub(Q);if(ae===void 0)return null;for(let J of Ng(V,ae.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null}(l,c),h=function(V,Q){let ae=new Map;for(let J of Bo(Q))for(let T of Ng(V,J.fieldPath))switch(T.op){case"==":case"in":ae.set(J.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return ae.set(J.fieldPath.canonicalString(),T.value),Array.from(ae.values())}return null}(l,c),p=function(V,Q){let ae=[],J=!0;for(let T of Bo(Q)){let v=T.kind===0?f1(V,T.fieldPath,V.startAt):p1(V,T.fieldPath,V.startAt);ae.push(v.value),J&&(J=v.inclusive)}return new oi(ae,J)}(l,c),_=function(V,Q){let ae=[],J=!0;for(let T of Bo(Q)){let v=T.kind===0?p1(V,T.fieldPath,V.endAt):f1(V,T.fieldPath,V.endAt);ae.push(v.value),J&&(J=v.inclusive)}return new oi(ae,J)}(l,c),w=this.hn(c,l,p),b=this.hn(c,l,_),S=this.Pn(c,l,h),O=this.In(c.indexId,d,w,p.inclusive,b,_.inclusive,S);return x.forEach(O,H=>r.G(H,t.limit).next(V=>{V.forEach(Q=>{let ae=G.fromSegments(Q.documentKey);o.has(ae)||(o=o.add(ae),a.push(ae))})}))}).next(()=>a)}return x.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=SK(Le.create(e.filters,"and")).map(r=>nC(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),l=c/(t!=null?t.length:1),d=[];for(let h=0;h<c;++h){let p=t?this.Tn(t[h/l]):dg,_=this.En(e,p,r[h%l],i),w=this.dn(e,p,s[h%l],o),b=a.map(S=>this.En(e,p,S,!0));d.push(...this.createRange(_,w,b))}return d}En(e,t,r,i){let s=new qo(e,G.empty(),t,r);return i?s:s.Jt()}dn(e,t,r,i){let s=new qo(e,G.empty(),t,r);return i?s.Jt():s}ln(e,t){let r=new Ug(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.cn(t);return x.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new $e(gt.comparator),d=!1;for(let h of c.filters)for(let p of h.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?d=!0:l=l.add(p.field));for(let h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}An(e,t){let r=new Ho;for(let i of Bo(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Mi.bt.Pt(s,o)}return r.Wt()}Tn(e){let t=new Ho;return Mi.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let r=new Ho;return Mi.bt.Pt(Ko(this.databaseId,t),r.Ht(function(s){let o=Bo(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,t,r){if(r===null)return[];let i=[];i.push(new Ho);let s=0;for(let o of Bo(e)){let a=r[s++];for(let c of i)if(this.Vn(t,o.fieldPath)&&Wd(a))i=this.mn(i,o,a);else{let l=c.Ht(o.kind);Mi.bt.Pt(a,l)}}return this.fn(i)}hn(e,t,r){return this.Pn(e,t,r.position)}fn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Wt();return t}mn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new Ho;c.seed(a.Wt()),Mi.bt.Pt(o,c.Ht(t.kind)),s.push(c)}return s}Vn(e,t){return!!e.filters.find(r=>r instanceof Te&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Pd(e),i=Pc(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return x.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,h){let p=h?new $d(h.sequenceNumber,new er(Zo(h.readTime),new G(ei(h.documentKey)),h.largestBatchId)):$d.empty(),_=d.fields.map(([w,b])=>new Uc(gt.fromServerFormat(w),b));return new Hc(d.indexId,d.collectionGroup,_,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:he(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Pd(e),s=Pc(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>x.forEach(a,c=>s.put(A1(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return x.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?x.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),x.forEach(a,c=>this.pn(e,i,c).next(l=>{let d=this.yn(s,c);return l.isEqual(d)?x.resolve():this.wn(e,s,c,l,d)}))))})}Sn(e,t,r,i){return Nc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,t.key),documentKey:t.key.path.toArray()})}bn(e,t,r,i){return Nc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,t.key),t.key.path.toArray()])}pn(e,t,r){let i=Nc(e),s=new $e(vs);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,t)])},(o,a)=>{s=s.add(new qo(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,t){let r=new $e(vs),i=this.An(t,e);if(i==null)return r;let s=Ub(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Wd(o))for(let a of o.arrayValue.values||[])r=r.add(new qo(t.indexId,e.key,this.Tn(a),i))}else r=r.add(new qo(t.indexId,e.key,dg,i));return r}wn(e,t,r,i,s){F("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,d,h,p){let _=c.getIterator(),w=l.getIterator(),b=xc(_),S=xc(w);for(;b||S;){let O=!1,H=!1;if(b&&S){let V=d(b,S);V<0?H=!0:V>0&&(O=!0)}else b!=null?H=!0:O=!0;O?(h(S),S=xc(w)):H?(p(b),b=xc(_)):(b=xc(_),S=xc(w))}}(i,s,vs,a=>{o.push(this.Sn(e,t,r,a))},a=>{o.push(this.bn(e,t,r,a))}),x.waitFor(o)}gn(e){let t=1;return Pc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>vs(o,a)).filter((o,a,c)=>!a||vs(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=vs(o,e),c=vs(o,t);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,dg,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,dg,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,t){return vs(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(O1)}getMinOffset(e,t){return x.mapArray(this.cn(t),r=>this.ln(e,r).next(i=>i||Y())).next(O1)}};function k1(n){return Ft(n,"collectionParents")}function Nc(n){return Ft(n,"indexEntries")}function Pd(n){return Ft(n,"indexConfiguration")}function Pc(n){return Ft(n,"indexState")}function O1(n){Z(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;k0(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new er(e.readTime,e.documentKey,t)}var L1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Xn=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function iF(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,h,p)=>(a++,p.delete()));s.push(c.next(()=>{Z(a===1)}));let l=[];for(let d of t.mutations){let h=uL(e,d.key.path,t.batchId);s.push(i.delete(h)),l.push(d.key)}return x.waitFor(s).next(()=>l)}function jg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Y();e=n.noDocument}return JSON.stringify(e).length}Xn.DEFAULT_COLLECTION_PERCENTILE=10,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xn.DEFAULT=new Xn(41943040,Xn.DEFAULT_COLLECTION_PERCENTILE,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xn.DISABLED=new Xn(-1,0,0);var $g=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,t,r,i){Z(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ws(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=Fc(e),o=ws(e);return o.add({}).next(a=>{Z(typeof a=="number");let c=new Qd(a,t,r,i),l=function(_,w,b){let S=b.baseMutations.map(H=>eh(_.ct,H)),O=b.mutations.map(H=>eh(_.ct,H));return{userId:w,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:S,mutations:O}}(this.serializer,this.userId,c),d=[],h=new $e((p,_)=>he(p.canonicalString(),_.canonicalString()));for(let p of i){let _=uL(this.userId,p.key.path,a);h=h.add(p.key.path.popLast()),d.push(o.put(l)),d.push(s.put(_,N8))}return h.forEach(p=>{d.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),x.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return ws(e).get(t).next(r=>r?(Z(r.userId===this.userId),$o(this.serializer,r)):null)}vn(e,t){return this.Cn[t]?x.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return ws(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(Z(a.batchId>=r),s=$o(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ws(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ws(e).U("userMutationsIndex",t).next(r=>r.map(i=>$o(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=mg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Fc(e).J({range:i},(o,a,c)=>{let[l,d,h]=o,p=ei(d);if(l===this.userId&&t.path.isEqual(p))return ws(e).get(h).next(_=>{if(!_)throw Y();Z(_.userId===this.userId),s.push($o(this.serializer,_))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new $e(he),i=[];return t.forEach(s=>{let o=mg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Fc(e).J({range:a},(l,d,h)=>{let[p,_,w]=l,b=ei(_);p===this.userId&&s.path.isEqual(b)?r=r.add(w):h.done()});i.push(c)}),x.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=mg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new $e(he);return Fc(e).J({range:o},(c,l,d)=>{let[h,p,_]=c,w=ei(p);h===this.userId&&r.isPrefixOf(w)?w.length===i&&(a=a.add(_)):d.done()}).next(()=>this.Fn(e,a))}Fn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(ws(e).get(s).next(o=>{if(o===null)throw Y();Z(o.userId===this.userId),r.push($o(this.serializer,o))}))}),x.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return iF(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),x.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return x.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Fc(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=ei(s[1]);i.push(c)}else a.done()}).next(()=>{Z(i.length===0)})})}containsKey(e,t){return sF(e,this.userId,t)}xn(e){return oF(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function sF(n,e,t){let r=mg(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Fc(n).J({range:s,H:!0},(a,c,l)=>{let[d,h,p]=a;d===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function ws(n){return Ft(n,"mutations")}function Fc(n){return Ft(n,"documentMutations")}function oF(n){return Ft(n,"mutationQueues")}var Yc=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var bC=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let r=new Yc(t.highestTargetId);return t.highestTargetId=r.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>ee.fromTimestamp(new nt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(t,r),this.kn(e,r))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Mc(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(Z(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return Mc(e).J((o,a)=>{let c=Ld(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>x.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Mc(e).J((r,i)=>{let s=Ld(i);t(s)})}Bn(e){return F1(e).get("targetGlobalKey").next(t=>(Z(t!==null),t))}kn(e,t){return F1(e).put("targetGlobalKey",t)}qn(e,t){return Mc(e).put(tF(this.serializer,t))}Qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Yo(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Mc(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=Ld(a);dh(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=Es(e);return t.forEach(o=>{let a=pn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),x.waitFor(i)}removeMatchingKeys(e,t,r){let i=Es(e);return x.forEach(t,s=>{let o=pn(s.path);return x.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=Es(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Es(e),s=pe();return i.J({range:r,H:!0},(o,a,c)=>{let l=ei(o[1]),d=new G(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=pn(t.path),i=IDBKeyRange.bound([r],[iL(r)],!1,!0),s=0;return Es(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return Mc(e).get(t).next(r=>r?Ld(r):null)}};function Mc(n){return Ft(n,"targets")}function F1(n){return Ft(n,"targetGlobal")}function Es(n){return Ft(n,"targetDocuments")}function V1([n,e],[t,r]){let i=he(n,t);return i===0?he(e,r):i}var CC=class{constructor(e){this.Kn=e,this.buffer=new $e(V1),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();V1(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},SC=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){F("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Fs(t)?F("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Ls(t)}yield this.zn(3e5)}))}},DC=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return x.resolve(On.oe);let r=new CC(t);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(F("LruGarbageCollector","Garbage collection skipped; disabled"),x.resolve(L1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(F("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),L1):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let r,i,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(F("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),kc()<=ge.DEBUG&&F("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),x.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function DK(n,e){return new DC(n,e)}var AC=class{constructor(e,t){this.db=e,this.garbageCollector=DK(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Zn(e){let t=0;return this.Jn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(r,i)=>t(i))}addReference(e,t,r){return hg(e,r)}removeReference(e,t,r){return hg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return hg(e,t)}er(e,t){return function(i,s){let o=!1;return oF(i).Y(a=>sF(i,a,s).next(c=>(c&&(o=!0),x.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=t){let c=this.er(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ee.min()),Es(e).delete(function(h){return[0,pn(h.path)]}(o))))});i.push(c)}}).next(()=>x.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return hg(e,t)}Xn(e,t){let r=Es(e),i,s=On.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==On.oe&&t(new G(ei(i)),s),s=l,i=c):s=On.oe}).next(()=>{s!==On.oe&&t(new G(ei(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function hg(n,e){return Es(n).put(function(r,i){return{targetId:0,path:pn(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Hg=class{constructor(){this.changes=new ai(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,At.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?x.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var RC=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Uo(e).put(r)}removeEntry(e,t,r){return Uo(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Fg(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.tr(e,r)))}getEntry(e,t){let r=At.newInvalidDocument(t);return Uo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Md(t))},(i,s)=>{r=this.nr(t,s)}).next(()=>r)}rr(e,t){let r={size:0,document:At.newInvalidDocument(t)};return Uo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Md(t))},(i,s)=>{r={document:this.nr(t,s),size:jg(s)}}).next(()=>r)}getEntries(e,t){let r=An();return this.ir(e,t,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,t){let r=An(),i=new Ye(G.comparator);return this.ir(e,t,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,jg(o))}).next(()=>({documents:r,_r:i}))}ir(e,t,r){if(t.isEmpty())return x.resolve();let i=new $e(j1);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(Md(i.first()),Md(i.last())),o=i.getIterator(),a=o.getNext();return Uo(e).J({index:"documentKeyIndex",range:s},(c,l,d)=>{let h=G.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&j1(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(Md(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Fg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Uo(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=An();for(let h of l){let p=this.nr(G.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);p.isFoundDocument()&&(fh(t,p)||i.has(p.key))&&(d=d.insert(p.key,p))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=An(),o=B1(t,r),a=B1(t,er.max());return Uo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,d)=>{let h=this.nr(G.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new xC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return U1(e).get("remoteDocumentGlobalKey").next(t=>(Z(!!t),t))}tr(e,t){return U1(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let r=bK(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ee.min())))return r}return At.newInvalidDocument(e)}};function aF(n){return new RC(n)}var xC=class extends Hg{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new ai(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new $e((s,o)=>he(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=S1(this.ar.serializer,o);i=i.add(s.path.popLast());let l=jg(c);r+=l-a.size,t.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=S1(this.ar.serializer,o.convertToNoDocument(ee.min()));t.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,r)),x.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(r=>(this.ur.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function U1(n){return Ft(n,"remoteDocumentGlobal")}function Uo(n){return Ft(n,"remoteDocumentsV14")}function Md(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function B1(n,e){let t=e.documentKey.path.toArray();return[n,Fg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function j1(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=he(t[s],r[s]),i)return i;return i=he(t.length,r.length),i||(i=he(t[t.length-2],r[r.length-2]),i||he(t[t.length-1],r[r.length-1]))}var NC=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var qg=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ud(r.mutation,i,Ln.empty(),nt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=pe()){let i=ti();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Od();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=ti();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,pe()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=An(),o=Vd(),a=function(){return Vd()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof Er)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),Ud(d.mutation,l,d.mutation.getFieldMask(),nt.now())):o.set(l.key,Ln.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var h;return a.set(l,new NC(d,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Vd(),i=new Ye((o,a)=>o-a),s=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||Ln.empty();d=a.applyToLocalView(l,d),r.set(c,d);let h=(i.get(a.batchId)||pe()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,h=NL();d.forEach(p=>{if(!s.has(p)){let _=UL(t.get(p),r.get(p));_!==null&&h.set(p,_),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return x.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):V0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):x.resolve(ti()),a=-1,c=s;return o.next(l=>x.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?x.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,pe())).next(d=>({batchId:a,changes:xL(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new G(t)).next(r=>{let i=Od();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Od();return this.indexManager.getCollectionParents(e,s).next(a=>x.forEach(a,c=>{let l=function(h,p){return new Ir(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,p)=>{o=o.insert(h,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,At.newInvalidDocument(d)))});let a=Od();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&Ud(d.mutation,l,Ln.empty(),nt.now()),fh(t,l)&&(a=a.insert(c,l))}),a})}};var PC=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return x.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:_t(i.createTime)}}(t)),x.resolve()}getNamedQuery(e,t){return x.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:$0(i.bundledQuery),readTime:_t(i.readTime)}}(t)),x.resolve()}};var MC=class{constructor(){this.overlays=new Ye(G.comparator),this.hr=new Map}getOverlay(e,t){return x.resolve(this.overlays.get(t))}getOverlays(e,t){let r=ti();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),x.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),x.resolve()}getOverlaysForCollection(e,t,r){let i=ti(),s=t.length+1,o=new G(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return x.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ye((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=ti(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=ti(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return x.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Yd(t,r));let s=this.hr.get(t);s===void 0&&(s=pe(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var nh=class{constructor(){this.Pr=new $e(St.Ir),this.Tr=new $e(St.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new St(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new St(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new G(new xe([])),r=new St(t,e),i=new St(t,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new G(new xe([])),r=new St(t,e),i=new St(t,e+1),s=pe();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new St(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},St=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return G.comparator(e.key,t.key)||he(e.pr,t.pr)}static Er(e,t){return he(e.pr,t.pr)||G.comparator(e.key,t.key)}};var kC=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new $e(St.Ir)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Qd(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new St(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return x.resolve(o)}lookupMutationBatch(e,t){return x.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return x.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new St(t,0),i=new St(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),x.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new $e(he);return t.forEach(i=>{let s=new St(i,0),o=new St(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),x.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;G.isDocumentKey(s)||(s=s.child(""));let o=new St(new G(s),0),a=new $e(he);return this.wr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.pr)),!0)},o),x.resolve(this.Dr(a))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Z(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return x.forEach(t.mutations,i=>{let s=new St(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new St(t,0),i=this.wr.firstAfterOrEqual(r);return x.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var OC=class{constructor(e){this.vr=e,this.docs=function(){return new Ye(G.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return x.resolve(r?r.document.mutableCopy():At.newInvalidDocument(t))}getEntries(e,t){let r=An();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():At.newInvalidDocument(i))}),x.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=An(),o=t.path,a=new G(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||k0(oL(d),r)<=0||(i.has(d.key)||fh(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return x.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Y()}Fr(e,t){return x.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new LC(this)}getSize(e){return x.resolve(this.size)}},LC=class extends Hg{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),x.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var FC=class{constructor(e){this.persistence=e,this.Mr=new ai(t=>Yo(t),dh),this.lastRemoteSnapshotVersion=ee.min(),this.highestTargetId=0,this.Or=0,this.Nr=new nh,this.targetCount=0,this.Lr=Yc.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),x.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new Yc(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,x.resolve()}updateTargetData(e,t){return this.qn(t),x.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),x.waitFor(s).next(()=>i)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return x.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),x.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),x.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),x.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return x.resolve(r)}containsKey(e,t){return x.resolve(this.Nr.containsKey(t))}};var zg=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new On(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new FC(this),this.indexManager=new EC,this.remoteDocumentCache=function(i){return new OC(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Lg(t),this.$r=new PC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new MC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new kC(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){F("MemoryPersistence","Starting transaction:",e);let i=new VC(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return x.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},VC=class extends bg{constructor(e){super(),this.currentSequenceNumber=e}},Gg=class n{constructor(e){this.persistence=e,this.zr=new nh,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw Y()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),x.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),x.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),x.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Jr,r=>{let i=G.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,ee.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return x.or([()=>x.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var UC=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new Cg("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",i1,{unique:!0}),c.createObjectStore("documentMutations")}(e),$1(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=x.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),$1(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ee.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",i1,{unique:!0});let h=l.store("mutations"),p=d.map(_=>h.put(_));return x.waitFor(p)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:H8});l.createIndex("collectionPathOverlayIndex",q8,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",z8,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:P8});l.createIndex("documentKeyIndex",M8),l.createIndex("collectionGroupIndex",k8)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:U8}).createIndex("sequenceNumberIndex",B8,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:j8}).createIndex("documentKeyIndex",$8,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=jg(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>x.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>x.forEach(a,c=>{Z(c.userId===s.userId);let l=$o(this.serializer,c);return iF(e,s.userId,l).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new xe(o),l=function(h){return[0,pn(h)]}(c);s.push(t.get(l).next(d=>d?x.resolve():(h=>t.put({targetId:0,path:pn(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>x.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:V8});let r=t.store("collectionParents"),i=new th,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:pn(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new xe(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],l)=>{let d=ei(a);return s(d.popLast())}))}ri(e){let t=e.store("targets");return t.J((r,i)=>{let s=Ld(i),o=tF(this.serializer,s);return t.put(o)})}ii(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(h){return h.document?new G(xe.fromString(h.document.name).popFirst(5)):h.noDocument?G.fromSegments(h.noDocument.path):h.unknownDocument?G.fromSegments(h.unknownDocument.path):Y()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>x.waitFor(i))}si(e,t){let r=t.store("mutations"),i=aF(this.serializer),s=new zg(Gg.Hr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:pe();$o(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),x.forEach(a,(c,l)=>{let d=new Dt(l),h=Vg.lt(this.serializer,d),p=s.getIndexManager(d),_=$g.lt(d,this.serializer,p,s.referenceDelegate);return new qg(i,_,h,p).recalculateAndSaveOverlaysForDocumentKeys(new qd(t,On.oe),c).next()})})}};function $1(n){n.createObjectStore("targetDocuments",{keyPath:L8}).createIndex("documentTargetsIndex",F8,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",O8,{unique:!0}),n.createObjectStore("targetGlobal")}var Rb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",BC=class n{constructor(e,t,r,i,s,o,a,c,l,d,h=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=l,this.ai=d,this.ui=h,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=p=>Promise.resolve(),!n.D())throw new L(P.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new AC(this,i),this.Ti=t+"main",this.serializer=new Lg(c),this.Ei=new Ds(this.Ti,this.ui,new UC(this.serializer)),this.Qr=new bC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=aF(this.serializer),this.$r=new mC,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,d===!1&&pt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new L(P.FAILED_PRECONDITION,Rb);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new On(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>g(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>g(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>fg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(Fs(e))return F("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return F("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return kd(e).get("owner").next(t=>x.resolve(this.Si(t)))}bi(e){return fg(e).delete(this.clientId)}Di(){return g(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Ft(t,"clientMetadata");return r.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return x.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?x.resolve(!0):kd(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new L(P.FAILED_PRECONDITION,Rb);return!1}}return!(!this.networkEnabled||!this.inForeground)||fg(e).U().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&F("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return g(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new qd(e,On.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(r=>this.Ci(r.updateTimeMs,t)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>fg(e).U().next(t=>this.vi(t,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return $g.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new TC(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Vg.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,r){F("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===16?W8:c===15?pL:c===14?fL:c===13?hL:c===12?G8:c===11?dL:void Y()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new qd(a,this.kr?this.kr.next():On.oe),t==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw pt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new L(P.FAILED_PRECONDITION,aL);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return kd(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new L(P.FAILED_PRECONDITION,Rb)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return kd(e).put("owner",t)}static D(){return Ds.D()}yi(e){let t=kd(e);return t.get("owner").next(r=>this.Si(r)?(F("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):x.resolve())}Ci(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(pt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;IE()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let r=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return F("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return pt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){pt("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function kd(n){return Ft(n,"owner")}function fg(n){return Ft(n,"clientMetadata")}function q0(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var jC=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=pe(),i=pe();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var $C=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Wg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return IE()?8:cL(je())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new $C;return this.Ji(e,t,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(kc()<=ge.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",Oc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),x.resolve()):(kc()<=ge.DEBUG&&F("QueryEngine","Query:",Oc(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(kc()<=ge.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",Oc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,mn(t))):x.resolve())}ji(e,t){if(m1(t))return x.resolve(null);let r=mn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Pg(t,null,"F"),r=mn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=pe(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.Zi(t,a);return this.Xi(t,l,o,c.readTime)?this.ji(e,Pg(t,null,"F")):this.es(e,l,t,c)}))})))}Hi(e,t,r,i){return m1(t)||i.isEqual(ee.min())?x.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,r,i)?x.resolve(null):(kc()<=ge.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Oc(t)),this.es(e,o,t,sL(i,-1)).next(a=>a))})}Zi(e,t){let r=new $e(AL(e));return t.forEach((i,s)=>{fh(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return kc()<=ge.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",Oc(t)),this.zi.getDocumentsMatchingQuery(e,t,er.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var HC=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new Ye(he),this.rs=new ai(s=>Yo(s),dh),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qg(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function cF(n,e,t,r){return new HC(n,e,t,r)}function lF(n,e){return g(this,null,function*(){let t=z(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=pe();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})})}function AK(n,e){let t=z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let h=l.batch,p=h.keys(),_=x.resolve();return p.forEach(w=>{_=_.next(()=>d.getEntry(c,w)).next(b=>{let S=l.docVersions.get(w);Z(S!==null),b.version.compareTo(S)<0&&(h.applyToRemoteDocument(b,l),b.isValidDocument()&&(b.setReadTime(l.commitVersion),d.addEntry(b)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=pe();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function uF(n){let e=z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function RK(n,e){let t=z(n),r=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let a=[];e.targetChanges.forEach((d,h)=>{let p=i.get(h);if(!p)return;a.push(t.Qr.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Qr.addMatchingKeys(s,d.addedDocuments,h)));let _=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?_=_.withResumeToken(Lt.EMPTY_BYTE_STRING,ee.min()).withLastLimboFreeSnapshotVersion(ee.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(h,_),function(b,S,O){return b.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(p,_,d)&&a.push(t.Qr.updateTargetData(s,_))});let c=An(),l=pe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(dF(s,o,e.documentUpdates).next(d=>{c=d.cs,l=d.ls})),!r.isEqual(ee.min())){let d=t.Qr.getLastRemoteSnapshotVersion(s).next(h=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return x.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.ns=i,s))}function dF(n,e,t){let r=pe(),i=pe();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=An();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(ee.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):F("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:i}})}function xK(n,e){let t=z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Jc(n,e){let t=z(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,x.resolve(i)):t.Qr.allocateTargetId(r).next(o=>(i=new Qc(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}function Xc(n,e,t){return g(this,null,function*(){let r=z(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Fs(o))throw o;F("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function Kg(n,e,t){let r=z(n),i=ee.min(),s=pe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let h=z(c),p=h.rs.get(d);return p!==void 0?x.resolve(h.ns.get(p)):h.Qr.getTargetData(l,d)}(r,o,mn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?i:ee.min(),t?s:pe())).next(a=>(pF(r,DL(e),a),{documents:a,hs:s})))}function hF(n,e){let t=z(n),r=z(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function fF(n,e){let t=z(n),r=t.ss.get(e)||ee.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,sL(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(pF(t,e,i),i))}function pF(n,e,t){let r=n.ss.get(e)||ee.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}function NK(n,e,t,r){return g(this,null,function*(){let i=z(n),s=pe(),o=An();for(let l of t){let d=e.Ps(l.metadata.name);l.document&&(s=s.add(d));let h=e.Is(l);h.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(d,h)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield Jc(i,function(d){return mn(ol(xe.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>dF(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Qr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.cs,d.ls)).next(()=>d.cs)))})}function PK(r,i){return g(this,arguments,function*(n,e,t=pe()){let s=yield Jc(n,mn($0(e.bundledQuery))),o=z(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=_t(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let l=s.withResumeToken(Lt.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(a,l).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,t,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function H1(n,e){return`firestore_clients_${n}_${e}`}function q1(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function xb(n,e){return`firestore_targets_${n}_${e}`}var Qg=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Es(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new L(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(pt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Bd=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Es(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new L(r.error.code,r.error.message))),s?new n(e,r.state,i):(pt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Yg=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=U0();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=lL(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(pt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},qC=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(pt("SharedClientState",`Failed to parse online state: ${e}`),null)}},rh=class{constructor(){this.activeTargetIds=U0()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},jd=class{constructor(e,t,r,i,s){this.window=e,this.oi=t,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Ye(he),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=H1(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new rh),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(H1(this.persistenceKey,r));if(i){let s=Yg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let r=this.xs(t);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,r){this.Ls(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(xb(this.persistenceKey,e));if(r){let i=Bd.Es(e,r);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(xb(this.persistenceKey,e))}updateQueryState(e,t,r){this.qs(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return F("SharedClientState","READ",e,t),t}setItem(e,t){F("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){F("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(F("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void pt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let r=this.$s(t.key);return this.Us(r,null)}{let r=this.Ws(t.key,t.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let r=this.Gs(t.key,t.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let r=this.js(t.key,t.newValue);if(r)return this.Hs(r)}}else if(t.key===this.vs){if(t.newValue!==null){let r=this.xs(t.newValue);if(r)return this.Os(r)}}else if(t.key===this.Ss){let r=function(s){let o=On.oe;if(s!=null)try{let a=JSON.parse(s);Z(typeof a=="number"),o=a}catch(a){pt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==On.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Fs){let r=this.Js(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,r){let i=new Qg(this.currentUser,e,t,r),s=q1(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let t=q1(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,r){let i=xb(this.persistenceKey,e),s=new Bd(e,t,r);this.setItem(i,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let r=this.$s(e);return Yg.Es(r,t)}Gs(e,t){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Qg.Es(new Dt(s),i,t)}js(e,t){let r=this.Cs.exec(e),i=Number(r[1]);return Bd.Es(i,t)}xs(e){return qC.Es(e)}Js(e){return JSON.parse(e)}zs(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);F("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let r=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=U0();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Jg=class{constructor(){this.no=new rh,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new rh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var zC=class{io(e){}shutdown(){}};var Xg=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){F("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){F("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var pg=null;function Nb(){return pg===null?pg=function(){return 268435456+Math.round(2147483648*Math.random())}():pg++,"0x"+pg.toString(16)}var MK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var GC=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var en="WebChannelConnection",WC=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,o){let a=Nb(),c=this.vo(t,r.toUriEncodedString());F("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(l,s,o),this.Mo(t,c,l,i).then(d=>(F("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Zn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}xo(t,r,i,s,o,a){return this.Co(t,r,i,s,o)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+sl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,r){let i=MK[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=Nb();return new Promise((o,a)=>{let c=new Eb;c.setWithCredentials(!0),c.listenOnce(bb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case xd.NO_ERROR:let d=c.getResponseJson();F(en,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case xd.TIMEOUT:F(en,`RPC '${e}' ${s} timed out`),a(new L(P.DEADLINE_EXCEEDED,"Request time out"));break;case xd.HTTP_ERROR:let h=c.getStatus();if(F(en,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);let _=p?.error;if(_&&_.status&&_.message){let w=function(S){let O=S.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(O)>=0?O:P.UNKNOWN}(_.status);a(new L(w,_.message))}else a(new L(P.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new L(P.UNAVAILABLE,"Connection failed."));break;default:Y()}}finally{F(en,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);F(en,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Oo(e,t,r){let i=Nb(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Db(),a=Sb(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Tb({})),this.Fo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");F(en,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c),p=!1,_=!1,w=new GC({lo:S=>{_?F(en,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(p||(F(en,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),F(en,`RPC '${e}' stream ${i} sending:`,S),h.send(S))},ho:()=>h.close()}),b=(S,O,H)=>{S.listen(O,V=>{try{H(V)}catch(Q){setTimeout(()=>{throw Q},0)}})};return b(h,Rc.EventType.OPEN,()=>{_||(F(en,`RPC '${e}' stream ${i} transport opened.`),w.mo())}),b(h,Rc.EventType.CLOSE,()=>{_||(_=!0,F(en,`RPC '${e}' stream ${i} transport closed`),w.po())}),b(h,Rc.EventType.ERROR,S=>{_||(_=!0,Zn(en,`RPC '${e}' stream ${i} transport errored:`,S),w.po(new L(P.UNAVAILABLE,"The operation could not be completed")))}),b(h,Rc.EventType.MESSAGE,S=>{var O;if(!_){let H=S.data[0];Z(!!H);let V=H,Q=V.error||((O=V[0])===null||O===void 0?void 0:O.error);if(Q){F(en,`RPC '${e}' stream ${i} received error:`,Q);let ae=Q.status,J=function(I){let C=Ct[I];if(C!==void 0)return $L(C)}(ae),T=Q.message;J===void 0&&(J=P.INTERNAL,T="Unknown error status: "+ae+" with message "+Q.message),_=!0,w.po(new L(J,T)),h.close()}else F(en,`RPC '${e}' stream ${i} received:`,H),w.yo(H)}}),b(a,Cb.STAT_EVENT,S=>{S.stat===ug.PROXY?F(en,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===ug.NOPROXY&&F(en,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}};function mF(){return typeof window<"u"?window:null}function vg(){return typeof document<"u"?document:null}function ph(n){return new uC(n,!0)}var ih=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&F("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var Zg=class{constructor(e,t,r,i,s,o,a,c){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new ih(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return g(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return g(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return g(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(pt(t.toString()),pt("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new L(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>g(this,null,function*(){this.state=0,this.start()}))}c_(e){return F("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(F("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},KC=class extends Zg{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=gK(this.serializer,e),r=function(s){if(!("targetChange"in s))return ee.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?ee.min():o.readTime?_t(o.readTime):ee.min()}(e);return this.listener.h_(t,r)}P_(e){let t={};t.database=fC(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=xg(c)?{documents:YL(s,c)}:{query:j0(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=qL(s,o.resumeToken);let l=dC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(ee.min())>0){a.readTime=Kc(s,o.snapshotVersion.toTimestamp());let l=dC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=vK(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){let t={};t.database=fC(this.serializer),t.removeTarget=e,this.i_(t)}},QC=class extends Zg{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(Z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=_K(e.writeResults,e.commitTime),r=_t(e.commitTime);return this.listener.A_(r,t)}return Z(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=fC(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>eh(this.serializer,r))};this.i_(t)}};var YC=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new L(P.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,hC(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(P.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,hC(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new L(P.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},JC=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(pt(t),this.y_=!1):F("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var XC=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>g(this,null,function*(){Vs(this)&&(F("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let l=z(c);l.M_.add(4),yield al(l),l.N_.set("Unknown"),l.M_.delete(4),yield mh(l)})}(this))}))}),this.N_=new JC(r,i)}};function mh(n){return g(this,null,function*(){if(Vs(n))for(let e of n.x_)yield e(!0)})}function al(n){return g(this,null,function*(){for(let e of n.x_)yield e(!1)})}function y_(n,e){let t=z(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),W0(t)?G0(t):ll(t).Xo()&&z0(t,e))}function Zc(n,e){let t=z(n),r=ll(t);t.F_.delete(e),r.Xo()&&gF(t,e),t.F_.size===0&&(r.Xo()?r.n_():Vs(t)&&t.N_.set("Unknown"))}function z0(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ee.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ll(n).P_(e)}function gF(n,e){n.L_.xe(e),ll(n).I_(e)}function G0(n){n.L_=new lC({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),ll(n).start(),n.N_.w_()}function W0(n){return Vs(n)&&!ll(n).Zo()&&n.F_.size>0}function Vs(n){return z(n).M_.size===0}function _F(n){n.L_=void 0}function kK(n){return g(this,null,function*(){n.N_.set("Online")})}function OK(n){return g(this,null,function*(){n.F_.forEach((e,t)=>{z0(n,e)})})}function LK(n,e){return g(this,null,function*(){_F(n),W0(n)?(n.N_.D_(e),G0(n)):n.N_.set("Unknown")})}function FK(n,e,t){return g(this,null,function*(){if(n.N_.set("Online"),e instanceof kg&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(n,e)}catch(r){F("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield e_(n,r)}else if(e instanceof jc?n.L_.Ke(e):e instanceof Mg?n.L_.He(e):n.L_.We(e),!t.isEqual(ee.min()))try{let r=yield uF(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.F_.get(l);d&&s.F_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.F_.get(c);if(!d)return;s.F_.set(c,d.withResumeToken(Lt.EMPTY_BYTE_STRING,d.snapshotVersion)),gF(s,c);let h=new Qc(d.target,c,l,d.sequenceNumber);z0(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){F("RemoteStore","Failed to raise snapshot:",r),yield e_(n,r)}})}function e_(n,e,t){return g(this,null,function*(){if(!Fs(e))throw e;n.M_.add(1),yield al(n),n.N_.set("Offline"),t||(t=()=>uF(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){F("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield mh(n)}))})}function yF(n,e){return e().catch(t=>e_(n,t,e))}function cl(n){return g(this,null,function*(){let e=z(n),t=Os(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;VK(e);)try{let i=yield xK(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,UK(e,i)}catch(i){yield e_(e,i)}vF(e)&&wF(e)})}function VK(n){return Vs(n)&&n.v_.length<10}function UK(n,e){n.v_.push(e);let t=Os(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function vF(n){return Vs(n)&&!Os(n).Zo()&&n.v_.length>0}function wF(n){Os(n).start()}function BK(n){return g(this,null,function*(){Os(n).V_()})}function jK(n){return g(this,null,function*(){let e=Os(n);for(let t of n.v_)e.d_(t.mutations)})}function $K(n,e,t){return g(this,null,function*(){let r=n.v_.shift(),i=sC.from(r,e,t);yield yF(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield cl(n)})}function HK(n,e){return g(this,null,function*(){e&&Os(n).E_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return jL(o)&&o!==P.ABORTED}(i.code)){let s=r.v_.shift();Os(r).t_(),yield yF(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield cl(r)}})}(n,e)),vF(n)&&wF(n)})}function z1(n,e){return g(this,null,function*(){let t=z(n);t.asyncQueue.verifyOperationInProgress(),F("RemoteStore","RemoteStore received new credentials");let r=Vs(t);t.M_.add(3),yield al(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield mh(t)})}function ZC(n,e){return g(this,null,function*(){let t=z(n);e?(t.M_.delete(2),yield mh(t)):e||(t.M_.add(2),yield al(t),t.N_.set("Unknown"))})}function ll(n){return n.B_||(n.B_=function(t,r,i){let s=z(t);return s.f_(),new KC(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:kK.bind(null,n),To:OK.bind(null,n),Ao:LK.bind(null,n),h_:FK.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.B_.t_(),W0(n)?G0(n):n.N_.set("Unknown")):(yield n.B_.stop(),_F(n))}))),n.B_}function Os(n){return n.k_||(n.k_=function(t,r,i){let s=z(t);return s.f_(),new QC(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:BK.bind(null,n),Ao:HK.bind(null,n),R_:jK.bind(null,n),A_:$K.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.k_.t_(),yield cl(n)):(yield n.k_.stop(),n.v_.length>0&&(F("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var e0=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new mt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ul(n,e){if(pt("AsyncQueue",`${e}: ${n}`),Fs(n))return new L(P.UNAVAILABLE,`${e}: ${n}`);throw n}var t_=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||G.comparator(t.key,r.key):(t,r)=>G.comparator(t.key,r.key),this.keyedMap=Od(),this.sortedSet=new Ye(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var n_=class{constructor(){this.q_=new Ye(G.comparator)}track(e){let t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):Y():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}},el=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,t_.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var t0=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},n0=class{constructor(){this.queries=new ai(e=>SL(e),hh),this.onlineState="Unknown",this.z_=new Set}};function K0(n,e){return g(this,null,function*(){let t=z(n),r=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new t0,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=ul(o,`Initialization of query '${Oc(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&Y0(t)})}function Q0(n,e){return g(this,null,function*(){let t=z(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function qK(n,e){let t=z(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&Y0(t)}function zK(n,e,t){let r=z(n),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(t);r.queries.delete(e)}function Y0(n){n.z_.forEach(e=>{e.next()})}var r0,G1;(G1=r0||(r0={})).J_="default",G1.Cache="cache";var sh=class{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new el(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=el.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==r0.Cache}};var i0=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var r_=class{constructor(e){this.serializer=e}Ps(e){return ri(this.serializer,e)}Is(e){return e.metadata.exists?QL(this.serializer,e.document,!1):At.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return _t(e)}},s0=class{constructor(e,t,r){this.oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=IF(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let r=xe.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,r=new r_(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||pe()).add(s);t.set(o,a)}}return t}complete(){return g(this,null,function*(){let e=yield NK(this.localStore,new r_(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let r of this.queries)yield PK(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function IF(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var i_=class{constructor(e){this.key=e}},s_=class{constructor(e){this.key=e}},o_=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=pe(),this.mutatedKeys=pe(),this.Ia=AL(e),this.Ta=new t_(this.Ia)}get Ea(){return this.la}da(e,t){let r=t?t.Aa:new n_,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let p=i.get(d),_=fh(this.query,h)?h:null,w=!!p&&this.mutatedKeys.has(p.key),b=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),S=!1;p&&_?p.data.isEqual(_.data)?w!==b&&(r.track({type:3,doc:_}),S=!0):this.Ra(p,_)||(r.track({type:2,doc:_}),S=!0,(c&&this.Ia(_,c)>0||l&&this.Ia(_,l)<0)&&(a=!0)):!p&&_?(r.track({type:0,doc:_}),S=!0):p&&!_&&(r.track({type:1,doc:p}),S=!0,(c||l)&&(a=!0)),S&&(_?(o=o.add(_),s=b?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((d,h)=>function(_,w){let b=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Y()}};return b(_)-b(w)}(d.type,h.type)||this.Ia(d.doc,h.doc)),this.Va(r),i=i!=null&&i;let a=t&&!i?this.ma():[],c=this.Pa.size===0&&this.current&&!i?1:0,l=c!==this.ha;return this.ha=c,o.length!==0||l?{snapshot:new el(this.query,e.Ta,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new n_,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=pe(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new s_(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new i_(r))}),t}pa(e){this.la=e.hs,this.Pa=pe();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return el.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},o0=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},a0=class{constructor(e){this.key=e,this.wa=!1}},c0=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new ai(a=>SL(a),hh),this.Da=new Map,this.Ca=new Set,this.va=new Ye(G.comparator),this.Fa=new Map,this.Ma=new nh,this.xa={},this.Oa=new Map,this.Na=Yc.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function GK(n,e,t=!0){return g(this,null,function*(){let r=v_(n),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield EF(r,e,t,!0),i})}function WK(n,e){return g(this,null,function*(){let t=v_(n);yield EF(t,e,!0,!1)})}function EF(n,e,t,r){return g(this,null,function*(){let i=yield Jc(n.localStore,mn(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield J0(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&y_(n.remoteStore,i),a})}function J0(n,e,t,r,i){return g(this,null,function*(){n.Ba=(h,p,_)=>function(b,S,O,H){return g(this,null,function*(){let V=S.view.da(O);V.Xi&&(V=yield Kg(b.localStore,S.query,!1).then(({documents:T})=>S.view.da(T,V)));let Q=H&&H.targetChanges.get(S.targetId),ae=H&&H.targetMismatches.get(S.targetId)!=null,J=S.view.applyChanges(V,b.isPrimaryClient,Q,ae);return l0(b,S.targetId,J.fa),J.snapshot})}(n,h,p,_);let s=yield Kg(n.localStore,e,!0),o=new o_(e,s.hs),a=o.da(s.documents),c=Xd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);l0(n,t,l.fa);let d=new o0(e,t,o);return n.ba.set(e,d),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),l.snapshot})}function KK(n,e,t){return g(this,null,function*(){let r=z(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!hh(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Xc(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Zc(r.remoteStore,i.targetId),tl(r,i.targetId)}).catch(Ls))):(tl(r,i.targetId),yield Xc(r.localStore,i.targetId,!0))})}function QK(n,e){return g(this,null,function*(){let t=z(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Zc(t.remoteStore,r.targetId))})}function YK(n,e,t){return g(this,null,function*(){let r=tS(n);try{let i=yield function(o,a){let c=z(o),l=nt.now(),d=a.reduce((_,w)=>_.add(w.key),pe()),h,p;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let w=An(),b=pe();return c.os.getEntries(_,d).next(S=>{w=S,w.forEach((O,H)=>{H.isValidDocument()||(b=b.add(O))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,w)).next(S=>{h=S;let O=[];for(let H of a){let V=lK(H,h.get(H.key).overlayedDocument);V!=null&&O.push(new Er(H.key,V,yL(V.value.mapValue),dt.exists(!0)))}return c.mutationQueue.addMutationBatch(_,l,O,a)}).next(S=>{p=S;let O=S.applyToLocalDocumentSet(h,b);return c.documentOverlayCache.saveOverlays(_,S.batchId,O)})}).then(()=>({batchId:p.batchId,changes:xL(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.xa[o.currentUser.toKey()];l||(l=new Ye(he)),l=l.insert(a,c),o.xa[o.currentUser.toKey()]=l}(r,i.batchId,t),yield Ui(r,i.changes),yield cl(r.remoteStore)}catch(i){let s=ul(i,"Failed to persist write");t.reject(s)}})}function TF(n,e){return g(this,null,function*(){let t=z(n);try{let r=yield RK(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(Z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?Z(o.wa):i.removedDocuments.size>0&&(Z(o.wa),o.wa=!1))}),yield Ui(t,r,e)}catch(r){yield Ls(r)}})}function W1(n,e,t){let r=z(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=z(o);c.onlineState=a;let l=!1;c.queries.forEach((d,h)=>{for(let p of h.U_)p.j_(a)&&(l=!0)}),l&&Y0(c)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function JK(n,e,t){return g(this,null,function*(){let r=z(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new Ye(G.comparator);o=o.insert(s,At.newNoDocument(s,ee.min()));let a=pe().add(s),c=new Jd(ee.min(),new Map,new Ye(he),o,a);yield TF(r,c),r.va=r.va.remove(s),r.Fa.delete(e),eS(r)}else yield Xc(r.localStore,e,!1).then(()=>tl(r,e,t)).catch(Ls)})}function XK(n,e){return g(this,null,function*(){let t=z(n),r=e.batch.batchId;try{let i=yield AK(t.localStore,e);Z0(t,r,null),X0(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ui(t,i)}catch(i){yield Ls(i)}})}function ZK(n,e,t){return g(this,null,function*(){let r=z(n);try{let i=yield function(o,a){let c=z(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(Z(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);Z0(r,e,t),X0(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ui(r,i)}catch(i){yield Ls(i)}})}function eQ(n,e){return g(this,null,function*(){let t=z(n);Vs(t.remoteStore)||F("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=z(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Oa.get(r)||[];i.push(e),t.Oa.set(r,i)}catch(r){let i=ul(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function X0(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function Z0(n,e,t){let r=z(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function tl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||bF(n,r)})}function bF(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(Zc(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),eS(n))}function l0(n,e,t){for(let r of t)r instanceof i_?(n.Ma.addReference(r.key,e),tQ(n,r)):r instanceof s_?(F("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||bF(n,r.key)):Y()}function tQ(n,e){let t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(F("SyncEngine","New document in limbo: "+t),n.Ca.add(r),eS(n))}function eS(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new G(xe.fromString(e)),r=n.Na.next();n.Fa.set(r,new a0(t)),n.va=n.va.insert(t,r),y_(n.remoteStore,new Qc(mn(ol(t.path)),r,"TargetPurposeLimboResolution",On.oe))}}function Ui(n,e,t){return g(this,null,function*(){let r=z(n),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,c)=>{o.push(r.Ba(c,e,t).then(l=>{if((l||t)&&r.isPrimaryClient){let d=l&&!l.fromCache;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);let d=jC.Ki(c.targetId,l);s.push(d)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(c,l){return g(this,null,function*(){let d=z(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>x.forEach(l,p=>x.forEach(p.qi,_=>d.persistence.referenceDelegate.addReference(h,p.targetId,_)).next(()=>x.forEach(p.Qi,_=>d.persistence.referenceDelegate.removeReference(h,p.targetId,_)))))}catch(h){if(!Fs(h))throw h;F("LocalStore","Failed to update sequence numbers: "+h)}for(let h of l){let p=h.targetId;if(!h.fromCache){let _=d.ns.get(p),w=_.snapshotVersion,b=_.withLastLimboFreeSnapshotVersion(w);d.ns=d.ns.insert(p,b)}}})}(r.localStore,s))})}function nQ(n,e){return g(this,null,function*(){let t=z(n);if(!t.currentUser.isEqual(e)){F("SyncEngine","User change. New user:",e.toKey());let r=yield lF(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(c=>{c.reject(new L(P.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ui(t,r.us)}})}function rQ(n,e){let t=z(n),r=t.Fa.get(e);if(r&&r.wa)return pe().add(r.key);{let i=pe(),s=t.Da.get(e);if(!s)return i;for(let o of s){let a=t.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function iQ(n,e){return g(this,null,function*(){let t=z(n),r=yield Kg(t.localStore,e.query,!0),i=e.view.pa(r);return t.isPrimaryClient&&l0(t,e.targetId,i.fa),i})}function sQ(n,e){return g(this,null,function*(){let t=z(n);return fF(t.localStore,e).then(r=>Ui(t,r))})}function oQ(n,e,t,r){return g(this,null,function*(){let i=z(n),s=yield function(a,c){let l=z(a),d=z(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.vn(h,c).next(p=>p?l.localDocuments.getDocuments(h,p):x.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield cl(i.remoteStore):t==="acknowledged"||t==="rejected"?(Z0(i,e,r||null),X0(i,e),function(a,c){z(z(a).mutationQueue).Mn(c)}(i.localStore,e)):Y(),yield Ui(i,s)):F("SyncEngine","Cannot apply mutation batch with id: "+e)})}function aQ(n,e){return g(this,null,function*(){let t=z(n);if(v_(t),tS(t),e===!0&&t.La!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield K1(t,r.toArray());t.La=!0,yield ZC(t.remoteStore,!0);for(let s of i)y_(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let r=[],i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(tl(t,o),Xc(t.localStore,o,!0))),Zc(t.remoteStore,o)}),yield i,yield K1(t,r),function(o){let a=z(o);a.Fa.forEach((c,l)=>{Zc(a.remoteStore,l)}),a.Ma.mr(),a.Fa=new Map,a.va=new Ye(G.comparator)}(t),t.La=!1,yield ZC(t.remoteStore,!1)}})}function K1(n,e,t){return g(this,null,function*(){let r=z(n),i=[],s=[];for(let o of e){let a,c=r.Da.get(o);if(c&&c.length!==0){a=yield Jc(r.localStore,mn(c[0]));for(let l of c){let d=r.ba.get(l),h=yield iQ(r,d);h.snapshot&&s.push(h.snapshot)}}else{let l=yield hF(r.localStore,o);a=yield Jc(r.localStore,l),yield J0(r,CF(l),o,!1,a.resumeToken)}i.push(a)}return r.Sa.h_(s),i})}function CF(n){return bL(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function cQ(n){return function(t){return z(z(t).persistence).Bi()}(z(n).localStore)}function lQ(n,e,t,r){return g(this,null,function*(){let i=z(n);if(i.La)return void F("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield fF(i.localStore,DL(s[0])),a=Jd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Lt.EMPTY_BYTE_STRING);yield Ui(i,o,a);break}case"rejected":yield Xc(i.localStore,e,!0),tl(i,e,r);break;default:Y()}})}function uQ(n,e,t){return g(this,null,function*(){let r=v_(n);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){F("SyncEngine","Adding an already active target "+i);continue}let s=yield hF(r.localStore,i),o=yield Jc(r.localStore,s);yield J0(r,CF(s),o.targetId,!1,o.resumeToken),y_(r.remoteStore,o)}for(let i of t)r.Da.has(i)&&(yield Xc(r.localStore,i,!1).then(()=>{Zc(r.remoteStore,i),tl(r,i)}).catch(Ls))}})}function v_(n){let e=z(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=TF.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=JK.bind(null,e),e.Sa.h_=qK.bind(null,e.eventManager),e.Sa.ka=zK.bind(null,e.eventManager),e}function tS(n){let e=z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=XK.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ZK.bind(null,e),e}function dQ(n,e,t){let r=z(n);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(_,w){let b=z(_),S=_t(w.createTime);return b.persistence.runTransaction("hasNewerBundle","readonly",O=>b.$r.getBundleMetadata(O,w.id)).then(O=>!!O&&O.createTime.compareTo(S)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(IF(c));let l=new s0(c,s.localStore,o.serializer),d=yield o.qa();for(;d;){let p=yield l._a(d);p&&a._updateProgress(p),d=yield o.qa()}let h=yield l.complete();return yield Ui(s,h.ca,void 0),yield function(_,w){let b=z(_);return b.persistence.runTransaction("Save bundle","readwrite",S=>b.$r.saveBundleMetadata(S,w))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.ua)}catch(c){return Zn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var oh=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=ph(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return cF(this.persistence,new Wg,e.initialUser,this.serializer)}createPersistence(e){return new zg(Gg.Hr,this.serializer)}createSharedClientState(e){return new Jg}terminate(){return g(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var a_=class n extends oh{constructor(e,t,r){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield Ar(n.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield tS(this.Qa.syncEngine),yield cl(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return cF(this.persistence,new Wg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new SC(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new Hb(t,this.persistence);return new $b(e.asyncQueue,r)}createPersistence(e){let t=q0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Xn.withCacheSize(this.cacheSizeBytes):Xn.DEFAULT;return new BC(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,mF(),vg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Jg}},u0=class n extends a_{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield Ar(n.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof jd&&(this.sharedClientState.syncEngine={Zs:oQ.bind(null,t),Xs:lQ.bind(null,t),eo:uQ.bind(null,t),Bi:cQ.bind(null,t),Ys:sQ.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>g(this,null,function*(){yield aQ(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=mF();if(!jd.D(t))throw new L(P.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=q0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new jd(t,e.asyncQueue,r,e.clientId,e.initialUser)}},ah=class{initialize(e,t){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>W1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=nQ.bind(null,this.syncEngine),yield ZC(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new n0}()}createDatastore(e){let t=ph(e.databaseInfo.databaseId),r=function(s){return new WC(s)}(e.databaseInfo);return function(s,o,a,c){return new YC(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new XC(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>W1(this.syncEngine,t,0),function(){return Xg.D()?new Xg:new zC}())}createSyncEngine(e,t){return function(i,s,o,a,c,l,d){let h=new c0(i,s,o,a,c,l);return d&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return g(this,null,function*(){var e;yield function(r){return g(this,null,function*(){let i=z(r);F("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield al(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function Q1(n,e=10240){let t=0;return{read(){return g(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var nl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):pt("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var d0=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new mt,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}qa(){return g(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return g(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),r=Number(t);isNaN(r)&&this.ja(`length string (${t}) is not valid number`);let i=yield this.Ha(r);return new i0(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return g(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return g(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var h0=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new L(P.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return g(this,null,function*(){let o=z(i),a={documents:s.map(h=>Zd(o.serializer,h))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,xe.emptyPath(),a,s.length),l=new Map;c.forEach(h=>{let p=mK(o.serializer,h);l.set(p.key.toString(),p)});let d=[];return s.forEach(h=>{let p=l.get(h.toString());Z(!!p),d.push(p)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ks(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=G.fromPath(r);this.mutations.push(new Kd(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=z(r),o={writes:i.map(a=>eh(s.serializer,a))};yield s.Co("Commit",s.serializer.databaseId,xe.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Y();t=ee.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new L(P.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ee.min())?dt.exists(!1):dt.updateTime(t):dt.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ee.min()))throw new L(P.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return dt.updateTime(t)}return dt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var f0=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Yo=new ih(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>g(this,null,function*(){let e=new h0(this.datastore),t=this.tu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let t=this.updateFunction(e);return!uh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!jL(t)}return!1}};var p0=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Dt.UNAUTHENTICATED,this.clientId=Eg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){F("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(F("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new L(P.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new mt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=ul(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function wg(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),F("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield lF(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function m0(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield nS(n);F("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>z1(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>z1(e.remoteStore,i)),n._onlineComponents=e})}function SF(n){return n.name==="FirebaseError"?n.code===P.FAILED_PRECONDITION||n.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function nS(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){F("FirestoreClient","Using user provided OfflineComponentProvider");try{yield wg(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!SF(t))throw t;Zn("Error using user provided cache. Falling back to memory cache: "+t),yield wg(n,new oh)}}else F("FirestoreClient","Using default OfflineComponentProvider"),yield wg(n,new oh);return n._offlineComponents})}function w_(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(F("FirestoreClient","Using user provided OnlineComponentProvider"),yield m0(n,n._uninitializedComponentsProvider._online)):(F("FirestoreClient","Using default OnlineComponentProvider"),yield m0(n,new ah))),n._onlineComponents})}function DF(n){return nS(n).then(e=>e.persistence)}function rS(n){return nS(n).then(e=>e.localStore)}function AF(n){return w_(n).then(e=>e.remoteStore)}function iS(n){return w_(n).then(e=>e.syncEngine)}function RF(n){return w_(n).then(e=>e.datastore)}function rl(n){return g(this,null,function*(){let e=yield w_(n),t=e.eventManager;return t.onListen=GK.bind(null,e.syncEngine),t.onUnlisten=KK.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=WK.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=QK.bind(null,e.syncEngine),t})}function hQ(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield DF(n),t=yield AF(n);return e.setNetworkEnabled(!0),function(i){let s=z(i);return s.M_.delete(0),mh(s)}(t)}))}function fQ(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield DF(n),t=yield AF(n);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=z(i);s.M_.add(0),yield al(s),s.N_.set("Offline")})}(t)}))}function pQ(n,e){let t=new mt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(l,d){let h=z(l);return h.persistence.runTransaction("read document","readonly",p=>h.localDocuments.getDocument(p,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new L(P.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=ul(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield rS(n),e,t)})),t.promise}function xF(n,e,t={}){let r=new mt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new nl({next:p=>{o.enqueueAndForget(()=>Q0(s,h));let _=p.docs.has(a);!_&&p.fromCache?l.reject(new L(P.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&c&&c.source==="server"?l.reject(new L(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new sh(ol(a.path),d,{includeMetadataChanges:!0,ra:!0});return K0(s,h)}(yield rl(n),n.asyncQueue,e,t,r)})),r.promise}function mQ(n,e){let t=new mt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield Kg(i,s,!0),c=new o_(s,a.hs),l=c.da(a.documents),d=c.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let c=ul(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield rS(n),e,t)})),t.promise}function NF(n,e,t={}){let r=new mt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new nl({next:p=>{o.enqueueAndForget(()=>Q0(s,h)),p.fromCache&&c.source==="server"?l.reject(new L(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new sh(a,d,{includeMetadataChanges:!0,ra:!0});return K0(s,h)}(yield rl(n),n.asyncQueue,e,t,r)})),r.promise}function gQ(n,e,t){let r=new mt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){try{let i=yield RF(n);r.resolve(function(o,a,c){return g(this,null,function*(){var l;let d=z(o),{request:h,ut:p,parent:_}=yK(d.serializer,Z8(a),c);d.connection.Do||delete h.parent;let w=(yield d.xo("RunAggregationQuery",d.serializer.databaseId,_,h,1)).filter(S=>!!S.result);Z(w.length===1);let b=(l=w[0].result)===null||l===void 0?void 0:l.aggregateFields;return Object.keys(b).reduce((S,O)=>(S[p[O]]=b[O],S),{})})}(i,e,t))}catch(i){r.reject(i)}})),r.promise}function _Q(n,e){let t=new nl(e);return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){z(i).z_.add(s),s.next()}(yield rl(n),t)})),()=>{t.$a(),n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){z(i).z_.delete(s)}(yield rl(n),t)}))}}function yQ(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?HL().encode(o):o,function(d,h){return new d0(d,h)}(function(d,h){if(d instanceof Uint8Array)return Q1(d,h);if(d instanceof ArrayBuffer)return Q1(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,ph(e));n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){dQ(yield iS(n),i,r)}))}function vQ(n,e){return n.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=z(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield rS(n),e)}))}function PF(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Y1=new Map;function sS(n,e,t){if(!t)throw new L(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function oS(n,e,t,r){if(e===!0&&r===!0)throw new L(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function J1(n){if(!G.isDocumentKey(n))throw new L(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function X1(n){if(G.isDocumentKey(n))throw new L(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function I_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Y()}function Ce(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=I_(n);throw new L(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function MF(n,e){if(e<=0)throw new L(P.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var c_=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new L(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new L(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}oS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=PF((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ea=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new c_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new L(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new L(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new c_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Pb;switch(r.type){case"firstParty":return new Lb(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Y1.get(t);r&&(F("ComponentProvider","Removing Datastore"),Y1.delete(t),r.terminate())}(this),Promise.resolve()}};function kF(n,e,t,r={}){var i;let s=(n=Ce(n,ea))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Zn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Dt.MOCK_USER;else{a=pc(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new L(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Dt(l)}n._authCredentials=new Mb(new Ig(a,c))}}var qt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},ze=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ii(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},ii=class n extends qt{constructor(e,t,r){super(e,t,ol(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ze(this.firestore,null,new G(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Us(n,e,...t){if(n=q(n),sS("collection","path",e),n instanceof ea){let r=xe.fromString(e,...t);return X1(r),new ii(n,null,r)}{if(!(n instanceof ze||n instanceof ii))throw new L(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(xe.fromString(e,...t));return X1(r),new ii(n.firestore,null,r)}}function OF(n,e){if(n=Ce(n,ea),sS("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new L(P.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new qt(n,null,function(r){return new Ir(xe.emptyPath(),r)}(e))}function gh(n,e,...t){if(n=q(n),arguments.length===1&&(e=Eg.newId()),sS("doc","path",e),n instanceof ea){let r=xe.fromString(e,...t);return J1(r),new ze(n,null,new G(r))}{if(!(n instanceof ze||n instanceof ii))throw new L(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(xe.fromString(e,...t));return J1(r),new ze(n.firestore,n instanceof ii?n.converter:null,new G(r))}}function aS(n,e){return n=q(n),e=q(e),(n instanceof ze||n instanceof ii)&&(e instanceof ze||e instanceof ii)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function cS(n,e){return n=q(n),e=q(e),n instanceof qt&&e instanceof qt&&n.firestore===e.firestore&&hh(n._query,e._query)&&n.converter===e.converter}var g0=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new ih(this,"async_queue_retry"),this.hu=()=>{let t=vg();t&&F("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=vg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=vg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new mt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return g(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Fs(e))throw e;F("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw pt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=e0.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&Y()}verifyOperationInProgress(){}du(){return g(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function _0(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var y0=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new mt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var LF=-1,Je=class extends ea{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new g0}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||FF(this),this._firestoreClient.terminate()}};function Rt(n){return n._firestoreClient||FF(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function FF(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,d){return new qb(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,PF(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new p0(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function VF(n,e){WF(n=Ce(n,Je));let t=Rt(n);if(t._uninitializedComponentsProvider)throw new L(P.FAILED_PRECONDITION,"SDK cache is already specified.");Zn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new ah;return BF(t,i,new a_(i,r.cacheSizeBytes,e?.forceOwnership))}function UF(n){WF(n=Ce(n,Je));let e=Rt(n);if(e._uninitializedComponentsProvider)throw new L(P.FAILED_PRECONDITION,"SDK cache is already specified.");Zn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new ah;return BF(e,r,new u0(r,t.cacheSizeBytes))}function BF(n,e,t){let r=new mt;return n.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield wg(n,t),yield m0(n,e),r.resolve()}catch(i){let s=i;if(!SF(s))throw s;Zn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function jF(n){if(n._initialized&&!n._terminated)throw new L(P.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new mt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!Ds.D())return Promise.resolve();let i=r+"main";yield Ds.delete(i)})}(q0(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function $F(n){return function(t){let r=new mt;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return eQ(yield iS(t),r)})),r.promise}(Rt(n=Ce(n,Je)))}function HF(n){return hQ(Rt(n=Ce(n,Je)))}function qF(n){return fQ(Rt(n=Ce(n,Je)))}function zF(n,e){let t=Rt(n=Ce(n,Je)),r=new y0;return yQ(t,n._databaseId,e,r),r}function GF(n,e){return vQ(Rt(n=Ce(n,Je)),e).then(t=>t?new qt(n,null,t.query):null)}function WF(n){if(n._initialized||n._terminated)throw new L(P.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var v0=class{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}},w0=class{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}};var ci=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Lt.fromBase64String(e))}catch(t){throw new L(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Lt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Tr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Vi=class{constructor(e){this._methodName=e}};var ta=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return he(this._lat,e._lat)||he(this._long,e._long)}};var wQ=/^__.*__$/,I0=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Er(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ms(e,this.data,t,this.fieldTransforms)}},l_=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Er(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function KF(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y()}}var u_=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return d_(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(KF(this.fu)&&wQ.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},E0=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ph(e)}Fu(e,t,r,i=!1){return new u_({fu:e,methodName:t,vu:r,path:gt.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function sa(n){let e=n._freezeSettings(),t=ph(n._databaseId);return new E0(n._databaseId,!!e.ignoreUndefinedProperties,t)}function E_(n,e,t,r,i,s={}){let o=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);dS("Data must be an object, but it was:",o,r);let a=JF(r,o),c,l;if(s.merge)c=new Ln(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let p=D0(e,h,t);if(!o.contains(p))throw new L(P.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);ZF(d,p)||d.push(p)}c=new Ln(d),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new I0(new tn(a),c,l)}var ch=class n extends Vi{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function QF(n,e,t){return new u_({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var T0=class n extends Vi{_toFieldTransform(e){return new Jo(e.path,new Ns)}isEqual(e){return e instanceof n}},b0=class n extends Vi{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=QF(this,e,!0),r=this.Mu.map(s=>oa(s,t)),i=new Li(r);return new Jo(e.path,i)}isEqual(e){return e instanceof n&&ls(this.Mu,e.Mu)}},C0=class n extends Vi{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=QF(this,e,!0),r=this.Mu.map(s=>oa(s,t)),i=new Fi(r);return new Jo(e.path,i)}isEqual(e){return e instanceof n&&ls(this.Mu,e.Mu)}},S0=class n extends Vi{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new Ps(e.serializer,kL(e.serializer,this.xu));return new Jo(e.path,t)}isEqual(e){return e instanceof n&&this.xu===e.xu}};function lS(n,e,t,r){let i=n.Fu(1,e,t);dS("Data must be an object, but it was:",i,r);let s=[],o=tn.empty();ia(r,(c,l)=>{let d=hS(e,c,t);l=q(l);let h=i.Su(d);if(l instanceof ch)s.push(d);else{let p=oa(l,h);p!=null&&(s.push(d),o.set(d,p))}});let a=new Ln(s);return new l_(o,a,i.fieldTransforms)}function uS(n,e,t,r,i,s){let o=n.Fu(1,e,t),a=[D0(e,r,t)],c=[i];if(s.length%2!=0)throw new L(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(D0(e,s[p])),c.push(s[p+1]);let l=[],d=tn.empty();for(let p=a.length-1;p>=0;--p)if(!ZF(l,a[p])){let _=a[p],w=c[p];w=q(w);let b=o.Su(_);if(w instanceof ch)l.push(_);else{let S=oa(w,b);S!=null&&(l.push(_),d.set(_,S))}}let h=new Ln(l);return new l_(d,h,o.fieldTransforms)}function YF(n,e,t,r=!1){return oa(t,n.Fu(r?4:3,e))}function oa(n,e){if(XF(n=q(n)))return dS("Unsupported field value:",e,n),JF(n,e);if(n instanceof Vi)return function(r,i){if(!KF(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=oa(a,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=q(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=nt.fromDate(r);return{timestampValue:Kc(i.serializer,s)}}if(r instanceof nt){let s=new nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Kc(i.serializer,s)}}if(r instanceof ta)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ci)return{bytesValue:qL(i.serializer,r._byteString)};if(r instanceof ze){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:B0(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${I_(r)}`)}(n,e)}function JF(n,e){let t={};return mL(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ia(n,(r,i)=>{let s=oa(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function XF(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof nt||n instanceof ta||n instanceof ci||n instanceof ze||n instanceof Vi)}function dS(n,e,t){if(!XF(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=I_(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function D0(n,e,t){if((e=q(e))instanceof Tr)return e._internalPath;if(typeof e=="string")return hS(n,e);throw d_("Field path arguments must be of type string or ",n,!1,void 0,t)}var IQ=new RegExp("[~\\*/\\[\\]]");function hS(n,e,t){if(e.search(IQ)>=0)throw d_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Tr(...e.split("."))._internalPath}catch{throw d_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function d_(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new L(P.INVALID_ARGUMENT,a+n+c)}function ZF(n,e){return n.some(t=>t.isEqual(e))}var na=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new A0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(T_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},A0=class extends na{data(){return super.data()}};function T_(n,e){return typeof e=="string"?hS(n,e):e instanceof Tr?e._internalPath:e._delegate._internalPath}function eV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var lh=class{},ra=class extends lh{};function Bi(n,e,...t){let r=[];e instanceof lh&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof R0).length,a=s.filter(c=>c instanceof h_).length;if(o>1||o>0&&a>0)throw new L(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var h_=class n extends ra{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return uV(e._query,t),new qt(e.firestore,e.converter,rC(e._query,t))}_parse(e){let t=sa(e.firestore);return function(s,o,a,c,l,d,h){let p;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new L(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){eL(h,d);let _=[];for(let w of h)_.push(Z1(c,s,w));p={arrayValue:{values:_}}}else p=Z1(c,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||eL(h,d),p=YF(a,o,h,d==="in"||d==="not-in");return Te.create(l,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function tV(n,e,t){let r=e,i=T_("where",n);return h_._create(i,r,t)}var R0=class n extends lh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Le.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)uV(o,c),o=rC(o,c)}(e._query,t),new qt(e.firestore,e.converter,rC(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var x0=class n extends ra{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new L(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new L(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Qo(s,o)}(e._query,this._field,this._direction);return new qt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Ir(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function nV(n,e="asc"){let t=e,r=T_("orderBy",n);return x0._create(r,t)}var f_=class n extends ra{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new qt(e.firestore,e.converter,Pg(e._query,this._limit,this._limitType))}};function rV(n){return MF("limit",n),f_._create("limit",n,"F")}function iV(n){return MF("limitToLast",n),f_._create("limitToLast",n,"L")}var p_=class n extends ra{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=lV(e,this.type,this._docOrFields,this._inclusive);return new qt(e.firestore,e.converter,function(i,s){return new Ir(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function sV(...n){return p_._create("startAt",n,!0)}function oV(...n){return p_._create("startAfter",n,!1)}var m_=class n extends ra{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=lV(e,this.type,this._docOrFields,this._inclusive);return new qt(e.firestore,e.converter,function(i,s){return new Ir(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function aV(...n){return m_._create("endBefore",n,!1)}function cV(...n){return m_._create("endAt",n,!0)}function lV(n,e,t,r){if(t[0]=q(t[0]),t[0]instanceof na)return function(s,o,a,c,l){if(!c)throw new L(P.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of Bc(s))if(h.field.isKeyField())d.push(Ko(o,c.key));else{let p=c.data.field(h.field);if(__(p))throw new L(P.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let _=h.field.canonicalString();throw new L(P.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(p)}return new oi(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=sa(n.firestore);return function(o,a,c,l,d,h){let p=o.explicitOrderBy;if(d.length>p.length)throw new L(P.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let _=[];for(let w=0;w<d.length;w++){let b=d[w];if(p[w].field.isKeyField()){if(typeof b!="string")throw new L(P.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof b}`);if(!V0(o)&&b.indexOf("/")!==-1)throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${b}' contains a slash.`);let S=o.path.child(xe.fromString(b));if(!G.isDocumentKey(S))throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${S}' is not because it contains an odd number of segments.`);let O=new G(S);_.push(Ko(a,O))}else{let S=YF(c,l,b);_.push(S)}}return new oi(_,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function Z1(n,e,t){if(typeof(t=q(t))=="string"){if(t==="")throw new L(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!V0(e)&&t.indexOf("/")!==-1)throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(xe.fromString(t));if(!G.isDocumentKey(r))throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ko(n,new G(r))}if(t instanceof ze)return Ko(n,t._key);throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${I_(t)}.`)}function eL(n,e){if(!Array.isArray(n)||n.length===0)throw new L(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function uV(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new L(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new L(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var il=class{convertValue(e,t="none"){switch(Wo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(As(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Y()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return ia(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new ta(ut(e.latitude),ut(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=L0(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(zd(e));default:return null}}convertTimestamp(e){let t=Oi(e);return new nt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=xe.fromString(e);Z(eF(r));let i=new Rs(r.get(1),r.get(3)),s=new G(r.popFirst(5));return i.isEqual(t)||pt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function b_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var N0=class extends il{constructor(e){super(),this.firestore=e}convertBytes(e){return new ci(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ze(this.firestore,null,t)}};function EQ(){return new v0("count")}var ki=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},tr=class extends na{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Cs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(T_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Cs=class extends tr{data(e={}){return super.data(e)}},br=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ki(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Cs(this._firestore,this._userDataWriter,r.key,r,new ki(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Cs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ki(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Cs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ki(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:TQ(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function TQ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y()}}function fS(n,e){return n instanceof tr&&e instanceof tr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof br&&e instanceof br&&n._firestore===e._firestore&&cS(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function dV(n){n=Ce(n,ze);let e=Ce(n.firestore,Je);return xF(Rt(e),n._key).then(t=>gS(e,n,t))}var li=class extends il{constructor(e){super(),this.firestore=e}convertBytes(e){return new ci(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ze(this.firestore,null,t)}};function hV(n){n=Ce(n,ze);let e=Ce(n.firestore,Je),t=Rt(e),r=new li(e);return pQ(t,n._key).then(i=>new tr(e,r,n._key,i,new ki(i!==null&&i.hasLocalMutations,!0),n.converter))}function fV(n){n=Ce(n,ze);let e=Ce(n.firestore,Je);return xF(Rt(e),n._key,{source:"server"}).then(t=>gS(e,n,t))}function pV(n){n=Ce(n,qt);let e=Ce(n.firestore,Je),t=Rt(e),r=new li(e);return eV(n._query),NF(t,n._query).then(i=>new br(e,r,n,i))}function mV(n){n=Ce(n,qt);let e=Ce(n.firestore,Je),t=Rt(e),r=new li(e);return mQ(t,n._query).then(i=>new br(e,r,n,i))}function gV(n){n=Ce(n,qt);let e=Ce(n.firestore,Je),t=Rt(e),r=new li(e);return NF(t,n._query,{source:"server"}).then(i=>new br(e,r,n,i))}function pS(n,e,t){n=Ce(n,ze);let r=Ce(n.firestore,Je),i=b_(n.converter,e,t);return dl(r,[E_(sa(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,dt.none())])}function mS(n,e,t,...r){n=Ce(n,ze);let i=Ce(n.firestore,Je),s=sa(i),o;return o=typeof(e=q(e))=="string"||e instanceof Tr?uS(s,"updateDoc",n._key,e,t,r):lS(s,"updateDoc",n._key,e),dl(i,[o.toMutation(n._key,dt.exists(!0))])}function _V(n){return dl(Ce(n.firestore,Je),[new ks(n._key,dt.none())])}function yV(n,e){let t=Ce(n.firestore,Je),r=gh(n),i=b_(n.converter,e);return dl(t,[E_(sa(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,dt.exists(!1))]).then(()=>r)}function _h(n,...e){var t,r,i;n=q(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||_0(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(_0(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,d;if(n instanceof ze)l=Ce(n.firestore,Je),d=ol(n._key.path),c={next:h=>{e[o]&&e[o](gS(l,n,h))},error:e[o+1],complete:e[o+2]};else{let h=Ce(n,qt);l=Ce(h.firestore,Je),d=h._query;let p=new li(l);c={next:_=>{e[o]&&e[o](new br(l,p,h,_))},error:e[o+1],complete:e[o+2]},eV(n._query)}return function(p,_,w,b){let S=new nl(b),O=new sh(_,S,w);return p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return K0(yield rl(p),O)})),()=>{S.$a(),p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return Q0(yield rl(p),O)}))}}(Rt(l),d,a,c)}function vV(n,e){return _Q(Rt(n=Ce(n,Je)),_0(e)?e:{next:e})}function dl(n,e){return function(r,i){let s=new mt;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return YK(yield iS(r),i,s)})),s.promise}(Rt(n),e)}function gS(n,e,t){let r=t.docs.get(e._key),i=new li(n);return new tr(n,i,e._key,r,new ki(t.hasPendingWrites,t.fromCache),e.converter)}function C_(n){return bQ(n,{count:EQ()})}function bQ(n,e){let t=Ce(n.firestore,Je),r=Rt(t),i=K8(e,(s,o)=>new oC(o,s.aggregateType,s._internalFieldPath));return gQ(r,n._query,i).then(s=>function(a,c,l){let d=new li(a);return new w0(c,d,l)}(t,n,s))}var CQ={maxAttempts:5};var g_=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=sa(e)}set(e,t,r){this._verifyNotCommitted();let i=Ts(e,this._firestore),s=b_(i.converter,t,r),o=E_(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,dt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=Ts(e,this._firestore),o;return o=typeof(t=q(t))=="string"||t instanceof Tr?uS(this._dataReader,"WriteBatch.update",s._key,t,r,i):lS(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,dt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Ts(e,this._firestore);return this._mutations=this._mutations.concat(new ks(t._key,dt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new L(P.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Ts(n,e){if((n=q(n)).firestore!==e)throw new L(P.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var P0=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=sa(t)}get(t){let r=Ts(t,this._firestore),i=new N0(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Y();let o=s[0];if(o.isFoundDocument())return new na(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new na(this._firestore,i,r._key,null,r.converter);throw Y()})}set(t,r,i){let s=Ts(t,this._firestore),o=b_(s.converter,r,i),a=E_(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=Ts(t,this._firestore),a;return a=typeof(r=q(r))=="string"||r instanceof Tr?uS(this._dataReader,"Transaction.update",o._key,r,i,s):lS(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=Ts(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Ts(e,this._firestore),r=new li(this._firestore);return super.get(e).then(i=>new tr(this._firestore,r,t._key,i._document,new ki(!1,!1),t.converter))}};function wV(n,e,t){n=Ce(n,Je);let r=Object.assign(Object.assign({},CQ),t);return function(s){if(s.maxAttempts<1)throw new L(P.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new mt;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let l=yield RF(s);new f0(s.asyncQueue,l,a,o,c).Xa()})),c.promise}(Rt(n),i=>e(new P0(n,i)),r)}function IV(){return new ch("deleteField")}function EV(){return new T0("serverTimestamp")}function TV(...n){return new b0("arrayUnion",n)}function bV(...n){return new C0("arrayRemove",n)}function CV(n){return new S0("increment",n)}(function(e,t=!0){(function(i){sl=i})(fn),hn(new Ve("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Je(new kb(r.getProvider("auth-internal")),new Vb(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new L(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rs(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),ft(t1,"4.6.3",e),ft(t1,"4.6.3","esm2017")})();var SQ="@firebase/firestore-compat",DQ="0.3.32";function ES(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new L("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function SV(){if(typeof Uint8Array>"u")throw new L("unimplemented","Uint8Arrays are not available in this environment.")}function DV(){if(!gL())throw new L("unimplemented","Blobs are unavailable in Firestore in this environment.")}var S_=class n{constructor(e){this._delegate=e}static fromBase64String(e){return DV(),new n(ci.fromBase64String(e))}static fromUint8Array(e){return SV(),new n(ci.fromUint8Array(e))}toBase64(){return DV(),this._delegate.toBase64()}toUint8Array(){return SV(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function _S(n){return AQ(n,["next","error","complete"])}function AQ(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var yS=class{enableIndexedDbPersistence(e,t){return VF(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return UF(e._delegate)}clearIndexedDbPersistence(e){return jF(e._delegate)}},D_=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Rs||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Zn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){kF(this._delegate,e,t,r)}enableNetwork(){return HF(this._delegate)}disableNetwork(){return qF(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,oS("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return $F(this._delegate)}onSnapshotsInSync(e){return vV(this._delegate,e)}get app(){if(!this._appCompat)throw new L("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new pl(this,Us(this._delegate,e))}catch(t){throw gn(t,"collection()","Firestore.collection()")}}doc(e){try{return new ui(this,gh(this._delegate,e))}catch(t){throw gn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ua(this,OF(this._delegate,e))}catch(t){throw gn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return wV(this._delegate,t=>e(new A_(this,t)))}batch(){return Rt(this._delegate),new R_(new g_(this._delegate,e=>dl(this._delegate,e)))}loadBundle(e){return zF(this._delegate,e)}namedQuery(e){return GF(this._delegate,e).then(t=>t?new ua(this,t):null)}},hl=class extends il{constructor(e){super(),this.firestore=e}convertBytes(e){return new S_(new ci(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return ui.forKey(t,this.firestore,null)}};function RQ(n){nL(n)}var A_=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new hl(e)}get(e){let t=aa(e);return this._delegate.get(t).then(r=>new ca(this._firestore,new tr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=aa(e);return r?(ES("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=aa(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=aa(e);return this._delegate.delete(t),this}},R_=class{constructor(e){this._delegate=e}set(e,t,r){let i=aa(e);return r?(ES("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=aa(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=aa(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},fl=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Cs(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new la(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new hl(e),t),i.set(t,s)),s}};fl.INSTANCES=new WeakMap;var ui=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new hl(e)}static forPath(e,t,r){if(e.length%2!==0)throw new L("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new ze(t._delegate,r,new G(e)))}static forKey(e,t,r){return new n(t,new ze(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new pl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new pl(this.firestore,Us(this._delegate,e))}catch(t){throw gn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=q(e),e instanceof ze?aS(this._delegate,e):!1}set(e,t){t=ES("DocumentReference.set",t);try{return t?pS(this._delegate,e,t):pS(this._delegate,e)}catch(r){throw gn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?mS(this._delegate,e):mS(this._delegate,e,t,...r)}catch(i){throw gn(i,"updateDoc()","DocumentReference.update()")}}delete(){return _V(this._delegate)}onSnapshot(...e){let t=AV(e),r=RV(e,i=>new ca(this.firestore,new tr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return _h(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=hV(this._delegate):e?.source==="server"?t=fV(this._delegate):t=dV(this._delegate),t.then(r=>new ca(this.firestore,new tr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(fl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function gn(n,e,t){return n.message=n.message.replace(e,t),n}function AV(n){for(let e of n)if(typeof e=="object"&&!_S(e))return e;return{}}function RV(n,e){var t,r;let i;return _S(n[0])?i=n[0]:_S(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var ca=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new ui(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return fS(this._delegate,e._delegate)}},la=class extends ca{data(e){let t=this._delegate.data(e);return this._delegate._converter||rL(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},ua=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new hl(e)}where(e,t,r){try{return new n(this.firestore,Bi(this._delegate,tV(e,t,r)))}catch(i){throw gn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Bi(this._delegate,nV(e,t)))}catch(r){throw gn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Bi(this._delegate,rV(e)))}catch(t){throw gn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Bi(this._delegate,iV(e)))}catch(t){throw gn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Bi(this._delegate,sV(...e)))}catch(t){throw gn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Bi(this._delegate,oV(...e)))}catch(t){throw gn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Bi(this._delegate,aV(...e)))}catch(t){throw gn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Bi(this._delegate,cV(...e)))}catch(t){throw gn(t,"endAt()","Query.endAt()")}}isEqual(e){return cS(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=mV(this._delegate):e?.source==="server"?t=gV(this._delegate):t=pV(this._delegate),t.then(r=>new yh(this.firestore,new br(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=AV(e),r=RV(e,i=>new yh(this.firestore,new br(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return _h(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(fl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},vS=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new la(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},yh=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new ua(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new la(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new vS(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new la(this._firestore,r))})}isEqual(e){return fS(this._delegate,e._delegate)}},pl=class n extends ua{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new ui(this.firestore,e):null}doc(e){try{return e===void 0?new ui(this.firestore,gh(this._delegate)):new ui(this.firestore,gh(this._delegate,e))}catch(t){throw gn(t,"doc()","CollectionReference.doc()")}}add(e){return yV(this._delegate,e).then(t=>new ui(this.firestore,t))}isEqual(e){return aS(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(fl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function aa(n){return Ce(n,ze)}var wS=class n{constructor(...e){this._delegate=new Tr(...e)}static documentId(){return new n(gt.keyField().canonicalString())}isEqual(e){return e=q(e),e instanceof Tr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var IS=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=EV();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=IV();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=TV(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=bV(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=CV(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var xQ={Firestore:D_,GeoPoint:ta,Timestamp:nt,Blob:S_,Transaction:A_,WriteBatch:R_,DocumentReference:ui,DocumentSnapshot:ca,Query:ua,QueryDocumentSnapshot:la,QuerySnapshot:yh,CollectionReference:pl,FieldPath:wS,FieldValue:IS,setLogLevel:RQ,CACHE_SIZE_UNLIMITED:LF};function NQ(n,e){n.INTERNAL.registerComponent(new Ve("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},xQ)))}function PQ(n){NQ(n,(e,t)=>new D_(e,t,new yS)),n.registerVersion(SQ,DQ)}PQ(X);var VV="firebasestorage.googleapis.com",UV="storageBucket",MQ=2*60*1e3,kQ=10*60*1e3,OQ=1e3;var rt=class n extends at{constructor(e,t,r=0){super(TS(e),`Firebase Storage: ${t} (${TS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return TS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Ze=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Ze||{});function TS(n){return"storage/"+n}function NS(){let n="An unknown error occurred, please check the error payload for server response.";return new rt(Ze.UNKNOWN,n)}function LQ(n){return new rt(Ze.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function FQ(n){return new rt(Ze.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function VQ(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new rt(Ze.UNAUTHENTICATED,n)}function UQ(){return new rt(Ze.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function BQ(n){return new rt(Ze.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function BV(){return new rt(Ze.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function jV(){return new rt(Ze.CANCELED,"User canceled the upload/download.")}function jQ(n){return new rt(Ze.INVALID_URL,"Invalid URL '"+n+"'.")}function $Q(n){return new rt(Ze.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function HQ(){return new rt(Ze.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+UV+"' property when initializing the app?")}function $V(){return new rt(Ze.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function qQ(){return new rt(Ze.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function zQ(){return new rt(Ze.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function GQ(n){return new rt(Ze.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function da(n){return new rt(Ze.INVALID_ARGUMENT,n)}function HV(){return new rt(Ze.APP_DELETED,"The Firebase app was deleted.")}function PS(n){return new rt(Ze.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function wh(n,e){return new rt(Ze.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function vh(n){throw new rt(Ze.INTERNAL_ERROR,"Internal error: "+n)}var _n=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw $Q(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(Q){Q.path.charAt(Q.path.length-1)==="/"&&(Q.path_=Q.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(Q){Q.path_=decodeURIComponent(Q.path)}let d="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",_=new RegExp(`^https?://${h}/${d}/b/${i}/o${p}`,"i"),w={bucket:1,path:3},b=t===VV?"(?:storage.googleapis.com|storage.cloud.google.com)":t,S="([^?#]*)",O=new RegExp(`^https?://${b}/${i}/${S}`,"i"),V=[{regex:a,indices:c,postModify:s},{regex:_,indices:w,postModify:l},{regex:O,indices:{bucket:1,path:2},postModify:l}];for(let Q=0;Q<V.length;Q++){let ae=V[Q],J=ae.regex.exec(e);if(J){let T=J[ae.indices.bucket],v=J[ae.indices.path];v||(v=""),r=new n(T,v),ae.postModify(r);break}}if(r==null)throw jQ(e);return r}},CS=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function WQ(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...S){l||(l=!0,e.apply(null,S))}function h(S){i=setTimeout(()=>{i=null,n(_,c())},S)}function p(){s&&clearTimeout(s)}function _(S,...O){if(l){p();return}if(S){p(),d.call(null,S,...O);return}if(c()||o){p(),d.call(null,S,...O);return}r<64&&(r*=2);let V;a===1?(a=2,V=0):V=(r+Math.random())*1e3,h(V)}let w=!1;function b(S){w||(w=!0,p(),!l&&(i!==null?(S||(a=2),clearTimeout(i),h(0)):S||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,b(!0)},t),b}function KQ(n){n(!1)}function QQ(n){return n!==void 0}function YQ(n){return typeof n=="function"}function JQ(n){return typeof n=="object"&&!Array.isArray(n)}function P_(n){return typeof n=="string"||n instanceof String}function xV(n){return MS()&&n instanceof Blob}function MS(){return typeof Blob<"u"}function SS(n,e,t,r){if(r<e)throw da(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw da(`Invalid value for '${n}'. Expected ${t} or less.`)}function Bs(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function qV(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var _l=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(_l||{});function zV(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var DS=class{constructor(e,t,r,i,s,o,a,c,l,d,h,p=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,w)=>{this.resolve_=_,this.reject_=w,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new gl(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===_l.NO_ERROR,c=s.getStatus();if(!a||zV(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===_l.ABORT;r(!1,new gl(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new gl(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());QQ(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=NS();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?HV():jV();o(c)}else{let c=BV();o(c)}};this.canceled_?t(!1,new gl(!1,null,!0)):this.backoffId_=WQ(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&KQ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},gl=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function XQ(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function ZQ(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function e7(n,e){e&&(n["X-Firebase-GMPID"]=e)}function t7(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function n7(n,e,t,r,i,s,o=!0){let a=qV(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return e7(l,e),XQ(l,t),ZQ(l,s),t7(l,r),new DS(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function r7(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function i7(...n){let e=r7();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(MS())return new Blob(n);throw new rt(Ze.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function s7(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function o7(n){if(typeof atob>"u")throw GQ("base-64");return atob(n)}var Fn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Ih=class{constructor(e,t){this.data=e,this.contentType=t||null}};function kS(n,e){switch(n){case Fn.RAW:return new Ih(GV(e));case Fn.BASE64:case Fn.BASE64URL:return new Ih(WV(n,e));case Fn.DATA_URL:return new Ih(c7(e),l7(e))}throw NS()}function GV(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function a7(n){let e;try{e=decodeURIComponent(n)}catch{throw wh(Fn.DATA_URL,"Malformed data URL.")}return GV(e)}function WV(n,e){switch(n){case Fn.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw wh(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Fn.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw wh(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=o7(e)}catch(i){throw i.message.includes("polyfill")?i:wh(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var N_=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw wh(Fn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=u7(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function c7(n){let e=new N_(n);return e.base64?WV(Fn.BASE64,e.rest):a7(e.rest)}function l7(n){return new N_(n).contentType}function u7(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var yl=class n{constructor(e,t){let r=0,i="";xV(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(xV(this.data_)){let r=this.data_,i=s7(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(MS()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(i7.apply(null,t))}else{let t=e.map(o=>P_(o)?kS(Fn.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function OS(n){let e;try{e=JSON.parse(n)}catch{return null}return JQ(e)?e:null}function d7(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function h7(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function KV(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function f7(n,e){return e}var zt=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||f7}},x_=null;function p7(n){return!P_(n)||n.length<2?n:KV(n)}function M_(){if(x_)return x_;let n=[];n.push(new zt("bucket")),n.push(new zt("generation")),n.push(new zt("metageneration")),n.push(new zt("name","fullPath",!0));function e(s,o){return p7(o)}let t=new zt("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new zt("size");return i.xform=r,n.push(i),n.push(new zt("timeCreated")),n.push(new zt("updated")),n.push(new zt("md5Hash",null,!0)),n.push(new zt("cacheControl",null,!0)),n.push(new zt("contentDisposition",null,!0)),n.push(new zt("contentEncoding",null,!0)),n.push(new zt("contentLanguage",null,!0)),n.push(new zt("contentType",null,!0)),n.push(new zt("metadata","customMetadata",!0)),x_=n,x_}function m7(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new _n(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function g7(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return m7(r,n),r}function QV(n,e,t){let r=OS(e);return r===null?null:g7(n,r,t)}function _7(n,e,t,r){let i=OS(e);if(i===null||!P_(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=n.bucket,h=n.fullPath,p="/b/"+o(d)+"/o/"+o(h),_=Bs(p,t,r),w=qV({alt:"media",token:l});return _+w})[0]}function LS(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var NV="prefixes",PV="items";function y7(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[NV])for(let i of t[NV]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new _n(e,s));r.prefixes.push(o)}if(t[PV])for(let i of t[PV]){let s=n._makeStorageReference(new _n(e,i.name));r.items.push(s)}return r}function v7(n,e,t){let r=OS(t);return r===null?null:y7(n,e,r)}var Cr=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function hi(n){if(!n)throw NS()}function k_(n,e){function t(r,i){let s=QV(n,i,e);return hi(s!==null),s}return t}function w7(n,e){function t(r,i){let s=v7(n,e,i);return hi(s!==null),s}return t}function I7(n,e){function t(r,i){let s=QV(n,i,e);return hi(s!==null),_7(s,i,n.host,n._protocol)}return t}function Il(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=UQ():i=VQ():t.getStatus()===402?i=FQ(n.bucket):t.getStatus()===403?i=BQ(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function O_(n){let e=Il(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=LQ(n.path)),s.serverResponse=i.serverResponse,s}return t}function YV(n,e,t){let r=e.fullServerUrl(),i=Bs(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Cr(i,s,k_(n,t),o);return a.errorHandler=O_(e),a}function E7(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=Bs(o,n.host,n._protocol),c="GET",l=n.maxOperationRetryTime,d=new Cr(a,c,w7(n,e.bucket),l);return d.urlParams=s,d.errorHandler=Il(e),d}function T7(n,e,t){let r=e.fullServerUrl(),i=Bs(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Cr(i,s,I7(n,t),o);return a.errorHandler=O_(e),a}function b7(n,e,t,r){let i=e.fullServerUrl(),s=Bs(i,n.host,n._protocol),o="PATCH",a=LS(t,r),c={"Content-Type":"application/json; charset=utf-8"},l=n.maxOperationRetryTime,d=new Cr(s,o,k_(n,r),l);return d.headers=c,d.body=a,d.errorHandler=O_(e),d}function C7(n,e){let t=e.fullServerUrl(),r=Bs(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,l){}let a=new Cr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=O_(e),a}function S7(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function JV(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=S7(null,e)),r}function D7(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let V="";for(let Q=0;Q<2;Q++)V=V+Math.random().toString().slice(2);return V}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let l=JV(e,r,i),d=LS(l,t),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,p=`\r
--`+c+"--",_=yl.getBlob(h,r,p);if(_===null)throw $V();let w={name:l.fullPath},b=Bs(s,n.host,n._protocol),S="POST",O=n.maxUploadRetryTime,H=new Cr(b,S,k_(n,t),O);return H.urlParams=w,H.headers=o,H.body=_.uploadData(),H.errorHandler=Il(e),H}var vl=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function FS(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{hi(!1)}return hi(!!t&&(e||["active"]).indexOf(t)!==-1),t}function A7(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=JV(e,r,i),a={name:o.fullPath},c=Bs(s,n.host,n._protocol),l="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=LS(o,t),p=n.maxUploadRetryTime;function _(b){FS(b);let S;try{S=b.getResponseHeader("X-Goog-Upload-URL")}catch{hi(!1)}return hi(P_(S)),S}let w=new Cr(c,l,_,p);return w.urlParams=a,w.headers=d,w.body=h,w.errorHandler=Il(e),w}function R7(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(l){let d=FS(l,["active","final"]),h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{hi(!1)}h||hi(!1);let p=Number(h);return hi(!isNaN(p)),new vl(p,r.size(),d==="final")}let o="POST",a=n.maxUploadRetryTime,c=new Cr(t,o,s,a);return c.headers=i,c.errorHandler=Il(e),c}var MV=256*1024;function x7(n,e,t,r,i,s,o,a){let c=new vl(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw qQ();let l=c.total-c.current,d=l;i>0&&(d=Math.min(d,i));let h=c.current,p=h+d,_="";d===0?_="finalize":l===d?_="upload, finalize":_="upload";let w={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${c.current}`},b=r.slice(h,p);if(b===null)throw $V();function S(Q,ae){let J=FS(Q,["active","final"]),T=c.current+d,v=r.size(),I;return J==="final"?I=k_(e,s)(Q,ae):I=null,new vl(T,v,J==="final",I)}let O="POST",H=e.maxUploadRetryTime,V=new Cr(t,O,S,H);return V.headers=w,V.body=b.uploadData(),V.progressCallback=a||null,V.errorHandler=Il(n),V}var XV={STATE_CHANGED:"state_changed"},nn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function bS(n){switch(n){case"running":case"pausing":case"canceling":return nn.RUNNING;case"paused":return nn.PAUSED;case"success":return nn.SUCCESS;case"canceled":return nn.CANCELED;case"error":return nn.ERROR;default:return nn.ERROR}}var AS=class{constructor(e,t,r){if(YQ(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function ml(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var kV=null,RS=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=_l.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=_l.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=_l.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw vh("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw vh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw vh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw vh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw vh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},xS=class extends RS{initXhr(){this.xhr_.responseType="text"}};function di(){return kV?kV():new xS}var Eh=class{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=M_(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Ze.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(zV(i.status,[]))if(s)i=BV();else{this.sleepTime=Math.max(this.sleepTime*2,OQ),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Ze.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=A7(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,di,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=R7(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,di,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=MV*this._chunkMultiplier,t=new vl(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=x7(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,di,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){MV*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=YV(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,di,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=D7(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,di,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=jV(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=bS(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new AS(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(bS(this._state)){case nn.SUCCESS:ml(this._resolve.bind(null,this.snapshot))();break;case nn.CANCELED:case nn.ERROR:let t=this._reject;ml(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(bS(this._state)){case nn.RUNNING:case nn.PAUSED:e.next&&ml(e.next.bind(e,this.snapshot))();break;case nn.SUCCESS:e.complete&&ml(e.complete.bind(e))();break;case nn.CANCELED:case nn.ERROR:e.error&&ml(e.error.bind(e,this._error))();break;default:e.error&&ml(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var wl=class n{constructor(e,t){this._service=e,t instanceof _n?this._location=t:this._location=_n.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new _n(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return KV(this._location.path)}get storage(){return this._service}get parent(){let e=d7(this._location.path);if(e===null)return null;let t=new _n(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw PS(e)}};function N7(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new Eh(n,new yl(e),t)}function P7(n){let e={prefixes:[],items:[]};return ZV(n,e).then(()=>e)}function ZV(n,e,t){return g(this,null,function*(){let i=yield eU(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield ZV(n,e,i.nextPageToken))})}function eU(n,e){e!=null&&typeof e.maxResults=="number"&&SS("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=E7(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,di)}function M7(n){n._throwIfRoot("getMetadata");let e=YV(n.storage,n._location,M_());return n.storage.makeRequestWithTokens(e,di)}function k7(n,e){n._throwIfRoot("updateMetadata");let t=b7(n.storage,n._location,e,M_());return n.storage.makeRequestWithTokens(t,di)}function O7(n){n._throwIfRoot("getDownloadURL");let e=T7(n.storage,n._location,M_());return n.storage.makeRequestWithTokens(e,di).then(t=>{if(t===null)throw zQ();return t})}function L7(n){n._throwIfRoot("deleteObject");let e=C7(n.storage,n._location);return n.storage.makeRequestWithTokens(e,di)}function tU(n,e){let t=h7(n._location.path,e),r=new _n(n._location.bucket,t);return new wl(n.storage,r)}function F7(n){return/^[A-Za-z]+:\/\//.test(n)}function V7(n,e){return new wl(n,e)}function nU(n,e){if(n instanceof Th){let t=n;if(t._bucket==null)throw HQ();let r=new wl(t,t._bucket);return e!=null?nU(r,e):r}else return e!==void 0?tU(n,e):n}function U7(n,e){if(e&&F7(e)){if(n instanceof Th)return V7(n,e);throw da("To use ref(service, url), the first argument must be a Storage instance.")}else return nU(n,e)}function OV(n,e){let t=e?.[UV];return t==null?null:_n.makeFromBucketSpec(t,n)}function B7(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:pc(i,n.app.options.projectId))}var Th=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=VV,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=MQ,this._maxUploadRetryTime=kQ,this._requests=new Set,i!=null?this._bucket=_n.makeFromBucketSpec(i,this._host):this._bucket=OV(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=_n.makeFromBucketSpec(this._url,e):this._bucket=OV(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){SS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){SS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return g(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return g(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new wl(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new CS(HV());{let o=n7(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return g(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},LV="@firebase/storage",FV="0.12.5";var j7="storage";function rU(n,e,t){return n=q(n),N7(n,e,t)}function iU(n){return n=q(n),M7(n)}function sU(n,e){return n=q(n),k7(n,e)}function oU(n,e){return n=q(n),eU(n,e)}function aU(n){return n=q(n),P7(n)}function cU(n){return n=q(n),O7(n)}function lU(n){return n=q(n),L7(n)}function VS(n,e){return n=q(n),U7(n,e)}function uU(n,e){return tU(n,e)}function dU(n,e,t,r={}){B7(n,e,t,r)}function $7(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Th(t,r,i,e,fn)}function H7(){hn(new Ve(j7,$7,"PUBLIC").setMultipleInstances(!0)),ft(LV,FV,""),ft(LV,FV,"esm2017")}H7();var El=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var L_=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new El(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new El(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new El(o,this,this._ref)):s={next:t.next?o=>t.next(new El(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},F_=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new ha(e,this._service))}get items(){return this._delegate.items.map(e=>new ha(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var ha=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=uU(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new L_(rU(this._delegate,e,t),this)}putString(e,t=Fn.RAW,r){this._throwIfRoot("putString");let i=kS(t,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new L_(new Eh(this._delegate,new yl(i.data,!0),s),this)}listAll(){return aU(this._delegate).then(e=>new F_(e,this.storage))}list(e){return oU(this._delegate,e||void 0).then(t=>new F_(t,this.storage))}getMetadata(){return iU(this._delegate)}updateMetadata(e){return sU(this._delegate,e)}getDownloadURL(){return cU(this._delegate)}delete(){return this._throwIfRoot("delete"),lU(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw PS(e)}};var V_=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(hU(e))throw da("ref() expected a child path but got a URL, use refFromURL instead.");return new ha(VS(this._delegate,e),this)}refFromURL(e){if(!hU(e))throw da("refFromURL() expected a full URL but got a child path, use ref() instead.");try{_n.makeFromUrl(e,this._delegate.host)}catch{throw da("refFromUrl() expected a valid full URL but got an invalid one.")}return new ha(VS(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){dU(this._delegate,e,t,r)}};function hU(n){return/^[A-Za-z]+:\/\//.test(n)}var q7="@firebase/storage-compat",z7="0.3.8";var G7="storage-compat";function W7(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new V_(t,r)}function K7(n){let e={TaskState:nn,TaskEvent:XV,StringFormat:Fn,Storage:V_,Reference:ha};n.INTERNAL.registerComponent(new Ve(G7,W7,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(q7,z7)}K7(X);var fU="@firebase/database",pU="1.0.5";var YD="";function JD(n){YD=n}var GS=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),It(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:hc(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var WS=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return dn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var zU=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new GS(e)}}catch{}return new WS},pa=zU("localStorage"),KS=zU("sessionStorage");var Sl=new Sn("@firebase/database"),GU=function(){let n=1;return function(){return n++}}(),WU=function(n){let e=Ck(n),t=new Tm;t.update(e);let r=t.digest();return bm.encodeByteArray(r)},Wh=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Wh.apply(null,r):typeof r=="object"?e+=It(r):e+=r,e+=" "}return e},ma=null,mU=!0,KU=function(n,e){j(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Sl.logLevel=ge.VERBOSE,ma=Sl.log.bind(Sl),e&&KS.set("logging_enabled",!0)):typeof n=="function"?ma=n:(ma=null,KS.remove("logging_enabled"))},Vt=function(...n){if(mU===!0&&(mU=!1,ma===null&&KS.get("logging_enabled")===!0&&KU(!0)),ma){let e=Wh.apply(null,n);ma(e)}},Kh=function(n){return function(...e){Vt(n,...e)}},QS=function(...n){let e="FIREBASE INTERNAL ERROR: "+Wh(...n);Sl.error(e)},mi=function(...n){let e=`FIREBASE FATAL ERROR: ${Wh(...n)}`;throw Sl.error(e),new Error(e)},rn=function(...n){let e="FIREBASE WARNING: "+Wh(...n);Sl.warn(e)},Q7=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&rn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},hy=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Y7=function(n){if(Gr()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},qs="[MIN_NAME]",ji="[MAX_NAME]",_a=function(n,e){if(n===e)return 0;if(n===qs||e===ji)return-1;if(e===qs||n===ji)return 1;{let t=gU(n),r=gU(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},J7=function(n,e){return n===e?0:n<e?-1:1},bh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+It(e))},XD=function(n){if(typeof n!="object"||n===null)return It(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=It(e[r]),t+=":",t+=XD(n[e[r]]);return t+="}",t},QU=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Ut(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var YU=function(n){j(!hy(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),h="";for(c=0;c<64;c+=8){let p=parseInt(d.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),h=h+p}return h.toLowerCase()},X7=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Z7=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function eY(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var tY=new RegExp("^-?(0*)\\d{1,10}$"),nY=-2147483648,rY=2147483647,gU=function(n){if(tY.test(n)){let e=Number(n);if(e>=nY&&e<=rY)return e}return null},Ol=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw rn("Exception was thrown by user callback.",t),e},Math.floor(0))}},iY=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ah=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var YS=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){rn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var JS=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Vt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',rn(e)}},Rh=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),B_="5",JU="v",XU="s",ZU="r",e2="f",t2=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,n2="ls",r2="p",XS="ac",i2="websocket",s2="long_polling";var j_=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=pa.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&pa.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function sY(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function o2(n,e,t){j(typeof e=="string","typeof type must == string"),j(typeof t=="object","typeof params must == object");let r;if(e===i2)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===s2)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);sY(n)&&(t.ns=n.namespace);let i=[];return Ut(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var ZS=class{constructor(){this.counters_={}}incrementCounter(e,t=1){dn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return vk(this.counters_)}};var US={},BS={};function ZD(n){let e=n.toString();return US[e]||(US[e]=new ZS),US[e]}function oY(n,e){let t=n.toString();return BS[t]||(BS[t]=e()),BS[t]}var eD=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Ol(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var _U="start",aY="close",cY="pLPCommand",lY="pRTLPCB",a2="id",c2="pw",l2="ser",uY="cb",dY="seg",hY="ts",fY="d",pY="dframe",u2=1870,d2=30,mY=u2-d2,gY=25e3,_Y=3e4,Mh=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Kh(e),this.stats_=ZD(t),this.urlFn=c=>(this.appCheckToken&&(c[XS]=this.appCheckToken),o2(t,s2,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new eD(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(_Y)),Y7(()=>{if(this.isClosed_)return;this.scriptTagHolder=new tD((...s)=>{let[o,a,c,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===_U)this.id=a,this.password=c;else if(o===aY)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[_U]="t",r[l2]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[uY]=this.scriptTagHolder.uniqueCallbackIdentifier),r[JU]=B_,this.transportSessionId&&(r[XU]=this.transportSessionId),this.lastSessionId&&(r[n2]=this.lastSessionId),this.applicationId&&(r[r2]=this.applicationId),this.appCheckToken&&(r[XS]=this.appCheckToken),typeof location<"u"&&location.hostname&&t2.test(location.hostname)&&(r[ZU]=e2);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Gr()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!X7()&&!Z7()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=It(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=yE(t),i=QU(r,mY);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Gr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[pY]="t",r[a2]=e,r[c2]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=It(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},tD=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Gr())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=GU(),window[cY+this.uniqueCallbackIdentifier]=e,window[lY+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Vt("frame writing exception"),a.stack&&Vt(a.stack),Vt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Vt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[a2]=this.myID,e[c2]=this.myPW,e[l2]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+d2+r.length<=u2;){let o=this.pendingSegs.shift();r=r+"&"+dY+i+"="+o.seg+"&"+hY+i+"="+o.ts+"&"+fY+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(gY)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){Gr()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Vt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var yY=16384,vY=45e3,$_=null;typeof MozWebSocket<"u"?$_=MozWebSocket:typeof WebSocket<"u"&&($_=WebSocket);var bl=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Kh(this.connId),this.stats_=ZD(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[JU]=B_,!Gr()&&typeof location<"u"&&location.hostname&&t2.test(location.hostname)&&(a[ZU]=e2),r&&(a[XU]=r),i&&(a[n2]=i),s&&(a[XS]=s),o&&(a[r2]=o),o2(t,i2,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,pa.set("previous_websocket_failure",!0);try{let i;if(Gr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${B_}/${YD}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new $_(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&$_!==null&&!n.forceDisallow_}static previouslyFailed(){return pa.isInMemoryStorage||pa.get("previous_websocket_failure")===!0}markConnectionHealthy(){pa.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=hc(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(j(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=It(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=QU(r,yY);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(vY))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),h2=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Mh,bl]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=bl&&bl.isAvailable(),i=r&&!bl.previouslyFailed();if(t.webSocketOnly&&(r||rn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[bl];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),wY=6e4,IY=5e3,EY=10*1024,TY=100*1024,jS="t",yU="d",bY="s",vU="r",CY="e",wU="o",IU="a",EU="n",TU="p",SY="h",nD=class{constructor(e,t,r,i,s,o,a,c,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Kh("c:"+this.id+":"),this.transportManager_=new h2(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Ah(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>TY?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>EY?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(jS in e){let t=e[jS];t===IU?this.upgradeIfSecondaryHealthy_():t===vU?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===wU&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=bh("t",e),r=bh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:TU,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:IU,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:EU,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=bh("t",e),r=bh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=bh(jS,e);if(yU in e){let r=e[yU];if(t===SY){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===EU){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===bY?this.onConnectionShutdown_(r):t===vU?this.onReset_(r):t===CY?QS("Server Error: "+r):t===wU?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):QS("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),B_!==r&&rn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Ah(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(wY))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ah(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(IY))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:TU,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(pa.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var H_=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var q_=class{constructor(e){this.allowedEvents_=e,this.listeners_={},j(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){j(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var z_=class n extends q_{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!nd()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return j(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var bU=32,CU=768,ke=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Me(){return new ke("")}function _e(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function zs(n){return n.pieces_.length-n.pieceNum_}function He(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ke(n.pieces_,e)}function eA(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function DY(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function kh(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function f2(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ke(e,0)}function et(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof ke)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new ke(t,0)}function ye(n){return n.pieceNum_>=n.pieces_.length}function yn(n,e){let t=_e(n),r=_e(e);if(t===null)return e;if(t===r)return yn(He(n),He(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function AY(n,e){let t=kh(n,0),r=kh(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=_a(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function tA(n,e){if(zs(n)!==zs(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function nr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(zs(n)>zs(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var rD=class{constructor(e,t){this.errorPrefix_=t,this.parts_=kh(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=id(this.parts_[r]);p2(this)}};function RY(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=id(e),p2(n)}function xY(n){let e=n.parts_.pop();n.byteLength_-=id(e),n.parts_.length>0&&(n.byteLength_-=1)}function p2(n){if(n.byteLength_>CU)throw new Error(n.errorPrefix_+"has a key path longer than "+CU+" bytes ("+n.byteLength_+").");if(n.parts_.length>bU)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+bU+") or object contains a cycle "+fa(n))}function fa(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var iD=class n extends q_{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return j(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ch=1e3,NY=60*5*1e3,SU=30*1e3,PY=1.3,MY=3e4,kY="server_kill",DU=3,nA=(()=>{class n extends H_{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=Kh("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ch,this.maxReconnectDelay_=NY,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!Gr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");iD.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&z_.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(It(o)),j(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new Nt,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),j(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),j(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,d=c.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&dn(t,"w")){let i=cs(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();rn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||bk(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=SU)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=Tk(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),j(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+It(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):QS("Unrecognized action received from server: "+It(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){j(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ch,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Ch,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>MY&&(this.reconnectDelay_=Ch),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*PY)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},d=function(p){j(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(p)};this.realtime_={close:l,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[p,_]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?Vt("getToken() completed but was canceled"):(Vt("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=_&&_.token,c=new nD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,w=>{rn(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(kY)},o))}catch(p){this.log_("Failed to get token: "+p),a||(this.repoInfo_.nodeAdmin&&rn(p),l())}}})}interrupt(t){Vt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Vt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],mc(this.interruptReasons_)&&(this.reconnectDelay_=Ch,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>XD(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new ke(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Vt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=DU&&(this.reconnectDelay_=SU,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Vt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=DU&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";Gr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+YD.replace(/\./g,"-")]=1,nd()?t["framework.cordova"]=1:Eo()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=z_.getInstance().currentlyOnline();return mc(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),Ie=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Dl=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new Ie(qs,e),i=new Ie(qs,t);return this.compare(r,i)!==0}minPost(){return Ie.MIN}};var U_,G_=class extends Dl{static get __EMPTY_NODE(){return U_}static set __EMPTY_NODE(e){U_=e}compare(e,t){return _a(e.name,t.name)}isDefinedOn(e){throw Io("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ie.MIN}maxPost(){return new Ie(ji,U_)}makePost(e,t){return j(typeof e=="string","KeyIndex indexValue must always be a string."),new Ie(e,U_)}toString(){return".key"}},pi=new G_;var Cl=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Sr=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??rr.EMPTY_NODE,this.right=o??rr.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return rr.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return rr.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),sD=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new Sr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},rr=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Sr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Sr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Cl(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Cl(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Cl(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Cl(this.root_,null,this.comparator_,!0,e)}};rr.EMPTY_NODE=new sD;function OY(n,e){return _a(n.name,e.name)}function rA(n,e){return _a(n,e)}var oD;function LY(n){oD=n}var m2=function(n){return typeof n=="number"?"number:"+YU(n):"string:"+n},g2=function(n){if(n.isLeafNode()){let e=n.val();j(typeof e=="string"||typeof e=="number"||typeof e=="object"&&dn(e,".sv"),"Priority must be a string or number.")}else j(n===oD||n.isEmpty(),"priority of unexpected type.");j(n===oD||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var AU,Al=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,j(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),g2(this.priorityNode_)}static set __childrenNodeConstructor(t){AU=t}static get __childrenNodeConstructor(){return AU}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return ye(t)?this:_e(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=_e(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(j(i!==".priority"||zs(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(He(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+m2(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=YU(this.value_):t+=this.value_,this.lazyHash_=WU(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(j(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return j(s>=0,"Unknown leaf type: "+r),j(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),_2,y2;function FY(n){_2=n}function VY(n){y2=n}var aD=class extends Dl{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?_a(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ie.MIN}maxPost(){return new Ie(ji,new Al("[PRIORITY-POST]",y2))}makePost(e,t){let r=_2(e);return new Ie(t,new Al("[PRIORITY-POST]",r))}toString(){return".priority"}},Ge=new aD;var UY=Math.log(2),cD=class{constructor(e){let t=s=>parseInt(Math.log(s)/UY,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},W_=function(n,e,t,r){n.sort(e);let i=function(c,l){let d=l-c,h,p;if(d===0)return null;if(d===1)return h=n[c],p=t?t(h):h,new Sr(p,h.node,Sr.BLACK,null,null);{let _=parseInt(d/2,10)+c,w=i(c,_),b=i(_+1,l);return h=n[_],p=t?t(h):h,new Sr(p,h.node,Sr.BLACK,w,b)}},s=function(c){let l=null,d=null,h=n.length,p=function(w,b){let S=h-w,O=h;h-=w;let H=i(S+1,O),V=n[S],Q=t?t(V):V;_(new Sr(Q,V.node,b,null,H))},_=function(w){l?(l.left=w,l=w):(d=w,l=w)};for(let w=0;w<c.count;++w){let b=c.nextBitIsOne(),S=Math.pow(2,c.count-(w+1));b?p(S,Sr.BLACK):(p(S,Sr.BLACK),p(S,Sr.RED))}return d},o=new cD(n.length),a=s(o);return new rr(r||e,a)};var $S,Tl={},Rl=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return j(Tl&&Ge,"ChildrenNode.ts has not been loaded"),$S=$S||new n({".priority":Tl},{".priority":Ge}),$S}get(e){let t=cs(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof rr?t:null}hasIndex(e){return dn(this.indexSet_,e.toString())}addIndex(e,t){j(e!==pi,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(Ie.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=W_(r,e.getCompare()):a=Tl;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,l)}addToIndexes(e,t){let r=rd(this.indexes_,(i,s)=>{let o=cs(this.indexSet_,s);if(j(o,"Missing index implementation for "+s),i===Tl)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(Ie.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),W_(a,o.getCompare())}else return Tl;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new Ie(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=rd(this.indexes_,i=>{if(i===Tl)return i;{let s=t.get(e.name);return s?i.remove(new Ie(e.name,s)):i}});return new n(r,this.indexSet_)}};var Sh,fe=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&g2(this.priorityNode_),this.children_.isEmpty()&&j(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Sh||(Sh=new n(new rr(rA),null,Rl.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Sh}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Sh:r}}getChild(t){let r=_e(t);return r===null?this:this.getImmediateChild(r).getChild(He(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(j(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new Ie(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Sh:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=_e(t);if(i===null)return r;{j(_e(t)!==".priority"||zs(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(He(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Ge,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+m2(this.getPriority().val())+":"),this.forEachChild(Ge,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":WU(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new Ie(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new Ie(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new Ie(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,Ie.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,Ie.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Qh?-1:0}withIndex(t){if(t===pi||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===pi||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ge),s=r.getIterator(Ge),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===pi?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),lD=class extends fe{constructor(){super(new rr(rA),fe.EMPTY_NODE,Rl.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return fe.EMPTY_NODE}isEmpty(){return!1}},Qh=new lD;Object.defineProperties(Ie,{MIN:{value:new Ie(qs,fe.EMPTY_NODE)},MAX:{value:new Ie(ji,Qh)}});G_.__EMPTY_NODE=fe.EMPTY_NODE;Al.__childrenNodeConstructor=fe;LY(Qh);VY(Qh);var BY=!0;function it(n,e=null){if(n===null)return fe.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),j(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Al(t,it(e))}if(!(n instanceof Array)&&BY){let t=[],r=!1;if(Ut(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=it(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Ie(o,c)))}}),t.length===0)return fe.EMPTY_NODE;let s=W_(t,OY,o=>o.name,rA);if(r){let o=W_(t,Ge.getCompare());return new fe(s,it(e),new Rl({".priority":o},{".priority":Ge}))}else return new fe(s,it(e),Rl.Default)}else{let t=fe.EMPTY_NODE;return Ut(n,(r,i)=>{if(dn(n,r)&&r.substring(0,1)!=="."){let s=it(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(it(e))}}FY(it);var Oh=class extends Dl{constructor(e){super(),this.indexPath_=e,j(!ye(e)&&_e(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?_a(e.name,t.name):s}makePost(e,t){let r=it(e),i=fe.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ie(t,i)}maxPost(){let e=fe.EMPTY_NODE.updateChild(this.indexPath_,Qh);return new Ie(ji,e)}toString(){return kh(this.indexPath_,0).join("/")}};var uD=class extends Dl{compare(e,t){let r=e.node.compareTo(t.node);return r===0?_a(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ie.MIN}maxPost(){return Ie.MAX}makePost(e,t){let r=it(e);return new Ie(t,r)}toString(){return".value"}},iA=new uD;function v2(n){return{type:"value",snapshotNode:n}}function xl(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Lh(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Fh(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function jY(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var Vh=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){j(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(Lh(t,a)):j(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(xl(t,r)):o.trackChildChange(Fh(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ge,(i,s)=>{t.hasChild(i)||r.trackChildChange(Lh(i,s))}),t.isLeafNode()||t.forEachChild(Ge,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Fh(i,s,o))}else r.trackChildChange(xl(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?fe.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var K_=class n{constructor(e){this.indexedFilter_=new Vh(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new Ie(t,r))||(r=fe.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=fe.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(fe.EMPTY_NODE);let s=this;return t.forEachChild(Ge,(o,a)=>{s.matches(new Ie(o,a))||(i=i.updateImmediateChild(o,fe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var dD=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new K_(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new Ie(t,r))||(r=fe.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=fe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=fe.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(fe.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,fe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(p,_)=>h(_,p)}else o=this.index_.getCompare();let a=e;j(a.numChildren()===this.limit_,"");let c=new Ie(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(t)){let h=a.getImmediateChild(t),p=i.getChildAfterChild(this.index_,l,this.reverse_);for(;p!=null&&(p.name===t||a.hasChild(p.name));)p=i.getChildAfterChild(this.index_,p,this.reverse_);let _=p==null?1:o(p,c);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(Fh(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(Lh(t,h));let b=a.updateImmediateChild(t,fe.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(s?.trackChildChange(xl(p.name,p.node)),b.updateImmediateChild(p.name,p.node)):b}}else return r.isEmpty()?e:d&&o(l,c)>=0?(s!=null&&(s.trackChildChange(Lh(l.name,l.node)),s.trackChildChange(xl(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,fe.EMPTY_NODE)):e}};var Uh=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ge}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return j(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return j(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:qs}hasEnd(){return this.endSet_}getIndexEndValue(){return j(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return j(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ji}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return j(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ge}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function $Y(n){return n.loadsAllData()?new Vh(n.getIndex()):n.hasLimit()?new dD(n):new K_(n)}function HY(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function qY(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function hD(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function zY(n,e,t){let r;return n.index_===pi||t?r=hD(n,e,t):r=hD(n,e,ji),r.startAfterSet_=!0,r}function fD(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function GY(n,e,t){let r;return n.index_===pi||t?r=fD(n,e,t):r=fD(n,e,qs),r.endBeforeSet_=!0,r}function fy(n,e){let t=n.copy();return t.index_=e,t}function RU(n){let e={};if(n.isDefault())return e;let t;if(n.index_===Ge?t="$priority":n.index_===iA?t="$value":n.index_===pi?t="$key":(j(n.index_ instanceof Oh,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=It(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=It(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+It(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=It(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+It(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function xU(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ge&&(e.i=n.index_.toString()),e}var pD=class n extends H_{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Kh("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(j(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=RU(e._queryParams);this.restRequest_(s+".json",c,(l,d)=>{let h=d;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),cs(this.listens_,o)===a){let p;l?l===401?p="permission_denied":p="rest_error:"+l:p="ok",i(p,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=RU(e._queryParams),r=e._path.toString(),i=new Nt;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ai(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=hc(a.responseText)}catch{rn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&rn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var mD=class{constructor(){this.rootNode_=fe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function Q_(){return{value:null,children:new Map}}function Ll(n,e,t){if(ye(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=_e(e);n.children.has(r)||n.children.set(r,Q_());let i=n.children.get(r);e=He(e),Ll(i,e,t)}}function gD(n,e){if(ye(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(Ge,(r,i)=>{Ll(n,new ke(r),i)}),gD(n,e)}}else if(n.children.size>0){let t=_e(e);return e=He(e),n.children.has(t)&&gD(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function _D(n,e,t){n.value!==null?t(e,n.value):WY(n,(r,i)=>{let s=new ke(e.toString()+"/"+r);_D(i,s,t)})}function WY(n,e){n.children.forEach((t,r)=>{e(r,t)})}var yD=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Ut(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var NU=10*1e3,KY=30*1e3,QY=5*60*1e3,vD=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new yD(e);let r=NU+(KY-NU)*Math.random();Ah(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Ut(e,(i,s)=>{s>0&&dn(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Ah(this.reportStats_.bind(this),Math.floor(Math.random()*2*QY))}};var fi=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(fi||{});function sA(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function oA(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function aA(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var wD=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=fi.ACK_USER_WRITE,this.source=sA()}operationForChild(e){if(ye(this.path)){if(this.affectedTree.value!=null)return j(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new ke(e));return new n(Me(),t,this.revert)}}else return j(_e(this.path)===e,"operationForChild called for unrelated child."),new n(He(this.path),this.affectedTree,this.revert)}};var Y_=class n{constructor(e,t){this.source=e,this.path=t,this.type=fi.LISTEN_COMPLETE}operationForChild(e){return ye(this.path)?new n(this.source,Me()):new n(this.source,He(this.path))}};var Nl=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=fi.OVERWRITE}operationForChild(e){return ye(this.path)?new n(this.source,Me(),this.snap.getImmediateChild(e)):new n(this.source,He(this.path),this.snap)}};var Bh=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=fi.MERGE}operationForChild(e){if(ye(this.path)){let t=this.children.subtree(new ke(e));return t.isEmpty()?null:t.value?new Nl(this.source,Me(),t.value):new n(this.source,Me(),t)}else return j(_e(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,He(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var gi=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ye(e))return this.isFullyInitialized()&&!this.filtered_;let t=_e(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var ID=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function YY(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(jY(o.childName,o.snapshotNode))}),Dh(n,i,"child_removed",e,r,t),Dh(n,i,"child_added",e,r,t),Dh(n,i,"child_moved",s,r,t),Dh(n,i,"child_changed",e,r,t),Dh(n,i,"value",e,r,t),i}function Dh(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>XY(n,a,c)),o.forEach(a=>{let c=JY(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function JY(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function XY(n,e,t){if(e.childName==null||t.childName==null)throw Io("Should only compare child_ events.");let r=new Ie(e.childName,e.snapshotNode),i=new Ie(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function py(n,e){return{eventCache:n,serverCache:e}}function xh(n,e,t,r){return py(new gi(e,t,r),n.serverCache)}function w2(n,e,t,r){return py(n.eventCache,new gi(e,t,r))}function J_(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function ga(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var HS,ZY=()=>(HS||(HS=new rr(J7)),HS),vn=class n{constructor(e,t=ZY()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Ut(e,(r,i)=>{t=t.set(new ke(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Me(),value:this.value};if(ye(e))return null;{let r=_e(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(He(e),t);return s!=null?{path:et(new ke(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ye(e))return this;{let t=_e(e),r=this.children.get(t);return r!==null?r.subtree(He(e)):new n(null)}}set(e,t){if(ye(e))return new n(t,this.children);{let r=_e(e),s=(this.children.get(r)||new n(null)).set(He(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(ye(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=_e(e),r=this.children.get(t);if(r){let i=r.remove(He(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(ye(e))return this.value;{let t=_e(e),r=this.children.get(t);return r?r.get(He(e)):null}}setTree(e,t){if(ye(e))return t;{let r=_e(e),s=(this.children.get(r)||new n(null)).setTree(He(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Me(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(et(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Me(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(ye(e))return null;{let s=_e(e),o=this.children.get(s);return o?o.findOnPath_(He(e),et(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Me(),t)}foreachOnPath_(e,t,r){if(ye(e))return this;{this.value&&r(t,this.value);let i=_e(e),s=this.children.get(i);return s?s.foreachOnPath_(He(e),et(t,i),r):new n(null)}}foreach(e){this.foreach_(Me(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(et(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Dr=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new vn(null))}};function Nh(n,e,t){if(ye(e))return new Dr(new vn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=yn(i,e);return s=s.updateChild(o,t),new Dr(n.writeTree_.set(i,s))}else{let i=new vn(t),s=n.writeTree_.setTree(e,i);return new Dr(s)}}}function ED(n,e,t){let r=n;return Ut(t,(i,s)=>{r=Nh(r,et(e,i),s)}),r}function PU(n,e){if(ye(e))return Dr.empty();{let t=n.writeTree_.setTree(e,new vn(null));return new Dr(t)}}function TD(n,e){return ya(n,e)!=null}function ya(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(yn(t.path,e)):null}function MU(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ge,(r,i)=>{e.push(new Ie(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Ie(r,i.value))}),e}function $s(n,e){if(ye(e))return n;{let t=ya(n,e);return t!=null?new Dr(new vn(t)):new Dr(n.writeTree_.subtree(e))}}function bD(n){return n.writeTree_.isEmpty()}function Pl(n,e){return I2(Me(),n.writeTree_,e)}function I2(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(j(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=I2(et(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(et(n,".priority"),r)),t}}function my(n,e){return C2(e,n)}function eJ(n,e,t,r,i){j(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Nh(n.visibleWrites,e,t)),n.lastWriteId=r}function tJ(n,e,t,r){j(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=ED(n.visibleWrites,e,t),n.lastWriteId=r}function nJ(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function rJ(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);j(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&iJ(a,r.path)?i=!1:nr(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return sJ(n),!0;if(r.snap)n.visibleWrites=PU(n.visibleWrites,r.path);else{let a=r.children;Ut(a,c=>{n.visibleWrites=PU(n.visibleWrites,et(r.path,c))})}return!0}else return!1}function iJ(n,e){if(n.snap)return nr(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&nr(et(n.path,t),e))return!0;return!1}function sJ(n){n.visibleWrites=E2(n.allWrites,oJ,Me()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function oJ(n){return n.visible}function E2(n,e,t){let r=Dr.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)nr(t,o)?(a=yn(t,o),r=Nh(r,a,s.snap)):nr(o,t)&&(a=yn(o,t),r=Nh(r,Me(),s.snap.getChild(a)));else if(s.children){if(nr(t,o))a=yn(t,o),r=ED(r,a,s.children);else if(nr(o,t))if(a=yn(o,t),ye(a))r=ED(r,Me(),s.children);else{let c=cs(s.children,_e(a));if(c){let l=c.getChild(He(a));r=Nh(r,Me(),l)}}}else throw Io("WriteRecord should have .snap or .children")}}return r}function T2(n,e,t,r,i){if(!r&&!i){let s=ya(n.visibleWrites,e);if(s!=null)return s;{let o=$s(n.visibleWrites,e);if(bD(o))return t;if(t==null&&!TD(o,Me()))return null;{let a=t||fe.EMPTY_NODE;return Pl(o,a)}}}else{let s=$s(n.visibleWrites,e);if(!i&&bD(s))return t;if(!i&&t==null&&!TD(s,Me()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(nr(l.path,e)||nr(e,l.path))},a=E2(n.allWrites,o,e),c=t||fe.EMPTY_NODE;return Pl(a,c)}}}function aJ(n,e,t){let r=fe.EMPTY_NODE,i=ya(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ge,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=$s(n.visibleWrites,e);return t.forEachChild(Ge,(o,a)=>{let c=Pl($s(s,new ke(o)),a);r=r.updateImmediateChild(o,c)}),MU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=$s(n.visibleWrites,e);return MU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function cJ(n,e,t,r,i){j(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=et(e,t);if(TD(n.visibleWrites,s))return null;{let o=$s(n.visibleWrites,s);return bD(o)?i.getChild(t):Pl(o,i.getChild(t))}}function lJ(n,e,t,r){let i=et(e,t),s=ya(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=$s(n.visibleWrites,i);return Pl(o,r.getNode().getImmediateChild(t))}else return null}function uJ(n,e){return ya(n.visibleWrites,e)}function dJ(n,e,t,r,i,s,o){let a,c=$s(n.visibleWrites,e),l=ya(c,Me());if(l!=null)a=l;else if(t!=null)a=Pl(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),p=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=p.getNext();for(;_&&d.length<i;)h(_,r)!==0&&d.push(_),_=p.getNext();return d}else return[]}function hJ(){return{visibleWrites:Dr.empty(),allWrites:[],lastWriteId:-1}}function X_(n,e,t,r){return T2(n.writeTree,n.treePath,e,t,r)}function cA(n,e){return aJ(n.writeTree,n.treePath,e)}function kU(n,e,t,r){return cJ(n.writeTree,n.treePath,e,t,r)}function Z_(n,e){return uJ(n.writeTree,et(n.treePath,e))}function fJ(n,e,t,r,i,s){return dJ(n.writeTree,n.treePath,e,t,r,i,s)}function lA(n,e,t){return lJ(n.writeTree,n.treePath,e,t)}function b2(n,e){return C2(et(n.treePath,e),n.writeTree)}function C2(n,e){return{treePath:n,writeTree:e}}var CD=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;j(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),j(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,Fh(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,Lh(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,xl(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,Fh(r,e.snapshotNode,i.oldSnap));else throw Io("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var SD=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},S2=new SD,jh=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new gi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return lA(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:ga(this.viewCache_),s=fJ(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function pJ(n){return{filter:n}}function mJ(n,e){j(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),j(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function gJ(n,e,t,r,i){let s=new CD,o,a;if(t.type===fi.OVERWRITE){let l=t;l.source.fromUser?o=DD(n,e,l.path,l.snap,r,i,s):(j(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!ye(l.path),o=ey(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===fi.MERGE){let l=t;l.source.fromUser?o=yJ(n,e,l.path,l.children,r,i,s):(j(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=AD(n,e,l.path,l.children,r,i,a,s))}else if(t.type===fi.ACK_USER_WRITE){let l=t;l.revert?o=IJ(n,e,l.path,r,i,s):o=vJ(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===fi.LISTEN_COMPLETE)o=wJ(n,e,t.path,r,s);else throw Io("Unknown operation type: "+t.type);let c=s.getChanges();return _J(e,o,c),{viewCache:o,changes:c}}function _J(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=J_(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(v2(J_(e)))}}function D2(n,e,t,r,i,s){let o=e.eventCache;if(Z_(r,t)!=null)return e;{let a,c;if(ye(t))if(j(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=ga(e),d=l instanceof fe?l:fe.EMPTY_NODE,h=cA(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=X_(r,ga(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=_e(t);if(l===".priority"){j(zs(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let h=kU(r,t,d,c);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=He(t),h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let p=kU(r,t,o.getNode(),c);p!=null?h=o.getNode().getImmediateChild(l).updateChild(d,p):h=o.getNode().getImmediateChild(l)}else h=lA(r,l,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),l,h,d,i,s):a=o.getNode()}}return xh(e,a,o.isFullyInitialized()||ye(t),n.filter.filtersNodes())}}function ey(n,e,t,r,i,s,o,a){let c=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(ye(t))l=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);l=d.updateFullNode(c.getNode(),_,null)}else{let _=_e(t);if(!c.isCompleteForPath(t)&&zs(t)>1)return e;let w=He(t),S=c.getNode().getImmediateChild(_).updateChild(w,r);_===".priority"?l=d.updatePriority(c.getNode(),S):l=d.updateChild(c.getNode(),_,S,w,S2,null)}let h=w2(e,l,c.isFullyInitialized()||ye(t),d.filtersNodes()),p=new jh(i,h,s);return D2(n,h,t,i,p,a)}function DD(n,e,t,r,i,s,o){let a=e.eventCache,c,l,d=new jh(i,e,s);if(ye(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=xh(e,l,!0,n.filter.filtersNodes());else{let h=_e(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=xh(e,l,a.isFullyInitialized(),a.isFiltered());else{let p=He(t),_=a.getNode().getImmediateChild(h),w;if(ye(p))w=r;else{let b=d.getCompleteChild(h);b!=null?eA(p)===".priority"&&b.getChild(f2(p)).isEmpty()?w=b:w=b.updateChild(p,r):w=fe.EMPTY_NODE}if(_.equals(w))c=e;else{let b=n.filter.updateChild(a.getNode(),h,w,p,d,o);c=xh(e,b,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function OU(n,e){return n.eventCache.isCompleteForChild(e)}function yJ(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let d=et(t,c);OU(e,_e(d))&&(a=DD(n,a,d,l,i,s,o))}),r.foreach((c,l)=>{let d=et(t,c);OU(e,_e(d))||(a=DD(n,a,d,l,i,s,o))}),a}function LU(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function AD(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;ye(t)?l=r:l=new vn(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((h,p)=>{if(d.hasChild(h)){let _=e.serverCache.getNode().getImmediateChild(h),w=LU(n,_,p);c=ey(n,c,new ke(h),w,i,s,o,a)}}),l.children.inorderTraversal((h,p)=>{let _=!e.serverCache.isCompleteForChild(h)&&p.value===null;if(!d.hasChild(h)&&!_){let w=e.serverCache.getNode().getImmediateChild(h),b=LU(n,w,p);c=ey(n,c,new ke(h),b,i,s,o,a)}}),c}function vJ(n,e,t,r,i,s,o){if(Z_(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(ye(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return ey(n,e,t,c.getNode().getChild(t),i,s,a,o);if(ye(t)){let l=new vn(null);return c.getNode().forEachChild(pi,(d,h)=>{l=l.set(new ke(d),h)}),AD(n,e,t,l,i,s,a,o)}else return e}else{let l=new vn(null);return r.foreach((d,h)=>{let p=et(t,d);c.isCompleteForPath(p)&&(l=l.set(d,c.getNode().getChild(p)))}),AD(n,e,t,l,i,s,a,o)}}function wJ(n,e,t,r,i){let s=e.serverCache,o=w2(e,s.getNode(),s.isFullyInitialized()||ye(t),s.isFiltered());return D2(n,o,t,r,S2,i)}function IJ(n,e,t,r,i,s){let o;if(Z_(r,t)!=null)return e;{let a=new jh(r,e,i),c=e.eventCache.getNode(),l;if(ye(t)||_e(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=X_(r,ga(e));else{let h=e.serverCache.getNode();j(h instanceof fe,"serverChildren would be complete if leaf node"),d=cA(r,h)}d=d,l=n.filter.updateFullNode(c,d,s)}else{let d=_e(t),h=lA(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?l=n.filter.updateChild(c,d,h,He(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(c,d,fe.EMPTY_NODE,He(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=X_(r,ga(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||Z_(r,Me())!=null,xh(e,l,o,n.filter.filtersNodes())}}var RD=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Vh(r.getIndex()),s=$Y(r);this.processor_=pJ(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(fe.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(fe.EMPTY_NODE,a.getNode(),null),d=new gi(c,o.isFullyInitialized(),i.filtersNodes()),h=new gi(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=py(h,d),this.eventGenerator_=new ID(this.query_)}get query(){return this.query_}};function EJ(n){return n.viewCache_.serverCache.getNode()}function TJ(n){return J_(n.viewCache_)}function bJ(n,e){let t=ga(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!ye(e)&&!t.getImmediateChild(_e(e)).isEmpty())?t.getChild(e):null}function FU(n){return n.eventRegistrations_.length===0}function CJ(n,e){n.eventRegistrations_.push(e)}function VU(n,e,t){let r=[];if(t){j(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function UU(n,e,t,r){e.type===fi.MERGE&&e.source.queryId!==null&&(j(ga(n.viewCache_),"We should always have a full cache before handling merges"),j(J_(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=gJ(n.processor_,i,e,t,r);return mJ(n.processor_,s.viewCache),j(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,A2(n,s.changes,s.viewCache.eventCache.getNode(),null)}function SJ(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Ge,(s,o)=>{r.push(xl(s,o))}),t.isFullyInitialized()&&r.push(v2(t.getNode())),A2(n,r,t.getNode(),e)}function A2(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return YY(n.eventGenerator_,e,t,i)}var ty,ny=class{constructor(){this.views=new Map}};function DJ(n){j(!ty,"__referenceConstructor has already been defined"),ty=n}function AJ(){return j(ty,"Reference.ts has not been loaded"),ty}function RJ(n){return n.views.size===0}function uA(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return j(s!=null,"SyncTree gave us an op for an invalid query."),UU(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(UU(o,e,t,r));return s}}function R2(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=X_(t,i?r:null),c=!1;a?c=!0:r instanceof fe?(a=cA(t,r),c=!1):(a=fe.EMPTY_NODE,c=!1);let l=py(new gi(a,c,!1),new gi(r,i,!1));return new RD(e,l)}return o}function xJ(n,e,t,r,i,s){let o=R2(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),CJ(o,t),SJ(o,t)}function NJ(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=Gs(n);if(i==="default")for(let[c,l]of n.views.entries())o=o.concat(VU(l,t,r)),FU(l)&&(n.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=n.views.get(i);c&&(o=o.concat(VU(c,t,r)),FU(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!Gs(n)&&s.push(new(AJ())(e._repo,e._path)),{removed:s,events:o}}function x2(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Hs(n,e){let t=null;for(let r of n.views.values())t=t||bJ(r,e);return t}function N2(n,e){if(e._queryParams.loadsAllData())return gy(n);{let r=e._queryIdentifier;return n.views.get(r)}}function P2(n,e){return N2(n,e)!=null}function Gs(n){return gy(n)!=null}function gy(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var ry;function PJ(n){j(!ry,"__referenceConstructor has already been defined"),ry=n}function MJ(){return j(ry,"Reference.ts has not been loaded"),ry}var kJ=1,iy=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new vn(null),this.pendingWriteTree_=hJ(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function dA(n,e,t,r,i){return eJ(n.pendingWriteTree_,e,t,r,i),i?Fl(n,new Nl(sA(),e,t)):[]}function OJ(n,e,t,r){tJ(n.pendingWriteTree_,e,t,r);let i=vn.fromObject(t);return Fl(n,new Bh(sA(),e,i))}function js(n,e,t=!1){let r=nJ(n.pendingWriteTree_,e);if(rJ(n.pendingWriteTree_,e)){let s=new vn(null);return r.snap!=null?s=s.set(Me(),!0):Ut(r.children,o=>{s=s.set(new ke(o),!0)}),Fl(n,new wD(r.path,s,t))}else return[]}function Yh(n,e,t){return Fl(n,new Nl(oA(),e,t))}function LJ(n,e,t){let r=vn.fromObject(t);return Fl(n,new Bh(oA(),e,r))}function FJ(n,e){return Fl(n,new Y_(oA(),e))}function VJ(n,e,t){let r=hA(n,t);if(r){let i=fA(r),s=i.path,o=i.queryId,a=yn(s,e),c=new Y_(aA(o),a);return pA(n,s,c)}else return[]}function sy(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||P2(o,e))){let c=NJ(o,e,t,r);RJ(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let d=l.findIndex(p=>p._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(p,_)=>Gs(_));if(d&&!h){let p=n.syncPointTree_.subtree(s);if(!p.isEmpty()){let _=jJ(p);for(let w=0;w<_.length;++w){let b=_[w],S=b.query,O=L2(n,b);n.listenProvider_.startListening(Ph(S),$h(n,S),O.hashFn,O.onComplete)}}}!h&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(Ph(e),null):l.forEach(p=>{let _=n.queryToTagMap.get(yy(p));n.listenProvider_.stopListening(Ph(p),_)}))}$J(n,l)}return a}function M2(n,e,t,r){let i=hA(n,r);if(i!=null){let s=fA(i),o=s.path,a=s.queryId,c=yn(o,e),l=new Nl(aA(a),c,t);return pA(n,o,l)}else return[]}function UJ(n,e,t,r){let i=hA(n,r);if(i){let s=fA(i),o=s.path,a=s.queryId,c=yn(o,e),l=vn.fromObject(t),d=new Bh(aA(a),c,l);return pA(n,o,d)}else return[]}function xD(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(p,_)=>{let w=yn(p,i);s=s||Hs(_,w),o=o||Gs(_)});let a=n.syncPointTree_.get(i);a?(o=o||Gs(a),s=s||Hs(a,Me())):(a=new ny,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=fe.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,w)=>{let b=Hs(w,Me());b&&(s=s.updateImmediateChild(_,b))}));let l=P2(a,e);if(!l&&!e._queryParams.loadsAllData()){let p=yy(e);j(!n.queryToTagMap.has(p),"View does not exist, but we have a tag");let _=HJ();n.queryToTagMap.set(p,_),n.tagToQueryMap.set(_,p)}let d=my(n.pendingWriteTree_,i),h=xJ(a,e,t,d,s,c);if(!l&&!o&&!r){let p=N2(a,e);h=h.concat(qJ(n,e,p))}return h}function _y(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=yn(o,e),l=Hs(a,c);if(l)return l});return T2(i,e,s,t,!0)}function BJ(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let h=yn(l,t);r=r||Hs(d,h)});let i=n.syncPointTree_.get(t);i?r=r||Hs(i,Me()):(i=new ny,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new gi(r,!0,!1):null,a=my(n.pendingWriteTree_,e._path),c=R2(i,e,a,s?o.getNode():fe.EMPTY_NODE,s);return TJ(c)}function Fl(n,e){return k2(e,n.syncPointTree_,null,my(n.pendingWriteTree_,Me()))}function k2(n,e,t,r){if(ye(n.path))return O2(n,e,t,r);{let i=e.get(Me());t==null&&i!=null&&(t=Hs(i,Me()));let s=[],o=_e(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,d=b2(r,o);s=s.concat(k2(a,c,l,d))}return i&&(s=s.concat(uA(i,n,r,t))),s}}function O2(n,e,t,r){let i=e.get(Me());t==null&&i!=null&&(t=Hs(i,Me()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=b2(r,o),d=n.operationForChild(o);d&&(s=s.concat(O2(d,a,c,l)))}),i&&(s=s.concat(uA(i,n,r,t))),s}function L2(n,e){let t=e.query,r=$h(n,t);return{hashFn:()=>(EJ(e)||fe.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?VJ(n,t._path,r):FJ(n,t._path);{let s=eY(i,t);return sy(n,t,null,s)}}}}function $h(n,e){let t=yy(e);return n.queryToTagMap.get(t)}function yy(n){return n._path.toString()+"$"+n._queryIdentifier}function hA(n,e){return n.tagToQueryMap.get(e)}function fA(n){let e=n.indexOf("$");return j(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ke(n.substr(0,e))}}function pA(n,e,t){let r=n.syncPointTree_.get(e);j(r,"Missing sync point for query tag that we're tracking");let i=my(n.pendingWriteTree_,e);return uA(r,t,i,null)}function jJ(n){return n.fold((e,t,r)=>{if(t&&Gs(t))return[gy(t)];{let i=[];return t&&(i=x2(t)),Ut(r,(s,o)=>{i=i.concat(o)}),i}})}function Ph(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(MJ())(n._repo,n._path):n}function $J(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=yy(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function HJ(){return kJ++}function qJ(n,e,t){let r=e._path,i=$h(n,e),s=L2(n,t),o=n.listenProvider_.startListening(Ph(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)j(!Gs(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,d,h)=>{if(!ye(l)&&d&&Gs(d))return[gy(d).query];{let p=[];return d&&(p=p.concat(x2(d).map(_=>_.query))),Ut(h,(_,w)=>{p=p.concat(w)}),p}});for(let l=0;l<c.length;++l){let d=c[l];n.listenProvider_.stopListening(Ph(d),$h(n,d))}}return o}var ND=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},PD=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=et(this.path_,e);return new n(this.syncTree_,t)}node(){return _y(this.syncTree_,this.path_)}},zJ=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},BU=function(n,e,t){if(!n||typeof n!="object")return n;if(j(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return GJ(n[".sv"],e,t);if(typeof n[".sv"]=="object")return WJ(n[".sv"],e);j(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},GJ=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:j(!1,"Unexpected server value: "+n)}},WJ=function(n,e,t){n.hasOwnProperty("increment")||j(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&j(!1,"Unexpected increment value: "+r);let i=e.node();if(j(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},F2=function(n,e,t,r){return gA(e,new PD(t,n),r)},mA=function(n,e,t){return gA(n,new ND(e),t)};function gA(n,e,t){let r=n.getPriority().val(),i=BU(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=BU(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Al(a,it(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Al(i))),o.forEachChild(Ge,(a,c)=>{let l=gA(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var Hh=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function vy(n,e){let t=e instanceof ke?e:new ke(e),r=n,i=_e(t);for(;i!==null;){let s=cs(r.node.children,i)||{children:{},childCount:0};r=new Hh(i,r,s),t=He(t),i=_e(t)}return r}function va(n){return n.node.value}function _A(n,e){n.node.value=e,MD(n)}function V2(n){return n.node.childCount>0}function KJ(n){return va(n)===void 0&&!V2(n)}function wy(n,e){Ut(n.node.children,(t,r)=>{e(new Hh(t,n,r))})}function U2(n,e,t,r){t&&!r&&e(n),wy(n,i=>{U2(i,e,!0,r)}),t&&r&&e(n)}function QJ(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Jh(n){return new ke(n.parent===null?n.name:Jh(n.parent)+"/"+n.name)}function MD(n){n.parent!==null&&YJ(n.parent,n.name,n)}function YJ(n,e,t){let r=KJ(t),i=dn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,MD(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,MD(n))}var JJ=/[\[\].#$\/\u0000-\u001F\u007F]/,XJ=/[\[\].#$\u0000-\u001F\u007F]/,qS=10*1024*1024,Iy=function(n){return typeof n=="string"&&n.length!==0&&!JJ.test(n)},B2=function(n){return typeof n=="string"&&n.length!==0&&!XJ.test(n)},ZJ=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),B2(n)},qh=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!hy(n)||n&&typeof n=="object"&&dn(n,".sv")},_i=function(n,e,t,r){r&&e===void 0||Xh(Xt(n,"value"),e,t)},Xh=function(n,e,t){let r=t instanceof ke?new rD(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+fa(r));if(typeof e=="function")throw new Error(n+"contains a function "+fa(r)+" with contents = "+e.toString());if(hy(e))throw new Error(n+"contains "+e.toString()+" "+fa(r));if(typeof e=="string"&&e.length>qS/3&&id(e)>qS)throw new Error(n+"contains a string greater than "+qS+" utf8 bytes "+fa(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Ut(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Iy(o)))throw new Error(n+" contains an invalid key ("+o+") "+fa(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);RY(r,o),Xh(n,a,r),xY(r)}),i&&s)throw new Error(n+' contains ".value" child '+fa(r)+" in addition to actual children.")}},eX=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=kh(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Iy(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(AY);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&nr(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},j2=function(n,e,t,r){if(r&&e===void 0)return;let i=Xt(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Ut(e,(o,a)=>{let c=new ke(o);if(Xh(i,a,et(t,c)),eA(c)===".priority"&&!qh(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),eX(i,s)},yA=function(n,e,t){if(!(t&&e===void 0)){if(hy(e))throw new Error(Xt(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!qh(e))throw new Error(Xt(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Zh=function(n,e,t,r){if(!(r&&t===void 0)&&!Iy(t))throw new Error(Xt(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Vl=function(n,e,t,r){if(!(r&&t===void 0)&&!B2(t))throw new Error(Xt(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},tX=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Vl(n,e,t,r)},Vn=function(n,e){if(_e(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},$2=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Iy(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!ZJ(t))throw new Error(Xt(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var kD=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Ey(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!tA(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function H2(n,e,t){Ey(n,t),q2(n,r=>tA(r,e))}function Un(n,e,t){Ey(n,t),q2(n,r=>nr(r,e)||nr(e,r))}function q2(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(nX(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function nX(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();ma&&Vt("event: "+t.toString()),Ol(r)}}}var z2="repo_interrupt",rX=25,OD=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new kD,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Q_(),this.transactionQueueTree_=new Hh,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function iX(n,e,t){if(n.stats_=ZD(n.repoInfo_),n.forceRestClient_||iY())n.server_=new pD(n.repoInfo_,(r,i,s,o)=>{jU(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>$U(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{It(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new nA(n.repoInfo_,e,(r,i,s,o)=>{jU(n,r,i,s,o)},r=>{$U(n,r)},r=>{sX(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=oY(n.repoInfo_,()=>new vD(n.stats_,n.server_)),n.infoData_=new mD,n.infoSyncTree_=new iy({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=Yh(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),vA(n,"connected",!1),n.serverSyncTree_=new iy({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);Un(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function G2(n){let t=n.infoData_.getNode(new ke(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function ef(n){return zJ({timestamp:G2(n)})}function jU(n,e,t,r,i){n.dataUpdateCount++;let s=new ke(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=rd(t,l=>it(l));o=UJ(n.serverSyncTree_,s,c,i)}else{let c=it(t);o=M2(n.serverSyncTree_,s,c,i)}else if(r){let c=rd(t,l=>it(l));o=LJ(n.serverSyncTree_,s,c)}else{let c=it(t);o=Yh(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Ml(n,s)),Un(n.eventQueue_,a,o)}function $U(n,e){vA(n,"connected",e),e===!1&&cX(n)}function sX(n,e){Ut(e,(t,r)=>{vA(n,t,r)})}function vA(n,e,t){let r=new ke("/.info/"+e),i=it(t);n.infoData_.updateSnapshot(r,i);let s=Yh(n.infoSyncTree_,r,i);Un(n.eventQueue_,r,s)}function Ty(n){return n.nextWriteId_++}function oX(n,e,t){let r=BJ(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=it(i).withIndex(e._queryParams.getIndex());xD(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=Yh(n.serverSyncTree_,e._path,s);else{let a=$h(n.serverSyncTree_,e);o=M2(n.serverSyncTree_,e._path,s,a)}return Un(n.eventQueue_,e._path,o),sy(n.serverSyncTree_,e,t,null,!0),s},i=>(Ul(n,"get for query "+It(e)+" failed: "+i),Promise.reject(new Error(i))))}function wA(n,e,t,r,i){Ul(n,"set",{path:e.toString(),value:t,priority:r});let s=ef(n),o=it(t,r),a=_y(n.serverSyncTree_,e),c=mA(o,a,s),l=Ty(n),d=dA(n.serverSyncTree_,e,c,l,!0);Ey(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(p,_)=>{let w=p==="ok";w||rn("set at "+e+" failed: "+p);let b=js(n.serverSyncTree_,l,!w);Un(n.eventQueue_,e,b),Ws(n,i,p,_)});let h=EA(n,e);Ml(n,h),Un(n.eventQueue_,h,[])}function aX(n,e,t,r){Ul(n,"update",{path:e.toString(),value:t});let i=!0,s=ef(n),o={};if(Ut(t,(a,c)=>{i=!1,o[a]=F2(et(e,a),it(c),n.serverSyncTree_,s)}),i)Vt("update() called with empty data.  Don't do anything."),Ws(n,r,"ok",void 0);else{let a=Ty(n),c=OJ(n.serverSyncTree_,e,o,a);Ey(n.eventQueue_,c),n.server_.merge(e.toString(),t,(l,d)=>{let h=l==="ok";h||rn("update at "+e+" failed: "+l);let p=js(n.serverSyncTree_,a,!h),_=p.length>0?Ml(n,e):e;Un(n.eventQueue_,_,p),Ws(n,r,l,d)}),Ut(t,l=>{let d=EA(n,et(e,l));Ml(n,d)}),Un(n.eventQueue_,e,[])}}function cX(n){Ul(n,"onDisconnectEvents");let e=ef(n),t=Q_();_D(n.onDisconnect_,Me(),(i,s)=>{let o=F2(i,s,n.serverSyncTree_,e);Ll(t,i,o)});let r=[];_D(t,Me(),(i,s)=>{r=r.concat(Yh(n.serverSyncTree_,i,s));let o=EA(n,i);Ml(n,o)}),n.onDisconnect_=Q_(),Un(n.eventQueue_,Me(),r)}function lX(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&gD(n.onDisconnect_,e),Ws(n,t,r,i)})}function HU(n,e,t,r){let i=it(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Ll(n.onDisconnect_,e,i),Ws(n,r,s,o)})}function uX(n,e,t,r,i){let s=it(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Ll(n.onDisconnect_,e,s),Ws(n,i,o,a)})}function dX(n,e,t,r){if(mc(t)){Vt("onDisconnect().update() called with empty data.  Don't do anything."),Ws(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Ut(t,(o,a)=>{let c=it(a);Ll(n.onDisconnect_,et(e,o),c)}),Ws(n,r,i,s)})}function hX(n,e,t){let r;_e(e._path)===".info"?r=xD(n.infoSyncTree_,e,t):r=xD(n.serverSyncTree_,e,t),H2(n.eventQueue_,e._path,r)}function LD(n,e,t){let r;_e(e._path)===".info"?r=sy(n.infoSyncTree_,e,t):r=sy(n.serverSyncTree_,e,t),H2(n.eventQueue_,e._path,r)}function W2(n){n.persistentConnection_&&n.persistentConnection_.interrupt(z2)}function fX(n){n.persistentConnection_&&n.persistentConnection_.resume(z2)}function Ul(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Vt(t,...e)}function Ws(n,e,t,r){e&&Ol(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function pX(n,e,t,r,i,s){Ul(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:GU(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=IA(n,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Xh("transaction failed: Data returned ",c,o.path),o.status=0;let l=vy(n.transactionQueueTree_,e),d=va(l)||[];d.push(o),_A(l,d);let h;typeof c=="object"&&c!==null&&dn(c,".priority")?(h=cs(c,".priority"),j(qh(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(_y(n.serverSyncTree_,e)||fe.EMPTY_NODE).getPriority().val();let p=ef(n),_=it(c,h),w=mA(_,a,p);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=w,o.currentWriteId=Ty(n);let b=dA(n.serverSyncTree_,e,w,o.currentWriteId,o.applyLocally);Un(n.eventQueue_,e,b),by(n,n.transactionQueueTree_)}}function IA(n,e,t){return _y(n.serverSyncTree_,e,t)||fe.EMPTY_NODE}function by(n,e=n.transactionQueueTree_){if(e||Cy(n,e),va(e)){let t=Q2(n,e);j(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&mX(n,Jh(e),t)}else V2(e)&&wy(e,t=>{by(n,t)})}function mX(n,e,t){let r=t.map(l=>l.currentWriteId),i=IA(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];j(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=yn(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{Ul(n,"transaction put response",{path:c.toString(),status:l});let d=[];if(l==="ok"){let h=[];for(let p=0;p<t.length;p++)t[p].status=2,d=d.concat(js(n.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&h.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();Cy(n,vy(n.transactionQueueTree_,e)),by(n,n.transactionQueueTree_),Un(n.eventQueue_,e,d);for(let p=0;p<h.length;p++)Ol(h[p])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{rn("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}Ml(n,e)}},o)}function Ml(n,e){let t=K2(n,e),r=Jh(t),i=Q2(n,t);return gX(n,i,r),r}function gX(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=yn(t,c.path),d=!1,h;if(j(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,i=i.concat(js(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=rX)d=!0,h="maxretry",i=i.concat(js(n.serverSyncTree_,c.currentWriteId,!0));else{let p=IA(n,c.path,o);c.currentInputSnapshot=p;let _=e[a].update(p.val());if(_!==void 0){Xh("transaction failed: Data returned ",_,c.path);let w=it(_);typeof _=="object"&&_!=null&&dn(_,".priority")||(w=w.updatePriority(p.getPriority()));let S=c.currentWriteId,O=ef(n),H=mA(w,p,O);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=H,c.currentWriteId=Ty(n),o.splice(o.indexOf(S),1),i=i.concat(dA(n.serverSyncTree_,c.path,H,c.currentWriteId,c.applyLocally)),i=i.concat(js(n.serverSyncTree_,S,!0))}else d=!0,h="nodata",i=i.concat(js(n.serverSyncTree_,c.currentWriteId,!0))}Un(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}Cy(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)Ol(r[a]);by(n,n.transactionQueueTree_)}function K2(n,e){let t,r=n.transactionQueueTree_;for(t=_e(e);t!==null&&va(r)===void 0;)r=vy(r,t),e=He(e),t=_e(e);return r}function Q2(n,e){let t=[];return Y2(n,e,t),t.sort((r,i)=>r.order-i.order),t}function Y2(n,e,t){let r=va(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);wy(e,i=>{Y2(n,i,t)})}function Cy(n,e){let t=va(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,_A(e,t.length>0?t:void 0)}wy(e,r=>{Cy(n,r)})}function EA(n,e){let t=Jh(K2(n,e)),r=vy(n.transactionQueueTree_,e);return QJ(r,i=>{zS(n,i)}),zS(n,r),U2(r,i=>{zS(n,i)}),t}function zS(n,e){let t=va(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(j(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(j(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(js(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?_A(e,void 0):t.length=s+1,Un(n.eventQueue_,Jh(e),i);for(let o=0;o<r.length;o++)Ol(r[o])}}function _X(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function yX(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):rn(`Invalid query segment '${t}' in query '${n}'`)}return e}var FD=function(n,e){let t=vX(n),r=t.namespace;t.domain==="firebase.com"&&mi(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&mi("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Q7();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new j_(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new ke(t.pathString)}},vX=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=_X(n.substring(d,h)));let p=yX(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let _=e.slice(0,l);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),t=e.substring(w+1),s=r}"ns"in p&&(s=p.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var qU="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",wX=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=qU.charAt(t%64),t=Math.floor(t/64);j(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=qU.charAt(e[i]);return j(o.length===20,"nextPushId: Length should be 20."),o}}();var oy=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+It(this.snapshot.exportVal())}},ay=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var zh=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return j(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var cy=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new Nt;return lX(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Vn("OnDisconnect.remove",this._path);let e=new Nt;return HU(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Vn("OnDisconnect.set",this._path),_i("OnDisconnect.set",e,this._path,!1);let t=new Nt;return HU(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Vn("OnDisconnect.setWithPriority",this._path),_i("OnDisconnect.setWithPriority",e,this._path,!1),yA("OnDisconnect.setWithPriority",t,!1);let r=new Nt;return uX(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Vn("OnDisconnect.update",this._path),j2("OnDisconnect.update",e,this._path,!1);let t=new Nt;return dX(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var wn=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return ye(this._path)?null:eA(this._path)}get ref(){return new Bn(this._repo,this._path)}get _queryIdentifier(){let e=xU(this._queryParams),t=XD(e);return t==="{}"?"default":t}get _queryObject(){return xU(this._queryParams)}isEqual(e){if(e=q(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=tA(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+DY(this._path)}};function Sy(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Qs(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===pi){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==qs)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==ji)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===Ge){if(e!=null&&!qh(e)||t!=null&&!qh(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(j(n.getIndex()instanceof Oh||n.getIndex()===iA,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Dy(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Bn=class n extends wn{constructor(e,t){super(e,t,new Uh,!1)}get parent(){let e=f2(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},kl=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new ke(e),r=Ks(this.ref,e);return new n(this._node.getChild(t),r,Ge)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,Ks(this.ref,r),Ge)))}hasChild(e){let t=new ke(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Bl(n,e){return n=q(n),n._checkNotDeleted("ref"),e!==void 0?Ks(n._root,e):n._root}function TA(n,e){n=q(n),n._checkNotDeleted("refFromURL");let t=FD(e,n._repo.repoInfo_.nodeAdmin);$2("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&mi("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),Bl(n,t.path.toString())}function Ks(n,e){return n=q(n),_e(n._path)===null?tX("child","path",e,!1):Vl("child","path",e,!1),new Bn(n._repo,et(n._path,e))}function Ay(n,e){n=q(n),Vn("push",n._path),_i("push",e,n._path,!0);let t=G2(n._repo),r=wX(t),i=Ks(n,r),s=Ks(n,r),o;return e!=null?o=Ry(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function J2(n){return Vn("remove",n._path),Ry(n,null)}function Ry(n,e){n=q(n),Vn("set",n._path),_i("set",e,n._path,!1);let t=new Nt;return wA(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function X2(n,e){n=q(n),Vn("setPriority",n._path),yA("setPriority",e,!1);let t=new Nt;return wA(n._repo,et(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function Z2(n,e,t){if(Vn("setWithPriority",n._path),_i("setWithPriority",e,n._path,!1),yA("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new Nt;return wA(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function eB(n,e){j2("update",e,n._path,!1);let t=new Nt;return aX(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function tB(n){n=q(n);let e=new zh(()=>{}),t=new Gh(e);return oX(n._repo,n,t).then(r=>new kl(r,new Bn(n._repo,n._path),n._queryParams.getIndex()))}var Gh=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new oy("value",this,new kl(e.snapshotNode,new Bn(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ay(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},ly=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ay(this,e,t):null}createEvent(e,t){j(e.childName!=null,"Child events should have a childName.");let r=Ks(new Bn(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new oy(e.type,this,new kl(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function tf(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,l=(d,h)=>{LD(n._repo,n,a),c(d,h)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new zh(t,s||void 0),a=e==="value"?new Gh(o):new ly(e,o);return hX(n._repo,n,a),()=>LD(n._repo,n,a)}function xy(n,e,t,r){return tf(n,"value",e,t,r)}function nf(n,e,t,r){return tf(n,"child_added",e,t,r)}function bA(n,e,t,r){return tf(n,"child_changed",e,t,r)}function CA(n,e,t,r){return tf(n,"child_moved",e,t,r)}function rf(n,e,t,r){return tf(n,"child_removed",e,t,r)}function SA(n,e,t){let r=null,i=t?new zh(t):null;e==="value"?r=new Gh(i):e&&(r=new ly(e,i)),LD(n._repo,n,r)}var jn=class{},uy=class extends jn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){_i("endAt",this._value,e._path,!0);let t=fD(e._queryParams,this._value,this._key);if(Dy(t),Qs(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new wn(e._repo,e._path,t,e._orderByCalled)}};function nB(n,e){return Zh("endAt","key",e,!0),new uy(n,e)}var VD=class extends jn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){_i("endBefore",this._value,e._path,!1);let t=GY(e._queryParams,this._value,this._key);if(Dy(t),Qs(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new wn(e._repo,e._path,t,e._orderByCalled)}};function rB(n,e){return Zh("endBefore","key",e,!0),new VD(n,e)}var dy=class extends jn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){_i("startAt",this._value,e._path,!0);let t=hD(e._queryParams,this._value,this._key);if(Dy(t),Qs(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new wn(e._repo,e._path,t,e._orderByCalled)}};function iB(n=null,e){return Zh("startAt","key",e,!0),new dy(n,e)}var UD=class extends jn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){_i("startAfter",this._value,e._path,!1);let t=zY(e._queryParams,this._value,this._key);if(Dy(t),Qs(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new wn(e._repo,e._path,t,e._orderByCalled)}};function sB(n,e){return Zh("startAfter","key",e,!0),new UD(n,e)}var BD=class extends jn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new wn(e._repo,e._path,HY(e._queryParams,this._limit),e._orderByCalled)}};function oB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new BD(n)}var jD=class extends jn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new wn(e._repo,e._path,qY(e._queryParams,this._limit),e._orderByCalled)}};function aB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new jD(n)}var $D=class extends jn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Sy(e,"orderByChild");let t=new ke(this._path);if(ye(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Oh(t),i=fy(e._queryParams,r);return Qs(i),new wn(e._repo,e._path,i,!0)}};function cB(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Vl("orderByChild","path",n,!1),new $D(n)}var HD=class extends jn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Sy(e,"orderByKey");let t=fy(e._queryParams,pi);return Qs(t),new wn(e._repo,e._path,t,!0)}};function lB(){return new HD}var qD=class extends jn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Sy(e,"orderByPriority");let t=fy(e._queryParams,Ge);return Qs(t),new wn(e._repo,e._path,t,!0)}};function uB(){return new qD}var zD=class extends jn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Sy(e,"orderByValue");let t=fy(e._queryParams,iA);return Qs(t),new wn(e._repo,e._path,t,!0)}};function dB(){return new zD}var GD=class extends jn{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(_i("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new uy(this._value,this._key)._apply(new dy(this._value,this._key)._apply(e))}};function hB(n,e){return Zh("equalTo","key",e,!0),new GD(n,e)}function ir(n,...e){let t=q(n);for(let r of e)t=r._apply(t);return t}DJ(Bn);PJ(Bn);var IX="FIREBASE_DATABASE_EMULATOR_HOST",WD={},EX=!1;function TX(n,e,t,r){n.repoInfo_=new j_(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function DA(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||mi("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Vt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=FD(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[IX]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=FD(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new Rh(Rh.OWNER):new JS(n.name,n.options,e);$2("Invalid Firebase Database URL",o),ye(o.path)||mi("Database URL must point to the root of a Firebase Database (not including a child path).");let h=CX(a,n,d,new YS(n.name,t));return new KD(h,n)}function bX(n,e){let t=WD[e];(!t||t[n.key]!==n)&&mi(`Database ${e}(${n.repoInfo_}) has already been deleted.`),W2(n),delete t[n.key]}function CX(n,e,t,r){let i=WD[e.name];i||(i={},WD[e.name]=i);let s=i[n.toURLString()];return s&&mi("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new OD(n,EX,t,r),i[n.toURLString()]=s,s}var KD=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(iX(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Bn(this._repo,Me())),this._rootInternal}_delete(){return this._rootInternal!==null&&(bX(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&mi("Cannot call "+e+" on a deleted database.")}};function fB(){h2.IS_TRANSPORT_INITIALIZED&&rn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function pB(){fB(),Mh.forceDisallow()}function mB(){fB(),bl.forceDisallow(),Mh.forceAllow()}function gB(n,e,t,r={}){n=q(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&mi("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&mi('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Rh(Rh.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:pc(r.mockUserToken,n.app.options.projectId);s=new Rh(o)}TX(i,e,t,s)}function _B(n){n=q(n),n._checkNotDeleted("goOffline"),W2(n._repo)}function yB(n){n=q(n),n._checkNotDeleted("goOnline"),fX(n._repo)}function vB(n,e){KU(n,e)}function SX(n){JD(fn),hn(new Ve("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return DA(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),ft(fU,pU,n),ft(fU,pU,"esm2017")}var DX={".sv":"timestamp"};function wB(){return DX}function IB(n){return{".sv":{increment:n}}}var QD=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function EB(n,e,t){var r;if(n=q(n),Vn("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new Nt,o=(c,l,d)=>{let h=null;c?s.reject(c):(h=new kl(d,new Bn(n._repo,n._path),Ge),s.resolve(new QD(l,h)))},a=xy(n,()=>{});return pX(n._repo,n._path,e,o,a,i),s.promise}nA.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};nA.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};SX();var AX="@firebase/database-compat",RX="1.0.5";var xX=new Sn("@firebase/database-compat"),TB=function(n){let e="FIREBASE WARNING: "+n;xX.warn(e)};var NX=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(Xt(n,e)+"must be a boolean.")},PX=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Xt(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var AA=class{constructor(e){this._delegate=e}cancel(e){se("OnDisconnect.cancel",0,1,arguments.length),Pt("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){se("OnDisconnect.remove",0,1,arguments.length),Pt("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){se("OnDisconnect.set",1,2,arguments.length),Pt("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){se("OnDisconnect.setWithPriority",2,3,arguments.length),Pt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(se("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,TB("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Pt("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var RA=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return se("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var wa=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return se("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return se("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return se("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return se("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return se("DataSnapshot.child",0,1,arguments.length),e=String(e),Vl("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return se("DataSnapshot.hasChild",1,1,arguments.length),Vl("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return se("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return se("DataSnapshot.forEach",1,1,arguments.length),Pt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return se("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return se("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return se("DataSnapshot.ref",0,0,arguments.length),new $i(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Ny=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;se("Query.on",2,4,arguments.length),Pt("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new wa(this.database,l),d)};a.userCallback=t,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return xy(this._delegate,a,c),t;case"child_added":return nf(this._delegate,a,c),t;case"child_removed":return rf(this._delegate,a,c),t;case"child_changed":return bA(this._delegate,a,c),t;case"child_moved":return CA(this._delegate,a,c),t;default:throw new Error(Xt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(se("Query.off",0,3,arguments.length),PX("Query.off",e,!0),Pt("Query.off","callback",t,!0),EE("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,SA(this._delegate,e,i)}else SA(this._delegate,e)}get(){return tB(this._delegate).then(e=>new wa(this.database,e))}once(e,t,r,i){se("Query.once",1,4,arguments.length),Pt("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new Nt,a=(l,d)=>{let h=new wa(this.database,l);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":xy(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":nf(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":rf(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":bA(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":CA(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(Xt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return se("Query.limitToFirst",1,1,arguments.length),new n(this.database,ir(this._delegate,oB(e)))}limitToLast(e){return se("Query.limitToLast",1,1,arguments.length),new n(this.database,ir(this._delegate,aB(e)))}orderByChild(e){return se("Query.orderByChild",1,1,arguments.length),new n(this.database,ir(this._delegate,cB(e)))}orderByKey(){return se("Query.orderByKey",0,0,arguments.length),new n(this.database,ir(this._delegate,lB()))}orderByPriority(){return se("Query.orderByPriority",0,0,arguments.length),new n(this.database,ir(this._delegate,uB()))}orderByValue(){return se("Query.orderByValue",0,0,arguments.length),new n(this.database,ir(this._delegate,dB()))}startAt(e=null,t){return se("Query.startAt",0,2,arguments.length),new n(this.database,ir(this._delegate,iB(e,t)))}startAfter(e=null,t){return se("Query.startAfter",0,2,arguments.length),new n(this.database,ir(this._delegate,sB(e,t)))}endAt(e=null,t){return se("Query.endAt",0,2,arguments.length),new n(this.database,ir(this._delegate,nB(e,t)))}endBefore(e=null,t){return se("Query.endBefore",0,2,arguments.length),new n(this.database,ir(this._delegate,rB(e,t)))}equalTo(e,t){return se("Query.equalTo",1,2,arguments.length),new n(this.database,ir(this._delegate,hB(e,t)))}toString(){return se("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return se("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(se("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,Pt(e,"cancel",i.cancel,!0),i.context=r,EE(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(Xt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new $i(this.database,new Bn(this._delegate._repo,this._delegate._path))}},$i=class n extends Ny{constructor(e,t){super(e,new wn(t._repo,t._path,new Uh,!1)),this.database=e,this._delegate=t}getKey(){return se("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return se("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,Ks(this._delegate,e))}getParent(){se("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return se("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){se("Reference.set",1,2,arguments.length),Pt("Reference.set","onComplete",t,!0);let r=Ry(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(se("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,TB("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Vn("Reference.update",this._delegate._path),Pt("Reference.update","onComplete",t,!0);let r=eB(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){se("Reference.setWithPriority",2,3,arguments.length),Pt("Reference.setWithPriority","onComplete",r,!0);let i=Z2(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){se("Reference.remove",0,1,arguments.length),Pt("Reference.remove","onComplete",e,!0);let t=J2(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){se("Reference.transaction",1,3,arguments.length),Pt("Reference.transaction","transactionUpdate",e,!1),Pt("Reference.transaction","onComplete",t,!0),NX("Reference.transaction","applyLocally",r,!0);let i=EB(this._delegate,e,{applyLocally:r}).then(s=>new RA(s.committed,new wa(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){se("Reference.setPriority",1,2,arguments.length),Pt("Reference.setPriority","onComplete",t,!0);let r=X2(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){se("Reference.push",0,2,arguments.length),Pt("Reference.push","onComplete",t,!0);let r=Ay(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Vn("Reference.onDisconnect",this._delegate._path),new AA(new cy(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Ia=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:pB,forceLongPolling:mB}}useEmulator(e,t,r={}){gB(this._delegate,e,t,r)}ref(e){if(se("database.ref",0,1,arguments.length),e instanceof $i){let t=TA(this._delegate,e.toString());return new $i(this,t)}else{let t=Bl(this._delegate,e);return new $i(this,t)}}refFromURL(e){se("database.refFromURL",1,1,arguments.length);let r=TA(this._delegate,e);return new $i(this,r)}goOffline(){return se("database.goOffline",0,0,arguments.length),_B(this._delegate)}goOnline(){return se("database.goOnline",0,0,arguments.length),yB(this._delegate)}};Ia.ServerValue={TIMESTAMP:wB(),increment:n=>IB(n)};function MX({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){JD(t);let a=new ds("database-standalone"),c=new bo("auth-internal",a);c.setComponent(new Ve("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new bo("app-check-internal",a),l.setComponent(new Ve("app-check-internal",()=>i,"PRIVATE"))),{instance:new Ia(DA(n,c,l,e,o),n),namespace:s}}var kX=Object.freeze({__proto__:null,initStandalone:MX});var OX=Ia.ServerValue;function LX(n){n.INTERNAL.registerComponent(new Ve("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new Ia(i,r)},"PUBLIC").setServiceProps({Reference:$i,Query:Ny,Database:Ia,DataSnapshot:wa,enableLogging:vB,INTERNAL:kX,ServerValue:OX}).setMultipleInstances(!0)),n.registerVersion(AX,RX)}LX(X);var FX="firebase",VX="10.12.2";X.registerVersion(FX,VX,"app-compat");var bB=(()=>{let e=class e{constructor(r){this.router=r}ngOnInit(){X.auth().onAuthStateChanged(r=>{r?this.router.navigate(["/chat"]):(this.router.navigate(["/log"]),document.getElementById("sidebar-container").style.display="none",document.getElementById("sidebar").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%")})}};e.\u0275fac=function(i){return new(i||e)(we(wt))},e.\u0275cmp=vt({type:e,selectors:[["app-log"]],decls:9,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],["routerLink","/login",1,"button"],["routerLink","/register",1,"button"]],template:function(i,s){i&1&&(M(0,"div",0),re(1,"div",1),M(2,"div",2),re(3,"img",3),M(4,"button",4),B(5,"Accedi"),k(),M(6,"button",5),B(7,"Registrati"),k()(),re(8,"div",1),k())},dependencies:[fk]});let n=e;return n})();var sn=(()=>{let e=class e{constructor(r){this.router=r,this.currentSector="",this.linkObject={},this.linkCounter=0,this.ticketToRead=!1,this.messageQueue=[]}initNormalScreen(){window.innerWidth>=899&&(document.getElementById("sidebar-container").style.display="flex",document.getElementById("sidebar").style.display="flex",document.getElementById("header").style.display="flex",document.getElementById("router-outlet-container").style.height="calc(100% - 3.5rem)",document.getElementById("router-outlet-container").style.width="calc(100% - 18rem)")}initSector(){document.getElementById("sector-name").innerText=this.currentSector.name,document.getElementById("sector-description").innerText=this.currentSector.description}getUserData(){X.auth().onAuthStateChanged(r=>{r?X.firestore().collection("users_data").doc(r.uid).get().then(i=>{if(i.exists){var s=i.data();this.currentUser=s,document.getElementById("header-name-display").innerText=this.currentUser.name,document.getElementById("header-surname-display").innerText=this.currentUser.surname,document.getElementById("header-email-display").innerText=this.currentUser.email,document.getElementById("header-agency-display").innerText=this.currentUser.agencyName}else this.presentToast("Nessun utente trovato"),this.router.navigate(["/log"])}).catch(i=>{this.presentToast("Errore durante il recupero dell'utente:"+i.message)}):(console.log("Nessun utente loggato."),this.router.navigate(["/log"]))})}convertTimestamp(r){let i=new Date(r),s=String(i.getDate()).padStart(2,"0"),o=String(i.getMonth()+1).padStart(2,"0"),a=String(i.getFullYear()),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0"),d=String(i.getSeconds()).padStart(2,"0");return`${s}/${o}/${a} ${c}:${l}:${d}`}presentToast(r){this.animate1("toast-message"),this.messageQueue.push(r),this.messageQueue.length===1&&this.showMessageFromQueue()}showMessageFromQueue(){let r=this.messageQueue[0];document.getElementById("toast-message").style.display="flex",document.getElementById("toast-message-text").innerText=r,setTimeout(()=>{this.hideToastMessage()},3e3)}hideToastMessage(){this.animateFadeOut("toast-message"),setTimeout(()=>{document.getElementById("toast-message").style.display="none"},100),this.messageQueue.shift(),this.messageQueue.length>0&&(this.showMessageFromQueue(),this.animate1("toast-message"))}animate1(r){var i=document.getElementById(r),s=[{opacity:0},{opacity:1}],o={duration:150,easing:"ease-in-out"};i.animate(s,o)}animateFadeOut(r){var i=document.getElementById(r),s=[{opacity:1},{opacity:0}],o={duration:150,easing:"ease-out"};i.animate(s,o)}};e.\u0275fac=function(i){return new(i||e)(ie(wt))},e.\u0275prov=ne({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var CB=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}login(){var r=document.getElementById("email-login-input").value,i=document.getElementById("password-login-input").value;X.auth().signInWithEmailAndPassword(r,i).then(s=>{var o=s.user;this.generalService.presentToast("Login effettuato con successo"),this.router.navigate(["/chat"])}).catch(s=>{s.code=="auth/invalid-credential"&&this.generalService.presentToast("Email o password non validi")})}};e.\u0275fac=function(i){return new(i||e)(we(sn),we(wt))},e.\u0275cmp=vt({type:e,selectors:[["app-login"]],decls:15,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate",2,"color","#333"],["id","email-login-input","type","text","placeholder","Email",1,"input"],["id","password-login-input","type","text","placeholder","Password",1,"input"],[1,"button",3,"click"]],template:function(i,s){i&1&&(M(0,"div",0),re(1,"div",1),M(2,"div",2),re(3,"img",3),M(4,"div",4)(5,"span",5),B(6,"mail"),k(),re(7,"input",6),k(),M(8,"div",4)(9,"span",5),B(10,"key"),k(),re(11,"input",7),k(),M(12,"button",8),oe("click",function(){return s.login()}),B(13,"Accedi"),k()(),re(14,"div",1),k())}});let n=e;return n})();var SB=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}register(){var r=document.getElementById("email-register-input").value,i=document.getElementById("password-register-input").value,s=document.getElementById("confirm-password-register-input").value,o=document.getElementById("name-register-input").value,a=document.getElementById("surname-register-input").value,c=document.getElementById("agency-name-register-input").value;i==s?X.auth().createUserWithEmailAndPassword(r,i).then(l=>{let d=l.user;var h=X.firestore();h.collection("users_data").doc(d.uid).set({uid:d.uid,name:o,surname:a,agencyName:c,email:r,registration_date:X.firestore.FieldValue.serverTimestamp()}).catch(p=>{this.generalService.presentToast("Errore nel salvataggio dei dati dell'utente durante la registrazione: "+p.message)}),this.generalService.presentToast("Registrazione completata con successo"),this.router.navigate(["/chat"])}).catch(l=>{l.code=="auth/invalid-email"&&this.generalService.presentToast("Email non valida"),l.code=="auth/weak-password"&&this.generalService.presentToast("Password troppo debole")}):this.generalService.presentToast("Le password inserite non corrispondono")}};e.\u0275fac=function(i){return new(i||e)(we(sn),we(wt))},e.\u0275cmp=vt({type:e,selectors:[["app-register"]],decls:43,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate"],["id","name-register-input","type","text","placeholder","Nome",1,"input"],["id","surname-register-input","type","text","placeholder","Cognome",1,"input"],["id","agency-name-register-input",2,"width","100%","height","100%","background","transparent","border","1px solid transparent"],["value","TORINO"],["value","ALBA"],["value","GRINZANE CAVOUR"],["value","ASTI"],["value","BRA"],["value","VAD\xD3 LIGURE"],["id","email-register-input","type","email","placeholder","Email",1,"input"],["id","password-register-input","type","email","placeholder","Password",1,"input"],["id","confirm-password-register-input","type","email","placeholder","Conferma password",1,"input"],[1,"button",2,"width","100%","height","2.5rem",3,"click"]],template:function(i,s){i&1&&(M(0,"div",0),re(1,"div",1),M(2,"div",2),re(3,"img",3),M(4,"div",4)(5,"span",5),B(6,"person"),k(),re(7,"input",6),k(),M(8,"div",4)(9,"span",5),B(10,"person"),k(),re(11,"input",7),k(),M(12,"div",4)(13,"span",5),B(14,"store"),k(),M(15,"select",8)(16,"option",9),B(17,"TORINO"),k(),M(18,"option",10),B(19,"ALBA"),k(),M(20,"option",11),B(21,"GRINZANE CAVOUR"),k(),M(22,"option",12),B(23,"ASTI"),k(),M(24,"option",13),B(25,"BRA"),k(),M(26,"option",14),B(27,"VAD\xD3 LIGURE"),k()()(),M(28,"div",4)(29,"span",5),B(30,"mail"),k(),re(31,"input",15),k(),M(32,"div",4)(33,"span",5),B(34,"lock"),k(),re(35,"input",16),k(),M(36,"div",4)(37,"span",5),B(38,"lock"),k(),re(39,"input",17),k(),M(40,"button",18),oe("click",function(){return s.register()}),B(41,"Register"),k()(),re(42,"div",1),k())}});let n=e;return n})();var DB=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.generalService.initNormalScreen(),this.fetchMessages()}fetchMessages(){let r=X.database(),i=document.getElementById("messages"),s=Bl(r,"messages");nf(s,o=>{let a=o.val().text,c=document.createElement("div");c.id="chat-card-"+o.key,c.className="chat-card";let l=document.createElement("div");l.style.display="flex",l.style.flexDirection="row",l.style.alignItems="center",l.style.justifyContent="space-between",c.appendChild(l);let d=document.createElement("p");d.style.marginBottom="0.5rem",d.style.marginTop="0.5rem",d.textContent=o.val().name+" "+o.val().surname+" | "+o.val().agencyName+" | "+this.convertTimestamp(o.val().timestamp),l.appendChild(d);let h=document.createElement("p");h.style.color="#333",h.style.marginLeft="0.5rem",h.style.cursor="pointer",h.className="material-symbols-outlined",h.textContent="delete",l.appendChild(h),h.addEventListener("click",()=>{this.deleteMessage(o.key)});let p=document.createElement("p");p.style.marginTop="0rem",p.textContent=a,c.appendChild(p),i.appendChild(c)}),rf(s,o=>{let a=o.val().text;document.getElementById("chat-card-"+o.key).remove()})}deleteMessage(r){window.confirm("Sei sicuro di voler eliminare questo messaggio?")&&X.database().ref("/messages/"+r+"/").remove().then(()=>{this.generalService.presentToast("Messaggio eliminato con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione del messaggio: "+i.message)})}sendMessage(){let r=X.database();var i=X.auth().currentUser;let s=document.getElementById("message-input"),o=s.value;if(o){let a=Bl(r,"messages");Ay(a,{text:o,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:i.email,uid:i.uid,timestamp:X.database.ServerValue.TIMESTAMP}),s.value=""}}convertTimestamp(r){let i=new Date(r),s=i.getDate(),o=i.getMonth()+1,a=i.getFullYear(),c=i.getHours(),l=i.getMinutes(),d=i.getSeconds(),h=s<10?`0${s}`:`${s}`,p=o<10?`0${o}`:`${o}`,_=c<10?`0${c}`:`${c}`,w=l<10?`0${l}`:`${l}`,b=d<10?`0${d}`:`${d}`;return`${h}/${p}/${a} ${_}:${w}:${b}`}};e.\u0275fac=function(i){return new(i||e)(we(sn))},e.\u0275cmp=vt({type:e,selectors:[["app-chat"]],decls:9,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden","padding-right","1rem"],["id","messages",2,"width","100%","height","calc(100% - 6rem)","display","flex","flex-direction","column","gap","1rem","overflow-x","hidden","overflow-y","auto","padding-right","1rem","padding-bottom","1rem"],[2,"width","100%","height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem"],["id","message-input","type","text","placeholder","Inserisci qui il tuo messaggio",2,"width","calc(100% - 3.5rem)","border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'",3,"keydown.enter"],["id","send-button",2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"]],template:function(i,s){i&1&&(M(0,"div",0)(1,"h2"),B(2,"Chat Generale"),k(),re(3,"div",1),M(4,"div",2)(5,"input",3),oe("keydown.enter",function(){return s.sendMessage()}),k(),M(6,"button",4),oe("click",function(){return s.sendMessage()}),M(7,"span",5),B(8,"send"),k()()()())}});let n=e;return n})();var AB=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.generalService.initNormalScreen()}};e.\u0275fac=function(i){return new(i||e)(we(sn))},e.\u0275cmp=vt({type:e,selectors:[["app-company"]],decls:24,vars:0,consts:[[2,"height","100%","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[1,"card",2,"padding","1rem","margin-top","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"width","3rem"],[2,"max-width","80%"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","flex-wrap","wrap","gap","1rem"],["href","https://www.agenziaautoteam.it/i-nostri-servizi/","target","_blank",1,"a_button",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"width","2rem"],[2,"margin-top","0rem","margin-bottom","0rem","color","black"],["href","https://www.mcteknology.it/autoteam/WEB_APP_%20AUTOTEAM.pdf","target","_blank",1,"a_button",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"]],template:function(i,s){i&1&&(M(0,"div",0)(1,"div",1)(2,"div",2),re(3,"img",3),M(4,"h3"),B(5,"L'azienda | Mission"),k()(),M(6,"p",4)(7,"strong"),B(8,"CI SONO MOLTE AGENZIE DI PRATICHE AUTO, INFINITE POSSIBILIT\xC0 PER AUTOMOBILISTI E ADDETTI AI LAVORI. CHE COSA RENDE AUTOTEAM DIVERSA E UNICA?"),k()(),M(9,"p"),B(10,"NON CI SONO RICETTE SEGRETE: TUTTO PARTE DALLA PRECISA VOLONT\xC0 DI COSTRUIRE SOLIDE RELAZIONI CON I CLIENTI. DIALOGO, ASSISTENZA, PRESENZA: IN OGNI FASE DEL LAVORO, IN OGNI OCCASIONE, PER QUALSIASI NECESSIT\xC0, AUTOTEAM C'\xC8. UN'AMPIA GAMMA DI SERVIZI E UNA COSTANTE FORMAZIONE DEI COLLABORATORI GARANTISCE TEMPESTIVIT\xC0 E QUALIT\xC0 DEI SERVIZI, METTENDO A DISPOSIZIONE DELLA CLIENTELA PERSONALE ALTAMENTE QUALIFICATO E, DAL PUNTO DI VISTA UMANO, PERSONE DISPOSTE AD ASCOLTARE E A TROVARE LA SOLUZIONE MIGLIORE PER OGNI TIPO DI ESIGENZA."),k(),M(11,"p"),B(12,"UN TEAM FUNZIONA SE ALLA BASE CI SONO VALORI SOLIDI ECONDIVISI. AGENZIA AUTOTEAM CREDE PROFONDAMENTE NEL PROPRIO GRUPPO: STIMA, FIDUCIA, RISPETTO PER I COLLABORATORI SONO LE FONDAMENTA SULLE QUALI SI BASA LA NOSTRA IDEA DI GRUPPO."),k(),M(13,"p"),B(14,"OGNUNO \xC8 IMPORTANTE, IL CONTRIBUTO DI TUTTI CONTRIBUISCE ALLA CRESCITA E AL SUCCESSO."),k(),M(15,"div",5)(16,"a",6),re(17,"img",7),M(18,"p",8),B(19,"Sito Web | Servizi"),k()(),M(20,"a",9),re(21,"img",7),M(22,"p",8),B(23,"Presentazione Web App"),k()()()()())}});let n=e;return n})();function UX(n,e){if(n&1){let t=_o();M(0,"button",7),oe("click",function(){Ur(t);let i=gr();return Br(i.getMoreSectorProcedures())}),B(1,"Recupera altre procedure"),k()}}var RB=(()=>{let e=class e{constructor(r,i,s){this.generalService=r,this.router=i,this.route=s,this.documents=new Xe([]),this.nextPageAvailable=!1}ngOnInit(){this.generalService.currentSector==""&&this.router.navigate(["/chat"])}getMoreSectorProcedures(){!this.lastVisible||!this.nextPageAvailable||X.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSector.id).orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(K({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+r.message),this.nextPageAvailable=!1})}showAddProcedurePopup(){this.generalService.linkObject={},this.generalService.linkCounter=0,document.getElementById("add-new-procedure-popup").style.display="flex"}};e.\u0275fac=function(i){return new(i||e)(we(sn),we(wt),we(Di))},e.\u0275cmp=vt({type:e,selectors:[["app-settori"]],decls:9,vars:1,consts:[[2,"height","100%","overflow-y","auto","overflow-x","hidden","display","flex","flex-direction","column","padding-left","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.5rem"],["id","sector-name"],[1,"material-symbols-outlined","notranslate",2,"color","black","cursor","pointer","font-size","1.8rem",3,"click"],["id","sector-description",2,"margin-top","0rem"],["id","procedure",2,"display","flex","flex-direction","column","gap","1rem"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(M(0,"div",0)(1,"h2",1),re(2,"span",2),B(3," | "),M(4,"span",3),oe("click",function(){return s.showAddProcedurePopup()}),B(5,"add_circle"),k()(),re(6,"p",4)(7,"div",5),$r(8,UX,2,0,"button",6),k()),i&2&&(Ht(8),mr("ngIf",s.nextPageAvailable))},dependencies:[tc]});let n=e;return n})();var xB=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.generalService.initNormalScreen()}};e.\u0275fac=function(i){return new(i||e)(we(sn))},e.\u0275cmp=vt({type:e,selectors:[["app-home"]],decls:1,vars:0,consts:[[2,"height","100%","padding-left","1rem","display","flex","flex-direction","row","flex-wrap","wrap"]],template:function(i,s){i&1&&re(0,"div",0)}});let n=e;return n})();function BX(n,e){n&1&&(M(0,"span"),B(1,"Aperto"),k())}function jX(n,e){n&1&&(M(0,"span"),B(1,"Chiuso"),k())}function $X(n,e){if(n&1){let t=_o();M(0,"div",12)(1,"div",13)(2,"span",14),B(3,"account_circle"),k(),M(4,"p"),B(5),k(),re(6,"div",11),M(7,"span",15),oe("click",function(){let i=Ur(t).$implicit,s=gr();return Br(s.openTicketMenuPopup(i))}),B(8,"more_vert"),k()(),M(9,"h3",16),B(10),$r(11,BX,2,0,"span",17)(12,jX,2,0,"span",17),k(),M(13,"p",18),B(14),k(),M(15,"div",19)(16,"div",20)(17,"div",21)(18,"span",22),B(19,"forum"),k(),M(20,"input",23),oe("keydown.enter",function(){let i=Ur(t).$implicit,s=gr();return Br(s.addComment(i))}),k()(),M(21,"button",24),oe("click",function(){let i=Ur(t).$implicit,s=gr();return Br(s.addComment(i))}),M(22,"span",25),B(23,"send"),k()()(),M(24,"p",26),oe("click",function(){let i=Ur(t).$implicit,s=gr();return Br(s.getComments(i))}),M(25,"span",25),B(26,"keyboard_arrow_down"),k(),B(27,"Commenti"),k(),re(28,"div",27),k()()}if(n&2){let t=e.$implicit;Ht(5),eI("",t.name," ",t.surname," | ",t.agencyName,""),Ht(5),$p("",t.argomento," | "),Ht(),mr("ngIf",t.status=="open"),Ht(),mr("ngIf",t.status=="close"),Ht(2),Ya(t.descrizione),Ht(6),jp("id","comment-input-",t.id,""),Ht(8),jp("id","comment-section-",t.id,"")}}function HX(n,e){if(n&1){let t=_o();M(0,"button",28),oe("click",function(){Ur(t);let i=gr();return Br(i.getMoreTickets())}),B(1,"Recupera altri ticket"),k()}}var NB=(()=>{let e=class e{constructor(r){this.generalService=r,this.documents=new Xe([]),this.nextPageAvailable=!1,this.comments=new Xe([])}ngOnInit(){this.generalService.initNormalScreen(),this.getOpenTickets(),this.setAllTicketsRead()}setAllTicketsRead(){return g(this,null,function*(){let r=Us(X.firestore(),"tickets"),i=yield C_(r);localStorage.setItem("last-ticket-count",i.data().count+""),this.generalService.ticketToRead=!1})}openAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="flex"}openTicketMenuPopup(r){this.generalService.currentTicket=r,document.getElementById("edit-menu-ticket-popup").style.display="flex",r.status=="open"&&(document.getElementById("open-ticket-button").style.display="none",document.getElementById("close-ticket-button").style.display="flex"),r.status=="close"&&(document.getElementById("open-ticket-button").style.display="flex",document.getElementById("close-ticket-button").style.display="none")}showCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="flex"}hideCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="none"}addComment(r){var i=X.auth().currentUser;let s=document.getElementById("comment-input-"+r.id),o=s.value;o.trim()&&(X.database().ref("/comments/"+r.id+"/").push({text:o,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,timestamp:X.database.ServerValue.TIMESTAMP,creator_uid:i.uid}),s.value="",this.getComments(r))}getComments(r){let i=document.getElementById("comment-section-"+r.id);i.innerHTML="",i.style.display=="none"?X.database().ref(`/comments/${r.id}/`).once("value").then(s=>{s.forEach(a=>{let c=a.key,l=a.val(),d=document.getElementById("comment-section-"+r.id),h=document.createElement("div");h.className="comment";let p=document.createElement("p");p.style.marginBottom="0.5rem",p.textContent=l.name+" "+l.surname+" | "+l.agencyName+" | "+this.convertTimestamp(l.timestamp);let _=document.createElement("p");_.style.marginBottom="0.5rem",_.textContent=l.text,h.appendChild(p),h.appendChild(_),d.appendChild(h)});let o=document.getElementById("comment-section-"+r.id);o&&(o.style.display="flex")}).catch(s=>{console.error("Errore durante il recupero dei commenti:",s)}):i.style.display="none"}convertTimestamp(r){let s=new Date(r).toISOString(),[o,a]=s.split("T"),[c,l,d]=o.split("-"),[h]=a.split(".");return`${d}/${l}/${c} ${h}`}getTickets(){return X.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(K({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{console.error("Error getting documents: ",r)})}getOpenTickets(){return X.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","open").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(K({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket aperti: "+r.message)})}getClosedTickets(){return X.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","close").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(K({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket chiusi: "+r.message)})}getMyTickets(){var r=X.auth().currentUser;return X.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("creator_id","==",r.uid).onSnapshot(i=>{let s=[];i.forEach(o=>{s.push(K({id:o.id},o.data()))}),s.length===4?(this.lastVisible=i.docs[i.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(s)},i=>{this.generalService.presentToast("Errore nel recuperare i tuoi ticket: "+i.message)})}getMoreTickets(){!this.lastVisible||!this.nextPageAvailable||X.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(K({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}};e.\u0275fac=function(i){return new(i||e)(we(sn))},e.\u0275cmp=vt({type:e,selectors:[["app-tickets"]],decls:24,vars:4,consts:[[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","flex-wrap","wrap"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","black","font-size","1.8rem","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","border","1px solid rgba(0, 0, 0, 0.192)","border-radius","2rem","padding-left","1rem","padding-right","1rem","height","2.5rem","overflow-y","hidden","overflow-x","auto","margin-bottom","1rem"],[2,"cursor","pointer",3,"click"],[2,"height","100%","width","1px","background","rgba(0, 0, 0, 0.192)"],[2,"overflow-y","auto","overflow-x","hidden","padding-bottom","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","card","style","padding-left: 1rem; padding-bottom: 1rem;",4,"ngFor","ngForOf"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],[2,"flex","1"],[1,"card",2,"padding-left","1rem","padding-bottom","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","padding-right","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem",3,"click"],[2,"margin-top","0rem","margin-bottom","0rem"],[4,"ngIf"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","column","align-items","center","padding-right","1rem"],[2,"width","100%","height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem"],[1,"input-group",2,"width","calc(100% - 3.5rem)"],[1,"material-symbols-outlined","notranslate"],["type","text","placeholder","Scrivi un commento",1,"input",3,"keydown.enter","id"],[2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[2,"cursor","pointer","display","flex","flex-direction","row","align-items","center","width","100%",3,"click"],[2,"display","none","flex-direction","column","gap","1rem","width","100%",3,"id"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(M(0,"div",0)(1,"div",1)(2,"h2",2),B(3,"Tickets"),M(4,"span",3),oe("click",function(){return s.openAddTicketPopup()}),B(5,"add_circle"),k()(),M(6,"div",4)(7,"h3",5),oe("click",function(){return s.getOpenTickets()}),B(8,"Aperti"),k(),re(9,"div",6),M(10,"h3",5),oe("click",function(){return s.getClosedTickets()}),B(11,"Chiusi"),k(),re(12,"div",6),M(13,"h3",5),oe("click",function(){return s.getTickets()}),B(14,"Tutti"),k(),re(15,"div",6),M(16,"h3",5),oe("click",function(){return s.getMyTickets()}),B(17,"Pubblicati da me"),k()()(),M(18,"div",7)(19,"div",8),$r(20,$X,29,11,"div",9),Hp(21,"async"),$r(22,HX,2,0,"button",10),k()(),re(23,"div",11),k()),i&2&&(Ht(20),mr("ngForOf",qp(21,2,s.documents)),Ht(2),mr("ngIf",s.nextPageAvailable))},dependencies:[Zp,tc,em]});let n=e;return n})();var qX=[{path:"",redirectTo:"chat",pathMatch:"full"},{path:"log",component:bB},{path:"login",component:CB},{path:"register",component:SB},{path:"company",component:AB},{path:"chat",component:DB},{path:"settori_e_procedure",component:RB},{path:"home",component:xB},{path:"tickets",component:NB}],PB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=fr({type:e}),e.\u0275inj=hr({imports:[fE.forRoot(qX),fE]});let n=e;return n})();function zX(n,e){if(n&1&&(M(0,"div",48)(1,"span",49),B(2),k()()),n&2){let t=gr();Ht(2),Ya(t.ticketToReadSidebar)}}function GX(n,e){if(n&1){let t=_o();M(0,"button",42),oe("click",function(){let i=Ur(t).$implicit,s=gr();return Br(s.showSectorProcedures(i))}),M(1,"span",43),B(2,"library_books"),k(),B(3),k()}if(n&2){let t=e.$implicit;Ht(3),Ya(t.name)}}var MB=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.documents=new Xe([]),this.initFirebase(),this.generalService.getUserData(),document.addEventListener("DOMContentLoaded",()=>{this.openCloseSettoriEProcedure()})}ngOnInit(){X.auth().onAuthStateChanged(i=>{i?(this.generalService.initNormalScreen(),this.checkForNewTickets()):this.router.navigate(["/log"])}),_h(Us(X.firestore(),"tickets"),i=>{i.docChanges().forEach(s=>{this.checkForNewTickets()})})}checkForNewTickets(){return g(this,null,function*(){let r=Us(X.firestore(),"tickets"),i=yield C_(r);localStorage.getItem("last-ticket-count")!=null?Number(localStorage.getItem("last-ticket-count"))<i.data().count?(this.generalService.ticketToRead=!0,this.ticketToReadSidebar=i.data().count-Number(localStorage.getItem("last-ticket-count")),console.log("Hai nuovi ticket da leggere")):(this.generalService.ticketToRead=!1,console.log("Non Hai nessun ticket nuovo da leggere")):(localStorage.setItem("last-ticket-count","0"),this.checkForNewTickets())})}initFirebase(){let r={apiKey:"AIzaSyCsD3AG7Zq7Aw_VAhn6N9ZGqVdabUrcFZU",authDomain:"tenquestion-6e3dd.firebaseapp.com",databaseURL:"https://tenquestion-6e3dd-default-rtdb.europe-west1.firebasedatabase.app",projectId:"tenquestion-6e3dd",storageBucket:"tenquestion-6e3dd.appspot.com",messagingSenderId:"438469942447",appId:"1:438469942447:web:97b3e3a5bf4620aa4f485a",measurementId:"G-3XVQGB22FD"};X.initializeApp(r)}closeSidebarMobile(){window.innerWidth<=899&&(document.getElementById("sidebar-container").style.display="none")}logout(){window.confirm("Sei sicuro di volerti disconnettere?")&&X.auth().signOut().then(()=>{this.generalService.presentToast("Disconnessione effettuata con successo"),this.router.navigate(["/log"])}).catch(r=>{this.generalService.presentToast("Errore durante la disconnessione: "+r.message)})}goToRoute(r,i){this.closeSidebarMobile(),this.router.navigate(["/"+r])}closeAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="none"}closeTicketMenuPopup(){document.getElementById("edit-menu-ticket-popup").style.display="none"}closeAddNewSectorPopup(){document.getElementById("add-new-sector-popup").style.display="none"}closeAddNewProcedurePopup(){document.getElementById("add-new-procedure-popup").style.display="none"}openCloseSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}deleteTicket(){window.confirm("Sei sicuro di voler eliminare questo ticket?")&&X.firestore().collection("tickets").doc(this.generalService.currentTicket.id).delete().then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket eliminato con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'eliminazione del ticket: "+r.message)})}openTicket(){X.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"open"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aperto con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'apertura del ticket: "+r.message)})}closeTicket(){X.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"close"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket chiuso con successo")}).catch(r=>{this.generalService.presentToast("Errore durante la chiusura del ticket: "+r.message)})}addTicket(){let r=document.getElementById("add-ticket-argomento-input").value,i=document.getElementById("add-ticket-description-input").value;var s=X.auth().currentUser;X.firestore().collection("tickets").add({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:s.email,creator_id:s.uid,timestamp:X.firestore.FieldValue.serverTimestamp(),status:"open"}).then(o=>{document.getElementById("add-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del ticket: "+o.message)})}openCloseSettoriEProcedure(){let r=document.getElementById("settori-menu-container"),i=document.getElementById("open-menu-icon1");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):X.firestore().collection("settori").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(K({id:a.id},a.data()))}),this.documents.next(o),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero dei settori: "+s.message)})}hideOrShowSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}showSectorProcedures(r){this.generalService.currentSector=r,this.router.navigate(["/settori_e_procedure"]),setTimeout(()=>{this.getSectorProcedures(r),this.generalService.initSector(),window.innerWidth<=799&&this.hideOrShowSidebar()},200)}newSector(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-sector-popup").style.display="flex"}addNewSector(){let r=document.getElementById("add-sector-name-input"),i=document.getElementById("add-sector-description-input");var s=X.auth().currentUser;X.firestore().collection("settori").doc().set({name:r.value,description:i.value,timestamp:X.firestore.FieldValue.serverTimestamp(),creator_id:s.uid}).then(()=>{document.getElementById("add-new-sector-popup").style.display="none",this.generalService.presentToast("Settore aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del settore: "+o.message)})}addNewProcedureLink(){let r=document.getElementById("add-procedure-label-input"),i=document.getElementById("add-procedure-link-input"),s=document.getElementById("add-procedure-links-container"),o={label:r.value,link:i.value};this.generalService.linkObject[`resource${this.generalService.linkCounter}`]=o;let a=document.createElement("div");a.className="card",a.id=`entry${this.generalService.linkCounter}`,a.style.paddingLeft="0.8rem",a.style.borderRadius="0.5rem";let c=document.createElement("div");c.className="card-body";let l=document.createElement("h5");l.className="card-title",l.innerText=r.value,l.style.marginTop="0.5rem",l.style.marginBottom="0.5rem";let d=document.createElement("a");d.className="card-link",d.href=i.value,d.innerText=i.value,d.target="_blank",d.style.marginBottom="0.5rem",c.appendChild(l),c.appendChild(d),a.appendChild(c),s.appendChild(a),this.generalService.linkCounter++,r.value="",i.value=""}addNewProcedure(){let r=document.getElementById("add-procedure-name-input"),i=document.getElementById("add-procedure-description-input");X.firestore().collection("procedure").doc().set({name:r.value,description:i.value,sector_id:this.generalService.currentSector.id,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,timestamp:X.firestore.FieldValue.serverTimestamp(),links:this.generalService.linkObject,links_counter:this.generalService.linkCounter}).then(()=>{document.getElementById("add-procedure-name-input").value="",document.getElementById("add-procedure-description-input").value="",document.getElementById("add-procedure-label-input").value="",document.getElementById("add-procedure-link-input").value="",document.getElementById("add-procedure-links-container").innerHTML="",document.getElementById("add-new-procedure-popup").style.display="none",this.generalService.presentToast("Procedura aggiunta con successo")}).catch(s=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+s.message)})}getSectorProcedures(r){let i=document.getElementById("procedure");return i.innerHTML="",X.firestore().collection("procedure").where("sector_id","==",r.id).orderBy("timestamp","desc").onSnapshot(s=>{i.innerHTML="";let o=[];s.forEach(a=>{var c=a.data();let l=document.createElement("div");l.className="card",l.style.paddingLeft="1rem";let d=document.createElement("h4");d.style.marginBottom="0.5rem",d.textContent=c.name+" | "+c.creator_name+" "+c.creator_surname+" | "+this.formatTimestamp(c.timestamp),l.appendChild(d);let h=document.createElement("p");h.style.marginTop="0rem",h.textContent=c.description,l.appendChild(h);let p=document.createElement("div");p.id="resources-div-"+a.id,p.style.display="flex",p.style.flexDirection="row",p.style.flexWrap="wrap",p.style.gap="1rem",p.style.width="100%",p.style.paddingBottom="1rem",l.appendChild(p),i.appendChild(l);let _=c.links;for(let w in _)if(_.hasOwnProperty(w)){let b=_[w],S=document.createElement("div");S.className="card",S.style.display="flex",S.style.alignItems="center",S.style.height="2.5rem",S.style.width="min-content",S.style.paddingLeft="1rem",S.style.paddingRight="1rem",p.appendChild(S);let O=document.createElement("span");O.className="material-symbols-outlined notranslate",O.innerText="link",O.style.marginRight="0.5rem",(b.link.includes(".com")||b.link.includes(".it"))&&(O.innerText="link"),b.link.includes("pdf")&&(O.innerText="picture_as_pdf"),b.link.includes("mp4")&&(O.innerText="movie"),b.link.includes("mkv")&&(O.innerText="movie"),b.link.includes("mp3")&&(O.innerText="volume_up"),S.appendChild(O);let H=document.createElement("img");H.src="assets/imgs/a-autoteam-logo.png",H.style.height="1.5rem",H.style.marginRight="0.5rem",S.appendChild(H);let V=document.createElement("a");V.id="link-"+w,V.style.marginTop="0rem",b.link.startsWith("https://")||(b.link="https://"+b.link),V.href=b.link,V.textContent=b.label,V.target="_blank",S.appendChild(V)}})},s=>{this.generalService.presentToast("Errore nel recuperare le procedure del settore selezionato: "+s.message)})}formatTimestamp(r){let i=r.seconds*1e3+r.nanoseconds/1e6,s=new Date(i),o=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),c=String(s.getDate()).padStart(2,"0"),l=String(s.getHours()).padStart(2,"0"),d=String(s.getMinutes()).padStart(2,"0"),h=String(s.getSeconds()).padStart(2,"0");return`${o}-${a}-${c} ${l}:${d}:${h}`}};e.\u0275fac=function(i){return new(i||e)(we(sn),we(wt))},e.\u0275cmp=vt({type:e,selectors:[["app-root"]],decls:114,vars:4,consts:[["id","toast-message",2,"height","100%","width","100%","display","none","flex-direction","column","pointer-events","none","background","transparent","z-index","99999999","position","absolute","align-items","center","justify-content","end"],[1,"toastMessage",2,"pointer-events","all"],["id","toast-message-text"],["id","add-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"min-width","18rem","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","space-between"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","black","cursor","pointer",3,"click"],[2,"width","100%","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-ticket-argomento-input","type","text","placeholder","Argomento",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-ticket-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[1,"button",3,"click"],["id","edit-menu-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[2,"display","flex","flex-direction","column","gap","1rem"],["id","open-ticket-button",1,"button",3,"click"],["id","close-ticket-button",1,"button",3,"click"],["id","add-new-sector-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-sector-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-sector-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-procedure-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-procedure-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-procedure-label-input","type","text","placeholder","Etichetta",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","margin-top","1rem"],["id","add-procedure-link-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-links-container",2,"display","flex","flex-direction","column","gap","0.5rem"],["id","header",2,"height","3.5rem","border-bottom","1px solid rgba(0, 0, 0, 0.192)","display","flex","flex-direction","row","align-items","center","flex-shrink","0","justify-content","space-between","padding-left","1rem","padding-right","1rem"],[1,"desktop-element",2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2rem","color","#333","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.3rem"],["id","header-name-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-surname-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-email-display",2,"margin-top","0rem","margin-bottom","0rem"],["id","header-agency-display",2,"margin-bottom","0rem","margin-top","0rem"],[1,"mobile-element",2,"display","none","flex-direction","row","align-items","center","gap","1rem"],[2,"width","100%","height","100%","display","flex","flex-direction","row"],["id","sidebar-container",2,"display","flex"],["id","sidebar",1,"desktop-element",2,"display","flex","flex-direction","column","width","18rem","flex-shrink","0","height","calc(100% - 3.5rem)","background","white","border-right","1px solid rgba(0, 0, 0, 0.192)","overflow-y","auto","overflow-x","hidden"],["src","assets\\imgs\\logo.png",2,"width","100%","margin-top","1rem"],[1,"sidebar-button",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["style","background: red; border-radius: 1rem; padding-left: 0.5rem; padding-right: 0.5rem;",4,"ngIf"],["id","open-menu-icon1",1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","settori-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem","margin-bottom","2rem"],[1,"sidebar-button",2,"width","100%",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.8rem"],["class","sidebar-button","style","width: 100%;",3,"click",4,"ngFor","ngForOf"],[2,"flex","1"],[1,"sidebar-button",2,"margin-bottom","1rem",3,"click"],["id","router-outlet-container",2,"width","calc(100% - 18rem)","height","calc(100% - 3.5rem)"],[2,"background","red","border-radius","1rem","padding-left","0.5rem","padding-right","0.5rem"],["id","ticket-to-read-sidebar-display",2,"color","white"]],template:function(i,s){i&1&&(M(0,"div",0)(1,"div",1),re(2,"p",2),k()(),M(3,"div",3)(4,"div",4)(5,"h3",5),B(6,"Nuovo Ticket"),M(7,"span",6),oe("click",function(){return s.closeAddTicketPopup()}),B(8,"close"),k()(),M(9,"div",7),re(10,"input",8)(11,"textarea",9),k(),M(12,"div",5)(13,"button",10),oe("click",function(){return s.closeAddTicketPopup()}),B(14,"Annulla"),k(),M(15,"button",10),oe("click",function(){return s.addTicket()}),B(16,"Pubblica"),k()()()(),M(17,"div",11)(18,"div",4)(19,"h3",5),B(20,"Men\xF9 ticket"),M(21,"span",6),oe("click",function(){return s.closeTicketMenuPopup()}),B(22,"close"),k()(),M(23,"div",12)(24,"button",10),oe("click",function(){return s.deleteTicket()}),B(25,"Elimina"),k(),M(26,"button",13),oe("click",function(){return s.openTicket()}),B(27,"Apri"),k(),M(28,"button",14),oe("click",function(){return s.closeTicket()}),B(29,"Chiudi"),k()()()(),M(30,"div",15)(31,"div",4)(32,"h3",5),B(33,"Nuovo settore"),M(34,"span",6),oe("click",function(){return s.closeAddNewSectorPopup()}),B(35,"close"),k()(),M(36,"div",7),re(37,"input",16)(38,"textarea",17),k(),M(39,"div",5)(40,"button",10),oe("click",function(){return s.closeAddNewSectorPopup()}),B(41,"Annulla"),k(),M(42,"button",10),oe("click",function(){return s.addNewSector()}),B(43,"Aggiungi"),k()()()(),M(44,"div",18)(45,"div",4)(46,"h3",5),B(47,"Nuova procedura"),M(48,"span",6),oe("click",function(){return s.closeAddNewProcedurePopup()}),B(49,"close"),k()(),M(50,"div",7),re(51,"input",19)(52,"textarea",20)(53,"input",21)(54,"input",22),M(55,"button",10),oe("click",function(){return s.addNewProcedureLink()}),B(56,"Aggiungi link"),k(),re(57,"div",23),k(),M(58,"div",5)(59,"button",10),oe("click",function(){return s.closeAddNewProcedurePopup()}),B(60,"Annulla"),k(),M(61,"button",10),oe("click",function(){return s.addNewProcedure()}),B(62,"Conferma"),k()()()(),M(63,"div",24)(64,"div",25)(65,"span",26),oe("click",function(){return s.openCloseSidebar()}),B(66,"menu"),k(),M(67,"div")(68,"div",27),re(69,"h3",28)(70,"h3",29),k(),re(71,"p",30),k(),M(72,"p"),B(73," | "),k(),M(74,"div"),re(75,"h3",31),k()(),M(76,"div",32)(77,"span",26),oe("click",function(){return s.hideOrShowSidebar()}),B(78,"menu"),k()()(),M(79,"div",33)(80,"div",34)(81,"div",35),re(82,"img",36),M(83,"button",37),oe("click",function(){return s.goToRoute("company","close-sidebar")}),M(84,"span",38),B(85,"apartment"),k(),B(86,"L'azienda"),k(),M(87,"button",37),oe("click",function(){return s.goToRoute("tickets","close-sidebar")}),M(88,"span",38),B(89,"style"),k(),B(90,"Tickets "),$r(91,zX,3,1,"div",39),k(),M(92,"button",37),oe("click",function(){return s.goToRoute("chat","close-sidebar")}),M(93,"span",38),B(94,"chat"),k(),B(95,"Chat"),k(),M(96,"button",37),oe("click",function(){return s.openCloseSettoriEProcedure()}),M(97,"span",40),B(98,"keyboard_arrow_down"),k(),B(99,"Settori e procedure"),k(),M(100,"div",41)(101,"button",42),oe("click",function(){return s.newSector()}),M(102,"span",43),B(103,"add_circle"),k(),B(104,"Nuovo settore"),k(),$r(105,GX,4,1,"button",44),Hp(106,"async"),k(),re(107,"div",45),M(108,"button",46),oe("click",function(){return s.logout()}),M(109,"span",38),B(110,"logout"),k(),B(111,"Disconnetti"),k()()(),M(112,"div",47),re(113,"router-outlet"),k()()),i&2&&(Ht(91),mr("ngIf",s.generalService.ticketToRead==!0),Ht(14),mr("ngForOf",qp(106,2,s.documents)))},dependencies:[Zp,tc,oE,em]});let n=e;return n})();var kB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=fr({type:e,bootstrap:[MB]}),e.\u0275inj=hr({providers:[{provide:_r,useClass:Xp}],imports:[CM,PB]});let n=e;return n})();bM().bootstrapModule(kB).catch(n=>console.error(n));
