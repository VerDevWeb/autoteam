var oR=Object.defineProperty,Zj=Object.defineProperties;var e$=Object.getOwnPropertyDescriptors;var iR=Object.getOwnPropertySymbols,t$=Object.getPrototypeOf,n$=Object.prototype.hasOwnProperty,r$=Object.prototype.propertyIsEnumerable,i$=Reflect.get;var sR=(n,e,t)=>e in n?oR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,z=(n,e)=>{for(var t in e||={})n$.call(e,t)&&sR(n,t,e[t]);if(iR)for(var t of iR(e))r$.call(e,t)&&sR(n,t,e[t]);return n},lt=(n,e)=>Zj(n,e$(e));var s$=(n,e)=>{for(var t in e)oR(n,t,{get:e[t],enumerable:!0})};var Qr=(n,e,t)=>i$(t$(n),t,e);var g=(n,e,t)=>new Promise((r,i)=>{var s=c=>{try{a(t.next(c))}catch(l){i(l)}},o=c=>{try{a(t.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(n,e)).next())});var aR=null;var Ev=1,cR=Symbol("SIGNAL");function Le(n){let e=aR;return aR=n,e}var lR={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function o$(n){if(!(Cv(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Ev)){if(!n.producerMustRecompute(n)&&!Iv(n)){n.dirty=!1,n.lastCleanEpoch=Ev;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Ev}}function uR(n){return n&&(n.nextProducerIndex=0),Le(n)}function dR(n,e){if(Le(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Cv(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)bv(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Iv(n){zf(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(o$(t),r!==t.version))return!0}return!1}function hR(n){if(zf(n),Cv(n))for(let e=0;e<n.producerNode.length;e++)bv(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function bv(n,e){if(a$(n),zf(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)bv(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];zf(i),i.producerIndexOfThis[r]=e}}function Cv(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function zf(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function a$(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function c$(){throw new Error}var l$=c$;function fR(n){l$=n}function me(n){return typeof n=="function"}function Ya(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Gf=Ya(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ku(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Bt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(me(r))try{r()}catch(s){e=s instanceof Gf?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{pR(s)}catch(o){e=e??[],o instanceof Gf?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Gf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)pR(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ku(t,e)}remove(e){let{_finalizers:t}=this;t&&ku(t,e),e instanceof n&&e._removeParent(this)}};Bt.EMPTY=(()=>{let n=new Bt;return n.closed=!0,n})();var Tv=Bt.EMPTY;function Wf(n){return n instanceof Bt||n&&"closed"in n&&me(n.remove)&&me(n.add)&&me(n.unsubscribe)}function pR(n){me(n)?n():n.unsubscribe()}var xr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ja={setTimeout(n,e,...t){let{delegate:r}=Ja;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Ja;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Kf(n){Ja.setTimeout(()=>{let{onUnhandledError:e}=xr;if(e)e(n);else throw n})}function Pu(){}var mR=Sv("C",void 0,void 0);function gR(n){return Sv("E",void 0,n)}function _R(n){return Sv("N",n,void 0)}function Sv(n,e,t){return{kind:n,value:e,error:t}}var Io=null;function Xa(n){if(xr.useDeprecatedSynchronousErrorHandling){let e=!Io;if(e&&(Io={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Io;if(Io=null,t)throw r}}else n()}function yR(n){xr.useDeprecatedSynchronousErrorHandling&&Io&&(Io.errorThrown=!0,Io.error=n)}var bo=class extends Bt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Wf(e)&&e.add(this)):this.destination=h$}static create(e,t,r){return new Za(e,t,r)}next(e){this.isStopped?Av(_R(e),this):this._next(e)}error(e){this.isStopped?Av(gR(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Av(mR,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},u$=Function.prototype.bind;function Dv(n,e){return u$.call(n,e)}var xv=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Qf(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Qf(r)}else Qf(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Qf(t)}}},Za=class extends bo{constructor(e,t,r){super();let i;if(me(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&xr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Dv(e.next,s),error:e.error&&Dv(e.error,s),complete:e.complete&&Dv(e.complete,s)}):i=e}this.destination=new xv(i)}};function Qf(n){xr.useDeprecatedSynchronousErrorHandling?yR(n):Kf(n)}function d$(n){throw n}function Av(n,e){let{onStoppedNotification:t}=xr;t&&Ja.setTimeout(()=>t(n,e))}var h$={closed:!0,next:Pu,error:d$,complete:Pu};var ec=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Wn(n){return n}function Rv(...n){return Nv(n)}function Nv(n){return n.length===0?Wn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var He=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=p$(t)?t:new Za(t,r,i);return Xa(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=vR(r),new r((i,s)=>{let o=new Za({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[ec](){return this}pipe(...t){return Nv(t)(this)}toPromise(t){return t=vR(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function vR(n){var e;return(e=n??xr.Promise)!==null&&e!==void 0?e:Promise}function f$(n){return n&&me(n.next)&&me(n.error)&&me(n.complete)}function p$(n){return n&&n instanceof bo||f$(n)&&Wf(n)}function kv(n){return me(n?.lift)}function ke(n){return e=>{if(kv(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Pe(n,e,t,r,i){return new Pv(n,e,t,r,i)}var Pv=class extends bo{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function tc(){return ke((n,e)=>{let t=null;n._refCount++;let r=Pe(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var nc=class extends He{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,kv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Bt;let t=this.getSubject();e.add(this.source.subscribe(Pe(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Bt.EMPTY)}return e}refCount(){return tc()(this)}};var wR=Ya(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var an=(()=>{class n extends He{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Yf(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new wR}next(t){Xa(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Xa(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Xa(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Tv:(this.currentObservers=null,s.push(t),new Bt(()=>{this.currentObservers=null,ku(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new He;return t.source=this,t}}return n.create=(e,t)=>new Yf(e,t),n})(),Yf=class extends an{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Tv}};var De=class extends an{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Kn=new He(n=>n.complete());function ER(n){return n&&me(n.schedule)}function IR(n){return n[n.length-1]}function bR(n){return me(IR(n))?n.pop():void 0}function hs(n){return ER(IR(n))?n.pop():void 0}function Jf(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function TR(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{l(r.next(d))}catch(h){o(h)}}function c(d){try{l(r.throw(d))}catch(h){o(h)}}function l(d){d.done?s(d.value):i(d.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function CR(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Co(n){return this instanceof Co?(this.v=n,this):new Co(n)}function SR(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(E){return Promise.resolve(E).then(_,h)}}function a(_,E){r[_]&&(i[_]=function(A){return new Promise(function(R,V){s.push([_,A,R,V])>1||c(_,A)})},E&&(i[_]=E(i[_])))}function c(_,E){try{l(r[_](E))}catch(A){p(s[0][3],A)}}function l(_){_.value instanceof Co?Promise.resolve(_.value.v).then(d,h):p(s[0][2],_)}function d(_){c("next",_)}function h(_){c("throw",_)}function p(_,E){_(E),s.shift(),s.length&&c(s[0][0],s[0][1])}}function DR(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof CR=="function"?CR(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Xf=n=>n&&typeof n.length=="number"&&typeof n!="function";function Zf(n){return me(n?.then)}function ep(n){return me(n[ec])}function tp(n){return Symbol.asyncIterator&&me(n?.[Symbol.asyncIterator])}function np(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function m$(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var rp=m$();function ip(n){return me(n?.[rp])}function sp(n){return SR(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Co(t.read());if(i)return yield Co(void 0);yield yield Co(r)}}finally{t.releaseLock()}})}function op(n){return me(n?.getReader)}function Ht(n){if(n instanceof He)return n;if(n!=null){if(ep(n))return g$(n);if(Xf(n))return _$(n);if(Zf(n))return y$(n);if(tp(n))return AR(n);if(ip(n))return v$(n);if(op(n))return w$(n)}throw np(n)}function g$(n){return new He(e=>{let t=n[ec]();if(me(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function _$(n){return new He(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function y$(n){return new He(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Kf)})}function v$(n){return new He(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function AR(n){return new He(e=>{E$(n,e).catch(t=>e.error(t))})}function w$(n){return AR(sp(n))}function E$(n,e){var t,r,i,s;return TR(this,void 0,void 0,function*(){try{for(t=DR(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function kn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function ap(n,e=0){return ke((t,r)=>{t.subscribe(Pe(r,i=>kn(r,n,()=>r.next(i),e),()=>kn(r,n,()=>r.complete(),e),i=>kn(r,n,()=>r.error(i),e)))})}function cp(n,e=0){return ke((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function xR(n,e){return Ht(n).pipe(cp(e),ap(e))}function RR(n,e){return Ht(n).pipe(cp(e),ap(e))}function NR(n,e){return new He(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function kR(n,e){return new He(t=>{let r;return kn(t,e,()=>{r=n[rp](),kn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>me(r?.return)&&r.return()})}function lp(n,e){if(!n)throw new Error("Iterable cannot be null");return new He(t=>{kn(t,e,()=>{let r=n[Symbol.asyncIterator]();kn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function PR(n,e){return lp(sp(n),e)}function MR(n,e){if(n!=null){if(ep(n))return xR(n,e);if(Xf(n))return NR(n,e);if(Zf(n))return RR(n,e);if(tp(n))return lp(n,e);if(ip(n))return kR(n,e);if(op(n))return PR(n,e)}throw np(n)}function Ct(n,e){return e?MR(n,e):Ht(n)}function he(...n){let e=hs(n);return Ct(n,e)}function rc(n,e){let t=me(n)?n:()=>n,r=i=>i.error(t());return new He(e?i=>e.schedule(r,0,i):r)}function Mv(n){return!!n&&(n instanceof He||me(n.lift)&&me(n.subscribe))}var Li=Ya(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Me(n,e){return ke((t,r)=>{let i=0;t.subscribe(Pe(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:I$}=Array;function b$(n,e){return I$(e)?n(...e):n(e)}function OR(n){return Me(e=>b$(n,e))}var{isArray:C$}=Array,{getPrototypeOf:T$,prototype:S$,keys:D$}=Object;function FR(n){if(n.length===1){let e=n[0];if(C$(e))return{args:e,keys:null};if(A$(e)){let t=D$(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function A$(n){return n&&typeof n=="object"&&T$(n)===S$}function LR(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Mu(...n){let e=hs(n),t=bR(n),{args:r,keys:i}=FR(n);if(r.length===0)return Ct([],e);let s=new He(x$(r,e,i?o=>LR(i,o):Wn));return t?s.pipe(OR(t)):s}function x$(n,e,t=Wn){return r=>{VR(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)VR(e,()=>{let l=Ct(n[c],e),d=!1;l.subscribe(Pe(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function VR(n,e,t){n?kn(t,n,e):e()}function UR(n,e,t,r,i,s,o,a){let c=[],l=0,d=0,h=!1,p=()=>{h&&!c.length&&!l&&e.complete()},_=A=>l<r?E(A):c.push(A),E=A=>{s&&e.next(A),l++;let R=!1;Ht(t(A,d++)).subscribe(Pe(e,V=>{i?.(V),s?_(V):e.next(V)},()=>{R=!0},void 0,()=>{if(R)try{for(l--;c.length&&l<r;){let V=c.shift();o?kn(e,o,()=>E(V)):E(V)}p()}catch(V){e.error(V)}}))};return n.subscribe(Pe(e,_,()=>{h=!0,p()})),()=>{a?.()}}function Rt(n,e,t=1/0){return me(e)?Rt((r,i)=>Me((s,o)=>e(r,s,i,o))(Ht(n(r,i))),t):(typeof e=="number"&&(t=e),ke((r,i)=>UR(r,i,n,t)))}function ic(n=1/0){return Rt(Wn,n)}function BR(){return ic(1)}function sc(...n){return BR()(Ct(n,hs(n)))}function up(n){return new He(e=>{Ht(n()).subscribe(e)})}function ar(n,e){return ke((t,r)=>{let i=0;t.subscribe(Pe(r,s=>n.call(e,s,i++)&&r.next(s)))})}function fs(n){return ke((e,t)=>{let r=null,i=!1,s;r=e.subscribe(Pe(t,void 0,void 0,o=>{s=Ht(n(o,fs(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function jR(n,e,t,r,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Pe(o,d=>{let h=l++;c=a?n(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function To(n,e){return me(e)?Rt(n,e,1):Rt(n,1)}function ps(n){return ke((e,t)=>{let r=!1;e.subscribe(Pe(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Vi(n){return n<=0?()=>Kn:ke((e,t)=>{let r=0;e.subscribe(Pe(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Ov(n){return Me(()=>n)}function dp(n=R$){return ke((e,t)=>{let r=!1;e.subscribe(Pe(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function R$(){return new Li}function Ou(n){return ke((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Yr(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ar((i,s)=>n(i,s,r)):Wn,Vi(1),t?ps(e):dp(()=>new Li))}function oc(n){return n<=0?()=>Kn:ke((e,t)=>{let r=[];e.subscribe(Pe(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Fv(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ar((i,s)=>n(i,s,r)):Wn,oc(1),t?ps(e):dp(()=>new Li))}function Lv(n,e){return ke(jR(n,e,arguments.length>=2,!0))}function Vv(...n){let e=hs(n);return ke((t,r)=>{(e?sc(n,t,e):sc(n,t)).subscribe(r)})}function cr(n,e){return ke((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(Pe(r,c=>{i?.unsubscribe();let l=0,d=s++;Ht(n(c,d)).subscribe(i=Pe(r,h=>r.next(e?e(c,h,d,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Uv(n){return ke((e,t)=>{Ht(n).subscribe(Pe(t,()=>t.complete(),Pu)),!t.closed&&e.subscribe(t)})}function Xt(n,e,t){let r=me(n)||e||t?{next:n,error:e,complete:t}:n;return r?ke((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Pe(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Wn}var CN="https://g.co/ng/security#xss",se=class extends Error{constructor(e,t){super(Fw(e,t)),this.code=e}};function Fw(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function Wu(n){return{toString:n}.toString()}var hp="__parameters__";function N$(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function TN(n,e,t){return Wu(()=>{let r=N$(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let h=c.hasOwnProperty(hp)?c[hp]:Object.defineProperty(c,hp,{value:[]})[hp];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var wn=globalThis;function Je(n){for(let e in n)if(n[e]===Je)return e;throw Error("Could not find renamed property on target object.")}function k$(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Mn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Mn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function $R(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var P$=Je({__forward_ref__:Je});function Ku(n){return n.__forward_ref__=Ku,n.toString=function(){return Mn(this())},n}function vn(n){return SN(n)?n():n}function SN(n){return typeof n=="function"&&n.hasOwnProperty(P$)&&n.__forward_ref__===Ku}function ae(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Fn(n){return{providers:n.providers||[],imports:n.imports||[]}}function zp(n){return HR(n,AN)||HR(n,xN)}function DN(n){return zp(n)!==null}function HR(n,e){return n.hasOwnProperty(e)?n[e]:null}function M$(n){let e=n&&(n[AN]||n[xN]);return e||null}function qR(n){return n&&(n.hasOwnProperty(zR)||n.hasOwnProperty(O$))?n[zR]:null}var AN=Je({\u0275prov:Je}),zR=Je({\u0275inj:Je}),xN=Je({ngInjectableDef:Je}),O$=Je({ngInjectorDef:Je}),pe=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ae({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function RN(n){return n&&!!n.\u0275providers}var F$=Je({\u0275cmp:Je}),L$=Je({\u0275dir:Je}),V$=Je({\u0275pipe:Je}),U$=Je({\u0275mod:Je}),Ep=Je({\u0275fac:Je}),Fu=Je({__NG_ELEMENT_ID__:Je}),GR=Je({__NG_ENV_ID__:Je});function qt(n){return typeof n=="string"?n:n==null?"":String(n)}function B$(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():qt(n)}function j$(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new se(-200,n)}function Lw(n,e){throw new se(-201,!1)}var Ce=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Ce||{}),Jv;function NN(){return Jv}function Pn(n){let e=Jv;return Jv=n,e}function kN(n,e,t){let r=zp(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&Ce.Optional)return null;if(e!==void 0)return e;Lw(n,"Injector")}var $$={},Vu=$$,Xv="__NG_DI_FLAG__",Ip="ngTempTokenPath",H$="ngTokenPath",q$=/\n/gm,z$="\u0275",WR="__source",dc;function G$(){return dc}function ms(n){let e=dc;return dc=n,e}function W$(n,e=Ce.Default){if(dc===void 0)throw new se(-203,!1);return dc===null?kN(n,void 0,e):dc.get(n,e&Ce.Optional?null:void 0,e)}function ce(n,e=Ce.Default){return(NN()||W$)(vn(n),e)}function X(n,e=Ce.Default){return ce(n,Gp(e))}function Gp(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Zv(n){let e=[];for(let t=0;t<n.length;t++){let r=vn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new se(900,!1);let i,s=Ce.Default;for(let o=0;o<r.length;o++){let a=r[o],c=K$(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(ce(i,s))}else e.push(ce(r))}return e}function PN(n,e){return n[Xv]=e,n.prototype[Xv]=e,n}function K$(n){return n[Xv]}function Q$(n,e,t,r){let i=n[Ip];throw e[WR]&&i.unshift(e[WR]),n.message=Y$(`
`+n.message,i,t,r),n[H$]=i,n[Ip]=null,n}function Y$(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==z$?n.slice(2):n;let i=Mn(e);if(Array.isArray(e))i=e.map(Mn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Mn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(q$,`
  `)}`}var Wp=PN(TN("Optional"),8);var Vw=PN(TN("SkipSelf"),4);function Ao(n,e){let t=n.hasOwnProperty(Ep);return t?n[Ep]:null}function Uw(n,e){n.forEach(t=>Array.isArray(t)?Uw(t,e):e(t))}function MN(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function bp(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var fc={},Nr=[],pc=new pe(""),ON=new pe("",-1),FN=new pe(""),Cp=class{get(e,t=Vu){if(t===Vu){let r=new Error(`NullInjectorError: No provider for ${Mn(e)}!`);throw r.name="NullInjectorError",r}return t}},LN=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(LN||{}),Zr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Zr||{}),ur=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(ur||{});function J$(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function ew(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];X$(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function VN(n){return n===3||n===4||n===6}function X$(n){return n.charCodeAt(0)===64}function Uu(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?KR(n,t,i,null,e[++r]):KR(n,t,i,null,null))}}return n}function KR(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var UN="ng-template";function Z$(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&J$(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Bw(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Bw(n){return n.type===4&&n.value!==UN}function e3(n,e,t){let r=n.type===4&&!t?UN:n.value;return e===r}function t3(n,e,t){let r=4,i=n.attrs,s=i!==null?i3(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Rr(r)&&!Rr(c))return!1;if(o&&Rr(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!e3(n,c,t)||c===""&&e.length===1){if(Rr(r))return!1;o=!0}}else if(r&8){if(i===null||!Z$(n,i,c,t)){if(Rr(r))return!1;o=!0}}else{let l=e[++a],d=n3(c,i,Bw(n),t);if(d===-1){if(Rr(r))return!1;o=!0;continue}if(l!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(Rr(r))return!1;o=!0}}}}return Rr(r)||o}function Rr(n){return(n&1)===0}function n3(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return s3(e,n)}function r3(n,e,t=!1){for(let r=0;r<e.length;r++)if(t3(n,e[r],t))return!0;return!1}function i3(n){for(let e=0;e<n.length;e++){let t=n[e];if(VN(t))return e}return n.length}function s3(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function QR(n,e){return n?":not("+e.trim()+")":e}function o3(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Rr(o)&&(e+=QR(s,i),i=""),r=o,s=s||!Rr(r);t++}return i!==""&&(e+=QR(s,i)),e}function a3(n){return n.map(o3).join(",")}function c3(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!Rr(i))break;i=s}r++}return{attrs:e,classes:t}}function xe(n){return Wu(()=>{let e=zN(n),t=lt(z({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===LN.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Zr.Emulated,styles:n.styles||Nr,_:null,schemas:n.schemas||null,tView:null,id:""});GN(t);let r=n.dependencies;return t.directiveDefs=JR(r,!1),t.pipeDefs=JR(r,!0),t.id=d3(t),t})}function l3(n){return _s(n)||jN(n)}function u3(n){return n!==null}function Ln(n){return Wu(()=>({type:n.type,bootstrap:n.bootstrap||Nr,declarations:n.declarations||Nr,imports:n.imports||Nr,exports:n.exports||Nr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function YR(n,e){if(n==null)return fc;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=ur.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==ur.None?[r,a]:r,e[s]=o):t[s]=r}return t}function Qn(n){return Wu(()=>{let e=zN(n);return GN(e),e})}function BN(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function _s(n){return n[F$]||null}function jN(n){return n[L$]||null}function $N(n){return n[V$]||null}function HN(n){let e=_s(n)||jN(n)||$N(n);return e!==null?e.standalone:!1}function qN(n,e){let t=n[U$]||null;if(!t&&e===!0)throw new Error(`Type ${Mn(n)} does not have '\u0275mod' property.`);return t}function zN(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||fc,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||Nr,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:YR(n.inputs,e),outputs:YR(n.outputs),debugInfo:null}}function GN(n){n.features?.forEach(e=>e(n))}function JR(n,e){if(!n)return null;let t=e?$N:l3;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(u3)}function d3(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function h3(...n){return{\u0275providers:WN(!0,n),\u0275fromNgModule:!0}}function WN(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return Uw(e,o=>{let a=o;tw(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&KN(i,s),t}function KN(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];jw(i,s=>{e(s,r)})}}function tw(n,e,t,r){if(n=vn(n),!n)return!1;let i=null,s=qR(n),o=!s&&_s(n);if(!s&&!o){let c=n.ngModule;if(s=qR(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)tw(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Uw(s.imports,d=>{tw(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&KN(l,e)}if(!a){let l=Ao(i)||(()=>new i);e({provide:i,useFactory:l,deps:Nr},i),e({provide:FN,useValue:i,multi:!0},i),e({provide:pc,useValue:()=>ce(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;jw(c,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function jw(n,e){for(let t of n)RN(t)&&(t=t.\u0275providers),Array.isArray(t)?jw(t,e):e(t)}var f3=Je({provide:String,useValue:Je});function QN(n){return n!==null&&typeof n=="object"&&f3 in n}function p3(n){return!!(n&&n.useExisting)}function m3(n){return!!(n&&n.useFactory)}function mc(n){return typeof n=="function"}function g3(n){return!!n.useClass}var Kp=new pe(""),gp={},_3={},Bv;function $w(){return Bv===void 0&&(Bv=new Cp),Bv}var On=class{},Bu=class extends On{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,rw(e,o=>this.processProvider(o)),this.records.set(ON,ac(void 0,this)),i.has("environment")&&this.records.set(On,ac(void 0,this));let s=this.records.get(Kp);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(FN,Nr,Ce.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Le(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Le(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=ms(this),r=Pn(void 0),i;try{return e()}finally{ms(t),Pn(r)}}get(e,t=Vu,r=Ce.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(GR))return e[GR](this);r=Gp(r);let i,s=ms(this),o=Pn(void 0);try{if(!(r&Ce.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=I3(e)&&zp(e);l&&this.injectableDefInScope(l)?c=ac(nw(e),gp):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&Ce.Self?$w():this.parent;return t=r&Ce.Optional&&t===Vu?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Ip]=a[Ip]||[]).unshift(Mn(e)),s)throw a;return Q$(a,e,"R3InjectorError",this.source)}else throw a}finally{Pn(o),ms(s)}}resolveInjectorInitializers(){let e=Le(null),t=ms(this),r=Pn(void 0),i;try{let s=this.get(pc,Nr,Ce.Self);for(let o of s)o()}finally{ms(t),Pn(r),Le(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Mn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new se(205,!1)}processProvider(e){e=vn(e);let t=mc(e)?e:vn(e&&e.provide),r=v3(e);if(!mc(e)&&e.multi===!0){let i=this.records.get(t);i||(i=ac(void 0,gp,!0),i.factory=()=>Zv(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Le(null);try{return t.value===gp&&(t.value=_3,t.value=t.factory()),typeof t.value=="object"&&t.value&&E3(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Le(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=vn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function nw(n){let e=zp(n),t=e!==null?e.factory:Ao(n);if(t!==null)return t;if(n instanceof pe)throw new se(204,!1);if(n instanceof Function)return y3(n);throw new se(204,!1)}function y3(n){if(n.length>0)throw new se(204,!1);let t=M$(n);return t!==null?()=>t.factory(n):()=>new n}function v3(n){if(QN(n))return ac(void 0,n.useValue);{let e=YN(n);return ac(e,gp)}}function YN(n,e,t){let r;if(mc(n)){let i=vn(n);return Ao(i)||nw(i)}else if(QN(n))r=()=>vn(n.useValue);else if(m3(n))r=()=>n.useFactory(...Zv(n.deps||[]));else if(p3(n))r=()=>ce(vn(n.useExisting));else{let i=vn(n&&(n.useClass||n.provide));if(w3(n))r=()=>new i(...Zv(n.deps));else return Ao(i)||nw(i)}return r}function ac(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function w3(n){return!!n.deps}function E3(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function I3(n){return typeof n=="function"||typeof n=="object"&&n instanceof pe}function rw(n,e){for(let t of n)Array.isArray(t)?rw(t,e):t&&RN(t)?rw(t.\u0275providers,e):e(t)}function Ui(n,e){n instanceof Bu&&n.assertNotDestroyed();let t,r=ms(n),i=Pn(void 0);try{return e()}finally{ms(r),Pn(i)}}function JN(){return NN()!==void 0||G$()!=null}function b3(n){if(!JN())throw new se(-203,!1)}function C3(n){let e=wn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function T3(n){return typeof n=="function"}var Bi=0,Ae=1,fe=2,ln=3,kr=4,Or=5,Tp=6,ju=7,Pr=8,gc=9,Mr=10,Zt=11,$u=12,XR=13,wc=14,ei=15,Qp=16,cc=17,_c=18,Yp=19,XN=20,gs=21,jv=22,xo=23,ti=25,ZN=1;var Ro=7,Sp=8,Dp=9,lr=10,Hw=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Hw||{});function So(n){return Array.isArray(n)&&typeof n[ZN]=="object"}function ji(n){return Array.isArray(n)&&n[ZN]===!0}function ek(n){return(n.flags&4)!==0}function Jp(n){return n.componentOffset>-1}function qw(n){return(n.flags&1)===1}function ys(n){return!!n.template}function S3(n){return(n[fe]&512)!==0}var iw=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function tk(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function Ec(){return nk}function nk(n){return n.type.prototype.ngOnChanges&&(n.setInput=A3),D3}Ec.ngInherit=!0;function D3(){let n=ik(this),e=n?.current;if(e){let t=n.previous;if(t===fc)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function A3(n,e,t,r,i){let s=this.declaredInputs[r],o=ik(n)||x3(n,{previous:fc,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new iw(l&&l.currentValue,t,c===fc),tk(n,e,i,t)}var rk="__ngSimpleChanges__";function ik(n){return n[rk]||null}function x3(n,e){return n[rk]=e}var ZR=null;var Jr=function(n,e,t){ZR?.(n,e,t)},R3="svg",N3="math",k3=!1;function P3(){return k3}function ni(n){for(;Array.isArray(n);)n=n[Bi];return n}function M3(n,e){return ni(e[n])}function dr(n,e){return ni(e[n.index])}function sk(n,e){return n.data[e]}function O3(n,e){return n[e]}function Es(n,e){let t=e[n];return So(t)?t:t[Bi]}function zw(n){return(n[fe]&128)===128}function F3(n){return ji(n[ln])}function Ap(n,e){return e==null?null:n[e]}function ok(n){n[cc]=0}function L3(n){n[fe]&1024||(n[fe]|=1024,zw(n)&&Hu(n))}function V3(n,e){for(;n>0;)e=e[wc],n--;return e}function Gw(n){return!!(n[fe]&9216||n[xo]?.dirty)}function sw(n){n[Mr].changeDetectionScheduler?.notify(1),Gw(n)?Hu(n):n[fe]&64&&(P3()?(n[fe]|=1024,Hu(n)):n[Mr].changeDetectionScheduler?.notify())}function Hu(n){n[Mr].changeDetectionScheduler?.notify();let e=qu(n);for(;e!==null&&!(e[fe]&8192||(e[fe]|=8192,!zw(e)));)e=qu(e)}function ak(n,e){if((n[fe]&256)===256)throw new se(911,!1);n[gs]===null&&(n[gs]=[]),n[gs].push(e)}function U3(n,e){if(n[gs]===null)return;let t=n[gs].indexOf(e);t!==-1&&n[gs].splice(t,1)}function qu(n){let e=n[ln];return ji(e)?e[ln]:e}var Se={lFrame:pk(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function B3(){return Se.lFrame.elementDepthCount}function j3(){Se.lFrame.elementDepthCount++}function $3(){Se.lFrame.elementDepthCount--}function ck(){return Se.bindingsEnabled}function H3(){return Se.skipHydrationRootTNode!==null}function q3(n){return Se.skipHydrationRootTNode===n}function z3(){Se.skipHydrationRootTNode=null}function Ge(){return Se.lFrame.lView}function hr(){return Se.lFrame.tView}function Ue(n){return Se.lFrame.contextLView=n,n[Pr]}function Be(n){return Se.lFrame.contextLView=null,n}function Yn(){let n=lk();for(;n!==null&&n.type===64;)n=n.parent;return n}function lk(){return Se.lFrame.currentTNode}function G3(){let n=Se.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Qu(n,e){let t=Se.lFrame;t.currentTNode=n,t.isParent=e}function uk(){return Se.lFrame.isParent}function W3(){Se.lFrame.isParent=!1}function K3(){let n=Se.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Xp(){return Se.lFrame.bindingIndex}function Q3(n){return Se.lFrame.bindingIndex=n}function Ww(){return Se.lFrame.bindingIndex++}function Zp(n){let e=Se.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Y3(){return Se.lFrame.inI18n}function J3(n,e){let t=Se.lFrame;t.bindingIndex=t.bindingRootIndex=n,ow(e)}function X3(){return Se.lFrame.currentDirectiveIndex}function ow(n){Se.lFrame.currentDirectiveIndex=n}function dk(n){Se.lFrame.currentQueryIndex=n}function Z3(n){let e=n[Ae];return e.type===2?e.declTNode:e.type===1?n[Or]:null}function hk(n,e,t){if(t&Ce.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&Ce.Host);)if(i=Z3(s),i===null||(s=s[wc],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=Se.lFrame=fk();return r.currentTNode=e,r.lView=n,!0}function Kw(n){let e=fk(),t=n[Ae];Se.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function fk(){let n=Se.lFrame,e=n===null?null:n.child;return e===null?pk(n):e}function pk(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function mk(){let n=Se.lFrame;return Se.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var gk=mk;function Qw(){let n=mk();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function e4(n){return(Se.lFrame.contextLView=V3(n,Se.lFrame.contextLView))[Pr]}function Oo(){return Se.lFrame.selectedIndex}function No(n){Se.lFrame.selectedIndex=n}function Yw(){let n=Se.lFrame;return sk(n.tView,n.selectedIndex)}function t4(){return Se.lFrame.currentNamespace}var _k=!0;function Jw(){return _k}function Xw(n){_k=n}function n4(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=nk(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function Zw(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function _p(n,e,t){yk(n,e,3,t)}function yp(n,e,t,r){(n[fe]&3)===t&&yk(n,e,t,r)}function $v(n,e){let t=n[fe];(t&3)===e&&(t&=16383,t+=1,n[fe]=t)}function yk(n,e,t,r){let i=r!==void 0?n[cc]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[cc]+=65536),(a<s||s==-1)&&(r4(n,t,e,c),n[cc]=(n[cc]&4294901760)+c+2),c++}function eN(n,e){Jr(4,n,e);let t=Le(null);try{e.call(n)}finally{Le(t),Jr(5,n,e)}}function r4(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[fe]>>14<n[cc]>>16&&(n[fe]&3)===e&&(n[fe]+=16384,eN(a,s)):eN(a,s)}var hc=-1,ko=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function i4(n){return n instanceof ko}function s4(n){return(n.flags&8)!==0}function o4(n){return(n.flags&16)!==0}function vk(n){return n!==hc}function xp(n){return n&32767}function a4(n){return n>>16}function Rp(n,e){let t=a4(n),r=e;for(;t>0;)r=r[wc],t--;return r}var aw=!0;function Np(n){let e=aw;return aw=n,e}var c4=256,wk=c4-1,Ek=5,l4=0,Xr={};function u4(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Fu)&&(r=t[Fu]),r==null&&(r=t[Fu]=l4++);let i=r&wk,s=1<<i;e.data[n+(i>>Ek)]|=s}function kp(n,e){let t=Ik(n,e);if(t!==-1)return t;let r=e[Ae];r.firstCreatePass&&(n.injectorIndex=e.length,Hv(r.data,n),Hv(e,null),Hv(r.blueprint,null));let i=eE(n,e),s=n.injectorIndex;if(vk(i)){let o=xp(i),a=Rp(i,e),c=a[Ae].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function Hv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Ik(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function eE(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=Dk(i),r===null)return hc;if(t++,i=i[wc],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return hc}function cw(n,e,t){u4(n,e,t)}function d4(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(VN(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function bk(n,e,t){if(t&Ce.Optional||n!==void 0)return n;Lw(e,"NodeInjector")}function Ck(n,e,t,r){if(t&Ce.Optional&&r===void 0&&(r=null),!(t&(Ce.Self|Ce.Host))){let i=n[gc],s=Pn(void 0);try{return i?i.get(e,r,t&Ce.Optional):kN(e,r,t&Ce.Optional)}finally{Pn(s)}}return bk(r,e,t)}function Tk(n,e,t,r=Ce.Default,i){if(n!==null){if(e[fe]&2048&&!(r&Ce.Self)){let o=g4(n,e,t,r,Xr);if(o!==Xr)return o}let s=Sk(n,e,t,r,Xr);if(s!==Xr)return s}return Ck(e,t,r,i)}function Sk(n,e,t,r,i){let s=p4(t);if(typeof s=="function"){if(!hk(e,n,r))return r&Ce.Host?bk(i,t,r):Ck(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&Ce.Optional))Lw(t);else return o}finally{gk()}}else if(typeof s=="number"){let o=null,a=Ik(n,e),c=hc,l=r&Ce.Host?e[ei][Or]:null;for((a===-1||r&Ce.SkipSelf)&&(c=a===-1?eE(n,e):e[a+8],c===hc||!nN(r,!1)?a=-1:(o=e[Ae],a=xp(c),e=Rp(c,e)));a!==-1;){let d=e[Ae];if(tN(s,a,d.data)){let h=h4(a,e,t,o,r,l);if(h!==Xr)return h}c=e[a+8],c!==hc&&nN(r,e[Ae].data[a+8]===l)&&tN(s,a,e)?(o=d,a=xp(c),e=Rp(c,e)):a=-1}}return i}function h4(n,e,t,r,i,s){let o=e[Ae],a=o.data[n+8],c=r==null?Jp(a)&&aw:r!=o&&(a.type&3)!==0,l=i&Ce.Host&&s===a,d=f4(a,o,t,c,l);return d!==null?yc(e,o,d,a):Xr}function f4(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,d=s>>20,h=r?a:a+d,p=i?a+d:l;for(let _=h;_<p;_++){let E=o[_];if(_<c&&t===E||_>=c&&E.type===t)return _}if(i){let _=o[c];if(_&&ys(_)&&_.type===t)return c}return null}function yc(n,e,t,r){let i=n[t],s=e.data;if(i4(i)){let o=i;o.resolving&&j$(B$(s[t]));let a=Np(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?Pn(o.injectImpl):null,d=hk(n,r,Ce.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&n4(t,s[t],e)}finally{l!==null&&Pn(l),Np(a),o.resolving=!1,gk()}}return i}function p4(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Fu)?n[Fu]:void 0;return typeof e=="number"?e>=0?e&wk:m4:e}function tN(n,e,t){let r=1<<n;return!!(t[e+(n>>Ek)]&r)}function nN(n,e){return!(n&Ce.Self)&&!(n&Ce.Host&&e)}var Do=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return Tk(this._tNode,this._lView,e,Gp(r),t)}};function m4(){return new Do(Yn(),Ge())}function Fo(n){return Wu(()=>{let e=n.prototype.constructor,t=e[Ep]||lw(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Ep]||lw(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function lw(n){return SN(n)?()=>{let e=lw(vn(n));return e&&e()}:Ao(n)}function g4(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[fe]&2048&&!(o[fe]&512);){let a=Sk(s,o,t,r|Ce.Self,Xr);if(a!==Xr)return a;let c=s.parent;if(!c){let l=o[XN];if(l){let d=l.get(t,Xr,r);if(d!==Xr)return d}c=Dk(o),o=o[wc]}s=c}return i}function Dk(n){let e=n[Ae],t=e.type;return t===2?e.declTNode:t===1?n[Or]:null}function tE(n){return d4(Yn(),n)}function rN(n,e=null,t=null,r){let i=Ak(n,e,t,r);return i.resolveInjectorInitializers(),i}function Ak(n,e=null,t=null,r,i=new Set){let s=[t||Nr,h3(n)];return r=r||(typeof n=="object"?void 0:Mn(n)),new Bu(s,e||$w(),r||null,i)}var Fr=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return rN({name:""},i,r,"");{let s=r.name??"";return rN({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Vu,e.NULL=new Cp,e.\u0275prov=ae({token:e,providedIn:"any",factory:()=>ce(ON)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var _4="ngOriginalError";function qv(n){return n[_4]}var ri=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&qv(e);for(;t&&qv(t);)t=qv(t);return t||null}},xk=new pe("",{providedIn:"root",factory:()=>X(ri).handleError.bind(void 0)}),nE=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=y4,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),uw=class extends nE{constructor(e){super(),this._lView=e}onDestroy(e){return ak(this._lView,e),()=>U3(this._lView,e)}};function y4(){return new uw(Ge())}function v4(){return em(Yn(),Ge())}function em(n,e){return new $i(dr(n,e))}var $i=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=v4;let n=e;return n})();var dw=class extends an{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,JN()&&(this.destroyRef=X(nE,{optional:!0})??void 0)}emit(e){let t=Le(null);try{super.next(e)}finally{Le(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=zv(s),i&&(i=zv(i)),o&&(o=zv(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Bt&&e.add(a),a}};function zv(n){return e=>{setTimeout(n,void 0,e)}}var cn=dw;function Rk(n){return(n.flags&128)===128}var Nk=new Map,w4=0;function E4(){return w4++}function I4(n){Nk.set(n[Yp],n)}function b4(n){Nk.delete(n[Yp])}var iN="__ngContext__";function Po(n,e){So(e)?(n[iN]=e[Yp],I4(e)):n[iN]=e}function kk(n){return Mk(n[$u])}function Pk(n){return Mk(n[kr])}function Mk(n){for(;n!==null&&!ji(n);)n=n[kr];return n}var hw;function Ok(n){hw=n}function C4(){if(hw!==void 0)return hw;if(typeof document<"u")return document;throw new se(210,!1)}var tm=new pe("",{providedIn:"root",factory:()=>T4}),T4="ng",rE=new pe(""),Is=new pe("",{providedIn:"platform",factory:()=>"unknown"});var iE=new pe("",{providedIn:"root",factory:()=>C4().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var S4="h",D4="b";var A4=()=>null;function sE(n,e,t=!1){return A4(n,e,t)}var Fk=!1,x4=new pe("",{providedIn:"root",factory:()=>Fk});var fp;function R4(){if(fp===void 0&&(fp=null,wn.trustedTypes))try{fp=wn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return fp}function sN(n){return R4()?.createScriptURL(n)||n}var Pp=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${CN})`}};function nm(n){return n instanceof Pp?n.changingThisBreaksApplicationSecurity:n}function oE(n,e){let t=N4(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${CN})`)}return t===e}function N4(n){return n instanceof Pp&&n.getTypeName()||null}var k4=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Lk(n){return n=String(n),n.match(k4)?n:"unsafe:"+n}var rm=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(rm||{});function Hi(n){let e=Uk();return e?e.sanitize(rm.URL,n)||"":oE(n,"URL")?nm(n):Lk(qt(n))}function P4(n){let e=Uk();if(e)return sN(e.sanitize(rm.RESOURCE_URL,n)||"");if(oE(n,"ResourceURL"))return sN(nm(n));throw new se(904,!1)}function M4(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?P4:Hi}function Vk(n,e,t){return M4(e,t)(n)}function Uk(){let n=Ge();return n&&n[Mr].sanitizer}function Bk(n){return n instanceof Function?n():n}function O4(n){return(n??X(Fr)).get(Is)==="browser"}var Lo=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Lo||{}),F4;function aE(n,e){return F4(n,e)}function lc(n,e,t,r,i){if(r!=null){let s,o=!1;ji(r)?s=r:So(r)&&(o=!0,r=r[Bi]);let a=ni(r);n===0&&t!==null?i==null?zk(e,t,a):Mp(e,t,a,i||null,!0):n===1&&t!==null?Mp(e,t,a,i||null,!0):n===2?Z4(e,a,o):n===3&&e.destroyNode(a),s!=null&&tH(e,n,s,t,i)}}function L4(n,e){return n.createText(e)}function V4(n,e,t){n.setValue(e,t)}function jk(n,e,t){return n.createElement(e,t)}function U4(n,e){$k(n,e),e[Bi]=null,e[Or]=null}function B4(n,e,t,r,i,s){r[Bi]=i,r[Or]=e,im(n,r,t,1,i,s)}function $k(n,e){e[Mr].changeDetectionScheduler?.notify(1),im(n,e,e[Zt],2,null,null)}function j4(n){let e=n[$u];if(!e)return Gv(n[Ae],n);for(;e;){let t=null;if(So(e))t=e[$u];else{let r=e[lr];r&&(t=r)}if(!t){for(;e&&!e[kr]&&e!==n;)So(e)&&Gv(e[Ae],e),e=e[ln];e===null&&(e=n),So(e)&&Gv(e[Ae],e),t=e&&e[kr]}e=t}}function $4(n,e,t,r){let i=lr+r,s=t.length;r>0&&(t[i-1][kr]=e),r<s-lr?(e[kr]=t[i],MN(t,lr+r,e)):(t.push(e),e[kr]=null),e[ln]=t;let o=e[Qp];o!==null&&t!==o&&H4(o,e);let a=e[_c];a!==null&&a.insertView(n),sw(e),e[fe]|=128}function H4(n,e){let t=n[Dp],i=e[ln][ln][ei];e[ei]!==i&&(n[fe]|=Hw.HasTransplantedViews),t===null?n[Dp]=[e]:t.push(e)}function Hk(n,e){let t=n[Dp],r=t.indexOf(e);t.splice(r,1)}function fw(n,e){if(n.length<=lr)return;let t=lr+e,r=n[t];if(r){let i=r[Qp];i!==null&&i!==n&&Hk(i,r),e>0&&(n[t-1][kr]=r[kr]);let s=bp(n,lr+e);U4(r[Ae],r);let o=s[_c];o!==null&&o.detachView(s[Ae]),r[ln]=null,r[kr]=null,r[fe]&=-129}return r}function qk(n,e){if(!(e[fe]&256)){let t=e[Zt];t.destroyNode&&im(n,e,t,3,null,null),j4(e)}}function Gv(n,e){if(e[fe]&256)return;let t=Le(null);try{e[fe]&=-129,e[fe]|=256,e[xo]&&hR(e[xo]),z4(n,e),q4(n,e),e[Ae].type===1&&e[Zt].destroy();let r=e[Qp];if(r!==null&&ji(e[ln])){r!==e[ln]&&Hk(r,e);let i=e[_c];i!==null&&i.detachView(n)}b4(e)}finally{Le(t)}}function q4(n,e){let t=n.cleanup,r=e[ju];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[ju]=null);let i=e[gs];if(i!==null){e[gs]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function z4(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof ko)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Jr(4,a,c);try{c.call(a)}finally{Jr(5,a,c)}}else{Jr(4,i,s);try{s.call(i)}finally{Jr(5,i,s)}}}}}function G4(n,e,t){return W4(n,e.parent,t)}function W4(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[Bi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===Zr.None||s===Zr.Emulated)return null}return dr(r,t)}}function Mp(n,e,t,r,i){n.insertBefore(e,t,r,i)}function zk(n,e,t){n.appendChild(e,t)}function oN(n,e,t,r,i){r!==null?Mp(n,e,t,r,i):zk(n,e,t)}function K4(n,e,t,r){n.removeChild(e,t,r)}function cE(n,e){return n.parentNode(e)}function Q4(n,e){return n.nextSibling(e)}function Y4(n,e,t){return X4(n,e,t)}function J4(n,e,t){return n.type&40?dr(n,t):null}var X4=J4,aN;function lE(n,e,t,r){let i=G4(n,r,e),s=e[Zt],o=r.parent||e[Or],a=Y4(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)oN(s,i,t[c],a,!1);else oN(s,i,t,a,!1);aN!==void 0&&aN(s,r,e,t,i)}function vp(n,e){if(e!==null){let t=e.type;if(t&3)return dr(e,n);if(t&4)return pw(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return vp(n,r);{let i=n[e.index];return ji(i)?pw(-1,i):ni(i)}}else{if(t&32)return aE(e,n)()||ni(n[e.index]);{let r=Gk(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=qu(n[ei]);return vp(i,r)}else return vp(n,e.next)}}}return null}function Gk(n,e){if(e!==null){let r=n[ei][Or],i=e.projection;return r.projection[i]}return null}function pw(n,e){let t=lr+n+1;if(t<e.length){let r=e[t],i=r[Ae].firstChild;if(i!==null)return vp(r,i)}return e[Ro]}function Z4(n,e,t){let r=cE(n,e);r&&K4(n,r,e,t)}function uE(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&e===0&&(a&&Po(ni(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)uE(n,e,t.child,r,i,s,!1),lc(e,n,i,a,s);else if(c&32){let l=aE(t,r),d;for(;d=l();)lc(e,n,i,d,s);lc(e,n,i,a,s)}else c&16?eH(n,e,r,t,i,s):lc(e,n,i,a,s);t=o?t.projectionNext:t.next}}function im(n,e,t,r,i,s){uE(t,r,n.firstChild,e,i,s,!1)}function eH(n,e,t,r,i,s){let o=t[ei],c=o[Or].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];lc(e,n,i,d,s)}else{let l=c,d=o[ln];Rk(r)&&(l.flags|=128),uE(n,e,l,d,i,s,!0)}}function tH(n,e,t,r,i){let s=t[Ro],o=ni(t);s!==o&&lc(e,n,r,s,i);for(let a=lr;a<t.length;a++){let c=t[a];im(c[Ae],c,n,e,r,s)}}function nH(n,e,t){n.setAttribute(e,"style",t)}function Wk(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Kk(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&ew(n,e,r),i!==null&&Wk(n,e,i),s!==null&&nH(n,e,s)}var Vn={};function j(n=1){Qk(hr(),Ge(),Oo()+n,!1)}function Qk(n,e,t,r){if(!r)if((e[fe]&3)===3){let s=n.preOrderCheckHooks;s!==null&&_p(e,s,t)}else{let s=n.preOrderHooks;s!==null&&yp(e,s,0,t)}No(t)}function ne(n,e=Ce.Default){let t=Ge();if(t===null)return ce(n,e);let r=Yn();return Tk(r,t,vn(n),e)}function Yk(){let n="invalid";throw new Error(n)}function Jk(n,e,t,r,i,s){let o=Le(null);try{let a=null;i&ur.SignalBased&&(a=e[r][cR]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&ur.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):tk(e,a,r,s)}finally{Le(o)}}function rH(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)No(~i);else{let s=i,o=t[++r],a=t[++r];J3(o,s);let c=e[s];a(2,c)}}}finally{No(-1)}}function sm(n,e,t,r,i,s,o,a,c,l,d){let h=e.blueprint.slice();return h[Bi]=i,h[fe]=r|4|128|8|64,(l!==null||n&&n[fe]&2048)&&(h[fe]|=2048),ok(h),h[ln]=h[wc]=n,h[Pr]=t,h[Mr]=o||n&&n[Mr],h[Zt]=a||n&&n[Zt],h[gc]=c||n&&n[gc]||null,h[Or]=s,h[Yp]=E4(),h[Tp]=d,h[XN]=l,h[ei]=e.type==2?n[ei]:h,h}function om(n,e,t,r,i){let s=n.data[e];if(s===null)s=iH(n,e,t,r,i),Y3()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=G3();s.injectorIndex=o===null?-1:o.injectorIndex}return Qu(s,!0),s}function iH(n,e,t,r,i){let s=lk(),o=uk(),a=o?s:s&&s.parent,c=n.data[e]=lH(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function Xk(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function Zk(n,e,t,r,i){let s=Oo(),o=r&2;try{No(-1),o&&e.length>ti&&Qk(n,e,ti,!1),Jr(o?2:0,i),t(r,i)}finally{No(s),Jr(o?3:1,i)}}function eP(n,e,t){if(ek(e)){let r=Le(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Le(r)}}}function tP(n,e,t){ck()&&(mH(n,e,t,dr(t,e)),(t.flags&64)===64&&aP(n,e,t))}function nP(n,e,t=dr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function rP(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=dE(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function dE(n,e,t,r,i,s,o,a,c,l,d){let h=ti+r,p=h+i,_=sH(h,p),E=typeof l=="function"?l():l;return _[Ae]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:E,incompleteFirstPass:!1,ssrId:d}}function sH(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Vn);return t}function oH(n,e,t,r){let s=r.get(x4,Fk)||t===Zr.ShadowDom,o=n.selectRootElement(e,s);return aH(o),o}function aH(n){cH(n)}var cH=()=>null;function lH(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return H3()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function cN(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=ur.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?lN(r,t,l,a,c):lN(r,t,l,a)}return r}function lN(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function uH(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,l=null;for(let d=r;d<i;d++){let h=s[d],p=t?t.get(h):null,_=p?p.inputs:null,E=p?p.outputs:null;c=cN(0,h.inputs,d,c,_),l=cN(1,h.outputs,d,l,E);let A=c!==null&&o!==null&&!Bw(e)?SH(c,d,o):null;a.push(A)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function dH(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function iP(n,e,t,r,i,s,o,a){let c=dr(e,t),l=e.inputs,d;!a&&l!=null&&(d=l[r])?(hE(n,t,d,r,i),Jp(e)&&hH(t,e.index)):e.type&3?(r=dH(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function hH(n,e){let t=Es(e,n);t[fe]&16||(t[fe]|=64)}function sP(n,e,t,r){if(ck()){let i=r===null?null:{"":-1},s=_H(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&oP(n,e,t,o,i,a),i&&yH(t,r,i)}t.mergedAttrs=Uu(t.mergedAttrs,t.attrs)}function oP(n,e,t,r,i,s){for(let l=0;l<r.length;l++)cw(kp(t,e),n,r[l].type);wH(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=Xk(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=Uu(t.mergedAttrs,d.hostAttrs),EH(n,t,e,c,d),vH(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}uH(n,t,s)}function fH(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;pH(o)!=a&&o.push(a),o.push(t,r,s)}}function pH(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function mH(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;Jp(t)&&IH(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||kp(t,e),Po(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],l=yc(e,n,a,t);if(Po(l,e),o!==null&&TH(e,a-i,l,c,t,o),ys(c)){let d=Es(t.index,e);d[Pr]=yc(e,n,a,t)}}}function aP(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=X3();try{No(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];ow(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&gH(c,l)}}finally{No(-1),ow(o)}}function gH(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function _H(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(r3(e,o.selectors,!1))if(r||(r=[]),ys(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;mw(n,e,c)}else r.unshift(o),mw(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function mw(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function yH(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new se(-301,!1);r.push(e[i],s)}}}function vH(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;ys(e)&&(t[""]=n)}}function wH(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function EH(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Ao(i.type,!0)),o=new ko(s,ys(i),ne);n.blueprint[r]=o,t[r]=o,fH(n,e,r,Xk(n,t,i.hostVars,Vn),i)}function IH(n,e,t){let r=dr(e,n),i=rP(t),s=n[Mr].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=am(n,sm(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function bH(n,e,t,r,i,s){let o=dr(n,e);CH(e[Zt],o,s,n.value,t,r,i)}function CH(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?qt(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function TH(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],d=o[a++],h=o[a++];Jk(r,t,c,l,d,h)}}function SH(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function cP(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function lP(n,e){let t=n.contentQueries;if(t!==null){let r=Le(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];dk(s),a.contentQueries(2,e[o],o)}}}finally{Le(r)}}}function am(n,e){return n[$u]?n[XR][kr]=e:n[$u]=e,n[XR]=e,e}function gw(n,e,t){dk(0);let r=Le(null);try{e(n,t)}finally{Le(r)}}function DH(n){return n[ju]||(n[ju]=[])}function AH(n){return n.cleanup||(n.cleanup=[])}function uP(n,e){let t=n[gc],r=t?t.get(ri,null):null;r&&r.handleError(e)}function hE(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],d=n.data[o];Jk(d,l,r,a,c,i)}}function Yu(n,e,t){let r=M3(e,n);V4(n[Zt],r,t)}function xH(n,e){let t=Es(e,n),r=t[Ae];RH(r,t);let i=t[Bi];i!==null&&t[Tp]===null&&(t[Tp]=sE(i,t[gc])),fE(r,t,t[Pr])}function RH(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function fE(n,e,t){Kw(e);try{let r=n.viewQuery;r!==null&&gw(1,r,t);let i=n.template;i!==null&&Zk(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[_c]?.finishViewCreation(n),n.staticContentQueries&&lP(n,e),n.staticViewQueries&&gw(2,n.viewQuery,t);let s=n.components;s!==null&&NH(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[fe]&=-5,Qw()}}function NH(n,e){for(let t=0;t<e.length;t++)xH(n,e[t])}function kH(n,e,t,r){let i=Le(null);try{let s=e.tView,a=n[fe]&4096?4096:16,c=sm(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[Qp]=l;let d=n[_c];return d!==null&&(c[_c]=d.createEmbeddedView(s)),fE(s,c,t),c}finally{Le(i)}}function uN(n,e){return!e||e.firstChild===null||Rk(n)}function PH(n,e,t,r=!0){let i=e[Ae];if($4(i,e,n,t),r){let o=pw(t,n),a=e[Zt],c=cE(a,n[Ro]);c!==null&&B4(i,n[Or],a,e,c,o)}let s=e[Tp];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Op(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(ni(s)),ji(s)&&MH(s,r);let o=t.type;if(o&8)Op(n,e,t.child,r);else if(o&32){let a=aE(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=Gk(e,t);if(Array.isArray(a))r.push(...a);else{let c=qu(e[ei]);Op(c[Ae],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function MH(n,e){for(let t=lr;t<n.length;t++){let r=n[t],i=r[Ae].firstChild;i!==null&&Op(r[Ae],r,i,e)}n[Ro]!==n[Bi]&&e.push(n[Ro])}var dP=[];function OH(n){return n[xo]??FH(n)}function FH(n){let e=dP.pop()??Object.create(VH);return e.lView=n,e}function LH(n){n.lView[xo]!==n&&(n.lView=null,dP.push(n))}var VH=lt(z({},lR),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Hu(n.lView)},consumerOnSignalRead(){this.lView[xo]=this}}),hP=100;function fP(n,e=!0,t=0){let r=n[Mr],i=r.rendererFactory,s=!1;s||i.begin?.();try{UH(n,t)}catch(o){throw e&&uP(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function UH(n,e){_w(n,e);let t=0;for(;Gw(n);){if(t===hP)throw new se(103,!1);t++,_w(n,1)}}function BH(n,e,t,r){let i=e[fe];if((i&256)===256)return;let s=!1;!s&&e[Mr].inlineEffectRunner?.flush(),Kw(e);let o=null,a=null;!s&&jH(n)&&(a=OH(e),o=uR(a));try{ok(e),Q3(n.bindingStartIndex),t!==null&&Zk(n,e,t,2,r);let c=(i&3)===3;if(!s)if(c){let h=n.preOrderCheckHooks;h!==null&&_p(e,h,null)}else{let h=n.preOrderHooks;h!==null&&yp(e,h,0,null),$v(e,0)}if($H(e),pP(e,0),n.contentQueries!==null&&lP(n,e),!s)if(c){let h=n.contentCheckHooks;h!==null&&_p(e,h)}else{let h=n.contentHooks;h!==null&&yp(e,h,1),$v(e,1)}rH(n,e);let l=n.components;l!==null&&gP(e,l,0);let d=n.viewQuery;if(d!==null&&gw(2,d,r),!s)if(c){let h=n.viewCheckHooks;h!==null&&_p(e,h)}else{let h=n.viewHooks;h!==null&&yp(e,h,2),$v(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[jv]){for(let h of e[jv])h();e[jv]=null}s||(e[fe]&=-73)}catch(c){throw Hu(e),c}finally{a!==null&&(dR(a,o),LH(a)),Qw()}}function jH(n){return n.type!==2}function pP(n,e){for(let t=kk(n);t!==null;t=Pk(t))for(let r=lr;r<t.length;r++){let i=t[r];mP(i,e)}}function $H(n){for(let e=kk(n);e!==null;e=Pk(e)){if(!(e[fe]&Hw.HasTransplantedViews))continue;let t=e[Dp];for(let r=0;r<t.length;r++){let i=t[r],s=i[ln];L3(i)}}}function HH(n,e,t){let r=Es(e,n);mP(r,t)}function mP(n,e){zw(n)&&_w(n,e)}function _w(n,e){let r=n[Ae],i=n[fe],s=n[xo],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Iv(s)),s&&(s.dirty=!1),n[fe]&=-9217,o)BH(r,n,r.template,n[Pr]);else if(i&8192){pP(n,1);let a=r.components;a!==null&&gP(n,a,1)}}function gP(n,e,t){for(let r=0;r<e.length;r++)HH(n,e[r],t)}function pE(n){for(n[Mr].changeDetectionScheduler?.notify();n;){n[fe]|=64;let e=qu(n);if(S3(n)&&!e)return n;n=e}return null}var Mo=class{get rootNodes(){let e=this._lView,t=e[Ae];return Op(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Pr]}set context(e){this._lView[Pr]=e}get destroyed(){return(this._lView[fe]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[ln];if(ji(e)){let t=e[Sp],r=t?t.indexOf(this):-1;r>-1&&(fw(e,r),bp(t,r))}this._attachedToViewContainer=!1}qk(this._lView[Ae],this._lView)}onDestroy(e){ak(this._lView,e)}markForCheck(){pE(this._cdRefInjectingView||this._lView)}detach(){this._lView[fe]&=-129}reattach(){sw(this._lView),this._lView[fe]|=128}detectChanges(){this._lView[fe]|=1024,fP(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new se(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,$k(this._lView[Ae],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new se(902,!1);this._appRef=e,sw(this._lView)}},cm=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=GH;let n=e;return n})(),qH=cm,zH=class extends qH{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=kH(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new Mo(i)}};function GH(){return WH(Yn(),Ge())}function WH(n,e){return n.type&4?new zH(e,n,em(n,e)):null}var Foe=new RegExp(`^(\\d+)*(${D4}|${S4})*(.*)`);var KH=()=>null;function dN(n,e){return KH(n,e)}var Fp=class{},yw=class{},Lp=class{};function QH(n){let e=Error(`No component factory found for ${Mn(n)}.`);return e[YH]=n,e}var YH="ngComponent";var vw=class{resolveComponentFactory(e){throw QH(e)}},lm=(()=>{let e=class e{};e.NULL=new vw;let n=e;return n})(),zu=class{},bs=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>JH();let n=e;return n})();function JH(){let n=Ge(),e=Yn(),t=Es(e.index,n);return(So(t)?t:n)[Zt]}var XH=(()=>{let e=class e{};e.\u0275prov=ae({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),Wv={};var hN=new Set;function mE(n){hN.has(n)||(hN.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function fN(...n){}function ZH(){let n=typeof wn.requestAnimationFrame=="function",e=wn[n?"requestAnimationFrame":"setTimeout"],t=wn[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var tt=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new cn(!1),this.onMicrotaskEmpty=new cn(!1),this.onStable=new cn(!1),this.onError=new cn(!1),typeof Zone>"u")throw new se(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=ZH().nativeRequestAnimationFrame,nq(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new se(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new se(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,eq,fN,fN);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},eq={};function gE(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function tq(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(wn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,ww(n),n.isCheckStableRunning=!0,gE(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),ww(n))}function nq(n){let e=()=>{tq(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(rq(a))return t.invokeTask(i,s,o,a);try{return pN(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),mN(n)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return pN(n),t.invoke(i,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),mN(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,ww(n),gE(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function ww(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function pN(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function mN(n){n._nesting--,gE(n)}var Ew=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new cn,this.onMicrotaskEmpty=new cn,this.onStable=new cn,this.onError=new cn}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function rq(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}function iq(n="zone.js",e){return n==="noop"?new Ew:n==="zone.js"?new tt(e):n}var uc=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(uc||{}),sq={destroy(){}};function um(n,e){!e&&b3(um);let t=e?.injector??X(Fr);if(!O4(t))return sq;mE("NgAfterNextRender");let r=t.get(_E),i=r.handler??=new bw,s=e?.phase??uc.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(nE).onDestroy(o),c=Ui(t,()=>new Iw(s,()=>{o(),n()}));return i.register(c),{destroy:o}}var Iw=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=X(tt),this.errorHandler=X(ri,{optional:!0}),X(Fp,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},bw=class{constructor(){this.executingCallbacks=!1,this.buckets={[uc.EarlyRead]:new Set,[uc.Write]:new Set,[uc.MixedReadWrite]:new Set,[uc.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},_E=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=ae({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function Cw(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=$R(i,a);else if(s==2){let c=a,l=e[++o];r=$R(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Vp=class extends lm{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=_s(e);return new vc(t,this.ngModule)}};function gN(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function oq(n){let e=n.toLowerCase();return e==="svg"?R3:e==="math"?N3:null}var Tw=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Gp(r);let i=this.injector.get(e,Wv,r);return i!==Wv||t===Wv?i:this.parentInjector.get(e,t,r)}},vc=class extends Lp{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=gN(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return gN(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=a3(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Le(null);try{i=i||this.ngModule;let o=i instanceof On?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Tw(e,o):e,c=a.get(zu,null);if(c===null)throw new se(407,!1);let l=a.get(XH,null),d=a.get(_E,null),h=a.get(Fp,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},_=c.createRenderer(null,this.componentDef),E=this.componentDef.selectors[0][0]||"div",A=r?oH(_,r,this.componentDef.encapsulation,a):jk(_,E,oq(E)),R=512;this.componentDef.signals?R|=4096:this.componentDef.onPush||(R|=16);let V=null;A!==null&&(V=sE(A,a,!0));let J=dE(0,null,null,1,0,null,null,null,null,null,null),H=sm(null,J,null,R,null,null,p,_,a,null,V);Kw(H);let ee,de;try{let re=this.componentDef,S,I=null;re.findHostDirectiveDefs?(S=[],I=new Map,re.findHostDirectiveDefs(re,S,I),S.push(re)):S=[re];let C=aq(H,A),D=cq(C,A,re,S,H,p,_);de=sk(J,ti),A&&dq(_,re,A,r),t!==void 0&&hq(de,this.ngContentSelectors,t),ee=uq(D,re,S,I,H,[fq]),fE(J,H,null)}finally{Qw()}return new Sw(this.componentType,ee,em(de,H),H,de)}finally{Le(s)}}},Sw=class extends yw{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Mo(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;hE(s[Ae],s,i,e,t),this.previousInputValues.set(e,t);let o=Es(this._tNode.index,s);pE(o)}}get injector(){return new Do(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function aq(n,e){let t=n[Ae],r=ti;return n[r]=e,om(t,r,2,"#host",null)}function cq(n,e,t,r,i,s,o){let a=i[Ae];lq(r,n,e,o);let c=null;e!==null&&(c=sE(e,i[gc]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=sm(i,rP(t),null,d,i[n.index],n,s,l,null,null,c);return a.firstCreatePass&&mw(a,n,r.length-1),am(i,h),i[n.index]=h}function lq(n,e,t,r){for(let i of n)e.mergedAttrs=Uu(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Cw(e,e.mergedAttrs,!0),t!==null&&Kk(r,t,e))}function uq(n,e,t,r,i,s){let o=Yn(),a=i[Ae],c=dr(o,i);oP(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,p=yc(i,a,h,o);Po(p,i)}aP(a,i,o),c&&Po(c,i);let l=yc(i,a,o.directiveStart+o.componentOffset,o);if(n[Pr]=i[Pr]=l,s!==null)for(let d of s)d(l,e);return eP(a,o,i),l}function dq(n,e,t,r){if(r)ew(n,t,["ng-version","17.3.11"]);else{let{attrs:i,classes:s}=c3(e.selectors[0]);i&&ew(n,t,i),s&&s.length>0&&Wk(n,t,s.join(" "))}}function hq(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function fq(){let n=Yn();Zw(Ge()[Ae],n)}var Ic=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=pq;let n=e;return n})();function pq(){let n=Yn();return gq(n,Ge())}var mq=Ic,_P=class extends mq{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return em(this._hostTNode,this._hostLView)}get injector(){return new Do(this._hostTNode,this._hostLView)}get parentInjector(){let e=eE(this._hostTNode,this._hostLView);if(vk(e)){let t=Rp(e,this._hostLView),r=xp(e),i=t[Ae].data[r+8];return new Do(i,t)}else return new Do(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=_N(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-lr}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=dN(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,uN(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!T3(e),a;if(o)a=t;else{let E=t||{};a=E.index,r=E.injector,i=E.projectableNodes,s=E.environmentInjector||E.ngModuleRef}let c=o?e:new vc(_s(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let A=(o?l:this.parentInjector).get(On,null);A&&(s=A)}let d=_s(c.componentType??{}),h=dN(this._lContainer,d?.id??null),p=h?.firstChild??null,_=c.create(l,i,p,s);return this.insertImpl(_.hostView,a,uN(this._hostTNode,h)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(F3(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[ln],l=new _P(c,c[Or],c[ln]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return PH(o,i,s,r),e.attachToViewContainerRef(),MN(Kv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=_N(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=fw(this._lContainer,t);r&&(bp(Kv(this._lContainer),t),qk(r[Ae],r))}detach(e){let t=this._adjustIndex(e,-1),r=fw(this._lContainer,t);return r&&bp(Kv(this._lContainer),t)!=null?new Mo(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function _N(n){return n[Sp]}function Kv(n){return n[Sp]||(n[Sp]=[])}function gq(n,e){let t,r=e[n.index];return ji(r)?t=r:(t=cP(r,e,null,n),e[n.index]=t,am(e,t)),yq(t,e,n,r),new _P(t,n,e)}function _q(n,e){let t=n[Zt],r=t.createComment(""),i=dr(e,n),s=cE(t,i);return Mp(t,s,r,Q4(t,i),!1),r}var yq=Eq,vq=()=>!1;function wq(n,e,t){return vq(n,e,t)}function Eq(n,e,t,r){if(n[Ro])return;let i;t.type&8?i=ni(r):i=_q(e,t),n[Ro]=i}function Iq(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(Sq))}return s}return Up.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,d=i.styleUrls;i.styleUrls.forEach((h,p)=>{a.push(""),o.push(r(h).then(_=>{a[l+p]=_,d.splice(d.indexOf(h),1),d.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>Dq(s));e.push(c)}),Cq(),Promise.all(e).then(()=>{})}var Up=new Map,bq=new Set;function Cq(){let n=Up;return Up=new Map,n}function Tq(){return Up.size===0}function Sq(n){return typeof n=="string"?n:n.text()}function Dq(n){bq.delete(n)}function Aq(n){return Object.getPrototypeOf(n.prototype).constructor}function Ju(n){let e=Aq(n.type),t=!0,r=[n];for(;e;){let i;if(ys(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new se(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let o=n;o.inputs=pp(n.inputs),o.inputTransforms=pp(n.inputTransforms),o.declaredInputs=pp(n.declaredInputs),o.outputs=pp(n.outputs);let a=i.hostBindings;a&&Pq(n,a);let c=i.viewQuery,l=i.contentQueries;if(c&&Nq(n,c),l&&kq(n,l),xq(n,i),k$(n.outputs,i.outputs),ys(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===Ju&&(t=!1)}}e=Object.getPrototypeOf(e)}Rq(r)}function xq(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function Rq(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Uu(i.hostAttrs,t=Uu(t,i.hostAttrs))}}function pp(n){return n===fc?{}:n===Nr?[]:n}function Nq(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function kq(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function Pq(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function yE(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var vs=class{},Gu=class{};var Bp=class extends vs{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Vp(this);let i=qN(e);this._bootstrapComponents=Bk(i.bootstrap),this._r3Injector=Ak(e,t,[{provide:vs,useValue:this},{provide:lm,useValue:this.componentFactoryResolver},...r],Mn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},jp=class extends Gu{constructor(e){super(),this.moduleType=e}create(e){return new Bp(this.moduleType,e,[])}};function Mq(n,e,t){return new Bp(n,e,t)}var Dw=class extends vs{constructor(e){super(),this.componentFactoryResolver=new Vp(this),this.instance=null;let t=new Bu([...e.providers,{provide:vs,useValue:this},{provide:lm,useValue:this.componentFactoryResolver}],e.parent||$w(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function dm(n,e,t=null){return new Dw({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var hm=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new De(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function yP(n){return Fq(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function Oq(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function Fq(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Lq(n,e,t){return n[e]=t}function ws(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function $p(n,e,t,r){let i=ws(n,e,t);return ws(n,e+1,r)||i}function Vq(n,e,t,r,i){let s=$p(n,e,t,r);return ws(n,e+2,i)||s}function vP(n,e,t,r,i,s){let o=$p(n,e,t,r);return $p(n,e+2,i,s)||o}function Uq(n){return(n.flags&32)===32}function Bq(n,e,t,r,i,s,o,a,c){let l=e.consts,d=om(e,n,4,o||null,Ap(l,a));sP(e,t,d,Ap(l,c)),Zw(e,d);let h=d.tView=dE(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}function ye(n,e,t,r,i,s,o,a){let c=Ge(),l=hr(),d=n+ti,h=l.firstCreatePass?Bq(d,l,c,e,t,r,i,s,o):l.data[d];Qu(h,!1);let p=jq(l,c,h,n);Jw()&&lE(l,c,p,h),Po(p,c);let _=cP(p,c,p,h);return c[d]=_,am(c,_),wq(_,h,c),qw(h)&&tP(l,c,h),o!=null&&nP(c,h,a),ye}var jq=$q;function $q(n,e,t,r){return Xw(!0),e[Zt].createComment("")}function fm(n,e,t,r){let i=Ge(),s=Ww();if(ws(i,s,e)){let o=hr(),a=Yw();bH(a,i,n,e,t,r)}return fm}function wP(n,e,t,r){return ws(n,Ww(),t)?e+qt(t)+r:Vn}function Hq(n,e,t,r,i,s){let o=Xp(),a=$p(n,o,t,i);return Zp(2),a?e+qt(t)+r+qt(i)+s:Vn}function qq(n,e,t,r,i,s,o,a){let c=Xp(),l=Vq(n,c,t,i,o);return Zp(3),l?e+qt(t)+r+qt(i)+s+qt(o)+a:Vn}function zq(n,e,t,r,i,s,o,a,c,l){let d=Xp(),h=vP(n,d,t,i,o,c);return Zp(4),h?e+qt(t)+r+qt(i)+s+qt(o)+a+qt(c)+l:Vn}function Gq(n,e,t,r,i,s,o,a,c,l,d,h){let p=Xp(),_=vP(n,p,t,i,o,c);return _=ws(n,p+4,d)||_,Zp(5),_?e+qt(t)+r+qt(i)+s+qt(o)+a+qt(c)+l+qt(d)+h:Vn}function Z(n,e,t){let r=Ge(),i=Ww();if(ws(r,i,e)){let s=hr(),o=Yw();iP(s,o,r,n,e,r[Zt],t,!1)}return Z}function yN(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";hE(n,t,s[o],o,r)}function Wq(n,e,t,r,i,s){let o=e.consts,a=Ap(o,i),c=om(e,n,2,r,a);return sP(e,t,c,Ap(o,s)),c.attrs!==null&&Cw(c,c.attrs,!1),c.mergedAttrs!==null&&Cw(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function v(n,e,t,r){let i=Ge(),s=hr(),o=ti+n,a=i[Zt],c=s.firstCreatePass?Wq(o,s,i,e,t,r):s.data[o],l=Kq(s,i,c,a,e,n);i[o]=l;let d=qw(c);return Qu(c,!0),Kk(a,l,c),!Uq(c)&&Jw()&&lE(s,i,l,c),B3()===0&&Po(l,i),j3(),d&&(tP(s,i,c),eP(s,c,i)),r!==null&&nP(i,c),v}function w(){let n=Yn();uk()?W3():(n=n.parent,Qu(n,!1));let e=n;q3(e)&&z3(),$3();let t=hr();return t.firstCreatePass&&(Zw(t,n),ek(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&s4(e)&&yN(t,e,Ge(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&o4(e)&&yN(t,e,Ge(),e.stylesWithoutHost,!1),w}function W(n,e,t,r){return v(n,e,t,r),w(),W}var Kq=(n,e,t,r,i,s)=>(Xw(!0),jk(r,i,t4()));function Ke(){return Ge()}var Hp="en-US";var Qq=Hp;function Yq(n){typeof n=="string"&&(Qq=n.toLowerCase().replace(/_/g,"-"))}function B(n,e,t,r){let i=Ge(),s=hr(),o=Yn();return Xq(s,i,i[Zt],o,n,e,r),B}function Jq(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[ju],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function Xq(n,e,t,r,i,s,o){let a=qw(r),l=n.firstCreatePass&&AH(n),d=e[Pr],h=DH(e),p=!0;if(r.type&3||o){let A=dr(r,e),R=o?o(A):A,V=h.length,J=o?ee=>o(ni(ee[r.index])):r.index,H=null;if(!o&&a&&(H=Jq(n,e,i,r.index)),H!==null){let ee=H.__ngLastListenerFn__||H;ee.__ngNextListenerFn__=s,H.__ngLastListenerFn__=s,p=!1}else{s=wN(r,e,d,s,!1);let ee=t.listen(R,i,s);h.push(s,ee),l&&l.push(i,J,V,V+1)}}else s=wN(r,e,d,s,!1);let _=r.outputs,E;if(p&&_!==null&&(E=_[i])){let A=E.length;if(A)for(let R=0;R<A;R+=2){let V=E[R],J=E[R+1],de=e[V][J].subscribe(s),re=h.length;h.push(s,de),l&&l.push(i,r.index,re,-(re+1))}}}function vN(n,e,t,r){let i=Le(null);try{return Jr(6,e,t),t(r)!==!1}catch(s){return uP(n,s),!1}finally{Jr(7,e,t),Le(i)}}function wN(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?Es(n.index,e):e;pE(a);let c=vN(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)c=vN(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function ue(n=1){return e4(n)}function Cs(n,e,t){return un(n,"",e,"",t),Cs}function un(n,e,t,r,i){let s=Ge(),o=wP(s,e,t,r);if(o!==Vn){let a=hr(),c=Yw();iP(a,c,s,n,o,s[Zt],i,!1)}return un}function Zq(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function b(n,e=""){let t=Ge(),r=hr(),i=n+ti,s=r.firstCreatePass?om(r,i,1,e,null):r.data[i],o=ez(r,t,s,e,n);t[i]=o,Jw()&&lE(r,t,o,s),Qu(s,!1)}var ez=(n,e,t,r,i)=>(Xw(!0),L4(e[Zt],r));function ft(n){return qi("",n,""),ft}function qi(n,e,t){let r=Ge(),i=wP(r,n,e,t);return i!==Vn&&Yu(r,Oo(),i),qi}function vE(n,e,t,r,i){let s=Ge(),o=Hq(s,n,e,t,r,i);return o!==Vn&&Yu(s,Oo(),o),vE}function wE(n,e,t,r,i,s,o){let a=Ge(),c=qq(a,n,e,t,r,i,s,o);return c!==Vn&&Yu(a,Oo(),c),wE}function EE(n,e,t,r,i,s,o,a,c){let l=Ge(),d=zq(l,n,e,t,r,i,s,o,a,c);return d!==Vn&&Yu(l,Oo(),d),EE}function IE(n,e,t,r,i,s,o,a,c,l,d){let h=Ge(),p=Gq(h,n,e,t,r,i,s,o,a,c,l,d);return p!==Vn&&Yu(h,Oo(),p),IE}function tz(n,e,t){let r=hr();if(r.firstCreatePass){let i=ys(n);Aw(t,r.data,r.blueprint,i,!0),Aw(e,r.data,r.blueprint,i,!1)}}function Aw(n,e,t,r,i){if(n=vn(n),Array.isArray(n))for(let s=0;s<n.length;s++)Aw(n[s],e,t,r,i);else{let s=hr(),o=Ge(),a=Yn(),c=mc(n)?n:vn(n.provide),l=YN(n),d=a.providerIndexes&1048575,h=a.directiveStart,p=a.providerIndexes>>20;if(mc(n)||!n.multi){let _=new ko(l,i,ne),E=Yv(c,e,i?d:d+p,h);E===-1?(cw(kp(a,o),s,c),Qv(s,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(_),o.push(_)):(t[E]=_,o[E]=_)}else{let _=Yv(c,e,d+p,h),E=Yv(c,e,d,d+p),A=_>=0&&t[_],R=E>=0&&t[E];if(i&&!R||!i&&!A){cw(kp(a,o),s,c);let V=iz(i?rz:nz,t.length,i,r,l);!i&&R&&(t[E].providerFactory=V),Qv(s,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(V),o.push(V)}else{let V=EP(t[i?E:_],l,!i&&r);Qv(s,n,_>-1?_:E,V)}!i&&r&&R&&t[E].componentProviders++}}}function Qv(n,e,t,r){let i=mc(e),s=g3(e);if(i||s){let c=(s?vn(e.useClass):e).prototype.ngOnDestroy;if(c){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=l.indexOf(t);d===-1?l.push(t,[r,c]):l[d+1].push(r,c)}else l.push(t,c)}}}function EP(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Yv(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function nz(n,e,t,r){return xw(this.multi,[])}function rz(n,e,t,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=yc(t,t[Ae],this.providerFactory.index,r);s=a.slice(0,o),xw(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],xw(i,s);return s}function xw(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function iz(n,e,t,r,i){let s=new ko(n,t,ne);return s.multi=[],s.index=e,s.componentProviders=0,EP(s,i,r&&!t),s}function bE(n,e=[]){return t=>{t.providersResolver=(r,i)=>tz(r,i?i(n):n,e)}}var sz=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=WN(!1,r.type),s=i.length>0?dm([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=ae({token:e,providedIn:"environment",factory:()=>new e(ce(On))});let n=e;return n})();function IP(n){mE("NgStandalone"),n.getStandaloneInjector=e=>e.get(sz).getOrCreateStandaloneInjector(n)}function oz(n,e){let t=n[e];return t===Vn?void 0:t}function az(n,e,t,r,i,s){let o=e+t;return ws(n,o,i)?Lq(n,o+1,s?r.call(s,i):r(i)):oz(n,o+1)}function Un(n,e){let t=hr(),r,i=n+ti;t.firstCreatePass?(r=cz(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=Ao(r.type,!0)),o,a=Pn(ne);try{let c=Np(!1),l=s();return Np(c),Zq(t,Ge(),i,l),l}finally{Pn(a)}}function cz(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function Bn(n,e,t){let r=n+ti,i=Ge(),s=O3(i,r);return lz(i,r)?az(i,K3(),e,s.transform,t,s):s.transform(t)}function lz(n,e){return n[Ae].data[e].pure}var mp=null;function uz(n){mp!==null&&(n.defaultEncapsulation!==mp.defaultEncapsulation||n.preserveWhitespaces!==mp.preserveWhitespaces)||(mp=n)}var pm=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var CE=new pe(""),Xu=new pe(""),mm=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,TE||(dz(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{tt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(ce(tt),ce(gm),ce(Xu))},e.\u0275prov=ae({token:e,factory:e.\u0275fac});let n=e;return n})(),gm=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return TE?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function dz(n){TE=n}var TE;function Vo(n){return!!n&&typeof n.then=="function"}function SE(n){return!!n&&typeof n.subscribe=="function"}var _m=new pe(""),bP=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=X(_m,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Vo(o))r.push(o);else if(SE(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),DE=new pe("");function hz(){fR(()=>{throw new se(600,!1)})}function fz(n){return n.isBoundToModule}function pz(n,e,t){try{let r=t();return Vo(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function CP(n,e){return Array.isArray(e)?e.reduce(CP,n):z(z({},n),e)}var bc=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=X(xk),this.afterRenderEffectManager=X(_E),this.externalTestViews=new Set,this.beforeRender=new an,this.afterTick=new an,this.componentTypes=[],this.components=[],this.isStable=X(hm).hasPendingTasks.pipe(Me(r=>!r)),this._injector=X(On)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Lp;if(!this._injector.get(bP).done){let _=!s&&HN(r),E=!1;throw new se(405,E)}let a;s?a=r:a=this._injector.get(lm).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=fz(a)?void 0:this._injector.get(vs),l=i||a.selector,d=a.create(Fr.NULL,[],l,c),h=d.location.nativeElement,p=d.injector.get(CE,null);return p?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),wp(this.components,d),p?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new se(101,!1);let i=Le(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Le(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===hP)throw new se(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)mz(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Rw(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Rw(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;wp(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(DE,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>wp(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new se(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function wp(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function mz(n,e,t){!e&&!Rw(n)||gz(n,t,e)}function Rw(n){return Gw(n)}function gz(n,e,t){let r;t?(r=0,n[fe]|=1024):n[fe]&64?r=0:r=1,fP(n,e,r)}var Nw=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},ym=(()=>{let e=class e{compileModuleSync(r){return new jp(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=qN(r),o=Bk(s.declarations).reduce((a,c)=>{let l=_s(c);return l&&a.push(new vc(l)),a},[]);return new Nw(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),_z=new pe("");function yz(n,e,t){let r=new jp(t);return Promise.resolve(r)}function EN(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var vz=(()=>{let e=class e{constructor(){this.zone=X(tt),this.applicationRef=X(bc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function wz(n){return[{provide:tt,useFactory:n},{provide:pc,multi:!0,useFactory:()=>{let e=X(vz,{optional:!0});return()=>e.initialize()}},{provide:pc,multi:!0,useFactory:()=>{let e=X(bz);return()=>{e.initialize()}}},{provide:xk,useFactory:Ez}]}function Ez(){let n=X(tt),e=X(ri);return t=>n.runOutsideAngular(()=>e.handleError(t))}function Iz(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var bz=(()=>{let e=class e{constructor(){this.subscription=new Bt,this.initialized=!1,this.zone=X(tt),this.pendingTasks=X(hm)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{tt.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{tt.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Cz(){return typeof $localize<"u"&&$localize.locale||Hp}var AE=new pe("",{providedIn:"root",factory:()=>X(AE,Ce.Optional|Ce.SkipSelf)||Cz()});var TP=new pe(""),SP=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=iq(i?.ngZone,Iz({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=Mq(r.moduleType,this.injector,wz(()=>s)),a=o.injector.get(ri,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{wp(this._modules,o),c.unsubscribe()})}),pz(a,s,()=>{let c=o.injector.get(bP);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(AE,Hp);return Yq(l||Hp),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=CP({},i);return yz(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(bc);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new se(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new se(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(TP,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(ce(Fr))},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),Lu=null,DP=new pe("");function Tz(n){if(Lu&&!Lu.get(DP,!1))throw new se(400,!1);hz(),Lu=n;let e=n.get(SP);return Az(n),e}function xE(n,e,t=[]){let r=`Platform: ${e}`,i=new pe(r);return(s=[])=>{let o=AP();if(!o||o.injector.get(DP,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):Tz(Sz(a,r))}return Dz(i)}}function Sz(n=[],e){return Fr.create({name:e,providers:[{provide:Kp,useValue:"platform"},{provide:TP,useValue:new Set([()=>Lu=null])},...n]})}function Dz(n){let e=AP();if(!e)throw new se(401,!1);return e}function AP(){return Lu?.get(SP)??null}function Az(n){n.get(rE,null)?.forEach(t=>t())}var Uo=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=xz;let n=e;return n})();function xz(n){return Rz(Yn(),Ge(),(n&16)===16)}function Rz(n,e,t){if(Jp(n)&&!t){let r=Es(n.index,e);return new Mo(r,r)}else if(n.type&47){let r=e[ei];return new Mo(r,e)}return null}var kw=class{constructor(){}supports(e){return yP(e)}create(e){return new Pw(e)}},Nz=(n,e)=>e,Pw=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Nz}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<IN(r,i,s)?t:r,a=IN(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,d=c-i;if(l!=d){for(let p=0;p<l;p++){let _=p<s.length?s[p]:s[p]=0,E=_+p;d<=E&&E<l&&(s[p]=_+1)}let h=o.previousIndex;s[h]=d-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!yP(e))throw new se(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,Oq(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new Mw(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new qp),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new qp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Mw=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Ow=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},qp=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Ow,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function IN(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function bN(){return new RE([new kw])}var RE=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||bN()),deps:[[e,new Vw,new Wp]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new se(901,!1)}};e.\u0275prov=ae({token:e,providedIn:"root",factory:bN});let n=e;return n})();var xP=xE(null,"core",[]),RP=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(ce(bc))},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({});let n=e;return n})();function Cc(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function NE(n){let e=Le(null);try{return n()}finally{Le(e)}}function NP(n){let e=_s(n);if(!e)return null;let t=new vc(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var FP=null;function Bo(){return FP}function LP(n){FP??=n}var vm=class{};var jn=new pe(""),UE=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:()=>X(kz),providedIn:"platform"});let n=e;return n})(),VP=new pe(""),kz=(()=>{let e=class e extends UE{constructor(){super(),this._doc=X(jn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Bo().getBaseHref(this._doc)}onPopState(r){let i=Bo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=Bo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function BE(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function kP(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function zi(n){return n&&n[0]!=="?"?"?"+n:n}var Lr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:()=>X(jE),providedIn:"root"});let n=e;return n})(),UP=new pe(""),jE=(()=>{let e=class e extends Lr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??X(jn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return BE(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+zi(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+zi(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+zi(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(ce(UE),ce(UP,8))},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Em=(()=>{let e=class e extends Lr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=BE(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+zi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+zi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(ce(UE),ce(UP,8))},e.\u0275prov=ae({token:e,factory:e.\u0275fac});let n=e;return n})(),Tc=(()=>{let e=class e{constructor(r){this._subject=new cn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=Oz(kP(PP(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+zi(i))}normalize(r){return e.stripTrailingSlash(Mz(this._basePath,PP(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+zi(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+zi(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=zi,e.joinWithSlash=BE,e.stripTrailingSlash=kP,e.\u0275fac=function(i){return new(i||e)(ce(Lr))},e.\u0275prov=ae({token:e,factory:()=>Pz(),providedIn:"root"});let n=e;return n})();function Pz(){return new Tc(ce(Lr))}function Mz(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function PP(n){return n.replace(/\/index.html$/,"")}function Oz(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function BP(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var kE=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},fr=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new kE(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),MP(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);MP(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(ne(Ic),ne(cm),ne(RE))},e.\u0275dir=Qn({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let n=e;return n})();function MP(n,e){n.context.$implicit=e.item}var pr=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new PE,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){OP("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){OP("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(ne(Ic),ne(cm))},e.\u0275dir=Qn({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let n=e;return n})(),PE=class{constructor(){this.$implicit=null,this.ngIf=null}};function OP(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${Mn(e)}'.`)}function Fz(n,e){return new se(2100,!1)}var ME=class{createSubscription(e,t){return NE(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){NE(()=>e.unsubscribe())}},OE=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},Lz=new OE,Vz=new ME,mr=(()=>{let e=class e{constructor(r){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=r}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(r){if(!this._obj){if(r)try{this.markForCheckOnValueUpdate=!1,this._subscribe(r)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return r!==this._obj?(this._dispose(),this.transform(r)):this._latestValue}_subscribe(r){this._obj=r,this._strategy=this._selectStrategy(r),this._subscription=this._strategy.createSubscription(r,i=>this._updateLatestValue(r,i))}_selectStrategy(r){if(Vo(r))return Lz;if(SE(r))return Vz;throw Fz(e,r)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(r,i){r===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}};e.\u0275fac=function(i){return new(i||e)(ne(Uo,16))},e.\u0275pipe=BN({name:"async",type:e,pure:!1,standalone:!0});let n=e;return n})();var jP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({});let n=e;return n})(),$E="browser",Uz="server";function Bz(n){return n===$E}function HE(n){return n===Uz}var $P=(()=>{let e=class e{};e.\u0275prov=ae({token:e,providedIn:"root",factory:()=>Bz(X(Is))?new FE(X(jn),window):new LE});let n=e;return n})(),FE=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=jz(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function jz(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var LE=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},wm=class{};var GE=class extends vm{constructor(){super(...arguments),this.supportsDOMEvents=!0}},WE=class n extends GE{static makeCurrent(){LP(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Hz();return t==null?null:qz(t)}resetBaseElement(){Zu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return BP(document.cookie,e)}},Zu=null;function Hz(){return Zu=Zu||document.querySelector("base"),Zu?Zu.getAttribute("href"):null}function qz(n){return new URL(n,document.baseURI).pathname}var KE=class{addToWindow(e){wn.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new se(5103,!1);return s},wn.getAllAngularTestabilities=()=>e.getAllTestabilities(),wn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=wn.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};wn.frameworkStabilizers||(wn.frameworkStabilizers=[]),wn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?Bo().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},zz=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac});let n=e;return n})(),QE=new pe(""),GP=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new se(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(ce(QE),ce(tt))},e.\u0275prov=ae({token:e,factory:e.\u0275fac});let n=e;return n})(),Im=class{constructor(e){this._doc=e}},qE="ng-app-id",WP=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=HE(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${qE}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(qE),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(qE,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(ce(jn),ce(tm),ce(iE,8),ce(Is))},e.\u0275prov=ae({token:e,factory:e.\u0275fac});let n=e;return n})(),zE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},JE=/%COMP%/g,KP="%COMP%",Gz=`_nghost-${KP}`,Wz=`_ngcontent-${KP}`,Kz=!0,Qz=new pe("",{providedIn:"root",factory:()=>Kz});function Yz(n){return Wz.replace(JE,n)}function Jz(n){return Gz.replace(JE,n)}function QP(n,e){return e.map(t=>t.replace(JE,n))}var HP=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=HE(c),this.defaultRenderer=new ed(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Zr.ShadowDom&&(i=lt(z({},i),{encapsulation:Zr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof bm?s.applyToHost(r):s instanceof td&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(i.encapsulation){case Zr.Emulated:o=new bm(l,d,i,this.appId,h,a,c,p);break;case Zr.ShadowDom:return new YE(l,d,r,i,a,c,this.nonce,p);default:o=new td(l,d,i,h,a,c,p);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(ce(GP),ce(WP),ce(tm),ce(Qz),ce(jn),ce(Is),ce(tt),ce(iE))},e.\u0275prov=ae({token:e,factory:e.\u0275fac});let n=e;return n})(),ed=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(zE[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(qP(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(qP(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new se(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=zE[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=zE[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Lo.DashCase|Lo.Important)?e.style.setProperty(t,r,i&Lo.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Lo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=Bo().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function qP(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var YE=class extends ed{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=QP(i.id,i.styles);for(let d of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},td=class extends ed{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?QP(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},bm=class extends td{constructor(e,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,l),this.contentAttr=Yz(l),this.hostAttr=Jz(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},Xz=(()=>{let e=class e extends Im{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(ce(jn))},e.\u0275prov=ae({token:e,factory:e.\u0275fac});let n=e;return n})(),zP=["alt","control","meta","shift"],Zz={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},eG={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},tG=(()=>{let e=class e extends Im{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Bo().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),zP.forEach(d=>{let h=i.indexOf(d);h>-1&&(i.splice(h,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=Zz[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),zP.forEach(a=>{if(a!==s){let c=eG[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(ce(jn))},e.\u0275prov=ae({token:e,factory:e.\u0275fac});let n=e;return n})();function nG(){WE.makeCurrent()}function rG(){return new ri}function iG(){return Ok(document),document}var sG=[{provide:Is,useValue:$E},{provide:rE,useValue:nG,multi:!0},{provide:jn,useFactory:iG,deps:[]}],YP=xE(xP,"browser",sG),oG=new pe(""),aG=[{provide:Xu,useClass:KE,deps:[]},{provide:CE,useClass:mm,deps:[tt,gm,Xu]},{provide:mm,useClass:mm,deps:[tt,gm,Xu]}],cG=[{provide:Kp,useValue:"root"},{provide:ri,useFactory:rG,deps:[]},{provide:QE,useClass:Xz,multi:!0,deps:[jn,tt,Is]},{provide:QE,useClass:tG,multi:!0,deps:[jn]},HP,WP,GP,{provide:zu,useExisting:HP},{provide:wm,useClass:zz,deps:[]},[]],JP=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:tm,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(ce(oG,12))},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({providers:[...cG,...aG],imports:[jP,RP]});let n=e;return n})();var XP=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(ce(jn))},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var we="primary",gd=Symbol("RouteTitle"),nI=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Rc(n){return new nI(n)}function lG(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function uG(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ii(n[t],e[t]))return!1;return!0}function ii(n,e){let t=n?rI(n):void 0,r=e?rI(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!cM(n[i],e[i]))return!1;return!0}function rI(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function cM(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function lM(n){return n.length>0?n[n.length-1]:null}function As(n){return Mv(n)?n:Vo(n)?Ct(Promise.resolve(n)):he(n)}var dG={exact:dM,subset:hM},uM={exact:hG,subset:fG,ignored:()=>!0};function eM(n,e,t){return dG[t.paths](n.root,e.root,t.matrixParams)&&uM[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function hG(n,e){return ii(n,e)}function dM(n,e,t){if(!$o(n.segments,e.segments)||!Sm(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!dM(n.children[r],e.children[r],t))return!1;return!0}function fG(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>cM(n[t],e[t]))}function hM(n,e,t){return fM(n,e,e.segments,t)}function fM(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!$o(i,t)||e.hasChildren()||!Sm(i,t,r))}else if(n.segments.length===t.length){if(!$o(n.segments,t)||!Sm(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!hM(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!$o(n.segments,i)||!Sm(n.segments,i,r)||!n.children[we]?!1:fM(n.children[we],e,s,r)}}function Sm(n,e,t){return e.every((r,i)=>uM[t](n[i].parameters,r.parameters))}var Ts=class{constructor(e=new qe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Rc(this.queryParams),this._queryParamMap}toString(){return gG.serialize(this)}},qe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Dm(this)}},jo=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Rc(this.parameters),this._parameterMap}toString(){return mM(this)}};function pG(n,e){return $o(n,e)&&n.every((t,r)=>ii(t.parameters,e[r].parameters))}function $o(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function mG(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===we&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==we&&(t=t.concat(e(i,r)))}),t}var _d=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:()=>new cd,providedIn:"root"});let n=e;return n})(),cd=class{parse(e){let t=new sI(e);return new Ts(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${nd(e.root,!0)}`,r=vG(e.queryParams),i=typeof e.fragment=="string"?`#${_G(e.fragment)}`:"";return`${t}${r}${i}`}},gG=new cd;function Dm(n){return n.segments.map(e=>mM(e)).join("/")}function nd(n,e){if(!n.hasChildren())return Dm(n);if(e){let t=n.children[we]?nd(n.children[we],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==we&&r.push(`${i}:${nd(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=mG(n,(r,i)=>i===we?[nd(n.children[we],!1)]:[`${i}:${nd(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[we]!=null?`${Dm(n)}/${t[0]}`:`${Dm(n)}/(${t.join("//")})`}}function pM(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Cm(n){return pM(n).replace(/%3B/gi,";")}function _G(n){return encodeURI(n)}function iI(n){return pM(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Am(n){return decodeURIComponent(n)}function tM(n){return Am(n.replace(/\+/g,"%20"))}function mM(n){return`${iI(n.path)}${yG(n.parameters)}`}function yG(n){return Object.entries(n).map(([e,t])=>`;${iI(e)}=${iI(t)}`).join("")}function vG(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Cm(t)}=${Cm(i)}`).join("&"):`${Cm(t)}=${Cm(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var wG=/^[^\/()?;#]+/;function XE(n){let e=n.match(wG);return e?e[0]:""}var EG=/^[^\/()?;=#]+/;function IG(n){let e=n.match(EG);return e?e[0]:""}var bG=/^[^=?&#]+/;function CG(n){let e=n.match(bG);return e?e[0]:""}var TG=/^[^&#]+/;function SG(n){let e=n.match(TG);return e?e[0]:""}var sI=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new qe([],{}):new qe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[we]=new qe(e,t)),r}parseSegment(){let e=XE(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new se(4009,!1);return this.capture(e),new jo(Am(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=IG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=XE(this.remaining);i&&(r=i,this.capture(r))}e[Am(t)]=Am(r)}parseQueryParam(e){let t=CG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=SG(this.remaining);o&&(r=o,this.capture(r))}let i=tM(t),s=tM(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=XE(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new se(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=we);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[we]:new qe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new se(4011,!1)}};function gM(n){return n.segments.length>0?new qe([],{[we]:n}):n}function _M(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=_M(i);if(r===we&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new qe(n.segments,e);return DG(t)}function DG(n){if(n.numberOfChildren===1&&n.children[we]){let e=n.children[we];return new qe(n.segments.concat(e.segments),e.children)}return n}function Nc(n){return n instanceof Ts}function AG(n,e,t=null,r=null){let i=yM(n);return vM(i,e,t,r)}function yM(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new qe(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=gM(r);return e??i}function vM(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return ZE(i,i,i,t,r);let s=xG(e);if(s.toRoot())return ZE(i,i,new qe([],{}),t,r);let o=RG(s,i,n),a=o.processChildren?sd(o.segmentGroup,o.index,s.commands):EM(o.segmentGroup,o.index,s.commands);return ZE(i,o.segmentGroup,a,t,r)}function xm(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function ld(n){return typeof n=="object"&&n!=null&&n.outlets}function ZE(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=wM(n,e,t);let a=gM(_M(o));return new Ts(a,s,i)}function wM(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=wM(s,e,t)}),new qe(n.segments,r)}var Rm=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&xm(r[0]))throw new se(4003,!1);let i=r.find(ld);if(i&&i!==lM(r))throw new se(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function xG(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Rm(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Rm(t,e,r)}var Ac=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function RG(n,e,t){if(n.isAbsolute)return new Ac(e,!0,0);if(!t)return new Ac(e,!1,NaN);if(t.parent===null)return new Ac(t,!0,0);let r=xm(n.commands[0])?0:1,i=t.segments.length-1+r;return NG(t,i,n.numberOfDoubleDots)}function NG(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new se(4005,!1);i=r.segments.length}return new Ac(r,!1,i-s)}function kG(n){return ld(n[0])?n[0].outlets:{[we]:n}}function EM(n,e,t){if(n??=new qe([],{}),n.segments.length===0&&n.hasChildren())return sd(n,e,t);let r=PG(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new qe(n.segments.slice(0,r.pathIndex),{});return s.children[we]=new qe(n.segments.slice(r.pathIndex),n.children),sd(s,0,i)}else return r.match&&i.length===0?new qe(n.segments,{}):r.match&&!n.hasChildren()?oI(n,e,t):r.match?sd(n,0,i):oI(n,e,t)}function sd(n,e,t){if(t.length===0)return new qe(n.segments,{});{let r=kG(t),i={};if(Object.keys(r).some(s=>s!==we)&&n.children[we]&&n.numberOfChildren===1&&n.children[we].segments.length===0){let s=sd(n.children[we],e,t);return new qe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=EM(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new qe(n.segments,i)}}function PG(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(ld(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!rM(c,l,o))return s;r+=2}else{if(!rM(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function oI(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(ld(s)){let c=MG(s.outlets);return new qe(r,c)}if(i===0&&xm(t[0])){let c=n.segments[e];r.push(new jo(c.path,nM(t[0]))),i++;continue}let o=ld(s)?s.outlets[we]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&xm(a)?(r.push(new jo(o,nM(a))),i+=2):(r.push(new jo(o,{})),i++)}return new qe(r,{})}function MG(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=oI(new qe([],{}),0,r))}),e}function nM(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function rM(n,e,t){return n==t.path&&ii(e,t.parameters)}var od="imperative",zt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(zt||{}),gr=class{constructor(e,t){this.id=e,this.url=t}},kc=class extends gr{constructor(e,t,r="imperative",i=null){super(e,t),this.type=zt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},si=class extends gr{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=zt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Xn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Xn||{}),Nm=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Nm||{}),Ss=class extends gr{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=zt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ds=class extends gr{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=zt.NavigationSkipped}},ud=class extends gr{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=zt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},km=class extends gr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=zt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},aI=class extends gr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=zt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},cI=class extends gr{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=zt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},lI=class extends gr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=zt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},uI=class extends gr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=zt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},dI=class{constructor(e){this.route=e,this.type=zt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},hI=class{constructor(e){this.route=e,this.type=zt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},fI=class{constructor(e){this.snapshot=e,this.type=zt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},pI=class{constructor(e){this.snapshot=e,this.type=zt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mI=class{constructor(e){this.snapshot=e,this.type=zt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},gI=class{constructor(e){this.snapshot=e,this.type=zt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pm=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=zt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},dd=class{},hd=class{constructor(e){this.url=e}};var _I=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new yd,this.attachRef=null}},yd=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new _I,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Mm=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=yI(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=yI(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=vI(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return vI(e,this._root).map(t=>t.value)}};function yI(n,e){if(n===e.value)return e;for(let t of e.children){let r=yI(n,t);if(r)return r}return null}function vI(n,e){if(n===e.value)return[e];for(let t of e.children){let r=vI(n,t);if(r.length)return r.unshift(e),r}return[]}var Jn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Dc(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Om=class extends Mm{constructor(e,t){super(e),this.snapshot=t,xI(this,e)}toString(){return this.snapshot.toString()}};function IM(n){let e=OG(n),t=new De([new jo("",{})]),r=new De({}),i=new De({}),s=new De({}),o=new De(""),a=new Vr(t,r,s,o,i,we,n,e.root);return a.snapshot=e.root,new Om(new Jn(a,[]),e)}function OG(n){let e={},t={},r={},i="",s=new fd([],e,r,i,t,we,n,null,{});return new Fm("",new Jn(s,[]))}var Vr=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Me(l=>l[gd]))??he(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Me(e=>Rc(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Me(e=>Rc(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function AI(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:z(z({},e.params),n.params),data:z(z({},e.data),n.data),resolve:z(z(z(z({},n.data),e.data),i?.data),n._resolvedData)}:r={params:z({},n.params),data:z({},n.data),resolve:z(z({},n.data),n._resolvedData??{})},i&&CM(i)&&(r.resolve[gd]=i.title),r}var fd=class{get title(){return this.data?.[gd]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Rc(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Rc(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Fm=class extends Mm{constructor(e,t){super(t),this.url=e,xI(this,t)}toString(){return bM(this._root)}};function xI(n,e){e.value._routerState=n,e.children.forEach(t=>xI(n,t))}function bM(n){let e=n.children.length>0?` { ${n.children.map(bM).join(", ")} } `:"";return`${n.value}${e}`}function eI(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ii(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),ii(e.params,t.params)||n.paramsSubject.next(t.params),uG(e.url,t.url)||n.urlSubject.next(t.url),ii(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function wI(n,e){let t=ii(n.params,e.params)&&pG(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||wI(n.parent,e.parent))}function CM(n){return typeof n.title=="string"||n.title===null}var RI=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=we,this.activateEvents=new cn,this.deactivateEvents=new cn,this.attachEvents=new cn,this.detachEvents=new cn,this.parentContexts=X(yd),this.location=X(Ic),this.changeDetector=X(Uo),this.environmentInjector=X(On),this.inputBinder=X(jm,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new se(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new se(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new se(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new se(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new EI(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Qn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ec]});let n=e;return n})(),EI=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Vr?this.route:e===yd?this.childContexts:this.parent.get(e,t)}},jm=new pe(""),iM=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Mu([i.queryParams,i.params,i.data]).pipe(cr(([o,a,c],l)=>(c=z(z(z({},o),a),c),l===0?he(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=NP(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac});let n=e;return n})();function FG(n,e,t){let r=pd(n,e._root,t?t._root:void 0);return new Om(r,e)}function pd(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=LG(n,e,t);return new Jn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>pd(n,a)),o}}let r=VG(e.value),i=e.children.map(s=>pd(n,s));return new Jn(r,i)}}function LG(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return pd(n,r,i);return pd(n,r)})}function VG(n){return new Vr(new De(n.url),new De(n.params),new De(n.queryParams),new De(n.fragment),new De(n.data),n.outlet,n.component,n)}var TM="ngNavigationCancelingError";function SM(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Nc(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=DM(!1,Xn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function DM(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[TM]=!0,t.cancellationCode=e,t}function UG(n){return AM(n)&&Nc(n.url)}function AM(n){return!!n&&n[TM]}var BG=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=xe({type:e,selectors:[["ng-component"]],standalone:!0,features:[IP],decls:1,vars:0,template:function(i,s){i&1&&W(0,"router-outlet")},dependencies:[RI],encapsulation:2});let n=e;return n})();function jG(n,e){return n.providers&&!n._injector&&(n._injector=dm(n.providers,e,`Route: ${n.path}`)),n._injector??e}function NI(n){let e=n.children&&n.children.map(NI),t=e?lt(z({},n),{children:e}):z({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==we&&(t.component=BG),t}function oi(n){return n.outlet||we}function $G(n,e){let t=n.filter(r=>oi(r)===e);return t.push(...n.filter(r=>oi(r)!==e)),t}function vd(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var HG=(n,e,t,r)=>Me(i=>(new II(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),II=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),eI(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Dc(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Dc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Dc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Dc(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new gI(s.value.snapshot))}),e.children.length&&this.forwardEvent(new pI(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(eI(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),eI(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=vd(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Lm=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},xc=class{constructor(e,t){this.component=e,this.route=t}};function qG(n,e,t){let r=n._root,i=e?e._root:null;return rd(r,i,t,[r.value])}function zG(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Mc(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!DN(n)?n:e.get(n):r}function rd(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Dc(e);return n.children.forEach(o=>{GG(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>ad(a,t.getContext(o),i)),i}function GG(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=WG(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Lm(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?rd(n,e,a?a.children:null,r,i):rd(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new xc(a.outlet.component,o))}else o&&ad(e,a,i),i.canActivateChecks.push(new Lm(r)),s.component?rd(n,null,a?a.children:null,r,i):rd(n,null,t,r,i);return i}function WG(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!$o(n.url,e.url);case"pathParamsOrQueryParamsChange":return!$o(n.url,e.url)||!ii(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!wI(n,e)||!ii(n.queryParams,e.queryParams);case"paramsChange":default:return!wI(n,e)}}function ad(n,e,t){let r=Dc(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?ad(o,e.children.getContext(s),t):ad(o,null,t):ad(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new xc(e.outlet.component,i)):t.canDeactivateChecks.push(new xc(null,i)):t.canDeactivateChecks.push(new xc(null,i))}function wd(n){return typeof n=="function"}function KG(n){return typeof n=="boolean"}function QG(n){return n&&wd(n.canLoad)}function YG(n){return n&&wd(n.canActivate)}function JG(n){return n&&wd(n.canActivateChild)}function XG(n){return n&&wd(n.canDeactivate)}function ZG(n){return n&&wd(n.canMatch)}function xM(n){return n instanceof Li||n?.name==="EmptyError"}var Tm=Symbol("INITIAL_VALUE");function Pc(){return cr(n=>Mu(n.map(e=>e.pipe(Vi(1),Vv(Tm)))).pipe(Me(e=>{for(let t of e)if(t!==!0){if(t===Tm)return Tm;if(t===!1||t instanceof Ts)return t}return!0}),ar(e=>e!==Tm),Vi(1)))}function e5(n,e){return Rt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?he(lt(z({},t),{guardsResult:!0})):t5(o,r,i,n).pipe(Rt(a=>a&&KG(a)?n5(r,s,n,e):he(a)),Me(a=>lt(z({},t),{guardsResult:a})))})}function t5(n,e,t,r){return Ct(n).pipe(Rt(i=>a5(i.component,i.route,t,e,r)),Yr(i=>i!==!0,!0))}function n5(n,e,t,r){return Ct(e).pipe(To(i=>sc(i5(i.route.parent,r),r5(i.route,r),o5(n,i.path,t),s5(n,i.route,t))),Yr(i=>i!==!0,!0))}function r5(n,e){return n!==null&&e&&e(new mI(n)),he(!0)}function i5(n,e){return n!==null&&e&&e(new fI(n)),he(!0)}function s5(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return he(!0);let i=r.map(s=>up(()=>{let o=vd(e)??t,a=Mc(s,o),c=YG(a)?a.canActivate(e,n):Ui(o,()=>a(e,n));return As(c).pipe(Yr())}));return he(i).pipe(Pc())}function o5(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>zG(o)).filter(o=>o!==null).map(o=>up(()=>{let a=o.guards.map(c=>{let l=vd(o.node)??t,d=Mc(c,l),h=JG(d)?d.canActivateChild(r,n):Ui(l,()=>d(r,n));return As(h).pipe(Yr())});return he(a).pipe(Pc())}));return he(s).pipe(Pc())}function a5(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return he(!0);let o=s.map(a=>{let c=vd(e)??i,l=Mc(a,c),d=XG(l)?l.canDeactivate(n,e,t,r):Ui(c,()=>l(n,e,t,r));return As(d).pipe(Yr())});return he(o).pipe(Pc())}function c5(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return he(!0);let s=i.map(o=>{let a=Mc(o,n),c=QG(a)?a.canLoad(e,t):Ui(n,()=>a(e,t));return As(c)});return he(s).pipe(Pc(),RM(r))}function RM(n){return Rv(Xt(e=>{if(Nc(e))throw SM(n,e)}),Me(e=>e===!0))}function l5(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return he(!0);let s=i.map(o=>{let a=Mc(o,n),c=ZG(a)?a.canMatch(e,t):Ui(n,()=>a(e,t));return As(c)});return he(s).pipe(Pc(),RM(r))}var md=class{constructor(e){this.segmentGroup=e||null}},Vm=class extends Error{constructor(e){super(),this.urlTree=e}};function Sc(n){return rc(new md(n))}function u5(n){return rc(new se(4e3,!1))}function d5(n){return rc(DM(!1,Xn.GuardRejected))}var bI=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return he(r);if(i.numberOfChildren>1||!i.children[we])return u5(e.redirectTo);i=i.children[we]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new Vm(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Ts(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new qe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new se(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},CI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function h5(n,e,t,r,i){let s=kI(n,e,t);return s.matched?(r=jG(e,r),l5(r,e,t,i).pipe(Me(o=>o===!0?s:z({},CI)))):he(s)}function kI(n,e,t){if(e.path==="**")return f5(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?z({},CI):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||lG)(t,n,e);if(!i)return z({},CI);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?z(z({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function f5(n){return{matched:!0,parameters:n.length>0?lM(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function sM(n,e,t,r){return t.length>0&&g5(n,t,r)?{segmentGroup:new qe(e,m5(r,new qe(t,n.children))),slicedSegments:[]}:t.length===0&&_5(n,t,r)?{segmentGroup:new qe(n.segments,p5(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new qe(n.segments,n.children),slicedSegments:t}}function p5(n,e,t,r){let i={};for(let s of t)if($m(n,e,s)&&!r[oi(s)]){let o=new qe([],{});i[oi(s)]=o}return z(z({},r),i)}function m5(n,e){let t={};t[we]=e;for(let r of n)if(r.path===""&&oi(r)!==we){let i=new qe([],{});t[oi(r)]=i}return t}function g5(n,e,t){return t.some(r=>$m(n,e,r)&&oi(r)!==we)}function _5(n,e,t){return t.some(r=>$m(n,e,r))}function $m(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function y5(n,e,t,r){return oi(n)!==r&&(r===we||!$m(e,t,n))?!1:kI(e,n,t).matched}function v5(n,e,t){return e.length===0&&!n.children[t]}var TI=class{};function w5(n,e,t,r,i,s,o="emptyOnly"){return new SI(n,e,t,r,i,o,s).recognize()}var E5=31,SI=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new bI(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new se(4002,`'${e.segmentGroup}'`)}recognize(){let e=sM(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Me(t=>{let r=new fd([],Object.freeze({}),Object.freeze(z({},this.urlTree.queryParams)),this.urlTree.fragment,{},we,this.rootComponentType,null,{}),i=new Jn(r,t),s=new Fm("",i),o=AG(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,we).pipe(fs(r=>{if(r instanceof Vm)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof md?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=AI(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Me(s=>s instanceof Jn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return Ct(i).pipe(To(s=>{let o=r.children[s],a=$G(t,s);return this.processSegmentGroup(e,a,o,s)}),Lv((s,o)=>(s.push(...o),s)),ps(null),Fv(),Rt(s=>{if(s===null)return Sc(r);let o=NM(s);return I5(o),he(o)}))}processSegment(e,t,r,i,s,o){return Ct(t).pipe(To(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(fs(c=>{if(c instanceof md)return he(null);throw c}))),Yr(a=>!!a),fs(a=>{if(xM(a))return v5(r,i,s)?he(new TI):Sc(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return y5(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):Sc(i):Sc(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:d}=kI(t,i,s);if(!a)return Sc(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>E5&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,h).pipe(Rt(p=>this.processSegment(e,r,t,p.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=h5(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(cr(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(cr(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:p}=a,_=new fd(d,p,Object.freeze(z({},this.urlTree.queryParams)),this.urlTree.fragment,C5(r),oi(r),r.component??r._loadedComponent??null,r,T5(r)),{segmentGroup:E,slicedSegments:A}=sM(t,d,h,c);if(A.length===0&&E.hasChildren())return this.processChildren(l,c,E).pipe(Me(V=>V===null?null:new Jn(_,V)));if(c.length===0&&A.length===0)return he(new Jn(_,[]));let R=oi(r)===s;return this.processSegment(l,c,E,A,R?we:s,!0).pipe(Me(V=>new Jn(_,V instanceof Jn?[V]:[])))}))):Sc(t)))}getChildConfig(e,t,r){return t.children?he({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?he({routes:t._loadedRoutes,injector:t._loadedInjector}):c5(e,t,r,this.urlSerializer).pipe(Rt(i=>i?this.configLoader.loadChildren(e,t).pipe(Xt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):d5(t))):he({routes:[],injector:e})}};function I5(n){n.sort((e,t)=>e.value.outlet===we?-1:t.value.outlet===we?1:e.value.outlet.localeCompare(t.value.outlet))}function b5(n){let e=n.value.routeConfig;return e&&e.path===""}function NM(n){let e=[],t=new Set;for(let r of n){if(!b5(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=NM(r.children);e.push(new Jn(r.value,i))}return e.filter(r=>!t.has(r))}function C5(n){return n.data||{}}function T5(n){return n.resolve||{}}function S5(n,e,t,r,i,s){return Rt(o=>w5(n,e,t,r,o.extractedUrl,i,s).pipe(Me(({state:a,tree:c})=>lt(z({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function D5(n,e){return Rt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return he(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of kM(c))o.add(l);let a=0;return Ct(o).pipe(To(c=>s.has(c)?A5(c,r,n,e):(c.data=AI(c,c.parent,n).resolve,he(void 0))),Xt(()=>a++),oc(1),Rt(c=>a===o.size?he(t):Kn))})}function kM(n){let e=n.children.map(t=>kM(t)).flat();return[n,...e]}function A5(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!CM(i)&&(s[gd]=i.title),x5(s,n,e,r).pipe(Me(o=>(n._resolvedData=o,n.data=AI(n,n.parent,t).resolve,null)))}function x5(n,e,t,r){let i=rI(n);if(i.length===0)return he({});let s={};return Ct(i).pipe(Rt(o=>R5(n[o],e,t,r).pipe(Yr(),Xt(a=>{s[o]=a}))),oc(1),Ov(s),fs(o=>xM(o)?Kn:rc(o)))}function R5(n,e,t,r){let i=vd(e)??r,s=Mc(n,i),o=s.resolve?s.resolve(e,t):Ui(i,()=>s(e,t));return As(o)}function tI(n){return cr(e=>{let t=n(e);return t?Ct(t).pipe(Me(()=>e)):he(e)})}var PM=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===we);return i}getResolvedTitleForRoute(r){return r.data[gd]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:()=>X(N5),providedIn:"root"});let n=e;return n})(),N5=(()=>{let e=class e extends PM{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(ce(XP))},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ed=new pe("",{providedIn:"root",factory:()=>({})}),Um=new pe(""),PI=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=X(ym)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return he(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=As(r.loadComponent()).pipe(Me(MM),Xt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Ou(()=>{this.componentLoaders.delete(r)})),s=new nc(i,()=>new an).pipe(tc());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return he({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=k5(i,this.compiler,r,this.onLoadEndListener).pipe(Ou(()=>{this.childrenLoaders.delete(i)})),a=new nc(o,()=>new an).pipe(tc());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function k5(n,e,t,r){return As(n.loadChildren()).pipe(Me(MM),Rt(i=>i instanceof Gu||Array.isArray(i)?he(i):Ct(e.compileModuleAsync(i))),Me(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(Um,[],{optional:!0,self:!0}).flat()),{routes:o.map(NI),injector:s}}))}function P5(n){return n&&typeof n=="object"&&"default"in n}function MM(n){return P5(n)?n.default:n}var MI=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:()=>X(M5),providedIn:"root"});let n=e;return n})(),M5=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),OM=new pe(""),FM=new pe("");function O5(n,e,t){let r=n.get(FM),i=n.get(jn);return n.get(tt).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),F5(n))),{onViewTransitionCreated:c}=r;return c&&Ui(n,()=>c({transition:a,from:e,to:t})),o})}function F5(n){return new Promise(e=>{um(e,{injector:n})})}var OI=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new an,this.transitionAbortSubject=new an,this.configLoader=X(PI),this.environmentInjector=X(On),this.urlSerializer=X(_d),this.rootContexts=X(yd),this.location=X(Tc),this.inputBindingEnabled=X(jm,{optional:!0})!==null,this.titleStrategy=X(PM),this.options=X(Ed,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=X(MI),this.createViewTransition=X(OM,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>he(void 0),this.rootComponentType=null;let r=s=>this.events.next(new dI(s)),i=s=>this.events.next(new hI(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(lt(z(z({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new De({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:od,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ar(o=>o.id!==0),Me(o=>lt(z({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),cr(o=>{let a=!1,c=!1;return he(o).pipe(cr(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Xn.SupersededByNewNavigation),Kn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?lt(z({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&h!=="reload"){let p="";return this.events.next(new Ds(l.id,this.urlSerializer.serialize(l.rawUrl),p,Nm.IgnoredSameUrlNavigation)),l.resolve(null),Kn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return he(l).pipe(cr(p=>{let _=this.transitions?.getValue();return this.events.next(new kc(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),_!==this.transitions?.getValue()?Kn:Promise.resolve(p)}),S5(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Xt(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=lt(z({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let _=new km(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(_)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:_,source:E,restoredState:A,extras:R}=l,V=new kc(p,this.urlSerializer.serialize(_),E,A);this.events.next(V);let J=IM(this.rootComponentType).snapshot;return this.currentTransition=o=lt(z({},l),{targetSnapshot:J,urlAfterRedirects:_,extras:lt(z({},R),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=_,he(o)}else{let p="";return this.events.next(new Ds(l.id,this.urlSerializer.serialize(l.extractedUrl),p,Nm.IgnoredByUrlHandlingStrategy)),l.resolve(null),Kn}}),Xt(l=>{let d=new aI(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Me(l=>(this.currentTransition=o=lt(z({},l),{guards:qG(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),e5(this.environmentInjector,l=>this.events.next(l)),Xt(l=>{if(o.guardsResult=l.guardsResult,Nc(l.guardsResult))throw SM(this.urlSerializer,l.guardsResult);let d=new cI(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),ar(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Xn.GuardRejected),!1)),tI(l=>{if(l.guards.canActivateChecks.length)return he(l).pipe(Xt(d=>{let h=new lI(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),cr(d=>{let h=!1;return he(d).pipe(D5(this.paramsInheritanceStrategy,this.environmentInjector),Xt({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",Xn.NoDataFromResolver)}}))}),Xt(d=>{let h=new uI(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),tI(l=>{let d=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(Xt(_=>{h.component=_}),Me(()=>{})));for(let _ of h.children)p.push(...d(_));return p};return Mu(d(l.targetSnapshot.root)).pipe(ps(null),Vi(1))}),tI(()=>this.afterPreactivation()),cr(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return h?Ct(h).pipe(Me(()=>o)):he(o)}),Me(l=>{let d=FG(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=lt(z({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),Xt(()=>{this.events.next(new dd)}),HG(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Vi(1),Xt({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new si(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Uv(this.transitionAbortSubject.pipe(Xt(l=>{throw l}))),Ou(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Xn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),fs(l=>{if(c=!0,AM(l))this.events.next(new Ss(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),UG(l)?this.events.next(new hd(l.url)):o.resolve(!1);else{this.events.next(new ud(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Kn}))}))}cancelNavigationTransition(r,i,s){let o=new Ss(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function L5(n){return n!==od}var V5=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:()=>X(U5),providedIn:"root"});let n=e;return n})(),DI=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},U5=(()=>{let e=class e extends DI{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Fo(e)))(s||e)}})(),e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),LM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:()=>X(B5),providedIn:"root"});let n=e;return n})(),B5=(()=>{let e=class e extends LM{constructor(){super(...arguments),this.location=X(Tc),this.urlSerializer=X(_d),this.options=X(Ed,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=X(MI),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ts,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=IM(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof kc)this.stateMemento=this.createStateMemento();else if(r instanceof Ds)this.rawUrlTree=i.initialUrl;else if(r instanceof km){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof dd?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Ss&&(r.code===Xn.GuardRejected||r.code===Xn.NoDataFromResolver)?this.restoreHistory(i):r instanceof ud?this.restoreHistory(i,!0):r instanceof si&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=z(z({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=z(z({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Fo(e)))(s||e)}})(),e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),id=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(id||{});function VM(n,e){n.events.pipe(ar(t=>t instanceof si||t instanceof Ss||t instanceof ud||t instanceof Ds),Me(t=>t instanceof si||t instanceof Ds?id.COMPLETE:(t instanceof Ss?t.code===Xn.Redirect||t.code===Xn.SupersededByNewNavigation:!1)?id.REDIRECTING:id.FAILED),ar(t=>t!==id.REDIRECTING),Vi(1)).subscribe(()=>{e()})}function j5(n){throw n}var $5={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},H5={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},nt=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=X(pm),this.stateManager=X(LM),this.options=X(Ed,{optional:!0})||{},this.pendingTasks=X(hm),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=X(OI),this.urlSerializer=X(_d),this.location=X(Tc),this.urlHandlingStrategy=X(MI),this._events=new an,this.errorHandler=this.options.errorHandler||j5,this.navigated=!1,this.routeReuseStrategy=X(V5),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=X(Um,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!X(jm,{optional:!0}),this.eventsSubscription=new Bt,this.isNgZoneEnabled=X(tt)instanceof tt&&tt.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Ss&&i.code!==Xn.Redirect&&i.code!==Xn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof si)this.navigated=!0;else if(i instanceof hd){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||L5(s.source)};this.scheduleNavigation(a,od,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}z5(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),od,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=z({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(NI),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=z(z({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let _=s?s.snapshot:this.routerState.snapshot.root;p=yM(_)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),p=this.currentUrlTree.root}return vM(p,r,h,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Nc(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,od,null,i)}navigate(r,i={skipLocationChange:!1}){return q5(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=z({},$5):i===!1?s=z({},H5):s=i,Nc(r))return eM(this.currentUrlTree,r,s);let o=this.parseUrl(r);return eM(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,d;a?(c=a.resolve,l=a.reject,d=a.promise):d=new Promise((p,_)=>{c=p,l=_});let h=this.pendingTasks.add();return VM(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function q5(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new se(4008,!1)}function z5(n){return!(n instanceof dd)&&!(n instanceof hd)}var Oc=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new an,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof si&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:Vk(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(ne(nt),ne(Vr),tE("tabindex"),ne(bs),ne($i),ne(Lr))},e.\u0275dir=Qn({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&B("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&fm("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[ur.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Cc],skipLocationChange:[ur.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Cc],replaceUrl:[ur.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Cc],routerLink:"routerLink"},standalone:!0,features:[yE,Ec]});let n=e;return n})();var Bm=class{};var G5=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(ar(r=>r instanceof si),To(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=dm(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return Ct(s).pipe(ic())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=he(null);let o=s.pipe(Rt(a=>a===null?he(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return Ct([o,a]).pipe(ic())}else return o})}};e.\u0275fac=function(i){return new(i||e)(ce(nt),ce(ym),ce(On),ce(Bm),ce(PI))},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),UM=new pe(""),W5=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=X(On),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof kc?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof si?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Ds&&r.code===Nm.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Pm&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>g(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),um(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Pm(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){Yk()},e.\u0275prov=ae({token:e,factory:e.\u0275fac});let n=e;return n})();function K5(n){return n.routerState.root}function Id(n,e){return{\u0275kind:n,\u0275providers:e}}function Q5(){let n=X(Fr);return e=>{let t=n.get(bc);if(e!==t.components[0])return;let r=n.get(nt),i=n.get(BM);n.get(FI)===1&&r.initialNavigation(),n.get(jM,null,Ce.Optional)?.setUpPreloading(),n.get(UM,null,Ce.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var BM=new pe("",{factory:()=>new an}),FI=new pe("",{providedIn:"root",factory:()=>1});function Y5(){return Id(2,[{provide:FI,useValue:0},{provide:_m,multi:!0,deps:[Fr],useFactory:e=>{let t=e.get(VP,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(nt),s=e.get(BM);VM(i,()=>{r(!0)}),e.get(OI).afterPreactivation=()=>(r(!0),s.closed?he(void 0):s),i.initialNavigation()}))}}])}function J5(){return Id(3,[{provide:_m,multi:!0,useFactory:()=>{let e=X(nt);return()=>{e.setUpLocationChangeListener()}}},{provide:FI,useValue:2}])}var jM=new pe("");function X5(n){return Id(0,[{provide:jM,useExisting:G5},{provide:Bm,useExisting:n}])}function Z5(){return Id(8,[iM,{provide:jm,useExisting:iM}])}function eW(n){let e=[{provide:OM,useValue:O5},{provide:FM,useValue:z({skipNextTransition:!!n?.skipInitialTransition},n)}];return Id(9,e)}var oM=new pe("ROUTER_FORROOT_GUARD"),tW=[Tc,{provide:_d,useClass:cd},nt,yd,{provide:Vr,useFactory:K5,deps:[nt]},PI,[]],LI=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[tW,[],{provide:Um,multi:!0,useValue:r},{provide:oM,useFactory:sW,deps:[[nt,new Wp,new Vw]]},{provide:Ed,useValue:i||{}},i?.useHash?rW():iW(),nW(),i?.preloadingStrategy?X5(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?oW(i):[],i?.bindToComponentInputs?Z5().\u0275providers:[],i?.enableViewTransitions?eW().\u0275providers:[],aW()]}}static forChild(r){return{ngModule:e,providers:[{provide:Um,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(ce(oM,8))},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({});let n=e;return n})();function nW(){return{provide:UM,useFactory:()=>{let n=X($P),e=X(tt),t=X(Ed),r=X(OI),i=X(_d);return t.scrollOffset&&n.setOffset(t.scrollOffset),new W5(i,r,n,e,t)}}}function rW(){return{provide:Lr,useClass:Em}}function iW(){return{provide:Lr,useClass:jE}}function sW(n){return"guarded"}function oW(n){return[n.initialNavigation==="disabled"?J5().\u0275providers:[],n.initialNavigation==="enabledBlocking"?Y5().\u0275providers:[]]}var aM=new pe("");function aW(){return[{provide:aM,useFactory:Q5},{provide:DE,multi:!0,useExisting:aM}]}var UI={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var q=function(n,e){if(!n)throw Ho(e)},Ho=function(n){return new Error("Firebase Database ("+UI.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var HM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},cW=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},qm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4,p=(a&15)<<2|l>>6,_=l&63;c||(_=64,o||(p=64)),r.push(t[d],t[h],t[p],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(HM(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):cW(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new BI;let p=s<<2|a>>4;if(r.push(p),l!==64){let _=a<<4&240|l>>2;if(r.push(_),h!==64){let E=l<<6&192|h;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},BI=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},$I=function(n){let e=HM(n);return qm.encodeByteArray(e,!0)},bd=function(n){return $I(n).replace(/\./g,"")},Cd=function(n){try{return qm.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function qM(n){return Lc(void 0,n)}function Lc(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!lW(t)||(n[t]=Lc(n[t],e[t]));return n}function lW(n){return n!=="__proto__"}function uW(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var dW=()=>uW().__FIREBASE_DEFAULTS__,hW=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},fW=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Cd(n[1]);return e&&JSON.parse(e)},HI=()=>{try{return dW()||hW()||fW()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var qI=()=>{var n;return(n=HI())===null||n===void 0?void 0:n.config},zM=n=>{var e;return(e=HI())===null||e===void 0?void 0:e[`_${n}`]};var jt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Vc(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[bd(JSON.stringify(t)),bd(JSON.stringify(o)),""].join(".")}function Xe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Td(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xe())}function zm(){var n;let e=(n=HI())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Gm(){return typeof self=="object"&&self.self===self}function Wm(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function qo(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Km(){let n=Xe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ci(){return UI.NODE_CLIENT===!0||UI.NODE_ADMIN===!0}function zI(){return!zm()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xs(){try{return typeof indexedDB=="object"}catch{return!1}}function GM(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var pW="FirebaseError",vt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=pW,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_r.prototype.create)}},_r=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?mW(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new vt(i,a,r)}};function mW(n,e){return n.replace(gW,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var gW=/\{\$([^}]+)}/g;function Fc(n){return JSON.parse(n)}function Nt(n){return JSON.stringify(n)}var WM=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=Fc(Cd(s[0])||""),t=Fc(Cd(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var KM=function(n){let e=WM(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},QM=function(n){let e=WM(n).claims;return typeof e=="object"&&e.admin===!0};function En(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Rs(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Uc(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Sd(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Ns(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if($M(s)&&$M(o)){if(!Ns(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function $M(n){return n!==null&&typeof n=="object"}function Wi(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ks(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Bc(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var Hm=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){let p=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(p<<1|p>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,d;for(let h=0;h<80;h++){h<40?h<20?(l=a^s&(o^a),d=1518500249):(l=s^o^a,d=1859775393):h<60?(l=s&o|a&(s|o),d=2400959708):(l=s^o^a,d=3395469782);let p=(i<<5|i>>>27)+l+c+d+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=p}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function Qm(n,e){let t=new jI(n,e);return t.subscribe.bind(t)}var jI=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");_W(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=VI),i.error===void 0&&(i.error=VI),i.complete===void 0&&(i.complete=VI);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function _W(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function VI(){}var le=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){let s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function dn(n,e){return`${n} failed: ${e} argument `}function $t(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(dn(n,e)+"must be a valid function.")}function GI(n,e,t,r){if(!(r&&!t)&&(typeof t!="object"||t===null))throw new Error(dn(n,e)+"must be a valid context object.")}var YM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,q(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Dd=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var Wae=4*60*60*1e3;function K(n){return n&&n._delegate?n._delegate:n}var Qe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var zo="[DEFAULT]";var Go=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new jt;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vW(e))try{this.getOrInitializeService({instanceIdentifier:zo})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=zo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=zo){return this.instances.has(e)}getOptions(e=zo){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:yW(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=zo){return this.component?this.component.multipleInstances?e:zo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function yW(n){return n===zo?void 0:n}function vW(n){return n.instantiationMode==="EAGER"}var Ps=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Go(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var c0={};s$(c0,{FirebaseError:()=>vt,SDK_VERSION:()=>bn,_DEFAULT_ENTRY_NAME:()=>ui,_addComponent:()=>Hc,_addOrOverwriteComponent:()=>s0,_apps:()=>Ms,_clearComponents:()=>o9,_components:()=>$c,_getProvider:()=>qc,_isFirebaseApp:()=>d1,_isFirebaseServerApp:()=>pt,_registerComponent:()=>In,_removeServiceInstance:()=>u1,_serverApps:()=>jc,deleteApp:()=>eg,getApp:()=>xd,getApps:()=>l9,initializeApp:()=>Zm,initializeServerApp:()=>c9,onLog:()=>o0,registerVersion:()=>Tt,setLogLevel:()=>a0});var WI=[],Ee=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(Ee||{}),JM={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},wW=Ee.INFO,EW={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},IW=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=EW[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},$n=class{constructor(e){this.name=e,this._logLevel=wW,this._logHandler=IW,this._userLogHandler=null,WI.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?JM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}};function XM(n){WI.forEach(e=>{e.setLogLevel(n)})}function ZM(n,e){for(let t of WI){let r=null;e&&e.level&&(r=JM[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:Ee[s].toLowerCase(),message:a,args:o,type:i.name})}}}var bW=(n,e)=>e.some(t=>n instanceof t),e1,t1;function CW(){return e1||(e1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function TW(){return t1||(t1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var n1=new WeakMap,QI=new WeakMap,r1=new WeakMap,KI=new WeakMap,JI=new WeakMap;function SW(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(li(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&n1.set(t,n)}).catch(()=>{}),JI.set(e,n),e}function DW(n){if(QI.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});QI.set(n,e)}var YI={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return QI.get(n);if(e==="objectStoreNames")return n.objectStoreNames||r1.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return li(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function i1(n){YI=n(YI)}function AW(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Ym(this),e,...t);return r1.set(r,e.sort?e.sort():[e]),li(r)}:TW().includes(n)?function(...e){return n.apply(Ym(this),e),li(n1.get(this))}:function(...e){return li(n.apply(Ym(this),e))}}function xW(n){return typeof n=="function"?AW(n):(n instanceof IDBTransaction&&DW(n),bW(n,CW())?new Proxy(n,YI):n)}function li(n){if(n instanceof IDBRequest)return SW(n);if(KI.has(n))return KI.get(n);let e=xW(n);return e!==n&&(KI.set(n,e),JI.set(e,n)),e}var Ym=n=>JI.get(n);function o1(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=li(o);return r&&o.addEventListener("upgradeneeded",c=>{r(li(o.result),c.oldVersion,c.newVersion,li(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var RW=["get","getKey","getAll","getAllKeys","count"],NW=["put","add","delete","clear"],XI=new Map;function s1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(XI.get(e))return XI.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=NW.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||RW.includes(t)))return;let s=function(o,...a){return g(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return XI.set(e,s),s}i1(n=>lt(z({},n),{get:(e,t,r)=>s1(e,t)||n.get(e,t,r),has:(e,t)=>!!s1(e,t)||n.has(e,t)}));var e0=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(kW(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function kW(n){let e=n.getComponent();return e?.type==="VERSION"}var Jm="@firebase/app",t0="0.10.5";var Wo=new $n("@firebase/app"),PW="@firebase/app-compat",MW="@firebase/analytics-compat",OW="@firebase/analytics",FW="@firebase/app-check-compat",LW="@firebase/app-check",VW="@firebase/auth",UW="@firebase/auth-compat",BW="@firebase/database",jW="@firebase/database-compat",$W="@firebase/functions",HW="@firebase/functions-compat",qW="@firebase/installations",zW="@firebase/installations-compat",GW="@firebase/messaging",WW="@firebase/messaging-compat",KW="@firebase/performance",QW="@firebase/performance-compat",YW="@firebase/remote-config",JW="@firebase/remote-config-compat",XW="@firebase/storage",ZW="@firebase/storage-compat",e9="@firebase/firestore",t9="@firebase/vertexai-preview",n9="@firebase/firestore-compat",r9="firebase",i9="10.12.2";var ui="[DEFAULT]",s9={[Jm]:"fire-core",[PW]:"fire-core-compat",[OW]:"fire-analytics",[MW]:"fire-analytics-compat",[LW]:"fire-app-check",[FW]:"fire-app-check-compat",[VW]:"fire-auth",[UW]:"fire-auth-compat",[BW]:"fire-rtdb",[jW]:"fire-rtdb-compat",[$W]:"fire-fn",[HW]:"fire-fn-compat",[qW]:"fire-iid",[zW]:"fire-iid-compat",[GW]:"fire-fcm",[WW]:"fire-fcm-compat",[KW]:"fire-perf",[QW]:"fire-perf-compat",[YW]:"fire-rc",[JW]:"fire-rc-compat",[XW]:"fire-gcs",[ZW]:"fire-gcs-compat",[e9]:"fire-fst",[n9]:"fire-fst-compat",[t9]:"fire-vertex","fire-js":"fire-js",[r9]:"fire-js-all"};var Ms=new Map,jc=new Map,$c=new Map;function Hc(n,e){try{n.container.addComponent(e)}catch(t){Wo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function s0(n,e){n.container.addOrOverwriteComponent(e)}function In(n){let e=n.name;if($c.has(e))return Wo.debug(`There were multiple attempts to register component ${e}.`),!1;$c.set(e,n);for(let t of Ms.values())Hc(t,n);for(let t of jc.values())Hc(t,n);return!0}function qc(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function u1(n,e,t=ui){qc(n,e).clearInstance(t)}function d1(n){return n.options!==void 0}function pt(n){return n.settings!==void 0}function o9(){$c.clear()}var a9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yr=new _r("app","Firebase",a9);var Xm=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Qe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yr.create("app-deleted",{appName:this._name})}};var n0=class extends Xm{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Tt(Jm,t0,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){eg(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw yr.create("server-app-deleted")}};var bn=i9;function Zm(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:ui,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw yr.create("bad-app-name",{appName:String(i)});if(t||(t=qI()),!t)throw yr.create("no-options");let s=Ms.get(i);if(s){if(Ns(t,s.options)&&Ns(r,s.config))return s;throw yr.create("duplicate-app",{appName:i})}let o=new Ps(i);for(let c of $c.values())o.addComponent(c);let a=new Xm(t,r,o);return Ms.set(i,a),a}function c9(n,e){if(Gm())throw yr.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;d1(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=l=>[...l].reduce((d,h)=>Math.imul(31,d)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw yr.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=jc.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new Ps(s);for(let l of $c.values())a.addComponent(l);let c=new n0(t,e,s,a);return jc.set(s,c),c}function xd(n=ui){let e=Ms.get(n);if(!e&&n===ui&&qI())return Zm();if(!e)throw yr.create("no-app",{appName:n});return e}function l9(){return Array.from(Ms.values())}function eg(n){return g(this,null,function*(){let e=!1,t=n.name;Ms.has(t)?(e=!0,Ms.delete(t)):jc.has(t)&&n.decRefCount()<=0&&(jc.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function Tt(n,e,t){var r;let i=(r=s9[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Wo.warn(a.join(" "));return}In(new Qe(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function o0(n,e){if(n!==null&&typeof n!="function")throw yr.create("invalid-log-argument");ZM(n,e)}function a0(n){XM(n)}var u9="firebase-heartbeat-database",d9=1,Ad="firebase-heartbeat-store",ZI=null;function h1(){return ZI||(ZI=o1(u9,d9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ad)}catch(t){console.warn(t)}}}}).catch(n=>{throw yr.create("idb-open",{originalErrorMessage:n.message})})),ZI}function h9(n){return g(this,null,function*(){try{let t=(yield h1()).transaction(Ad),r=yield t.objectStore(Ad).get(f1(n));return yield t.done,r}catch(e){if(e instanceof vt)Wo.warn(e.message);else{let t=yr.create("idb-get",{originalErrorMessage:e?.message});Wo.warn(t.message)}}})}function a1(n,e){return g(this,null,function*(){try{let r=(yield h1()).transaction(Ad,"readwrite");yield r.objectStore(Ad).put(e,f1(n)),yield r.done}catch(t){if(t instanceof vt)Wo.warn(t.message);else{let r=yr.create("idb-set",{originalErrorMessage:t?.message});Wo.warn(r.message)}}})}function f1(n){return`${n.name}!${n.options.appId}`}var f9=1024,p9=30*24*60*60*1e3,r0=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new i0(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return g(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=c1();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=p9}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return g(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=c1(),{heartbeatsToSend:r,unsentEntries:i}=m9(this._heartbeatsCache.heartbeats),s=bd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function c1(){return new Date().toISOString().substring(0,10)}function m9(n,e=f9){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),l1(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),l1(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var i0=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return xs()?GM().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield h9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return a1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return a1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function l1(n){return bd(JSON.stringify({version:2,heartbeats:n})).length}function g9(n){In(new Qe("platform-logger",e=>new e0(e),"PRIVATE")),In(new Qe("heartbeat",e=>new r0(e),"PRIVATE")),Tt(Jm,t0,n),Tt(Jm,t0,"esm2017"),Tt("fire-js","")}g9("");var l0=class{constructor(e,t){this._delegate=e,this.firebase=t,Hc(e,new Qe("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),eg(this._delegate)))}_getService(e,t=ui){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=ui){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Hc(this._delegate,e)}_addOrOverwriteComponent(e){s0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var _9={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},p1=new _r("app-compat","Firebase",_9);function y9(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Tt,setLogLevel:a0,onLog:o0,apps:null,SDK_VERSION:bn,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:c0}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||ui,!En(e,l))throw p1.create("no-app",{appName:l});return e[l]}i.App=n;function s(l,d={}){let h=Zm(l,d);if(En(e,h.name))return e[h.name];let p=new n(h,t);return e[h.name]=p,p}function o(){return Object.keys(e).map(l=>e[l])}function a(l){let d=l.name,h=d.replace("-compat","");if(In(l)&&l.type==="PUBLIC"){let p=(_=i())=>{if(typeof _[h]!="function")throw p1.create("invalid-app-argument",{appName:d});return _[h]()};l.serviceProps!==void 0&&Lc(p,l.serviceProps),t[h]=p,n.prototype[h]=function(..._){return this._getService.bind(this,d).apply(this,l.multipleInstances?_:[])}}return l.type==="PUBLIC"?t[h]:null}function c(l,d){return d==="serverAuth"?null:d}return t}function g1(){let n=y9(l0);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:g1,extendNamespace:e,createSubscribe:Qm,ErrorFactory:_r,deepExtend:Lc});function e(t){Lc(n,t)}return n}var v9=g1();var m1=new $n("@firebase/app-compat"),w9="@firebase/app-compat",E9="0.2.35";function I9(n){Tt(w9,E9,n)}if(Gm()&&self.firebase!==void 0){m1.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);let n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&m1.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var F=v9;I9();var Zo={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var Us={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function b9(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function k1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var B0=b9,P1=k1,M1=new _r("auth","Firebase",k1());var ig=new $n("@firebase/auth");function C9(n,...e){ig.logLevel<=Ee.WARN&&ig.warn(`Auth (${bn}): ${n}`,...e)}function ng(n,...e){ig.logLevel<=Ee.ERROR&&ig.error(`Auth (${bn}): ${n}`,...e)}function Mt(n,...e){throw $0(n,...e)}function Pt(n,...e){return $0(n,...e)}function j0(n,e,t){let r=Object.assign(Object.assign({},P1()),{[e]:t});return new _r("auth","Firebase",r).create(e,{appName:n.name})}function Gt(n){return j0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Wc(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Mt(n,"argument-error"),j0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function $0(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return M1.create(n,...e)}function $(n,e,...t){if(!n)throw $0(e,...t)}function di(n){let e="INTERNAL ASSERTION FAILED: "+n;throw ng(e),new Error(e)}function vr(n,e){n||di(e)}function Md(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function H0(){return _1()==="http:"||_1()==="https:"}function _1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function T9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(H0()||Wm()||"connection"in navigator)?navigator.onLine:!0}function S9(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Ko=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,vr(t>e,"Short delay should be less than long delay!"),this.isMobile=Td()||qo()}get(){return T9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function q0(n,e){vr(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Od=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;di("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;di("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;di("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var D9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var A9=new Ko(3e4,6e4);function wt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Et(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){return O1(n,i,()=>g(this,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let h=Wi(Object.assign({key:n.config.apiKey},d)).slice(1),p=yield n._getAdditionalHeaders();return p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode),Od.fetch()(F1(n,n.config.apiHost,t,h),Object.assign({method:e,headers:p,referrerPolicy:"no-referrer"},l))}))})}function O1(n,e,t){return g(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},D9),e);try{let i=new p0(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Rd(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Rd(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Rd(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Rd(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw j0(n,d,l);Mt(n,d)}}catch(i){if(i instanceof vt)throw i;Mt(n,"network-request-failed",{message:String(i)})}})}function Yi(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){let l=yield Et(n,e,t,r,i);return"mfaPendingCredential"in l&&Mt(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function F1(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?q0(n.config,i):`${n.config.apiScheme}://${i}`}function x9(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var p0=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Pt(this.auth,"network-request-failed")),A9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Rd(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Pt(n,e,r);return i.customData._tokenResponse=t,i}function y1(n){return n!==void 0&&n.getResponse!==void 0}function v1(n){return n!==void 0&&n.enterprise!==void 0}var m0=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return x9(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function R9(n){return g(this,null,function*(){return(yield Et(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})}function N9(n,e){return g(this,null,function*(){return Et(n,"GET","/v2/recaptchaConfig",wt(n,e))})}function k9(n,e){return g(this,null,function*(){return Et(n,"POST","/v1/accounts:delete",e)})}function P9(n,e){return g(this,null,function*(){return Et(n,"POST","/v1/accounts:update",e)})}function L1(n,e){return g(this,null,function*(){return Et(n,"POST","/v1/accounts:lookup",e)})}function Nd(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function V1(n,e=!1){return g(this,null,function*(){let t=K(n),r=yield t.getIdToken(e),i=mg(r);$(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Nd(u0(i.auth_time)),issuedAtTime:Nd(u0(i.iat)),expirationTime:Nd(u0(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function u0(n){return Number(n)*1e3}function mg(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ng("JWT malformed, contained fewer than 3 sections"),null;try{let i=Cd(t);return i?JSON.parse(i):(ng("Failed to decode base64 JWT payload"),null)}catch(i){return ng("Caught error parsing JWT payload as JSON",i?.toString()),null}}function w1(n){let e=mg(n);return $(e,"internal-error"),$(typeof e.exp<"u","internal-error"),$(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Qi(n,e,t=!1){return g(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof vt&&M9(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function M9({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var g0=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Fd=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nd(this.lastLoginAt),this.creationTime=Nd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Ld(n){return g(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Qi(n,L1(t,{idToken:r}));$(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?B1(s.providerUserInfo):[],a=O9(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,d=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Fd(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,h)})}function U1(n){return g(this,null,function*(){let e=K(n);yield Ld(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function O9(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function B1(n){return n.map(e=>{var{providerId:t}=e,r=Jf(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function F9(n,e){return g(this,null,function*(){let t=yield O1(n,{},()=>g(this,null,function*(){let r=Wi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=F1(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Od.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function L9(n,e){return g(this,null,function*(){return Et(n,"POST","/v2/accounts:revokeToken",wt(n,e))})}var kd=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$(e.idToken,"internal-error"),$(typeof e.idToken<"u","internal-error"),$(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):w1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$(e.length!==0,"internal-error");let t=w1(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return g(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield F9(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&($(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&($(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&($(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return di("not implemented")}};function Os(n,e){$(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Qo=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Jf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new g0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Fd(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let t=yield Qi(this,this.stsTokenManager.getToken(this.auth,e));return $(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return V1(this,e)}reload(){return U1(this)}_assign(e){this!==e&&($(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Ld(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(pt(this.auth.app))return Promise.reject(Gt(this.auth));let e=yield this.getIdToken();return yield Qi(this,k9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,d;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=t.photoURL)!==null&&o!==void 0?o:void 0,A=(a=t.tenantId)!==null&&a!==void 0?a:void 0,R=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,V=(l=t.createdAt)!==null&&l!==void 0?l:void 0,J=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:H,emailVerified:ee,isAnonymous:de,providerData:re,stsTokenManager:S}=t;$(H&&S,e,"internal-error");let I=kd.fromJSON(this.name,S);$(typeof H=="string",e,"internal-error"),Os(h,e.name),Os(p,e.name),$(typeof ee=="boolean",e,"internal-error"),$(typeof de=="boolean",e,"internal-error"),Os(_,e.name),Os(E,e.name),Os(A,e.name),Os(R,e.name),Os(V,e.name),Os(J,e.name);let C=new n({uid:H,auth:e,email:p,emailVerified:ee,displayName:h,isAnonymous:de,photoURL:E,phoneNumber:_,tenantId:A,stsTokenManager:I,createdAt:V,lastLoginAt:J});return re&&Array.isArray(re)&&(C.providerData=re.map(D=>Object.assign({},D))),R&&(C._redirectEventId=R),C}static _fromIdTokenResponse(e,t,r=!1){return g(this,null,function*(){let i=new kd;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Ld(s),s})}static _fromGetAccountInfoResponse(e,t,r){return g(this,null,function*(){let i=t.users[0];$(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?B1(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new kd;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Fd(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var E1=new Map;function hn(n){vr(n instanceof Function,"Expected a class definition");let e=E1.get(n);return e?(vr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,E1.set(n,e),e)}var V9=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(t,r){return g(this,null,function*(){this.storage[t]=r})}_get(t){return g(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return g(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Ls=V9;function hi(n,e,t){return`firebase:${n}:${e}:${t}`}var sg=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=hi(this.userKey,i.apiKey,s),this.fullPersistenceKey=hi("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Qo._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return g(this,null,function*(){if(!t.length)return new n(hn(Ls),e,r);let i=(yield Promise.all(t.map(l=>g(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||hn(Ls),o=hi(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let d=yield l._get(o);if(d){let h=Qo._fromJSON(e,d);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>g(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,r))})}};function I1(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(H1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(j1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(q1(e))return"Blackberry";if(z1(e))return"Webos";if(z0(e))return"Safari";if((e.includes("chrome/")||$1(e))&&!e.includes("edge/"))return"Chrome";if(Kc(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function j1(n=Xe()){return/firefox\//i.test(n)}function z0(n=Xe()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function $1(n=Xe()){return/crios\//i.test(n)}function H1(n=Xe()){return/iemobile/i.test(n)}function Kc(n=Xe()){return/android/i.test(n)}function q1(n=Xe()){return/blackberry/i.test(n)}function z1(n=Xe()){return/webos/i.test(n)}function ea(n=Xe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function G1(n=Xe()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function U9(n=Xe()){var e;return ea(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function B9(){return Km()&&document.documentMode===10}function W1(n=Xe()){return ea(n)||Kc(n)||z1(n)||q1(n)||/windows phone/i.test(n)||H1(n)}function j9(){try{return!!(window&&window!==window.top)}catch{return!1}}function G0(n,e=[]){let t;switch(n){case"Browser":t=I1(Xe());break;case"Worker":t=`${I1(Xe())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${bn}/${r}`}var _0=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function $9(t){return g(this,arguments,function*(n,e={}){return Et(n,"GET","/v2/passwordPolicy",wt(n,e))})}var H9=6,y0=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:H9,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var og=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ag(this),this.idTokenSubscription=new ag(this),this.beforeStateQueue=new _0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=M1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=hn(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield sg.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let t=yield L1(this,{idToken:e}),r=yield Qo._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var t;if(pt(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield Ld(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=S9()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(pt(this.app))return Promise.reject(Gt(this));let t=e?K(e):null;return t&&$(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&$(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return pt(this.app)?Promise.reject(Gt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return pt(this.app)?Promise.reject(Gt(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(hn(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield $9(this),t=new y0(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new _r("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield L9(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&hn(e)||this._popupRedirectResolver;$(t,this,"argument-error"),this.redirectPersistenceManager=yield sg.create(this,[hn(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if($(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=G0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return g(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&C9(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function ot(n){return K(n)}var ag=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Qm(t=>this.observer=t)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Wd={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function q9(n){Wd=n}function W0(n){return Wd.loadJS(n)}function z9(){return Wd.recaptchaV2Script}function G9(){return Wd.recaptchaEnterpriseScript}function W9(){return Wd.gapiScript}function K1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var K9="recaptcha-enterprise",Q9="NO_RECAPTCHA",v0=class{constructor(e){this.type=K9,this.auth=ot(e)}verify(e="verify",t=!1){return g(this,null,function*(){function r(s){return g(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>g(this,null,function*(){N9(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let l=new m0(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;v1(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(Q9)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&v1(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=G9();c.length!==0&&(c+=a),W0(c).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})})}};function b1(n,e,t,r=!1){return g(this,null,function*(){let i=new v0(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function Vd(n,e,t,r){return g(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield b1(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>g(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield b1(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function Y9(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(hn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function K0(n,e,t){let r=ot(n);$(r._canInitEmulator,r,"emulator-config-failed"),$(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Q1(e),{host:o,port:a}=J9(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||X9()}function Q1(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function J9(n){let e=Q1(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:C1(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:C1(o)}}}function C1(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function X9(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var fi=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return di("not implemented")}_getIdTokenResponse(e){return di("not implemented")}_linkToIdToken(e,t){return di("not implemented")}_getReauthenticationResolver(e){return di("not implemented")}};function Y1(n,e){return g(this,null,function*(){return Et(n,"POST","/v1/accounts:resetPassword",wt(n,e))})}function Z9(n,e){return g(this,null,function*(){return Et(n,"POST","/v1/accounts:update",e)})}function e6(n,e){return g(this,null,function*(){return Et(n,"POST","/v1/accounts:signUp",e)})}function t6(n,e){return g(this,null,function*(){return Et(n,"POST","/v1/accounts:update",wt(n,e))})}function n6(n,e){return g(this,null,function*(){return Yi(n,"POST","/v1/accounts:signInWithPassword",wt(n,e))})}function gg(n,e){return g(this,null,function*(){return Et(n,"POST","/v1/accounts:sendOobCode",wt(n,e))})}function r6(n,e){return g(this,null,function*(){return gg(n,e)})}function i6(n,e){return g(this,null,function*(){return gg(n,e)})}function s6(n,e){return g(this,null,function*(){return gg(n,e)})}function o6(n,e){return g(this,null,function*(){return gg(n,e)})}function a6(n,e){return g(this,null,function*(){return Yi(n,"POST","/v1/accounts:signInWithEmailLink",wt(n,e))})}function c6(n,e){return g(this,null,function*(){return Yi(n,"POST","/v1/accounts:signInWithEmailLink",wt(n,e))})}var Ud=class n extends fi{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return g(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vd(e,t,"signInWithPassword",n6);case"emailLink":return a6(e,{email:this._email,oobCode:this._password});default:Mt(e,"internal-error")}})}_linkToIdToken(e,t){return g(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vd(e,r,"signUpPassword",e6);case"emailLink":return c6(e,{idToken:t,email:this._email,oobCode:this._password});default:Mt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Ki(n,e){return g(this,null,function*(){return Yi(n,"POST","/v1/accounts:signInWithIdp",wt(n,e))})}var l6="http://localhost",Ur=class n extends fi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Mt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Jf(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return Ki(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Ki(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Ki(e,t)}buildRequest(){let e={requestUri:l6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Wi(t)}return e}};function u6(n,e){return g(this,null,function*(){return Et(n,"POST","/v1/accounts:sendVerificationCode",wt(n,e))})}function d6(n,e){return g(this,null,function*(){return Yi(n,"POST","/v1/accounts:signInWithPhoneNumber",wt(n,e))})}function h6(n,e){return g(this,null,function*(){let t=yield Yi(n,"POST","/v1/accounts:signInWithPhoneNumber",wt(n,e));if(t.temporaryProof)throw Rd(n,"account-exists-with-different-credential",t);return t})}var f6={USER_NOT_FOUND:"user-not-found"};function p6(n,e){return g(this,null,function*(){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Yi(n,"POST","/v1/accounts:signInWithPhoneNumber",wt(n,t),f6)})}var zc=class n extends fi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return d6(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return h6(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return p6(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function m6(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function g6(n){let e=ks(Bc(n)).link,t=e?ks(Bc(e)).deep_link_id:null,r=ks(Bc(n)).deep_link_id;return(r?ks(Bc(r)).link:null)||r||t||e||n}var Bd=class n{constructor(e){var t,r,i,s,o,a;let c=ks(Bc(e)),l=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=m6((i=c.mode)!==null&&i!==void 0?i:null);$(l&&d&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=g6(e);try{return new n(t)}catch{return null}}};var Kd=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Ud._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Bd.parseLink(r);return $(i,"argument-error"),Ud._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Br=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Vs=class extends Br{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},Gc=class n extends Vs{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return $("providerId"in t&&"signInMethod"in t,"argument-error"),Ur._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return $(e.idToken||e.accessToken,"argument-error"),Ur._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var _g=(()=>{class n extends Vs{constructor(){super("facebook.com")}static credential(t){return Ur._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.FACEBOOK_SIGN_IN_METHOD="facebook.com",n.PROVIDER_ID="facebook.com";return n})(),yg=(()=>{class n extends Vs{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Ur._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})(),vg=(()=>{class n extends Vs{constructor(){super("github.com")}static credential(t){return Ur._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.GITHUB_SIGN_IN_METHOD="github.com",n.PROVIDER_ID="github.com";return n})(),_6="http://localhost",Yo=class n extends fi{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return Ki(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Ki(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Ki(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:_6,returnSecureToken:!0,pendingToken:this.pendingToken}}};var y6="saml.",jd=class n extends Br{constructor(e){$(e.startsWith(y6),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=Yo.fromJSON(e);return $(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Yo._create(r,t)}catch{return null}}};var wg=(()=>{class n extends Vs{constructor(){super("twitter.com")}static credential(t,r){return Ur._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return n.credential(r,i)}catch{return null}}}n.TWITTER_SIGN_IN_METHOD="twitter.com",n.PROVIDER_ID="twitter.com";return n})();function J1(n,e){return g(this,null,function*(){return Yi(n,"POST","/v1/accounts:signUp",wt(n,e))})}var jr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return g(this,null,function*(){let s=yield Qo._fromIdTokenResponse(e,r,i),o=T1(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return g(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=T1(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function T1(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function Q0(n){return g(this,null,function*(){var e;if(pt(n.app))return Promise.reject(Gt(n));let t=ot(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new jr({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield J1(t,{returnSecureToken:!0}),i=yield jr._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var w0=class n extends vt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function X1(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?w0._fromErrorAndOperation(n,s,e,r):s})}function Z1(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}function Y0(n,e){return g(this,null,function*(){let t=K(n);yield Eg(!0,t,e);let{providerUserInfo:r}=yield P9(t.auth,{idToken:yield t.getIdToken(),deleteProvider:[e]}),i=Z1(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),yield t.auth._persistUserIfCurrent(t),t})}function J0(n,e,t=!1){return g(this,null,function*(){let r=yield Qi(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return jr._forOperation(n,"link",r)})}function Eg(n,e,t){return g(this,null,function*(){yield Ld(e);let r=Z1(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";$(r.has(t)===n,e.auth,i)})}function eO(n,e,t=!1){return g(this,null,function*(){let{auth:r}=n;if(pt(r.app))return Promise.reject(Gt(r));let i="reauthenticate";try{let s=yield Qi(n,X1(r,i,e,n),t);$(s.idToken,r,"internal-error");let o=mg(s.idToken);$(o,r,"internal-error");let{sub:a}=o;return $(n.uid===a,r,"user-mismatch"),jr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Mt(r,"user-mismatch"),s}})}function tO(n,e,t=!1){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Gt(n));let r="signIn",i=yield X1(n,r,e),s=yield jr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Qc(n,e){return g(this,null,function*(){return tO(ot(n),e)})}function Ig(n,e){return g(this,null,function*(){let t=K(n);return yield Eg(!1,t,e.providerId),J0(t,e)})}function bg(n,e){return g(this,null,function*(){return eO(K(n),e)})}function v6(n,e){return g(this,null,function*(){return Yi(n,"POST","/v1/accounts:signInWithCustomToken",wt(n,e))})}function X0(n,e){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Gt(n));let t=ot(n),r=yield v6(t,{token:e,returnSecureToken:!0}),i=yield jr._fromIdTokenResponse(t,"signIn",r);return yield t._updateCurrentUser(i.user),i})}var Jo=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?E0._fromServerResponse(e,t):"totpInfo"in t?I0._fromServerResponse(e,t):Mt(e,"internal-error")}},E0=class n extends Jo{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},I0=class n extends Jo{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function Cg(n,e,t){var r;$(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),$(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&($(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&($(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function Z0(n){return g(this,null,function*(){let e=ot(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function eb(n,e,t){return g(this,null,function*(){let r=ot(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Cg(r,i,t),yield Vd(r,i,"getOobCode",i6)})}function tb(n,e,t){return g(this,null,function*(){yield Y1(K(n),{oobCode:e,newPassword:t}).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Z0(n),r}))})}function nb(n,e){return g(this,null,function*(){yield t6(K(n),{oobCode:e})})}function Tg(n,e){return g(this,null,function*(){let t=K(n),r=yield Y1(t,{oobCode:e}),i=r.requestType;switch($(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":$(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":$(r.mfaInfo,t,"internal-error");default:$(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=Jo._fromServerResponse(ot(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}})}function rb(n,e){return g(this,null,function*(){let{data:t}=yield Tg(K(n),e);return t.email})}function ib(n,e,t){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Gt(n));let r=ot(n),o=yield Vd(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",J1).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Z0(n),c}),a=yield jr._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function sb(n,e,t){return pt(n.app)?Promise.reject(Gt(n)):Qc(K(n),Kd.credential(e,t)).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Z0(n),r}))}function ob(n,e,t){return g(this,null,function*(){let r=ot(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){$(a.handleCodeInApp,r,"argument-error"),a&&Cg(r,o,a)}s(i,t),yield Vd(r,i,"getOobCode",s6)})}function ab(n,e){let t=Bd.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}function cb(n,e,t){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Gt(n));let r=K(n),i=Kd.credentialWithLink(e,t||Md());return $(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Qc(r,i)})}function w6(n,e){return g(this,null,function*(){return Et(n,"POST","/v1/accounts:createAuthUri",wt(n,e))})}function lb(n,e){return g(this,null,function*(){let t=H0()?Md():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=yield w6(K(n),r);return i||[]})}function ub(n,e){return g(this,null,function*(){let t=K(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&Cg(t.auth,i,e);let{email:s}=yield r6(t.auth,i);s!==n.email&&(yield n.reload())})}function db(n,e,t){return g(this,null,function*(){let r=K(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield n.getIdToken(),newEmail:e};t&&Cg(r.auth,s,t);let{email:o}=yield o6(r.auth,s);o!==n.email&&(yield n.reload())})}function E6(n,e){return g(this,null,function*(){return Et(n,"POST","/v1/accounts:update",e)})}function hb(r,i){return g(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=K(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield Qi(s,E6(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let l=s.providerData.find(({providerId:d})=>d==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function fb(n,e){let t=K(n);return pt(t.auth.app)?Promise.reject(Gt(t.auth)):nO(t,e,null)}function pb(n,e){return nO(K(n),null,e)}function nO(n,e,t){return g(this,null,function*(){let{auth:r}=n,s={idToken:yield n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=yield Qi(n,Z9(r,s));yield n._updateTokensIfNecessary(o,!0)})}function I6(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=mg(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new Fs(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new b0(s,i);case"github.com":return new C0(s,i);case"google.com":return new T0(s,i);case"twitter.com":return new S0(s,i,n.screenName||null);case"custom":case"anonymous":return new Fs(s,null);default:return new Fs(s,r,i)}}var Fs=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},cg=class extends Fs{constructor(e,t,r,i){super(e,t,r),this.username=i}},b0=class extends Fs{constructor(e,t){super(e,"facebook.com",t)}},C0=class extends cg{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},T0=class extends Fs{constructor(e,t){super(e,"google.com",t)}},S0=class extends cg{constructor(e,t,r){super(e,"twitter.com",t,r)}};function mb(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:I6(t)}var lg=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var D0=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=ot(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>Jo._fromServerResponse(r,a));$(i.mfaPendingCredential,r,"internal-error");let o=lg._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,a=>g(this,null,function*(){let c=yield a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let l=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let d=yield jr._fromIdTokenResponse(r,t.operationType,l);return yield r._updateCurrentUser(d.user),d;case"reauthenticate":return $(t.user,r,"internal-error"),jr._forOperation(t.user,t.operationType,l);default:Mt(r,"internal-error")}}))}resolveSignIn(e){return g(this,null,function*(){let t=e;return this.signInResolver(t)})}};function gb(n,e){var t;let r=K(n),i=e;return $(e.customData.operationType,r,"argument-error"),$((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),D0._fromError(r,i)}function b6(n,e){return Et(n,"POST","/v2/accounts/mfaEnrollment:start",wt(n,e))}function C6(n,e){return Et(n,"POST","/v2/accounts/mfaEnrollment:finalize",wt(n,e))}function T6(n,e){return Et(n,"POST","/v2/accounts/mfaEnrollment:withdraw",wt(n,e))}var A0=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Jo._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}getSession(){return g(this,null,function*(){return lg._fromIdtoken(yield this.user.getIdToken(),this.user)})}enroll(e,t){return g(this,null,function*(){let r=e,i=yield this.getSession(),s=yield Qi(this.user,r._process(this.user.auth,i,t));return yield this.user._updateTokensIfNecessary(s),this.user.reload()})}unenroll(e){return g(this,null,function*(){let t=typeof e=="string"?e:e.uid,r=yield this.user.getIdToken();try{let i=yield Qi(this.user,T6(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),yield this.user._updateTokensIfNecessary(i),yield this.user.reload()}catch(i){throw i}})}},d0=new WeakMap;function _b(n){let e=K(n);return d0.has(e)||d0.set(e,A0._fromUser(e)),d0.get(e)}var ug="__sak";var dg=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ug,"1"),this.storage.removeItem(ug),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function S6(){let n=Xe();return z0(n)||ea(n)}var D6=1e3,A6=10,x6=(()=>{class n extends dg{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=S6()&&j9(),this.fallbackToPolling=W1(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(i);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);B9()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,A6):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},D6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return g(this,null,function*(){yield Qr(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return g(this,null,function*(){let r=yield Qr(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return g(this,null,function*(){yield Qr(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Yc=x6;var R6=(()=>{class n extends dg{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),pi=R6;function N6(n){return Promise.all(n.map(e=>g(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var k6=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return g(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>g(this,null,function*(){return d(r.origin,o)})),l=yield N6(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function ta(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var x0=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return g(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=ta("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let p=h;if(p.data.eventId===l)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function kt(){return window}function P6(n){kt().location.href=n}function yb(){return typeof kt().WorkerGlobalScope<"u"&&typeof kt().importScripts=="function"}function M6(){return g(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function O6(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function F6(){return yb()?self:null}var rO="firebaseLocalStorageDb",L6=1,hg="firebaseLocalStorage",iO="fbase_key",Xo=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Sg(n,e){return n.transaction([hg],e?"readwrite":"readonly").objectStore(hg)}function V6(){let n=indexedDB.deleteDatabase(rO);return new Xo(n).toPromise()}function R0(){let n=indexedDB.open(rO,L6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(hg,{keyPath:iO})}catch(i){t(i)}}),n.addEventListener("success",()=>g(this,null,function*(){let r=n.result;r.objectStoreNames.contains(hg)?e(r):(r.close(),yield V6(),e(yield R0()))}))})}function S1(n,e,t){return g(this,null,function*(){let r=Sg(n,!0).put({[iO]:e,value:t});return new Xo(r).toPromise()})}function U6(n,e){return g(this,null,function*(){let t=Sg(n,!1).get(e),r=yield new Xo(t).toPromise();return r===void 0?null:r.value})}function D1(n,e){let t=Sg(n,!0).delete(e);return new Xo(t).toPromise()}var B6=800,j6=3,$6=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db?this.db:(this.db=yield R0(),this.db)})}_withRetries(t){return g(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>j6)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return yb()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=k6._getInstance(F6()),this.receiver._subscribe("keyChanged",(t,r)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var t,r;if(this.activeServiceWorker=yield M6(),!this.activeServiceWorker)return;this.sender=new x0(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return g(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||O6()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;let t=yield R0();return yield S1(t,ug,"1"),yield D1(t,ug),!0}catch{}return!1})}_withPendingWrite(t){return g(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(i=>S1(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return g(this,null,function*(){let r=yield this._withRetries(i=>U6(i,t));return this.localCache[t]=r,r})}_remove(t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(r=>D1(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return g(this,null,function*(){let t=yield this._withRetries(s=>{let o=Sg(s,!1).getAll();return new Xo(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),B6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),na=$6;function H6(n,e){return Et(n,"POST","/v2/accounts/mfaSignIn:start",wt(n,e))}function q6(n,e){return Et(n,"POST","/v2/accounts/mfaSignIn:finalize",wt(n,e))}var z6=500,G6=6e4,tg=1e12,N0=class{constructor(e){this.auth=e,this.counter=tg,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new k0(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||tg;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||tg;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}execute(e){return g(this,null,function*(){var t;let r=e||tg;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""})}},k0=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;$(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=W6(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},G6)},z6))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function W6(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var h0=K1("rcb"),K6=new Ko(3e4,6e4),P0=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=kt().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return $(Q6(t),e,"argument-error"),this.shouldResolveImmediately(t)&&y1(kt().grecaptcha)?Promise.resolve(kt().grecaptcha):new Promise((r,i)=>{let s=kt().setTimeout(()=>{i(Pt(e,"network-request-failed"))},K6.get());kt()[h0]=()=>{kt().clearTimeout(s),delete kt()[h0];let a=kt().grecaptcha;if(!a||!y1(a)){i(Pt(e,"internal-error"));return}let c=a.render;a.render=(l,d)=>{let h=c(l,d);return this.counter++,h},this.hostLanguage=t,r(a)};let o=`${z9()}?${Wi({onload:h0,render:"explicit",hl:t})}`;W0(o).catch(()=>{clearTimeout(s),i(Pt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=kt().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function Q6(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var M0=class{load(e){return g(this,null,function*(){return new N0(e)})}clearedOneInstance(){}};var sO="recaptcha",Y6={theme:"light",type:"image"},$d=class{constructor(e,t,r=Object.assign({},Y6)){this.parameters=r,this.type=sO,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=ot(e),this.isInvisible=this.parameters.size==="invisible",$(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;$(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new M0:new P0,this.validateStartingState()}verify(){return g(this,null,function*(){this.assertNotDestroyed();let e=yield this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){$(!this.parameters.sitekey,this.auth,"argument-error"),$(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),$(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=kt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){$(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){return g(this,null,function*(){if(yield this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId})}init(){return g(this,null,function*(){$(H0()&&!yb(),this.auth,"internal-error"),yield J6(),this.recaptcha=yield this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=yield R9(this.auth);$(e,this.auth,"internal-error"),this.parameters.sitekey=e})}getAssertedRecaptcha(){return $(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function J6(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var Hd=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=zc._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};function vb(n,e,t){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Gt(n));let r=ot(n),i=yield Dg(r,e,K(t));return new Hd(i,s=>Qc(r,s))})}function wb(n,e,t){return g(this,null,function*(){let r=K(n);yield Eg(!1,r,"phone");let i=yield Dg(r.auth,e,K(t));return new Hd(i,s=>Ig(r,s))})}function Eb(n,e,t){return g(this,null,function*(){let r=K(n);if(pt(r.auth.app))return Promise.reject(Gt(r.auth));let i=yield Dg(r.auth,e,K(t));return new Hd(i,s=>bg(r,s))})}function Dg(n,e,t){return g(this,null,function*(){var r;let i=yield t.verify();try{$(typeof i=="string",n,"argument-error"),$(t.type===sO,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return $(o.type==="enroll",n,"internal-error"),(yield b6(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{$(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return $(a,n,"missing-multi-factor-info"),(yield H6(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=yield u6(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}})}function Ib(n,e){return g(this,null,function*(){let t=K(n);if(pt(t.auth.app))return Promise.reject(Gt(t.auth));yield J0(t,e)})}var ra=(()=>{class n{constructor(t){this.providerId=n.PROVIDER_ID,this.auth=ot(t)}verifyPhoneNumber(t,r){return Dg(this.auth,t,K(r))}static credential(t,r){return zc._fromVerification(t,r)}static credentialFromResult(t){let r=t;return n.credentialFromTaggedObject(r)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{phoneNumber:r,temporaryProof:i}=t;return r&&i?zc._fromTokenResponse(r,i):null}}n.PROVIDER_ID="phone",n.PHONE_SIGN_IN_METHOD="phone";return n})();function ia(n,e){return e?hn(e):($(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var qd=class extends fi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ki(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ki(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ki(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function X6(n){return tO(n.auth,new qd(n),n.bypassAuthState)}function Z6(n){let{auth:e,user:t}=n;return $(t,e,"internal-error"),eO(t,new qd(n),n.bypassAuthState)}function e8(n){return g(this,null,function*(){let{auth:e,user:t}=n;return $(t,e,"internal-error"),J0(t,new qd(n),n.bypassAuthState)})}var fg=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return g(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return X6;case"linkViaPopup":case"linkViaRedirect":return e8;case"reauthViaPopup":case"reauthViaRedirect":return Z6;default:Mt(this.auth,"internal-error")}}resolve(e){vr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){vr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var t8=new Ko(2e3,1e4);function bb(n,e,t){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Pt(n,"operation-not-supported-in-this-environment"));let r=ot(n);Wc(n,e,Br);let i=ia(r,t);return new Sb(r,"signInViaPopup",e,i).executeNotNull()})}function Cb(n,e,t){return g(this,null,function*(){let r=K(n);if(pt(r.auth.app))return Promise.reject(Pt(r.auth,"operation-not-supported-in-this-environment"));Wc(r.auth,e,Br);let i=ia(r.auth,t);return new Sb(r.auth,"reauthViaPopup",e,i,r).executeNotNull()})}function Tb(n,e,t){return g(this,null,function*(){let r=K(n);Wc(r.auth,e,Br);let i=ia(r.auth,t);return new Sb(r.auth,"linkViaPopup",e,i,r).executeNotNull()})}var Sb=(()=>{class n extends fg{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return g(this,null,function*(){let t=yield this.execute();return $(t,this.auth,"internal-error"),t})}onExecution(){return g(this,null,function*(){vr(this.filter.length===1,"Popup operations only handle one event");let t=ta();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Pt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Pt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Pt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,t8.get())};t()}}n.currentPopupAction=null;return n})(),n8="pendingRedirect",Pd=new Map,O0=class n extends fg{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return g(this,null,function*(){let e=Pd.get(this.auth._key());if(!e){try{let r=(yield r8(this.resolver,this.auth))?yield Qr(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Pd.set(this.auth._key(),e)}return this.bypassAuthState||Pd.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if(e.type==="signInViaRedirect")return Qr(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Qr(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return g(this,null,function*(){})}cleanUp(){}};function r8(n,e){return g(this,null,function*(){let t=cO(e),r=aO(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Db(n,e){return g(this,null,function*(){return aO(n)._set(cO(e),"true")})}function oO(){Pd.clear()}function Jc(n,e){Pd.set(n._key(),e)}function aO(n){return hn(n._redirectPersistence)}function cO(n){return hi(n8,n.config.apiKey,n.name)}function Ab(n,e,t){return i8(n,e,t)}function i8(n,e,t){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Gt(n));let r=ot(n);Wc(n,e,Br),yield r._initializationPromise;let i=ia(r,t);return yield Db(i,r),i._openRedirect(r,e,"signInViaRedirect")})}function xb(n,e,t){return s8(n,e,t)}function s8(n,e,t){return g(this,null,function*(){let r=K(n);if(Wc(r.auth,e,Br),pt(r.auth.app))return Promise.reject(Gt(r.auth));yield r.auth._initializationPromise;let i=ia(r.auth,t);yield Db(i,r.auth);let s=yield lO(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)})}function Rb(n,e,t){return o8(n,e,t)}function o8(n,e,t){return g(this,null,function*(){let r=K(n);Wc(r.auth,e,Br),yield r.auth._initializationPromise;let i=ia(r.auth,t);yield Eg(!1,r,e.providerId),yield Db(i,r.auth);let s=yield lO(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)})}function Nb(n,e){return g(this,null,function*(){return yield ot(n)._initializationPromise,sa(n,e,!1)})}function sa(n,e,t=!1){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Gt(n));let r=ot(n),i=ia(r,e),o=yield new O0(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}function lO(n){return g(this,null,function*(){let e=ta(`${n.uid}:::`);return n._redirectEventId=e,yield n.auth._setRedirectUser(n),yield n.auth._persistUserIfCurrent(n),e})}var a8=10*60*1e3,zd=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!c8(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!uO(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Pt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=a8&&this.cachedEventUids.clear(),this.cachedEventUids.has(A1(e))}saveEventToCache(e){this.cachedEventUids.add(A1(e)),this.lastProcessedEventTime=Date.now()}};function A1(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function uO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function c8(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return uO(n);default:return!1}}function kb(t){return g(this,arguments,function*(n,e={}){return Et(n,"GET","/v1/projects",e)})}var l8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,u8=/^https?/;function d8(n){return g(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield kb(n);for(let t of e)try{if(h8(t))return}catch{}Mt(n,"unauthorized-domain")})}function h8(n){let e=Md(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!u8.test(t))return!1;if(l8.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var f8=new Ko(3e4,6e4);function x1(){let n=kt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function p8(n){return new Promise((e,t)=>{var r,i,s;function o(){x1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{x1(),t(Pt(n,"network-request-failed"))},timeout:f8.get()})}if(!((i=(r=kt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=kt().gapi)===null||s===void 0)&&s.load)o();else{let a=K1("iframefcb");return kt()[a]=()=>{gapi.load?o():t(Pt(n,"network-request-failed"))},W0(`${W9()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw rg=null,e})}var rg=null;function m8(n){return rg=rg||p8(n),rg}var g8=new Ko(5e3,15e3),_8="__/auth/iframe",y8="emulator/auth/iframe",v8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},w8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function E8(n){let e=n.config;$(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?q0(e,y8):`https://${n.config.authDomain}/${_8}`,r={apiKey:e.apiKey,appName:n.name,v:bn},i=w8.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Wi(r).slice(1)}`}function I8(n){return g(this,null,function*(){let e=yield m8(n),t=kt().gapi;return $(t,n,"internal-error"),e.open({where:document.body,url:E8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:v8,dontclear:!0},r=>new Promise((i,s)=>g(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=Pt(n,"network-request-failed"),a=kt().setTimeout(()=>{s(o)},g8.get());function c(){kt().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var b8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},C8=500,T8=600,S8="_blank",D8="http://localhost",Gd=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function A8(n,e,t,r=C8,i=T8){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},b8),{width:r.toString(),height:i.toString(),top:s,left:o}),l=Xe().toLowerCase();t&&(a=$1(l)?S8:t),j1(l)&&(e=e||D8,c.scrollbars="yes");let d=Object.entries(c).reduce((p,[_,E])=>`${p}${_}=${E},`,"");if(U9(l)&&a!=="_self")return x8(e||"",a),new Gd(null);let h=window.open(e||"",a,d);$(h,n,"popup-blocked");try{h.focus()}catch{}return new Gd(h)}function x8(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var R8="__/auth/handler",N8="emulator/auth/handler",k8=encodeURIComponent("fac");function pg(n,e,t,r,i,s){return g(this,null,function*(){$(n.config.authDomain,n,"auth-domain-config-required"),$(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:bn,eventId:i};if(e instanceof Br){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Uc(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(s||{}))o[d]=h}if(e instanceof Vs){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),l=c?`#${k8}=${encodeURIComponent(c)}`:"";return`${P8(n)}?${Wi(a).slice(1)}${l}`})}function P8({config:n}){return n.emulator?q0(n,N8):`https://${n.authDomain}/${R8}`}var f0="webStorageSupport",F0=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pi,this._completeRedirectFn=sa,this._overrideRedirectResult=Jc}_openPopup(e,t,r,i){return g(this,null,function*(){var s;vr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield pg(e,t,r,Md(),i);return A8(e,o,ta())})}_openRedirect(e,t,r,i){return g(this,null,function*(){yield this._originValidation(e);let s=yield pg(e,t,r,Md(),i);return P6(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(vr(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return g(this,null,function*(){let t=yield I8(e),r=new zd(e);return t.register("authEvent",i=>($(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(f0,{type:f0},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[f0];o!==void 0&&t(!!o),Mt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=d8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return W1()||z0()||ea()}},Pb=F0,L0=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return di("unexpected MultiFactorSessionType")}}},V0=class n extends L0{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return C6(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return q6(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},Mb=(()=>{class n{constructor(){}static assertion(t){return V0._fromCredential(t)}}return n.FACTOR_ID="phone",n})();var R1="@firebase/auth",N1="1.7.4";var U0=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function M8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function O8(n){In(new Qe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;$(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:G0(n)},l=new og(r,i,s,c);return Y9(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),In(new Qe("auth-internal",e=>{let t=ot(e.getProvider("auth").getImmediate());return(r=>new U0(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Tt(R1,N1,M8(n)),Tt(R1,N1,"esm2017")}var F8=5*60,Ece=zM("authIdTokenMaxAge")||F8;function L8(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}q9({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Pt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",L8().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});O8("Browser");function oa(){return window}var V8=2e3;function U8(n,e,t){return g(this,null,function*(){var r;let{BuildInfo:i}=oa();vr(e.sessionId,"AuthEvent did not contain a session ID");let s=yield q8(e.sessionId),o={};return ea()?o.ibi=i.packageName:Kc()?o.apn=i.packageName:Mt(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,pg(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)})}function B8(n){return g(this,null,function*(){let{BuildInfo:e}=oa(),t={};ea()?t.iosBundleId=e.packageName:Kc()?t.androidPackageName=e.packageName:Mt(n,"operation-not-supported-in-this-environment"),yield kb(n,t)})}function j8(n){let{cordova:e}=oa();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,G1()?"_blank":"_system","location=yes"),t(i)})})}function $8(n,e,t){return g(this,null,function*(){let{cordova:r}=oa(),i=()=>{};try{yield new Promise((s,o)=>{let a=null;function c(){var h;s();let p=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof p=="function"&&p(),typeof t?.close=="function"&&t.close()}function l(){a||(a=window.setTimeout(()=>{o(Pt(n,"redirect-cancelled-by-user"))},V8))}function d(){document?.visibilityState==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),Kc()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}})}function H8(n){var e,t,r,i,s,o,a,c,l,d;let h=oa();$(typeof((e=h?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),$(typeof((t=h?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),$(typeof((s=(i=(r=h?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),$(typeof((c=(a=(o=h?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),$(typeof((d=(l=h?.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function q8(n){return g(this,null,function*(){let e=z8(n),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")})}function z8(n){if(vr(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var G8=20,Ob=class extends zd{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}initialized(){return g(this,null,function*(){yield this.initPromise})}};function W8(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:Y8(),postBody:null,tenantId:n.tenantId,error:Pt(n,"no-auth-event")}}function K8(n,e){return Fb()._set(Lb(n),e)}function dO(n){return g(this,null,function*(){let e=yield Fb()._get(Lb(n));return e&&(yield Fb()._remove(Lb(n))),e})}function Q8(n,e){var t,r;let i=X8(e);if(i.includes("/__/auth/callback")){let s=Ag(i),o=s.firebaseError?J8(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?Pt(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function Y8(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<G8;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function Fb(){return hn(Yc)}function Lb(n){return hi("authEvent",n.config.apiKey,n.name)}function J8(n){try{return JSON.parse(n)}catch{return null}}function X8(n){let e=Ag(n),t=e.link?decodeURIComponent(e.link):void 0,r=Ag(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Ag(i).link||i||r||t||n}function Ag(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return ks(t.join("?"))}var Z8=500,Vb=class{constructor(){this._redirectPersistence=pi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=sa,this._overrideRedirectResult=Jc}_initialize(e){return g(this,null,function*(){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new Ob(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r})}_openPopup(e){Mt(e,"operation-not-supported-in-this-environment")}_openRedirect(e,t,r,i){return g(this,null,function*(){H8(e);let s=yield this._initialize(e);yield s.initialized(),s.resetRedirect(),oO(),yield this._originValidation(e);let o=W8(e,r,i);yield K8(e,o);let a=yield U8(e,o,t),c=yield j8(a);return $8(e,s,c)})}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=B8(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=oa(),o=setTimeout(()=>g(this,null,function*(){yield dO(e),t.onEvent(hO())}),Z8),a=d=>g(this,null,function*(){clearTimeout(o);let h=yield dO(e),p=null;h&&d?.url&&(p=Q8(h,d.url)),t.onEvent(p||hO())});typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,l=`${s.packageName.toLowerCase()}://`;oa().handleOpenURL=d=>g(this,null,function*(){if(d.toLowerCase().startsWith(l)&&a({url:d}),typeof c=="function")try{c(d)}catch(h){console.error(h)}})}},fO=Vb;function hO(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Pt("no-auth-event")}}function pO(n,e){ot(n)._logFramework(e)}var tK="@firebase/auth-compat",nK="0.5.9";var rK=1e3;function Jd(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function iK(){return Jd()==="http:"||Jd()==="https:"}function _O(n=Xe()){return!!((Jd()==="file:"||Jd()==="ionic:"||Jd()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function sK(){return qo()||zm()}function oK(){return Km()&&document?.documentMode===11}function aK(n=Xe()){return/Edge\/\d+/.test(n)}function cK(n=Xe()){return oK()||aK(n)}function yO(){try{let n=self.localStorage,e=ta();if(n)return n.setItem(e,"1"),n.removeItem(e),cK()?xs():!0}catch{return qb()&&xs()}return!1}function qb(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Ub(){return(iK()||Wm()||_O())&&!sK()&&yO()&&!qb()}function vO(){return _O()&&typeof document<"u"}function lK(){return g(this,null,function*(){return vO()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},rK);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1})}function uK(){return typeof window<"u"?window:null}var Zn={LOCAL:"local",NONE:"none",SESSION:"session"},Qd=$,wO="persistence";function dK(n,e){if(Qd(Object.values(Zn).includes(e),n,"invalid-persistence-type"),qo()){Qd(e!==Zn.SESSION,n,"unsupported-persistence-type");return}if(zm()){Qd(e===Zn.NONE,n,"unsupported-persistence-type");return}if(qb()){Qd(e===Zn.NONE||e===Zn.LOCAL&&xs(),n,"unsupported-persistence-type");return}Qd(e===Zn.NONE||yO(),n,"unsupported-persistence-type")}function Bb(n){return g(this,null,function*(){yield n._initializationPromise;let e=EO(),t=hi(wO,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())})}function hK(n,e){let t=EO();if(!t)return[];let r=hi(wO,n,e);switch(t.getItem(r)){case Zn.NONE:return[Ls];case Zn.LOCAL:return[na,pi];case Zn.SESSION:return[pi];default:return[]}}function EO(){var n;try{return((n=uK())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var fK=$,mi=class{constructor(){this.browserResolver=hn(Pb),this.cordovaResolver=hn(fO),this.underlyingResolver=null,this._redirectPersistence=pi,this._completeRedirectFn=sa,this._overrideRedirectResult=Jc}_initialize(e){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)})}_openPopup(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)})}_openRedirect(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)})}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return vO()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return fK(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){return g(this,null,function*(){if(this.underlyingResolver)return;let e=yield lK();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver})}};function IO(n){return n.unwrap()}function pK(n){return n.wrapped()}function mK(n){return bO(n)}function gK(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new $b(n,gb(n,e))}else if(r){let i=bO(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function bO(n){let{_tokenResponse:e}=n instanceof vt?n.customData:n;if(!e)return null;if(!(n instanceof vt)&&"temporaryProof"in e&&"phoneNumber"in e)return ra.credentialFromResult(n);let t=e.providerId;if(!t||t===Zo.PASSWORD)return null;let r;switch(t){case Zo.GOOGLE:r=yg;break;case Zo.FACEBOOK:r=_g;break;case Zo.GITHUB:r=vg;break;case Zo.TWITTER:r=wg;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?Yo._create(t,a):Ur._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new Gc(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof vt?r.credentialFromError(n):r.credentialFromResult(n)}function Hn(n,e){return e.catch(t=>{throw t instanceof vt&&gK(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:mK(t),additionalUserInfo:mb(t),user:Xc.getOrCreate(i)}})}function jb(n,e){return g(this,null,function*(){let t=yield e;return{verificationId:t.verificationId,confirm:r=>Hn(n,t.confirm(r))}})}var $b=class{constructor(e,t){this.resolver=t,this.auth=pK(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Hn(IO(this.auth),this.resolver.resolveSignIn(e))}};var Xc=class n{constructor(e){this._delegate=e,this.multiFactor=_b(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}linkWithCredential(e){return g(this,null,function*(){return Hn(this.auth,Ig(this._delegate,e))})}linkWithPhoneNumber(e,t){return g(this,null,function*(){return jb(this.auth,wb(this._delegate,e,t))})}linkWithPopup(e){return g(this,null,function*(){return Hn(this.auth,Tb(this._delegate,e,mi))})}linkWithRedirect(e){return g(this,null,function*(){return yield Bb(ot(this.auth)),Rb(this._delegate,e,mi)})}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}reauthenticateWithCredential(e){return g(this,null,function*(){return Hn(this.auth,bg(this._delegate,e))})}reauthenticateWithPhoneNumber(e,t){return jb(this.auth,Eb(this._delegate,e,t))}reauthenticateWithPopup(e){return Hn(this.auth,Cb(this._delegate,e,mi))}reauthenticateWithRedirect(e){return g(this,null,function*(){return yield Bb(ot(this.auth)),xb(this._delegate,e,mi)})}sendEmailVerification(e){return ub(this._delegate,e)}unlink(e){return g(this,null,function*(){return yield Y0(this._delegate,e),this})}updateEmail(e){return fb(this._delegate,e)}updatePassword(e){return pb(this._delegate,e)}updatePhoneNumber(e){return Ib(this._delegate,e)}updateProfile(e){return hb(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return db(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Xc.USER_MAP=new WeakMap;var Yd=$,mO=(()=>{class n{constructor(t,r){if(this.app=t,r.isInitialized()){this._delegate=r.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:i}=t.options;Yd(i,"invalid-api-key",{appName:t.name}),Yd(i,"invalid-api-key",{appName:t.name});let s=typeof window<"u"?mi:void 0;this._delegate=r.initialize({options:{persistence:_K(i,t.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(B0),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Xc.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,r){K0(this._delegate,t,r)}applyActionCode(t){return nb(this._delegate,t)}checkActionCode(t){return Tg(this._delegate,t)}confirmPasswordReset(t,r){return tb(this._delegate,t,r)}createUserWithEmailAndPassword(t,r){return g(this,null,function*(){return Hn(this._delegate,ib(this._delegate,t,r))})}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return lb(this._delegate,t)}isSignInWithEmailLink(t){return ab(this._delegate,t)}getRedirectResult(){return g(this,null,function*(){Yd(Ub(),this._delegate,"operation-not-supported-in-this-environment");let t=yield Nb(this._delegate,mi);return t?Hn(this._delegate,Promise.resolve(t)):{credential:null,user:null}})}addFrameworkForLogging(t){pO(this._delegate,t)}onAuthStateChanged(t,r,i){let{next:s,error:o,complete:a}=gO(t,r,i);return this._delegate.onAuthStateChanged(s,o,a)}onIdTokenChanged(t,r,i){let{next:s,error:o,complete:a}=gO(t,r,i);return this._delegate.onIdTokenChanged(s,o,a)}sendSignInLinkToEmail(t,r){return ob(this._delegate,t,r)}sendPasswordResetEmail(t,r){return eb(this._delegate,t,r||void 0)}setPersistence(t){return g(this,null,function*(){dK(this._delegate,t);let r;switch(t){case Zn.SESSION:r=pi;break;case Zn.LOCAL:r=(yield hn(na)._isAvailable())?na:Yc;break;case Zn.NONE:r=Ls;break;default:return Mt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)})}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return Hn(this._delegate,Q0(this._delegate))}signInWithCredential(t){return Hn(this._delegate,Qc(this._delegate,t))}signInWithCustomToken(t){return Hn(this._delegate,X0(this._delegate,t))}signInWithEmailAndPassword(t,r){return Hn(this._delegate,sb(this._delegate,t,r))}signInWithEmailLink(t,r){return Hn(this._delegate,cb(this._delegate,t,r))}signInWithPhoneNumber(t,r){return jb(this._delegate,vb(this._delegate,t,r))}signInWithPopup(t){return g(this,null,function*(){return Yd(Ub(),this._delegate,"operation-not-supported-in-this-environment"),Hn(this._delegate,bb(this._delegate,t,mi))})}signInWithRedirect(t){return g(this,null,function*(){return Yd(Ub(),this._delegate,"operation-not-supported-in-this-environment"),yield Bb(this._delegate),Ab(this._delegate,t,mi)})}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return rb(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=Zn,n})();function gO(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&Xc.getOrCreate(o)),error:e,complete:t}}function _K(n,e){let t=hK(n,e);if(typeof self<"u"&&!t.includes(na)&&t.push(na),typeof window<"u")for(let r of[Yc,pi])t.includes(r)||t.push(r);return t.includes(Ls)||t.push(Ls),t}var Xd=class{constructor(){this.providerId="phone",this._delegate=new ra(IO(F.auth()))}static credential(e,t){return ra.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};Xd.PHONE_SIGN_IN_METHOD=ra.PHONE_SIGN_IN_METHOD;Xd.PROVIDER_ID=ra.PROVIDER_ID;var yK=$,Hb=class{constructor(e,t,r=F.app()){var i;yK((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new $d(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var vK="auth-compat";function wK(n){n.INTERNAL.registerComponent(new Qe(vK,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new mO(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Us.EMAIL_SIGNIN,PASSWORD_RESET:Us.PASSWORD_RESET,RECOVER_EMAIL:Us.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Us.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Us.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Us.VERIFY_EMAIL}},EmailAuthProvider:Kd,FacebookAuthProvider:_g,GithubAuthProvider:vg,GoogleAuthProvider:yg,OAuthProvider:Gc,SAMLAuthProvider:jd,PhoneAuthProvider:Xd,PhoneMultiFactorGenerator:Mb,RecaptchaVerifier:Hb,TwitterAuthProvider:wg,Auth:mO,AuthCredential:fi,Error:vt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(tK,nK)}wK(F);var CO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},TO={};var Bs,zb;(function(){var n;function e(S,I){function C(){}C.prototype=I.prototype,S.D=I.prototype,S.prototype=new C,S.prototype.constructor=S,S.C=function(D,x,k){for(var T=Array(arguments.length-2),Mi=2;Mi<arguments.length;Mi++)T[Mi-2]=arguments[Mi];return I.prototype[x].apply(D,T)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,I,C){C||(C=0);var D=Array(16);if(typeof I=="string")for(var x=0;16>x;++x)D[x]=I.charCodeAt(C++)|I.charCodeAt(C++)<<8|I.charCodeAt(C++)<<16|I.charCodeAt(C++)<<24;else for(x=0;16>x;++x)D[x]=I[C++]|I[C++]<<8|I[C++]<<16|I[C++]<<24;I=S.g[0],C=S.g[1],x=S.g[2];var k=S.g[3],T=I+(k^C&(x^k))+D[0]+3614090360&4294967295;I=C+(T<<7&4294967295|T>>>25),T=k+(x^I&(C^x))+D[1]+3905402710&4294967295,k=I+(T<<12&4294967295|T>>>20),T=x+(C^k&(I^C))+D[2]+606105819&4294967295,x=k+(T<<17&4294967295|T>>>15),T=C+(I^x&(k^I))+D[3]+3250441966&4294967295,C=x+(T<<22&4294967295|T>>>10),T=I+(k^C&(x^k))+D[4]+4118548399&4294967295,I=C+(T<<7&4294967295|T>>>25),T=k+(x^I&(C^x))+D[5]+1200080426&4294967295,k=I+(T<<12&4294967295|T>>>20),T=x+(C^k&(I^C))+D[6]+2821735955&4294967295,x=k+(T<<17&4294967295|T>>>15),T=C+(I^x&(k^I))+D[7]+4249261313&4294967295,C=x+(T<<22&4294967295|T>>>10),T=I+(k^C&(x^k))+D[8]+1770035416&4294967295,I=C+(T<<7&4294967295|T>>>25),T=k+(x^I&(C^x))+D[9]+2336552879&4294967295,k=I+(T<<12&4294967295|T>>>20),T=x+(C^k&(I^C))+D[10]+4294925233&4294967295,x=k+(T<<17&4294967295|T>>>15),T=C+(I^x&(k^I))+D[11]+2304563134&4294967295,C=x+(T<<22&4294967295|T>>>10),T=I+(k^C&(x^k))+D[12]+1804603682&4294967295,I=C+(T<<7&4294967295|T>>>25),T=k+(x^I&(C^x))+D[13]+4254626195&4294967295,k=I+(T<<12&4294967295|T>>>20),T=x+(C^k&(I^C))+D[14]+2792965006&4294967295,x=k+(T<<17&4294967295|T>>>15),T=C+(I^x&(k^I))+D[15]+1236535329&4294967295,C=x+(T<<22&4294967295|T>>>10),T=I+(x^k&(C^x))+D[1]+4129170786&4294967295,I=C+(T<<5&4294967295|T>>>27),T=k+(C^x&(I^C))+D[6]+3225465664&4294967295,k=I+(T<<9&4294967295|T>>>23),T=x+(I^C&(k^I))+D[11]+643717713&4294967295,x=k+(T<<14&4294967295|T>>>18),T=C+(k^I&(x^k))+D[0]+3921069994&4294967295,C=x+(T<<20&4294967295|T>>>12),T=I+(x^k&(C^x))+D[5]+3593408605&4294967295,I=C+(T<<5&4294967295|T>>>27),T=k+(C^x&(I^C))+D[10]+38016083&4294967295,k=I+(T<<9&4294967295|T>>>23),T=x+(I^C&(k^I))+D[15]+3634488961&4294967295,x=k+(T<<14&4294967295|T>>>18),T=C+(k^I&(x^k))+D[4]+3889429448&4294967295,C=x+(T<<20&4294967295|T>>>12),T=I+(x^k&(C^x))+D[9]+568446438&4294967295,I=C+(T<<5&4294967295|T>>>27),T=k+(C^x&(I^C))+D[14]+3275163606&4294967295,k=I+(T<<9&4294967295|T>>>23),T=x+(I^C&(k^I))+D[3]+4107603335&4294967295,x=k+(T<<14&4294967295|T>>>18),T=C+(k^I&(x^k))+D[8]+1163531501&4294967295,C=x+(T<<20&4294967295|T>>>12),T=I+(x^k&(C^x))+D[13]+2850285829&4294967295,I=C+(T<<5&4294967295|T>>>27),T=k+(C^x&(I^C))+D[2]+4243563512&4294967295,k=I+(T<<9&4294967295|T>>>23),T=x+(I^C&(k^I))+D[7]+1735328473&4294967295,x=k+(T<<14&4294967295|T>>>18),T=C+(k^I&(x^k))+D[12]+2368359562&4294967295,C=x+(T<<20&4294967295|T>>>12),T=I+(C^x^k)+D[5]+4294588738&4294967295,I=C+(T<<4&4294967295|T>>>28),T=k+(I^C^x)+D[8]+2272392833&4294967295,k=I+(T<<11&4294967295|T>>>21),T=x+(k^I^C)+D[11]+1839030562&4294967295,x=k+(T<<16&4294967295|T>>>16),T=C+(x^k^I)+D[14]+4259657740&4294967295,C=x+(T<<23&4294967295|T>>>9),T=I+(C^x^k)+D[1]+2763975236&4294967295,I=C+(T<<4&4294967295|T>>>28),T=k+(I^C^x)+D[4]+1272893353&4294967295,k=I+(T<<11&4294967295|T>>>21),T=x+(k^I^C)+D[7]+4139469664&4294967295,x=k+(T<<16&4294967295|T>>>16),T=C+(x^k^I)+D[10]+3200236656&4294967295,C=x+(T<<23&4294967295|T>>>9),T=I+(C^x^k)+D[13]+681279174&4294967295,I=C+(T<<4&4294967295|T>>>28),T=k+(I^C^x)+D[0]+3936430074&4294967295,k=I+(T<<11&4294967295|T>>>21),T=x+(k^I^C)+D[3]+3572445317&4294967295,x=k+(T<<16&4294967295|T>>>16),T=C+(x^k^I)+D[6]+76029189&4294967295,C=x+(T<<23&4294967295|T>>>9),T=I+(C^x^k)+D[9]+3654602809&4294967295,I=C+(T<<4&4294967295|T>>>28),T=k+(I^C^x)+D[12]+3873151461&4294967295,k=I+(T<<11&4294967295|T>>>21),T=x+(k^I^C)+D[15]+530742520&4294967295,x=k+(T<<16&4294967295|T>>>16),T=C+(x^k^I)+D[2]+3299628645&4294967295,C=x+(T<<23&4294967295|T>>>9),T=I+(x^(C|~k))+D[0]+4096336452&4294967295,I=C+(T<<6&4294967295|T>>>26),T=k+(C^(I|~x))+D[7]+1126891415&4294967295,k=I+(T<<10&4294967295|T>>>22),T=x+(I^(k|~C))+D[14]+2878612391&4294967295,x=k+(T<<15&4294967295|T>>>17),T=C+(k^(x|~I))+D[5]+4237533241&4294967295,C=x+(T<<21&4294967295|T>>>11),T=I+(x^(C|~k))+D[12]+1700485571&4294967295,I=C+(T<<6&4294967295|T>>>26),T=k+(C^(I|~x))+D[3]+2399980690&4294967295,k=I+(T<<10&4294967295|T>>>22),T=x+(I^(k|~C))+D[10]+4293915773&4294967295,x=k+(T<<15&4294967295|T>>>17),T=C+(k^(x|~I))+D[1]+2240044497&4294967295,C=x+(T<<21&4294967295|T>>>11),T=I+(x^(C|~k))+D[8]+1873313359&4294967295,I=C+(T<<6&4294967295|T>>>26),T=k+(C^(I|~x))+D[15]+4264355552&4294967295,k=I+(T<<10&4294967295|T>>>22),T=x+(I^(k|~C))+D[6]+2734768916&4294967295,x=k+(T<<15&4294967295|T>>>17),T=C+(k^(x|~I))+D[13]+1309151649&4294967295,C=x+(T<<21&4294967295|T>>>11),T=I+(x^(C|~k))+D[4]+4149444226&4294967295,I=C+(T<<6&4294967295|T>>>26),T=k+(C^(I|~x))+D[11]+3174756917&4294967295,k=I+(T<<10&4294967295|T>>>22),T=x+(I^(k|~C))+D[2]+718787259&4294967295,x=k+(T<<15&4294967295|T>>>17),T=C+(k^(x|~I))+D[9]+3951481745&4294967295,S.g[0]=S.g[0]+I&4294967295,S.g[1]=S.g[1]+(x+(T<<21&4294967295|T>>>11))&4294967295,S.g[2]=S.g[2]+x&4294967295,S.g[3]=S.g[3]+k&4294967295}r.prototype.u=function(S,I){I===void 0&&(I=S.length);for(var C=I-this.blockSize,D=this.B,x=this.h,k=0;k<I;){if(x==0)for(;k<=C;)i(this,S,k),k+=this.blockSize;if(typeof S=="string"){for(;k<I;)if(D[x++]=S.charCodeAt(k++),x==this.blockSize){i(this,D),x=0;break}}else for(;k<I;)if(D[x++]=S[k++],x==this.blockSize){i(this,D),x=0;break}}this.h=x,this.o+=I},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var I=1;I<S.length-8;++I)S[I]=0;var C=8*this.o;for(I=S.length-8;I<S.length;++I)S[I]=C&255,C/=256;for(this.u(S),S=Array(16),I=C=0;4>I;++I)for(var D=0;32>D;D+=8)S[C++]=this.g[I]>>>D&255;return S};function s(S,I){var C=a;return Object.prototype.hasOwnProperty.call(C,S)?C[S]:C[S]=I(S)}function o(S,I){this.h=I;for(var C=[],D=!0,x=S.length-1;0<=x;x--){var k=S[x]|0;D&&k==I||(C[x]=k,D=!1)}this.g=C}var a={};function c(S){return-128<=S&&128>S?s(S,function(I){return new o([I|0],0>I?-1:0)}):new o([S|0],0>S?-1:0)}function l(S){if(isNaN(S)||!isFinite(S))return h;if(0>S)return R(l(-S));for(var I=[],C=1,D=0;S>=C;D++)I[D]=S/C|0,C*=4294967296;return new o(I,0)}function d(S,I){if(S.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(S.charAt(0)=="-")return R(d(S.substring(1),I));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=l(Math.pow(I,8)),D=h,x=0;x<S.length;x+=8){var k=Math.min(8,S.length-x),T=parseInt(S.substring(x,x+k),I);8>k?(k=l(Math.pow(I,k)),D=D.j(k).add(l(T))):(D=D.j(C),D=D.add(l(T)))}return D}var h=c(0),p=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(A(this))return-R(this).m();for(var S=0,I=1,C=0;C<this.g.length;C++){var D=this.i(C);S+=(0<=D?D:4294967296+D)*I,I*=4294967296}return S},n.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(E(this))return"0";if(A(this))return"-"+R(this).toString(S);for(var I=l(Math.pow(S,6)),C=this,D="";;){var x=ee(C,I).g;C=V(C,x.j(I));var k=((0<C.g.length?C.g[0]:C.h)>>>0).toString(S);if(C=x,E(C))return k+D;for(;6>k.length;)k="0"+k;D=k+D}},n.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function E(S){if(S.h!=0)return!1;for(var I=0;I<S.g.length;I++)if(S.g[I]!=0)return!1;return!0}function A(S){return S.h==-1}n.l=function(S){return S=V(this,S),A(S)?-1:E(S)?0:1};function R(S){for(var I=S.g.length,C=[],D=0;D<I;D++)C[D]=~S.g[D];return new o(C,~S.h).add(p)}n.abs=function(){return A(this)?R(this):this},n.add=function(S){for(var I=Math.max(this.g.length,S.g.length),C=[],D=0,x=0;x<=I;x++){var k=D+(this.i(x)&65535)+(S.i(x)&65535),T=(k>>>16)+(this.i(x)>>>16)+(S.i(x)>>>16);D=T>>>16,k&=65535,T&=65535,C[x]=T<<16|k}return new o(C,C[C.length-1]&-2147483648?-1:0)};function V(S,I){return S.add(R(I))}n.j=function(S){if(E(this)||E(S))return h;if(A(this))return A(S)?R(this).j(R(S)):R(R(this).j(S));if(A(S))return R(this.j(R(S)));if(0>this.l(_)&&0>S.l(_))return l(this.m()*S.m());for(var I=this.g.length+S.g.length,C=[],D=0;D<2*I;D++)C[D]=0;for(D=0;D<this.g.length;D++)for(var x=0;x<S.g.length;x++){var k=this.i(D)>>>16,T=this.i(D)&65535,Mi=S.i(x)>>>16,fu=S.i(x)&65535;C[2*D+2*x]+=T*fu,J(C,2*D+2*x),C[2*D+2*x+1]+=k*fu,J(C,2*D+2*x+1),C[2*D+2*x+1]+=T*Mi,J(C,2*D+2*x+1),C[2*D+2*x+2]+=k*Mi,J(C,2*D+2*x+2)}for(D=0;D<I;D++)C[D]=C[2*D+1]<<16|C[2*D];for(D=I;D<2*I;D++)C[D]=0;return new o(C,0)};function J(S,I){for(;(S[I]&65535)!=S[I];)S[I+1]+=S[I]>>>16,S[I]&=65535,I++}function H(S,I){this.g=S,this.h=I}function ee(S,I){if(E(I))throw Error("division by zero");if(E(S))return new H(h,h);if(A(S))return I=ee(R(S),I),new H(R(I.g),R(I.h));if(A(I))return I=ee(S,R(I)),new H(R(I.g),I.h);if(30<S.g.length){if(A(S)||A(I))throw Error("slowDivide_ only works with positive integers.");for(var C=p,D=I;0>=D.l(S);)C=de(C),D=de(D);var x=re(C,1),k=re(D,1);for(D=re(D,2),C=re(C,2);!E(D);){var T=k.add(D);0>=T.l(S)&&(x=x.add(C),k=T),D=re(D,1),C=re(C,1)}return I=V(S,x.j(I)),new H(x,I)}for(x=h;0<=S.l(I);){for(C=Math.max(1,Math.floor(S.m()/I.m())),D=Math.ceil(Math.log(C)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),k=l(C),T=k.j(I);A(T)||0<T.l(S);)C-=D,k=l(C),T=k.j(I);E(k)&&(k=p),x=x.add(k),S=V(S,T)}return new H(x,S)}n.A=function(S){return ee(this,S).h},n.and=function(S){for(var I=Math.max(this.g.length,S.g.length),C=[],D=0;D<I;D++)C[D]=this.i(D)&S.i(D);return new o(C,this.h&S.h)},n.or=function(S){for(var I=Math.max(this.g.length,S.g.length),C=[],D=0;D<I;D++)C[D]=this.i(D)|S.i(D);return new o(C,this.h|S.h)},n.xor=function(S){for(var I=Math.max(this.g.length,S.g.length),C=[],D=0;D<I;D++)C[D]=this.i(D)^S.i(D);return new o(C,this.h^S.h)};function de(S){for(var I=S.g.length+1,C=[],D=0;D<I;D++)C[D]=S.i(D)<<1|S.i(D-1)>>>31;return new o(C,S.h)}function re(S,I){var C=I>>5;I%=32;for(var D=S.g.length-C,x=[],k=0;k<D;k++)x[k]=0<I?S.i(k+C)>>>I|S.i(k+C+1)<<32-I:S.i(k+C);return new o(x,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,zb=TO.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,Bs=TO.Integer=o}).apply(typeof CO<"u"?CO:typeof self<"u"?self:typeof window<"u"?window:{});var xg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ji={};var Gb,Wb,Zc,Kb,Zd,Rg,Qb,Yb,Jb;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,m){return u==Array.prototype||u==Object.prototype||(u[f]=m.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof xg=="object"&&xg];for(var f=0;f<u.length;++f){var m=u[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=t(this);function i(u,f){if(f)e:{var m=r;u=u.split(".");for(var y=0;y<u.length-1;y++){var N=u[y];if(!(N in m))break e;m=m[N]}u=u[u.length-1],y=m[u],f=f(y),f!=y&&f!=null&&e(m,u,{configurable:!0,writable:!0,value:f})}}function s(u,f){u instanceof String&&(u+="");var m=0,y=!1,N={next:function(){if(!y&&m<u.length){var M=m++;return{value:f(M,u[M]),done:!1}}return y=!0,{done:!0,value:void 0}}};return N[Symbol.iterator]=function(){return N},N}i("Array.prototype.values",function(u){return u||function(){return s(this,function(f,m){return m})}});var o=o||{},a=this||self;function c(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function l(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function d(u,f,m){return u.call.apply(u.bind,arguments)}function h(u,f,m){if(!u)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var N=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(N,y),u.apply(f,N)}}return function(){return u.apply(f,arguments)}}function p(u,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function _(u,f){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),u.apply(this,y)}}function E(u,f){function m(){}m.prototype=f.prototype,u.aa=f.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(y,N,M){for(var G=Array(arguments.length-2),Ye=2;Ye<arguments.length;Ye++)G[Ye-2]=arguments[Ye];return f.prototype[N].apply(y,G)}}function A(u){let f=u.length;if(0<f){let m=Array(f);for(let y=0;y<f;y++)m[y]=u[y];return m}return[]}function R(u,f){for(let m=1;m<arguments.length;m++){let y=arguments[m];if(c(y)){let N=u.length||0,M=y.length||0;u.length=N+M;for(let G=0;G<M;G++)u[N+G]=y[G]}else u.push(y)}}class V{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function J(u){return/^[\s\xa0]*$/.test(u)}function H(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function ee(u){return ee[" "](u),u}ee[" "]=function(){};var de=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function re(u,f,m){for(let y in u)f.call(m,u[y],y,u)}function S(u,f){for(let m in u)f.call(void 0,u[m],m,u)}function I(u){let f={};for(let m in u)f[m]=u[m];return f}let C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(u,f){let m,y;for(let N=1;N<arguments.length;N++){y=arguments[N];for(m in y)u[m]=y[m];for(let M=0;M<C.length;M++)m=C[M],Object.prototype.hasOwnProperty.call(y,m)&&(u[m]=y[m])}}function x(u){var f=1;u=u.split(":");let m=[];for(;0<f&&u.length;)m.push(u.shift()),f--;return u.length&&m.push(u.join(":")),m}function k(u){a.setTimeout(()=>{throw u},0)}function T(){var u=Yy;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class Mi{constructor(){this.h=this.g=null}add(f,m){let y=fu.get();y.set(f,m),this.h?this.h.next=y:this.g=y,this.h=y}}var fu=new V(()=>new vj,u=>u.reset());class vj{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let pu,mu=!1,Yy=new Mi,rx=()=>{let u=a.Promise.resolve(void 0);pu=()=>{u.then(wj)}};var wj=()=>{for(var u;u=T();){try{u.h.call(u.g)}catch(m){k(m)}var f=fu;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}mu=!1};function cs(){this.s=this.s,this.C=this.C}cs.prototype.s=!1,cs.prototype.ma=function(){this.s||(this.s=!0,this.N())},cs.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function nn(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}nn.prototype.h=function(){this.defaultPrevented=!0};var Ej=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return u}();function gu(u,f){if(nn.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,y=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(de){e:{try{ee(f.nodeName);var N=!0;break e}catch{}N=!1}N||(f=null)}}else m=="mouseover"?f=u.fromElement:m=="mouseout"&&(f=u.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Ij[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&gu.aa.h.call(this)}}E(gu,nn);var Ij={2:"touch",3:"pen",4:"mouse"};gu.prototype.h=function(){gu.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var _u="closure_listenable_"+(1e6*Math.random()|0),bj=0;function Cj(u,f,m,y,N){this.listener=u,this.proxy=null,this.src=f,this.type=m,this.capture=!!y,this.ha=N,this.key=++bj,this.da=this.fa=!1}function Af(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function xf(u){this.src=u,this.g={},this.h=0}xf.prototype.add=function(u,f,m,y,N){var M=u.toString();u=this.g[M],u||(u=this.g[M]=[],this.h++);var G=Xy(u,f,y,N);return-1<G?(f=u[G],m||(f.fa=!1)):(f=new Cj(f,this.src,M,!!y,N),f.fa=m,u.push(f)),f};function Jy(u,f){var m=f.type;if(m in u.g){var y=u.g[m],N=Array.prototype.indexOf.call(y,f,void 0),M;(M=0<=N)&&Array.prototype.splice.call(y,N,1),M&&(Af(f),u.g[m].length==0&&(delete u.g[m],u.h--))}}function Xy(u,f,m,y){for(var N=0;N<u.length;++N){var M=u[N];if(!M.da&&M.listener==f&&M.capture==!!m&&M.ha==y)return N}return-1}var Zy="closure_lm_"+(1e6*Math.random()|0),ev={};function ix(u,f,m,y,N){if(y&&y.once)return ox(u,f,m,y,N);if(Array.isArray(f)){for(var M=0;M<f.length;M++)ix(u,f[M],m,y,N);return null}return m=iv(m),u&&u[_u]?u.K(f,m,l(y)?!!y.capture:!!y,N):sx(u,f,m,!1,y,N)}function sx(u,f,m,y,N,M){if(!f)throw Error("Invalid event type");var G=l(N)?!!N.capture:!!N,Ye=nv(u);if(Ye||(u[Zy]=Ye=new xf(u)),m=Ye.add(f,m,y,G,M),m.proxy)return m;if(y=Tj(),m.proxy=y,y.src=u,y.listener=m,u.addEventListener)Ej||(N=G),N===void 0&&(N=!1),u.addEventListener(f.toString(),y,N);else if(u.attachEvent)u.attachEvent(cx(f.toString()),y);else if(u.addListener&&u.removeListener)u.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function Tj(){function u(m){return f.call(u.src,u.listener,m)}let f=Sj;return u}function ox(u,f,m,y,N){if(Array.isArray(f)){for(var M=0;M<f.length;M++)ox(u,f[M],m,y,N);return null}return m=iv(m),u&&u[_u]?u.L(f,m,l(y)?!!y.capture:!!y,N):sx(u,f,m,!0,y,N)}function ax(u,f,m,y,N){if(Array.isArray(f))for(var M=0;M<f.length;M++)ax(u,f[M],m,y,N);else y=l(y)?!!y.capture:!!y,m=iv(m),u&&u[_u]?(u=u.i,f=String(f).toString(),f in u.g&&(M=u.g[f],m=Xy(M,m,y,N),-1<m&&(Af(M[m]),Array.prototype.splice.call(M,m,1),M.length==0&&(delete u.g[f],u.h--)))):u&&(u=nv(u))&&(f=u.g[f.toString()],u=-1,f&&(u=Xy(f,m,y,N)),(m=-1<u?f[u]:null)&&tv(m))}function tv(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[_u])Jy(f.i,u);else{var m=u.type,y=u.proxy;f.removeEventListener?f.removeEventListener(m,y,u.capture):f.detachEvent?f.detachEvent(cx(m),y):f.addListener&&f.removeListener&&f.removeListener(y),(m=nv(f))?(Jy(m,u),m.h==0&&(m.src=null,f[Zy]=null)):Af(u)}}}function cx(u){return u in ev?ev[u]:ev[u]="on"+u}function Sj(u,f){if(u.da)u=!0;else{f=new gu(f,this);var m=u.listener,y=u.ha||u.src;u.fa&&tv(u),u=m.call(y,f)}return u}function nv(u){return u=u[Zy],u instanceof xf?u:null}var rv="__closure_events_fn_"+(1e9*Math.random()>>>0);function iv(u){return typeof u=="function"?u:(u[rv]||(u[rv]=function(f){return u.handleEvent(f)}),u[rv])}function rn(){cs.call(this),this.i=new xf(this),this.M=this,this.F=null}E(rn,cs),rn.prototype[_u]=!0,rn.prototype.removeEventListener=function(u,f,m,y){ax(this,u,f,m,y)};function _n(u,f){var m,y=u.F;if(y)for(m=[];y;y=y.F)m.push(y);if(u=u.M,y=f.type||f,typeof f=="string")f=new nn(f,u);else if(f instanceof nn)f.target=f.target||u;else{var N=f;f=new nn(y,u),D(f,N)}if(N=!0,m)for(var M=m.length-1;0<=M;M--){var G=f.g=m[M];N=Rf(G,y,!0,f)&&N}if(G=f.g=u,N=Rf(G,y,!0,f)&&N,N=Rf(G,y,!1,f)&&N,m)for(M=0;M<m.length;M++)G=f.g=m[M],N=Rf(G,y,!1,f)&&N}rn.prototype.N=function(){if(rn.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var m=u.g[f],y=0;y<m.length;y++)Af(m[y]);delete u.g[f],u.h--}}this.F=null},rn.prototype.K=function(u,f,m,y){return this.i.add(String(u),f,!1,m,y)},rn.prototype.L=function(u,f,m,y){return this.i.add(String(u),f,!0,m,y)};function Rf(u,f,m,y){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var N=!0,M=0;M<f.length;++M){var G=f[M];if(G&&!G.da&&G.capture==m){var Ye=G.listener,Jt=G.ha||G.src;G.fa&&Jy(u.i,G),N=Ye.call(Jt,y)!==!1&&N}}return N&&!y.defaultPrevented}function lx(u,f,m){if(typeof u=="function")m&&(u=p(u,m));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function ux(u){u.g=lx(()=>{u.g=null,u.i&&(u.i=!1,ux(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class Dj extends cs{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:ux(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yu(u){cs.call(this),this.h=u,this.g={}}E(yu,cs);var dx=[];function hx(u){re(u.g,function(f,m){this.g.hasOwnProperty(m)&&tv(f)},u),u.g={}}yu.prototype.N=function(){yu.aa.N.call(this),hx(this)},yu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var sv=a.JSON.stringify,Aj=a.JSON.parse,xj=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function ov(){}ov.prototype.h=null;function fx(u){return u.h||(u.h=u.i())}function px(){}var vu={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function av(){nn.call(this,"d")}E(av,nn);function cv(){nn.call(this,"c")}E(cv,nn);var yo={},mx=null;function Nf(){return mx=mx||new rn}yo.La="serverreachability";function gx(u){nn.call(this,yo.La,u)}E(gx,nn);function wu(u){let f=Nf();_n(f,new gx(f))}yo.STAT_EVENT="statevent";function _x(u,f){nn.call(this,yo.STAT_EVENT,u),this.stat=f}E(_x,nn);function yn(u){let f=Nf();_n(f,new _x(f,u))}yo.Ma="timingevent";function yx(u,f){nn.call(this,yo.Ma,u),this.size=f}E(yx,nn);function Eu(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function Iu(){this.g=!0}Iu.prototype.xa=function(){this.g=!1};function Rj(u,f,m,y,N,M){u.info(function(){if(u.g)if(M)for(var G="",Ye=M.split("&"),Jt=0;Jt<Ye.length;Jt++){var Ve=Ye[Jt].split("=");if(1<Ve.length){var sn=Ve[0];Ve=Ve[1];var on=sn.split("_");G=2<=on.length&&on[1]=="type"?G+(sn+"="+Ve+"&"):G+(sn+"=redacted&")}}else G=null;else G=M;return"XMLHTTP REQ ("+y+") [attempt "+N+"]: "+f+`
`+m+`
`+G})}function Nj(u,f,m,y,N,M,G){u.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+N+"]: "+f+`
`+m+`
`+M+" "+G})}function Ga(u,f,m,y){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+Pj(u,m)+(y?" "+y:"")})}function kj(u,f){u.info(function(){return"TIMEOUT: "+f})}Iu.prototype.info=function(){};function Pj(u,f){if(!u.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var y=m[u];if(!(2>y.length)){var N=y[1];if(Array.isArray(N)&&!(1>N.length)){var M=N[0];if(M!="noop"&&M!="stop"&&M!="close")for(var G=1;G<N.length;G++)N[G]=""}}}}return sv(m)}catch{return f}}var kf={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vx={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},lv;function Pf(){}E(Pf,ov),Pf.prototype.g=function(){return new XMLHttpRequest},Pf.prototype.i=function(){return{}},lv=new Pf;function ls(u,f,m,y){this.j=u,this.i=f,this.l=m,this.R=y||1,this.U=new yu(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new wx}function wx(){this.i=null,this.g="",this.h=!1}var Ex={},uv={};function dv(u,f,m){u.L=1,u.v=Lf(Oi(f)),u.m=m,u.P=!0,Ix(u,null)}function Ix(u,f){u.F=Date.now(),Mf(u),u.A=Oi(u.v);var m=u.A,y=u.R;Array.isArray(y)||(y=[String(y)]),Fx(m.i,"t",y),u.C=0,m=u.j.J,u.h=new wx,u.g=eR(u.j,m?f:null,!u.m),0<u.O&&(u.M=new Dj(p(u.Y,u,u.g),u.O)),f=u.U,m=u.g,y=u.ca;var N="readystatechange";Array.isArray(N)||(N&&(dx[0]=N.toString()),N=dx);for(var M=0;M<N.length;M++){var G=ix(m,N[M],y||f.handleEvent,!1,f.h||f);if(!G)break;f.g[G.key]=G}f=u.H?I(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),wu(),Rj(u.i,u.u,u.A,u.l,u.R,u.m)}ls.prototype.ca=function(u){u=u.target;let f=this.M;f&&Fi(u)==3?f.j():this.Y(u)},ls.prototype.Y=function(u){try{if(u==this.g)e:{let on=Fi(this.g);var f=this.g.Ba();let Qa=this.g.Z();if(!(3>on)&&(on!=3||this.g&&(this.h.h||this.g.oa()||Hx(this.g)))){this.J||on!=4||f==7||(f==8||0>=Qa?wu(3):wu(2)),hv(this);var m=this.g.Z();this.X=m;t:if(bx(this)){var y=Hx(this.g);u="";var N=y.length,M=Fi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){vo(this),bu(this);var G="";break t}this.h.i=new a.TextDecoder}for(f=0;f<N;f++)this.h.h=!0,u+=this.h.i.decode(y[f],{stream:!(M&&f==N-1)});y.length=0,this.h.g+=u,this.C=0,G=this.h.g}else G=this.g.oa();if(this.o=m==200,Nj(this.i,this.u,this.A,this.l,this.R,on,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Ye,Jt=this.g;if((Ye=Jt.g?Jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!J(Ye)){var Ve=Ye;break t}}Ve=null}if(m=Ve)Ga(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,fv(this,m);else{this.o=!1,this.s=3,yn(12),vo(this),bu(this);break e}}if(this.P){m=!0;let Ar;for(;!this.J&&this.C<G.length;)if(Ar=Mj(this,G),Ar==uv){on==4&&(this.s=4,yn(14),m=!1),Ga(this.i,this.l,null,"[Incomplete Response]");break}else if(Ar==Ex){this.s=4,yn(15),Ga(this.i,this.l,G,"[Invalid Chunk]"),m=!1;break}else Ga(this.i,this.l,Ar,null),fv(this,Ar);if(bx(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),on!=4||G.length!=0||this.h.h||(this.s=1,yn(16),m=!1),this.o=this.o&&m,!m)Ga(this.i,this.l,G,"[Invalid Chunked Response]"),vo(this),bu(this);else if(0<G.length&&!this.W){this.W=!0;var sn=this.j;sn.g==this&&sn.ba&&!sn.M&&(sn.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),vv(sn),sn.M=!0,yn(11))}}else Ga(this.i,this.l,G,null),fv(this,G);on==4&&vo(this),this.o&&!this.J&&(on==4?Yx(this.j,this):(this.o=!1,Mf(this)))}else Jj(this.g),m==400&&0<G.indexOf("Unknown SID")?(this.s=3,yn(12)):(this.s=0,yn(13)),vo(this),bu(this)}}}catch{}finally{}};function bx(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Mj(u,f){var m=u.C,y=f.indexOf(`
`,m);return y==-1?uv:(m=Number(f.substring(m,y)),isNaN(m)?Ex:(y+=1,y+m>f.length?uv:(f=f.slice(y,y+m),u.C=y+m,f)))}ls.prototype.cancel=function(){this.J=!0,vo(this)};function Mf(u){u.S=Date.now()+u.I,Cx(u,u.I)}function Cx(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Eu(p(u.ba,u),f)}function hv(u){u.B&&(a.clearTimeout(u.B),u.B=null)}ls.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(kj(this.i,this.A),this.L!=2&&(wu(),yn(17)),vo(this),this.s=2,bu(this)):Cx(this,this.S-u)};function bu(u){u.j.G==0||u.J||Yx(u.j,u)}function vo(u){hv(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,hx(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function fv(u,f){try{var m=u.j;if(m.G!=0&&(m.g==u||pv(m.h,u))){if(!u.K&&pv(m.h,u)&&m.G==3){try{var y=m.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var N=y;if(N[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)$f(m),Bf(m);else break e;yv(m),yn(18)}}else m.za=N[1],0<m.za-m.T&&37500>N[2]&&m.F&&m.v==0&&!m.C&&(m.C=Eu(p(m.Za,m),6e3));if(1>=Dx(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else Eo(m,11)}else if((u.K||m.g==u)&&$f(m),!J(f))for(N=m.Da.g.parse(f),f=0;f<N.length;f++){let Ve=N[f];if(m.T=Ve[0],Ve=Ve[1],m.G==2)if(Ve[0]=="c"){m.K=Ve[1],m.ia=Ve[2];let sn=Ve[3];sn!=null&&(m.la=sn,m.j.info("VER="+m.la));let on=Ve[4];on!=null&&(m.Aa=on,m.j.info("SVER="+m.Aa));let Qa=Ve[5];Qa!=null&&typeof Qa=="number"&&0<Qa&&(y=1.5*Qa,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;let Ar=u.g;if(Ar){let qf=Ar.g?Ar.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qf){var M=y.h;M.g||qf.indexOf("spdy")==-1&&qf.indexOf("quic")==-1&&qf.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(mv(M,M.h),M.h=null))}if(y.D){let wv=Ar.g?Ar.g.getResponseHeader("X-HTTP-Session-Id"):null;wv&&(y.ya=wv,st(y.I,y.D,wv))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var G=u;if(y.qa=Zx(y,y.J?y.ia:null,y.W),G.K){Ax(y.h,G);var Ye=G,Jt=y.L;Jt&&(Ye.I=Jt),Ye.B&&(hv(Ye),Mf(Ye)),y.g=G}else Kx(y);0<m.i.length&&jf(m)}else Ve[0]!="stop"&&Ve[0]!="close"||Eo(m,7);else m.G==3&&(Ve[0]=="stop"||Ve[0]=="close"?Ve[0]=="stop"?Eo(m,7):_v(m):Ve[0]!="noop"&&m.l&&m.l.ta(Ve),m.v=0)}}wu(4)}catch{}}var Oj=class{constructor(u,f){this.g=u,this.map=f}};function Tx(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Sx(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Dx(u){return u.h?1:u.g?u.g.size:0}function pv(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function mv(u,f){u.g?u.g.add(f):u.h=f}function Ax(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}Tx.prototype.cancel=function(){if(this.i=xx(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function xx(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let m of u.g.values())f=f.concat(m.D);return f}return A(u.i)}function Fj(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var f=[],m=u.length,y=0;y<m;y++)f.push(u[y]);return f}f=[],m=0;for(y in u)f[m++]=u[y];return f}function Lj(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var f=[];u=u.length;for(var m=0;m<u;m++)f.push(m);return f}f=[],m=0;for(let y in u)f[m++]=y;return f}}}function Rx(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var m=Lj(u),y=Fj(u),N=y.length,M=0;M<N;M++)f.call(void 0,y[M],m&&m[M],u)}var Nx=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vj(u,f){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var y=u[m].indexOf("="),N=null;if(0<=y){var M=u[m].substring(0,y);N=u[m].substring(y+1)}else M=u[m];f(M,N?decodeURIComponent(N.replace(/\+/g," ")):"")}}}function wo(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof wo){this.h=u.h,Of(this,u.j),this.o=u.o,this.g=u.g,Ff(this,u.s),this.l=u.l;var f=u.i,m=new Su;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),kx(this,m),this.m=u.m}else u&&(f=String(u).match(Nx))?(this.h=!1,Of(this,f[1]||"",!0),this.o=Cu(f[2]||""),this.g=Cu(f[3]||"",!0),Ff(this,f[4]),this.l=Cu(f[5]||"",!0),kx(this,f[6]||"",!0),this.m=Cu(f[7]||"")):(this.h=!1,this.i=new Su(null,this.h))}wo.prototype.toString=function(){var u=[],f=this.j;f&&u.push(Tu(f,Px,!0),":");var m=this.g;return(m||f=="file")&&(u.push("//"),(f=this.o)&&u.push(Tu(f,Px,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(Tu(m,m.charAt(0)=="/"?jj:Bj,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",Tu(m,Hj)),u.join("")};function Oi(u){return new wo(u)}function Of(u,f,m){u.j=m?Cu(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function Ff(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function kx(u,f,m){f instanceof Su?(u.i=f,qj(u.i,u.h)):(m||(f=Tu(f,$j)),u.i=new Su(f,u.h))}function st(u,f,m){u.i.set(f,m)}function Lf(u){return st(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Cu(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Tu(u,f,m){return typeof u=="string"?(u=encodeURI(u).replace(f,Uj),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Uj(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Px=/[#\/\?@]/g,Bj=/[#\?:]/g,jj=/[#\?]/g,$j=/[#\?@]/g,Hj=/#/g;function Su(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function us(u){u.g||(u.g=new Map,u.h=0,u.i&&Vj(u.i,function(f,m){u.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=Su.prototype,n.add=function(u,f){us(this),this.i=null,u=Wa(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(f),this.h+=1,this};function Mx(u,f){us(u),f=Wa(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function Ox(u,f){return us(u),f=Wa(u,f),u.g.has(f)}n.forEach=function(u,f){us(this),this.g.forEach(function(m,y){m.forEach(function(N){u.call(f,N,y,this)},this)},this)},n.na=function(){us(this);let u=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let y=0;y<f.length;y++){let N=u[y];for(let M=0;M<N.length;M++)m.push(f[y])}return m},n.V=function(u){us(this);let f=[];if(typeof u=="string")Ox(this,u)&&(f=f.concat(this.g.get(Wa(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)f=f.concat(u[m])}return f},n.set=function(u,f){return us(this),this.i=null,u=Wa(this,u),Ox(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function Fx(u,f,m){Mx(u,f),0<m.length&&(u.i=null,u.g.set(Wa(u,f),A(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var y=f[m];let M=encodeURIComponent(String(y)),G=this.V(y);for(y=0;y<G.length;y++){var N=M;G[y]!==""&&(N+="="+encodeURIComponent(String(G[y]))),u.push(N)}}return this.i=u.join("&")};function Wa(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function qj(u,f){f&&!u.j&&(us(u),u.i=null,u.g.forEach(function(m,y){var N=y.toLowerCase();y!=N&&(Mx(this,y),Fx(this,N,m))},u)),u.j=f}function zj(u,f){let m=new Iu;if(a.Image){let y=new Image;y.onload=_(ds,m,"TestLoadImage: loaded",!0,f,y),y.onerror=_(ds,m,"TestLoadImage: error",!1,f,y),y.onabort=_(ds,m,"TestLoadImage: abort",!1,f,y),y.ontimeout=_(ds,m,"TestLoadImage: timeout",!1,f,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=u}else f(!1)}function Gj(u,f){let m=new Iu,y=new AbortController,N=setTimeout(()=>{y.abort(),ds(m,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:y.signal}).then(M=>{clearTimeout(N),M.ok?ds(m,"TestPingServer: ok",!0,f):ds(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(N),ds(m,"TestPingServer: error",!1,f)})}function ds(u,f,m,y,N){try{N&&(N.onload=null,N.onerror=null,N.onabort=null,N.ontimeout=null),y(m)}catch{}}function Wj(){this.g=new xj}function Kj(u,f,m){let y=m||"";try{Rx(u,function(N,M){let G=N;l(N)&&(G=sv(N)),f.push(y+M+"="+encodeURIComponent(G))})}catch(N){throw f.push(y+"type="+encodeURIComponent("_badmap")),N}}function Du(u){this.l=u.Ub||null,this.j=u.eb||!1}E(Du,ov),Du.prototype.g=function(){return new Vf(this.l,this.j)},Du.prototype.i=function(u){return function(){return u}}({});function Vf(u,f){rn.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Vf,rn),n=Vf.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,xu(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Au(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,xu(this)),this.g&&(this.readyState=3,xu(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Lx(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Lx(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?Au(this):xu(this),this.readyState==3&&Lx(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Au(this))},n.Qa=function(u){this.g&&(this.response=u,Au(this))},n.ga=function(){this.g&&Au(this)};function Au(u){u.readyState=4,u.l=null,u.j=null,u.v=null,xu(u)}n.setRequestHeader=function(u,f){this.u.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=f.next();return u.join(`\r
`)};function xu(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Vf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Vx(u){let f="";return re(u,function(m,y){f+=y,f+=":",f+=m,f+=`\r
`}),f}function gv(u,f,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=Vx(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):st(u,f,m))}function yt(u){rn.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(yt,rn);var Qj=/^https?$/i,Yj=["POST","PUT"];n=yt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,f,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():lv.g(),this.v=this.o?fx(this.o):fx(lv),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(M){Ux(this,M);return}if(u=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var N in y)m.set(N,y[N]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let M of y.keys())m.set(M,y.get(M));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(M=>M.toLowerCase()=="content-type"),N=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Yj,f,void 0))||y||N||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[M,G]of m)this.g.setRequestHeader(M,G);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$x(this),this.u=!0,this.g.send(u),this.u=!1}catch(M){Ux(this,M)}};function Ux(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,Bx(u),Uf(u)}function Bx(u){u.A||(u.A=!0,_n(u,"complete"),_n(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,_n(this,"complete"),_n(this,"abort"),Uf(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Uf(this,!0)),yt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?jx(this):this.bb())},n.bb=function(){jx(this)};function jx(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Fi(u)!=4||u.Z()!=2)){if(u.u&&Fi(u)==4)lx(u.Ea,0,u);else if(_n(u,"readystatechange"),Fi(u)==4){u.h=!1;try{let G=u.Z();e:switch(G){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var y;if(y=G===0){var N=String(u.D).match(Nx)[1]||null;!N&&a.self&&a.self.location&&(N=a.self.location.protocol.slice(0,-1)),y=!Qj.test(N?N.toLowerCase():"")}m=y}if(m)_n(u,"complete"),_n(u,"success");else{u.m=6;try{var M=2<Fi(u)?u.g.statusText:""}catch{M=""}u.l=M+" ["+u.Z()+"]",Bx(u)}}finally{Uf(u)}}}}function Uf(u,f){if(u.g){$x(u);let m=u.g,y=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||_n(u,"ready");try{m.onreadystatechange=y}catch{}}}function $x(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Fi(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Fi(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),Aj(f)}};function Hx(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Jj(u){let f={};u=(u.g&&2<=Fi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<u.length;y++){if(J(u[y]))continue;var m=x(u[y]);let N=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let M=f[N]||[];f[N]=M,M.push(m)}S(f,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ru(u,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||f}function qx(u){this.Aa=0,this.i=[],this.j=new Iu,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ru("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ru("baseRetryDelayMs",5e3,u),this.cb=Ru("retryDelaySeedMs",1e4,u),this.Wa=Ru("forwardChannelMaxRetries",2,u),this.wa=Ru("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Tx(u&&u.concurrentRequestLimit),this.Da=new Wj,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=qx.prototype,n.la=8,n.G=1,n.connect=function(u,f,m,y){yn(0),this.W=u,this.H=f||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=Zx(this,null,this.W),jf(this)};function _v(u){if(zx(u),u.G==3){var f=u.U++,m=Oi(u.I);if(st(m,"SID",u.K),st(m,"RID",f),st(m,"TYPE","terminate"),Nu(u,m),f=new ls(u,u.j,f),f.L=2,f.v=Lf(Oi(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=eR(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Mf(f)}Xx(u)}function Bf(u){u.g&&(vv(u),u.g.cancel(),u.g=null)}function zx(u){Bf(u),u.u&&(a.clearTimeout(u.u),u.u=null),$f(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function jf(u){if(!Sx(u.h)&&!u.s){u.s=!0;var f=u.Ga;pu||rx(),mu||(pu(),mu=!0),Yy.add(f,u),u.B=0}}function Xj(u,f){return Dx(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Eu(p(u.Ga,u,f),Jx(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let N=new ls(this,this.j,u),M=this.o;if(this.S&&(M?(M=I(M),D(M,this.S)):M=this.S),this.m!==null||this.O||(N.H=M,M=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=Wx(this,N,f),m=Oi(this.I),st(m,"RID",u),st(m,"CVER",22),this.D&&st(m,"X-HTTP-Session-Id",this.D),Nu(this,m),M&&(this.O?f="headers="+encodeURIComponent(String(Vx(M)))+"&"+f:this.m&&gv(m,this.m,M)),mv(this.h,N),this.Ua&&st(m,"TYPE","init"),this.P?(st(m,"$req",f),st(m,"SID","null"),N.T=!0,dv(N,m,null)):dv(N,m,f),this.G=2}}else this.G==3&&(u?Gx(this,u):this.i.length==0||Sx(this.h)||Gx(this))};function Gx(u,f){var m;f?m=f.l:m=u.U++;let y=Oi(u.I);st(y,"SID",u.K),st(y,"RID",m),st(y,"AID",u.T),Nu(u,y),u.m&&u.o&&gv(y,u.m,u.o),m=new ls(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),f&&(u.i=f.D.concat(u.i)),f=Wx(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),mv(u.h,m),dv(m,y,f)}function Nu(u,f){u.H&&re(u.H,function(m,y){st(f,y,m)}),u.l&&Rx({},function(m,y){st(f,y,m)})}function Wx(u,f,m){m=Math.min(u.i.length,m);var y=u.l?p(u.l.Na,u.l,u):null;e:{var N=u.i;let M=-1;for(;;){let G=["count="+m];M==-1?0<m?(M=N[0].g,G.push("ofs="+M)):M=0:G.push("ofs="+M);let Ye=!0;for(let Jt=0;Jt<m;Jt++){let Ve=N[Jt].g,sn=N[Jt].map;if(Ve-=M,0>Ve)M=Math.max(0,N[Jt].g-100),Ye=!1;else try{Kj(sn,G,"req"+Ve+"_")}catch{y&&y(sn)}}if(Ye){y=G.join("&");break e}}}return u=u.i.splice(0,m),f.D=u,y}function Kx(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;pu||rx(),mu||(pu(),mu=!0),Yy.add(f,u),u.v=0}}function yv(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Eu(p(u.Fa,u),Jx(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Qx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Eu(p(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yn(10),Bf(this),Qx(this))};function vv(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Qx(u){u.g=new ls(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=Oi(u.qa);st(f,"RID","rpc"),st(f,"SID",u.K),st(f,"AID",u.T),st(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&st(f,"TO",u.ja),st(f,"TYPE","xmlhttp"),Nu(u,f),u.m&&u.o&&gv(f,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=Lf(Oi(f)),m.m=null,m.P=!0,Ix(m,u)}n.Za=function(){this.C!=null&&(this.C=null,Bf(this),yv(this),yn(19))};function $f(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Yx(u,f){var m=null;if(u.g==f){$f(u),vv(u),u.g=null;var y=2}else if(pv(u.h,f))m=f.D,Ax(u.h,f),y=1;else return;if(u.G!=0){if(f.o)if(y==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var N=u.B;y=Nf(),_n(y,new yx(y,m)),jf(u)}else Kx(u);else if(N=f.s,N==3||N==0&&0<f.X||!(y==1&&Xj(u,f)||y==2&&yv(u)))switch(m&&0<m.length&&(f=u.h,f.i=f.i.concat(m)),N){case 1:Eo(u,5);break;case 4:Eo(u,10);break;case 3:Eo(u,6);break;default:Eo(u,2)}}}function Jx(u,f){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*f}function Eo(u,f){if(u.j.info("Error code "+f),f==2){var m=p(u.fb,u),y=u.Xa;let N=!y;y=new wo(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Of(y,"https"),Lf(y),N?zj(y.toString(),m):Gj(y.toString(),m)}else yn(2);u.G=0,u.l&&u.l.sa(f),Xx(u),zx(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),yn(2)):(this.j.info("Failed to ping google.com"),yn(1))};function Xx(u){if(u.G=0,u.ka=[],u.l){let f=xx(u.h);(f.length!=0||u.i.length!=0)&&(R(u.ka,f),R(u.ka,u.i),u.h.i.length=0,A(u.i),u.i.length=0),u.l.ra()}}function Zx(u,f,m){var y=m instanceof wo?Oi(m):new wo(m);if(y.g!="")f&&(y.g=f+"."+y.g),Ff(y,y.s);else{var N=a.location;y=N.protocol,f=f?f+"."+N.hostname:N.hostname,N=+N.port;var M=new wo(null);y&&Of(M,y),f&&(M.g=f),N&&Ff(M,N),m&&(M.l=m),y=M}return m=u.D,f=u.ya,m&&f&&st(y,m,f),st(y,"VER",u.la),Nu(u,y),y}function eR(u,f,m){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new yt(new Du({eb:m})):new yt(u.pa),f.Ha(u.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function tR(){}n=tR.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Hf(){}Hf.prototype.g=function(u,f){return new Gn(u,f)};function Gn(u,f){rn.call(this),this.g=new qx(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!J(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!J(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new Ka(this)}E(Gn,rn),Gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Gn.prototype.close=function(){_v(this.g)},Gn.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=sv(u),u=m);f.i.push(new Oj(f.Ya++,u)),f.G==3&&jf(f)},Gn.prototype.N=function(){this.g.l=null,delete this.j,_v(this.g),delete this.g,Gn.aa.N.call(this)};function nR(u){av.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(let m in f){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}E(nR,av);function rR(){cv.call(this),this.status=1}E(rR,cv);function Ka(u){this.g=u}E(Ka,tR),Ka.prototype.ua=function(){_n(this.g,"a")},Ka.prototype.ta=function(u){_n(this.g,new nR(u))},Ka.prototype.sa=function(u){_n(this.g,new rR)},Ka.prototype.ra=function(){_n(this.g,"b")},Hf.prototype.createWebChannel=Hf.prototype.g,Gn.prototype.send=Gn.prototype.o,Gn.prototype.open=Gn.prototype.m,Gn.prototype.close=Gn.prototype.close,Jb=Ji.createWebChannelTransport=function(){return new Hf},Yb=Ji.getStatEventTarget=function(){return Nf()},Qb=Ji.Event=yo,Rg=Ji.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},kf.NO_ERROR=0,kf.TIMEOUT=8,kf.HTTP_ERROR=6,Zd=Ji.ErrorCode=kf,vx.COMPLETE="complete",Kb=Ji.EventType=vx,px.EventType=vu,vu.OPEN="a",vu.CLOSE="b",vu.ERROR="c",vu.MESSAGE="d",rn.prototype.listen=rn.prototype.K,Zc=Ji.WebChannel=px,Wb=Ji.FetchXmlHttpFactory=Du,yt.prototype.listenOnce=yt.prototype.L,yt.prototype.getLastError=yt.prototype.Ka,yt.prototype.getLastErrorCode=yt.prototype.Ba,yt.prototype.getStatus=yt.prototype.Z,yt.prototype.getResponseJson=yt.prototype.Oa,yt.prototype.getResponseText=yt.prototype.oa,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Ha,Gb=Ji.XhrIo=yt}).apply(typeof xg<"u"?xg:typeof self<"u"?self:typeof window<"u"?window:{});var SO="@firebase/firestore";var Lt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Lt.UNAUTHENTICATED=new Lt(null),Lt.GOOGLE_CREDENTIALS=new Lt("google-credentials-uid"),Lt.FIRST_PARTY=new Lt("first-party-uid"),Lt.MOCK_USER=new Lt("mock-user");var xl="10.12.1";var Ks=new $n("@firebase/firestore");function il(){return Ks.logLevel}function DF(n){Ks.setLogLevel(n)}function U(n,...e){if(Ks.logLevel<=Ee.DEBUG){let t=e.map(rS);Ks.debug(`Firestore (${xl}): ${n}`,...t)}}function St(n,...e){if(Ks.logLevel<=Ee.ERROR){let t=e.map(rS);Ks.error(`Firestore (${xl}): ${n}`,...t)}}function Er(n,...e){if(Ks.logLevel<=Ee.WARN){let t=e.map(rS);Ks.warn(`Firestore (${xl}): ${n}`,...t)}}function rS(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function te(n="Unexpected state"){let e=`FIRESTORE (${xl}) INTERNAL ASSERTION FAILED: `+n;throw St(e),new Error(e)}function ie(n,e){n||te()}function AF(n,e){n||te()}function Q(n,e){return n}var O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends vt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Dt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var jg=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},nC=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Lt.UNAUTHENTICATED))}shutdown(){}},rC=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},iC=class{constructor(e){this.t=e,this.currentUser=Lt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Dt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Dt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Dt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ie(typeof r.accessToken=="string"),new jg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return ie(e===null||typeof e=="string"),new Lt(e)}},sC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Lt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},oC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new sC(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Lt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},aC=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},cC=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,U("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ie(typeof t.token=="string"),this.R=t.token,new aC(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function EK(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var $g=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=EK(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function ge(n,e){return n<e?-1:n>e?1:0}function hl(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function xF(n){return n+"\0"}var mt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new L(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ge(this.nanoseconds,e.nanoseconds):ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var oe=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new mt(0,0))}static max(){return new n(new mt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Hg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&te(),r===void 0?r=e.length-t:r>e.length-t&&te(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Fe=class n extends Hg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new L(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},IK=/^[_a-zA-Z][_a-zA-Z0-9]*$/,At=class n extends Hg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return IK.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new L(O.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new L(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new L(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new L(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Y=class n{constructor(e){this.path=e}static fromPath(e){return new n(Fe.fromString(e))}static fromName(e){return new n(Fe.fromString(e).popFirst(5))}static empty(){return new n(Fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Fe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Fe(e.slice()))}};var fl=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function lC(n){return n.fields.find(e=>e.kind===2)}function ca(n){return n.fields.filter(e=>e.kind!==2)}fl.UNKNOWN_ID=-1;var ll=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var dh=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Ir.min())}};function RF(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=oe.fromTimestamp(r===1e9?new mt(t+1,0):new mt(t,r));return new Ir(i,Y.empty(),e)}function NF(n){return new Ir(n.readTime,n.key,-1)}var Ir=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(oe.min(),Y.empty(),-1)}static max(){return new n(oe.max(),Y.empty(),-1)}};function iS(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Y.comparator(n.documentKey,e.documentKey),t!==0?t:ge(n.largestBatchId,e.largestBatchId))}var kF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",qg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function io(n){return g(this,null,function*(){if(n.code!==O.FAILED_PRECONDITION||n.message!==kF)throw n;U("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&te(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var zg=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Dt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new pa(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=sS(r.target.error);this.V.reject(new pa(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new pa(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(U("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new dC(t)}},Qs=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(Xe())===12.2&&St("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return U("SimpleDb","Removing database:",e),la(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!xs())return!1;if(n.C())return!0;let e=Xe(),t=n.S(e),r=0<t&&t<10,i=PF(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return g(this,null,function*(){return this.db||(U("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new pa(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new L(O.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new L(O.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new pa(e,o))},i.onupgradeneeded=s=>{U("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{U("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return g(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=zg.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),P.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(U("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function PF(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var uC=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return la(this.B.delete())}},pa=class extends L{constructor(e,t){super(O.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function so(n){return n.name==="IndexedDbTransactionError"}var dC=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(U("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(U("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),la(r)}add(e){return U("SimpleDb","ADD",this.store.name,e,e),la(this.store.add(e))}get(e){return la(this.store.get(e)).next(t=>(t===void 0&&(t=null),U("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return U("SimpleDb","DELETE",this.store.name,e),la(this.store.delete(e))}count(){return U("SimpleDb","COUNT",this.store.name),la(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new P((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new P((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){U("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new P((r,i)=>{t.onerror=s=>{let o=sS(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new P((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new uC(a),l=t(a.primaryKey,a.value,c);if(l instanceof P){let d=l.catch(h=>(c.done(),P.reject(h)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>P.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function la(n){return new P((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=sS(r.target.error);t(i)}})}var DO=!1;function sS(n){let e=Qs.S(Xe());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new L("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return DO||(DO=!0,setTimeout(()=>{throw r},0)),r}}return n}var hC=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){U("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{U("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){so(t)?U("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield io(t)}yield this.X(6e4)}))}},fC=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return P.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return U("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(U("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=NF(s);iS(o,r)>0&&(r=o)}),new Ir(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var er=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Ph(n){return n==null}function hh(n){return n===0&&1/n==-1/0}function MF(n){return typeof n=="number"&&Number.isInteger(n)&&!hh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Cn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=AO(e)),e=bK(n.get(t),e);return AO(e)}function bK(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function AO(n){return n+""}function gi(n){let e=n.length;if(ie(e>=2),e===2)return ie(n.charAt(0)===""&&n.charAt(1)===""),Fe.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&te(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:te()}s=o+2}return new Fe(r)}var xO=["userId","batchId"];function Og(n,e){return[n,Cn(e)]}function OF(n,e,t){return[n,Cn(e),t]}var CK={},TK=["prefixPath","collectionGroup","readTime","documentId"],SK=["prefixPath","collectionGroup","documentId"],DK=["collectionGroup","readTime","prefixPath","documentId"],AK=["canonicalId","targetId"],xK=["targetId","path"],RK=["path","targetId"],NK=["collectionId","parent"],kK=["indexId","uid"],PK=["uid","sequenceNumber"],MK=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],OK=["indexId","uid","orderedDocumentKey"],FK=["userId","collectionPath","documentId"],LK=["userId","collectionPath","largestBatchId"],VK=["userId","collectionGroup","largestBatchId"],FF=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],UK=[...FF,"documentOverlays"],LF=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],VF=LF,UF=[...VF,"indexConfiguration","indexState","indexEntries"],BK=UF;var fh=class extends qg{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Kt(n,e){let t=Q(n);return Qs.F(t._e,e)}function RO(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Sa(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function jK(n,e){let t=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function BF(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var at=class n{constructor(e,t){this.comparator=e,this.root=t||yi.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,yi.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cl(this.root,e,this.comparator,!1)}getReverseIterator(){return new cl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cl(this.root,e,this.comparator,!0)}},cl=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},yi=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw te();let e=this.left.check();if(e!==this.right.check())throw te();return e+(this.isRed()?0:1)}};yi.EMPTY=null,yi.RED=!0,yi.BLACK=!1;yi.EMPTY=new class{constructor(){this.size=0}get key(){throw te()}get value(){throw te()}get color(){throw te()}get left(){throw te()}get right(){throw te()}copy(e,t,r,i,s){return this}insert(e,t,r){return new yi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ze=class n{constructor(e){this.comparator=e,this.data=new at(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Gg(this.data.getIterator())}getIteratorFrom(e){return new Gg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Gg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function el(n){return n.hasNext()?n.getNext():void 0}var tr=class n{constructor(e){this.fields=e,e.sort(At.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ze(At.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return hl(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Wg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function jF(){return typeof atob<"u"}var Wt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Wg("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Wt.EMPTY_BYTE_STRING=new Wt("");var $K=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function es(n){if(ie(!!n),typeof n=="string"){let e=0,t=$K.exec(n);if(ie(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:It(n.seconds),nanos:It(n.nanos)}}function It(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ys(n){return typeof n=="string"?Wt.fromBase64String(n):Wt.fromUint8Array(n)}function L_(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function oS(n){let e=n.mapValue.fields.__previous_value__;return L_(e)?oS(e):e}function ph(n){let e=es(n.mapValue.fields.__local_write_time__.timestampValue);return new mt(e.seconds,e.nanos)}var pC=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Js=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Gs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Fg={nullValue:"NULL_VALUE"};function ma(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?L_(n)?4:$F(n)?9007199254740991:10:te()}function Ei(n,e){if(n===e)return!0;let t=ma(n);if(t!==ma(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ph(n).isEqual(ph(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=es(i.timestampValue),a=es(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Ys(i.bytesValue).isEqual(Ys(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return It(i.geoPointValue.latitude)===It(s.geoPointValue.latitude)&&It(i.geoPointValue.longitude)===It(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return It(i.integerValue)===It(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=It(i.doubleValue),a=It(s.doubleValue);return o===a?hh(o)===hh(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return hl(n.arrayValue.values||[],e.arrayValue.values||[],Ei);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(RO(o)!==RO(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Ei(o[c],a[c])))return!1;return!0}(n,e);default:return te()}}function mh(n,e){return(n.values||[]).find(t=>Ei(t,e))!==void 0}function Xs(n,e){if(n===e)return 0;let t=ma(n),r=ma(e);if(t!==r)return ge(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ge(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=It(s.integerValue||s.doubleValue),c=It(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return NO(n.timestampValue,e.timestampValue);case 4:return NO(ph(n),ph(e));case 5:return ge(n.stringValue,e.stringValue);case 6:return function(s,o){let a=Ys(s),c=Ys(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=ge(a[l],c[l]);if(d!==0)return d}return ge(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ge(It(s.latitude),It(o.latitude));return a!==0?a:ge(It(s.longitude),It(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){let d=Xs(a[l],c[l]);if(d)return d}return ge(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Gs.mapValue&&o===Gs.mapValue)return 0;if(s===Gs.mapValue)return 1;if(o===Gs.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let p=ge(c[h],d[h]);if(p!==0)return p;let _=Xs(a[c[h]],l[d[h]]);if(_!==0)return _}return ge(c.length,d.length)}(n.mapValue,e.mapValue);default:throw te()}}function NO(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ge(n,e);let t=es(n),r=es(e),i=ge(t.seconds,r.seconds);return i!==0?i:ge(t.nanos,r.nanos)}function pl(n){return mC(n)}function mC(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=es(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ys(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Y.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=mC(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${mC(t.fields[o])}`;return i+"}"}(n.mapValue):te()}function ga(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function gC(n){return!!n&&"integerValue"in n}function gh(n){return!!n&&"arrayValue"in n}function kO(n){return!!n&&"nullValue"in n}function PO(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Lg(n){return!!n&&"mapValue"in n}function oh(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Sa(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=oh(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=oh(n.arrayValue.values[t]);return e}return Object.assign({},n)}function $F(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function HK(n){return"nullValue"in n?Fg:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ga(Js.empty(),Y.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:te()}function qK(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ga(Js.empty(),Y.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Gs:te()}function MO(n,e){let t=Xs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function OO(n,e){let t=Xs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var pn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Lg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=oh(t)}setAll(e){let t=At.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=oh(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Lg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ei(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Lg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Sa(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(oh(this.value))}};function HF(n){let e=[];return Sa(n.fields,(t,r)=>{let i=new At([t]);if(Lg(r)){let s=HF(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new tr(e)}var Vt=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,oe.min(),oe.min(),oe.min(),pn.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,oe.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,oe.min(),oe.min(),pn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,oe.min(),oe.min(),pn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ii=class{constructor(e,t){this.position=e,this.inclusive=t}};function FO(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=Y.comparator(Y.fromName(o.referenceValue),t.key):r=Xs(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function LO(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ei(n.position[t],e.position[t]))return!1;return!0}var _a=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function zK(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Kg=class{},Re=class n extends Kg{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new vC(e,t,r):t==="array-contains"?new IC(e,r):t==="in"?new Qg(e,r):t==="not-in"?new bC(e,r):t==="array-contains-any"?new CC(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new wC(e,r):new EC(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Xs(t,this.value)):t!==null&&ma(this.value)===ma(t)&&this.matchesComparison(Xs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return te()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},We=class n extends Kg{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return ml(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function ml(n){return n.op==="and"}function _C(n){return n.op==="or"}function aS(n){return qF(n)&&ml(n)}function qF(n){for(let e of n.filters)if(e instanceof We)return!1;return!0}function yC(n){if(n instanceof Re)return n.field.canonicalString()+n.op.toString()+pl(n.value);if(aS(n))return n.filters.map(e=>yC(e)).join(",");{let e=n.filters.map(t=>yC(t)).join(",");return`${n.op}(${e})`}}function zF(n,e){return n instanceof Re?function(r,i){return i instanceof Re&&r.op===i.op&&r.field.isEqual(i.field)&&Ei(r.value,i.value)}(n,e):n instanceof We?function(r,i){return i instanceof We&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&zF(o,i.filters[a]),!0):!1}(n,e):void te()}function GF(n,e){let t=n.filters.concat(e);return We.create(t,n.op)}function WF(n){return n instanceof Re?function(t){return`${t.field.canonicalString()} ${t.op} ${pl(t.value)}`}(n):n instanceof We?function(t){return t.op.toString()+" {"+t.getFilters().map(WF).join(" ,")+"}"}(n):"Filter"}var vC=class extends Re{constructor(e,t,r){super(e,t,r),this.key=Y.fromName(r.referenceValue)}matches(e){let t=Y.comparator(e.key,this.key);return this.matchesComparison(t)}},wC=class extends Re{constructor(e,t){super(e,"in",t),this.keys=KF("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},EC=class extends Re{constructor(e,t){super(e,"not-in",t),this.keys=KF("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function KF(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Y.fromName(r.referenceValue))}var IC=class extends Re{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return gh(t)&&mh(t.arrayValue,this.value)}},Qg=class extends Re{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&mh(this.value.arrayValue,t)}},bC=class extends Re{constructor(e,t){super(e,"not-in",t)}matches(e){if(mh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!mh(this.value.arrayValue,t)}},CC=class extends Re{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!gh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>mh(this.value.arrayValue,r))}};var TC=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function SC(n,e=null,t=[],r=[],i=null,s=null,o=null){return new TC(n,e,t,r,i,s,o)}function ya(n){let e=Q(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>yC(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ph(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>pl(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>pl(r)).join(",")),e.ue=t}return e.ue}function Mh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!zK(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!zF(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!LO(n.startAt,e.startAt)&&LO(n.endAt,e.endAt)}function Yg(n){return Y.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Jg(n,e){return n.filters.filter(t=>t instanceof Re&&t.field.isEqual(e))}function VO(n,e,t){let r=Fg,i=!0;for(let s of Jg(n,e)){let o=Fg,a=!0;switch(s.op){case"<":case"<=":o=HK(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Fg}MO({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];MO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function UO(n,e,t){let r=Gs,i=!0;for(let s of Jg(n,e)){let o=Gs,a=!0;switch(s.op){case">=":case">":o=qK(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Gs}OO({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];OO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var $r=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function QF(n,e,t,r,i,s,o,a){return new $r(n,e,t,r,i,s,o,a)}function Rl(n){return new $r(n)}function BO(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function cS(n){return n.collectionGroup!==null}function ul(n){let e=Q(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ze(At.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new _a(s,r))}),t.has(At.keyField().canonicalString())||e.ce.push(new _a(At.keyField(),r))}return e.ce}function Tn(n){let e=Q(n);return e.le||(e.le=YF(e,ul(n))),e.le}function GK(n){let e=Q(n);return e.he||(e.he=YF(e,n.explicitOrderBy)),e.he}function YF(n,e){if(n.limitType==="F")return SC(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new _a(i.field,s)});let t=n.endAt?new Ii(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ii(n.startAt.position,n.startAt.inclusive):null;return SC(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function DC(n,e){let t=n.filters.concat([e]);return new $r(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Xg(n,e,t){return new $r(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Oh(n,e){return Mh(Tn(n),Tn(e))&&n.limitType===e.limitType}function JF(n){return`${ya(Tn(n))}|lt:${n.limitType}`}function sl(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>WF(i)).join(", ")}]`),Ph(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>pl(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>pl(i)).join(",")),`Target(${r})`}(Tn(n))}; limitType=${n.limitType})`}function Fh(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Y.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of ul(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=FO(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,ul(r),i)||r.endAt&&!function(o,a,c){let l=FO(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,ul(r),i))}(n,e)}function XF(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ZF(n){return(e,t)=>{let r=!1;for(let i of ul(n)){let s=WK(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function WK(n,e,t){let r=n.field.isKeyField()?Y.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?Xs(c,l):te()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return te()}}var bi=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Sa(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return BF(this.inner)}size(){return this.innerSize}};var KK=new at(Y.comparator);function qn(){return KK}var eL=new at(Y.comparator);function ih(...n){let e=eL;for(let t of n)e=e.insert(t.key,t);return e}function tL(n){let e=eL;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function _i(){return ah()}function nL(){return ah()}function ah(){return new bi(n=>n.toString(),(n,e)=>n.isEqual(e))}var QK=new at(Y.comparator),YK=new Ze(Y.comparator);function ve(...n){let e=YK;for(let t of n)e=e.add(t);return e}var JK=new Ze(ge);function lS(){return JK}function rL(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hh(e)?"-0":e}}function iL(n){return{integerValue:""+n}}function sL(n,e){return MF(e)?iL(e):rL(n,e)}var gl=class{constructor(){this._=void 0}};function XK(n,e,t){return n instanceof Zs?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&L_(s)&&(s=oS(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof ts?aL(n,e):n instanceof ns?cL(n,e):function(i,s){let o=oL(i,s),a=jO(o)+jO(i.Pe);return gC(o)&&gC(i.Pe)?iL(a):rL(i.serializer,a)}(n,e)}function ZK(n,e,t){return n instanceof ts?aL(n,e):n instanceof ns?cL(n,e):t}function oL(n,e){return n instanceof eo?function(r){return gC(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Zs=class extends gl{},ts=class extends gl{constructor(e){super(),this.elements=e}};function aL(n,e){let t=lL(e);for(let r of n.elements)t.some(i=>Ei(i,r))||t.push(r);return{arrayValue:{values:t}}}var ns=class extends gl{constructor(e){super(),this.elements=e}};function cL(n,e){let t=lL(e);for(let r of n.elements)t=t.filter(i=>!Ei(i,r));return{arrayValue:{values:t}}}var eo=class extends gl{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function jO(n){return It(n.integerValue||n.doubleValue)}function lL(n){return gh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var va=class{constructor(e,t){this.field=e,this.transform=t}};function e7(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof ts&&i instanceof ts||r instanceof ns&&i instanceof ns?hl(r.elements,i.elements,Ei):r instanceof eo&&i instanceof eo?Ei(r.Pe,i.Pe):r instanceof Zs&&i instanceof Zs}(n.transform,e.transform)}var AC=class{constructor(e,t){this.version=e,this.transformResults=t}},bt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Vg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var _l=class{};function uL(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new no(n.key,bt.none()):new to(n.key,n.data,bt.none());{let t=n.data,r=pn.empty(),i=new Ze(At.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Hr(n.key,r,new tr(i.toArray()),bt.none())}}function t7(n,e,t){n instanceof to?function(i,s,o){let a=i.value.clone(),c=HO(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Hr?function(i,s,o){if(!Vg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=HO(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(dL(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function ch(n,e,t,r){return n instanceof to?function(s,o,a,c){if(!Vg(s.precondition,o))return a;let l=s.value.clone(),d=qO(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof Hr?function(s,o,a,c){if(!Vg(s.precondition,o))return a;let l=qO(s.fieldTransforms,c,o),d=o.data;return d.setAll(dL(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return Vg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function n7(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=oL(r.transform,i||null);s!=null&&(t===null&&(t=pn.empty()),t.set(r.field,s))}return t||null}function $O(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&hl(r,i,(s,o)=>e7(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var to=class extends _l{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Hr=class extends _l{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function dL(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function HO(n,e,t){let r=new Map;ie(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,ZK(o,a,t[i]))}return r}function qO(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,XK(s,o,e))}return r}var no=class extends _l{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},_h=class extends _l{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var yh=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&t7(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ch(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ch(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=nL();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=uL(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(oe.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ve())}isEqual(e){return this.batchId===e.batchId&&hl(this.mutations,e.mutations,(t,r)=>$O(t,r))&&hl(this.baseMutations,e.baseMutations,(t,r)=>$O(t,r))}},xC=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ie(e.mutations.length===r.length);let i=function(){return QK}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var vh=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var RC=class{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}};var NC=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ot,Oe;function hL(n){switch(n){default:return te();case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0}}function fL(n){if(n===void 0)return St("GRPC error has no .code"),O.UNKNOWN;switch(n){case Ot.OK:return O.OK;case Ot.CANCELLED:return O.CANCELLED;case Ot.UNKNOWN:return O.UNKNOWN;case Ot.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case Ot.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case Ot.INTERNAL:return O.INTERNAL;case Ot.UNAVAILABLE:return O.UNAVAILABLE;case Ot.UNAUTHENTICATED:return O.UNAUTHENTICATED;case Ot.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case Ot.NOT_FOUND:return O.NOT_FOUND;case Ot.ALREADY_EXISTS:return O.ALREADY_EXISTS;case Ot.PERMISSION_DENIED:return O.PERMISSION_DENIED;case Ot.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case Ot.ABORTED:return O.ABORTED;case Ot.OUT_OF_RANGE:return O.OUT_OF_RANGE;case Ot.UNIMPLEMENTED:return O.UNIMPLEMENTED;case Ot.DATA_LOSS:return O.DATA_LOSS;default:return te()}}(Oe=Ot||(Ot={}))[Oe.OK=0]="OK",Oe[Oe.CANCELLED=1]="CANCELLED",Oe[Oe.UNKNOWN=2]="UNKNOWN",Oe[Oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oe[Oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oe[Oe.NOT_FOUND=5]="NOT_FOUND",Oe[Oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oe[Oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oe[Oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oe[Oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oe[Oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oe[Oe.ABORTED=10]="ABORTED",Oe[Oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oe[Oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oe[Oe.INTERNAL=13]="INTERNAL",Oe[Oe.UNAVAILABLE=14]="UNAVAILABLE",Oe[Oe.DATA_LOSS=15]="DATA_LOSS";var zO=null;function pL(){return new TextEncoder}var r7=new Bs([4294967295,4294967295],0);function GO(n){let e=pL().encode(n),t=new zb;return t.update(e),new Uint8Array(t.digest())}function WO(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Bs([t,r],0),new Bs([i,s],0)]}var kC=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new fa(`Invalid padding: ${t}`);if(r<0)throw new fa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new fa(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new fa(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Bs.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Bs.fromNumber(r)));return i.compare(r7)===1&&(i=new Bs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=GO(e),[r,i]=WO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=GO(e),[r,i]=WO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},fa=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var wh=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Eh.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(oe.min(),i,new at(ge),qn(),ve())}},Eh=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ve(),ve(),ve())}};var dl=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Zg=class{constructor(e,t){this.targetId=e,this.me=t}},e_=class{constructor(e,t,r=Wt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},t_=class{constructor(){this.fe=0,this.ge=QO(),this.pe=Wt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=ve(),t=ve(),r=ve();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:te()}}),new Eh(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=QO()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ie(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},PC=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=qn(),this.qe=KO(),this.Qe=new at(ge)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:te()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(Yg(s))if(r===0){let o=new Y(s.path);this.Ue(t,o,Vt.newNoDocument(o,oe.min()))}else ie(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}zO?.et(function(d,h,p,_,E){var A,R,V,J,H,ee;let de={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},re=h.unchangedNames;return re&&(de.bloomFilter={applied:E===0,hashCount:(A=re?.hashCount)!==null&&A!==void 0?A:0,bitmapLength:(J=(V=(R=re?.bits)===null||R===void 0?void 0:R.bitmap)===null||V===void 0?void 0:V.length)!==null&&J!==void 0?J:0,padding:(ee=(H=re?.bits)===null||H===void 0?void 0:H.padding)!==null&&ee!==void 0?ee:0,mightContain:S=>{var I;return(I=_?.mightContain(S))!==null&&I!==void 0&&I}}),de}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=Ys(r).toUint8Array()}catch(c){if(c instanceof Wg)return Er("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new kC(o,i,s)}catch(c){return Er(c instanceof fa?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&Yg(a.target)){let c=new Y(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Vt.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let r=ve();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new wh(e,t,this.Qe,this.ke,r);return this.ke=qn(),this.qe=KO(),this.Qe=new at(ge),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new t_,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ze(ge),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||U("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new t_),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function KO(){return new at(Y.comparator)}function QO(){return new at(Y.comparator)}var i7={asc:"ASCENDING",desc:"DESCENDING"},s7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},o7={and:"AND",or:"OR"},MC=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function OC(n,e){return n.useProto3Json||Ph(e)?e:{value:e}}function yl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function a7(n,e){return yl(n,e.toTimestamp())}function xt(n){return ie(!!n),oe.fromTimestamp(function(t){let r=es(t);return new mt(r.seconds,r.nanos)}(n))}function uS(n,e){return FC(n,e).canonicalString()}function FC(n,e){let t=function(i){return new Fe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function gL(n){let e=Fe.fromString(n);return ie(TL(e)),e}function Ih(n,e){return uS(n.databaseId,e.path)}function vi(n,e){let t=gL(e);if(t.get(1)!==n.databaseId.projectId)throw new L(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Y(vL(t))}function _L(n,e){return uS(n.databaseId,e)}function yL(n){let e=gL(n);return e.length===4?Fe.emptyPath():vL(e)}function LC(n){return new Fe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function vL(n){return ie(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function YO(n,e,t){return{name:Ih(n,e),fields:t.value.mapValue.fields}}function wL(n,e,t){let r=vi(n,e.name),i=xt(e.updateTime),s=e.createTime?xt(e.createTime):oe.min(),o=new pn({mapValue:{fields:e.fields}}),a=Vt.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function c7(n,e){return"found"in e?function(r,i){ie(!!i.found),i.found.name,i.found.updateTime;let s=vi(r,i.found.name),o=xt(i.found.updateTime),a=i.found.createTime?xt(i.found.createTime):oe.min(),c=new pn({mapValue:{fields:i.found.fields}});return Vt.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){ie(!!i.missing),ie(!!i.readTime);let s=vi(r,i.missing),o=xt(i.readTime);return Vt.newNoDocument(s,o)}(n,e):te()}function l7(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:te()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(ie(d===void 0||typeof d=="string"),Wt.fromBase64String(d||"")):(ie(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Wt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?O.UNKNOWN:fL(l.code);return new L(d,l.message||"")}(o);t=new e_(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=vi(n,r.document.name),s=xt(r.document.updateTime),o=r.document.createTime?xt(r.document.createTime):oe.min(),a=new pn({mapValue:{fields:r.document.fields}}),c=Vt.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new dl(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=vi(n,r.document),s=r.readTime?xt(r.readTime):oe.min(),o=Vt.newNoDocument(i,s),a=r.removedTargetIds||[];t=new dl([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=vi(n,r.document),s=r.removedTargetIds||[];t=new dl([],s,i,null)}else{if(!("filter"in e))return te();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new NC(i,s),a=r.targetId;t=new Zg(a,o)}}return t}function bh(n,e){let t;if(e instanceof to)t={update:YO(n,e.key,e.value)};else if(e instanceof no)t={delete:Ih(n,e.key)};else if(e instanceof Hr)t={update:YO(n,e.key,e.data),updateMask:g7(e.fieldMask)};else{if(!(e instanceof _h))return te();t={verify:Ih(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Zs)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ts)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ns)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof eo)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw te()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:a7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:te()}(n,e.precondition)),t}function VC(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?bt.updateTime(xt(s.updateTime)):s.exists!==void 0?bt.exists(s.exists):bt.none()}(e.currentDocument):bt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)ie(a.setToServerValue==="REQUEST_TIME"),c=new Zs;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new ts(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new ns(d)}else"increment"in a?c=new eo(o,a.increment):te();let l=At.fromServerFormat(a.fieldPath);return new va(l,c)}(n,i)):[];if(e.update){e.update.name;let i=vi(n,e.update.name),s=new pn({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new tr(l.map(d=>At.fromServerFormat(d)))}(e.updateMask);return new Hr(i,s,o,t,r)}return new to(i,s,t,r)}if(e.delete){let i=vi(n,e.delete);return new no(i,t)}if(e.verify){let i=vi(n,e.verify);return new _h(i,t)}return te()}function u7(n,e){return n&&n.length>0?(ie(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?xt(i.updateTime):xt(s);return o.isEqual(oe.min())&&(o=xt(s)),new AC(o,i.transformResults||[])}(t,e))):[]}function EL(n,e){return{documents:[_L(n,e.path)]}}function dS(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=_L(n,i);let s=function(l){if(l.length!==0)return CL(We.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(p){return{field:Hs(p.field),direction:f7(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=OC(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function d7(n,e,t,r){let{_t:i,parent:s}=dS(n,e),o={},a=[],c=0;return t.forEach(l=>{let d=r?l.alias:"aggregate_"+c++;o[d]=l.alias,l.aggregateType==="count"?a.push({alias:d,count:{}}):l.aggregateType==="avg"?a.push({alias:d,avg:{field:Hs(l.fieldPath)}}):l.aggregateType==="sum"&&a.push({alias:d,sum:{field:Hs(l.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},ut:o,parent:s}}function IL(n){let e=yL(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ie(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let p=bL(h);return p instanceof We&&aS(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(p=>function(E){return new _a(ol(E.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,Ph(p)?null:p}(t.limit));let c=null;t.startAt&&(c=function(h){let p=!!h.before,_=h.values||[];return new Ii(_,p)}(t.startAt));let l=null;return t.endAt&&(l=function(h){let p=!h.before,_=h.values||[];return new Ii(_,p)}(t.endAt)),QF(e,i,o,s,a,"F",c,l)}function h7(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return te()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function bL(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=ol(t.unaryFilter.field);return Re.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ol(t.unaryFilter.field);return Re.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ol(t.unaryFilter.field);return Re.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ol(t.unaryFilter.field);return Re.create(o,"!=",{nullValue:"NULL_VALUE"});default:return te()}}(n):n.fieldFilter!==void 0?function(t){return Re.create(ol(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return te()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return We.create(t.compositeFilter.filters.map(r=>bL(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return te()}}(t.compositeFilter.op))}(n):te()}function f7(n){return i7[n]}function p7(n){return s7[n]}function m7(n){return o7[n]}function Hs(n){return{fieldPath:n.canonicalString()}}function ol(n){return At.fromServerFormat(n.fieldPath)}function CL(n){return n instanceof Re?function(t){if(t.op==="=="){if(PO(t.value))return{unaryFilter:{field:Hs(t.field),op:"IS_NAN"}};if(kO(t.value))return{unaryFilter:{field:Hs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(PO(t.value))return{unaryFilter:{field:Hs(t.field),op:"IS_NOT_NAN"}};if(kO(t.value))return{unaryFilter:{field:Hs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hs(t.field),op:p7(t.op),value:t.value}}}(n):n instanceof We?function(t){let r=t.getFilters().map(i=>CL(i));return r.length===1?r[0]:{compositeFilter:{op:m7(t.op),filters:r}}}(n):te()}function g7(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function TL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var vl=class n{constructor(e,t,r,i,s=oe.min(),o=oe.min(),a=Wt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var n_=class{constructor(e){this.ct=e}};function _7(n,e){let t;if(e.document)t=wL(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=Y.fromSegments(e.noDocument.path),i=Ea(e.noDocument.readTime);t=Vt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return te();{let r=Y.fromSegments(e.unknownDocument.path),i=Ea(e.unknownDocument.version);t=Vt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new mt(i[0],i[1]);return oe.fromTimestamp(s)}(e.readTime)),t}function JO(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:r_(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Ih(s,o.key),fields:o.data.value.mapValue.fields,updateTime:yl(s,o.version.toTimestamp()),createTime:yl(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:wa(e.version)};else{if(!e.isUnknownDocument())return te();r.unknownDocument={path:t.path.toArray(),version:wa(e.version)}}return r}function r_(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function wa(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ea(n){let e=new mt(n.seconds,n.nanoseconds);return oe.fromTimestamp(e)}function ua(n,e){let t=(e.baseMutations||[]).map(s=>VC(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>VC(n.ct,s)),i=mt.fromMillis(e.localWriteTimeMs);return new yh(e.batchId,i,t,r)}function sh(n){let e=Ea(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ea(n.lastLimboFreeSnapshotVersion):oe.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return ie(s.documents.length===1),Tn(Rl(yL(s.documents[0])))}(n.query):function(s){return Tn(IL(s))}(n.query),new vl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Wt.fromBase64String(n.resumeToken))}function SL(n,e){let t=wa(e.snapshotVersion),r=wa(e.lastLimboFreeSnapshotVersion),i;i=Yg(e.target)?EL(n.ct,e.target):dS(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ya(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function hS(n){let e=IL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Xg(e,e.limit,"L"):e}function Xb(n,e){return new vh(e.largestBatchId,VC(n.ct,e.overlayMutation))}function XO(n,e){let t=e.path.lastSegment();return[n,Cn(e.path.popLast()),t]}function ZO(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:wa(r.readTime),documentKey:Cn(r.documentKey.path),largestBatchId:r.largestBatchId}}var UC=class{getBundleMetadata(e,t){return eF(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ea(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return eF(e).put(function(i){return{bundleId:i.id,createTime:wa(xt(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return tF(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:hS(s.bundledQuery),readTime:Ea(s.readTime)}}(r)})}saveNamedQuery(e,t){return tF(e).put(function(i){return{name:i.name,readTime:wa(xt(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function eF(n){return Kt(n,"bundles")}function tF(n){return Kt(n,"namedQueries")}var i_=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return eh(e).get(XO(this.userId,t)).next(r=>r?Xb(this.serializer,r):null)}getOverlays(e,t){let r=_i();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new vh(t,o);i.push(this.ht(e,a))}),P.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(Cn(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(eh(e).j("collectionPathOverlayIndex",a))}),P.waitFor(s)}getOverlaysForCollection(e,t,r){let i=_i(),s=Cn(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return eh(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=Xb(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=_i(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return eh(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,d)=>{let h=Xb(this.serializer,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return eh(e).put(function(i,s,o){let[a,c,l]=XO(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:bh(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function eh(n){return Kt(n,"documentOverlays")}var Xi=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(It(e.integerValue));else if("doubleValue"in e){let r=It(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),hh(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=es(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Ys(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?$F(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):te()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),Y.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};Xi.bt=new Xi;function y7(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function nF(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=y7(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var BC=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ct(r.value),r=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Mt(r.value),r=t.next();this.xt()}Ot(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let t=this.Bt(e),r=nF(t);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){let t=this.Bt(e),r=nF(t);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},jC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},$C=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},da=class{constructor(){this.Gt=new BC,this.zt=new jC(this.Gt),this.jt=new $C(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var ha=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function js(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=rF(n.arrayValue,e.arrayValue),t!==0?t:(t=rF(n.directionalValue,e.directionalValue),t!==0?t:Y.comparator(n.documentKey,e.documentKey)))}function rF(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var s_=class{constructor(e){this.Yt=new Ze((t,r)=>At.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let r=t;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(ie(e.collectionGroup===this.collectionId),this.en)return!1;let t=lC(e);if(t!==void 0&&!this.nn(t))return!1;let r=ca(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Ze(At.comparator),t=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new ll(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new ll(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new ll(r.field,r.dir==="asc"?0:1)));return new fl(fl.UNKNOWN_ID,this.collectionId,t,dh.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function DL(n){var e,t;if(ie(n instanceof Re||n instanceof We),n instanceof Re){if(n instanceof Qg){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Re.create(n.field,"==",s)))||[];return We.create(i,"or")}return n}let r=n.filters.map(i=>DL(i));return We.create(r,n.op)}function v7(n){if(n.getFilters().length===0)return[];let e=zC(DL(n));return ie(AL(e)),HC(e)||qC(e)?[e]:e.getFilters()}function HC(n){return n instanceof Re}function qC(n){return n instanceof We&&aS(n)}function AL(n){return HC(n)||qC(n)||function(t){if(t instanceof We&&_C(t)){for(let r of t.getFilters())if(!HC(r)&&!qC(r))return!1;return!0}return!1}(n)}function zC(n){if(ie(n instanceof Re||n instanceof We),n instanceof Re)return n;if(n.filters.length===1)return zC(n.filters[0]);let e=n.filters.map(r=>zC(r)),t=We.create(e,n.op);return t=o_(t),AL(t)?t:(ie(t instanceof We),ie(ml(t)),ie(t.filters.length>1),t.filters.reduce((r,i)=>fS(r,i)))}function fS(n,e){let t;return ie(n instanceof Re||n instanceof We),ie(e instanceof Re||e instanceof We),t=n instanceof Re?e instanceof Re?function(i,s){return We.create([i,s],"and")}(n,e):iF(n,e):e instanceof Re?iF(e,n):function(i,s){if(ie(i.filters.length>0&&s.filters.length>0),ml(i)&&ml(s))return GF(i,s.getFilters());let o=_C(i)?i:s,a=_C(i)?s:i,c=o.filters.map(l=>fS(l,a));return We.create(c,"or")}(n,e),o_(t)}function iF(n,e){if(ml(e))return GF(e,n.getFilters());{let t=e.filters.map(r=>fS(n,r));return We.create(t,"or")}}function o_(n){if(ie(n instanceof Re||n instanceof We),n instanceof Re)return n;let e=n.getFilters();if(e.length===1)return o_(e[0]);if(qF(n))return n;let t=e.map(i=>o_(i)),r=[];return t.forEach(i=>{i instanceof Re?r.push(i):i instanceof We&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:We.create(r,n.op)}var GC=class{constructor(){this._n=new Ch}addToCollectionParentIndex(e,t){return this._n.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(Ir.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(Ir.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},Ch=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ze(Fe.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ze(Fe.comparator)).toArray()}};var Ng=new Uint8Array(0),WC=class{constructor(e,t){this.databaseId=t,this.an=new Ch,this.un=new bi(r=>ya(r),(r,i)=>Mh(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:r,parent:Cn(i)};return sF(e).put(s)}return P.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[xF(t),""],!1,!0);return sF(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(gi(o.parent))}return r})}addFieldIndex(e,t){let r=th(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=nl(e);return s.next(a=>{o.put(ZO(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=th(e),i=nl(e),s=tl(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=th(e),r=tl(e),i=nl(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return P.forEach(this.cn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new s_(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=tl(e),i=!0,s=new Map;return P.forEach(this.cn(t),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ve(),a=[];return P.forEach(s,(c,l)=>{U("IndexedDbIndexManager",`Using index ${function(H){return`id=${H.indexId}|cg=${H.collectionGroup}|f=${H.fields.map(ee=>`${ee.fieldPath}:${ee.kind}`).join(",")}`}(c)} to execute ${ya(t)}`);let d=function(H,ee){let de=lC(ee);if(de===void 0)return null;for(let re of Jg(H,de.fieldPath))switch(re.op){case"array-contains-any":return re.value.arrayValue.values||[];case"array-contains":return[re.value]}return null}(l,c),h=function(H,ee){let de=new Map;for(let re of ca(ee))for(let S of Jg(H,re.fieldPath))switch(S.op){case"==":case"in":de.set(re.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return de.set(re.fieldPath.canonicalString(),S.value),Array.from(de.values())}return null}(l,c),p=function(H,ee){let de=[],re=!0;for(let S of ca(ee)){let I=S.kind===0?VO(H,S.fieldPath,H.startAt):UO(H,S.fieldPath,H.startAt);de.push(I.value),re&&(re=I.inclusive)}return new Ii(de,re)}(l,c),_=function(H,ee){let de=[],re=!0;for(let S of ca(ee)){let I=S.kind===0?UO(H,S.fieldPath,H.endAt):VO(H,S.fieldPath,H.endAt);de.push(I.value),re&&(re=I.inclusive)}return new Ii(de,re)}(l,c),E=this.hn(c,l,p),A=this.hn(c,l,_),R=this.Pn(c,l,h),V=this.In(c.indexId,d,E,p.inclusive,A,_.inclusive,R);return P.forEach(V,J=>r.G(J,t.limit).next(H=>{H.forEach(ee=>{let de=Y.fromSegments(ee.documentKey);o.has(de)||(o=o.add(de),a.push(de))})}))}).next(()=>a)}return P.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=v7(We.create(e.filters,"and")).map(r=>SC(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),l=c/(t!=null?t.length:1),d=[];for(let h=0;h<c;++h){let p=t?this.Tn(t[h/l]):Ng,_=this.En(e,p,r[h%l],i),E=this.dn(e,p,s[h%l],o),A=a.map(R=>this.En(e,p,R,!0));d.push(...this.createRange(_,E,A))}return d}En(e,t,r,i){let s=new ha(e,Y.empty(),t,r);return i?s:s.Jt()}dn(e,t,r,i){let s=new ha(e,Y.empty(),t,r);return i?s.Jt():s}ln(e,t){let r=new s_(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.cn(t);return P.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new Ze(At.comparator),d=!1;for(let h of c.filters)for(let p of h.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?d=!0:l=l.add(p.field));for(let h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}An(e,t){let r=new da;for(let i of ca(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Xi.bt.Pt(s,o)}return r.Wt()}Tn(e){let t=new da;return Xi.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let r=new da;return Xi.bt.Pt(ga(this.databaseId,t),r.Ht(function(s){let o=ca(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,t,r){if(r===null)return[];let i=[];i.push(new da);let s=0;for(let o of ca(e)){let a=r[s++];for(let c of i)if(this.Vn(t,o.fieldPath)&&gh(a))i=this.mn(i,o,a);else{let l=c.Ht(o.kind);Xi.bt.Pt(a,l)}}return this.fn(i)}hn(e,t,r){return this.Pn(e,t,r.position)}fn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Wt();return t}mn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new da;c.seed(a.Wt()),Xi.bt.Pt(o,c.Ht(t.kind)),s.push(c)}return s}Vn(e,t){return!!e.filters.find(r=>r instanceof Re&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=th(e),i=nl(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return P.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,h){let p=h?new dh(h.sequenceNumber,new Ir(Ea(h.readTime),new Y(gi(h.documentKey)),h.largestBatchId)):dh.empty(),_=d.fields.map(([E,A])=>new ll(At.fromServerFormat(E),A));return new fl(d.indexId,d.collectionGroup,_,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ge(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=th(e),s=nl(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>P.forEach(a,c=>s.put(ZO(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return P.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?P.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),P.forEach(a,c=>this.pn(e,i,c).next(l=>{let d=this.yn(s,c);return l.isEqual(d)?P.resolve():this.wn(e,s,c,l,d)}))))})}Sn(e,t,r,i){return tl(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,t.key),documentKey:t.key.path.toArray()})}bn(e,t,r,i){return tl(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,t.key),t.key.path.toArray()])}pn(e,t,r){let i=tl(e),s=new Ze(js);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,t)])},(o,a)=>{s=s.add(new ha(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,t){let r=new Ze(js),i=this.An(t,e);if(i==null)return r;let s=lC(t);if(s!=null){let o=e.data.field(s.fieldPath);if(gh(o))for(let a of o.arrayValue.values||[])r=r.add(new ha(t.indexId,e.key,this.Tn(a),i))}else r=r.add(new ha(t.indexId,e.key,Ng,i));return r}wn(e,t,r,i,s){U("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,d,h,p){let _=c.getIterator(),E=l.getIterator(),A=el(_),R=el(E);for(;A||R;){let V=!1,J=!1;if(A&&R){let H=d(A,R);H<0?J=!0:H>0&&(V=!0)}else A!=null?J=!0:V=!0;V?(h(R),R=el(E)):J?(p(A),A=el(_)):(A=el(_),R=el(E))}}(i,s,js,a=>{o.push(this.Sn(e,t,r,a))},a=>{o.push(this.bn(e,t,r,a))}),P.waitFor(o)}gn(e){let t=1;return nl(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>js(o,a)).filter((o,a,c)=>!a||js(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=js(o,e),c=js(o,t);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Ng,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Ng,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,t){return js(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(oF)}getMinOffset(e,t){return P.mapArray(this.cn(t),r=>this.ln(e,r).next(i=>i||te())).next(oF)}};function sF(n){return Kt(n,"collectionParents")}function tl(n){return Kt(n,"indexEntries")}function th(n){return Kt(n,"indexConfiguration")}function nl(n){return Kt(n,"indexState")}function oF(n){ie(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;iS(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ir(e.readTime,e.documentKey,t)}var aF={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},wr=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function xL(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,h,p)=>(a++,p.delete()));s.push(c.next(()=>{ie(a===1)}));let l=[];for(let d of t.mutations){let h=OF(e,d.key.path,t.batchId);s.push(i.delete(h)),l.push(d.key)}return P.waitFor(s).next(()=>l)}function a_(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw te();e=n.noDocument}return JSON.stringify(e).length}wr.DEFAULT_COLLECTION_PERCENTILE=10,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wr.DEFAULT=new wr(41943040,wr.DEFAULT_COLLECTION_PERCENTILE,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wr.DISABLED=new wr(-1,0,0);var c_=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,t,r,i){ie(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return $s(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=al(e),o=$s(e);return o.add({}).next(a=>{ie(typeof a=="number");let c=new yh(a,t,r,i),l=function(_,E,A){let R=A.baseMutations.map(J=>bh(_.ct,J)),V=A.mutations.map(J=>bh(_.ct,J));return{userId:E,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:R,mutations:V}}(this.serializer,this.userId,c),d=[],h=new Ze((p,_)=>ge(p.canonicalString(),_.canonicalString()));for(let p of i){let _=OF(this.userId,p.key.path,a);h=h.add(p.key.path.popLast()),d.push(o.put(l)),d.push(s.put(_,CK))}return h.forEach(p=>{d.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),P.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return $s(e).get(t).next(r=>r?(ie(r.userId===this.userId),ua(this.serializer,r)):null)}vn(e,t){return this.Cn[t]?P.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return $s(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(ie(a.batchId>=r),s=ua(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return $s(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return $s(e).U("userMutationsIndex",t).next(r=>r.map(i=>ua(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Og(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return al(e).J({range:i},(o,a,c)=>{let[l,d,h]=o,p=gi(d);if(l===this.userId&&t.path.isEqual(p))return $s(e).get(h).next(_=>{if(!_)throw te();ie(_.userId===this.userId),s.push(ua(this.serializer,_))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ze(ge),i=[];return t.forEach(s=>{let o=Og(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=al(e).J({range:a},(l,d,h)=>{let[p,_,E]=l,A=gi(_);p===this.userId&&s.path.isEqual(A)?r=r.add(E):h.done()});i.push(c)}),P.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Og(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Ze(ge);return al(e).J({range:o},(c,l,d)=>{let[h,p,_]=c,E=gi(p);h===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(_)):d.done()}).next(()=>this.Fn(e,a))}Fn(e,t){let r=[],i=[];return t.forEach(s=>{i.push($s(e).get(s).next(o=>{if(o===null)throw te();ie(o.userId===this.userId),r.push(ua(this.serializer,o))}))}),P.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return xL(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),P.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return P.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return al(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=gi(s[1]);i.push(c)}else a.done()}).next(()=>{ie(i.length===0)})})}containsKey(e,t){return RL(e,this.userId,t)}xn(e){return NL(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function RL(n,e,t){let r=Og(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return al(n).J({range:s,H:!0},(a,c,l)=>{let[d,h,p]=a;d===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function $s(n){return Kt(n,"mutations")}function al(n){return Kt(n,"documentMutations")}function NL(n){return Kt(n,"mutationQueues")}var wl=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var KC=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let r=new wl(t.highestTargetId);return t.highestTargetId=r.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>oe.fromTimestamp(new mt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(t,r),this.kn(e,r))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>rl(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(ie(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return rl(e).J((o,a)=>{let c=sh(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>P.waitFor(s)).next(()=>i)}forEachTarget(e,t){return rl(e).J((r,i)=>{let s=sh(i);t(s)})}Bn(e){return cF(e).get("targetGlobalKey").next(t=>(ie(t!==null),t))}kn(e,t){return cF(e).put("targetGlobalKey",t)}qn(e,t){return rl(e).put(SL(this.serializer,t))}Qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=ya(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return rl(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=sh(a);Mh(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=qs(e);return t.forEach(o=>{let a=Cn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),P.waitFor(i)}removeMatchingKeys(e,t,r){let i=qs(e);return P.forEach(t,s=>{let o=Cn(s.path);return P.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=qs(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=qs(e),s=ve();return i.J({range:r,H:!0},(o,a,c)=>{let l=gi(o[1]),d=new Y(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=Cn(t.path),i=IDBKeyRange.bound([r],[xF(r)],!1,!0),s=0;return qs(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return rl(e).get(t).next(r=>r?sh(r):null)}};function rl(n){return Kt(n,"targets")}function cF(n){return Kt(n,"targetGlobal")}function qs(n){return Kt(n,"targetDocuments")}function lF([n,e],[t,r]){let i=ge(n,t);return i===0?ge(e,r):i}var QC=class{constructor(e){this.Kn=e,this.buffer=new Ze(lF),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();lF(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},YC=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){U("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){so(t)?U("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield io(t)}yield this.zn(3e5)}))}},JC=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return P.resolve(er.oe);let r=new QC(t);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(U("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(aF)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),aF):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let r,i,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),il()<=Ee.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function w7(n,e){return new JC(n,e)}var XC=class{constructor(e,t){this.db=e,this.garbageCollector=w7(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Zn(e){let t=0;return this.Jn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(r,i)=>t(i))}addReference(e,t,r){return kg(e,r)}removeReference(e,t,r){return kg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return kg(e,t)}er(e,t){return function(i,s){let o=!1;return NL(i).Y(a=>RL(i,a,s).next(c=>(c&&(o=!0),P.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=t){let c=this.er(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,oe.min()),qs(e).delete(function(h){return[0,Cn(h.path)]}(o))))});i.push(c)}}).next(()=>P.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return kg(e,t)}Xn(e,t){let r=qs(e),i,s=er.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==er.oe&&t(new Y(gi(i)),s),s=l,i=c):s=er.oe}).next(()=>{s!==er.oe&&t(new Y(gi(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function kg(n,e){return qs(n).put(function(r,i){return{targetId:0,path:Cn(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var l_=class{constructor(){this.changes=new bi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ZC=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return aa(e).put(r)}removeEntry(e,t,r){return aa(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],r_(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.tr(e,r)))}getEntry(e,t){let r=Vt.newInvalidDocument(t);return aa(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(nh(t))},(i,s)=>{r=this.nr(t,s)}).next(()=>r)}rr(e,t){let r={size:0,document:Vt.newInvalidDocument(t)};return aa(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(nh(t))},(i,s)=>{r={document:this.nr(t,s),size:a_(s)}}).next(()=>r)}getEntries(e,t){let r=qn();return this.ir(e,t,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,t){let r=qn(),i=new at(Y.comparator);return this.ir(e,t,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,a_(o))}).next(()=>({documents:r,_r:i}))}ir(e,t,r){if(t.isEmpty())return P.resolve();let i=new Ze(hF);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(nh(i.first()),nh(i.last())),o=i.getIterator(),a=o.getNext();return aa(e).J({index:"documentKeyIndex",range:s},(c,l,d)=>{let h=Y.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&hF(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(nh(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),r_(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return aa(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=qn();for(let h of l){let p=this.nr(Y.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);p.isFoundDocument()&&(Fh(t,p)||i.has(p.key))&&(d=d.insert(p.key,p))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=qn(),o=dF(t,r),a=dF(t,Ir.max());return aa(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,d)=>{let h=this.nr(Y.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new eT(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return uF(e).get("remoteDocumentGlobalKey").next(t=>(ie(!!t),t))}tr(e,t){return uF(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let r=_7(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(oe.min())))return r}return Vt.newInvalidDocument(e)}};function kL(n){return new ZC(n)}var eT=class extends l_{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new bi(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Ze((s,o)=>ge(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=JO(this.ar.serializer,o);i=i.add(s.path.popLast());let l=a_(c);r+=l-a.size,t.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=JO(this.ar.serializer,o.convertToNoDocument(oe.min()));t.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,r)),P.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(r=>(this.ur.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function uF(n){return Kt(n,"remoteDocumentGlobal")}function aa(n){return Kt(n,"remoteDocumentsV14")}function nh(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function dF(n,e){let t=e.documentKey.path.toArray();return[n,r_(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function hF(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ge(t[s],r[s]),i)return i;return i=ge(t.length,r.length),i||(i=ge(t[t.length-2],r[r.length-2]),i||ge(t[t.length-1],r[r.length-1]))}var tT=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var u_=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ch(r.mutation,i,tr.empty(),mt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ve()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ve()){let i=_i();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=ih();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=_i();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ve()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=qn(),o=ah(),a=function(){return ah()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof Hr)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),ch(d.mutation,l,d.mutation.getFieldMask(),mt.now())):o.set(l.key,tr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var h;return a.set(l,new tT(d,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=ah(),i=new at((o,a)=>o-a),s=ve();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||tr.empty();d=a.applyToLocalView(l,d),r.set(c,d);let h=(i.get(a.batchId)||ve()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,h=nL();d.forEach(p=>{if(!s.has(p)){let _=uL(t.get(p),r.get(p));_!==null&&h.set(p,_),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return P.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return Y.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):cS(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(_i()),a=-1,c=s;return o.next(l=>P.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?P.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,ve())).next(d=>({batchId:a,changes:tL(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Y(t)).next(r=>{let i=ih();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=ih();return this.indexManager.getCollectionParents(e,s).next(a=>P.forEach(a,c=>{let l=function(h,p){return new $r(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,p)=>{o=o.insert(h,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,Vt.newInvalidDocument(d)))});let a=ih();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&ch(d.mutation,l,tr.empty(),mt.now()),Fh(t,l)&&(a=a.insert(c,l))}),a})}};var nT=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return P.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:xt(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:hS(i.bundledQuery),readTime:xt(i.readTime)}}(t)),P.resolve()}};var rT=class{constructor(){this.overlays=new at(Y.comparator),this.hr=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=_i();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=_i(),s=t.length+1,o=new Y(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new at((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=_i(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=_i(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return P.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new vh(t,r));let s=this.hr.get(t);s===void 0&&(s=ve(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var Th=class{constructor(){this.Pr=new Ze(Ft.Ir),this.Tr=new Ze(Ft.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new Ft(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new Ft(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new Y(new Fe([])),r=new Ft(t,e),i=new Ft(t,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new Y(new Fe([])),r=new Ft(t,e),i=new Ft(t,e+1),s=ve();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Ft(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ft=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return Y.comparator(e.key,t.key)||ge(e.pr,t.pr)}static Er(e,t){return ge(e.pr,t.pr)||Y.comparator(e.key,t.key)}};var iT=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new Ze(Ft.Ir)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new yh(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new Ft(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return P.resolve(o)}lookupMutationBatch(e,t){return P.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ft(t,0),i=new Ft(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ze(ge);return t.forEach(i=>{let s=new Ft(i,0),o=new Ft(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),P.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;Y.isDocumentKey(s)||(s=s.child(""));let o=new Ft(new Y(s),0),a=new Ze(ge);return this.wr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.pr)),!0)},o),P.resolve(this.Dr(a))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ie(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return P.forEach(t.mutations,i=>{let s=new Ft(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new Ft(t,0),i=this.wr.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var sT=class{constructor(e){this.vr=e,this.docs=function(){return new at(Y.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():Vt.newInvalidDocument(t))}getEntries(e,t){let r=qn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Vt.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=qn(),o=t.path,a=new Y(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||iS(NF(d),r)<=0||(i.has(d.key)||Fh(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,r,i){te()}Fr(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new oT(this)}getSize(e){return P.resolve(this.size)}},oT=class extends l_{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var aT=class{constructor(e){this.persistence=e,this.Mr=new bi(t=>ya(t),Mh),this.lastRemoteSnapshotVersion=oe.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Th,this.targetCount=0,this.Lr=wl.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),P.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new wl(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.qn(t),P.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.Nr.containsKey(t))}};var d_=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new er(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new aT(this),this.indexManager=new GC,this.remoteDocumentCache=function(i){return new sT(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new n_(t),this.$r=new nT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new rT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new iT(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){U("MemoryPersistence","Starting transaction:",e);let i=new cT(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return P.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},cT=class extends qg{constructor(e){super(),this.currentSequenceNumber=e}},h_=class n{constructor(e){this.persistence=e,this.zr=new Th,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw te()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),P.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Jr,r=>{let i=Y.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,oe.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return P.or([()=>P.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var lT=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new zg("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xO,{unique:!0}),c.createObjectStore("documentMutations")}(e),fF(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=P.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),fF(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:oe.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xO,{unique:!0});let h=l.store("mutations"),p=d.map(_=>h.put(_));return P.waitFor(p)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:FK});l.createIndex("collectionPathOverlayIndex",LK,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",VK,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:TK});l.createIndex("documentKeyIndex",SK),l.createIndex("collectionGroupIndex",DK)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:kK}).createIndex("sequenceNumberIndex",PK,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:MK}).createIndex("documentKeyIndex",OK,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=a_(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>P.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>P.forEach(a,c=>{ie(c.userId===s.userId);let l=ua(this.serializer,c);return xL(e,s.userId,l).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new Fe(o),l=function(h){return[0,Cn(h)]}(c);s.push(t.get(l).next(d=>d?P.resolve():(h=>t.put({targetId:0,path:Cn(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>P.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:NK});let r=t.store("collectionParents"),i=new Ch,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Cn(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new Fe(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],l)=>{let d=gi(a);return s(d.popLast())}))}ri(e){let t=e.store("targets");return t.J((r,i)=>{let s=sh(i),o=SL(this.serializer,s);return t.put(o)})}ii(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(h){return h.document?new Y(Fe.fromString(h.document.name).popFirst(5)):h.noDocument?Y.fromSegments(h.noDocument.path):h.unknownDocument?Y.fromSegments(h.unknownDocument.path):te()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>P.waitFor(i))}si(e,t){let r=t.store("mutations"),i=kL(this.serializer),s=new d_(h_.Hr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:ve();ua(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),P.forEach(a,(c,l)=>{let d=new Lt(l),h=i_.lt(this.serializer,d),p=s.getIndexManager(d),_=c_.lt(d,this.serializer,p,s.referenceDelegate);return new u_(i,_,h,p).recalculateAndSaveOverlaysForDocumentKeys(new fh(t,er.oe),c).next()})})}};function fF(n){n.createObjectStore("targetDocuments",{keyPath:xK}).createIndex("documentTargetsIndex",RK,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",AK,{unique:!0}),n.createObjectStore("targetGlobal")}var Zb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",uT=class n{constructor(e,t,r,i,s,o,a,c,l,d,h=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=l,this.ai=d,this.ui=h,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=p=>Promise.resolve(),!n.D())throw new L(O.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new XC(this,i),this.Ti=t+"main",this.serializer=new n_(c),this.Ei=new Qs(this.Ti,this.ui,new lT(this.serializer)),this.Qr=new KC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=kL(this.serializer),this.$r=new UC,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,d===!1&&St("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new L(O.FAILED_PRECONDITION,Zb);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new er(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>g(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>g(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Pg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(so(e))return U("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return U("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return rh(e).get("owner").next(t=>P.resolve(this.Si(t)))}bi(e){return Pg(e).delete(this.clientId)}Di(){return g(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Kt(t,"clientMetadata");return r.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return P.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?P.resolve(!0):rh(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new L(O.FAILED_PRECONDITION,Zb);return!1}}return!(!this.networkEnabled||!this.inForeground)||Pg(e).U().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&U("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return g(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new fh(e,er.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(r=>this.Ci(r.updateTimeMs,t)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Pg(e).U().next(t=>this.vi(t,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return c_.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new WC(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return i_.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,r){U("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===16?BK:c===15?UF:c===14?VF:c===13?LF:c===12?UK:c===11?FF:void te()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new fh(a,this.kr?this.kr.next():er.oe),t==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw St(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new L(O.FAILED_PRECONDITION,kF);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return rh(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new L(O.FAILED_PRECONDITION,Zb)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return rh(e).put("owner",t)}static D(){return Qs.D()}yi(e){let t=rh(e);return t.get("owner").next(r=>this.Si(r)?(U("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):P.resolve())}Ci(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(St(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;zI()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let r=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return U("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return St("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){St("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function rh(n){return Kt(n,"owner")}function Pg(n){return Kt(n,"clientMetadata")}function pS(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var dT=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=ve(),i=ve();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var hT=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var f_=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return zI()?8:PF(Xe())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new hT;return this.Ji(e,t,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(il()<=Ee.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",sl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),P.resolve()):(il()<=Ee.DEBUG&&U("QueryEngine","Query:",sl(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(il()<=Ee.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",sl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Tn(t))):P.resolve())}ji(e,t){if(BO(t))return P.resolve(null);let r=Tn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Xg(t,null,"F"),r=Tn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ve(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.Zi(t,a);return this.Xi(t,l,o,c.readTime)?this.ji(e,Xg(t,null,"F")):this.es(e,l,t,c)}))})))}Hi(e,t,r,i){return BO(t)||i.isEqual(oe.min())?P.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,r,i)?P.resolve(null):(il()<=Ee.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),sl(t)),this.es(e,o,t,RF(i,-1)).next(a=>a))})}Zi(e,t){let r=new Ze(ZF(e));return t.forEach((i,s)=>{Fh(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return il()<=Ee.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",sl(t)),this.zi.getDocumentsMatchingQuery(e,t,Ir.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var fT=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new at(ge),this.rs=new bi(s=>ya(s),Mh),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new u_(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function PL(n,e,t,r){return new fT(n,e,t,r)}function ML(n,e){return g(this,null,function*(){let t=Q(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=ve();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})})}function E7(n,e){let t=Q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let h=l.batch,p=h.keys(),_=P.resolve();return p.forEach(E=>{_=_.next(()=>d.getEntry(c,E)).next(A=>{let R=l.docVersions.get(E);ie(R!==null),A.version.compareTo(R)<0&&(h.applyToRemoteDocument(A,l),A.isValidDocument()&&(A.setReadTime(l.commitVersion),d.addEntry(A)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ve();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function OL(n){let e=Q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function I7(n,e){let t=Q(n),r=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let a=[];e.targetChanges.forEach((d,h)=>{let p=i.get(h);if(!p)return;a.push(t.Qr.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Qr.addMatchingKeys(s,d.addedDocuments,h)));let _=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?_=_.withResumeToken(Wt.EMPTY_BYTE_STRING,oe.min()).withLastLimboFreeSnapshotVersion(oe.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(h,_),function(A,R,V){return A.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(p,_,d)&&a.push(t.Qr.updateTargetData(s,_))});let c=qn(),l=ve();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(FL(s,o,e.documentUpdates).next(d=>{c=d.cs,l=d.ls})),!r.isEqual(oe.min())){let d=t.Qr.getLastRemoteSnapshotVersion(s).next(h=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return P.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.ns=i,s))}function FL(n,e,t){let r=ve(),i=ve();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=qn();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(oe.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):U("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:i}})}function b7(n,e){let t=Q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function El(n,e){let t=Q(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,P.resolve(i)):t.Qr.allocateTargetId(r).next(o=>(i=new vl(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}function Il(n,e,t){return g(this,null,function*(){let r=Q(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!so(o))throw o;U("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function p_(n,e,t){let r=Q(n),i=oe.min(),s=ve();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let h=Q(c),p=h.rs.get(d);return p!==void 0?P.resolve(h.ns.get(p)):h.Qr.getTargetData(l,d)}(r,o,Tn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?i:oe.min(),t?s:ve())).next(a=>(UL(r,XF(e),a),{documents:a,hs:s})))}function LL(n,e){let t=Q(n),r=Q(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function VL(n,e){let t=Q(n),r=t.ss.get(e)||oe.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,RF(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(UL(t,e,i),i))}function UL(n,e,t){let r=n.ss.get(e)||oe.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}function C7(n,e,t,r){return g(this,null,function*(){let i=Q(n),s=ve(),o=qn();for(let l of t){let d=e.Ps(l.metadata.name);l.document&&(s=s.add(d));let h=e.Is(l);h.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(d,h)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield El(i,function(d){return Tn(Rl(Fe.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>FL(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Qr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.cs,d.ls)).next(()=>d.cs)))})}function T7(r,i){return g(this,arguments,function*(n,e,t=ve()){let s=yield El(n,Tn(hS(e.bundledQuery))),o=Q(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=xt(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let l=s.withResumeToken(Wt.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(a,l).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,t,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function pF(n,e){return`firestore_clients_${n}_${e}`}function mF(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function eC(n,e){return`firestore_targets_${n}_${e}`}var m_=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Es(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new L(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(St("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},lh=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Es(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new L(r.error.code,r.error.message))),s?new n(e,r.state,i):(St("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},g_=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=lS();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=MF(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(St("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},pT=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(St("SharedClientState",`Failed to parse online state: ${e}`),null)}},Sh=class{constructor(){this.activeTargetIds=lS()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},uh=class{constructor(e,t,r,i,s){this.window=e,this.oi=t,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new at(ge),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=pF(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Sh),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(pF(this.persistenceKey,r));if(i){let s=g_.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let r=this.xs(t);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,r){this.Ls(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(eC(this.persistenceKey,e));if(r){let i=lh.Es(e,r);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(eC(this.persistenceKey,e))}updateQueryState(e,t,r){this.qs(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return U("SharedClientState","READ",e,t),t}setItem(e,t){U("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){U("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(U("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void St("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let r=this.$s(t.key);return this.Us(r,null)}{let r=this.Ws(t.key,t.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let r=this.Gs(t.key,t.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let r=this.js(t.key,t.newValue);if(r)return this.Hs(r)}}else if(t.key===this.vs){if(t.newValue!==null){let r=this.xs(t.newValue);if(r)return this.Os(r)}}else if(t.key===this.Ss){let r=function(s){let o=er.oe;if(s!=null)try{let a=JSON.parse(s);ie(typeof a=="number"),o=a}catch(a){St("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==er.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Fs){let r=this.Js(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,r){let i=new m_(this.currentUser,e,t,r),s=mF(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let t=mF(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,r){let i=eC(this.persistenceKey,e),s=new lh(e,t,r);this.setItem(i,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let r=this.$s(e);return g_.Es(r,t)}Gs(e,t){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return m_.Es(new Lt(s),i,t)}js(e,t){let r=this.Cs.exec(e),i=Number(r[1]);return lh.Es(i,t)}xs(e){return pT.Es(e)}Js(e){return JSON.parse(e)}zs(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);U("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let r=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=lS();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},__=class{constructor(){this.no=new Sh,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Sh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var mT=class{io(e){}shutdown(){}};var y_=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Mg=null;function tC(){return Mg===null?Mg=function(){return 268435456+Math.round(2147483648*Math.random())}():Mg++,"0x"+Mg.toString(16)}var S7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var gT=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var fn="WebChannelConnection",_T=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,o){let a=tC(),c=this.vo(t,r.toUriEncodedString());U("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(l,s,o),this.Mo(t,c,l,i).then(d=>(U("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Er("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}xo(t,r,i,s,o,a){return this.Co(t,r,i,s,o)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+xl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,r){let i=S7[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=tC();return new Promise((o,a)=>{let c=new Gb;c.setWithCredentials(!0),c.listenOnce(Kb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Zd.NO_ERROR:let d=c.getResponseJson();U(fn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Zd.TIMEOUT:U(fn,`RPC '${e}' ${s} timed out`),a(new L(O.DEADLINE_EXCEEDED,"Request time out"));break;case Zd.HTTP_ERROR:let h=c.getStatus();if(U(fn,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);let _=p?.error;if(_&&_.status&&_.message){let E=function(R){let V=R.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(V)>=0?V:O.UNKNOWN}(_.status);a(new L(E,_.message))}else a(new L(O.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new L(O.UNAVAILABLE,"Connection failed."));break;default:te()}}finally{U(fn,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);U(fn,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Oo(e,t,r){let i=tC(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Jb(),a=Yb(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Wb({})),this.Fo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");U(fn,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c),p=!1,_=!1,E=new gT({lo:R=>{_?U(fn,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(p||(U(fn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),U(fn,`RPC '${e}' stream ${i} sending:`,R),h.send(R))},ho:()=>h.close()}),A=(R,V,J)=>{R.listen(V,H=>{try{J(H)}catch(ee){setTimeout(()=>{throw ee},0)}})};return A(h,Zc.EventType.OPEN,()=>{_||(U(fn,`RPC '${e}' stream ${i} transport opened.`),E.mo())}),A(h,Zc.EventType.CLOSE,()=>{_||(_=!0,U(fn,`RPC '${e}' stream ${i} transport closed`),E.po())}),A(h,Zc.EventType.ERROR,R=>{_||(_=!0,Er(fn,`RPC '${e}' stream ${i} transport errored:`,R),E.po(new L(O.UNAVAILABLE,"The operation could not be completed")))}),A(h,Zc.EventType.MESSAGE,R=>{var V;if(!_){let J=R.data[0];ie(!!J);let H=J,ee=H.error||((V=H[0])===null||V===void 0?void 0:V.error);if(ee){U(fn,`RPC '${e}' stream ${i} received error:`,ee);let de=ee.status,re=function(C){let D=Ot[C];if(D!==void 0)return fL(D)}(de),S=ee.message;re===void 0&&(re=O.INTERNAL,S="Unknown error status: "+de+" with message "+ee.message),_=!0,E.po(new L(re,S)),h.close()}else U(fn,`RPC '${e}' stream ${i} received:`,J),E.yo(J)}}),A(a,Qb.STAT_EVENT,R=>{R.stat===Rg.PROXY?U(fn,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Rg.NOPROXY&&U(fn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.fo()},0),E}};function BL(){return typeof window<"u"?window:null}function Ug(){return typeof document<"u"?document:null}function Lh(n){return new MC(n,!0)}var Dh=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&U("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var v_=class{constructor(e,t,r,i,s,o,a,c){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Dh(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return g(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return g(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return g(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(St(t.toString()),St("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new L(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>g(this,null,function*(){this.state=0,this.start()}))}c_(e){return U("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},yT=class extends v_{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=l7(this.serializer,e),r=function(s){if(!("targetChange"in s))return oe.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?oe.min():o.readTime?xt(o.readTime):oe.min()}(e);return this.listener.h_(t,r)}P_(e){let t={};t.database=LC(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=Yg(c)?{documents:EL(s,c)}:{query:dS(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=mL(s,o.resumeToken);let l=OC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(oe.min())>0){a.readTime=yl(s,o.snapshotVersion.toTimestamp());let l=OC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=h7(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){let t={};t.database=LC(this.serializer),t.removeTarget=e,this.i_(t)}},vT=class extends v_{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(ie(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=u7(e.writeResults,e.commitTime),r=xt(e.commitTime);return this.listener.A_(r,t)}return ie(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=LC(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>bh(this.serializer,r))};this.i_(t)}};var wT=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new L(O.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,FC(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(O.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,FC(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new L(O.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},ET=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(St(t),this.y_=!1):U("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var IT=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>g(this,null,function*(){oo(this)&&(U("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let l=Q(c);l.M_.add(4),yield Nl(l),l.N_.set("Unknown"),l.M_.delete(4),yield Vh(l)})}(this))}))}),this.N_=new ET(r,i)}};function Vh(n){return g(this,null,function*(){if(oo(n))for(let e of n.x_)yield e(!0)})}function Nl(n){return g(this,null,function*(){for(let e of n.x_)yield e(!1)})}function V_(n,e){let t=Q(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),_S(t)?gS(t):Pl(t).Xo()&&mS(t,e))}function bl(n,e){let t=Q(n),r=Pl(t);t.F_.delete(e),r.Xo()&&jL(t,e),t.F_.size===0&&(r.Xo()?r.n_():oo(t)&&t.N_.set("Unknown"))}function mS(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(oe.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Pl(n).P_(e)}function jL(n,e){n.L_.xe(e),Pl(n).I_(e)}function gS(n){n.L_=new PC({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Pl(n).start(),n.N_.w_()}function _S(n){return oo(n)&&!Pl(n).Zo()&&n.F_.size>0}function oo(n){return Q(n).M_.size===0}function $L(n){n.L_=void 0}function D7(n){return g(this,null,function*(){n.N_.set("Online")})}function A7(n){return g(this,null,function*(){n.F_.forEach((e,t)=>{mS(n,e)})})}function x7(n,e){return g(this,null,function*(){$L(n),_S(n)?(n.N_.D_(e),gS(n)):n.N_.set("Unknown")})}function R7(n,e,t){return g(this,null,function*(){if(n.N_.set("Online"),e instanceof e_&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(n,e)}catch(r){U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield w_(n,r)}else if(e instanceof dl?n.L_.Ke(e):e instanceof Zg?n.L_.He(e):n.L_.We(e),!t.isEqual(oe.min()))try{let r=yield OL(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.F_.get(l);d&&s.F_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.F_.get(c);if(!d)return;s.F_.set(c,d.withResumeToken(Wt.EMPTY_BYTE_STRING,d.snapshotVersion)),jL(s,c);let h=new vl(d.target,c,l,d.sequenceNumber);mS(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){U("RemoteStore","Failed to raise snapshot:",r),yield w_(n,r)}})}function w_(n,e,t){return g(this,null,function*(){if(!so(e))throw e;n.M_.add(1),yield Nl(n),n.N_.set("Offline"),t||(t=()=>OL(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){U("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield Vh(n)}))})}function HL(n,e){return e().catch(t=>w_(n,t,e))}function kl(n){return g(this,null,function*(){let e=Q(n),t=ro(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;N7(e);)try{let i=yield b7(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,k7(e,i)}catch(i){yield w_(e,i)}qL(e)&&zL(e)})}function N7(n){return oo(n)&&n.v_.length<10}function k7(n,e){n.v_.push(e);let t=ro(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function qL(n){return oo(n)&&!ro(n).Zo()&&n.v_.length>0}function zL(n){ro(n).start()}function P7(n){return g(this,null,function*(){ro(n).V_()})}function M7(n){return g(this,null,function*(){let e=ro(n);for(let t of n.v_)e.d_(t.mutations)})}function O7(n,e,t){return g(this,null,function*(){let r=n.v_.shift(),i=xC.from(r,e,t);yield HL(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield kl(n)})}function F7(n,e){return g(this,null,function*(){e&&ro(n).E_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return hL(o)&&o!==O.ABORTED}(i.code)){let s=r.v_.shift();ro(r).t_(),yield HL(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield kl(r)}})}(n,e)),qL(n)&&zL(n)})}function gF(n,e){return g(this,null,function*(){let t=Q(n);t.asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials");let r=oo(t);t.M_.add(3),yield Nl(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield Vh(t)})}function bT(n,e){return g(this,null,function*(){let t=Q(n);e?(t.M_.delete(2),yield Vh(t)):e||(t.M_.add(2),yield Nl(t),t.N_.set("Unknown"))})}function Pl(n){return n.B_||(n.B_=function(t,r,i){let s=Q(t);return s.f_(),new yT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:D7.bind(null,n),To:A7.bind(null,n),Ao:x7.bind(null,n),h_:R7.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.B_.t_(),_S(n)?gS(n):n.N_.set("Unknown")):(yield n.B_.stop(),$L(n))}))),n.B_}function ro(n){return n.k_||(n.k_=function(t,r,i){let s=Q(t);return s.f_(),new vT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:P7.bind(null,n),Ao:F7.bind(null,n),R_:M7.bind(null,n),A_:O7.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.k_.t_(),yield kl(n)):(yield n.k_.stop(),n.v_.length>0&&(U("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var CT=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Dt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ml(n,e){if(St("AsyncQueue",`${e}: ${n}`),so(n))return new L(O.UNAVAILABLE,`${e}: ${n}`);throw n}var E_=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Y.comparator(t.key,r.key):(t,r)=>Y.comparator(t.key,r.key),this.keyedMap=ih(),this.sortedSet=new at(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var I_=class{constructor(){this.q_=new at(Y.comparator)}track(e){let t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):te():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}},Cl=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,E_.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Oh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var TT=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},ST=class{constructor(){this.queries=new bi(e=>JF(e),Oh),this.onlineState="Unknown",this.z_=new Set}};function yS(n,e){return g(this,null,function*(){let t=Q(n),r=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new TT,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=Ml(o,`Initialization of query '${sl(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&wS(t)})}function vS(n,e){return g(this,null,function*(){let t=Q(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function L7(n,e){let t=Q(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&wS(t)}function V7(n,e,t){let r=Q(n),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(t);r.queries.delete(e)}function wS(n){n.z_.forEach(e=>{e.next()})}var DT,_F;(_F=DT||(DT={})).J_="default",_F.Cache="cache";var Ah=class{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Cl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Cl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==DT.Cache}};var AT=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var b_=class{constructor(e){this.serializer=e}Ps(e){return vi(this.serializer,e)}Is(e){return e.metadata.exists?wL(this.serializer,e.document,!1):Vt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return xt(e)}},xT=class{constructor(e,t,r){this.oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=GL(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let r=Fe.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,r=new b_(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||ve()).add(s);t.set(o,a)}}return t}complete(){return g(this,null,function*(){let e=yield C7(this.localStore,new b_(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let r of this.queries)yield T7(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function GL(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var C_=class{constructor(e){this.key=e}},T_=class{constructor(e){this.key=e}},S_=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=ve(),this.mutatedKeys=ve(),this.Ia=ZF(e),this.Ta=new E_(this.Ia)}get Ea(){return this.la}da(e,t){let r=t?t.Aa:new I_,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let p=i.get(d),_=Fh(this.query,h)?h:null,E=!!p&&this.mutatedKeys.has(p.key),A=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),R=!1;p&&_?p.data.isEqual(_.data)?E!==A&&(r.track({type:3,doc:_}),R=!0):this.Ra(p,_)||(r.track({type:2,doc:_}),R=!0,(c&&this.Ia(_,c)>0||l&&this.Ia(_,l)<0)&&(a=!0)):!p&&_?(r.track({type:0,doc:_}),R=!0):p&&!_&&(r.track({type:1,doc:p}),R=!0,(c||l)&&(a=!0)),R&&(_?(o=o.add(_),s=A?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((d,h)=>function(_,E){let A=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return te()}};return A(_)-A(E)}(d.type,h.type)||this.Ia(d.doc,h.doc)),this.Va(r),i=i!=null&&i;let a=t&&!i?this.ma():[],c=this.Pa.size===0&&this.current&&!i?1:0,l=c!==this.ha;return this.ha=c,o.length!==0||l?{snapshot:new Cl(this.query,e.Ta,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new I_,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=ve(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new T_(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new C_(r))}),t}pa(e){this.la=e.hs,this.Pa=ve();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Cl.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},RT=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},NT=class{constructor(e){this.key=e,this.wa=!1}},kT=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new bi(a=>JF(a),Oh),this.Da=new Map,this.Ca=new Set,this.va=new at(Y.comparator),this.Fa=new Map,this.Ma=new Th,this.xa={},this.Oa=new Map,this.Na=wl.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function U7(n,e,t=!0){return g(this,null,function*(){let r=U_(n),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield WL(r,e,t,!0),i})}function B7(n,e){return g(this,null,function*(){let t=U_(n);yield WL(t,e,!0,!1)})}function WL(n,e,t,r){return g(this,null,function*(){let i=yield El(n.localStore,Tn(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield ES(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&V_(n.remoteStore,i),a})}function ES(n,e,t,r,i){return g(this,null,function*(){n.Ba=(h,p,_)=>function(A,R,V,J){return g(this,null,function*(){let H=R.view.da(V);H.Xi&&(H=yield p_(A.localStore,R.query,!1).then(({documents:S})=>R.view.da(S,H)));let ee=J&&J.targetChanges.get(R.targetId),de=J&&J.targetMismatches.get(R.targetId)!=null,re=R.view.applyChanges(H,A.isPrimaryClient,ee,de);return PT(A,R.targetId,re.fa),re.snapshot})}(n,h,p,_);let s=yield p_(n.localStore,e,!0),o=new S_(e,s.hs),a=o.da(s.documents),c=Eh.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);PT(n,t,l.fa);let d=new RT(e,t,o);return n.ba.set(e,d),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),l.snapshot})}function j7(n,e,t){return g(this,null,function*(){let r=Q(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!Oh(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Il(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&bl(r.remoteStore,i.targetId),Tl(r,i.targetId)}).catch(io))):(Tl(r,i.targetId),yield Il(r.localStore,i.targetId,!0))})}function $7(n,e){return g(this,null,function*(){let t=Q(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),bl(t.remoteStore,r.targetId))})}function H7(n,e,t){return g(this,null,function*(){let r=TS(n);try{let i=yield function(o,a){let c=Q(o),l=mt.now(),d=a.reduce((_,E)=>_.add(E.key),ve()),h,p;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=qn(),A=ve();return c.os.getEntries(_,d).next(R=>{E=R,E.forEach((V,J)=>{J.isValidDocument()||(A=A.add(V))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,E)).next(R=>{h=R;let V=[];for(let J of a){let H=n7(J,h.get(J.key).overlayedDocument);H!=null&&V.push(new Hr(J.key,H,HF(H.value.mapValue),bt.exists(!0)))}return c.mutationQueue.addMutationBatch(_,l,V,a)}).next(R=>{p=R;let V=R.applyToLocalDocumentSet(h,A);return c.documentOverlayCache.saveOverlays(_,R.batchId,V)})}).then(()=>({batchId:p.batchId,changes:tL(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.xa[o.currentUser.toKey()];l||(l=new at(ge)),l=l.insert(a,c),o.xa[o.currentUser.toKey()]=l}(r,i.batchId,t),yield is(r,i.changes),yield kl(r.remoteStore)}catch(i){let s=Ml(i,"Failed to persist write");t.reject(s)}})}function KL(n,e){return g(this,null,function*(){let t=Q(n);try{let r=yield I7(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(ie(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?ie(o.wa):i.removedDocuments.size>0&&(ie(o.wa),o.wa=!1))}),yield is(t,r,e)}catch(r){yield io(r)}})}function yF(n,e,t){let r=Q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=Q(o);c.onlineState=a;let l=!1;c.queries.forEach((d,h)=>{for(let p of h.U_)p.j_(a)&&(l=!0)}),l&&wS(c)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function q7(n,e,t){return g(this,null,function*(){let r=Q(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new at(Y.comparator);o=o.insert(s,Vt.newNoDocument(s,oe.min()));let a=ve().add(s),c=new wh(oe.min(),new Map,new at(ge),o,a);yield KL(r,c),r.va=r.va.remove(s),r.Fa.delete(e),CS(r)}else yield Il(r.localStore,e,!1).then(()=>Tl(r,e,t)).catch(io)})}function z7(n,e){return g(this,null,function*(){let t=Q(n),r=e.batch.batchId;try{let i=yield E7(t.localStore,e);bS(t,r,null),IS(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield is(t,i)}catch(i){yield io(i)}})}function G7(n,e,t){return g(this,null,function*(){let r=Q(n);try{let i=yield function(o,a){let c=Q(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(ie(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);bS(r,e,t),IS(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield is(r,i)}catch(i){yield io(i)}})}function W7(n,e){return g(this,null,function*(){let t=Q(n);oo(t.remoteStore)||U("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=Q(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Oa.get(r)||[];i.push(e),t.Oa.set(r,i)}catch(r){let i=Ml(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function IS(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function bS(n,e,t){let r=Q(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Tl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||QL(n,r)})}function QL(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(bl(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),CS(n))}function PT(n,e,t){for(let r of t)r instanceof C_?(n.Ma.addReference(r.key,e),K7(n,r)):r instanceof T_?(U("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||QL(n,r.key)):te()}function K7(n,e){let t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(U("SyncEngine","New document in limbo: "+t),n.Ca.add(r),CS(n))}function CS(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new Y(Fe.fromString(e)),r=n.Na.next();n.Fa.set(r,new NT(t)),n.va=n.va.insert(t,r),V_(n.remoteStore,new vl(Tn(Rl(t.path)),r,"TargetPurposeLimboResolution",er.oe))}}function is(n,e,t){return g(this,null,function*(){let r=Q(n),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,c)=>{o.push(r.Ba(c,e,t).then(l=>{if((l||t)&&r.isPrimaryClient){let d=l&&!l.fromCache;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);let d=dT.Ki(c.targetId,l);s.push(d)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(c,l){return g(this,null,function*(){let d=Q(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>P.forEach(l,p=>P.forEach(p.qi,_=>d.persistence.referenceDelegate.addReference(h,p.targetId,_)).next(()=>P.forEach(p.Qi,_=>d.persistence.referenceDelegate.removeReference(h,p.targetId,_)))))}catch(h){if(!so(h))throw h;U("LocalStore","Failed to update sequence numbers: "+h)}for(let h of l){let p=h.targetId;if(!h.fromCache){let _=d.ns.get(p),E=_.snapshotVersion,A=_.withLastLimboFreeSnapshotVersion(E);d.ns=d.ns.insert(p,A)}}})}(r.localStore,s))})}function Q7(n,e){return g(this,null,function*(){let t=Q(n);if(!t.currentUser.isEqual(e)){U("SyncEngine","User change. New user:",e.toKey());let r=yield ML(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(c=>{c.reject(new L(O.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield is(t,r.us)}})}function Y7(n,e){let t=Q(n),r=t.Fa.get(e);if(r&&r.wa)return ve().add(r.key);{let i=ve(),s=t.Da.get(e);if(!s)return i;for(let o of s){let a=t.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function J7(n,e){return g(this,null,function*(){let t=Q(n),r=yield p_(t.localStore,e.query,!0),i=e.view.pa(r);return t.isPrimaryClient&&PT(t,e.targetId,i.fa),i})}function X7(n,e){return g(this,null,function*(){let t=Q(n);return VL(t.localStore,e).then(r=>is(t,r))})}function Z7(n,e,t,r){return g(this,null,function*(){let i=Q(n),s=yield function(a,c){let l=Q(a),d=Q(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.vn(h,c).next(p=>p?l.localDocuments.getDocuments(h,p):P.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield kl(i.remoteStore):t==="acknowledged"||t==="rejected"?(bS(i,e,r||null),IS(i,e),function(a,c){Q(Q(a).mutationQueue).Mn(c)}(i.localStore,e)):te(),yield is(i,s)):U("SyncEngine","Cannot apply mutation batch with id: "+e)})}function eQ(n,e){return g(this,null,function*(){let t=Q(n);if(U_(t),TS(t),e===!0&&t.La!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield vF(t,r.toArray());t.La=!0,yield bT(t.remoteStore,!0);for(let s of i)V_(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let r=[],i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Tl(t,o),Il(t.localStore,o,!0))),bl(t.remoteStore,o)}),yield i,yield vF(t,r),function(o){let a=Q(o);a.Fa.forEach((c,l)=>{bl(a.remoteStore,l)}),a.Ma.mr(),a.Fa=new Map,a.va=new at(Y.comparator)}(t),t.La=!1,yield bT(t.remoteStore,!1)}})}function vF(n,e,t){return g(this,null,function*(){let r=Q(n),i=[],s=[];for(let o of e){let a,c=r.Da.get(o);if(c&&c.length!==0){a=yield El(r.localStore,Tn(c[0]));for(let l of c){let d=r.ba.get(l),h=yield J7(r,d);h.snapshot&&s.push(h.snapshot)}}else{let l=yield LL(r.localStore,o);a=yield El(r.localStore,l),yield ES(r,YL(l),o,!1,a.resumeToken)}i.push(a)}return r.Sa.h_(s),i})}function YL(n){return QF(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function tQ(n){return function(t){return Q(Q(t).persistence).Bi()}(Q(n).localStore)}function nQ(n,e,t,r){return g(this,null,function*(){let i=Q(n);if(i.La)return void U("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield VL(i.localStore,XF(s[0])),a=wh.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Wt.EMPTY_BYTE_STRING);yield is(i,o,a);break}case"rejected":yield Il(i.localStore,e,!0),Tl(i,e,r);break;default:te()}})}function rQ(n,e,t){return g(this,null,function*(){let r=U_(n);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){U("SyncEngine","Adding an already active target "+i);continue}let s=yield LL(r.localStore,i),o=yield El(r.localStore,s);yield ES(r,YL(s),o.targetId,!1,o.resumeToken),V_(r.remoteStore,o)}for(let i of t)r.Da.has(i)&&(yield Il(r.localStore,i,!1).then(()=>{bl(r.remoteStore,i),Tl(r,i)}).catch(io))}})}function U_(n){let e=Q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=KL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Y7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=q7.bind(null,e),e.Sa.h_=L7.bind(null,e.eventManager),e.Sa.ka=V7.bind(null,e.eventManager),e}function TS(n){let e=Q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=z7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=G7.bind(null,e),e}function iQ(n,e,t){let r=Q(n);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(_,E){let A=Q(_),R=xt(E.createTime);return A.persistence.runTransaction("hasNewerBundle","readonly",V=>A.$r.getBundleMetadata(V,E.id)).then(V=>!!V&&V.createTime.compareTo(R)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(GL(c));let l=new xT(c,s.localStore,o.serializer),d=yield o.qa();for(;d;){let p=yield l._a(d);p&&a._updateProgress(p),d=yield o.qa()}let h=yield l.complete();return yield is(s,h.ca,void 0),yield function(_,E){let A=Q(_);return A.persistence.runTransaction("Save bundle","readwrite",R=>A.$r.saveBundleMetadata(R,E))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.ua)}catch(c){return Er("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var xh=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=Lh(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return PL(this.persistence,new f_,e.initialUser,this.serializer)}createPersistence(e){return new d_(h_.Hr,this.serializer)}createSharedClientState(e){return new __}terminate(){return g(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var D_=class n extends xh{constructor(e,t,r){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield Qr(n.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield TS(this.Qa.syncEngine),yield kl(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return PL(this.persistence,new f_,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new YC(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new fC(t,this.persistence);return new hC(e.asyncQueue,r)}createPersistence(e){let t=pS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?wr.withCacheSize(this.cacheSizeBytes):wr.DEFAULT;return new uT(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,BL(),Ug(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new __}},MT=class n extends D_{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield Qr(n.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof uh&&(this.sharedClientState.syncEngine={Zs:Z7.bind(null,t),Xs:nQ.bind(null,t),eo:rQ.bind(null,t),Bi:tQ.bind(null,t),Ys:X7.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>g(this,null,function*(){yield eQ(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=BL();if(!uh.D(t))throw new L(O.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=pS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new uh(t,e.asyncQueue,r,e.clientId,e.initialUser)}},Rh=class{initialize(e,t){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>yF(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Q7.bind(null,this.syncEngine),yield bT(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new ST}()}createDatastore(e){let t=Lh(e.databaseInfo.databaseId),r=function(s){return new _T(s)}(e.databaseInfo);return function(s,o,a,c){return new wT(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new IT(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>yF(this.syncEngine,t,0),function(){return y_.D()?new y_:new mT}())}createSyncEngine(e,t){return function(i,s,o,a,c,l,d){let h=new kT(i,s,o,a,c,l);return d&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return g(this,null,function*(){var e;yield function(r){return g(this,null,function*(){let i=Q(r);U("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Nl(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function wF(n,e=10240){let t=0;return{read(){return g(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Sl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):St("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var OT=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new Dt,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}qa(){return g(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return g(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),r=Number(t);isNaN(r)&&this.ja(`length string (${t}) is not valid number`);let i=yield this.Ha(r);return new AT(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return g(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return g(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var FT=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new L(O.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return g(this,null,function*(){let o=Q(i),a={documents:s.map(h=>Ih(o.serializer,h))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,Fe.emptyPath(),a,s.length),l=new Map;c.forEach(h=>{let p=c7(o.serializer,h);l.set(p.key.toString(),p)});let d=[];return s.forEach(h=>{let p=l.get(h.toString());ie(!!p),d.push(p)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new no(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=Y.fromPath(r);this.mutations.push(new _h(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=Q(r),o={writes:i.map(a=>bh(s.serializer,a))};yield s.Co("Commit",s.serializer.databaseId,Fe.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw te();t=oe.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new L(O.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(oe.min())?bt.exists(!1):bt.updateTime(t):bt.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(oe.min()))throw new L(O.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return bt.updateTime(t)}return bt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var LT=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Yo=new Dh(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>g(this,null,function*(){let e=new FT(this.datastore),t=this.tu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let t=this.updateFunction(e);return!Ph(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!hL(t)}return!1}};var VT=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Lt.UNAUTHENTICATED,this.clientId=$g.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){U("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(U("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new L(O.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Dt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Ml(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Bg(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield ML(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function UT(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield SS(n);U("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>gF(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>gF(e.remoteStore,i)),n._onlineComponents=e})}function JL(n){return n.name==="FirebaseError"?n.code===O.FAILED_PRECONDITION||n.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function SS(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Bg(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!JL(t))throw t;Er("Error using user provided cache. Falling back to memory cache: "+t),yield Bg(n,new xh)}}else U("FirestoreClient","Using default OfflineComponentProvider"),yield Bg(n,new xh);return n._offlineComponents})}function B_(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(U("FirestoreClient","Using user provided OnlineComponentProvider"),yield UT(n,n._uninitializedComponentsProvider._online)):(U("FirestoreClient","Using default OnlineComponentProvider"),yield UT(n,new Rh))),n._onlineComponents})}function XL(n){return SS(n).then(e=>e.persistence)}function DS(n){return SS(n).then(e=>e.localStore)}function ZL(n){return B_(n).then(e=>e.remoteStore)}function AS(n){return B_(n).then(e=>e.syncEngine)}function eV(n){return B_(n).then(e=>e.datastore)}function Dl(n){return g(this,null,function*(){let e=yield B_(n),t=e.eventManager;return t.onListen=U7.bind(null,e.syncEngine),t.onUnlisten=j7.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=B7.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=$7.bind(null,e.syncEngine),t})}function sQ(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield XL(n),t=yield ZL(n);return e.setNetworkEnabled(!0),function(i){let s=Q(i);return s.M_.delete(0),Vh(s)}(t)}))}function oQ(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield XL(n),t=yield ZL(n);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=Q(i);s.M_.add(0),yield Nl(s),s.N_.set("Offline")})}(t)}))}function aQ(n,e){let t=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(l,d){let h=Q(l);return h.persistence.runTransaction("read document","readonly",p=>h.localDocuments.getDocument(p,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new L(O.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Ml(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield DS(n),e,t)})),t.promise}function tV(n,e,t={}){let r=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new Sl({next:p=>{o.enqueueAndForget(()=>vS(s,h));let _=p.docs.has(a);!_&&p.fromCache?l.reject(new L(O.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&c&&c.source==="server"?l.reject(new L(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new Ah(Rl(a.path),d,{includeMetadataChanges:!0,ra:!0});return yS(s,h)}(yield Dl(n),n.asyncQueue,e,t,r)})),r.promise}function cQ(n,e){let t=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield p_(i,s,!0),c=new S_(s,a.hs),l=c.da(a.documents),d=c.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let c=Ml(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield DS(n),e,t)})),t.promise}function nV(n,e,t={}){let r=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new Sl({next:p=>{o.enqueueAndForget(()=>vS(s,h)),p.fromCache&&c.source==="server"?l.reject(new L(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new Ah(a,d,{includeMetadataChanges:!0,ra:!0});return yS(s,h)}(yield Dl(n),n.asyncQueue,e,t,r)})),r.promise}function lQ(n,e,t){let r=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){try{let i=yield eV(n);r.resolve(function(o,a,c){return g(this,null,function*(){var l;let d=Q(o),{request:h,ut:p,parent:_}=d7(d.serializer,GK(a),c);d.connection.Do||delete h.parent;let E=(yield d.xo("RunAggregationQuery",d.serializer.databaseId,_,h,1)).filter(R=>!!R.result);ie(E.length===1);let A=(l=E[0].result)===null||l===void 0?void 0:l.aggregateFields;return Object.keys(A).reduce((R,V)=>(R[p[V]]=A[V],R),{})})}(i,e,t))}catch(i){r.reject(i)}})),r.promise}function uQ(n,e){let t=new Sl(e);return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){Q(i).z_.add(s),s.next()}(yield Dl(n),t)})),()=>{t.$a(),n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){Q(i).z_.delete(s)}(yield Dl(n),t)}))}}function dQ(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?pL().encode(o):o,function(d,h){return new OT(d,h)}(function(d,h){if(d instanceof Uint8Array)return wF(d,h);if(d instanceof ArrayBuffer)return wF(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,Lh(e));n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){iQ(yield AS(n),i,r)}))}function hQ(n,e){return n.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=Q(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield DS(n),e)}))}function rV(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var EF=new Map;function xS(n,e,t){if(!t)throw new L(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function RS(n,e,t,r){if(e===!0&&r===!0)throw new L(O.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function IF(n){if(!Y.isDocumentKey(n))throw new L(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function bF(n){if(Y.isDocumentKey(n))throw new L(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function j_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":te()}function Ne(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=j_(n);throw new L(O.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function iV(n,e){if(e<=0)throw new L(O.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var A_=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new L(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new L(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}RS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rV((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ia=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new A_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new L(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new L(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new A_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new nC;switch(r.type){case"firstParty":return new oC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=EF.get(t);r&&(U("ComponentProvider","Removing Datastore"),EF.delete(t),r.terminate())}(this),Promise.resolve()}};function sV(n,e,t,r={}){var i;let s=(n=Ne(n,Ia))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Er("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Lt.MOCK_USER;else{a=Vc(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new L(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Lt(l)}n._authCredentials=new rC(new jg(a,c))}}var en=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},rt=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},wi=class n extends en{constructor(e,t,r){super(e,t,Rl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new rt(this.firestore,null,new Y(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Cr(n,e,...t){if(n=K(n),xS("collection","path",e),n instanceof Ia){let r=Fe.fromString(e,...t);return bF(r),new wi(n,null,r)}{if(!(n instanceof rt||n instanceof wi))throw new L(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Fe.fromString(e,...t));return bF(r),new wi(n.firestore,null,r)}}function oV(n,e){if(n=Ne(n,Ia),xS("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new L(O.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new en(n,null,function(r){return new $r(Fe.emptyPath(),r)}(e))}function Uh(n,e,...t){if(n=K(n),arguments.length===1&&(e=$g.newId()),xS("doc","path",e),n instanceof Ia){let r=Fe.fromString(e,...t);return IF(r),new rt(n,null,new Y(r))}{if(!(n instanceof rt||n instanceof wi))throw new L(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Fe.fromString(e,...t));return IF(r),new rt(n.firestore,n instanceof wi?n.converter:null,new Y(r))}}function NS(n,e){return n=K(n),e=K(e),(n instanceof rt||n instanceof wi)&&(e instanceof rt||e instanceof wi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function kS(n,e){return n=K(n),e=K(e),n instanceof en&&e instanceof en&&n.firestore===e.firestore&&Oh(n._query,e._query)&&n.converter===e.converter}var BT=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Dh(this,"async_queue_retry"),this.hu=()=>{let t=Ug();t&&U("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=Ug();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=Ug();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new Dt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return g(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!so(e))throw e;U("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw St("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=CT.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&te()}verifyOperationInProgress(){}du(){return g(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function jT(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var $T=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Dt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var aV=-1,ct=class extends Ia{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new BT}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||cV(this),this._firestoreClient.terminate()}};function Ut(n){return n._firestoreClient||cV(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function cV(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,d){return new pC(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,rV(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new VT(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function lV(n,e){yV(n=Ne(n,ct));let t=Ut(n);if(t._uninitializedComponentsProvider)throw new L(O.FAILED_PRECONDITION,"SDK cache is already specified.");Er("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new Rh;return dV(t,i,new D_(i,r.cacheSizeBytes,e?.forceOwnership))}function uV(n){yV(n=Ne(n,ct));let e=Ut(n);if(e._uninitializedComponentsProvider)throw new L(O.FAILED_PRECONDITION,"SDK cache is already specified.");Er("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new Rh;return dV(e,r,new MT(r,t.cacheSizeBytes))}function dV(n,e,t){let r=new Dt;return n.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield Bg(n,t),yield UT(n,e),r.resolve()}catch(i){let s=i;if(!JL(s))throw s;Er("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function hV(n){if(n._initialized&&!n._terminated)throw new L(O.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Dt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!Qs.D())return Promise.resolve();let i=r+"main";yield Qs.delete(i)})}(pS(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function fV(n){return function(t){let r=new Dt;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return W7(yield AS(t),r)})),r.promise}(Ut(n=Ne(n,ct)))}function pV(n){return sQ(Ut(n=Ne(n,ct)))}function mV(n){return oQ(Ut(n=Ne(n,ct)))}function gV(n,e){let t=Ut(n=Ne(n,ct)),r=new $T;return dQ(t,n._databaseId,e,r),r}function _V(n,e){return hQ(Ut(n=Ne(n,ct)),e).then(t=>t?new en(n,null,t.query):null)}function yV(n){if(n._initialized||n._terminated)throw new L(O.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var HT=class{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}},qT=class{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}};var Ci=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Wt.fromBase64String(e))}catch(t){throw new L(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Wt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var qr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new At(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var rs=class{constructor(e){this._methodName=e}};var ba=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ge(this._lat,e._lat)||ge(this._long,e._long)}};var fQ=/^__.*__$/,zT=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Hr(e,this.data,this.fieldMask,t,this.fieldTransforms):new to(e,this.data,t,this.fieldTransforms)}},x_=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Hr(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function vV(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw te()}}var R_=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return N_(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(vV(this.fu)&&fQ.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},GT=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Lh(e)}Fu(e,t,r,i=!1){return new R_({fu:e,methodName:t,vu:r,path:At.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Da(n){let e=n._freezeSettings(),t=Lh(n._databaseId);return new GT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function $_(n,e,t,r,i,s={}){let o=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);OS("Data must be an object, but it was:",o,r);let a=IV(r,o),c,l;if(s.merge)c=new tr(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let p=JT(e,h,t);if(!o.contains(p))throw new L(O.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);CV(d,p)||d.push(p)}c=new tr(d),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new zT(new pn(a),c,l)}var Nh=class n extends rs{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function wV(n,e,t){return new R_({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var WT=class n extends rs{_toFieldTransform(e){return new va(e.path,new Zs)}isEqual(e){return e instanceof n}},KT=class n extends rs{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=wV(this,e,!0),r=this.Mu.map(s=>Aa(s,t)),i=new ts(r);return new va(e.path,i)}isEqual(e){return e instanceof n&&Ns(this.Mu,e.Mu)}},QT=class n extends rs{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=wV(this,e,!0),r=this.Mu.map(s=>Aa(s,t)),i=new ns(r);return new va(e.path,i)}isEqual(e){return e instanceof n&&Ns(this.Mu,e.Mu)}},YT=class n extends rs{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new eo(e.serializer,sL(e.serializer,this.xu));return new va(e.path,t)}isEqual(e){return e instanceof n&&this.xu===e.xu}};function PS(n,e,t,r){let i=n.Fu(1,e,t);OS("Data must be an object, but it was:",i,r);let s=[],o=pn.empty();Sa(r,(c,l)=>{let d=FS(e,c,t);l=K(l);let h=i.Su(d);if(l instanceof Nh)s.push(d);else{let p=Aa(l,h);p!=null&&(s.push(d),o.set(d,p))}});let a=new tr(s);return new x_(o,a,i.fieldTransforms)}function MS(n,e,t,r,i,s){let o=n.Fu(1,e,t),a=[JT(e,r,t)],c=[i];if(s.length%2!=0)throw new L(O.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(JT(e,s[p])),c.push(s[p+1]);let l=[],d=pn.empty();for(let p=a.length-1;p>=0;--p)if(!CV(l,a[p])){let _=a[p],E=c[p];E=K(E);let A=o.Su(_);if(E instanceof Nh)l.push(_);else{let R=Aa(E,A);R!=null&&(l.push(_),d.set(_,R))}}let h=new tr(l);return new x_(d,h,o.fieldTransforms)}function EV(n,e,t,r=!1){return Aa(t,n.Fu(r?4:3,e))}function Aa(n,e){if(bV(n=K(n)))return OS("Unsupported field value:",e,n),IV(n,e);if(n instanceof rs)return function(r,i){if(!vV(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Aa(a,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=K(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return sL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=mt.fromDate(r);return{timestampValue:yl(i.serializer,s)}}if(r instanceof mt){let s=new mt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:yl(i.serializer,s)}}if(r instanceof ba)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ci)return{bytesValue:mL(i.serializer,r._byteString)};if(r instanceof rt){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:uS(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${j_(r)}`)}(n,e)}function IV(n,e){let t={};return BF(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Sa(n,(r,i)=>{let s=Aa(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function bV(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof mt||n instanceof ba||n instanceof Ci||n instanceof rt||n instanceof rs)}function OS(n,e,t){if(!bV(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=j_(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function JT(n,e,t){if((e=K(e))instanceof qr)return e._internalPath;if(typeof e=="string")return FS(n,e);throw N_("Field path arguments must be of type string or ",n,!1,void 0,t)}var pQ=new RegExp("[~\\*/\\[\\]]");function FS(n,e,t){if(e.search(pQ)>=0)throw N_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new qr(...e.split("."))._internalPath}catch{throw N_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function N_(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new L(O.INVALID_ARGUMENT,a+n+c)}function CV(n,e){return n.some(t=>t.isEqual(e))}var Ca=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new rt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new XT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(H_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},XT=class extends Ca{data(){return super.data()}};function H_(n,e){return typeof e=="string"?FS(n,e):e instanceof qr?e._internalPath:e._delegate._internalPath}function TV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var kh=class{},Ta=class extends kh{};function zn(n,e,...t){let r=[];e instanceof kh&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof ZT).length,a=s.filter(c=>c instanceof k_).length;if(o>1||o>0&&a>0)throw new L(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var k_=class n extends Ta{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return MV(e._query,t),new en(e.firestore,e.converter,DC(e._query,t))}_parse(e){let t=Da(e.firestore);return function(s,o,a,c,l,d,h){let p;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new L(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){TF(h,d);let _=[];for(let E of h)_.push(CF(c,s,E));p={arrayValue:{values:_}}}else p=CF(c,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||TF(h,d),p=EV(a,o,h,d==="in"||d==="not-in");return Re.create(l,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function xa(n,e,t){let r=e,i=H_("where",n);return k_._create(i,r,t)}var ZT=class n extends kh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:We.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)MV(o,c),o=DC(o,c)}(e._query,t),new en(e.firestore,e.converter,DC(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var eS=class n extends Ta{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new L(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new L(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _a(s,o)}(e._query,this._field,this._direction);return new en(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new $r(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function SV(n,e="asc"){let t=e,r=H_("orderBy",n);return eS._create(r,t)}var P_=class n extends Ta{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new en(e.firestore,e.converter,Xg(e._query,this._limit,this._limitType))}};function DV(n){return iV("limit",n),P_._create("limit",n,"F")}function AV(n){return iV("limitToLast",n),P_._create("limitToLast",n,"L")}var M_=class n extends Ta{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=PV(e,this.type,this._docOrFields,this._inclusive);return new en(e.firestore,e.converter,function(i,s){return new $r(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function xV(...n){return M_._create("startAt",n,!0)}function RV(...n){return M_._create("startAfter",n,!1)}var O_=class n extends Ta{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=PV(e,this.type,this._docOrFields,this._inclusive);return new en(e.firestore,e.converter,function(i,s){return new $r(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function NV(...n){return O_._create("endBefore",n,!1)}function kV(...n){return O_._create("endAt",n,!0)}function PV(n,e,t,r){if(t[0]=K(t[0]),t[0]instanceof Ca)return function(s,o,a,c,l){if(!c)throw new L(O.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of ul(s))if(h.field.isKeyField())d.push(ga(o,c.key));else{let p=c.data.field(h.field);if(L_(p))throw new L(O.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let _=h.field.canonicalString();throw new L(O.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(p)}return new Ii(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Da(n.firestore);return function(o,a,c,l,d,h){let p=o.explicitOrderBy;if(d.length>p.length)throw new L(O.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let _=[];for(let E=0;E<d.length;E++){let A=d[E];if(p[E].field.isKeyField()){if(typeof A!="string")throw new L(O.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof A}`);if(!cS(o)&&A.indexOf("/")!==-1)throw new L(O.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${A}' contains a slash.`);let R=o.path.child(Fe.fromString(A));if(!Y.isDocumentKey(R))throw new L(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let V=new Y(R);_.push(ga(a,V))}else{let R=EV(c,l,A);_.push(R)}}return new Ii(_,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function CF(n,e,t){if(typeof(t=K(t))=="string"){if(t==="")throw new L(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cS(e)&&t.indexOf("/")!==-1)throw new L(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Fe.fromString(t));if(!Y.isDocumentKey(r))throw new L(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ga(n,new Y(r))}if(t instanceof rt)return ga(n,t._key);throw new L(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${j_(t)}.`)}function TF(n,e){if(!Array.isArray(n)||n.length===0)throw new L(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function MV(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new L(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new L(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Al=class{convertValue(e,t="none"){switch(ma(e)){case 0:return null;case 1:return e.booleanValue;case 2:return It(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ys(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw te()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Sa(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new ba(It(e.latitude),It(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=oS(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ph(e));default:return null}}convertTimestamp(e){let t=es(e);return new mt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Fe.fromString(e);ie(TL(r));let i=new Js(r.get(1),r.get(3)),s=new Y(r.popFirst(5));return i.isEqual(t)||St(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function q_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var tS=class extends Al{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ci(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new rt(this.firestore,null,t)}};function mQ(){return new HT("count")}var Zi=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},br=class extends Ca{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Ws(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(H_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Ws=class extends br{data(e={}){return super.data(e)}},zr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Zi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Ws(this._firestore,this._userDataWriter,r.key,r,new Zi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Ws(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Ws(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:gQ(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function gQ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return te()}}function LS(n,e){return n instanceof br&&e instanceof br?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof zr&&e instanceof zr&&n._firestore===e._firestore&&kS(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function OV(n){n=Ne(n,rt);let e=Ne(n.firestore,ct);return tV(Ut(e),n._key).then(t=>BS(e,n,t))}var Ti=class extends Al{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ci(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new rt(this.firestore,null,t)}};function FV(n){n=Ne(n,rt);let e=Ne(n.firestore,ct),t=Ut(e),r=new Ti(e);return aQ(t,n._key).then(i=>new br(e,r,n._key,i,new Zi(i!==null&&i.hasLocalMutations,!0),n.converter))}function LV(n){n=Ne(n,rt);let e=Ne(n.firestore,ct);return tV(Ut(e),n._key,{source:"server"}).then(t=>BS(e,n,t))}function VV(n){n=Ne(n,en);let e=Ne(n.firestore,ct),t=Ut(e),r=new Ti(e);return TV(n._query),nV(t,n._query).then(i=>new zr(e,r,n,i))}function UV(n){n=Ne(n,en);let e=Ne(n.firestore,ct),t=Ut(e),r=new Ti(e);return cQ(t,n._query).then(i=>new zr(e,r,n,i))}function BV(n){n=Ne(n,en);let e=Ne(n.firestore,ct),t=Ut(e),r=new Ti(e);return nV(t,n._query,{source:"server"}).then(i=>new zr(e,r,n,i))}function VS(n,e,t){n=Ne(n,rt);let r=Ne(n.firestore,ct),i=q_(n.converter,e,t);return Ol(r,[$_(Da(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,bt.none())])}function US(n,e,t,...r){n=Ne(n,rt);let i=Ne(n.firestore,ct),s=Da(i),o;return o=typeof(e=K(e))=="string"||e instanceof qr?MS(s,"updateDoc",n._key,e,t,r):PS(s,"updateDoc",n._key,e),Ol(i,[o.toMutation(n._key,bt.exists(!0))])}function jV(n){return Ol(Ne(n.firestore,ct),[new no(n._key,bt.none())])}function $V(n,e){let t=Ne(n.firestore,ct),r=Uh(n),i=q_(n.converter,e);return Ol(t,[$_(Da(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,bt.exists(!1))]).then(()=>r)}function Bh(n,...e){var t,r,i;n=K(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||jT(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(jT(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,d;if(n instanceof rt)l=Ne(n.firestore,ct),d=Rl(n._key.path),c={next:h=>{e[o]&&e[o](BS(l,n,h))},error:e[o+1],complete:e[o+2]};else{let h=Ne(n,en);l=Ne(h.firestore,ct),d=h._query;let p=new Ti(l);c={next:_=>{e[o]&&e[o](new zr(l,p,h,_))},error:e[o+1],complete:e[o+2]},TV(n._query)}return function(p,_,E,A){let R=new Sl(A),V=new Ah(_,R,E);return p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return yS(yield Dl(p),V)})),()=>{R.$a(),p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return vS(yield Dl(p),V)}))}}(Ut(l),d,a,c)}function HV(n,e){return uQ(Ut(n=Ne(n,ct)),jT(e)?e:{next:e})}function Ol(n,e){return function(r,i){let s=new Dt;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return H7(yield AS(r),i,s)})),s.promise}(Ut(n),e)}function BS(n,e,t){let r=t.docs.get(e._key),i=new Ti(n);return new br(n,i,e._key,r,new Zi(t.hasPendingWrites,t.fromCache),e.converter)}function Ra(n){return _Q(n,{count:mQ()})}function _Q(n,e){let t=Ne(n.firestore,ct),r=Ut(t),i=jK(e,(s,o)=>new RC(o,s.aggregateType,s._internalFieldPath));return lQ(r,n._query,i).then(s=>function(a,c,l){let d=new Ti(a);return new qT(c,d,l)}(t,n,s))}var yQ={maxAttempts:5};var F_=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Da(e)}set(e,t,r){this._verifyNotCommitted();let i=zs(e,this._firestore),s=q_(i.converter,t,r),o=$_(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,bt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=zs(e,this._firestore),o;return o=typeof(t=K(t))=="string"||t instanceof qr?MS(this._dataReader,"WriteBatch.update",s._key,t,r,i):PS(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,bt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=zs(e,this._firestore);return this._mutations=this._mutations.concat(new no(t._key,bt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new L(O.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function zs(n,e){if((n=K(n)).firestore!==e)throw new L(O.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var nS=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Da(t)}get(t){let r=zs(t,this._firestore),i=new tS(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return te();let o=s[0];if(o.isFoundDocument())return new Ca(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Ca(this._firestore,i,r._key,null,r.converter);throw te()})}set(t,r,i){let s=zs(t,this._firestore),o=q_(s.converter,r,i),a=$_(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=zs(t,this._firestore),a;return a=typeof(r=K(r))=="string"||r instanceof qr?MS(this._dataReader,"Transaction.update",o._key,r,i,s):PS(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=zs(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=zs(e,this._firestore),r=new Ti(this._firestore);return super.get(e).then(i=>new br(this._firestore,r,t._key,i._document,new Zi(!1,!1),t.converter))}};function qV(n,e,t){n=Ne(n,ct);let r=Object.assign(Object.assign({},yQ),t);return function(s){if(s.maxAttempts<1)throw new L(O.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new Dt;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let l=yield eV(s);new LT(s.asyncQueue,l,a,o,c).Xa()})),c.promise}(Ut(n),i=>e(new nS(n,i)),r)}function zV(){return new Nh("deleteField")}function GV(){return new WT("serverTimestamp")}function WV(...n){return new KT("arrayUnion",n)}function KV(...n){return new QT("arrayRemove",n)}function QV(n){return new YT("increment",n)}(function(e,t=!0){(function(i){xl=i})(bn),In(new Qe("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new ct(new iC(r.getProvider("auth-internal")),new cC(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new L(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Js(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Tt(SO,"4.6.3",e),Tt(SO,"4.6.3","esm2017")})();var vQ="@firebase/firestore-compat",wQ="0.3.32";function GS(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new L("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function YV(){if(typeof Uint8Array>"u")throw new L("unimplemented","Uint8Arrays are not available in this environment.")}function JV(){if(!jF())throw new L("unimplemented","Blobs are unavailable in Firestore in this environment.")}var z_=class n{constructor(e){this._delegate=e}static fromBase64String(e){return JV(),new n(Ci.fromBase64String(e))}static fromUint8Array(e){return YV(),new n(Ci.fromUint8Array(e))}toBase64(){return JV(),this._delegate.toBase64()}toUint8Array(){return YV(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function jS(n){return EQ(n,["next","error","complete"])}function EQ(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var $S=class{enableIndexedDbPersistence(e,t){return lV(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return uV(e._delegate)}clearIndexedDbPersistence(e){return hV(e._delegate)}},G_=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Js||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Er("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){sV(this._delegate,e,t,r)}enableNetwork(){return pV(this._delegate)}disableNetwork(){return mV(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,RS("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return fV(this._delegate)}onSnapshotsInSync(e){return HV(this._delegate,e)}get app(){if(!this._appCompat)throw new L("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Vl(this,Cr(this._delegate,e))}catch(t){throw Sn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Si(this,Uh(this._delegate,e))}catch(t){throw Sn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ma(this,oV(this._delegate,e))}catch(t){throw Sn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return qV(this._delegate,t=>e(new W_(this,t)))}batch(){return Ut(this._delegate),new K_(new F_(this._delegate,e=>Ol(this._delegate,e)))}loadBundle(e){return gV(this._delegate,e)}namedQuery(e){return _V(this._delegate,e).then(t=>t?new Ma(this,t):null)}},Fl=class extends Al{constructor(e){super(),this.firestore=e}convertBytes(e){return new z_(new Ci(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Si.forKey(t,this.firestore,null)}};function IQ(n){DF(n)}var W_=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Fl(e)}get(e){let t=Na(e);return this._delegate.get(t).then(r=>new ka(this._firestore,new br(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Na(e);return r?(GS("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Na(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Na(e);return this._delegate.delete(t),this}},K_=class{constructor(e){this._delegate=e}set(e,t,r){let i=Na(e);return r?(GS("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Na(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Na(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Ll=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Ws(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Pa(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new Fl(e),t),i.set(t,s)),s}};Ll.INSTANCES=new WeakMap;var Si=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Fl(e)}static forPath(e,t,r){if(e.length%2!==0)throw new L("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new rt(t._delegate,r,new Y(e)))}static forKey(e,t,r){return new n(t,new rt(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Vl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Vl(this.firestore,Cr(this._delegate,e))}catch(t){throw Sn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=K(e),e instanceof rt?NS(this._delegate,e):!1}set(e,t){t=GS("DocumentReference.set",t);try{return t?VS(this._delegate,e,t):VS(this._delegate,e)}catch(r){throw Sn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?US(this._delegate,e):US(this._delegate,e,t,...r)}catch(i){throw Sn(i,"updateDoc()","DocumentReference.update()")}}delete(){return jV(this._delegate)}onSnapshot(...e){let t=XV(e),r=ZV(e,i=>new ka(this.firestore,new br(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Bh(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=FV(this._delegate):e?.source==="server"?t=LV(this._delegate):t=OV(this._delegate),t.then(r=>new ka(this.firestore,new br(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ll.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Sn(n,e,t){return n.message=n.message.replace(e,t),n}function XV(n){for(let e of n)if(typeof e=="object"&&!jS(e))return e;return{}}function ZV(n,e){var t,r;let i;return jS(n[0])?i=n[0]:jS(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var ka=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Si(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return LS(this._delegate,e._delegate)}},Pa=class extends ka{data(e){let t=this._delegate.data(e);return this._delegate._converter||AF(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Ma=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Fl(e)}where(e,t,r){try{return new n(this.firestore,zn(this._delegate,xa(e,t,r)))}catch(i){throw Sn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,zn(this._delegate,SV(e,t)))}catch(r){throw Sn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,zn(this._delegate,DV(e)))}catch(t){throw Sn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,zn(this._delegate,AV(e)))}catch(t){throw Sn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,zn(this._delegate,xV(...e)))}catch(t){throw Sn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,zn(this._delegate,RV(...e)))}catch(t){throw Sn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,zn(this._delegate,NV(...e)))}catch(t){throw Sn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,zn(this._delegate,kV(...e)))}catch(t){throw Sn(t,"endAt()","Query.endAt()")}}isEqual(e){return kS(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=UV(this._delegate):e?.source==="server"?t=BV(this._delegate):t=VV(this._delegate),t.then(r=>new jh(this.firestore,new zr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=XV(e),r=ZV(e,i=>new jh(this.firestore,new zr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Bh(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ll.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},HS=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Pa(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},jh=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ma(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Pa(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new HS(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Pa(this._firestore,r))})}isEqual(e){return LS(this._delegate,e._delegate)}},Vl=class n extends Ma{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Si(this.firestore,e):null}doc(e){try{return e===void 0?new Si(this.firestore,Uh(this._delegate)):new Si(this.firestore,Uh(this._delegate,e))}catch(t){throw Sn(t,"doc()","CollectionReference.doc()")}}add(e){return $V(this._delegate,e).then(t=>new Si(this.firestore,t))}isEqual(e){return NS(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ll.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Na(n){return Ne(n,rt)}var qS=class n{constructor(...e){this._delegate=new qr(...e)}static documentId(){return new n(At.keyField().canonicalString())}isEqual(e){return e=K(e),e instanceof qr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var zS=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=GV();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=zV();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=WV(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=KV(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=QV(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var bQ={Firestore:G_,GeoPoint:ba,Timestamp:mt,Blob:z_,Transaction:W_,WriteBatch:K_,DocumentReference:Si,DocumentSnapshot:ka,Query:Ma,QueryDocumentSnapshot:Pa,QuerySnapshot:jh,CollectionReference:Vl,FieldPath:qS,FieldValue:zS,setLogLevel:IQ,CACHE_SIZE_UNLIMITED:aV};function CQ(n,e){n.INTERNAL.registerComponent(new Qe("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},bQ)))}function TQ(n){CQ(n,(e,t)=>new G_(e,t,new $S)),n.registerVersion(vQ,wQ)}TQ(F);var c2="firebasestorage.googleapis.com",l2="storageBucket",SQ=2*60*1e3,DQ=10*60*1e3,AQ=1e3;var gt=class n extends vt{constructor(e,t,r=0){super(WS(e),`Firebase Storage: ${t} (${WS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return WS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},dt=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(dt||{});function WS(n){return"storage/"+n}function tD(){let n="An unknown error occurred, please check the error payload for server response.";return new gt(dt.UNKNOWN,n)}function xQ(n){return new gt(dt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function RQ(n){return new gt(dt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function NQ(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new gt(dt.UNAUTHENTICATED,n)}function kQ(){return new gt(dt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function PQ(n){return new gt(dt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function u2(){return new gt(dt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function d2(){return new gt(dt.CANCELED,"User canceled the upload/download.")}function MQ(n){return new gt(dt.INVALID_URL,"Invalid URL '"+n+"'.")}function OQ(n){return new gt(dt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function FQ(){return new gt(dt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+l2+"' property when initializing the app?")}function h2(){return new gt(dt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function LQ(){return new gt(dt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function VQ(){return new gt(dt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function UQ(n){return new gt(dt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Oa(n){return new gt(dt.INVALID_ARGUMENT,n)}function f2(){return new gt(dt.APP_DELETED,"The Firebase app was deleted.")}function nD(n){return new gt(dt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Hh(n,e){return new gt(dt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function $h(n){throw new gt(dt.INTERNAL_ERROR,"Internal error: "+n)}var Dn=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw OQ(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(ee){ee.path.charAt(ee.path.length-1)==="/"&&(ee.path_=ee.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(ee){ee.path_=decodeURIComponent(ee.path)}let d="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",_=new RegExp(`^https?://${h}/${d}/b/${i}/o${p}`,"i"),E={bucket:1,path:3},A=t===c2?"(?:storage.googleapis.com|storage.cloud.google.com)":t,R="([^?#]*)",V=new RegExp(`^https?://${A}/${i}/${R}`,"i"),H=[{regex:a,indices:c,postModify:s},{regex:_,indices:E,postModify:l},{regex:V,indices:{bucket:1,path:2},postModify:l}];for(let ee=0;ee<H.length;ee++){let de=H[ee],re=de.regex.exec(e);if(re){let S=re[de.indices.bucket],I=re[de.indices.path];I||(I=""),r=new n(S,I),de.postModify(r);break}}if(r==null)throw MQ(e);return r}},QS=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function BQ(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...R){l||(l=!0,e.apply(null,R))}function h(R){i=setTimeout(()=>{i=null,n(_,c())},R)}function p(){s&&clearTimeout(s)}function _(R,...V){if(l){p();return}if(R){p(),d.call(null,R,...V);return}if(c()||o){p(),d.call(null,R,...V);return}r<64&&(r*=2);let H;a===1?(a=2,H=0):H=(r+Math.random())*1e3,h(H)}let E=!1;function A(R){E||(E=!0,p(),!l&&(i!==null?(R||(a=2),clearTimeout(i),h(0)):R||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,A(!0)},t),A}function jQ(n){n(!1)}function $Q(n){return n!==void 0}function HQ(n){return typeof n=="function"}function qQ(n){return typeof n=="object"&&!Array.isArray(n)}function J_(n){return typeof n=="string"||n instanceof String}function e2(n){return rD()&&n instanceof Blob}function rD(){return typeof Blob<"u"}function YS(n,e,t,r){if(r<e)throw Oa(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Oa(`Invalid value for '${n}'. Expected ${t} or less.`)}function ao(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function p2(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var jl=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(jl||{});function m2(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var JS=class{constructor(e,t,r,i,s,o,a,c,l,d,h,p=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,E)=>{this.resolve_=_,this.reject_=E,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Bl(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===jl.NO_ERROR,c=s.getStatus();if(!a||m2(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===jl.ABORT;r(!1,new Bl(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new Bl(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());$Q(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=tD();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?f2():d2();o(c)}else{let c=u2();o(c)}};this.canceled_?t(!1,new Bl(!1,null,!0)):this.backoffId_=BQ(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&jQ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Bl=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function zQ(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function GQ(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function WQ(n,e){e&&(n["X-Firebase-GMPID"]=e)}function KQ(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function QQ(n,e,t,r,i,s,o=!0){let a=p2(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return WQ(l,e),zQ(l,t),GQ(l,s),KQ(l,r),new JS(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function YQ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function JQ(...n){let e=YQ();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(rD())return new Blob(n);throw new gt(dt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function XQ(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function ZQ(n){if(typeof atob>"u")throw UQ("base-64");return atob(n)}var nr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},qh=class{constructor(e,t){this.data=e,this.contentType=t||null}};function iD(n,e){switch(n){case nr.RAW:return new qh(g2(e));case nr.BASE64:case nr.BASE64URL:return new qh(_2(n,e));case nr.DATA_URL:return new qh(tY(e),nY(e))}throw tD()}function g2(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function eY(n){let e;try{e=decodeURIComponent(n)}catch{throw Hh(nr.DATA_URL,"Malformed data URL.")}return g2(e)}function _2(n,e){switch(n){case nr.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Hh(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case nr.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Hh(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=ZQ(e)}catch(i){throw i.message.includes("polyfill")?i:Hh(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var Y_=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw Hh(nr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=rY(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function tY(n){let e=new Y_(n);return e.base64?_2(nr.BASE64,e.rest):eY(e.rest)}function nY(n){return new Y_(n).contentType}function rY(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var $l=class n{constructor(e,t){let r=0,i="";e2(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(e2(this.data_)){let r=this.data_,i=XQ(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(rD()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(JQ.apply(null,t))}else{let t=e.map(o=>J_(o)?iD(nr.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function sD(n){let e;try{e=JSON.parse(n)}catch{return null}return qQ(e)?e:null}function iY(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function sY(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function y2(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function oY(n,e){return e}var tn=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||oY}},Q_=null;function aY(n){return!J_(n)||n.length<2?n:y2(n)}function X_(){if(Q_)return Q_;let n=[];n.push(new tn("bucket")),n.push(new tn("generation")),n.push(new tn("metageneration")),n.push(new tn("name","fullPath",!0));function e(s,o){return aY(o)}let t=new tn("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new tn("size");return i.xform=r,n.push(i),n.push(new tn("timeCreated")),n.push(new tn("updated")),n.push(new tn("md5Hash",null,!0)),n.push(new tn("cacheControl",null,!0)),n.push(new tn("contentDisposition",null,!0)),n.push(new tn("contentEncoding",null,!0)),n.push(new tn("contentLanguage",null,!0)),n.push(new tn("contentType",null,!0)),n.push(new tn("metadata","customMetadata",!0)),Q_=n,Q_}function cY(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new Dn(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function lY(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return cY(r,n),r}function v2(n,e,t){let r=sD(e);return r===null?null:lY(n,r,t)}function uY(n,e,t,r){let i=sD(e);if(i===null||!J_(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=n.bucket,h=n.fullPath,p="/b/"+o(d)+"/o/"+o(h),_=ao(p,t,r),E=p2({alt:"media",token:l});return _+E})[0]}function oD(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var t2="prefixes",n2="items";function dY(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[t2])for(let i of t[t2]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new Dn(e,s));r.prefixes.push(o)}if(t[n2])for(let i of t[n2]){let s=n._makeStorageReference(new Dn(e,i.name));r.items.push(s)}return r}function hY(n,e,t){let r=sD(t);return r===null?null:dY(n,e,r)}var Gr=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Ai(n){if(!n)throw tD()}function Z_(n,e){function t(r,i){let s=v2(n,i,e);return Ai(s!==null),s}return t}function fY(n,e){function t(r,i){let s=hY(n,e,i);return Ai(s!==null),s}return t}function pY(n,e){function t(r,i){let s=v2(n,i,e);return Ai(s!==null),uY(s,i,n.host,n._protocol)}return t}function zl(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=kQ():i=NQ():t.getStatus()===402?i=RQ(n.bucket):t.getStatus()===403?i=PQ(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function ey(n){let e=zl(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=xQ(n.path)),s.serverResponse=i.serverResponse,s}return t}function w2(n,e,t){let r=e.fullServerUrl(),i=ao(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Gr(i,s,Z_(n,t),o);return a.errorHandler=ey(e),a}function mY(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=ao(o,n.host,n._protocol),c="GET",l=n.maxOperationRetryTime,d=new Gr(a,c,fY(n,e.bucket),l);return d.urlParams=s,d.errorHandler=zl(e),d}function gY(n,e,t){let r=e.fullServerUrl(),i=ao(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Gr(i,s,pY(n,t),o);return a.errorHandler=ey(e),a}function _Y(n,e,t,r){let i=e.fullServerUrl(),s=ao(i,n.host,n._protocol),o="PATCH",a=oD(t,r),c={"Content-Type":"application/json; charset=utf-8"},l=n.maxOperationRetryTime,d=new Gr(s,o,Z_(n,r),l);return d.headers=c,d.body=a,d.errorHandler=ey(e),d}function yY(n,e){let t=e.fullServerUrl(),r=ao(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,l){}let a=new Gr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=ey(e),a}function vY(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function E2(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=vY(null,e)),r}function wY(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let H="";for(let ee=0;ee<2;ee++)H=H+Math.random().toString().slice(2);return H}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let l=E2(e,r,i),d=oD(l,t),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,p=`\r
--`+c+"--",_=$l.getBlob(h,r,p);if(_===null)throw h2();let E={name:l.fullPath},A=ao(s,n.host,n._protocol),R="POST",V=n.maxUploadRetryTime,J=new Gr(A,R,Z_(n,t),V);return J.urlParams=E,J.headers=o,J.body=_.uploadData(),J.errorHandler=zl(e),J}var Hl=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function aD(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{Ai(!1)}return Ai(!!t&&(e||["active"]).indexOf(t)!==-1),t}function EY(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=E2(e,r,i),a={name:o.fullPath},c=ao(s,n.host,n._protocol),l="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=oD(o,t),p=n.maxUploadRetryTime;function _(A){aD(A);let R;try{R=A.getResponseHeader("X-Goog-Upload-URL")}catch{Ai(!1)}return Ai(J_(R)),R}let E=new Gr(c,l,_,p);return E.urlParams=a,E.headers=d,E.body=h,E.errorHandler=zl(e),E}function IY(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(l){let d=aD(l,["active","final"]),h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Ai(!1)}h||Ai(!1);let p=Number(h);return Ai(!isNaN(p)),new Hl(p,r.size(),d==="final")}let o="POST",a=n.maxUploadRetryTime,c=new Gr(t,o,s,a);return c.headers=i,c.errorHandler=zl(e),c}var r2=256*1024;function bY(n,e,t,r,i,s,o,a){let c=new Hl(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw LQ();let l=c.total-c.current,d=l;i>0&&(d=Math.min(d,i));let h=c.current,p=h+d,_="";d===0?_="finalize":l===d?_="upload, finalize":_="upload";let E={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${c.current}`},A=r.slice(h,p);if(A===null)throw h2();function R(ee,de){let re=aD(ee,["active","final"]),S=c.current+d,I=r.size(),C;return re==="final"?C=Z_(e,s)(ee,de):C=null,new Hl(S,I,re==="final",C)}let V="POST",J=e.maxUploadRetryTime,H=new Gr(t,V,R,J);return H.headers=E,H.body=A.uploadData(),H.progressCallback=a||null,H.errorHandler=zl(n),H}var I2={STATE_CHANGED:"state_changed"},mn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function KS(n){switch(n){case"running":case"pausing":case"canceling":return mn.RUNNING;case"paused":return mn.PAUSED;case"success":return mn.SUCCESS;case"canceled":return mn.CANCELED;case"error":return mn.ERROR;default:return mn.ERROR}}var XS=class{constructor(e,t,r){if(HQ(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Ul(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var i2=null,ZS=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=jl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=jl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=jl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw $h("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw $h("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw $h("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw $h("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw $h("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},eD=class extends ZS{initXhr(){this.xhr_.responseType="text"}};function Di(){return i2?i2():new eD}var zh=class{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=X_(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(dt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(m2(i.status,[]))if(s)i=u2();else{this.sleepTime=Math.max(this.sleepTime*2,AQ),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(dt.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=EY(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Di,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=IY(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Di,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=r2*this._chunkMultiplier,t=new Hl(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=bY(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,Di,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){r2*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=w2(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Di,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=wY(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Di,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=d2(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=KS(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new XS(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(KS(this._state)){case mn.SUCCESS:Ul(this._resolve.bind(null,this.snapshot))();break;case mn.CANCELED:case mn.ERROR:let t=this._reject;Ul(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(KS(this._state)){case mn.RUNNING:case mn.PAUSED:e.next&&Ul(e.next.bind(e,this.snapshot))();break;case mn.SUCCESS:e.complete&&Ul(e.complete.bind(e))();break;case mn.CANCELED:case mn.ERROR:e.error&&Ul(e.error.bind(e,this._error))();break;default:e.error&&Ul(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var ql=class n{constructor(e,t){this._service=e,t instanceof Dn?this._location=t:this._location=Dn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Dn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return y2(this._location.path)}get storage(){return this._service}get parent(){let e=iY(this._location.path);if(e===null)return null;let t=new Dn(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw nD(e)}};function CY(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new zh(n,new $l(e),t)}function TY(n){let e={prefixes:[],items:[]};return b2(n,e).then(()=>e)}function b2(n,e,t){return g(this,null,function*(){let i=yield C2(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield b2(n,e,i.nextPageToken))})}function C2(n,e){e!=null&&typeof e.maxResults=="number"&&YS("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=mY(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Di)}function SY(n){n._throwIfRoot("getMetadata");let e=w2(n.storage,n._location,X_());return n.storage.makeRequestWithTokens(e,Di)}function DY(n,e){n._throwIfRoot("updateMetadata");let t=_Y(n.storage,n._location,e,X_());return n.storage.makeRequestWithTokens(t,Di)}function AY(n){n._throwIfRoot("getDownloadURL");let e=gY(n.storage,n._location,X_());return n.storage.makeRequestWithTokens(e,Di).then(t=>{if(t===null)throw VQ();return t})}function xY(n){n._throwIfRoot("deleteObject");let e=yY(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Di)}function T2(n,e){let t=sY(n._location.path,e),r=new Dn(n._location.bucket,t);return new ql(n.storage,r)}function RY(n){return/^[A-Za-z]+:\/\//.test(n)}function NY(n,e){return new ql(n,e)}function S2(n,e){if(n instanceof Gh){let t=n;if(t._bucket==null)throw FQ();let r=new ql(t,t._bucket);return e!=null?S2(r,e):r}else return e!==void 0?T2(n,e):n}function kY(n,e){if(e&&RY(e)){if(n instanceof Gh)return NY(n,e);throw Oa("To use ref(service, url), the first argument must be a Storage instance.")}else return S2(n,e)}function s2(n,e){let t=e?.[l2];return t==null?null:Dn.makeFromBucketSpec(t,n)}function PY(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:Vc(i,n.app.options.projectId))}var Gh=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=c2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=SQ,this._maxUploadRetryTime=DQ,this._requests=new Set,i!=null?this._bucket=Dn.makeFromBucketSpec(i,this._host):this._bucket=s2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Dn.makeFromBucketSpec(this._url,e):this._bucket=s2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){YS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){YS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return g(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return g(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ql(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new QS(f2());{let o=QQ(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return g(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},o2="@firebase/storage",a2="0.12.5";var MY="storage";function Wh(n,e,t){return n=K(n),CY(n,e,t)}function D2(n){return n=K(n),SY(n)}function A2(n,e){return n=K(n),DY(n,e)}function x2(n,e){return n=K(n),C2(n,e)}function R2(n){return n=K(n),TY(n)}function Kh(n){return n=K(n),AY(n)}function Gl(n){return n=K(n),xY(n)}function ss(n,e){return n=K(n),kY(n,e)}function N2(n,e){return T2(n,e)}function k2(n,e,t,r={}){PY(n,e,t,r)}function OY(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Gh(t,r,i,e,bn)}function FY(){In(new Qe(MY,OY,"PUBLIC").setMultipleInstances(!0)),Tt(o2,a2,""),Tt(o2,a2,"esm2017")}FY();var Wl=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var ty=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Wl(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new Wl(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new Wl(o,this,this._ref)):s={next:t.next?o=>t.next(new Wl(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},ny=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Fa(e,this._service))}get items(){return this._delegate.items.map(e=>new Fa(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var Fa=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=N2(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new ty(Wh(this._delegate,e,t),this)}putString(e,t=nr.RAW,r){this._throwIfRoot("putString");let i=iD(t,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new ty(new zh(this._delegate,new $l(i.data,!0),s),this)}listAll(){return R2(this._delegate).then(e=>new ny(e,this.storage))}list(e){return x2(this._delegate,e||void 0).then(t=>new ny(t,this.storage))}getMetadata(){return D2(this._delegate)}updateMetadata(e){return A2(this._delegate,e)}getDownloadURL(){return Kh(this._delegate)}delete(){return this._throwIfRoot("delete"),Gl(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw nD(e)}};var ry=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(P2(e))throw Oa("ref() expected a child path but got a URL, use refFromURL instead.");return new Fa(ss(this._delegate,e),this)}refFromURL(e){if(!P2(e))throw Oa("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Dn.makeFromUrl(e,this._delegate.host)}catch{throw Oa("refFromUrl() expected a valid full URL but got an invalid one.")}return new Fa(ss(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){k2(this._delegate,e,t,r)}};function P2(n){return/^[A-Za-z]+:\/\//.test(n)}var LY="@firebase/storage-compat",VY="0.3.8";var UY="storage-compat";function BY(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new ry(t,r)}function jY(n){let e={TaskState:mn,TaskEvent:I2,StringFormat:nr,Storage:ry,Reference:Fa};n.INTERNAL.registerComponent(new Qe(UY,BY,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(LY,VY)}jY(F);var M2="@firebase/database",O2="1.0.5";var vA="";function wA(n){vA=n}var mD=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Nt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Fc(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var gD=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return En(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var hU=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new mD(e)}}catch{}return new gD},Va=hU("localStorage"),_D=hU("sessionStorage");var Jl=new $n("@firebase/database"),fU=function(){let n=1;return function(){return n++}}(),pU=function(n){let e=YM(n),t=new Hm;t.update(e);let r=t.digest();return qm.encodeByteArray(r)},vf=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=vf.apply(null,r):typeof r=="object"?e+=Nt(r):e+=r,e+=" "}return e},Ua=null,F2=!0,mU=function(n,e){q(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Jl.logLevel=Ee.VERBOSE,Ua=Jl.log.bind(Jl),e&&_D.set("logging_enabled",!0)):typeof n=="function"?Ua=n:(Ua=null,_D.remove("logging_enabled"))},Qt=function(...n){if(F2===!0&&(F2=!1,Ua===null&&_D.get("logging_enabled")===!0&&mU(!0)),Ua){let e=vf.apply(null,n);Ua(e)}},wf=function(n){return function(...e){Qt(n,...e)}},yD=function(...n){let e="FIREBASE INTERNAL ERROR: "+vf(...n);Jl.error(e)},Ni=function(...n){let e=`FIREBASE FATAL ERROR: ${vf(...n)}`;throw Jl.error(e),new Error(e)},gn=function(...n){let e="FIREBASE WARNING: "+vf(...n);Jl.warn(e)},$Y=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&gn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ny=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},HY=function(n){if(ci()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},ho="[MIN_NAME]",os="[MAX_NAME]",ja=function(n,e){if(n===e)return 0;if(n===ho||e===os)return-1;if(e===ho||n===os)return 1;{let t=L2(n),r=L2(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},qY=function(n,e){return n===e?0:n<e?-1:1},Qh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Nt(e))},EA=function(n){if(typeof n!="object"||n===null)return Nt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Nt(e[r]),t+=":",t+=EA(n[e[r]]);return t+="}",t},gU=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Yt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var _U=function(n){q(!Ny(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),h="";for(c=0;c<64;c+=8){let p=parseInt(d.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),h=h+p}return h.toLowerCase()},zY=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},GY=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function WY(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var KY=new RegExp("^-?(0*)\\d{1,10}$"),QY=-2147483648,YY=2147483647,L2=function(n){if(KY.test(n)){let e=Number(n);if(e>=QY&&e<=YY)return e}return null},ou=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw gn("Exception was thrown by user callback.",t),e},Math.floor(0))}},JY=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Zh=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var vD=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){gn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var wD=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Qt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',gn(e)}},ef=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),sy="5",yU="v",vU="s",wU="r",EU="f",IU=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,bU="ls",CU="p",ED="ac",TU="websocket",SU="long_polling";var oy=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Va.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Va.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function XY(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function DU(n,e,t){q(typeof e=="string","typeof type must == string"),q(typeof t=="object","typeof params must == object");let r;if(e===TU)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===SU)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);XY(n)&&(t.ns=n.namespace);let i=[];return Yt(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var ID=class{constructor(){this.counters_={}}incrementCounter(e,t=1){En(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return qM(this.counters_)}};var cD={},lD={};function IA(n){let e=n.toString();return cD[e]||(cD[e]=new ID),cD[e]}function ZY(n,e){let t=n.toString();return lD[t]||(lD[t]=e()),lD[t]}var bD=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&ou(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var V2="start",eJ="close",tJ="pLPCommand",nJ="pRTLPCB",AU="id",xU="pw",RU="ser",rJ="cb",iJ="seg",sJ="ts",oJ="d",aJ="dframe",NU=1870,kU=30,cJ=NU-kU,lJ=25e3,uJ=3e4,sf=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=wf(e),this.stats_=IA(t),this.urlFn=c=>(this.appCheckToken&&(c[ED]=this.appCheckToken),DU(t,SU,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new bD(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(uJ)),HY(()=>{if(this.isClosed_)return;this.scriptTagHolder=new CD((...s)=>{let[o,a,c,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===V2)this.id=a,this.password=c;else if(o===eJ)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[V2]="t",r[RU]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[rJ]=this.scriptTagHolder.uniqueCallbackIdentifier),r[yU]=sy,this.transportSessionId&&(r[vU]=this.transportSessionId),this.lastSessionId&&(r[bU]=this.lastSessionId),this.applicationId&&(r[CU]=this.applicationId),this.appCheckToken&&(r[ED]=this.appCheckToken),typeof location<"u"&&location.hostname&&IU.test(location.hostname)&&(r[wU]=EU);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return ci()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!zY()&&!GY()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=Nt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=$I(t),i=gU(r,cJ);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(ci())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[aJ]="t",r[AU]=e,r[xU]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=Nt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},CD=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ci())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=fU(),window[tJ+this.uniqueCallbackIdentifier]=e,window[nJ+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Qt("frame writing exception"),a.stack&&Qt(a.stack),Qt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Qt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[AU]=this.myID,e[xU]=this.myPW,e[RU]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+kU+r.length<=NU;){let o=this.pendingSegs.shift();r=r+"&"+iJ+i+"="+o.seg+"&"+sJ+i+"="+o.ts+"&"+oJ+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(lJ)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){ci()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Qt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var dJ=16384,hJ=45e3,ay=null;typeof MozWebSocket<"u"?ay=MozWebSocket:typeof WebSocket<"u"&&(ay=WebSocket);var Ql=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=wf(this.connId),this.stats_=IA(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[yU]=sy,!ci()&&typeof location<"u"&&location.hostname&&IU.test(location.hostname)&&(a[wU]=EU),r&&(a[vU]=r),i&&(a[bU]=i),s&&(a[ED]=s),o&&(a[CU]=o),DU(t,TU,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Va.set("previous_websocket_failure",!0);try{let i;if(ci()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${sy}/${vA}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new ay(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&ay!==null&&!n.forceDisallow_}static previouslyFailed(){return Va.isInMemoryStorage||Va.get("previous_websocket_failure")===!0}markConnectionHealthy(){Va.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Fc(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(q(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=Nt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=gU(r,dJ);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(hJ))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),PU=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[sf,Ql]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=Ql&&Ql.isAvailable(),i=r&&!Ql.previouslyFailed();if(t.webSocketOnly&&(r||gn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ql];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),fJ=6e4,pJ=5e3,mJ=10*1024,gJ=100*1024,uD="t",U2="d",_J="s",B2="r",yJ="e",j2="o",$2="a",H2="n",q2="p",vJ="h",TD=class{constructor(e,t,r,i,s,o,a,c,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=wf("c:"+this.id+":"),this.transportManager_=new PU(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Zh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>gJ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>mJ?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(uD in e){let t=e[uD];t===$2?this.upgradeIfSecondaryHealthy_():t===B2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===j2&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=Qh("t",e),r=Qh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:q2,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:$2,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:H2,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=Qh("t",e),r=Qh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=Qh(uD,e);if(U2 in e){let r=e[U2];if(t===vJ){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===H2){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===_J?this.onConnectionShutdown_(r):t===B2?this.onReset_(r):t===yJ?yD("Server Error: "+r):t===j2?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):yD("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),sy!==r&&gn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Zh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(fJ))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Zh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(pJ))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:q2,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Va.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var cy=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var ly=class{constructor(e){this.allowedEvents_=e,this.listeners_={},q(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){q(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var uy=class n extends ly{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Td()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return q(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var z2=32,G2=768,$e=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function je(){return new $e("")}function Ie(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function fo(n){return n.pieces_.length-n.pieceNum_}function et(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new $e(n.pieces_,e)}function bA(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function wJ(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function of(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function MU(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new $e(e,0)}function ht(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof $e)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new $e(t,0)}function be(n){return n.pieceNum_>=n.pieces_.length}function An(n,e){let t=Ie(n),r=Ie(e);if(t===null)return e;if(t===r)return An(et(n),et(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function EJ(n,e){let t=of(n,0),r=of(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=ja(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function CA(n,e){if(fo(n)!==fo(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Tr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(fo(n)>fo(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var SD=class{constructor(e,t){this.errorPrefix_=t,this.parts_=of(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Dd(this.parts_[r]);OU(this)}};function IJ(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Dd(e),OU(n)}function bJ(n){let e=n.parts_.pop();n.byteLength_-=Dd(e),n.parts_.length>0&&(n.byteLength_-=1)}function OU(n){if(n.byteLength_>G2)throw new Error(n.errorPrefix_+"has a key path longer than "+G2+" bytes ("+n.byteLength_+").");if(n.parts_.length>z2)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+z2+") or object contains a cycle "+La(n))}function La(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var DD=class n extends ly{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return q(e==="visible","Unknown event type: "+e),[this.visible_]}};var Yh=1e3,CJ=60*5*1e3,W2=30*1e3,TJ=1.3,SJ=3e4,DJ="server_kill",K2=3,TA=(()=>{class n extends cy{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=wf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Yh,this.maxReconnectDelay_=CJ,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!ci())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");DD.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&uy.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(Nt(o)),q(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new jt,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),q(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),q(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,d=c.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&En(t,"w")){let i=Rs(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();gn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||QM(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=W2)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=KM(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),q(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Nt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):yD("Unrecognized action received from server: "+Nt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){q(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Yh,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Yh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>SJ&&(this.reconnectDelay_=Yh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*TJ)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},d=function(p){q(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(p)};this.realtime_={close:l,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[p,_]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?Qt("getToken() completed but was canceled"):(Qt("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=_&&_.token,c=new TD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,E=>{gn(E+" ("+this.repoInfo_.toString()+")"),this.interrupt(DJ)},o))}catch(p){this.log_("Failed to get token: "+p),a||(this.repoInfo_.nodeAdmin&&gn(p),l())}}})}interrupt(t){Qt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Qt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Uc(this.interruptReasons_)&&(this.reconnectDelay_=Yh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>EA(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new $e(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Qt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=K2&&(this.reconnectDelay_=W2,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Qt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=K2&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";ci()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+vA.replace(/\./g,"-")]=1,Td()?t["framework.cordova"]=1:qo()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=uy.getInstance().currentlyOnline();return Uc(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),Te=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Xl=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new Te(ho,e),i=new Te(ho,t);return this.compare(r,i)!==0}minPost(){return Te.MIN}};var iy,dy=class extends Xl{static get __EMPTY_NODE(){return iy}static set __EMPTY_NODE(e){iy=e}compare(e,t){return ja(e.name,t.name)}isDefinedOn(e){throw Ho("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Te.MIN}maxPost(){return new Te(os,iy)}makePost(e,t){return q(typeof e=="string","KeyIndex indexValue must always be a string."),new Te(e,iy)}toString(){return".key"}},Ri=new dy;var Yl=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Wr=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Sr.EMPTY_NODE,this.right=o??Sr.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Sr.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Sr.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),AD=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new Wr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Sr=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Wr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Wr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Yl(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Yl(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Yl(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Yl(this.root_,null,this.comparator_,!0,e)}};Sr.EMPTY_NODE=new AD;function AJ(n,e){return ja(n.name,e.name)}function SA(n,e){return ja(n,e)}var xD;function xJ(n){xD=n}var FU=function(n){return typeof n=="number"?"number:"+_U(n):"string:"+n},LU=function(n){if(n.isLeafNode()){let e=n.val();q(typeof e=="string"||typeof e=="number"||typeof e=="object"&&En(e,".sv"),"Priority must be a string or number.")}else q(n===xD||n.isEmpty(),"priority of unexpected type.");q(n===xD||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Q2,Zl=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,q(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),LU(this.priorityNode_)}static set __childrenNodeConstructor(t){Q2=t}static get __childrenNodeConstructor(){return Q2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return be(t)?this:Ie(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=Ie(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(q(i!==".priority"||fo(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(et(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+FU(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=_U(this.value_):t+=this.value_,this.lazyHash_=pU(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(q(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return q(s>=0,"Unknown leaf type: "+r),q(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),VU,UU;function RJ(n){VU=n}function NJ(n){UU=n}var RD=class extends Xl{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?ja(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Te.MIN}maxPost(){return new Te(os,new Zl("[PRIORITY-POST]",UU))}makePost(e,t){let r=VU(e);return new Te(t,new Zl("[PRIORITY-POST]",r))}toString(){return".priority"}},it=new RD;var kJ=Math.log(2),ND=class{constructor(e){let t=s=>parseInt(Math.log(s)/kJ,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},hy=function(n,e,t,r){n.sort(e);let i=function(c,l){let d=l-c,h,p;if(d===0)return null;if(d===1)return h=n[c],p=t?t(h):h,new Wr(p,h.node,Wr.BLACK,null,null);{let _=parseInt(d/2,10)+c,E=i(c,_),A=i(_+1,l);return h=n[_],p=t?t(h):h,new Wr(p,h.node,Wr.BLACK,E,A)}},s=function(c){let l=null,d=null,h=n.length,p=function(E,A){let R=h-E,V=h;h-=E;let J=i(R+1,V),H=n[R],ee=t?t(H):H;_(new Wr(ee,H.node,A,null,J))},_=function(E){l?(l.left=E,l=E):(d=E,l=E)};for(let E=0;E<c.count;++E){let A=c.nextBitIsOne(),R=Math.pow(2,c.count-(E+1));A?p(R,Wr.BLACK):(p(R,Wr.BLACK),p(R,Wr.RED))}return d},o=new ND(n.length),a=s(o);return new Sr(r||e,a)};var dD,Kl={},eu=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return q(Kl&&it,"ChildrenNode.ts has not been loaded"),dD=dD||new n({".priority":Kl},{".priority":it}),dD}get(e){let t=Rs(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Sr?t:null}hasIndex(e){return En(this.indexSet_,e.toString())}addIndex(e,t){q(e!==Ri,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(Te.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=hy(r,e.getCompare()):a=Kl;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,l)}addToIndexes(e,t){let r=Sd(this.indexes_,(i,s)=>{let o=Rs(this.indexSet_,s);if(q(o,"Missing index implementation for "+s),i===Kl)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(Te.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),hy(a,o.getCompare())}else return Kl;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new Te(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Sd(this.indexes_,i=>{if(i===Kl)return i;{let s=t.get(e.name);return s?i.remove(new Te(e.name,s)):i}});return new n(r,this.indexSet_)}};var Jh,_e=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&LU(this.priorityNode_),this.children_.isEmpty()&&q(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Jh||(Jh=new n(new Sr(SA),null,eu.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Jh}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Jh:r}}getChild(t){let r=Ie(t);return r===null?this:this.getImmediateChild(r).getChild(et(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(q(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new Te(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Jh:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=Ie(t);if(i===null)return r;{q(Ie(t)!==".priority"||fo(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(et(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(it,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+FU(this.getPriority().val())+":"),this.forEachChild(it,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":pU(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new Te(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new Te(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new Te(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,Te.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,Te.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Ef?-1:0}withIndex(t){if(t===Ri||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Ri||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(it),s=r.getIterator(it),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===Ri?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),kD=class extends _e{constructor(){super(new Sr(SA),_e.EMPTY_NODE,eu.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return _e.EMPTY_NODE}isEmpty(){return!1}},Ef=new kD;Object.defineProperties(Te,{MIN:{value:new Te(ho,_e.EMPTY_NODE)},MAX:{value:new Te(os,Ef)}});dy.__EMPTY_NODE=_e.EMPTY_NODE;Zl.__childrenNodeConstructor=_e;xJ(Ef);NJ(Ef);var PJ=!0;function _t(n,e=null){if(n===null)return _e.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),q(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Zl(t,_t(e))}if(!(n instanceof Array)&&PJ){let t=[],r=!1;if(Yt(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=_t(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Te(o,c)))}}),t.length===0)return _e.EMPTY_NODE;let s=hy(t,AJ,o=>o.name,SA);if(r){let o=hy(t,it.getCompare());return new _e(s,_t(e),new eu({".priority":o},{".priority":it}))}else return new _e(s,_t(e),eu.Default)}else{let t=_e.EMPTY_NODE;return Yt(n,(r,i)=>{if(En(n,r)&&r.substring(0,1)!=="."){let s=_t(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(_t(e))}}RJ(_t);var af=class extends Xl{constructor(e){super(),this.indexPath_=e,q(!be(e)&&Ie(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?ja(e.name,t.name):s}makePost(e,t){let r=_t(e),i=_e.EMPTY_NODE.updateChild(this.indexPath_,r);return new Te(t,i)}maxPost(){let e=_e.EMPTY_NODE.updateChild(this.indexPath_,Ef);return new Te(os,e)}toString(){return of(this.indexPath_,0).join("/")}};var PD=class extends Xl{compare(e,t){let r=e.node.compareTo(t.node);return r===0?ja(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Te.MIN}maxPost(){return Te.MAX}makePost(e,t){let r=_t(e);return new Te(t,r)}toString(){return".value"}},DA=new PD;function BU(n){return{type:"value",snapshotNode:n}}function tu(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function cf(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function lf(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function MJ(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var uf=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){q(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(cf(t,a)):q(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(tu(t,r)):o.trackChildChange(lf(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(it,(i,s)=>{t.hasChild(i)||r.trackChildChange(cf(i,s))}),t.isLeafNode()||t.forEachChild(it,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(lf(i,s,o))}else r.trackChildChange(tu(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?_e.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var fy=class n{constructor(e){this.indexedFilter_=new uf(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new Te(t,r))||(r=_e.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=_e.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(_e.EMPTY_NODE);let s=this;return t.forEachChild(it,(o,a)=>{s.matches(new Te(o,a))||(i=i.updateImmediateChild(o,_e.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var MD=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new fy(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new Te(t,r))||(r=_e.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=_e.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=_e.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(_e.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,_e.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(p,_)=>h(_,p)}else o=this.index_.getCompare();let a=e;q(a.numChildren()===this.limit_,"");let c=new Te(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(t)){let h=a.getImmediateChild(t),p=i.getChildAfterChild(this.index_,l,this.reverse_);for(;p!=null&&(p.name===t||a.hasChild(p.name));)p=i.getChildAfterChild(this.index_,p,this.reverse_);let _=p==null?1:o(p,c);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(lf(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(cf(t,h));let A=a.updateImmediateChild(t,_e.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(s?.trackChildChange(tu(p.name,p.node)),A.updateImmediateChild(p.name,p.node)):A}}else return r.isEmpty()?e:d&&o(l,c)>=0?(s!=null&&(s.trackChildChange(cf(l.name,l.node)),s.trackChildChange(tu(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,_e.EMPTY_NODE)):e}};var df=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=it}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return q(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return q(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ho}hasEnd(){return this.endSet_}getIndexEndValue(){return q(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return q(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:os}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return q(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===it}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function OJ(n){return n.loadsAllData()?new uf(n.getIndex()):n.hasLimit()?new MD(n):new fy(n)}function FJ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function LJ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function OD(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function VJ(n,e,t){let r;return n.index_===Ri||t?r=OD(n,e,t):r=OD(n,e,os),r.startAfterSet_=!0,r}function FD(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function UJ(n,e,t){let r;return n.index_===Ri||t?r=FD(n,e,t):r=FD(n,e,ho),r.endBeforeSet_=!0,r}function ky(n,e){let t=n.copy();return t.index_=e,t}function Y2(n){let e={};if(n.isDefault())return e;let t;if(n.index_===it?t="$priority":n.index_===DA?t="$value":n.index_===Ri?t="$key":(q(n.index_ instanceof af,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Nt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=Nt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Nt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Nt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Nt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function J2(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==it&&(e.i=n.index_.toString()),e}var LD=class n extends cy{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=wf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(q(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=Y2(e._queryParams);this.restRequest_(s+".json",c,(l,d)=>{let h=d;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),Rs(this.listens_,o)===a){let p;l?l===401?p="permission_denied":p="rest_error:"+l:p="ok",i(p,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=Y2(e._queryParams),r=e._path.toString(),i=new jt;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Wi(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Fc(a.responseText)}catch{gn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&gn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var VD=class{constructor(){this.rootNode_=_e.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function py(){return{value:null,children:new Map}}function au(n,e,t){if(be(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=Ie(e);n.children.has(r)||n.children.set(r,py());let i=n.children.get(r);e=et(e),au(i,e,t)}}function UD(n,e){if(be(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(it,(r,i)=>{au(n,new $e(r),i)}),UD(n,e)}}else if(n.children.size>0){let t=Ie(e);return e=et(e),n.children.has(t)&&UD(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function BD(n,e,t){n.value!==null?t(e,n.value):BJ(n,(r,i)=>{let s=new $e(e.toString()+"/"+r);BD(i,s,t)})}function BJ(n,e){n.children.forEach((t,r)=>{e(r,t)})}var jD=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Yt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var X2=10*1e3,jJ=30*1e3,$J=5*60*1e3,$D=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new jD(e);let r=X2+(jJ-X2)*Math.random();Zh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Yt(e,(i,s)=>{s>0&&En(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Zh(this.reportStats_.bind(this),Math.floor(Math.random()*2*$J))}};var xi=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(xi||{});function AA(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function xA(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function RA(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var HD=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=xi.ACK_USER_WRITE,this.source=AA()}operationForChild(e){if(be(this.path)){if(this.affectedTree.value!=null)return q(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new $e(e));return new n(je(),t,this.revert)}}else return q(Ie(this.path)===e,"operationForChild called for unrelated child."),new n(et(this.path),this.affectedTree,this.revert)}};var my=class n{constructor(e,t){this.source=e,this.path=t,this.type=xi.LISTEN_COMPLETE}operationForChild(e){return be(this.path)?new n(this.source,je()):new n(this.source,et(this.path))}};var nu=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=xi.OVERWRITE}operationForChild(e){return be(this.path)?new n(this.source,je(),this.snap.getImmediateChild(e)):new n(this.source,et(this.path),this.snap)}};var hf=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=xi.MERGE}operationForChild(e){if(be(this.path)){let t=this.children.subtree(new $e(e));return t.isEmpty()?null:t.value?new nu(this.source,je(),t.value):new n(this.source,je(),t)}else return q(Ie(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,et(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var ki=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(be(e))return this.isFullyInitialized()&&!this.filtered_;let t=Ie(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var qD=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function HJ(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(MJ(o.childName,o.snapshotNode))}),Xh(n,i,"child_removed",e,r,t),Xh(n,i,"child_added",e,r,t),Xh(n,i,"child_moved",s,r,t),Xh(n,i,"child_changed",e,r,t),Xh(n,i,"value",e,r,t),i}function Xh(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>zJ(n,a,c)),o.forEach(a=>{let c=qJ(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function qJ(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function zJ(n,e,t){if(e.childName==null||t.childName==null)throw Ho("Should only compare child_ events.");let r=new Te(e.childName,e.snapshotNode),i=new Te(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function Py(n,e){return{eventCache:n,serverCache:e}}function tf(n,e,t,r){return Py(new ki(e,t,r),n.serverCache)}function jU(n,e,t,r){return Py(n.eventCache,new ki(e,t,r))}function gy(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Ba(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var hD,GJ=()=>(hD||(hD=new Sr(qY)),hD),xn=class n{constructor(e,t=GJ()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Yt(e,(r,i)=>{t=t.set(new $e(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:je(),value:this.value};if(be(e))return null;{let r=Ie(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(et(e),t);return s!=null?{path:ht(new $e(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(be(e))return this;{let t=Ie(e),r=this.children.get(t);return r!==null?r.subtree(et(e)):new n(null)}}set(e,t){if(be(e))return new n(t,this.children);{let r=Ie(e),s=(this.children.get(r)||new n(null)).set(et(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(be(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=Ie(e),r=this.children.get(t);if(r){let i=r.remove(et(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(be(e))return this.value;{let t=Ie(e),r=this.children.get(t);return r?r.get(et(e)):null}}setTree(e,t){if(be(e))return t;{let r=Ie(e),s=(this.children.get(r)||new n(null)).setTree(et(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(je(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(ht(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,je(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(be(e))return null;{let s=Ie(e),o=this.children.get(s);return o?o.findOnPath_(et(e),ht(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,je(),t)}foreachOnPath_(e,t,r){if(be(e))return this;{this.value&&r(t,this.value);let i=Ie(e),s=this.children.get(i);return s?s.foreachOnPath_(et(e),ht(t,i),r):new n(null)}}foreach(e){this.foreach_(je(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(ht(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Kr=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new xn(null))}};function nf(n,e,t){if(be(e))return new Kr(new xn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=An(i,e);return s=s.updateChild(o,t),new Kr(n.writeTree_.set(i,s))}else{let i=new xn(t),s=n.writeTree_.setTree(e,i);return new Kr(s)}}}function zD(n,e,t){let r=n;return Yt(t,(i,s)=>{r=nf(r,ht(e,i),s)}),r}function Z2(n,e){if(be(e))return Kr.empty();{let t=n.writeTree_.setTree(e,new xn(null));return new Kr(t)}}function GD(n,e){return $a(n,e)!=null}function $a(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(An(t.path,e)):null}function eU(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(it,(r,i)=>{e.push(new Te(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Te(r,i.value))}),e}function lo(n,e){if(be(e))return n;{let t=$a(n,e);return t!=null?new Kr(new xn(t)):new Kr(n.writeTree_.subtree(e))}}function WD(n){return n.writeTree_.isEmpty()}function ru(n,e){return $U(je(),n.writeTree_,e)}function $U(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(q(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=$U(ht(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(ht(n,".priority"),r)),t}}function My(n,e){return GU(e,n)}function WJ(n,e,t,r,i){q(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=nf(n.visibleWrites,e,t)),n.lastWriteId=r}function KJ(n,e,t,r){q(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=zD(n.visibleWrites,e,t),n.lastWriteId=r}function QJ(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function YJ(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);q(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&JJ(a,r.path)?i=!1:Tr(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return XJ(n),!0;if(r.snap)n.visibleWrites=Z2(n.visibleWrites,r.path);else{let a=r.children;Yt(a,c=>{n.visibleWrites=Z2(n.visibleWrites,ht(r.path,c))})}return!0}else return!1}function JJ(n,e){if(n.snap)return Tr(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Tr(ht(n.path,t),e))return!0;return!1}function XJ(n){n.visibleWrites=HU(n.allWrites,ZJ,je()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function ZJ(n){return n.visible}function HU(n,e,t){let r=Kr.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)Tr(t,o)?(a=An(t,o),r=nf(r,a,s.snap)):Tr(o,t)&&(a=An(o,t),r=nf(r,je(),s.snap.getChild(a)));else if(s.children){if(Tr(t,o))a=An(t,o),r=zD(r,a,s.children);else if(Tr(o,t))if(a=An(o,t),be(a))r=zD(r,je(),s.children);else{let c=Rs(s.children,Ie(a));if(c){let l=c.getChild(et(a));r=nf(r,je(),l)}}}else throw Ho("WriteRecord should have .snap or .children")}}return r}function qU(n,e,t,r,i){if(!r&&!i){let s=$a(n.visibleWrites,e);if(s!=null)return s;{let o=lo(n.visibleWrites,e);if(WD(o))return t;if(t==null&&!GD(o,je()))return null;{let a=t||_e.EMPTY_NODE;return ru(o,a)}}}else{let s=lo(n.visibleWrites,e);if(!i&&WD(s))return t;if(!i&&t==null&&!GD(s,je()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(Tr(l.path,e)||Tr(e,l.path))},a=HU(n.allWrites,o,e),c=t||_e.EMPTY_NODE;return ru(a,c)}}}function eX(n,e,t){let r=_e.EMPTY_NODE,i=$a(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(it,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=lo(n.visibleWrites,e);return t.forEachChild(it,(o,a)=>{let c=ru(lo(s,new $e(o)),a);r=r.updateImmediateChild(o,c)}),eU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=lo(n.visibleWrites,e);return eU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function tX(n,e,t,r,i){q(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=ht(e,t);if(GD(n.visibleWrites,s))return null;{let o=lo(n.visibleWrites,s);return WD(o)?i.getChild(t):ru(o,i.getChild(t))}}function nX(n,e,t,r){let i=ht(e,t),s=$a(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=lo(n.visibleWrites,i);return ru(o,r.getNode().getImmediateChild(t))}else return null}function rX(n,e){return $a(n.visibleWrites,e)}function iX(n,e,t,r,i,s,o){let a,c=lo(n.visibleWrites,e),l=$a(c,je());if(l!=null)a=l;else if(t!=null)a=ru(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),p=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=p.getNext();for(;_&&d.length<i;)h(_,r)!==0&&d.push(_),_=p.getNext();return d}else return[]}function sX(){return{visibleWrites:Kr.empty(),allWrites:[],lastWriteId:-1}}function _y(n,e,t,r){return qU(n.writeTree,n.treePath,e,t,r)}function NA(n,e){return eX(n.writeTree,n.treePath,e)}function tU(n,e,t,r){return tX(n.writeTree,n.treePath,e,t,r)}function yy(n,e){return rX(n.writeTree,ht(n.treePath,e))}function oX(n,e,t,r,i,s){return iX(n.writeTree,n.treePath,e,t,r,i,s)}function kA(n,e,t){return nX(n.writeTree,n.treePath,e,t)}function zU(n,e){return GU(ht(n.treePath,e),n.writeTree)}function GU(n,e){return{treePath:n,writeTree:e}}var KD=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;q(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),q(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,lf(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,cf(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,tu(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,lf(r,e.snapshotNode,i.oldSnap));else throw Ho("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var QD=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},WU=new QD,ff=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new ki(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return kA(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ba(this.viewCache_),s=oX(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function aX(n){return{filter:n}}function cX(n,e){q(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),q(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function lX(n,e,t,r,i){let s=new KD,o,a;if(t.type===xi.OVERWRITE){let l=t;l.source.fromUser?o=YD(n,e,l.path,l.snap,r,i,s):(q(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!be(l.path),o=vy(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===xi.MERGE){let l=t;l.source.fromUser?o=dX(n,e,l.path,l.children,r,i,s):(q(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=JD(n,e,l.path,l.children,r,i,a,s))}else if(t.type===xi.ACK_USER_WRITE){let l=t;l.revert?o=pX(n,e,l.path,r,i,s):o=hX(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===xi.LISTEN_COMPLETE)o=fX(n,e,t.path,r,s);else throw Ho("Unknown operation type: "+t.type);let c=s.getChanges();return uX(e,o,c),{viewCache:o,changes:c}}function uX(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=gy(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(BU(gy(e)))}}function KU(n,e,t,r,i,s){let o=e.eventCache;if(yy(r,t)!=null)return e;{let a,c;if(be(t))if(q(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Ba(e),d=l instanceof _e?l:_e.EMPTY_NODE,h=NA(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=_y(r,Ba(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=Ie(t);if(l===".priority"){q(fo(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let h=tU(r,t,d,c);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=et(t),h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let p=tU(r,t,o.getNode(),c);p!=null?h=o.getNode().getImmediateChild(l).updateChild(d,p):h=o.getNode().getImmediateChild(l)}else h=kA(r,l,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),l,h,d,i,s):a=o.getNode()}}return tf(e,a,o.isFullyInitialized()||be(t),n.filter.filtersNodes())}}function vy(n,e,t,r,i,s,o,a){let c=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(be(t))l=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);l=d.updateFullNode(c.getNode(),_,null)}else{let _=Ie(t);if(!c.isCompleteForPath(t)&&fo(t)>1)return e;let E=et(t),R=c.getNode().getImmediateChild(_).updateChild(E,r);_===".priority"?l=d.updatePriority(c.getNode(),R):l=d.updateChild(c.getNode(),_,R,E,WU,null)}let h=jU(e,l,c.isFullyInitialized()||be(t),d.filtersNodes()),p=new ff(i,h,s);return KU(n,h,t,i,p,a)}function YD(n,e,t,r,i,s,o){let a=e.eventCache,c,l,d=new ff(i,e,s);if(be(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=tf(e,l,!0,n.filter.filtersNodes());else{let h=Ie(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=tf(e,l,a.isFullyInitialized(),a.isFiltered());else{let p=et(t),_=a.getNode().getImmediateChild(h),E;if(be(p))E=r;else{let A=d.getCompleteChild(h);A!=null?bA(p)===".priority"&&A.getChild(MU(p)).isEmpty()?E=A:E=A.updateChild(p,r):E=_e.EMPTY_NODE}if(_.equals(E))c=e;else{let A=n.filter.updateChild(a.getNode(),h,E,p,d,o);c=tf(e,A,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function nU(n,e){return n.eventCache.isCompleteForChild(e)}function dX(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let d=ht(t,c);nU(e,Ie(d))&&(a=YD(n,a,d,l,i,s,o))}),r.foreach((c,l)=>{let d=ht(t,c);nU(e,Ie(d))||(a=YD(n,a,d,l,i,s,o))}),a}function rU(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function JD(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;be(t)?l=r:l=new xn(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((h,p)=>{if(d.hasChild(h)){let _=e.serverCache.getNode().getImmediateChild(h),E=rU(n,_,p);c=vy(n,c,new $e(h),E,i,s,o,a)}}),l.children.inorderTraversal((h,p)=>{let _=!e.serverCache.isCompleteForChild(h)&&p.value===null;if(!d.hasChild(h)&&!_){let E=e.serverCache.getNode().getImmediateChild(h),A=rU(n,E,p);c=vy(n,c,new $e(h),A,i,s,o,a)}}),c}function hX(n,e,t,r,i,s,o){if(yy(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(be(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return vy(n,e,t,c.getNode().getChild(t),i,s,a,o);if(be(t)){let l=new xn(null);return c.getNode().forEachChild(Ri,(d,h)=>{l=l.set(new $e(d),h)}),JD(n,e,t,l,i,s,a,o)}else return e}else{let l=new xn(null);return r.foreach((d,h)=>{let p=ht(t,d);c.isCompleteForPath(p)&&(l=l.set(d,c.getNode().getChild(p)))}),JD(n,e,t,l,i,s,a,o)}}function fX(n,e,t,r,i){let s=e.serverCache,o=jU(e,s.getNode(),s.isFullyInitialized()||be(t),s.isFiltered());return KU(n,o,t,r,WU,i)}function pX(n,e,t,r,i,s){let o;if(yy(r,t)!=null)return e;{let a=new ff(r,e,i),c=e.eventCache.getNode(),l;if(be(t)||Ie(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=_y(r,Ba(e));else{let h=e.serverCache.getNode();q(h instanceof _e,"serverChildren would be complete if leaf node"),d=NA(r,h)}d=d,l=n.filter.updateFullNode(c,d,s)}else{let d=Ie(t),h=kA(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?l=n.filter.updateChild(c,d,h,et(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(c,d,_e.EMPTY_NODE,et(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=_y(r,Ba(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||yy(r,je())!=null,tf(e,l,o,n.filter.filtersNodes())}}var XD=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new uf(r.getIndex()),s=OJ(r);this.processor_=aX(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(_e.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(_e.EMPTY_NODE,a.getNode(),null),d=new ki(c,o.isFullyInitialized(),i.filtersNodes()),h=new ki(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Py(h,d),this.eventGenerator_=new qD(this.query_)}get query(){return this.query_}};function mX(n){return n.viewCache_.serverCache.getNode()}function gX(n){return gy(n.viewCache_)}function _X(n,e){let t=Ba(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!be(e)&&!t.getImmediateChild(Ie(e)).isEmpty())?t.getChild(e):null}function iU(n){return n.eventRegistrations_.length===0}function yX(n,e){n.eventRegistrations_.push(e)}function sU(n,e,t){let r=[];if(t){q(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function oU(n,e,t,r){e.type===xi.MERGE&&e.source.queryId!==null&&(q(Ba(n.viewCache_),"We should always have a full cache before handling merges"),q(gy(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=lX(n.processor_,i,e,t,r);return cX(n.processor_,s.viewCache),q(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,QU(n,s.changes,s.viewCache.eventCache.getNode(),null)}function vX(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(it,(s,o)=>{r.push(tu(s,o))}),t.isFullyInitialized()&&r.push(BU(t.getNode())),QU(n,r,t.getNode(),e)}function QU(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return HJ(n.eventGenerator_,e,t,i)}var wy,Ey=class{constructor(){this.views=new Map}};function wX(n){q(!wy,"__referenceConstructor has already been defined"),wy=n}function EX(){return q(wy,"Reference.ts has not been loaded"),wy}function IX(n){return n.views.size===0}function PA(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return q(s!=null,"SyncTree gave us an op for an invalid query."),oU(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(oU(o,e,t,r));return s}}function YU(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=_y(t,i?r:null),c=!1;a?c=!0:r instanceof _e?(a=NA(t,r),c=!1):(a=_e.EMPTY_NODE,c=!1);let l=Py(new ki(a,c,!1),new ki(r,i,!1));return new XD(e,l)}return o}function bX(n,e,t,r,i,s){let o=YU(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),yX(o,t),vX(o,t)}function CX(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=po(n);if(i==="default")for(let[c,l]of n.views.entries())o=o.concat(sU(l,t,r)),iU(l)&&(n.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=n.views.get(i);c&&(o=o.concat(sU(c,t,r)),iU(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!po(n)&&s.push(new(EX())(e._repo,e._path)),{removed:s,events:o}}function JU(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function uo(n,e){let t=null;for(let r of n.views.values())t=t||_X(r,e);return t}function XU(n,e){if(e._queryParams.loadsAllData())return Oy(n);{let r=e._queryIdentifier;return n.views.get(r)}}function ZU(n,e){return XU(n,e)!=null}function po(n){return Oy(n)!=null}function Oy(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Iy;function TX(n){q(!Iy,"__referenceConstructor has already been defined"),Iy=n}function SX(){return q(Iy,"Reference.ts has not been loaded"),Iy}var DX=1,by=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new xn(null),this.pendingWriteTree_=sX(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function MA(n,e,t,r,i){return WJ(n.pendingWriteTree_,e,t,r,i),i?cu(n,new nu(AA(),e,t)):[]}function AX(n,e,t,r){KJ(n.pendingWriteTree_,e,t,r);let i=xn.fromObject(t);return cu(n,new hf(AA(),e,i))}function co(n,e,t=!1){let r=QJ(n.pendingWriteTree_,e);if(YJ(n.pendingWriteTree_,e)){let s=new xn(null);return r.snap!=null?s=s.set(je(),!0):Yt(r.children,o=>{s=s.set(new $e(o),!0)}),cu(n,new HD(r.path,s,t))}else return[]}function If(n,e,t){return cu(n,new nu(xA(),e,t))}function xX(n,e,t){let r=xn.fromObject(t);return cu(n,new hf(xA(),e,r))}function RX(n,e){return cu(n,new my(xA(),e))}function NX(n,e,t){let r=OA(n,t);if(r){let i=FA(r),s=i.path,o=i.queryId,a=An(s,e),c=new my(RA(o),a);return LA(n,s,c)}else return[]}function Cy(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||ZU(o,e))){let c=CX(o,e,t,r);IX(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let d=l.findIndex(p=>p._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(p,_)=>po(_));if(d&&!h){let p=n.syncPointTree_.subtree(s);if(!p.isEmpty()){let _=MX(p);for(let E=0;E<_.length;++E){let A=_[E],R=A.query,V=rB(n,A);n.listenProvider_.startListening(rf(R),pf(n,R),V.hashFn,V.onComplete)}}}!h&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(rf(e),null):l.forEach(p=>{let _=n.queryToTagMap.get(Ly(p));n.listenProvider_.stopListening(rf(p),_)}))}OX(n,l)}return a}function eB(n,e,t,r){let i=OA(n,r);if(i!=null){let s=FA(i),o=s.path,a=s.queryId,c=An(o,e),l=new nu(RA(a),c,t);return LA(n,o,l)}else return[]}function kX(n,e,t,r){let i=OA(n,r);if(i){let s=FA(i),o=s.path,a=s.queryId,c=An(o,e),l=xn.fromObject(t),d=new hf(RA(a),c,l);return LA(n,o,d)}else return[]}function ZD(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(p,_)=>{let E=An(p,i);s=s||uo(_,E),o=o||po(_)});let a=n.syncPointTree_.get(i);a?(o=o||po(a),s=s||uo(a,je())):(a=new Ey,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=_e.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,E)=>{let A=uo(E,je());A&&(s=s.updateImmediateChild(_,A))}));let l=ZU(a,e);if(!l&&!e._queryParams.loadsAllData()){let p=Ly(e);q(!n.queryToTagMap.has(p),"View does not exist, but we have a tag");let _=FX();n.queryToTagMap.set(p,_),n.tagToQueryMap.set(_,p)}let d=My(n.pendingWriteTree_,i),h=bX(a,e,t,d,s,c);if(!l&&!o&&!r){let p=XU(a,e);h=h.concat(LX(n,e,p))}return h}function Fy(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=An(o,e),l=uo(a,c);if(l)return l});return qU(i,e,s,t,!0)}function PX(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let h=An(l,t);r=r||uo(d,h)});let i=n.syncPointTree_.get(t);i?r=r||uo(i,je()):(i=new Ey,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new ki(r,!0,!1):null,a=My(n.pendingWriteTree_,e._path),c=YU(i,e,a,s?o.getNode():_e.EMPTY_NODE,s);return gX(c)}function cu(n,e){return tB(e,n.syncPointTree_,null,My(n.pendingWriteTree_,je()))}function tB(n,e,t,r){if(be(n.path))return nB(n,e,t,r);{let i=e.get(je());t==null&&i!=null&&(t=uo(i,je()));let s=[],o=Ie(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,d=zU(r,o);s=s.concat(tB(a,c,l,d))}return i&&(s=s.concat(PA(i,n,r,t))),s}}function nB(n,e,t,r){let i=e.get(je());t==null&&i!=null&&(t=uo(i,je()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=zU(r,o),d=n.operationForChild(o);d&&(s=s.concat(nB(d,a,c,l)))}),i&&(s=s.concat(PA(i,n,r,t))),s}function rB(n,e){let t=e.query,r=pf(n,t);return{hashFn:()=>(mX(e)||_e.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?NX(n,t._path,r):RX(n,t._path);{let s=WY(i,t);return Cy(n,t,null,s)}}}}function pf(n,e){let t=Ly(e);return n.queryToTagMap.get(t)}function Ly(n){return n._path.toString()+"$"+n._queryIdentifier}function OA(n,e){return n.tagToQueryMap.get(e)}function FA(n){let e=n.indexOf("$");return q(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new $e(n.substr(0,e))}}function LA(n,e,t){let r=n.syncPointTree_.get(e);q(r,"Missing sync point for query tag that we're tracking");let i=My(n.pendingWriteTree_,e);return PA(r,t,i,null)}function MX(n){return n.fold((e,t,r)=>{if(t&&po(t))return[Oy(t)];{let i=[];return t&&(i=JU(t)),Yt(r,(s,o)=>{i=i.concat(o)}),i}})}function rf(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(SX())(n._repo,n._path):n}function OX(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=Ly(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function FX(){return DX++}function LX(n,e,t){let r=e._path,i=pf(n,e),s=rB(n,t),o=n.listenProvider_.startListening(rf(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)q(!po(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,d,h)=>{if(!be(l)&&d&&po(d))return[Oy(d).query];{let p=[];return d&&(p=p.concat(JU(d).map(_=>_.query))),Yt(h,(_,E)=>{p=p.concat(E)}),p}});for(let l=0;l<c.length;++l){let d=c[l];n.listenProvider_.stopListening(rf(d),pf(n,d))}}return o}var eA=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},tA=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=ht(this.path_,e);return new n(this.syncTree_,t)}node(){return Fy(this.syncTree_,this.path_)}},VX=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},aU=function(n,e,t){if(!n||typeof n!="object")return n;if(q(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return UX(n[".sv"],e,t);if(typeof n[".sv"]=="object")return BX(n[".sv"],e);q(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},UX=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:q(!1,"Unexpected server value: "+n)}},BX=function(n,e,t){n.hasOwnProperty("increment")||q(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&q(!1,"Unexpected increment value: "+r);let i=e.node();if(q(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},iB=function(n,e,t,r){return UA(e,new tA(t,n),r)},VA=function(n,e,t){return UA(n,new eA(e),t)};function UA(n,e,t){let r=n.getPriority().val(),i=aU(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=aU(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Zl(a,_t(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Zl(i))),o.forEachChild(it,(a,c)=>{let l=UA(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var mf=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function Vy(n,e){let t=e instanceof $e?e:new $e(e),r=n,i=Ie(t);for(;i!==null;){let s=Rs(r.node.children,i)||{children:{},childCount:0};r=new mf(i,r,s),t=et(t),i=Ie(t)}return r}function Ha(n){return n.node.value}function BA(n,e){n.node.value=e,nA(n)}function sB(n){return n.node.childCount>0}function jX(n){return Ha(n)===void 0&&!sB(n)}function Uy(n,e){Yt(n.node.children,(t,r)=>{e(new mf(t,n,r))})}function oB(n,e,t,r){t&&!r&&e(n),Uy(n,i=>{oB(i,e,!0,r)}),t&&r&&e(n)}function $X(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function bf(n){return new $e(n.parent===null?n.name:bf(n.parent)+"/"+n.name)}function nA(n){n.parent!==null&&HX(n.parent,n.name,n)}function HX(n,e,t){let r=jX(t),i=En(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,nA(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,nA(n))}var qX=/[\[\].#$\/\u0000-\u001F\u007F]/,zX=/[\[\].#$\u0000-\u001F\u007F]/,fD=10*1024*1024,By=function(n){return typeof n=="string"&&n.length!==0&&!qX.test(n)},aB=function(n){return typeof n=="string"&&n.length!==0&&!zX.test(n)},GX=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),aB(n)},gf=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Ny(n)||n&&typeof n=="object"&&En(n,".sv")},Pi=function(n,e,t,r){r&&e===void 0||Cf(dn(n,"value"),e,t)},Cf=function(n,e,t){let r=t instanceof $e?new SD(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+La(r));if(typeof e=="function")throw new Error(n+"contains a function "+La(r)+" with contents = "+e.toString());if(Ny(e))throw new Error(n+"contains "+e.toString()+" "+La(r));if(typeof e=="string"&&e.length>fD/3&&Dd(e)>fD)throw new Error(n+"contains a string greater than "+fD+" utf8 bytes "+La(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Yt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!By(o)))throw new Error(n+" contains an invalid key ("+o+") "+La(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);IJ(r,o),Cf(n,a,r),bJ(r)}),i&&s)throw new Error(n+' contains ".value" child '+La(r)+" in addition to actual children.")}},WX=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=of(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!By(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(EJ);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&Tr(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},cB=function(n,e,t,r){if(r&&e===void 0)return;let i=dn(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Yt(e,(o,a)=>{let c=new $e(o);if(Cf(i,a,ht(t,c)),bA(c)===".priority"&&!gf(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),WX(i,s)},jA=function(n,e,t){if(!(t&&e===void 0)){if(Ny(e))throw new Error(dn(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!gf(e))throw new Error(dn(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Tf=function(n,e,t,r){if(!(r&&t===void 0)&&!By(t))throw new Error(dn(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},lu=function(n,e,t,r){if(!(r&&t===void 0)&&!aB(t))throw new Error(dn(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},KX=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),lu(n,e,t,r)},rr=function(n,e){if(Ie(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},lB=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!By(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!GX(t))throw new Error(dn(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var rA=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function jy(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!CA(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function uB(n,e,t){jy(n,t),dB(n,r=>CA(r,e))}function ir(n,e,t){jy(n,t),dB(n,r=>Tr(r,e)||Tr(e,r))}function dB(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(QX(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function QX(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Ua&&Qt("event: "+t.toString()),ou(r)}}}var hB="repo_interrupt",YX=25,iA=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new rA,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=py(),this.transactionQueueTree_=new mf,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function JX(n,e,t){if(n.stats_=IA(n.repoInfo_),n.forceRestClient_||JY())n.server_=new LD(n.repoInfo_,(r,i,s,o)=>{cU(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>lU(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Nt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new TA(n.repoInfo_,e,(r,i,s,o)=>{cU(n,r,i,s,o)},r=>{lU(n,r)},r=>{XX(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=ZY(n.repoInfo_,()=>new $D(n.stats_,n.server_)),n.infoData_=new VD,n.infoSyncTree_=new by({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=If(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),$A(n,"connected",!1),n.serverSyncTree_=new by({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);ir(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function fB(n){let t=n.infoData_.getNode(new $e(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Sf(n){return VX({timestamp:fB(n)})}function cU(n,e,t,r,i){n.dataUpdateCount++;let s=new $e(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=Sd(t,l=>_t(l));o=kX(n.serverSyncTree_,s,c,i)}else{let c=_t(t);o=eB(n.serverSyncTree_,s,c,i)}else if(r){let c=Sd(t,l=>_t(l));o=xX(n.serverSyncTree_,s,c)}else{let c=_t(t);o=If(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=iu(n,s)),ir(n.eventQueue_,a,o)}function lU(n,e){$A(n,"connected",e),e===!1&&tZ(n)}function XX(n,e){Yt(e,(t,r)=>{$A(n,t,r)})}function $A(n,e,t){let r=new $e("/.info/"+e),i=_t(t);n.infoData_.updateSnapshot(r,i);let s=If(n.infoSyncTree_,r,i);ir(n.eventQueue_,r,s)}function $y(n){return n.nextWriteId_++}function ZX(n,e,t){let r=PX(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=_t(i).withIndex(e._queryParams.getIndex());ZD(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=If(n.serverSyncTree_,e._path,s);else{let a=pf(n.serverSyncTree_,e);o=eB(n.serverSyncTree_,e._path,s,a)}return ir(n.eventQueue_,e._path,o),Cy(n.serverSyncTree_,e,t,null,!0),s},i=>(uu(n,"get for query "+Nt(e)+" failed: "+i),Promise.reject(new Error(i))))}function HA(n,e,t,r,i){uu(n,"set",{path:e.toString(),value:t,priority:r});let s=Sf(n),o=_t(t,r),a=Fy(n.serverSyncTree_,e),c=VA(o,a,s),l=$y(n),d=MA(n.serverSyncTree_,e,c,l,!0);jy(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(p,_)=>{let E=p==="ok";E||gn("set at "+e+" failed: "+p);let A=co(n.serverSyncTree_,l,!E);ir(n.eventQueue_,e,A),mo(n,i,p,_)});let h=zA(n,e);iu(n,h),ir(n.eventQueue_,h,[])}function eZ(n,e,t,r){uu(n,"update",{path:e.toString(),value:t});let i=!0,s=Sf(n),o={};if(Yt(t,(a,c)=>{i=!1,o[a]=iB(ht(e,a),_t(c),n.serverSyncTree_,s)}),i)Qt("update() called with empty data.  Don't do anything."),mo(n,r,"ok",void 0);else{let a=$y(n),c=AX(n.serverSyncTree_,e,o,a);jy(n.eventQueue_,c),n.server_.merge(e.toString(),t,(l,d)=>{let h=l==="ok";h||gn("update at "+e+" failed: "+l);let p=co(n.serverSyncTree_,a,!h),_=p.length>0?iu(n,e):e;ir(n.eventQueue_,_,p),mo(n,r,l,d)}),Yt(t,l=>{let d=zA(n,ht(e,l));iu(n,d)}),ir(n.eventQueue_,e,[])}}function tZ(n){uu(n,"onDisconnectEvents");let e=Sf(n),t=py();BD(n.onDisconnect_,je(),(i,s)=>{let o=iB(i,s,n.serverSyncTree_,e);au(t,i,o)});let r=[];BD(t,je(),(i,s)=>{r=r.concat(If(n.serverSyncTree_,i,s));let o=zA(n,i);iu(n,o)}),n.onDisconnect_=py(),ir(n.eventQueue_,je(),r)}function nZ(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&UD(n.onDisconnect_,e),mo(n,t,r,i)})}function uU(n,e,t,r){let i=_t(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&au(n.onDisconnect_,e,i),mo(n,r,s,o)})}function rZ(n,e,t,r,i){let s=_t(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&au(n.onDisconnect_,e,s),mo(n,i,o,a)})}function iZ(n,e,t,r){if(Uc(t)){Qt("onDisconnect().update() called with empty data.  Don't do anything."),mo(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Yt(t,(o,a)=>{let c=_t(a);au(n.onDisconnect_,ht(e,o),c)}),mo(n,r,i,s)})}function sZ(n,e,t){let r;Ie(e._path)===".info"?r=ZD(n.infoSyncTree_,e,t):r=ZD(n.serverSyncTree_,e,t),uB(n.eventQueue_,e._path,r)}function sA(n,e,t){let r;Ie(e._path)===".info"?r=Cy(n.infoSyncTree_,e,t):r=Cy(n.serverSyncTree_,e,t),uB(n.eventQueue_,e._path,r)}function pB(n){n.persistentConnection_&&n.persistentConnection_.interrupt(hB)}function oZ(n){n.persistentConnection_&&n.persistentConnection_.resume(hB)}function uu(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Qt(t,...e)}function mo(n,e,t,r){e&&ou(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function aZ(n,e,t,r,i,s){uu(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:fU(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=qA(n,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Cf("transaction failed: Data returned ",c,o.path),o.status=0;let l=Vy(n.transactionQueueTree_,e),d=Ha(l)||[];d.push(o),BA(l,d);let h;typeof c=="object"&&c!==null&&En(c,".priority")?(h=Rs(c,".priority"),q(gf(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Fy(n.serverSyncTree_,e)||_e.EMPTY_NODE).getPriority().val();let p=Sf(n),_=_t(c,h),E=VA(_,a,p);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=E,o.currentWriteId=$y(n);let A=MA(n.serverSyncTree_,e,E,o.currentWriteId,o.applyLocally);ir(n.eventQueue_,e,A),Hy(n,n.transactionQueueTree_)}}function qA(n,e,t){return Fy(n.serverSyncTree_,e,t)||_e.EMPTY_NODE}function Hy(n,e=n.transactionQueueTree_){if(e||qy(n,e),Ha(e)){let t=gB(n,e);q(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&cZ(n,bf(e),t)}else sB(e)&&Uy(e,t=>{Hy(n,t)})}function cZ(n,e,t){let r=t.map(l=>l.currentWriteId),i=qA(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];q(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=An(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{uu(n,"transaction put response",{path:c.toString(),status:l});let d=[];if(l==="ok"){let h=[];for(let p=0;p<t.length;p++)t[p].status=2,d=d.concat(co(n.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&h.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();qy(n,Vy(n.transactionQueueTree_,e)),Hy(n,n.transactionQueueTree_),ir(n.eventQueue_,e,d);for(let p=0;p<h.length;p++)ou(h[p])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{gn("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}iu(n,e)}},o)}function iu(n,e){let t=mB(n,e),r=bf(t),i=gB(n,t);return lZ(n,i,r),r}function lZ(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=An(t,c.path),d=!1,h;if(q(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,i=i.concat(co(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=YX)d=!0,h="maxretry",i=i.concat(co(n.serverSyncTree_,c.currentWriteId,!0));else{let p=qA(n,c.path,o);c.currentInputSnapshot=p;let _=e[a].update(p.val());if(_!==void 0){Cf("transaction failed: Data returned ",_,c.path);let E=_t(_);typeof _=="object"&&_!=null&&En(_,".priority")||(E=E.updatePriority(p.getPriority()));let R=c.currentWriteId,V=Sf(n),J=VA(E,p,V);c.currentOutputSnapshotRaw=E,c.currentOutputSnapshotResolved=J,c.currentWriteId=$y(n),o.splice(o.indexOf(R),1),i=i.concat(MA(n.serverSyncTree_,c.path,J,c.currentWriteId,c.applyLocally)),i=i.concat(co(n.serverSyncTree_,R,!0))}else d=!0,h="nodata",i=i.concat(co(n.serverSyncTree_,c.currentWriteId,!0))}ir(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}qy(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)ou(r[a]);Hy(n,n.transactionQueueTree_)}function mB(n,e){let t,r=n.transactionQueueTree_;for(t=Ie(e);t!==null&&Ha(r)===void 0;)r=Vy(r,t),e=et(e),t=Ie(e);return r}function gB(n,e){let t=[];return _B(n,e,t),t.sort((r,i)=>r.order-i.order),t}function _B(n,e,t){let r=Ha(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Uy(e,i=>{_B(n,i,t)})}function qy(n,e){let t=Ha(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,BA(e,t.length>0?t:void 0)}Uy(e,r=>{qy(n,r)})}function zA(n,e){let t=bf(mB(n,e)),r=Vy(n.transactionQueueTree_,e);return $X(r,i=>{pD(n,i)}),pD(n,r),oB(r,i=>{pD(n,i)}),t}function pD(n,e){let t=Ha(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(q(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(q(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(co(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?BA(e,void 0):t.length=s+1,ir(n.eventQueue_,bf(e),i);for(let o=0;o<r.length;o++)ou(r[o])}}function uZ(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function dZ(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):gn(`Invalid query segment '${t}' in query '${n}'`)}return e}var oA=function(n,e){let t=hZ(n),r=t.namespace;t.domain==="firebase.com"&&Ni(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Ni("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||$Y();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new oy(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new $e(t.pathString)}},hZ=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=uZ(n.substring(d,h)));let p=dZ(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let _=e.slice(0,l);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),t=e.substring(E+1),s=r}"ns"in p&&(s=p.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var dU="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",fZ=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=dU.charAt(t%64),t=Math.floor(t/64);q(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=dU.charAt(e[i]);return q(o.length===20,"nextPushId: Length should be 20."),o}}();var Ty=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Nt(this.snapshot.exportVal())}},Sy=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var _f=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return q(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Dy=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new jt;return nZ(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){rr("OnDisconnect.remove",this._path);let e=new jt;return uU(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){rr("OnDisconnect.set",this._path),Pi("OnDisconnect.set",e,this._path,!1);let t=new jt;return uU(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){rr("OnDisconnect.setWithPriority",this._path),Pi("OnDisconnect.setWithPriority",e,this._path,!1),jA("OnDisconnect.setWithPriority",t,!1);let r=new jt;return rZ(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){rr("OnDisconnect.update",this._path),cB("OnDisconnect.update",e,this._path,!1);let t=new jt;return iZ(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var Rn=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return be(this._path)?null:bA(this._path)}get ref(){return new sr(this._repo,this._path)}get _queryIdentifier(){let e=J2(this._queryParams),t=EA(e);return t==="{}"?"default":t}get _queryObject(){return J2(this._queryParams)}isEqual(e){if(e=K(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=CA(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+wJ(this._path)}};function zy(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function _o(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Ri){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==ho)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==os)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===it){if(e!=null&&!gf(e)||t!=null&&!gf(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(q(n.getIndex()instanceof af||n.getIndex()===DA,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Gy(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var sr=class n extends Rn{constructor(e,t){super(e,t,new df,!1)}get parent(){let e=MU(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},su=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new $e(e),r=go(this.ref,e);return new n(this._node.getChild(t),r,it)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,go(this.ref,r),it)))}hasChild(e){let t=new $e(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function GA(n,e){return n=K(n),n._checkNotDeleted("ref"),e!==void 0?go(n._root,e):n._root}function WA(n,e){n=K(n),n._checkNotDeleted("refFromURL");let t=oA(e,n._repo.repoInfo_.nodeAdmin);lB("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Ni("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),GA(n,t.path.toString())}function go(n,e){return n=K(n),Ie(n._path)===null?KX("child","path",e,!1):lu("child","path",e,!1),new sr(n._repo,ht(n._path,e))}function yB(n,e){n=K(n),rr("push",n._path),Pi("push",e,n._path,!0);let t=fB(n._repo),r=fZ(t),i=go(n,r),s=go(n,r),o;return e!=null?o=Wy(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function vB(n){return rr("remove",n._path),Wy(n,null)}function Wy(n,e){n=K(n),rr("set",n._path),Pi("set",e,n._path,!1);let t=new jt;return HA(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function wB(n,e){n=K(n),rr("setPriority",n._path),jA("setPriority",e,!1);let t=new jt;return HA(n._repo,ht(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function EB(n,e,t){if(rr("setWithPriority",n._path),Pi("setWithPriority",e,n._path,!1),jA("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new jt;return HA(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function IB(n,e){cB("update",e,n._path,!1);let t=new jt;return eZ(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function bB(n){n=K(n);let e=new _f(()=>{}),t=new yf(e);return ZX(n._repo,n,t).then(r=>new su(r,new sr(n._repo,n._path),n._queryParams.getIndex()))}var yf=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new Ty("value",this,new su(e.snapshotNode,new sr(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Sy(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Ay=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Sy(this,e,t):null}createEvent(e,t){q(e.childName!=null,"Child events should have a childName.");let r=go(new sr(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new Ty(e.type,this,new su(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Df(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,l=(d,h)=>{sA(n._repo,n,a),c(d,h)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new _f(t,s||void 0),a=e==="value"?new yf(o):new Ay(e,o);return sZ(n._repo,n,a),()=>sA(n._repo,n,a)}function Ky(n,e,t,r){return Df(n,"value",e,t,r)}function KA(n,e,t,r){return Df(n,"child_added",e,t,r)}function QA(n,e,t,r){return Df(n,"child_changed",e,t,r)}function YA(n,e,t,r){return Df(n,"child_moved",e,t,r)}function JA(n,e,t,r){return Df(n,"child_removed",e,t,r)}function XA(n,e,t){let r=null,i=t?new _f(t):null;e==="value"?r=new yf(i):e&&(r=new Ay(e,i)),sA(n._repo,n,r)}var or=class{},xy=class extends or{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Pi("endAt",this._value,e._path,!0);let t=FD(e._queryParams,this._value,this._key);if(Gy(t),_o(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Rn(e._repo,e._path,t,e._orderByCalled)}};function CB(n,e){return Tf("endAt","key",e,!0),new xy(n,e)}var aA=class extends or{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Pi("endBefore",this._value,e._path,!1);let t=UJ(e._queryParams,this._value,this._key);if(Gy(t),_o(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Rn(e._repo,e._path,t,e._orderByCalled)}};function TB(n,e){return Tf("endBefore","key",e,!0),new aA(n,e)}var Ry=class extends or{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Pi("startAt",this._value,e._path,!0);let t=OD(e._queryParams,this._value,this._key);if(Gy(t),_o(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Rn(e._repo,e._path,t,e._orderByCalled)}};function SB(n=null,e){return Tf("startAt","key",e,!0),new Ry(n,e)}var cA=class extends or{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Pi("startAfter",this._value,e._path,!1);let t=VJ(e._queryParams,this._value,this._key);if(Gy(t),_o(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Rn(e._repo,e._path,t,e._orderByCalled)}};function DB(n,e){return Tf("startAfter","key",e,!0),new cA(n,e)}var lA=class extends or{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Rn(e._repo,e._path,FJ(e._queryParams,this._limit),e._orderByCalled)}};function AB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new lA(n)}var uA=class extends or{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Rn(e._repo,e._path,LJ(e._queryParams,this._limit),e._orderByCalled)}};function xB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new uA(n)}var dA=class extends or{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){zy(e,"orderByChild");let t=new $e(this._path);if(be(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new af(t),i=ky(e._queryParams,r);return _o(i),new Rn(e._repo,e._path,i,!0)}};function RB(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return lu("orderByChild","path",n,!1),new dA(n)}var hA=class extends or{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){zy(e,"orderByKey");let t=ky(e._queryParams,Ri);return _o(t),new Rn(e._repo,e._path,t,!0)}};function NB(){return new hA}var fA=class extends or{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){zy(e,"orderByPriority");let t=ky(e._queryParams,it);return _o(t),new Rn(e._repo,e._path,t,!0)}};function kB(){return new fA}var pA=class extends or{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){zy(e,"orderByValue");let t=ky(e._queryParams,DA);return _o(t),new Rn(e._repo,e._path,t,!0)}};function PB(){return new pA}var mA=class extends or{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Pi("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new xy(this._value,this._key)._apply(new Ry(this._value,this._key)._apply(e))}};function MB(n,e){return Tf("equalTo","key",e,!0),new mA(n,e)}function Dr(n,...e){let t=K(n);for(let r of e)t=r._apply(t);return t}wX(sr);TX(sr);var pZ="FIREBASE_DATABASE_EMULATOR_HOST",gA={},mZ=!1;function gZ(n,e,t,r){n.repoInfo_=new oy(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function ZA(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Ni("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Qt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=oA(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[pZ]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=oA(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new ef(ef.OWNER):new wD(n.name,n.options,e);lB("Invalid Firebase Database URL",o),be(o.path)||Ni("Database URL must point to the root of a Firebase Database (not including a child path).");let h=yZ(a,n,d,new vD(n.name,t));return new _A(h,n)}function _Z(n,e){let t=gA[e];(!t||t[n.key]!==n)&&Ni(`Database ${e}(${n.repoInfo_}) has already been deleted.`),pB(n),delete t[n.key]}function yZ(n,e,t,r){let i=gA[e.name];i||(i={},gA[e.name]=i);let s=i[n.toURLString()];return s&&Ni("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new iA(n,mZ,t,r),i[n.toURLString()]=s,s}var _A=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(JX(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new sr(this._repo,je())),this._rootInternal}_delete(){return this._rootInternal!==null&&(_Z(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ni("Cannot call "+e+" on a deleted database.")}};function OB(){PU.IS_TRANSPORT_INITIALIZED&&gn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function FB(){OB(),sf.forceDisallow()}function LB(){OB(),Ql.forceDisallow(),sf.forceAllow()}function VB(n,e,t,r={}){n=K(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Ni("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Ni('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new ef(ef.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Vc(r.mockUserToken,n.app.options.projectId);s=new ef(o)}gZ(i,e,t,s)}function UB(n){n=K(n),n._checkNotDeleted("goOffline"),pB(n._repo)}function BB(n){n=K(n),n._checkNotDeleted("goOnline"),oZ(n._repo)}function jB(n,e){mU(n,e)}function vZ(n){wA(bn),In(new Qe("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return ZA(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),Tt(M2,O2,n),Tt(M2,O2,"esm2017")}var wZ={".sv":"timestamp"};function $B(){return wZ}function HB(n){return{".sv":{increment:n}}}var yA=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function qB(n,e,t){var r;if(n=K(n),rr("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new jt,o=(c,l,d)=>{let h=null;c?s.reject(c):(h=new su(d,new sr(n._repo,n._path),it),s.resolve(new yA(l,h)))},a=Ky(n,()=>{});return aZ(n._repo,n._path,e,o,a,i),s.promise}TA.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};TA.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};vZ();var EZ="@firebase/database-compat",IZ="1.0.5";var bZ=new $n("@firebase/database-compat"),zB=function(n){let e="FIREBASE WARNING: "+n;bZ.warn(e)};var CZ=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(dn(n,e)+"must be a boolean.")},TZ=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(dn(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var ex=class{constructor(e){this._delegate=e}cancel(e){le("OnDisconnect.cancel",0,1,arguments.length),$t("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){le("OnDisconnect.remove",0,1,arguments.length),$t("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){le("OnDisconnect.set",1,2,arguments.length),$t("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){le("OnDisconnect.setWithPriority",2,3,arguments.length),$t("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(le("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,zB("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}$t("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var tx=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return le("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var qa=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return le("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return le("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return le("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return le("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return le("DataSnapshot.child",0,1,arguments.length),e=String(e),lu("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return le("DataSnapshot.hasChild",1,1,arguments.length),lu("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return le("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return le("DataSnapshot.forEach",1,1,arguments.length),$t("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return le("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return le("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return le("DataSnapshot.ref",0,0,arguments.length),new as(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Qy=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;le("Query.on",2,4,arguments.length),$t("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new qa(this.database,l),d)};a.userCallback=t,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Ky(this._delegate,a,c),t;case"child_added":return KA(this._delegate,a,c),t;case"child_removed":return JA(this._delegate,a,c),t;case"child_changed":return QA(this._delegate,a,c),t;case"child_moved":return YA(this._delegate,a,c),t;default:throw new Error(dn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(le("Query.off",0,3,arguments.length),TZ("Query.off",e,!0),$t("Query.off","callback",t,!0),GI("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,XA(this._delegate,e,i)}else XA(this._delegate,e)}get(){return bB(this._delegate).then(e=>new qa(this.database,e))}once(e,t,r,i){le("Query.once",1,4,arguments.length),$t("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new jt,a=(l,d)=>{let h=new qa(this.database,l);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":Ky(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":KA(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":JA(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":QA(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":YA(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(dn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return le("Query.limitToFirst",1,1,arguments.length),new n(this.database,Dr(this._delegate,AB(e)))}limitToLast(e){return le("Query.limitToLast",1,1,arguments.length),new n(this.database,Dr(this._delegate,xB(e)))}orderByChild(e){return le("Query.orderByChild",1,1,arguments.length),new n(this.database,Dr(this._delegate,RB(e)))}orderByKey(){return le("Query.orderByKey",0,0,arguments.length),new n(this.database,Dr(this._delegate,NB()))}orderByPriority(){return le("Query.orderByPriority",0,0,arguments.length),new n(this.database,Dr(this._delegate,kB()))}orderByValue(){return le("Query.orderByValue",0,0,arguments.length),new n(this.database,Dr(this._delegate,PB()))}startAt(e=null,t){return le("Query.startAt",0,2,arguments.length),new n(this.database,Dr(this._delegate,SB(e,t)))}startAfter(e=null,t){return le("Query.startAfter",0,2,arguments.length),new n(this.database,Dr(this._delegate,DB(e,t)))}endAt(e=null,t){return le("Query.endAt",0,2,arguments.length),new n(this.database,Dr(this._delegate,CB(e,t)))}endBefore(e=null,t){return le("Query.endBefore",0,2,arguments.length),new n(this.database,Dr(this._delegate,TB(e,t)))}equalTo(e,t){return le("Query.equalTo",1,2,arguments.length),new n(this.database,Dr(this._delegate,MB(e,t)))}toString(){return le("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return le("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(le("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,$t(e,"cancel",i.cancel,!0),i.context=r,GI(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(dn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new as(this.database,new sr(this._delegate._repo,this._delegate._path))}},as=class n extends Qy{constructor(e,t){super(e,new Rn(t._repo,t._path,new df,!1)),this.database=e,this._delegate=t}getKey(){return le("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return le("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,go(this._delegate,e))}getParent(){le("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return le("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){le("Reference.set",1,2,arguments.length),$t("Reference.set","onComplete",t,!0);let r=Wy(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(le("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,zB("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}rr("Reference.update",this._delegate._path),$t("Reference.update","onComplete",t,!0);let r=IB(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){le("Reference.setWithPriority",2,3,arguments.length),$t("Reference.setWithPriority","onComplete",r,!0);let i=EB(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){le("Reference.remove",0,1,arguments.length),$t("Reference.remove","onComplete",e,!0);let t=vB(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){le("Reference.transaction",1,3,arguments.length),$t("Reference.transaction","transactionUpdate",e,!1),$t("Reference.transaction","onComplete",t,!0),CZ("Reference.transaction","applyLocally",r,!0);let i=qB(this._delegate,e,{applyLocally:r}).then(s=>new tx(s.committed,new qa(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){le("Reference.setPriority",1,2,arguments.length),$t("Reference.setPriority","onComplete",t,!0);let r=wB(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){le("Reference.push",0,2,arguments.length),$t("Reference.push","onComplete",t,!0);let r=yB(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return rr("Reference.onDisconnect",this._delegate._path),new ex(new Dy(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var za=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:FB,forceLongPolling:LB}}useEmulator(e,t,r={}){VB(this._delegate,e,t,r)}ref(e){if(le("database.ref",0,1,arguments.length),e instanceof as){let t=WA(this._delegate,e.toString());return new as(this,t)}else{let t=GA(this._delegate,e);return new as(this,t)}}refFromURL(e){le("database.refFromURL",1,1,arguments.length);let r=WA(this._delegate,e);return new as(this,r)}goOffline(){return le("database.goOffline",0,0,arguments.length),UB(this._delegate)}goOnline(){return le("database.goOnline",0,0,arguments.length),BB(this._delegate)}};za.ServerValue={TIMESTAMP:$B(),increment:n=>HB(n)};function SZ({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){wA(t);let a=new Ps("database-standalone"),c=new Go("auth-internal",a);c.setComponent(new Qe("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new Go("app-check-internal",a),l.setComponent(new Qe("app-check-internal",()=>i,"PRIVATE"))),{instance:new za(ZA(n,c,l,e,o),n),namespace:s}}var DZ=Object.freeze({__proto__:null,initStandalone:SZ});var AZ=za.ServerValue;function xZ(n){n.INTERNAL.registerComponent(new Qe("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new za(i,r)},"PUBLIC").setServiceProps({Reference:as,Query:Qy,Database:za,DataSnapshot:qa,enableLogging:jB,INTERNAL:DZ,ServerValue:AZ}).setMultipleInstances(!0)),n.registerVersion(EZ,IZ)}xZ(F);var RZ="firebase",NZ="10.12.2";F.registerVersion(RZ,NZ,"app-compat");var GB=(()=>{let e=class e{constructor(r){this.router=r}ngOnInit(){F.auth().onAuthStateChanged(r=>{r?this.router.navigate(["/chat"]):(this.router.navigate(["/log"]),document.getElementById("sidebar-container").style.display="none",document.getElementById("sidebar").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%")})}};e.\u0275fac=function(i){return new(i||e)(ne(nt))},e.\u0275cmp=xe({type:e,selectors:[["app-log"]],decls:9,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],["routerLink","/login",1,"button"],["routerLink","/register",1,"button"]],template:function(i,s){i&1&&(v(0,"div",0),W(1,"div",1),v(2,"div",2),W(3,"img",3),v(4,"button",4),b(5,"Accedi"),w(),v(6,"button",5),b(7,"Registrati"),w()(),W(8,"div",1),w())},dependencies:[Oc]});let n=e;return n})();var ze=(()=>{let e=class e{constructor(r){this.router=r,this.currentSectorId="",this.linkObject={},this.linkCounter=0,this.ticketLinkObject={},this.ticketLinkCounter=0,this.ticketToRead=!1,this.isAdmin=!1,this.messageQueue=[]}initNormalScreen(){window.innerWidth>=899&&(document.getElementById("sidebar-container").style.display="flex",document.getElementById("sidebar").style.display="flex",document.getElementById("header").style.display="flex",document.getElementById("router-outlet-container").style.height="calc(100% - 3.5rem)",document.getElementById("router-outlet-container").style.width="calc(100% - 18rem)")}getUserData(){F.auth().onAuthStateChanged(r=>{r?F.firestore().collection("users_data").doc(r.uid).get().then(i=>{if(i.exists){var s=i.data();this.currentUser=s,document.getElementById("header-name-display").innerText=this.currentUser.name,document.getElementById("header-surname-display").innerText=this.currentUser.surname,document.getElementById("header-email-display").innerText=this.currentUser.email,document.getElementById("header-agency-display").innerText=this.currentUser.agencyName}else this.presentToast("Nessun utente trovato"),this.router.navigate(["/log"])}).catch(i=>{this.presentToast("Errore durante il recupero dell'utente:"+i.message)}):(console.log("Nessun utente loggato."),this.router.navigate(["/log"]))})}convertTimestamp(r){let i=new Date(r),s=String(i.getDate()).padStart(2,"0"),o=String(i.getMonth()+1).padStart(2,"0"),a=String(i.getFullYear()),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0"),d=String(i.getSeconds()).padStart(2,"0");return`${s}/${o}/${a} ${c}:${l}:${d}`}presentToast(r){this.animate1("toast-message"),this.messageQueue.push(r),this.messageQueue.length===1&&this.showMessageFromQueue()}showMessageFromQueue(){let r=this.messageQueue[0];document.getElementById("toast-message").style.display="flex",document.getElementById("toast-message-text").innerText=r,setTimeout(()=>{this.hideToastMessage()},3e3)}hideToastMessage(){this.animateFadeOut("toast-message"),setTimeout(()=>{document.getElementById("toast-message").style.display="none"},100),this.messageQueue.shift(),this.messageQueue.length>0&&(this.showMessageFromQueue(),this.animate1("toast-message"))}openCloseSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}animate1(r){var i=document.getElementById(r),s=[{opacity:0},{opacity:1}],o={duration:150,easing:"ease-in-out"};i.animate(s,o)}animateFadeOut(r){var i=document.getElementById(r),s=[{opacity:1},{opacity:0}],o={duration:150,easing:"ease-out"};i.animate(s,o)}getOpenTicketsNumber(){return g(this,null,function*(){let r=Cr(F.firestore(),"tickets"),i=zn(r,xa("status","==","open")),s=yield Ra(i);document.getElementById("open-tickets-sidebar-display").innerText=s.data().count+"",s.data().count!=0?document.getElementById("open-tickets-counter-container").style.display="flex":document.getElementById("open-tickets-counter-container").style.display="none"})}};e.\u0275fac=function(i){return new(i||e)(ce(nt))},e.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var WB=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}login(){var r=document.getElementById("email-login-input").value,i=document.getElementById("password-login-input").value;F.auth().signInWithEmailAndPassword(r,i).then(s=>{var o=s.user;this.generalService.presentToast("Login effettuato con successo"),document.getElementById("header").style.display="flex",this.router.navigate(["/company"])}).catch(s=>{s.code=="auth/invalid-credential"&&this.generalService.presentToast("Email o password non validi")})}};e.\u0275fac=function(i){return new(i||e)(ne(ze),ne(nt))},e.\u0275cmp=xe({type:e,selectors:[["app-login"]],decls:17,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate",2,"color","#333"],["id","email-login-input","type","text","placeholder","Email",1,"input"],["id","password-login-input","type","text","placeholder","Password",1,"input"],[1,"button",3,"click"],["routerLink","/change-password",1,"a1"]],template:function(i,s){i&1&&(v(0,"div",0),W(1,"div",1),v(2,"div",2),W(3,"img",3),v(4,"div",4)(5,"span",5),b(6,"mail"),w(),W(7,"input",6),w(),v(8,"div",4)(9,"span",5),b(10,"key"),w(),W(11,"input",7),w(),v(12,"button",8),B("click",function(){return s.login()}),b(13,"Accedi"),w(),v(14,"a",9),b(15,"Password dimenticata?"),w()(),W(16,"div",1),w())},dependencies:[Oc]});let n=e;return n})();var kZ=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(ne(bs),ne($i))},e.\u0275dir=Qn({type:e});let n=e;return n})(),QB=(()=>{let e=class e extends kZ{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Fo(e)))(s||e)}})(),e.\u0275dir=Qn({type:e,features:[Ju]});let n=e;return n})(),YB=new pe("");var PZ={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Nue=lt(z({},PZ),{"[class.ng-submitted]":"isSubmitted"});var MZ=new pe("CallSetDisabledState",{providedIn:"root",factory:()=>JB}),JB="always";var OZ={provide:YB,useExisting:Ku(()=>ZB),multi:!0};function XB(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function FZ(n){return n.split(":")[0]}var ZB=(()=>{let e=class e extends QB{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=XB(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=FZ(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Fo(e)))(s||e)}})(),e.\u0275dir=Qn({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&B("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[bE([OZ]),Ju]});let n=e;return n})(),du=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(XB(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(ne($i),ne(bs),ne(ZB,9))},e.\u0275dir=Qn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let n=e;return n})(),LZ={provide:YB,useExisting:Ku(()=>ej),multi:!0};function KB(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function VZ(n){return n.split(":")[0]}var ej=(()=>{let e=class e extends QB{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let l=a[c],d=this._getOptionValue(l.value);s.push(d)}}else{let a=i.options;for(let c=0;c<a.length;c++){let l=a[c];if(l.selected){let d=this._getOptionValue(l.value);s.push(d)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=VZ(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Fo(e)))(s||e)}})(),e.\u0275dir=Qn({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&B("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[bE([LZ]),Ju]});let n=e;return n})(),hu=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(KB(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(KB(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(ne($i),ne(bs),ne(ej,9))},e.\u0275dir=Qn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let n=e;return n})();var UZ=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({});let n=e;return n})();var tj=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:MZ,useValue:r.callSetDisabledState??JB}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({imports:[UZ]});let n=e;return n})();var nj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}register(){var r=document.getElementById("email-register-input").value,i=document.getElementById("password-register-input").value,s=document.getElementById("confirm-password-register-input").value,o=document.getElementById("name-register-input").value,a=document.getElementById("surname-register-input").value,c=document.getElementById("agency-name-register-input").value;i==s?F.auth().createUserWithEmailAndPassword(r,i).then(l=>{let d=l.user;var h=F.firestore();h.collection("users_data").doc(d.uid).set({uid:d.uid,name:o,surname:a,agencyName:c,email:r,registration_date:F.firestore.FieldValue.serverTimestamp()}).catch(p=>{this.generalService.presentToast("Errore nel salvataggio dei dati dell'utente durante la registrazione: "+p.message)}),this.generalService.presentToast("Registrazione completata con successo"),document.getElementById("header").style.display="flex",this.router.navigate(["/company"])}).catch(l=>{l.code=="auth/invalid-email"&&this.generalService.presentToast("Email non valida"),l.code=="auth/weak-password"&&this.generalService.presentToast("Password troppo debole")}):this.generalService.presentToast("Le password inserite non corrispondono")}};e.\u0275fac=function(i){return new(i||e)(ne(ze),ne(nt))},e.\u0275cmp=xe({type:e,selectors:[["app-register"]],decls:45,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate"],["id","name-register-input","type","text","placeholder","Nome",1,"input"],["id","surname-register-input","type","text","placeholder","Cognome",1,"input"],["id","agency-name-register-input",2,"width","100%","height","100%","background","transparent","border","1px solid transparent"],["value","TORINO"],["value","ALBA"],["value","GRINZANE CAVOUR"],["value","ASTI"],["value","BRA"],["value","VADO LIGURE"],["value","CAIRO MONTENOTTE"],["id","email-register-input","type","email","placeholder","Email",1,"input"],["id","password-register-input","type","email","placeholder","Password",1,"input"],["id","confirm-password-register-input","type","email","placeholder","Conferma password",1,"input"],[1,"button",2,"width","100%","height","2.5rem",3,"click"]],template:function(i,s){i&1&&(v(0,"div",0),W(1,"div",1),v(2,"div",2),W(3,"img",3),v(4,"div",4)(5,"span",5),b(6,"person"),w(),W(7,"input",6),w(),v(8,"div",4)(9,"span",5),b(10,"person"),w(),W(11,"input",7),w(),v(12,"div",4)(13,"span",5),b(14,"store"),w(),v(15,"select",8)(16,"option",9),b(17,"TORINO"),w(),v(18,"option",10),b(19,"ALBA"),w(),v(20,"option",11),b(21,"GRINZANE CAVOUR"),w(),v(22,"option",12),b(23,"ASTI"),w(),v(24,"option",13),b(25,"BRA"),w(),v(26,"option",14),b(27,"VADO LIGURE"),w(),v(28,"option",15),b(29,"CAIRO MONTENOTTE"),w()()(),v(30,"div",4)(31,"span",5),b(32,"mail"),w(),W(33,"input",16),w(),v(34,"div",4)(35,"span",5),b(36,"lock"),w(),W(37,"input",17),w(),v(38,"div",4)(39,"span",5),b(40,"lock"),w(),W(41,"input",18),w(),v(42,"button",19),B("click",function(){return s.register()}),b(43,"Register"),w()(),W(44,"div",1),w())},dependencies:[du,hu]});let n=e;return n})();function BZ(n,e){n&1&&(v(0,"div",2)(1,"p"),b(2,"Seleziona una chat"),w()())}function jZ(n,e){if(n&1){let t=Ke();v(0,"span",16),B("click",function(){Ue(t);let i=ue(2);return Be(i.changeChat(i.chatName))}),b(1,"edit"),w()}}function $Z(n,e){if(n&1){let t=Ke();v(0,"span",16),B("click",function(){Ue(t);let i=ue(2);return Be(i.deleteChat())}),b(1,"delete"),w()}}function HZ(n,e){if(n&1){let t=Ke();v(0,"button",17),B("click",function(){Ue(t);let i=ue(2);return Be(i.getMoreChatMessages())}),b(1,"Carica altri messaggi"),w()}}function qZ(n,e){if(n&1){let t=Ke();v(0,"span",23),B("click",function(){Ue(t);let i=ue().$implicit,s=ue(2);return Be(s.deleteMessage(i))}),b(1,"delete"),w()}}function zZ(n,e){if(n&1&&(v(0,"div",18)(1,"span",19)(2,"strong"),b(3),w(),v(4,"span"),b(5),w(),W(6,"div",20),ye(7,qZ,2,0,"span",21),w(),v(8,"p",22),b(9),w()()),n&2){let t=e.$implicit,r=ue(2);un("id","chat-message-id-",t.id,""),j(3),wE("",t.creator_name," ",t.creator_surname," ",r.formatTimestamp(t.createdAt),""),j(2),ft(t.creator_agency_name),j(2),Z("ngIf",r.generalService.isAdmin==!0),j(2),ft(t.message)}}function GZ(n,e){if(n&1){let t=Ke();v(0,"div",3)(1,"div",4)(2,"h2",5),b(3),w(),ye(4,jZ,2,0,"span",6)(5,$Z,2,0,"span",6),w(),v(6,"p",7),b(7),w(),v(8,"div",8),ye(9,HZ,2,0,"button",9),v(10,"div",10),ye(11,zZ,10,8,"div",11),Un(12,"async"),w()(),v(13,"div",12)(14,"input",13),B("keydown.enter",function(){Ue(t);let i=ue();return Be(i.sendMessage())}),w(),v(15,"button",14),B("click",function(){Ue(t);let i=ue();return Be(i.sendMessage())}),v(16,"span",15),b(17,"send"),w()()()()}if(n&2){let t=ue();j(3),ft(t.chatName),j(),Z("ngIf",t.generalService.isAdmin==!0),j(),Z("ngIf",t.generalService.isAdmin==!0),j(2),ft(t.chatDescription),j(2),Z("ngIf",t.nextPageAvailable),j(2),Z("ngForOf",Bn(12,6,t.documents))}}var rj=(()=>{let e=class e{constructor(r,i,s){this.generalService=r,this.route=i,this.router=s,this.chatName="",this.chatDescription="",this.showChatPlaceholder=!0,this.documents=new De([]),this.nextPageAvailable=!1}ngOnInit(){this.route.queryParams.subscribe(r=>{this.currentChatId=r.id,this.generalService.currentChatId=r.id,this.chatName=r.name,this.chatDescription=r.description,this.currentChatId?(this.showChatPlaceholder=!1,this.getChatMessages(),setTimeout(()=>{document.getElementById(this.currentChatId+"-to-read-messages-count").style.display="none"},1e3),this.chatName=r.name):this.showChatPlaceholder=!0})}sendMessage(){var r={creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,creator_email:this.generalService.currentUser.email,chat_id:this.currentChatId,createdAt:F.firestore.FieldValue.serverTimestamp(),message:document.getElementById("chat-message-input").value};F.firestore().collection("chat_messages").doc().set(r).then(()=>{document.getElementById("chat-message-input").value=""}).catch(i=>{this.generalService.presentToast("Errore durante l'invio del messaggio:"+i.message)})}deleteChat(){confirm("Sei sicuro di voler cancellare questa chat?")&&F.firestore().collection("chats").doc(this.currentChatId).delete().then(()=>{this.showChatPlaceholder=!0,this.generalService.presentToast("Chat eliminata con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'eliminazione della chat: "+r.message)})}changeChat(r){document.getElementById("change-chat-popup").style.display="flex",document.getElementById("change-chat-name-input").value=r,document.getElementById("change-chat-description-input").value=this.chatDescription}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}getChatMessages(){return F.firestore().collection("chat_messages").orderBy("createdAt","desc").where("chat_id","==",this.currentChatId).limit(40).onSnapshot(r=>{let i=[];if(r.forEach(o=>{i.push(z({id:o.id},o.data()))}),r){var s=i.length>0?i[0]:null;s!=null&&localStorage.setItem(this.currentChatId+"-last-message-seconds-timestamp-check",s.createdAt.seconds)}i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i tuoi ticket: "+r.message)})}getMoreChatMessages(){!this.lastVisible||!this.nextPageAvailable||F.firestore().collection("chat_messages").orderBy("createdAt","desc").where("chat_id","==",this.currentChatId).startAfter(this.lastVisible).limit(40).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(z({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}deleteMessage(r){confirm("Sei sicuro di voler eliminare questo messaggio?")&&(document.getElementById("chat-message-id-"+r.id).innerHTML="Messaggio eliminato",F.firestore().collection("chat_messages").doc(r.id).delete().then(()=>{this.generalService.presentToast("Messaggio eliminato con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione del messaggio: "+i.message)}))}};e.\u0275fac=function(i){return new(i||e)(ne(ze),ne(Vr),ne(nt))},e.\u0275cmp=xe({type:e,selectors:[["app-chat"]],decls:2,vars:2,consts:[["style","height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; padding-left: 1rem; overflow-x: hidden; overflow-y: hidden;",4,"ngIf"],["style","height: 100%; display: flex; flex-direction: column; padding-left: 1rem; overflow-x: hidden; overflow-y: hidden;",4,"ngIf"],[2,"height","100%","display","flex","flex-direction","column","align-items","center","justify-content","center","padding-left","1rem","overflow-x","hidden","overflow-y","hidden"],[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-top","1.5rem"],["id","open-chat-name-display",2,"margin-bottom","0rem","margin-top","0rem"],["style","color: #333; cursor: pointer;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","column","gap","1rem","overflow-y","auto","height","calc(100% - 4rem)","padding-top","1rem"],["class","button",3,"click",4,"ngIf"],["id","chat-container",2,"display","flex","flex-direction","column","gap","1rem"],["class","chat-card","style","padding-top: 0.5rem;",3,"id",4,"ngFor","ngForOf"],[2,"height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem","margin-top","1rem","margin-right","1rem"],["id","chat-message-input","placeholder","Inserisci qui il tuo messaggio",2,"width","calc(100% - 3.5rem)","border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'",3,"keydown.enter"],[2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer",3,"click"],[1,"button",3,"click"],[1,"chat-card",2,"padding-top","0.5rem",3,"id"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.2rem"],[2,"flex","1"],["style","font-size: 1.5rem; color: #333; cursor: pointer;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0.2rem","margin-bottom","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer",3,"click"]],template:function(i,s){i&1&&ye(0,BZ,3,0,"div",0)(1,GZ,18,8,"div",1),i&2&&(Z("ngIf",s.showChatPlaceholder==!0),j(),Z("ngIf",s.showChatPlaceholder==!1))},dependencies:[fr,pr,mr]});let n=e;return n})();var ij=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.generalService.initNormalScreen()}};e.\u0275fac=function(i){return new(i||e)(ne(ze))},e.\u0275cmp=xe({type:e,selectors:[["app-company"]],decls:24,vars:0,consts:[[2,"height","100%","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[1,"card",2,"padding","1rem","margin-top","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"width","3rem"],[2,"max-width","80%"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","flex-wrap","wrap","gap","1rem"],["href","https://www.agenziaautoteam.it/i-nostri-servizi/","target","_blank",1,"a_button",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"width","2rem"],[2,"margin-top","0rem","margin-bottom","0rem","color","black"],["href","assets\\pdf\\Web app autoteam nuova presentazione.pdf","target","_blank",1,"a_button",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1)(2,"div",2),W(3,"img",3),v(4,"h3"),b(5,"L'azienda | Mission"),w()(),v(6,"p",4)(7,"strong"),b(8,"CI SONO MOLTE AGENZIE DI PRATICHE AUTO, INFINITE POSSIBILIT\xC0 PER AUTOMOBILISTI E ADDETTI AI LAVORI. CHE COSA RENDE AUTOTEAM DIVERSA E UNICA?"),w()(),v(9,"p"),b(10,"NON CI SONO RICETTE SEGRETE: TUTTO PARTE DALLA PRECISA VOLONT\xC0 DI COSTRUIRE SOLIDE RELAZIONI CON I CLIENTI. DIALOGO, ASSISTENZA, PRESENZA: IN OGNI FASE DEL LAVORO, IN OGNI OCCASIONE, PER QUALSIASI NECESSIT\xC0, AUTOTEAM C'\xC8. UN'AMPIA GAMMA DI SERVIZI E UNA COSTANTE FORMAZIONE DEI COLLABORATORI GARANTISCE TEMPESTIVIT\xC0 E QUALIT\xC0 DEI SERVIZI, METTENDO A DISPOSIZIONE DELLA CLIENTELA PERSONALE ALTAMENTE QUALIFICATO E, DAL PUNTO DI VISTA UMANO, PERSONE DISPOSTE AD ASCOLTARE E A TROVARE LA SOLUZIONE MIGLIORE PER OGNI TIPO DI ESIGENZA."),w(),v(11,"p"),b(12,"UN TEAM FUNZIONA SE ALLA BASE CI SONO VALORI SOLIDI ECONDIVISI. AGENZIA AUTOTEAM CREDE PROFONDAMENTE NEL PROPRIO GRUPPO: STIMA, FIDUCIA, RISPETTO PER I COLLABORATORI SONO LE FONDAMENTA SULLE QUALI SI BASA LA NOSTRA IDEA DI GRUPPO."),w(),v(13,"p"),b(14,"OGNUNO \xC8 IMPORTANTE, IL CONTRIBUTO DI TUTTI CONTRIBUISCE ALLA CRESCITA E AL SUCCESSO."),w(),v(15,"div",5)(16,"a",6),W(17,"img",7),v(18,"p",8),b(19,"Sito Web | Servizi"),w()(),v(20,"a",9),W(21,"img",7),v(22,"p",8),b(23,"Presentazione Web App"),w()()()()())}});let n=e;return n})();function WZ(n,e){if(n&1){let t=Ke();v(0,"span",13),B("click",function(){Ue(t);let i=ue();return Be(i.changeSector())}),b(1,"edit"),w()}}function KZ(n,e){if(n&1){let t=Ke();v(0,"span",13),B("click",function(){Ue(t);let i=ue();return Be(i.deleteSector())}),b(1,"delete"),w()}}function QZ(n,e){if(n&1){let t=Ke();v(0,"span",28),B("click",function(){Ue(t);let i=ue().$implicit,s=ue(2);return Be(s.deleteSectorFolder(i))}),b(1,"delete"),w()}}function YZ(n,e){if(n&1){let t=Ke();v(0,"div",24),B("click",function(){let i=Ue(t).$implicit,s=ue(2);return Be(s.openSectorFolder(i))}),v(1,"span",25),b(2,"folder"),w(),v(3,"span",26),b(4),w(),ye(5,QZ,2,0,"span",27),w()}if(n&2){let t=e.$implicit,r=ue(2);j(3),Cs("id",t),j(),ft(t),j(),Z("ngIf",r.generalService.isAdmin==!0)}}function JZ(n,e){if(n&1&&(v(0,"div",21)(1,"h4",22),b(2,"Cartelle:"),w(),ye(3,YZ,6,3,"div",23),w()),n&2){let t=e.ngIf;j(3),Z("ngForOf",t)}}function XZ(n,e){n&1&&(v(0,"div",29)(1,"p",30),b(2,"Questa cartella \xE8 vuota"),w()())}function ZZ(n,e){n&1&&(v(0,"div",29)(1,"p",30),b(2,"Questo settore \xE8 vuoto (seleziona una cartella)"),w()())}function eee(n,e){if(n&1){let t=Ke();v(0,"span",40),B("click",function(){Ue(t);let i=ue().$implicit,s=ue();return Be(s.deleteProcedura(i))}),b(1,"delete"),w()}}function tee(n,e){n&1&&(v(0,"span",45),b(1,"link"),w())}function nee(n,e){n&1&&(v(0,"span",45),b(1,"picture_as_pdf"),w())}function ree(n,e){n&1&&(v(0,"span",45),b(1,"movie"),w())}function iee(n,e){n&1&&(v(0,"span",45),b(1,"movie"),w())}function see(n,e){n&1&&(v(0,"span",45),b(1,"movie"),w())}function oee(n,e){n&1&&(v(0,"span",45),b(1,"volume_up"),w())}function aee(n,e){if(n&1&&(v(0,"a",41)(1,"div",42),W(2,"img",43),ye(3,tee,2,0,"span",44)(4,nee,2,0,"span",44)(5,ree,2,0,"span",44)(6,iee,2,0,"span",44)(7,see,2,0,"span",44)(8,oee,2,0,"span",44),b(9),w()()),n&2){let t=e.$implicit,r=ue().$implicit;Z("href",r.links[t].link,Hi),j(3),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes(".com")),j(),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("pdf")),j(),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp4")),j(),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mkv")),j(),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("wmv")),j(),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp3")),j(),qi(" ",r.links[t].label," ")}}function cee(n,e){n&1&&(v(0,"span",45),b(1,"picture_as_pdf"),w())}function lee(n,e){n&1&&(v(0,"span",45),b(1,"movie"),w())}function uee(n,e){n&1&&(v(0,"span",45),b(1,"movie"),w())}function dee(n,e){n&1&&(v(0,"span",45),b(1,"movie"),w())}function hee(n,e){n&1&&(v(0,"span",45),b(1,"volume_up"),w())}function fee(n,e){if(n&1&&(v(0,"a",41)(1,"div",42)(2,"span",45),b(3,"draft"),w(),b(4," Download "),ye(5,cee,2,0,"span",44)(6,lee,2,0,"span",44)(7,uee,2,0,"span",44)(8,dee,2,0,"span",44)(9,hee,2,0,"span",44),w()()),n&2){let t=ue().$implicit;Cs("href",t.storage_resource_link,Hi),j(5),Z("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("pdf")),j(),Z("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp4")),j(),Z("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mkv")),j(),Z("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("wmv")),j(),Z("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp3"))}}function pee(n,e){if(n&1&&(v(0,"div",31)(1,"h3",32),b(2),W(3,"div",33),ye(4,eee,2,0,"span",34),w(),v(5,"h4",35),b(6),w(),v(7,"p",36),b(8),w(),v(9,"div",37),ye(10,aee,10,8,"a",38)(11,fee,10,6,"a",39),w()()),n&2){let t=e.$implicit,r=ue();un("id","procedure-id-",t.id,""),j(2),IE(" ",t.creator_name," ",t.creator_surname," | ",t.creator_agency_name," | ",r.formatTimestamp(t.timestamp)," /",t.folder_name," "),j(2),Z("ngIf",r.generalService.isAdmin==!0||r.generalService.currentUser.uid==t.creator_uid),j(2),ft(t.name),j(2),ft(t.description),j(2),Z("ngForOf",r.getObjectKeys(t.links)),j(),Z("ngIf",t.storage_resource_link!="")}}function mee(n,e){if(n&1){let t=Ke();v(0,"button",7),B("click",function(){Ue(t);let i=ue();return Be(i.getMoreSectorProcedures())}),b(1,"Recupera altre procedure"),w()}}var sj=(()=>{let e=class e{constructor(r,i,s){this.generalService=r,this.router=i,this.route=s,this.documents=new De([]),this.lastVisible="",this.nextPageAvailable=!0,this.matchingKeys$=new De([]),this.isFolderEmpty=!1,this.isSectorEmpty=!1}ngOnInit(){this.route.queryParams.subscribe(r=>{var i=r.sector_id,s=r.sector_name,o=r.sector_description;i==null&&this.router.navigate(["/chat"]),document.getElementById("folder-name-indicator").innerText="",document.getElementById("sector-name").style.background="yellow",this.generalService.currentSectorId=i,document.getElementById("sector-name").innerText=s,document.getElementById("sector-description").innerText=o,this.getSectorProcedures(),this.getSectorFolders()})}getSectorProcedures(){return F.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).orderBy("timestamp","desc").where("folder_name","==","").limit(4).startAfter(this.lastVisible).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(z({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,i.length==0&&(this.isFolderEmpty=!1,this.isSectorEmpty=!0),this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+r.message)})}getMoreSectorProcedures(){!this.lastVisible||!this.nextPageAvailable||F.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).orderBy("timestamp","desc").where("folder_name","==","").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(z({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}getSectorFolders(){this.matchingKeys$=new De([]),F.firestore().collection("sector_folders").doc("folders").get().then(r=>{if(r.exists){let i=r.data();if(this.matchingKeysUnfiltered=i,i){let s=[];for(let[o,a]of Object.entries(i))if(a===this.generalService.currentSectorId){let c=o.lastIndexOf("-"),l=c===-1?o:o.substring(0,c);s.push(l)}s.sort((o,a)=>o.localeCompare(a)),this.matchingKeys$.next(s),this.generalService.foldersNames}}else console.log("Documento non trovato!")}).catch(r=>{this.generalService.presentToast("Errore nel recuperare le cartelle di questo settore: "+r.message)})}closeAddNewProcedureFolderPopup(){document.getElementById("add-new-procedure-folder-popup").style.display="none"}addNewProcedureFolder(){let r=document.getElementById("add-procedure-folder-name-input");r.value!=""&&r.value!=" "?F.firestore().collection("sector_folders").doc("folders").set({[r.value+"-"+Date.now()]:this.generalService.currentSectorId},{merge:!0}).then(()=>{document.getElementById("add-new-procedure-folder-popup").style.display="none",this.getSectorFolders(),this.generalService.presentToast("Cartella aggiunta con successo")}).catch(i=>{this.generalService.presentToast("Errore durante la creazione della cartella: "+i.message)}):this.generalService.presentToast("Inserire un nome per la cartella")}showAddProcedurePopup(){this.getSectorFolders(),this.generalService.linkObject={},this.generalService.linkCounter=0,this.fillFolderNameSelection(),document.getElementById("add-new-procedure-popup").style.display="flex"}fillFolderNameSelection(){let r=document.getElementById("add-procedure-folder-input");r.innerHTML='<option value="">SELEZIONA</option>',this.matchingKeys$.subscribe(i=>{i.forEach(s=>{let o=s.lastIndexOf("-"),a=o===-1?s:s.substring(0,o),c=document.createElement("option");c.value=a,c.textContent=a,r.appendChild(c)})})}showAddProcedureFolder(){document.getElementById("add-new-procedure-folder-popup").style.display="flex"}getObjectKeys(r){return r?Object.keys(r):[]}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}openSectorFolder(r){document.getElementById("folder-name-indicator").innerText="/"+r,document.querySelectorAll(".folder-class1").forEach(i=>{i.style.backgroundColor="transparent"}),document.getElementById(r).style.background="yellow",this.documents=new De([]),F.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).where("folder_name","==",r).orderBy("timestamp","desc").startAfter(this.lastVisible).get().then(i=>{let s=[];if(i.forEach(o=>{s.push(z({id:o.id},o.data()))}),s.length==0)this.isSectorEmpty=!1,this.isFolderEmpty=!0;else{this.isSectorEmpty=!1,this.isFolderEmpty=!1;let a=[...this.documents.getValue(),...s];this.documents.next(a)}}).catch(i=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+i.message)})}showGeneralHiglight(){document.getElementById("folder-name-indicator").innerText="",document.querySelectorAll(".folder-class1").forEach(r=>{r.style.backgroundColor="transparent"}),document.getElementById("sector-name").style.background="yellow"}deleteProcedura(r){confirm("Sei sicuro di voler cancellare questa procedura e tutti i suoi allegati?")&&(document.getElementById("procedure-id-"+r.id).innerHTML="Procedura eliminata",F.firestore().collection("procedure").doc(r.id).delete().then(()=>{if(r.storage_resource_path!=""){let i=ss(F.storage(),r.storage_resource_path);Gl(i).then(()=>{this.generalService.presentToast("La procedura e i relativi allegati sono stati eliminati con successo")}).catch(s=>{this.generalService.presentToast("Errore durante l'eliminazione della procedura: 'DELETE FILE ERROR' "+s.message)}).catch(s=>{this.generalService.presentToast("Errore durante l'eliminazione della procedura: 'DELETE DOC ERROR' "+s.message)})}else this.generalService.presentToast("La procedura e i relativi allegati sono stati eliminati con successo")}))}deleteSector(){confirm("Sei sicuro di voler cancellare questo settore?")&&F.firestore().collection("settori").doc(this.generalService.currentSectorId).delete().then(()=>{this.generalService.presentToast("Settore cancellato con successo")}).catch(r=>{this.generalService.presentToast("Errore durante la cancellazione del settore: "+r.message)})}changeSector(){this.route.queryParams.subscribe(r=>{var i=r.sector_id,s=r.sector_name,o=r.sector_description;i==null&&this.router.navigate(["/chat"]),document.getElementById("change-sector-popup").style.display="flex",document.getElementById("change-sector-popup-name-input").value=s,document.getElementById("change-sector-popup-description-input").value=o})}deleteSectorFolder(r){if(confirm("Sei sicuro di voler cancellare questa cartella?")){let s=Object.keys(this.matchingKeysUnfiltered).find(o=>o.includes(r));if(!s){this.generalService.presentToast("Nessuna cartella corrispondente trovata");return}console.log(`Chiave da eliminare: ${s}`),F.firestore().collection("sector_folders").doc("folders").update({[s]:F.firestore.FieldValue.delete()}).then(()=>{this.getSectorFolders(),this.generalService.presentToast("Cartella eliminata con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'eliminazione della cartella: "+o.message)})}}};e.\u0275fac=function(i){return new(i||e)(ne(ze),ne(nt),ne(Vr))},e.\u0275cmp=xe({type:e,selectors:[["app-settori"]],decls:37,vars:11,consts:[["id","add-new-procedure-folder-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","30rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","space-between"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","black","cursor","pointer",3,"click"],[2,"width","100%","display","flex","flex-direction","row","flex-wrap","wrap","gap","1rem"],[2,"flex","1","min-width","15rem","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-procedure-folder-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],[1,"button",3,"click"],[2,"height","100%","overflow-y","auto","overflow-x","hidden","display","flex","flex-direction","column","padding-left","1rem","padding-right","1rem","margin-bottom","0rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.5rem","cursor","pointer","flex-wrap","wrap",3,"click"],["id","sector-name",1,"folder-class1"],["id","folder-name-indicator",2,"font-size","1rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem","flex-wrap","wrap","margin-top","0.2rem","margin-bottom","0.2rem"],[1,"material-symbols-outlined","notranslate",2,"color","black","cursor","pointer","font-size","1.8rem",3,"click"],["style","color: black; cursor: pointer; font-size: 1.8rem;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],["id","sector-description",2,"margin-top","0rem"],["style","margin-bottom: 1rem;",4,"ngIf"],["style","width: 100%; display: flex; align-items: center; justify-content: center;",4,"ngIf"],["id","procedure",2,"display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["class","card","style","padding-left: 1rem; padding-right: 1rem; padding-bottom: 1rem;",3,"id",4,"ngFor","ngForOf"],["class","button",3,"click",4,"ngIf"],[2,"margin-bottom","1rem"],[2,"margin-bottom","0.5rem","margin-top","0rem"],["style","display: flex; flex-direction: row; align-items: center; gap: 0.5rem; cursor: pointer; border-radius: 0.5rem; max-width: 50rem;",3,"click",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","cursor","pointer","border-radius","0.5rem","max-width","50rem",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem"],[1,"folder-class1",3,"id"],["style","color: #333; font-size: 1.5rem;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem",3,"click"],[2,"width","100%","display","flex","align-items","center","justify-content","center"],[2,"width","100%","text-align","center"],[1,"card",2,"padding-left","1rem","padding-right","1rem","padding-bottom","1rem",3,"id"],[2,"margin-bottom","0.5rem","display","flex","flex-direction","row","align-items","center"],[2,"flex","1"],["style","font-size: 1.5rem; color: #333; cursor: pointer;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0rem","margin-bottom","0rem"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngFor","ngForOf"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer",3,"click"],["target","_blank",2,"text-decoration","none",3,"href"],[1,"card",2,"height","2.5rem","display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem","padding-left","0.5rem","padding-right","0.5rem","border-radius","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"height","2rem","width","2rem"],["style","color: #313131; font-size: 1.8rem;","class","material-symbols-outlined notranslate",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"color","#313131","font-size","1.8rem"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1)(2,"h3",2),b(3,"Nuova cartella"),v(4,"span",3),B("click",function(){return s.closeAddNewProcedureFolderPopup()}),b(5,"close"),w()(),v(6,"div",4)(7,"div",5),W(8,"input",6),w()(),v(9,"div",2)(10,"button",7),B("click",function(){return s.closeAddNewProcedureFolderPopup()}),b(11,"Annulla"),w(),v(12,"button",7),B("click",function(){return s.addNewProcedureFolder()}),b(13,"Conferma"),w()()()(),v(14,"div",8)(15,"h2",9),B("click",function(){return s.getSectorProcedures(),s.showGeneralHiglight()}),W(16,"span",10)(17,"span",11),w(),v(18,"h3",12)(19,"span",13),B("click",function(){return s.showAddProcedurePopup()}),b(20,"add_notes"),w(),b(21," | "),v(22,"span",13),B("click",function(){return s.showAddProcedureFolder()}),b(23,"create_new_folder"),w(),b(24," | "),ye(25,WZ,2,0,"span",14),b(26," | "),ye(27,KZ,2,0,"span",14),w(),W(28,"p",15),ye(29,JZ,4,1,"div",16),Un(30,"async"),ye(31,XZ,3,0,"div",17)(32,ZZ,3,0,"div",17),v(33,"div",18),ye(34,pee,12,12,"div",19),Un(35,"async"),ye(36,mee,2,0,"button",20),w()()),i&2&&(j(25),Z("ngIf",s.generalService.isAdmin==!0),j(2),Z("ngIf",s.generalService.isAdmin==!0),j(2),Z("ngIf",Bn(30,7,s.matchingKeys$)),j(2),Z("ngIf",s.isFolderEmpty==!0),j(),Z("ngIf",s.isSectorEmpty==!0),j(2),Z("ngForOf",Bn(35,9,s.documents)),j(2),Z("ngIf",s.nextPageAvailable))},dependencies:[fr,pr,mr]});let n=e;return n})();var oj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.generalService.initNormalScreen()}};e.\u0275fac=function(i){return new(i||e)(ne(ze))},e.\u0275cmp=xe({type:e,selectors:[["app-home"]],decls:1,vars:0,consts:[[2,"height","100%","padding-left","1rem","display","flex","flex-direction","row","flex-wrap","wrap"]],template:function(i,s){i&1&&W(0,"div",0)}});let n=e;return n})();function gee(n,e){if(n&1){let t=Ke();v(0,"span",35),B("click",function(){Ue(t);let i=ue().$implicit,s=ue();return Be(s.openTicketMenuPopup(i))}),b(1,"more_vert"),w()}}function _ee(n,e){n&1&&(v(0,"span"),b(1,"Aperto"),w())}function yee(n,e){n&1&&(v(0,"span"),b(1,"Chiuso"),w())}function vee(n,e){n&1&&(v(0,"span",40),b(1,"link"),w())}function wee(n,e){n&1&&(v(0,"span",40),b(1,"picture_as_pdf"),w())}function Eee(n,e){n&1&&(v(0,"span",40),b(1,"movie"),w())}function Iee(n,e){n&1&&(v(0,"span",40),b(1,"movie"),w())}function bee(n,e){n&1&&(v(0,"span",40),b(1,"movie"),w())}function Cee(n,e){n&1&&(v(0,"span",40),b(1,"volume_up"),w())}function Tee(n,e){if(n&1&&(v(0,"a",36)(1,"div",37),W(2,"img",38),ye(3,vee,2,0,"span",39)(4,wee,2,0,"span",39)(5,Eee,2,0,"span",39)(6,Iee,2,0,"span",39)(7,bee,2,0,"span",39)(8,Cee,2,0,"span",39),b(9),w()()),n&2){let t=e.$implicit,r=ue().$implicit;Z("href",r.links[t].link,Hi),j(3),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes(".com")),j(),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("pdf")),j(),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp4")),j(),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mkv")),j(),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("wmv")),j(),Z("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp3")),j(),qi(" ",r.links[t].label," ")}}function See(n,e){n&1&&(v(0,"span",40),b(1,"picture_as_pdf"),w())}function Dee(n,e){n&1&&(v(0,"span",40),b(1,"movie"),w())}function Aee(n,e){n&1&&(v(0,"span",40),b(1,"movie"),w())}function xee(n,e){n&1&&(v(0,"span",40),b(1,"movie"),w())}function Ree(n,e){n&1&&(v(0,"span",40),b(1,"volume_up"),w())}function Nee(n,e){if(n&1&&(v(0,"a",36)(1,"div",37)(2,"span",40),b(3,"draft"),w(),b(4," Download "),ye(5,See,2,0,"span",39)(6,Dee,2,0,"span",39)(7,Aee,2,0,"span",39)(8,xee,2,0,"span",39)(9,Ree,2,0,"span",39),w()()),n&2){let t=ue().$implicit;Cs("href",t.storage_resource_link,Hi),j(5),Z("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("pdf")),j(),Z("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp4")),j(),Z("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mkv")),j(),Z("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("wmv")),j(),Z("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp3"))}}function kee(n,e){if(n&1){let t=Ke();v(0,"div",15)(1,"div",16)(2,"span",17),b(3,"account_circle"),w(),v(4,"p"),b(5),w(),W(6,"div",14),ye(7,gee,2,0,"span",18),w(),v(8,"h3",19),b(9),ye(10,_ee,2,0,"span",20)(11,yee,2,0,"span",20),w(),v(12,"p",21),b(13),w(),v(14,"div",22),ye(15,Tee,10,8,"a",23)(16,Nee,10,6,"a",24),w(),v(17,"div",25)(18,"div",26)(19,"div",27)(20,"span",28),b(21,"forum"),w(),v(22,"input",29),B("keydown.enter",function(){let i=Ue(t).$implicit,s=ue();return Be(s.addComment(i))}),w()(),v(23,"button",30),B("click",function(){let i=Ue(t).$implicit,s=ue();return Be(s.addComment(i))}),v(24,"span",31),b(25,"send"),w()()(),v(26,"p",32),B("click",function(){let i=Ue(t).$implicit,s=ue();return Be(s.getComments(i))}),v(27,"span",33),b(28,"keyboard_arrow_down"),w(),b(29," Vedi risposte "),w(),W(30,"div",34),w()()}if(n&2){let t=e.$implicit,r=ue();un("id","ticket-id-",t.id,""),j(5),EE("",t.name," ",t.surname," | ",r.convertTimestampToDate(t.timestamp.seconds)," | ",t.agencyName,""),j(2),Z("ngIf",r.generalService.isAdmin==!0||r.generalService.currentUser.uid==t.creator_id),j(2),qi("",t.argomento," | "),j(),Z("ngIf",t.status=="open"),j(),Z("ngIf",t.status=="close"),j(2),ft(t.descrizione),j(2),Z("ngForOf",r.getObjectKeys(t.links)),j(),Z("ngIf",t.storage_resource_link!=""),j(6),un("id","comment-input-",t.id,""),j(5),un("id","comment-section-arrow-icon-",t.id,""),j(3),un("id","comment-section-",t.id,"")}}function Pee(n,e){if(n&1){let t=Ke();v(0,"button",41),B("click",function(){Ue(t);let i=ue();return Be(i.getMoreTickets())}),b(1,"Recupera altri ticket"),w()}}var aj=(()=>{let e=class e{constructor(r){this.generalService=r,this.alredySavedMoreRecentOpenTicket=!1,this.documents=new De([]),this.nextPageAvailable=!1,this.comments=new De([])}ngOnInit(){this.generalService.initNormalScreen(),this.getOpenTickets(),this.setAllTicketsRead()}getObjectKeys(r){return r?Object.keys(r):[]}setAllTicketsRead(){return g(this,null,function*(){let r=Cr(F.firestore(),"tickets"),i=yield Ra(r);localStorage.setItem("last-ticket-count",i.data().count+""),this.generalService.ticketToRead=!1,localStorage.setItem("last-ticket-check-timestamp",Date.now()+""),document.getElementById("ticket-to-read-sidebar-container").style.display="none"})}openAddTicketPopup(){this.generalService.ticketLinkObject={},this.generalService.ticketLinkCounter=0,document.getElementById("add-ticket-popup").style.display="flex"}openTicketMenuPopup(r){this.generalService.currentTicket=r,document.getElementById("edit-menu-ticket-popup").style.display="flex",r.status=="open"&&(document.getElementById("open-ticket-button").style.display="none",document.getElementById("close-ticket-button").style.display="flex"),r.status=="close"&&(document.getElementById("open-ticket-button").style.display="flex",document.getElementById("close-ticket-button").style.display="none")}showCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="flex"}hideCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="none"}addComment(r){var i=F.auth().currentUser;let s=document.getElementById("comment-input-"+r.id),o=s.value;o.trim()&&(F.database().ref("/comments/"+r.id+"/").push({text:o,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,timestamp:Date.now(),creator_uid:i.uid}),s.value="",this.getComments(r))}getComments(r){let i=document.getElementById("comment-section-arrow-icon-"+r.id),s=document.getElementById("comment-section-"+r.id);s.innerHTML="",s.style.display=="none"?(i.innerText="keyboard_arrow_up",F.database().ref(`/comments/${r.id}/`).once("value").then(o=>{o.forEach(c=>{let l=c.key,d=c.val(),h=document.getElementById("comment-section-"+r.id),p=document.createElement("div");p.className="comment";let _=document.createElement("p");_.style.marginBottom="0.5rem",_.textContent=d.name+" "+d.surname+" | "+d.agencyName+" | "+this.convertTimestamp(d.timestamp);let E=document.createElement("p");E.style.marginBottom="0.5rem",E.textContent=d.text,p.appendChild(_),p.appendChild(E),h.appendChild(p)});let a=document.getElementById("comment-section-"+r.id);a&&(a.style.display="flex")}).catch(o=>{console.error("Errore durante il recupero dei commenti:",o)})):(s.style.display="none",i.innerText="keyboard_arrow_down")}higlightTicketIndicator(r){document.querySelectorAll(".ticket-navigator-button").forEach(i=>{i.style.backgroundColor="transparent"}),document.getElementById("ticket-navigator-button"+r).style.background="yellow"}convertTimestampToDate(r){let i=new Date(r*1e3),s=String(i.getDate()).padStart(2,"0"),o=String(i.getMonth()+1).padStart(2,"0"),a=i.getFullYear(),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0"),d=String(i.getSeconds()).padStart(2,"0");return`${s}-${o}-${a} ${c}:${l}:${d}`}convertTimestamp(r){let s=new Date(r).toISOString(),[o,a]=s.split("T"),[c,l,d]=o.split("-"),[h]=a.split(".");return`${d}/${l}/${c} ${h}`}getTickets(){return F.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(z({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{console.error("Error getting documents: ",r)})}getOpenTickets(){return this.higlightTicketIndicator(1),this.alredySavedMoreRecentOpenTicket=!1,F.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","open").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(z({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket aperti: "+r.message)})}getClosedTickets(){return F.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","close").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(z({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket chiusi: "+r.message)})}getMyTickets(){var r=F.auth().currentUser;return F.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("creator_id","==",r.uid).onSnapshot(i=>{let s=[];i.forEach(o=>{s.push(z({id:o.id},o.data()))}),s.length===4?(this.lastVisible=i.docs[i.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(s)},i=>{this.generalService.presentToast("Errore nel recuperare i tuoi ticket: "+i.message)})}getMoreTickets(){!this.lastVisible||!this.nextPageAvailable||F.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(z({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}};e.\u0275fac=function(i){return new(i||e)(ne(ze))},e.\u0275cmp=xe({type:e,selectors:[["app-tickets"]],decls:24,vars:4,consts:[[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","flex-wrap","wrap"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","black","font-size","1.8rem","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","border","1px solid rgba(0, 0, 0, 0.192)","border-radius","2rem","padding-left","1rem","padding-right","1rem","height","2.5rem","overflow-y","hidden","overflow-x","auto"],["id","ticket-navigator-button1",1,"ticket-navigator-button",2,"cursor","pointer",3,"click"],[2,"height","100%","width","1px","background","rgba(0, 0, 0, 0.192)"],["id","ticket-navigator-button2",1,"ticket-navigator-button",2,"cursor","pointer",3,"click"],["id","ticket-navigator-button3",1,"ticket-navigator-button",2,"cursor","pointer",3,"click"],["id","ticket-navigator-button4",1,"ticket-navigator-button",2,"cursor","pointer",3,"click"],[2,"overflow-y","auto","overflow-x","hidden","padding-bottom","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","card","style","padding-left: 1rem; padding-bottom: 1rem;",3,"id",4,"ngFor","ngForOf"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],[2,"flex","1"],[1,"card",2,"padding-left","1rem","padding-bottom","1rem",3,"id"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","padding-right","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem"],["style","color: #333; cursor: pointer; font-size: 1.8rem;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0rem","margin-bottom","0rem"],[4,"ngIf"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","margin-bottom","1rem"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngFor","ngForOf"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngIf"],[2,"display","flex","flex-direction","column","align-items","center","padding-right","1rem"],[2,"width","100%","height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem"],[1,"input-group",2,"width","calc(100% - 3.5rem)"],[1,"material-symbols-outlined","notranslate"],["type","text","placeholder","Scrivi un commento",1,"input",3,"keydown.enter","id"],[2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[2,"cursor","pointer","display","flex","flex-direction","row","align-items","center","width","100%",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333",3,"id"],[2,"display","none","flex-direction","column","gap","1rem","width","100%",3,"id"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem",3,"click"],["target","_blank",2,"text-decoration","none",3,"href"],[1,"card",2,"height","2.5rem","display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem","padding-left","0.5rem","padding-right","0.5rem","border-radius","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"height","2rem","width","2rem"],["style","color: #313131; font-size: 1.8rem;","class","material-symbols-outlined notranslate",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"color","#313131","font-size","1.8rem"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1)(2,"h2",2),b(3,"Tickets"),v(4,"span",3),B("click",function(){return s.openAddTicketPopup()}),b(5,"add_circle"),w()(),v(6,"div",4)(7,"h3",5),B("click",function(){return s.getOpenTickets(),s.higlightTicketIndicator(1)}),b(8,"Aperti"),w(),W(9,"div",6),v(10,"h3",7),B("click",function(){return s.getClosedTickets(),s.higlightTicketIndicator(2)}),b(11,"Chiusi"),w(),W(12,"div",6),v(13,"h3",8),B("click",function(){return s.getTickets(),s.higlightTicketIndicator(3)}),b(14,"Tutti"),w(),W(15,"div",6),v(16,"h3",9),B("click",function(){return s.getMyTickets(),s.higlightTicketIndicator(4)}),b(17,"Pubblicati da me"),w()()(),v(18,"div",10)(19,"div",11),ye(20,kee,31,19,"div",12),Un(21,"async"),ye(22,Pee,2,0,"button",13),w()(),W(23,"div",14),w()),i&2&&(j(20),Z("ngForOf",Bn(21,2,s.documents)),j(2),Z("ngIf",s.nextPageAvailable))},dependencies:[fr,pr,mr]});let n=e;return n})();var cj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=xe({type:e,selectors:[["app-zoom"]],decls:26,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-y","auto","overflow-x","hidden","padding-left","1rem","padding-right","1rem"],[1,"card",2,"margin-top","1rem","padding-left","1rem","padding-bottom","1rem"],[2,"width","100%","display","flex","flex-direction","column","gap","0.5rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem"],[2,"color","#333","margin-top","0rem","margin-bottom","0rem"],["href","https://zoom.us/it/signin#/login","target","_blank",2,"color","#333","margin-top","0rem","margin-bottom","0rem"],[2,"color","#333","text-decoration","underline","margin-top","0rem","margin-bottom","0rem"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1)(2,"h3"),b(3,"Chiamata Zoom"),w(),v(4,"div",2)(5,"div",3)(6,"span",4),b(7,"link"),w(),v(8,"p",5),b(9,"Link:"),w(),v(10,"a",6),b(11,"https://zoom.us/it/signin#/login"),w()(),v(12,"div",3)(13,"span",4),b(14,"person"),w(),v(15,"p",5),b(16,"Nome Utente:"),w(),v(17,"p",7),b(18,"erika.c@agenziaautoteam.it"),w()(),v(19,"div",3)(20,"span",4),b(21,"key"),w(),v(22,"p",5),b(23,"Password:"),w(),v(24,"p",7),b(25,"Autoteam2022"),w()()()()())}});let n=e;return n})();function Mee(n,e){n&1&&(v(0,"span",7),b(1,"add_circle"),w())}function Oee(n,e){if(n&1){let t=Ke();v(0,"span",16),B("click",function(){Ue(t);let i=ue().$implicit,s=ue();return Be(s.openChangeLinkPopup(i))}),b(1,"edit"),w()}}function Fee(n,e){if(n&1){let t=Ke();v(0,"span",16),B("click",function(){Ue(t);let i=ue().$implicit,s=ue();return Be(s.deleteLink(i))}),b(1,"delete"),w()}}function Lee(n,e){if(n&1&&(v(0,"div",8)(1,"p",9)(2,"span",10),b(3,"description"),w(),v(4,"strong"),b(5,"Nome: "),w(),W(6,"span",11),ye(7,Oee,2,0,"span",12)(8,Fee,2,0,"span",12),w(),v(9,"p",13),b(10),w(),v(11,"p",9)(12,"span",10),b(13,"format_list_bulleted"),w(),v(14,"strong"),b(15,"Descrizione: "),w()(),v(16,"p",13),b(17),w(),v(18,"p",14)(19,"span",10),b(20,"link"),w(),v(21,"strong"),b(22,"Url: "),w()(),v(23,"a",15),b(24),w()()),n&2){let t=e.$implicit,r=ue();j(7),Z("ngIf",r.generalService.isAdmin==!0),j(),Z("ngIf",r.generalService.isAdmin==!0),j(2),ft(t.name),j(7),ft(t.description),j(6),Cs("href",t.url,Hi),j(),ft(t.url)}}function Vee(n,e){if(n&1){let t=Ke();v(0,"button",17),B("click",function(){Ue(t);let i=ue();return Be(i.getMoreUsefulLinks())}),b(1,"Recupera altri link utili"),w()}}var lj=(()=>{let e=class e{ngOnInit(){this.getUsefulLinks()}constructor(r){this.generalService=r,this.documents=new De([]),this.nextPageAvailable=!1}getUsefulLinks(){return F.firestore().collection("useful_links").orderBy("timestamp","desc").limit(4).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(z({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{console.error("Error getting documents: ",r)})}getMoreUsefulLinks(){!this.lastVisible||!this.nextPageAvailable||F.firestore().collection("useful_links").orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(z({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}deleteLink(r){confirm("Sei sicuro di voler cancellare questo link?")&&F.firestore().collection("useful_links").doc(r.id).delete().then(()=>{this.generalService.presentToast("Link cancellato con successo")}).catch(i=>{this.generalService.presentToast("Errore durante la cancellazione del link: "+i.message)})}openChangeLinkPopup(r){this.generalService.currentLink=r,document.getElementById("change-new-useful-link-popup").style.display="flex",document.getElementById("change-useful-link-name-input").value=r.name,document.getElementById("change-useful-link-description-input").value=r.description,document.getElementById("change-useful-link-url-input").value=r.url}};e.\u0275fac=function(i){return new(i||e)(ne(ze))},e.\u0275cmp=xe({type:e,selectors:[["app-links"]],decls:9,vars:5,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-y","auto","overflow-x","hidden","padding-left","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],["onclick","document.getElementById('add-new-useful-link-popup').style.display = 'flex'; ","style","color: black; font-size: 1.8rem; cursor: pointer;","class","material-symbols-outlined notranslate",4,"ngIf"],[2,"overflow-y","auto","overflow-x","hidden","padding-bottom","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","card","style","padding-left: 1rem; padding-right: 1rem; padding-bottom: 1rem;",4,"ngFor","ngForOf"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],["onclick","document.getElementById('add-new-useful-link-popup').style.display = 'flex'; ",1,"material-symbols-outlined","notranslate",2,"color","black","font-size","1.8rem","cursor","pointer"],[1,"card",2,"padding-left","1rem","padding-right","1rem","padding-bottom","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.3rem"],[1,"material-symbols-outlined","notranslate",2,"color","#313131","font-size","1.5rem"],[2,"flex","1"],["style","font-size: 1.5rem; color: #333; cursor: pointer; display: flex;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.2rem"],["target","_blank",2,"overflow-wrap","break-word","margin-top","0rem",3,"href"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer","display","flex",3,"click"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"h2",1),b(2,"Link utili "),ye(3,Mee,2,0,"span",2),w(),v(4,"div",3)(5,"div",4),ye(6,Lee,25,6,"div",5),Un(7,"async"),ye(8,Vee,2,0,"button",6),w()()()),i&2&&(j(3),Z("ngIf",s.generalService.isAdmin==!0),j(3),Z("ngForOf",Bn(7,3,s.documents)),j(2),Z("ngIf",s.nextPageAvailable))},dependencies:[fr,pr,mr]});let n=e;return n})();var uj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){}changePassword(){let r=document.getElementById("change-password-email-input").value;F.auth().sendPasswordResetEmail(r).then(()=>{document.getElementById("change-password-email-input").value="",this.generalService.presentToast("Link per il cambio password inviato con successo, controlla la tua casella di posta ("+r+")")}).catch(i=>{this.generalService.presentToast("Errore nell'inviare l'email per il cambio password: "+i.message)})}};e.\u0275fac=function(i){return new(i||e)(ne(ze))},e.\u0275cmp=xe({type:e,selectors:[["app-change-password"]],decls:12,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],[2,"width","100%","margin-top","0.5rem"],[2,"margin-top","0rem"],[1,"input-group"],[1,"material-symbols-outlined","notranslate",2,"color","#333"],["id","change-password-email-input","type","text","placeholder","Email",1,"input"],[1,"button",2,"margin-top","1rem",3,"click"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"h2",1),b(2,"Cambio password"),w(),v(3,"div",2)(4,"p",3),b(5,"Inserisci qui il tuo indirizzo email per ricevere un link per cambiare la tua password"),w(),v(6,"div",4)(7,"span",5),b(8,"mail"),w(),W(9,"input",6),w(),v(10,"button",7),B("click",function(){return s.changePassword()}),b(11,"Conferma"),w()()())}});let n=e;return n})();function Uee(n,e){n&1&&(v(0,"div",4)(1,"h4",5),b(2,"Admin"),w(),v(3,"a",6),b(4,"Vai a utenti e permessi"),w()())}var dj=(()=>{let e=class e{ngOnInit(){}constructor(r){this.generalService=r}};e.\u0275fac=function(i){return new(i||e)(ne(ze))},e.\u0275cmp=xe({type:e,selectors:[["app-settings"]],decls:8,vars:1,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],["class","admin-elements",4,"ngIf"],["routerLink","/change-password",1,"a1",2,"margin-top","0.5rem"],[1,"admin-elements"],[2,"margin-bottom","0.5rem"],["href","assets\\settings\\permission-manager.html",1,"a1",2,"margin-top","0rem"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"h2",1),b(2,"Impostazioni"),w(),ye(3,Uee,5,0,"div",2),v(4,"h4",1),b(5,"Il mio account"),w(),v(6,"a",3),b(7,"Cambio password"),w()()),i&2&&(j(3),Z("ngIf",s.generalService.isAdmin))},dependencies:[pr,Oc]});let n=e;return n})();function Bee(n,e){if(n&1){let t=Ke();v(0,"tr",6)(1,"td",8),b(2),w(),v(3,"td",8),b(4),w(),v(5,"td",8),b(6),w(),v(7,"td",8)(8,"select",11),B("change",function(){let i=Ue(t).$implicit,s=ue();return Be(s.changeUserPermission(i))}),W(9,"option",12),v(10,"option",13),b(11,"Nessuno"),w(),v(12,"option",14),b(13,"Normale"),w(),v(14,"option",15),b(15,"Admin"),w()()(),v(16,"td",8),b(17),w(),v(18,"td",8),b(19),w(),v(20,"td",8)(21,"div",16)(22,"span",17),B("click",function(){let i=Ue(t).$implicit,s=ue();return Be(s.deleteUser(i))}),b(23,"delete"),w()()()()}if(n&2){let t=e.$implicit,r=ue();j(2),vE("",t.name," ",t.surname,""),j(2),ft(t.email),j(2),ft(t.agencyName),j(2),un("id","change-permission-type-input-",t.uid,""),j(9),ft(r.formatFirebaseTimestamp(t.registration_date)),j(2),ft(t.id)}}var hj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.getUsersList(),setTimeout(()=>{this.getUserPermission()},2e3)}formatFirebaseTimestamp(r){let i=new Date(r.seconds*1e3+r.nanoseconds/1e6),s={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"};return i.toLocaleString("it-IT",s)}getUsersList(){this.users=new He(r=>Bh(Cr(F.firestore(),"users_data"),s=>{let o=s.docs.map(a=>z({id:a.id},a.data()));r.next(o)},s=>{r.error(s)}))}getUserPermission(){F.firestore().collection("settings").doc("users_permissions").get().then(r=>{if(r.exists){let i=r.data();Object.entries(i).forEach(([s,o])=>{console.log(`Tag: ${s}, Valore: ${o}`),document.getElementById("change-permission-type-input-"+s).value=o})}else console.log("Documento non trovato.")}).catch(r=>{console.log("Errore nel recupero delle autorizzazioni:",r)})}changeUserPermission(r){let i=document.getElementById("change-permission-type-input-"+r.uid);confirm("Sei sicuro di voler modificare i permessi attribuiti a: "+r.email+"?")?i.value!=""&&F.firestore().collection("settings").doc("users_permissions").set({[r.uid]:i.value},{merge:!0}).then(()=>{alert("I permessi dell'utente: "+r.email+" sono stati modificati con successo")}).catch(s=>{alert("Errore durante la modifica dei permessi per questo utente: "+s.message)}):i.value=""}deleteUser(r){confirm("Sei sicuro di voler eliminare e di azzerare tutti i permessi per questo utente?")&&F.firestore().collection("users_data").doc(r.id).delete().then(()=>{F.firestore().collection("settings").doc("users_permissions").set({[r.uid]:"none"},{merge:!0}).catch(i=>{this.generalService.presentToast("Errore durante la modifica dei permessi per questo utente: "+i.message)}),this.generalService.presentToast("Utente e relativi permessi eliminati con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione dell'utente: "+i.message)})}};e.\u0275fac=function(i){return new(i||e)(ne(ze))},e.\u0275cmp=xe({type:e,selectors:[["app-admin"]],decls:26,vars:3,consts:[["id","settings-popup",2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],[2,"margin-top","0.5rem"],[2,"width","100%","overflow-x","auto","overflow-y","auto","border-radius","0.5rem"],[1,"table"],[1,"table-header"],[1,"table-row"],[1,"table-cell",2,"min-width","12rem"],[1,"table-cell"],[1,"table-body"],["class","table-row",4,"ngFor","ngForOf"],[3,"change","id"],["value",""],["value","none"],["value","normal"],["value","admin"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","1rem"],[1,"material-symbols-outlined","notranslate","table-button",3,"click"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"h2",1),b(2,"Impostazioni"),w(),v(3,"p",2),b(4,"Utenti e permessi"),w(),v(5,"div",3)(6,"table",4)(7,"thead",5)(8,"tr",6)(9,"th",7),b(10,"Nome e Cognome"),w(),v(11,"th",8),b(12,"Email"),w(),v(13,"th",8),b(14,"Agenzia"),w(),v(15,"th",8),b(16,"Permessi"),w(),v(17,"th",7),b(18,"Data Registrazione"),w(),v(19,"th",8),b(20,"ID"),w(),v(21,"th",8),b(22,"Azioni"),w()()(),v(23,"tbody",9),ye(24,Bee,24,8,"tr",10),Un(25,"async"),w()()()()),i&2&&(j(24),Z("ngForOf",Bn(25,1,s.users)))},dependencies:[fr,du,hu,mr]});let n=e;return n})();var jee=[{path:"",redirectTo:"chat",pathMatch:"full"},{path:"log",component:GB},{path:"login",component:WB},{path:"register",component:nj},{path:"company",component:ij},{path:"chat",component:rj},{path:"procedure",component:sj},{path:"home",component:oj},{path:"tickets",component:aj},{path:"zoom",component:cj},{path:"links",component:lj},{path:"change-password",component:uj},{path:"settings",component:dj},{path:"settings/admin",component:hj}],fj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({imports:[LI.forRoot(jee),LI]});let n=e;return n})();function $ee(n,e){if(n&1){let t=Ke();v(0,"button",10),B("click",function(){let i=Ue(t).$implicit,s=ue();return s.goToRoute("chat","close-sidebar"),Be(s.openChat(i))}),v(1,"span",11),b(2,"message"),w(),b(3),W(4,"div",15),v(5,"div",17),W(6,"span",18),w()()}if(n&2){let t=e.$implicit;j(3),qi(" ",t.name," "),j(2),un("id","",t.id,"-to-read-messages-count"),j(),un("id","",t.id,"-to-read-messages-count-display")}}function Hee(n,e){if(n&1){let t=Ke();v(0,"button",10),B("click",function(){let i=Ue(t).$implicit,s=ue();return s.goToRoute("settori","close-sidebar"),Be(s.showSectorProcedures(i))}),v(1,"span",11),b(2,"library_books"),w(),b(3),w()}if(n&2){let t=e.$implicit;j(3),ft(t.name)}}var pj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.chatDocuments=new De([]),this.documents=new De([]),this.chats=new De([]),this.count=0}ngOnInit(){document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{this.syncWithChatsCollectionChanges(),this.syncWithNewTickets()},500)})}getOpenTicketsNumber(){return g(this,null,function*(){let r=Cr(F.firestore(),"tickets"),i=zn(r,xa("status","==","open")),s=yield Ra(i);document.getElementById("open-tickets-sidebar-display").innerText=s.data().count+"",s.data().count!=0?document.getElementById("open-tickets-counter-container").style.display="flex":document.getElementById("open-tickets-counter-container").style.display="none"})}syncWithNewTickets(){F.firestore().collection("tickets").onSnapshot(r=>{r.docChanges().forEach(i=>{i.type==="removed"&&this.checkForNewTickets(),i.type==="added"&&(this.checkForNewTickets(),new Audio("assets/sounds/ticket.mp3").play())})})}goToRoute(r,i){this.closeSidebarMobile(),this.router.navigate(["/"+r])}closeSidebarMobile(){window.innerWidth<=899&&(document.getElementById("sidebar-container").style.display="none")}openChat(r){this.router.navigate(["/chat"],{queryParams:{id:r.id,name:r.name,description:r.description}})}newChat(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-chat-popup").style.display="flex"}newSector(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-sector-popup").style.display="flex"}hideOrShowSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}logout(){window.confirm("Sei sicuro di volerti disconnettere?")&&F.auth().signOut().then(()=>{this.generalService.presentToast("Disconnessione effettuata con successo"),this.router.navigate(["/log"])}).catch(r=>{this.generalService.presentToast("Errore durante la disconnessione: "+r.message)})}showSectorProcedures(r){this.router.navigate(["/procedure"],{queryParams:{sector_id:r.id,sector_name:r.name,sector_description:r.description}})}openCloseSettoriEProcedure(){let r=document.getElementById("settori-menu-container"),i=document.getElementById("open-menu-icon1");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):F.firestore().collection("settori").orderBy("name_query").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(z({id:a.id},a.data()))}),this.documents.next(o),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero dei settori: "+s.message)})}getTicketsToReadNumber(){return g(this,null,function*(){let r=Cr(F.firestore(),"tickets"),i=zn(r,xa("timestamp",">",Number(localStorage.getItem("last-ticket-timestamp")))),s=yield Ra(i)})}checkForNewTickets(){return g(this,null,function*(){this.generalService.getOpenTicketsNumber(),this.getTicketsToReadNumber(),F.firestore().collection("tickets").orderBy("timestamp","desc").limit(1).get().then(r=>{r.forEach(i=>g(this,null,function*(){var s=i.data().timestamp;Number(localStorage.getItem("last-ticket-check-timestamp"))<s.seconds*1e3?(document.getElementById("ticket-to-read-sidebar-container").style.display="flex",this.generalService.ticketToRead=!0,this.getTicketsToReadNumber()):document.getElementById("ticket-to-read-sidebar-container").style.display="none"}))}).catch(r=>{console.log("Error getting more recent tickt timestamp:",r)})})}syncWithChatsCollectionChanges(){F.firestore().collection("chat_messages").limit(1).orderBy("createdAt","desc").onSnapshot(r=>{r.docChanges().forEach(i=>{F.auth().onAuthStateChanged(s=>{i.doc.id!=localStorage.getItem("last_chat_message_fetched_id")&&i.doc.data().creator_uid!=s.uid&&(document.getElementById("chats-menu-container").style.display="none",localStorage.setItem("last_chat_message_fetched_id",i.doc.id),new Audio("assets/sounds/chat.mp3").play(),Notification.permission==="granted"?this.showChatMessageNotification(i.doc.data()):Notification.permission!=="denied"&&Notification.requestPermission().then(o=>{o==="granted"&&this.showChatMessageNotification(i.doc.data())})),this.openCloseChats()})})},r=>{console.error("Errore nel monitoraggio delle modifiche: ",r)})}showChatMessageNotification(r){let i=new Notification("AutoTeam | Nuovo Messaggio",{body:r.creator_name+" "+r.creator_surname+" | "+r.message,icon:"icon.png"});i.onclick=function(){window.open("https://www.serviziautoteam.it/app/#/chat?id="+r.chat_id)}}openCloseChats(){let r=document.getElementById("chats-menu-container"),i=document.getElementById("open-menu-icon2");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):F.firestore().collection("chats").orderBy("name_query").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(z({id:a.id},a.data())),this.checkForNewMessages(a.id)}),this.chats.next(o),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero delle chat: "+s.message)})}checkForNewMessages(r){return g(this,null,function*(){var i=yield this.getRecentDocumentTimestamp(r);if(i!="no_messages"){var s=i.seconds*1e3,o=Number(localStorage.getItem(r+"-last-message-seconds-timestamp-check"))*1e3;o?o<s?(console.log("Hai messaggi nuovi da leggere per la chat: "+r),document.getElementById(r+"-to-read-messages-count").style.display="flex"):document.getElementById(r+"-to-read-messages-count").style.display="none":(console.log("L'utente non ha mai controllato questa chat: "+r),document.getElementById(r+"-to-read-messages-count").style.display="flex")}})}getRecentDocumentTimestamp(r){return g(this,null,function*(){try{let s=yield F.firestore().collection("chat_messages").where("chat_id","==",r).orderBy("createdAt","desc").limit(1).get();return s.empty?"no_messages":s.docs[0].data().createdAt}catch(i){this.generalService.presentToast("Errore durante il controllo per i nuovi messaggi: "+i.message)}})}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}};e.\u0275fac=function(i){return new(i||e)(ne(ze),ne(nt))},e.\u0275cmp=xe({type:e,selectors:[["app-sidebar"]],decls:49,vars:6,consts:[["id","sidebar-container",2,"display","flex","height","100%"],["id","sidebar",1,"desktop-element",2,"display","flex","flex-direction","column","width","18rem","flex-shrink","0","height","calc(100% - 3.5rem)","background","white","border-right","1px solid rgba(0, 0, 0, 0.192)","overflow-y","auto","overflow-x","hidden"],["src","assets\\imgs\\logo.png",2,"width","100%","margin-top","1rem"],[1,"sidebar-button",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","open-tickets-counter-container",2,"background","rgb(247, 150, 32)","border-radius","50%","width","1.8rem","height","1.8rem","display","none","align-items","center","justify-content","center"],["id","open-tickets-sidebar-display",2,"color","white"],["id","ticket-to-read-sidebar-container",2,"background","red","border-radius","50%","width","1.8rem","height","1.8rem","display","none","align-items","center","justify-content","center"],["id","open-menu-icon2",1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","chats-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem"],[1,"sidebar-button",2,"width","100%",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.8rem"],["class","sidebar-button","style","width: 100%;",3,"click",4,"ngFor","ngForOf"],["id","open-menu-icon1",1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","settori-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem"],[2,"flex","1"],[1,"sidebar-button",2,"margin-bottom","1rem",3,"click"],[2,"display","none","background","red","border-radius","50%","width","1rem","height","1rem",3,"id"],[2,"color","white",3,"id"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1),W(2,"img",2),v(3,"button",3),B("click",function(){return s.goToRoute("company","close-sidebar")}),v(4,"span",4),b(5,"apartment"),w(),b(6,"L'azienda"),w(),v(7,"button",3),B("click",function(){return s.goToRoute("tickets","close-sidebar")}),v(8,"span",4),b(9,"style"),w(),b(10,"Tickets "),v(11,"div",5),W(12,"span",6),w(),W(13,"div",7),w(),v(14,"button",3),B("click",function(){return s.openCloseChats()}),v(15,"span",8),b(16,"keyboard_arrow_down"),w(),b(17,"Chat"),w(),v(18,"div",9)(19,"button",10),B("click",function(){return s.newChat()}),v(20,"span",11),b(21,"add_circle"),w(),b(22,"Nuova chat"),w(),ye(23,$ee,7,5,"button",12),Un(24,"async"),w(),v(25,"button",3),B("click",function(){return s.openCloseSettoriEProcedure()}),v(26,"span",13),b(27,"keyboard_arrow_down"),w(),b(28,"Settori e procedure"),w(),v(29,"div",14)(30,"button",10),B("click",function(){return s.newSector()}),v(31,"span",11),b(32,"add_circle"),w(),b(33,"Nuovo settore"),w(),ye(34,Hee,4,1,"button",12),Un(35,"async"),w(),v(36,"button",3),B("click",function(){return s.goToRoute("links","close-sidebar")}),v(37,"span",4),b(38,"link"),w(),b(39,"Link utili"),w(),W(40,"div",15),v(41,"button",3),B("click",function(){return s.goToRoute("settings","close-sidebar")}),v(42,"span",4),b(43,"settings"),w(),b(44,"Impostazioni"),w(),v(45,"button",16),B("click",function(){return s.logout()}),v(46,"span",4),b(47,"logout"),w(),b(48,"Disconnetti"),w()()()),i&2&&(j(23),Z("ngForOf",Bn(24,2,s.chats)),j(11),Z("ngForOf",Bn(35,4,s.documents)))},dependencies:[fr,mr]});let n=e;return n})();function zee(n,e){if(n&1){let t=Ke();v(0,"button",14),B("click",function(){Ue(t);let i=ue();return Be(i.deleteTicket())}),b(1,"Elimina"),w()}}var mj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.documents=new De([]),this.chatDocuments=new De([]),this.downloadURL="",this.ticketDownloadURL=""}ngOnInit(){}openChangeTicketPopup(){document.getElementById("edit-menu-ticket-popup").style.display="none",document.getElementById("change-ticket-argomento-input").value=this.generalService.currentTicket.argomento,document.getElementById("change-ticket-description-input").value=this.generalService.currentTicket.descrizione,document.getElementById("change-ticket-popup").style.display="flex"}closeAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="none"}closeTicketMenuPopup(){document.getElementById("edit-menu-ticket-popup").style.display="none"}closeAddNewSectorPopup(){document.getElementById("add-new-sector-popup").style.display="none"}closeChangeSectorPopup(){document.getElementById("change-sector-popup").style.display="none"}closeAddNewProcedurePopup(){document.getElementById("add-new-procedure-popup").style.display="none"}closeAddNewUsefulLinkPopup(){document.getElementById("add-new-useful-link-popup").style.display="none"}closeAddNewChatPopup(){document.getElementById("add-new-chat-popup").style.display="none"}closeChangeTicketPopup(){document.getElementById("change-ticket-popup").style.display="none"}closeChangeUsefulLinkPopup(){document.getElementById("change-new-useful-link-popup").style.display="none"}closeChangeChatPopup(){document.getElementById("change-chat-popup").style.display="none"}changeTicket(){let r=document.getElementById("change-ticket-argomento-input").value,i=document.getElementById("change-ticket-description-input").value;F.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({argomento:r,descrizione:i},{merge:!0}).then(s=>{document.getElementById("change-ticket-popup").style.display="none",this.generalService.presentToast("Ticket salvato con successo")}).catch(s=>{this.generalService.presentToast("Errore durante il salvataggio del ticket: "+s.message)})}saveChat(){let r=document.getElementById("change-chat-name-input"),i=document.getElementById("change-chat-description-input");F.firestore().collection("chats").doc(this.generalService.currentChatId).set({name:r.value,description:i.value},{merge:!0}).then(()=>{document.getElementById("open-chat-name-display").innerText=r.value,document.getElementById("change-chat-popup").style.display="none",this.router.navigate(["/chat"],{queryParams:{id:this.generalService.currentChatId,name:r.value,description:i.value}}),this.generalService.presentToast("Chat modificata con successo")}).catch(s=>{this.generalService.presentToast("Errore durante il salvataggio delle modifiche per la chat: "+s.message)})}sendTicketEmail(r){fetch("https://apis.serviziautoteam.it/email/addTicket",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ticket:r})}).then(i=>i.json()).then(i=>{console.log("Risposta dal server:",i)}).catch(i=>{console.error("Errore durante l'invio dell'email:",i)})}deleteTicket(){confirm("Sei sicuro di voler cancellare questo ticket e tutti i suoi allegati?")&&F.firestore().collection("tickets").doc(this.generalService.currentTicket.id).delete().then(()=>{if(this.generalService.currentTicket.storage_resource_path!=""){let r=ss(F.storage(),this.generalService.currentTicket.storage_resource_path);Gl(r).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.getOpenTicketsNumber(),this.generalService.presentToast("Il ticket e i relativi allegati sono stati eliminati con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione del ticket: 'DELETE FILE ERROR' "+i.message)}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione del ticket: 'DELETE DOC ERROR' "+i.message)})}else document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.getOpenTicketsNumber(),this.generalService.presentToast("Il ticket e i relativi allegati sono stati eliminati con successo")})}openTicket(){F.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"open"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aperto con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'apertura del ticket: "+r.message)})}closeTicket(){F.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"close"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket chiuso con successo")}).catch(r=>{this.generalService.presentToast("Errore durante la chiusura del ticket: "+r.message)})}addNewSector(){let r=document.getElementById("add-sector-name-input"),i=document.getElementById("add-sector-description-input");var s=F.auth().currentUser;F.firestore().collection("settori").doc().set({name:r.value,name_query:r.value.toLowerCase(),description:i.value,timestamp:F.firestore.FieldValue.serverTimestamp(),creator_id:s.uid}).then(()=>{document.getElementById("add-new-sector-popup").style.display="none",this.generalService.presentToast("Settore aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del settore: "+o.message)})}addNewTicketLink(){let r=document.getElementById("add-ticket-label-input"),i=document.getElementById("add-ticket-link-input"),s=document.getElementById("add-ticket-links-container"),o={label:r.value,link:i.value};this.generalService.ticketLinkObject[`resource${this.generalService.ticketLinkCounter}`]=o;let a=document.createElement("div");a.className="card",a.id=`entry${this.generalService.ticketLinkCounter}`,a.style.paddingLeft="0.8rem",a.style.borderRadius="0.5rem";let c=document.createElement("div");c.className="card-body";let l=document.createElement("h5");l.className="card-title",l.innerText=r.value,l.style.marginTop="0.5rem",l.style.marginBottom="0.5rem";let d=document.createElement("a");d.className="card-link",d.href=i.value,d.innerText=i.value,d.target="_blank",d.style.marginBottom="0.5rem",c.appendChild(l),c.appendChild(d),a.appendChild(c),s.appendChild(a),this.generalService.ticketLinkCounter++,r.value="",i.value=""}addTicket(){let r=document.getElementById("add-ticket-argomento-input").value,i=document.getElementById("add-ticket-description-input").value,s=document.getElementById("ticket-fileInput2"),o=document.getElementById("ticket-uploadProgress"),a=document.getElementById("ticket-uploadStatus");var c=F.auth().currentUser;if(s.files&&s.files.length>0){let d=s.files[0];var l="ticket-files/"+d.name+"-date"+Date.now();let h=ss(F.storage(),l),p=Wh(h,d);p.on("state_changed",_=>{let E=_.bytesTransferred/_.totalBytes*100;switch(o&&(o.value=E),a&&(a.textContent=`Caricamento: ${E.toFixed(2)}%`),_.state){case"paused":console.log("Caricamento in pausa");break;case"running":console.log("Caricamento in corso");break}},_=>{console.error("Errore nel caricamento:",_),a&&(a.textContent="Errore nel caricamento")},()=>{Kh(p.snapshot.ref).then(_=>{this.ticketDownloadURL=_,a&&F.firestore().collection("tickets").doc().set({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:c.email,creator_id:c.uid,timestamp:F.firestore.FieldValue.serverTimestamp(),status:"open",links:this.generalService.ticketLinkObject,links_counter:this.generalService.ticketLinkCounter,storage_resource_link:this.ticketDownloadURL,storage_resource_path:l}).then(()=>{document.getElementById("add-ticket-label-input").value="",document.getElementById("add-ticket-link-input").value="",document.getElementById("add-ticket-links-container").innerHTML="",document.getElementById("add-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aggiunto con successo"),this.sendTicketEmail({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:c.email,creator_id:c.uid,timestamp:F.firestore.FieldValue.serverTimestamp(),status:"open",links:this.generalService.ticketLinkObject,links_counter:this.generalService.ticketLinkCounter,storage_resource_link:this.ticketDownloadURL,storage_resource_path:l})}).catch(E=>{console.error(E),this.generalService.presentToast("Errore durante l'aggiunta del ticket: "+E.message)})})})}else F.firestore().collection("tickets").doc().set({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:c.email,creator_id:c.uid,timestamp:F.firestore.FieldValue.serverTimestamp(),status:"open",links:this.generalService.ticketLinkObject,links_counter:this.generalService.ticketLinkCounter,storage_resource_link:"",storage_resource_path:""}).then(()=>{document.getElementById("add-ticket-label-input").value="",document.getElementById("add-ticket-link-input").value="",document.getElementById("add-ticket-links-container").innerHTML="",document.getElementById("add-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aggiunto con successo"),this.sendTicketEmail({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:c.email,creator_id:c.uid,timestamp:F.firestore.FieldValue.serverTimestamp(),status:"open",links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:"",storage_resource_path:""})}).catch(d=>{console.error(d),this.generalService.presentToast("Errore durante l'aggiunta del ticket: "+d.message)})}addNewProcedureLink(){let r=document.getElementById("add-procedure-label-input"),i=document.getElementById("add-procedure-link-input"),s=document.getElementById("add-procedure-links-container"),o={label:r.value,link:i.value};this.generalService.linkObject[`resource${this.generalService.linkCounter}`]=o;let a=document.createElement("div");a.className="card",a.id=`entry${this.generalService.linkCounter}`,a.style.paddingLeft="0.8rem",a.style.borderRadius="0.5rem";let c=document.createElement("div");c.className="card-body";let l=document.createElement("h5");l.className="card-title",l.innerText=r.value,l.style.marginTop="0.5rem",l.style.marginBottom="0.5rem";let d=document.createElement("a");d.className="card-link",d.href=i.value,d.innerText=i.value,d.target="_blank",d.style.marginBottom="0.5rem",c.appendChild(l),c.appendChild(d),a.appendChild(c),s.appendChild(a),this.generalService.linkCounter++,r.value="",i.value=""}addNewProcedure(){let r=document.getElementById("add-procedure-name-input"),i=document.getElementById("add-procedure-description-input"),s=document.getElementById("fileInput2"),o=document.getElementById("uploadProgress"),a=document.getElementById("uploadStatus"),c=document.getElementById("add-procedure-folder-input");if(s.files&&s.files.length>0){let d=s.files[0];var l="files/"+d.name+"-date"+Date.now();let h=ss(F.storage(),l),p=Wh(h,d);p.on("state_changed",_=>{let E=_.bytesTransferred/_.totalBytes*100;switch(o&&(o.value=E),a&&(a.textContent=`Caricamento: ${E.toFixed(2)}%`),_.state){case"paused":console.log("Caricamento in pausa");break;case"running":console.log("Caricamento in corso");break}},_=>{console.error("Errore nel caricamento:",_),a&&(a.textContent="Errore nel caricamento")},()=>{Kh(p.snapshot.ref).then(_=>{this.downloadURL=_,a&&F.firestore().collection("procedure").doc().set({name:r.value,description:i.value,sector_id:this.generalService.currentSectorId,folder_name:c.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,timestamp:F.firestore.FieldValue.serverTimestamp(),links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:this.downloadURL,storage_resource_path:l}).then(()=>{document.getElementById("add-procedure-name-input").value="",document.getElementById("add-procedure-description-input").value="",document.getElementById("add-procedure-label-input").value="",document.getElementById("add-procedure-link-input").value="",document.getElementById("add-procedure-links-container").innerHTML="",document.getElementById("add-new-procedure-popup").style.display="none",this.generalService.presentToast("Procedura aggiunta con successo")}).catch(E=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+E.message)})})})}else F.firestore().collection("procedure").doc().set({name:r.value,description:i.value,sector_id:this.generalService.currentSectorId,folder_name:c.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,timestamp:F.firestore.FieldValue.serverTimestamp(),links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:"",storage_resource_path:""}).then(()=>{document.getElementById("add-procedure-name-input").value="",document.getElementById("add-procedure-description-input").value="",document.getElementById("add-procedure-label-input").value="",document.getElementById("add-procedure-link-input").value="",document.getElementById("add-procedure-links-container").innerHTML="",document.getElementById("add-new-procedure-popup").style.display="none",this.generalService.presentToast("Procedura aggiunta con successo")}).catch(d=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+d.message)})}addNewChat(){let r=document.getElementById("add-chat-name-input"),i=document.getElementById("add-chat-description-input");F.firestore().collection("chats").doc().set({name:r.value,name_query:r.value.toLowerCase(),description:i.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,timestamp:F.firestore.FieldValue.serverTimestamp()}).then(()=>{document.getElementById("add-chat-name-input").value="",document.getElementById("add-chat-description-input").value="",document.getElementById("add-new-chat-popup").style.display="none",this.generalService.presentToast("Chat creata con successo")}).catch(s=>{this.generalService.presentToast("Errore durante la creazione della chat: "+s.message)})}addNewUsefulLink(){let r=document.getElementById("add-useful-link-name-input"),i=document.getElementById("add-useful-link-description-input"),s=document.getElementById("add-useful-link-url-input");F.firestore().collection("useful_links").doc().set({name:r.value,description:i.value,url:s.value,timestamp:F.firestore.FieldValue.serverTimestamp()}).then(()=>{document.getElementById("add-new-useful-link-popup").style.display="none",this.generalService.presentToast("Link utile aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del link utile: "+o.message)})}changeSector(){let r=document.getElementById("change-sector-popup-name-input"),i=document.getElementById("change-sector-popup-description-input");F.firestore().collection("settori").doc(this.generalService.currentSectorId).set({name:r.value,description:i.value},{merge:!0}).then(()=>{document.getElementById("sector-name").innerText=r.value,document.getElementById("sector-description").innerText=i.value,document.getElementById("change-sector-popup").style.display="none",this.generalService.presentToast("Settore modificato con successo")}).catch(s=>{this.generalService.presentToast("Errore durante la modifica del settore: "+s.message)})}changeLink(){let r=document.getElementById("change-useful-link-name-input"),i=document.getElementById("change-useful-link-description-input"),s=document.getElementById("change-useful-link-url-input");F.firestore().collection("useful_links").doc(this.generalService.currentLink.id).set({name:r.value,description:i.value,url:s.value},{merge:!0}).then(()=>{document.getElementById("change-new-useful-link-popup").style.display="none",this.generalService.presentToast("Modifiche salvate con successo")}).catch(o=>{this.generalService.presentToast("Errore durante il salvataggio delle modifiche del link: "+o.message)})}};e.\u0275fac=function(i){return new(i||e)(ne(ze),ne(nt))},e.\u0275cmp=xe({type:e,selectors:[["app-popups"]],decls:171,vars:1,consts:[["id","toast-message",2,"height","100%","width","100%","display","none","flex-direction","column","pointer-events","none","background","transparent","z-index","99999999","position","absolute","align-items","center","justify-content","end"],[1,"toastMessage",2,"pointer-events","all","width","95%"],["id","toast-message-text",2,"width","100%"],["id","add-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","40rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","space-between"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","black","cursor","pointer",3,"click"],[2,"width","100%","display","flex","flex-direction","row","flex-wrap","wrap","gap","1rem"],[2,"width","100%","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-ticket-argomento-input","type","text","placeholder","Argomento",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-ticket-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[2,"flex","1","min-width","15rem","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-ticket-label-input","type","text","placeholder","Etichetta",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-ticket-link-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],[1,"button",3,"click"],["id","add-ticket-links-container",2,"display","flex","flex-direction","column","gap","0.5rem"],["id","ticket-fileInput2","type","file",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","padding-top","1rem"],["id","ticket-uploadProgress","value","0","max","100",2,"width","100%"],["id","ticket-uploadStatus"],["id","edit-menu-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"min-width","18rem","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","button",3,"click",4,"ngIf"],["id","open-ticket-button",1,"button",3,"click"],["id","close-ticket-button",1,"button",3,"click"],["id","add-new-chat-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-chat-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-chat-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","change-chat-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","change-chat-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","change-chat-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-sector-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-sector-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-sector-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","change-sector-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","change-sector-popup-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","change-sector-popup-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-procedure-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","50rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],["id","add-procedure-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[2,"margin-top","-0.5rem","margin-bottom","-0.5rem","color","#333"],["id","add-procedure-folder-input",1,"inputGroup1",2,"height","2.5rem","border-radius","0.5rem"],["value",""],["id","add-procedure-label-input","type","text","placeholder","Etichetta",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-link-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-links-container",2,"display","flex","flex-direction","column","gap","0.5rem"],["id","fileInput2","type","file",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","padding-top","1rem"],["id","uploadProgress","value","0","max","100",2,"width","100%"],["id","uploadStatus"],["id","add-new-useful-link-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","30rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],["id","add-useful-link-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-useful-link-description-input","type","text","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","min-height","5.5rem","border-radius","0.5rem","resize","vertical"],["id","add-useful-link-url-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","change-new-useful-link-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","change-useful-link-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","change-useful-link-description-input","type","text","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","min-height","5.5rem","border-radius","0.5rem","resize","vertical"],["id","change-useful-link-url-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","change-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","change-ticket-argomento-input","type","text","placeholder","Argomento",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","change-ticket-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1),W(2,"p",2),w()(),v(3,"div",3)(4,"div",4)(5,"h3",5),b(6,"Nuovo Ticket"),v(7,"span",6),B("click",function(){return s.closeAddTicketPopup()}),b(8,"close"),w()(),v(9,"div",7)(10,"div",8),W(11,"input",9)(12,"textarea",10),w(),v(13,"div",11),W(14,"input",12)(15,"input",13),v(16,"button",14),B("click",function(){return s.addNewTicketLink()}),b(17,"Aggiungi Risorsa"),w(),W(18,"div",15)(19,"input",16)(20,"progress",17)(21,"span",18),w()(),v(22,"div",5)(23,"button",14),B("click",function(){return s.closeAddTicketPopup()}),b(24,"Annulla"),w(),v(25,"button",14),B("click",function(){return s.addTicket()}),b(26,"Pubblica"),w()()()(),v(27,"div",19)(28,"div",20)(29,"h3",5),b(30,"Men\xF9 ticket"),v(31,"span",6),B("click",function(){return s.closeTicketMenuPopup()}),b(32,"close"),w()(),v(33,"div",21)(34,"button",14),B("click",function(){return s.openChangeTicketPopup()}),b(35,"Modifica"),w(),ye(36,zee,2,0,"button",22),v(37,"button",23),B("click",function(){return s.openTicket()}),b(38,"Apri Ticket"),w(),v(39,"button",24),B("click",function(){return s.closeTicket()}),b(40,"Chiudi Ticket"),w()()()(),v(41,"div",25)(42,"div",20)(43,"h3",5),b(44,"Nuova Chat"),v(45,"span",6),B("click",function(){return s.closeAddNewChatPopup()}),b(46,"close"),w()(),v(47,"div",8),W(48,"input",26)(49,"textarea",27),w(),v(50,"div",5)(51,"button",14),B("click",function(){return s.closeAddNewChatPopup()}),b(52,"Annulla"),w(),v(53,"button",14),B("click",function(){return s.addNewChat()}),b(54,"Aggiungi"),w()()()(),v(55,"div",28)(56,"div",20)(57,"h3",5),b(58,"Modifica Chat"),v(59,"span",6),B("click",function(){return s.closeChangeChatPopup()}),b(60,"close"),w()(),v(61,"div",8),W(62,"input",29)(63,"textarea",30),w(),v(64,"div",5)(65,"button",14),B("click",function(){return s.closeChangeChatPopup()}),b(66,"Annulla"),w(),v(67,"button",14),B("click",function(){return s.saveChat()}),b(68,"Salva"),w()()()(),v(69,"div",31)(70,"div",20)(71,"h3",5),b(72,"Nuovo settore"),v(73,"span",6),B("click",function(){return s.closeAddNewSectorPopup()}),b(74,"close"),w()(),v(75,"div",8),W(76,"input",32)(77,"textarea",33),w(),v(78,"div",5)(79,"button",14),B("click",function(){return s.closeAddNewSectorPopup()}),b(80,"Annulla"),w(),v(81,"button",14),B("click",function(){return s.addNewSector()}),b(82,"Aggiungi"),w()()()(),v(83,"div",34)(84,"div",20)(85,"h3",5),b(86,"Modifica settore"),v(87,"span",6),B("click",function(){return s.closeChangeSectorPopup()}),b(88,"close"),w()(),v(89,"div",8),W(90,"input",35)(91,"textarea",36),w(),v(92,"div",5)(93,"button",14),B("click",function(){return s.closeChangeSectorPopup()}),b(94,"Annulla"),w(),v(95,"button",14),B("click",function(){return s.changeSector()}),b(96,"Salva"),w()()()(),v(97,"div",37)(98,"div",38)(99,"h3",5),b(100,"Nuova procedura"),v(101,"span",6),B("click",function(){return s.closeAddNewProcedurePopup()}),b(102,"close"),w()(),v(103,"div",7)(104,"div",11),W(105,"input",39)(106,"textarea",40),v(107,"p",41),b(108,"Cartella"),w(),v(109,"select",42),W(110,"option",43),w()(),v(111,"div",11),W(112,"input",44)(113,"input",45),v(114,"button",14),B("click",function(){return s.addNewProcedureLink()}),b(115,"Aggiungi Risorsa"),w(),W(116,"div",46)(117,"input",47)(118,"progress",48)(119,"span",49),w()(),v(120,"div",5)(121,"button",14),B("click",function(){return s.closeAddNewProcedurePopup()}),b(122,"Annulla"),w(),v(123,"button",14),B("click",function(){return s.addNewProcedure()}),b(124,"Conferma"),w()()()(),v(125,"div",50)(126,"div",51)(127,"h3",5),b(128,"Nuovo link"),v(129,"span",6),B("click",function(){return s.closeAddNewUsefulLinkPopup()}),b(130,"close"),w()(),v(131,"div",7)(132,"div",11),W(133,"input",52)(134,"textarea",53)(135,"input",54),w()(),v(136,"div",5)(137,"button",14),B("click",function(){return s.closeAddNewUsefulLinkPopup()}),b(138,"Annulla"),w(),v(139,"button",14),B("click",function(){return s.addNewUsefulLink()}),b(140,"Conferma"),w()()()(),v(141,"div",55)(142,"div",51)(143,"h3",5),b(144,"Modifica link"),v(145,"span",6),B("click",function(){return s.closeChangeUsefulLinkPopup()}),b(146,"close"),w()(),v(147,"div",7)(148,"div",11),W(149,"input",56)(150,"textarea",57)(151,"input",58),w()(),v(152,"div",5)(153,"button",14),B("click",function(){return s.closeChangeUsefulLinkPopup()}),b(154,"Annulla"),w(),v(155,"button",14),B("click",function(){return s.changeLink()}),b(156,"Salva"),w()()()(),v(157,"div",59)(158,"div",51)(159,"h3",5),b(160,"Modifica Ticket"),v(161,"span",6),B("click",function(){return s.closeChangeTicketPopup()}),b(162,"close"),w()(),v(163,"div",8),W(164,"input",60)(165,"textarea",61),w(),v(166,"div",5)(167,"button",14),B("click",function(){return s.closeChangeTicketPopup()}),b(168,"Annulla"),w(),v(169,"button",14),B("click",function(){return s.changeTicket()}),b(170,"Salva"),w()()()()),i&2&&(j(36),Z("ngIf",s.generalService.isAdmin==!0))},dependencies:[pr,du,hu]});let n=e;return n})();var gj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){}hideOrShowSidebar(){this.generalService.openCloseSidebar()}openCloseSidebar(){this.generalService.openCloseSidebar()}};e.\u0275fac=function(i){return new(i||e)(ne(ze))},e.\u0275cmp=xe({type:e,selectors:[["app-header"]],decls:16,vars:0,consts:[["id","header",2,"height","3.5rem","border-bottom","1px solid rgba(0, 0, 0, 0.192)","display","flex","flex-direction","row","align-items","center","flex-shrink","0","justify-content","space-between","padding-left","1rem","padding-right","1rem"],[1,"desktop-element",2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2rem","color","#333","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.3rem"],["id","header-name-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-surname-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-email-display",2,"margin-top","0rem","margin-bottom","0rem"],["id","header-agency-display",2,"margin-bottom","0rem","margin-top","0rem"],[1,"mobile-element",2,"display","none","flex-direction","row","align-items","center","gap","1rem"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1)(2,"span",2),B("click",function(){return s.openCloseSidebar()}),b(3,"menu"),w(),v(4,"div")(5,"div",3),W(6,"h3",4)(7,"h3",5),w(),W(8,"p",6),w(),v(9,"p"),b(10," | "),w(),v(11,"div"),W(12,"h3",7),w()(),v(13,"div",8)(14,"span",2),B("click",function(){return s.hideOrShowSidebar()}),b(15,"menu"),w()()())}});let n=e;return n})();var _j=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.initFirebase(),this.generalService.getUserData()}ngOnInit(){F.auth().onAuthStateChanged(r=>{r?(this.generalService.initNormalScreen(),this.getUserPremissionState()):this.router.navigate(["/log"])})}getUserPremissionState(){return g(this,null,function*(){let i=F.auth().currentUser;i?(yield i.getIdTokenResult()).claims.role=="admin"?(this.generalService.isAdmin=!0,console.log("isAdmin: "+this.generalService.isAdmin)):(this.generalService.isAdmin=!1,console.log("is Admin: "+this.generalService.isAdmin)):(this.router.navigate(["/log"]),console.log("Log in to fetch your current user permission state"),this.generalService.presentToast("Utente non loggato"))})}initFirebase(){let r={apiKey:"AIzaSyD_tP0OvuudgC3fbvxHs9SyCl5bMYnW3S4",authDomain:"ttm-db-82f02.firebaseapp.com",databaseURL:"https://ttm-db-82f02-default-rtdb.europe-west1.firebasedatabase.app",projectId:"ttm-db-82f02",storageBucket:"ttm-db-82f02.appspot.com",messagingSenderId:"264736388729",appId:"1:264736388729:web:4f5b8c6411d3ef47a786a8",measurementId:"G-FQYCE4Q6XN"};F.initializeApp(r)}openCloseSidebar(){this.generalService.openCloseSidebar()}};e.\u0275fac=function(i){return new(i||e)(ne(ze),ne(nt))},e.\u0275cmp=xe({type:e,selectors:[["app-root"]],decls:7,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","row"],[2,"height","100%"],[2,"height","100%","width","100%"],["id","router-outlet-container",2,"flex","1","height","calc(100% - 3.5rem)"]],template:function(i,s){i&1&&(W(0,"app-popups")(1,"app-header"),v(2,"div",0)(3,"div",1),W(4,"app-sidebar",2),w(),v(5,"div",3),W(6,"router-outlet"),w()())},dependencies:[RI,pj,mj,gj]});let n=e;return n})();var yj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ln({type:e,bootstrap:[_j]}),e.\u0275inj=Fn({providers:[{provide:Lr,useClass:Em}],imports:[JP,tj,fj]});let n=e;return n})();YP().bootstrapModule(yj).catch(n=>console.error(n));
