var oR=Object.defineProperty,Zj=Object.defineProperties;var e$=Object.getOwnPropertyDescriptors;var iR=Object.getOwnPropertySymbols,t$=Object.getPrototypeOf,n$=Object.prototype.hasOwnProperty,r$=Object.prototype.propertyIsEnumerable,i$=Reflect.get;var sR=(n,e,t)=>e in n?oR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,q=(n,e)=>{for(var t in e||={})n$.call(e,t)&&sR(n,t,e[t]);if(iR)for(var t of iR(e))r$.call(e,t)&&sR(n,t,e[t]);return n},lt=(n,e)=>Zj(n,e$(e));var s$=(n,e)=>{for(var t in e)oR(n,t,{get:e[t],enumerable:!0})};var Kr=(n,e,t)=>i$(t$(n),t,e);var g=(n,e,t)=>new Promise((r,i)=>{var s=c=>{try{a(t.next(c))}catch(l){i(l)}},o=c=>{try{a(t.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(n,e)).next())});var aR=null;var Iv=1,cR=Symbol("SIGNAL");function Le(n){let e=aR;return aR=n,e}var lR={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function o$(n){if(!(Cv(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Iv)){if(!n.producerMustRecompute(n)&&!Ev(n)){n.dirty=!1,n.lastCleanEpoch=Iv;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Iv}}function uR(n){return n&&(n.nextProducerIndex=0),Le(n)}function dR(n,e){if(Le(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Cv(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)bv(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Ev(n){Bf(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(o$(t),r!==t.version))return!0}return!1}function hR(n){if(Bf(n),Cv(n))for(let e=0;e<n.producerNode.length;e++)bv(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function bv(n,e){if(a$(n),Bf(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)bv(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Bf(i),i.producerIndexOfThis[r]=e}}function Cv(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Bf(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function a$(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function c$(){throw new Error}var l$=c$;function fR(n){l$=n}function pe(n){return typeof n=="function"}function Ga(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var jf=Ga(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Au(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Bt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(pe(r))try{r()}catch(s){e=s instanceof jf?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{pR(s)}catch(o){e=e??[],o instanceof jf?e=[...e,...o.errors]:e.push(o)}}if(e)throw new jf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)pR(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Au(t,e)}remove(e){let{_finalizers:t}=this;t&&Au(t,e),e instanceof n&&e._removeParent(this)}};Bt.EMPTY=(()=>{let n=new Bt;return n.closed=!0,n})();var Tv=Bt.EMPTY;function $f(n){return n instanceof Bt||n&&"closed"in n&&pe(n.remove)&&pe(n.add)&&pe(n.unsubscribe)}function pR(n){pe(n)?n():n.unsubscribe()}var Dr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Wa={setTimeout(n,e,...t){let{delegate:r}=Wa;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Wa;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Hf(n){Wa.setTimeout(()=>{let{onUnhandledError:e}=Dr;if(e)e(n);else throw n})}function xu(){}var mR=Sv("C",void 0,void 0);function gR(n){return Sv("E",void 0,n)}function _R(n){return Sv("N",n,void 0)}function Sv(n,e,t){return{kind:n,value:e,error:t}}var vo=null;function Ka(n){if(Dr.useDeprecatedSynchronousErrorHandling){let e=!vo;if(e&&(vo={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=vo;if(vo=null,t)throw r}}else n()}function yR(n){Dr.useDeprecatedSynchronousErrorHandling&&vo&&(vo.errorThrown=!0,vo.error=n)}var wo=class extends Bt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,$f(e)&&e.add(this)):this.destination=h$}static create(e,t,r){return new Qa(e,t,r)}next(e){this.isStopped?Av(_R(e),this):this._next(e)}error(e){this.isStopped?Av(gR(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Av(mR,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},u$=Function.prototype.bind;function Dv(n,e){return u$.call(n,e)}var xv=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){qf(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){qf(r)}else qf(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){qf(t)}}},Qa=class extends wo{constructor(e,t,r){super();let i;if(pe(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Dr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Dv(e.next,s),error:e.error&&Dv(e.error,s),complete:e.complete&&Dv(e.complete,s)}):i=e}this.destination=new xv(i)}};function qf(n){Dr.useDeprecatedSynchronousErrorHandling?yR(n):Hf(n)}function d$(n){throw n}function Av(n,e){let{onStoppedNotification:t}=Dr;t&&Wa.setTimeout(()=>t(n,e))}var h$={closed:!0,next:xu,error:d$,complete:xu};var Ya=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Gn(n){return n}function Rv(...n){return Nv(n)}function Nv(n){return n.length===0?Gn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var je=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=p$(t)?t:new Qa(t,r,i);return Ka(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=vR(r),new r((i,s)=>{let o=new Qa({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Ya](){return this}pipe(...t){return Nv(t)(this)}toPromise(t){return t=vR(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function vR(n){var e;return(e=n??Dr.Promise)!==null&&e!==void 0?e:Promise}function f$(n){return n&&pe(n.next)&&pe(n.error)&&pe(n.complete)}function p$(n){return n&&n instanceof wo||f$(n)&&$f(n)}function Pv(n){return pe(n?.lift)}function Pe(n){return e=>{if(Pv(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ke(n,e,t,r,i){return new kv(n,e,t,r,i)}var kv=class extends wo{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ja(){return Pe((n,e)=>{let t=null;n._refCount++;let r=ke(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Xa=class extends je{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Pv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Bt;let t=this.getSubject();e.add(this.source.subscribe(ke(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Bt.EMPTY)}return e}refCount(){return Ja()(this)}};var wR=Ga(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var an=(()=>{class n extends je{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new zf(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new wR}next(t){Ka(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Ka(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Ka(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Tv:(this.currentObservers=null,s.push(t),new Bt(()=>{this.currentObservers=null,Au(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new je;return t.source=this,t}}return n.create=(e,t)=>new zf(e,t),n})(),zf=class extends an{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Tv}};var De=class extends an{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Wn=new je(n=>n.complete());function IR(n){return n&&pe(n.schedule)}function ER(n){return n[n.length-1]}function bR(n){return pe(ER(n))?n.pop():void 0}function us(n){return IR(ER(n))?n.pop():void 0}function Gf(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function TR(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{l(r.next(d))}catch(h){o(h)}}function c(d){try{l(r.throw(d))}catch(h){o(h)}}function l(d){d.done?s(d.value):i(d.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function CR(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Io(n){return this instanceof Io?(this.v=n,this):new Io(n)}function SR(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(E){return Promise.resolve(E).then(_,h)}}function a(_,E){r[_]&&(i[_]=function(A){return new Promise(function(R,L){s.push([_,A,R,L])>1||c(_,A)})},E&&(i[_]=E(i[_])))}function c(_,E){try{l(r[_](E))}catch(A){p(s[0][3],A)}}function l(_){_.value instanceof Io?Promise.resolve(_.value.v).then(d,h):p(s[0][2],_)}function d(_){c("next",_)}function h(_){c("throw",_)}function p(_,E){_(E),s.shift(),s.length&&c(s[0][0],s[0][1])}}function DR(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof CR=="function"?CR(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Wf=n=>n&&typeof n.length=="number"&&typeof n!="function";function Kf(n){return pe(n?.then)}function Qf(n){return pe(n[Ya])}function Yf(n){return Symbol.asyncIterator&&pe(n?.[Symbol.asyncIterator])}function Jf(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function m$(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Xf=m$();function Zf(n){return pe(n?.[Xf])}function ep(n){return SR(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Io(t.read());if(i)return yield Io(void 0);yield yield Io(r)}}finally{t.releaseLock()}})}function tp(n){return pe(n?.getReader)}function Ht(n){if(n instanceof je)return n;if(n!=null){if(Qf(n))return g$(n);if(Wf(n))return _$(n);if(Kf(n))return y$(n);if(Yf(n))return AR(n);if(Zf(n))return v$(n);if(tp(n))return w$(n)}throw Jf(n)}function g$(n){return new je(e=>{let t=n[Ya]();if(pe(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function _$(n){return new je(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function y$(n){return new je(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Hf)})}function v$(n){return new je(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function AR(n){return new je(e=>{I$(n,e).catch(t=>e.error(t))})}function w$(n){return AR(ep(n))}function I$(n,e){var t,r,i,s;return TR(this,void 0,void 0,function*(){try{for(t=DR(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function Pn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function np(n,e=0){return Pe((t,r)=>{t.subscribe(ke(r,i=>Pn(r,n,()=>r.next(i),e),()=>Pn(r,n,()=>r.complete(),e),i=>Pn(r,n,()=>r.error(i),e)))})}function rp(n,e=0){return Pe((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function xR(n,e){return Ht(n).pipe(rp(e),np(e))}function RR(n,e){return Ht(n).pipe(rp(e),np(e))}function NR(n,e){return new je(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function PR(n,e){return new je(t=>{let r;return Pn(t,e,()=>{r=n[Xf](),Pn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>pe(r?.return)&&r.return()})}function ip(n,e){if(!n)throw new Error("Iterable cannot be null");return new je(t=>{Pn(t,e,()=>{let r=n[Symbol.asyncIterator]();Pn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function kR(n,e){return ip(ep(n),e)}function MR(n,e){if(n!=null){if(Qf(n))return xR(n,e);if(Wf(n))return NR(n,e);if(Kf(n))return RR(n,e);if(Yf(n))return ip(n,e);if(Zf(n))return PR(n,e);if(tp(n))return kR(n,e)}throw Jf(n)}function bt(n,e){return e?MR(n,e):Ht(n)}function de(...n){let e=us(n);return bt(n,e)}function Za(n,e){let t=pe(n)?n:()=>n,r=i=>i.error(t());return new je(e?i=>e.schedule(r,0,i):r)}function Mv(n){return!!n&&(n instanceof je||pe(n.lift)&&pe(n.subscribe))}var Fi=Ga(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Me(n,e){return Pe((t,r)=>{let i=0;t.subscribe(ke(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:E$}=Array;function b$(n,e){return E$(e)?n(...e):n(e)}function OR(n){return Me(e=>b$(n,e))}var{isArray:C$}=Array,{getPrototypeOf:T$,prototype:S$,keys:D$}=Object;function FR(n){if(n.length===1){let e=n[0];if(C$(e))return{args:e,keys:null};if(A$(e)){let t=D$(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function A$(n){return n&&typeof n=="object"&&T$(n)===S$}function LR(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Ru(...n){let e=us(n),t=bR(n),{args:r,keys:i}=FR(n);if(r.length===0)return bt([],e);let s=new je(x$(r,e,i?o=>LR(i,o):Gn));return t?s.pipe(OR(t)):s}function x$(n,e,t=Gn){return r=>{VR(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)VR(e,()=>{let l=bt(n[c],e),d=!1;l.subscribe(ke(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function VR(n,e,t){n?Pn(t,n,e):e()}function UR(n,e,t,r,i,s,o,a){let c=[],l=0,d=0,h=!1,p=()=>{h&&!c.length&&!l&&e.complete()},_=A=>l<r?E(A):c.push(A),E=A=>{s&&e.next(A),l++;let R=!1;Ht(t(A,d++)).subscribe(ke(e,L=>{i?.(L),s?_(L):e.next(L)},()=>{R=!0},void 0,()=>{if(R)try{for(l--;c.length&&l<r;){let L=c.shift();o?Pn(e,o,()=>E(L)):E(L)}p()}catch(L){e.error(L)}}))};return n.subscribe(ke(e,_,()=>{h=!0,p()})),()=>{a?.()}}function Rt(n,e,t=1/0){return pe(e)?Rt((r,i)=>Me((s,o)=>e(r,s,i,o))(Ht(n(r,i))),t):(typeof e=="number"&&(t=e),Pe((r,i)=>UR(r,i,n,t)))}function ec(n=1/0){return Rt(Gn,n)}function BR(){return ec(1)}function tc(...n){return BR()(bt(n,us(n)))}function sp(n){return new je(e=>{Ht(n()).subscribe(e)})}function or(n,e){return Pe((t,r)=>{let i=0;t.subscribe(ke(r,s=>n.call(e,s,i++)&&r.next(s)))})}function ds(n){return Pe((e,t)=>{let r=null,i=!1,s;r=e.subscribe(ke(t,void 0,void 0,o=>{s=Ht(n(o,ds(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function jR(n,e,t,r,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(ke(o,d=>{let h=l++;c=a?n(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function Eo(n,e){return pe(e)?Rt(n,e,1):Rt(n,1)}function hs(n){return Pe((e,t)=>{let r=!1;e.subscribe(ke(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Li(n){return n<=0?()=>Wn:Pe((e,t)=>{let r=0;e.subscribe(ke(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Ov(n){return Me(()=>n)}function op(n=R$){return Pe((e,t)=>{let r=!1;e.subscribe(ke(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function R$(){return new Fi}function Nu(n){return Pe((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Qr(n,e){let t=arguments.length>=2;return r=>r.pipe(n?or((i,s)=>n(i,s,r)):Gn,Li(1),t?hs(e):op(()=>new Fi))}function nc(n){return n<=0?()=>Wn:Pe((e,t)=>{let r=[];e.subscribe(ke(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Fv(n,e){let t=arguments.length>=2;return r=>r.pipe(n?or((i,s)=>n(i,s,r)):Gn,nc(1),t?hs(e):op(()=>new Fi))}function Lv(n,e){return Pe(jR(n,e,arguments.length>=2,!0))}function Vv(...n){let e=us(n);return Pe((t,r)=>{(e?tc(n,t,e):tc(n,t)).subscribe(r)})}function ar(n,e){return Pe((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(ke(r,c=>{i?.unsubscribe();let l=0,d=s++;Ht(n(c,d)).subscribe(i=ke(r,h=>r.next(e?e(c,h,d,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Uv(n){return Pe((e,t)=>{Ht(n).subscribe(ke(t,()=>t.complete(),xu)),!t.closed&&e.subscribe(t)})}function Xt(n,e,t){let r=pe(n)||e||t?{next:n,error:e,complete:t}:n;return r?Pe((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(ke(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Gn}var CN="https://g.co/ng/security#xss",ie=class extends Error{constructor(e,t){super(Fw(e,t)),this.code=e}};function Fw(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function Hu(n){return{toString:n}.toString()}var ap="__parameters__";function N$(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function TN(n,e,t){return Hu(()=>{let r=N$(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let h=c.hasOwnProperty(ap)?c[ap]:Object.defineProperty(c,ap,{value:[]})[ap];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var vn=globalThis;function Ye(n){for(let e in n)if(n[e]===Ye)return e;throw Error("Could not find renamed property on target object.")}function P$(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Mn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Mn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function $R(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var k$=Ye({__forward_ref__:Ye});function qu(n){return n.__forward_ref__=qu,n.toString=function(){return Mn(this())},n}function yn(n){return SN(n)?n():n}function SN(n){return typeof n=="function"&&n.hasOwnProperty(k$)&&n.__forward_ref__===qu}function oe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Fn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Bp(n){return HR(n,AN)||HR(n,xN)}function DN(n){return Bp(n)!==null}function HR(n,e){return n.hasOwnProperty(e)?n[e]:null}function M$(n){let e=n&&(n[AN]||n[xN]);return e||null}function qR(n){return n&&(n.hasOwnProperty(zR)||n.hasOwnProperty(O$))?n[zR]:null}var AN=Ye({\u0275prov:Ye}),zR=Ye({\u0275inj:Ye}),xN=Ye({ngInjectableDef:Ye}),O$=Ye({ngInjectorDef:Ye}),fe=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=oe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function RN(n){return n&&!!n.\u0275providers}var F$=Ye({\u0275cmp:Ye}),L$=Ye({\u0275dir:Ye}),V$=Ye({\u0275pipe:Ye}),U$=Ye({\u0275mod:Ye}),gp=Ye({\u0275fac:Ye}),Pu=Ye({__NG_ELEMENT_ID__:Ye}),GR=Ye({__NG_ENV_ID__:Ye});function qt(n){return typeof n=="string"?n:n==null?"":String(n)}function B$(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():qt(n)}function j$(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ie(-200,n)}function Lw(n,e){throw new ie(-201,!1)}var be=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(be||{}),Jv;function NN(){return Jv}function kn(n){let e=Jv;return Jv=n,e}function PN(n,e,t){let r=Bp(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&be.Optional)return null;if(e!==void 0)return e;Lw(n,"Injector")}var $$={},Mu=$$,Xv="__NG_DI_FLAG__",_p="ngTempTokenPath",H$="ngTokenPath",q$=/\n/gm,z$="\u0275",WR="__source",ac;function G$(){return ac}function fs(n){let e=ac;return ac=n,e}function W$(n,e=be.Default){if(ac===void 0)throw new ie(-203,!1);return ac===null?PN(n,void 0,e):ac.get(n,e&be.Optional?null:void 0,e)}function ae(n,e=be.Default){return(NN()||W$)(yn(n),e)}function J(n,e=be.Default){return ae(n,jp(e))}function jp(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Zv(n){let e=[];for(let t=0;t<n.length;t++){let r=yn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new ie(900,!1);let i,s=be.Default;for(let o=0;o<r.length;o++){let a=r[o],c=K$(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(ae(i,s))}else e.push(ae(r))}return e}function kN(n,e){return n[Xv]=e,n.prototype[Xv]=e,n}function K$(n){return n[Xv]}function Q$(n,e,t,r){let i=n[_p];throw e[WR]&&i.unshift(e[WR]),n.message=Y$(`
`+n.message,i,t,r),n[H$]=i,n[_p]=null,n}function Y$(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==z$?n.slice(2):n;let i=Mn(e);if(Array.isArray(e))i=e.map(Mn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Mn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(q$,`
  `)}`}var $p=kN(TN("Optional"),8);var Vw=kN(TN("SkipSelf"),4);function To(n,e){let t=n.hasOwnProperty(gp);return t?n[gp]:null}function Uw(n,e){n.forEach(t=>Array.isArray(t)?Uw(t,e):e(t))}function MN(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function yp(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var lc={},xr=[],uc=new fe(""),ON=new fe("",-1),FN=new fe(""),vp=class{get(e,t=Mu){if(t===Mu){let r=new Error(`NullInjectorError: No provider for ${Mn(e)}!`);throw r.name="NullInjectorError",r}return t}},LN=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(LN||{}),Xr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Xr||{}),lr=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(lr||{});function J$(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function ew(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];X$(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function VN(n){return n===3||n===4||n===6}function X$(n){return n.charCodeAt(0)===64}function Ou(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?KR(n,t,i,null,e[++r]):KR(n,t,i,null,null))}}return n}function KR(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var UN="ng-template";function Z$(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&J$(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Bw(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Bw(n){return n.type===4&&n.value!==UN}function eH(n,e,t){let r=n.type===4&&!t?UN:n.value;return e===r}function tH(n,e,t){let r=4,i=n.attrs,s=i!==null?iH(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Ar(r)&&!Ar(c))return!1;if(o&&Ar(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!eH(n,c,t)||c===""&&e.length===1){if(Ar(r))return!1;o=!0}}else if(r&8){if(i===null||!Z$(n,i,c,t)){if(Ar(r))return!1;o=!0}}else{let l=e[++a],d=nH(c,i,Bw(n),t);if(d===-1){if(Ar(r))return!1;o=!0;continue}if(l!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(Ar(r))return!1;o=!0}}}}return Ar(r)||o}function Ar(n){return(n&1)===0}function nH(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return sH(e,n)}function rH(n,e,t=!1){for(let r=0;r<e.length;r++)if(tH(n,e[r],t))return!0;return!1}function iH(n){for(let e=0;e<n.length;e++){let t=n[e];if(VN(t))return e}return n.length}function sH(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function QR(n,e){return n?":not("+e.trim()+")":e}function oH(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Ar(o)&&(e+=QR(s,i),i=""),r=o,s=s||!Ar(r);t++}return i!==""&&(e+=QR(s,i)),e}function aH(n){return n.map(oH).join(",")}function cH(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!Ar(i))break;i=s}r++}return{attrs:e,classes:t}}function xe(n){return Hu(()=>{let e=zN(n),t=lt(q({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===LN.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Xr.Emulated,styles:n.styles||xr,_:null,schemas:n.schemas||null,tView:null,id:""});GN(t);let r=n.dependencies;return t.directiveDefs=JR(r,!1),t.pipeDefs=JR(r,!0),t.id=dH(t),t})}function lH(n){return ms(n)||jN(n)}function uH(n){return n!==null}function Ln(n){return Hu(()=>({type:n.type,bootstrap:n.bootstrap||xr,declarations:n.declarations||xr,imports:n.imports||xr,exports:n.exports||xr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function YR(n,e){if(n==null)return lc;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=lr.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==lr.None?[r,a]:r,e[s]=o):t[s]=r}return t}function Kn(n){return Hu(()=>{let e=zN(n);return GN(e),e})}function BN(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function ms(n){return n[F$]||null}function jN(n){return n[L$]||null}function $N(n){return n[V$]||null}function HN(n){let e=ms(n)||jN(n)||$N(n);return e!==null?e.standalone:!1}function qN(n,e){let t=n[U$]||null;if(!t&&e===!0)throw new Error(`Type ${Mn(n)} does not have '\u0275mod' property.`);return t}function zN(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||lc,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||xr,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:YR(n.inputs,e),outputs:YR(n.outputs),debugInfo:null}}function GN(n){n.features?.forEach(e=>e(n))}function JR(n,e){if(!n)return null;let t=e?$N:lH;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(uH)}function dH(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function hH(...n){return{\u0275providers:WN(!0,n),\u0275fromNgModule:!0}}function WN(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return Uw(e,o=>{let a=o;tw(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&KN(i,s),t}function KN(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];jw(i,s=>{e(s,r)})}}function tw(n,e,t,r){if(n=yn(n),!n)return!1;let i=null,s=qR(n),o=!s&&ms(n);if(!s&&!o){let c=n.ngModule;if(s=qR(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)tw(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Uw(s.imports,d=>{tw(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&KN(l,e)}if(!a){let l=To(i)||(()=>new i);e({provide:i,useFactory:l,deps:xr},i),e({provide:FN,useValue:i,multi:!0},i),e({provide:uc,useValue:()=>ae(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;jw(c,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function jw(n,e){for(let t of n)RN(t)&&(t=t.\u0275providers),Array.isArray(t)?jw(t,e):e(t)}var fH=Ye({provide:String,useValue:Ye});function QN(n){return n!==null&&typeof n=="object"&&fH in n}function pH(n){return!!(n&&n.useExisting)}function mH(n){return!!(n&&n.useFactory)}function dc(n){return typeof n=="function"}function gH(n){return!!n.useClass}var Hp=new fe(""),dp={},_H={},Bv;function $w(){return Bv===void 0&&(Bv=new vp),Bv}var On=class{},Fu=class extends On{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,rw(e,o=>this.processProvider(o)),this.records.set(ON,rc(void 0,this)),i.has("environment")&&this.records.set(On,rc(void 0,this));let s=this.records.get(Hp);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(FN,xr,be.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Le(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Le(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=fs(this),r=kn(void 0),i;try{return e()}finally{fs(t),kn(r)}}get(e,t=Mu,r=be.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(GR))return e[GR](this);r=jp(r);let i,s=fs(this),o=kn(void 0);try{if(!(r&be.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=EH(e)&&Bp(e);l&&this.injectableDefInScope(l)?c=rc(nw(e),dp):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&be.Self?$w():this.parent;return t=r&be.Optional&&t===Mu?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[_p]=a[_p]||[]).unshift(Mn(e)),s)throw a;return Q$(a,e,"R3InjectorError",this.source)}else throw a}finally{kn(o),fs(s)}}resolveInjectorInitializers(){let e=Le(null),t=fs(this),r=kn(void 0),i;try{let s=this.get(uc,xr,be.Self);for(let o of s)o()}finally{fs(t),kn(r),Le(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Mn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ie(205,!1)}processProvider(e){e=yn(e);let t=dc(e)?e:yn(e&&e.provide),r=vH(e);if(!dc(e)&&e.multi===!0){let i=this.records.get(t);i||(i=rc(void 0,dp,!0),i.factory=()=>Zv(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Le(null);try{return t.value===dp&&(t.value=_H,t.value=t.factory()),typeof t.value=="object"&&t.value&&IH(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Le(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=yn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function nw(n){let e=Bp(n),t=e!==null?e.factory:To(n);if(t!==null)return t;if(n instanceof fe)throw new ie(204,!1);if(n instanceof Function)return yH(n);throw new ie(204,!1)}function yH(n){if(n.length>0)throw new ie(204,!1);let t=M$(n);return t!==null?()=>t.factory(n):()=>new n}function vH(n){if(QN(n))return rc(void 0,n.useValue);{let e=YN(n);return rc(e,dp)}}function YN(n,e,t){let r;if(dc(n)){let i=yn(n);return To(i)||nw(i)}else if(QN(n))r=()=>yn(n.useValue);else if(mH(n))r=()=>n.useFactory(...Zv(n.deps||[]));else if(pH(n))r=()=>ae(yn(n.useExisting));else{let i=yn(n&&(n.useClass||n.provide));if(wH(n))r=()=>new i(...Zv(n.deps));else return To(i)||nw(i)}return r}function rc(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function wH(n){return!!n.deps}function IH(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function EH(n){return typeof n=="function"||typeof n=="object"&&n instanceof fe}function rw(n,e){for(let t of n)Array.isArray(t)?rw(t,e):t&&RN(t)?rw(t.\u0275providers,e):e(t)}function Vi(n,e){n instanceof Fu&&n.assertNotDestroyed();let t,r=fs(n),i=kn(void 0);try{return e()}finally{fs(r),kn(i)}}function JN(){return NN()!==void 0||G$()!=null}function bH(n){if(!JN())throw new ie(-203,!1)}function CH(n){let e=vn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function TH(n){return typeof n=="function"}var Ui=0,Ae=1,he=2,ln=3,Rr=4,kr=5,wp=6,Lu=7,Nr=8,hc=9,Pr=10,Zt=11,Vu=12,XR=13,gc=14,Zr=15,qp=16,ic=17,fc=18,zp=19,XN=20,ps=21,jv=22,So=23,ei=25,ZN=1;var Do=7,Ip=8,Ep=9,cr=10,Hw=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Hw||{});function bo(n){return Array.isArray(n)&&typeof n[ZN]=="object"}function Bi(n){return Array.isArray(n)&&n[ZN]===!0}function eP(n){return(n.flags&4)!==0}function Gp(n){return n.componentOffset>-1}function qw(n){return(n.flags&1)===1}function gs(n){return!!n.template}function SH(n){return(n[he]&512)!==0}var iw=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function tP(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function _c(){return nP}function nP(n){return n.type.prototype.ngOnChanges&&(n.setInput=AH),DH}_c.ngInherit=!0;function DH(){let n=iP(this),e=n?.current;if(e){let t=n.previous;if(t===lc)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function AH(n,e,t,r,i){let s=this.declaredInputs[r],o=iP(n)||xH(n,{previous:lc,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new iw(l&&l.currentValue,t,c===lc),tP(n,e,i,t)}var rP="__ngSimpleChanges__";function iP(n){return n[rP]||null}function xH(n,e){return n[rP]=e}var ZR=null;var Yr=function(n,e,t){ZR?.(n,e,t)},RH="svg",NH="math",PH=!1;function kH(){return PH}function ti(n){for(;Array.isArray(n);)n=n[Ui];return n}function MH(n,e){return ti(e[n])}function ur(n,e){return ti(e[n.index])}function sP(n,e){return n.data[e]}function OH(n,e){return n[e]}function vs(n,e){let t=e[n];return bo(t)?t:t[Ui]}function zw(n){return(n[he]&128)===128}function FH(n){return Bi(n[ln])}function bp(n,e){return e==null?null:n[e]}function oP(n){n[ic]=0}function LH(n){n[he]&1024||(n[he]|=1024,zw(n)&&Uu(n))}function VH(n,e){for(;n>0;)e=e[gc],n--;return e}function Gw(n){return!!(n[he]&9216||n[So]?.dirty)}function sw(n){n[Pr].changeDetectionScheduler?.notify(1),Gw(n)?Uu(n):n[he]&64&&(kH()?(n[he]|=1024,Uu(n)):n[Pr].changeDetectionScheduler?.notify())}function Uu(n){n[Pr].changeDetectionScheduler?.notify();let e=Bu(n);for(;e!==null&&!(e[he]&8192||(e[he]|=8192,!zw(e)));)e=Bu(e)}function aP(n,e){if((n[he]&256)===256)throw new ie(911,!1);n[ps]===null&&(n[ps]=[]),n[ps].push(e)}function UH(n,e){if(n[ps]===null)return;let t=n[ps].indexOf(e);t!==-1&&n[ps].splice(t,1)}function Bu(n){let e=n[ln];return Bi(e)?e[ln]:e}var Te={lFrame:pP(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function BH(){return Te.lFrame.elementDepthCount}function jH(){Te.lFrame.elementDepthCount++}function $H(){Te.lFrame.elementDepthCount--}function cP(){return Te.bindingsEnabled}function HH(){return Te.skipHydrationRootTNode!==null}function qH(n){return Te.skipHydrationRootTNode===n}function zH(){Te.skipHydrationRootTNode=null}function qe(){return Te.lFrame.lView}function dr(){return Te.lFrame.tView}function ze(n){return Te.lFrame.contextLView=n,n[Nr]}function Ge(n){return Te.lFrame.contextLView=null,n}function Qn(){let n=lP();for(;n!==null&&n.type===64;)n=n.parent;return n}function lP(){return Te.lFrame.currentTNode}function GH(){let n=Te.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function zu(n,e){let t=Te.lFrame;t.currentTNode=n,t.isParent=e}function uP(){return Te.lFrame.isParent}function WH(){Te.lFrame.isParent=!1}function KH(){let n=Te.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Wp(){return Te.lFrame.bindingIndex}function QH(n){return Te.lFrame.bindingIndex=n}function Ww(){return Te.lFrame.bindingIndex++}function Kp(n){let e=Te.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function YH(){return Te.lFrame.inI18n}function JH(n,e){let t=Te.lFrame;t.bindingIndex=t.bindingRootIndex=n,ow(e)}function XH(){return Te.lFrame.currentDirectiveIndex}function ow(n){Te.lFrame.currentDirectiveIndex=n}function dP(n){Te.lFrame.currentQueryIndex=n}function ZH(n){let e=n[Ae];return e.type===2?e.declTNode:e.type===1?n[kr]:null}function hP(n,e,t){if(t&be.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&be.Host);)if(i=ZH(s),i===null||(s=s[gc],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=Te.lFrame=fP();return r.currentTNode=e,r.lView=n,!0}function Kw(n){let e=fP(),t=n[Ae];Te.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function fP(){let n=Te.lFrame,e=n===null?null:n.child;return e===null?pP(n):e}function pP(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function mP(){let n=Te.lFrame;return Te.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var gP=mP;function Qw(){let n=mP();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function e3(n){return(Te.lFrame.contextLView=VH(n,Te.lFrame.contextLView))[Nr]}function Po(){return Te.lFrame.selectedIndex}function Ao(n){Te.lFrame.selectedIndex=n}function Yw(){let n=Te.lFrame;return sP(n.tView,n.selectedIndex)}function t3(){return Te.lFrame.currentNamespace}var _P=!0;function Jw(){return _P}function Xw(n){_P=n}function n3(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=nP(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function Zw(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function hp(n,e,t){yP(n,e,3,t)}function fp(n,e,t,r){(n[he]&3)===t&&yP(n,e,t,r)}function $v(n,e){let t=n[he];(t&3)===e&&(t&=16383,t+=1,n[he]=t)}function yP(n,e,t,r){let i=r!==void 0?n[ic]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[ic]+=65536),(a<s||s==-1)&&(r3(n,t,e,c),n[ic]=(n[ic]&4294901760)+c+2),c++}function eN(n,e){Yr(4,n,e);let t=Le(null);try{e.call(n)}finally{Le(t),Yr(5,n,e)}}function r3(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[he]>>14<n[ic]>>16&&(n[he]&3)===e&&(n[he]+=16384,eN(a,s)):eN(a,s)}var cc=-1,xo=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function i3(n){return n instanceof xo}function s3(n){return(n.flags&8)!==0}function o3(n){return(n.flags&16)!==0}function vP(n){return n!==cc}function Cp(n){return n&32767}function a3(n){return n>>16}function Tp(n,e){let t=a3(n),r=e;for(;t>0;)r=r[gc],t--;return r}var aw=!0;function Sp(n){let e=aw;return aw=n,e}var c3=256,wP=c3-1,IP=5,l3=0,Jr={};function u3(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Pu)&&(r=t[Pu]),r==null&&(r=t[Pu]=l3++);let i=r&wP,s=1<<i;e.data[n+(i>>IP)]|=s}function Dp(n,e){let t=EP(n,e);if(t!==-1)return t;let r=e[Ae];r.firstCreatePass&&(n.injectorIndex=e.length,Hv(r.data,n),Hv(e,null),Hv(r.blueprint,null));let i=eI(n,e),s=n.injectorIndex;if(vP(i)){let o=Cp(i),a=Tp(i,e),c=a[Ae].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function Hv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function EP(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function eI(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=DP(i),r===null)return cc;if(t++,i=i[gc],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return cc}function cw(n,e,t){u3(n,e,t)}function d3(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(VN(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function bP(n,e,t){if(t&be.Optional||n!==void 0)return n;Lw(e,"NodeInjector")}function CP(n,e,t,r){if(t&be.Optional&&r===void 0&&(r=null),!(t&(be.Self|be.Host))){let i=n[hc],s=kn(void 0);try{return i?i.get(e,r,t&be.Optional):PN(e,r,t&be.Optional)}finally{kn(s)}}return bP(r,e,t)}function TP(n,e,t,r=be.Default,i){if(n!==null){if(e[he]&2048&&!(r&be.Self)){let o=g3(n,e,t,r,Jr);if(o!==Jr)return o}let s=SP(n,e,t,r,Jr);if(s!==Jr)return s}return CP(e,t,r,i)}function SP(n,e,t,r,i){let s=p3(t);if(typeof s=="function"){if(!hP(e,n,r))return r&be.Host?bP(i,t,r):CP(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&be.Optional))Lw(t);else return o}finally{gP()}}else if(typeof s=="number"){let o=null,a=EP(n,e),c=cc,l=r&be.Host?e[Zr][kr]:null;for((a===-1||r&be.SkipSelf)&&(c=a===-1?eI(n,e):e[a+8],c===cc||!nN(r,!1)?a=-1:(o=e[Ae],a=Cp(c),e=Tp(c,e)));a!==-1;){let d=e[Ae];if(tN(s,a,d.data)){let h=h3(a,e,t,o,r,l);if(h!==Jr)return h}c=e[a+8],c!==cc&&nN(r,e[Ae].data[a+8]===l)&&tN(s,a,e)?(o=d,a=Cp(c),e=Tp(c,e)):a=-1}}return i}function h3(n,e,t,r,i,s){let o=e[Ae],a=o.data[n+8],c=r==null?Gp(a)&&aw:r!=o&&(a.type&3)!==0,l=i&be.Host&&s===a,d=f3(a,o,t,c,l);return d!==null?pc(e,o,d,a):Jr}function f3(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,d=s>>20,h=r?a:a+d,p=i?a+d:l;for(let _=h;_<p;_++){let E=o[_];if(_<c&&t===E||_>=c&&E.type===t)return _}if(i){let _=o[c];if(_&&gs(_)&&_.type===t)return c}return null}function pc(n,e,t,r){let i=n[t],s=e.data;if(i3(i)){let o=i;o.resolving&&j$(B$(s[t]));let a=Sp(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?kn(o.injectImpl):null,d=hP(n,r,be.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&n3(t,s[t],e)}finally{l!==null&&kn(l),Sp(a),o.resolving=!1,gP()}}return i}function p3(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Pu)?n[Pu]:void 0;return typeof e=="number"?e>=0?e&wP:m3:e}function tN(n,e,t){let r=1<<n;return!!(t[e+(n>>IP)]&r)}function nN(n,e){return!(n&be.Self)&&!(n&be.Host&&e)}var Co=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return TP(this._tNode,this._lView,e,jp(r),t)}};function m3(){return new Co(Qn(),qe())}function ko(n){return Hu(()=>{let e=n.prototype.constructor,t=e[gp]||lw(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[gp]||lw(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function lw(n){return SN(n)?()=>{let e=lw(yn(n));return e&&e()}:To(n)}function g3(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[he]&2048&&!(o[he]&512);){let a=SP(s,o,t,r|be.Self,Jr);if(a!==Jr)return a;let c=s.parent;if(!c){let l=o[XN];if(l){let d=l.get(t,Jr,r);if(d!==Jr)return d}c=DP(o),o=o[gc]}s=c}return i}function DP(n){let e=n[Ae],t=e.type;return t===2?e.declTNode:t===1?n[kr]:null}function tI(n){return d3(Qn(),n)}function rN(n,e=null,t=null,r){let i=AP(n,e,t,r);return i.resolveInjectorInitializers(),i}function AP(n,e=null,t=null,r,i=new Set){let s=[t||xr,hH(n)];return r=r||(typeof n=="object"?void 0:Mn(n)),new Fu(s,e||$w(),r||null,i)}var Mr=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return rN({name:""},i,r,"");{let s=r.name??"";return rN({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Mu,e.NULL=new vp,e.\u0275prov=oe({token:e,providedIn:"any",factory:()=>ae(ON)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var _3="ngOriginalError";function qv(n){return n[_3]}var ni=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&qv(e);for(;t&&qv(t);)t=qv(t);return t||null}},xP=new fe("",{providedIn:"root",factory:()=>J(ni).handleError.bind(void 0)}),nI=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=y3,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),uw=class extends nI{constructor(e){super(),this._lView=e}onDestroy(e){return aP(this._lView,e),()=>UH(this._lView,e)}};function y3(){return new uw(qe())}function v3(){return Qp(Qn(),qe())}function Qp(n,e){return new ji(ur(n,e))}var ji=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=v3;let n=e;return n})();var dw=class extends an{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,JN()&&(this.destroyRef=J(nI,{optional:!0})??void 0)}emit(e){let t=Le(null);try{super.next(e)}finally{Le(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=zv(s),i&&(i=zv(i)),o&&(o=zv(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Bt&&e.add(a),a}};function zv(n){return e=>{setTimeout(n,void 0,e)}}var cn=dw;function RP(n){return(n.flags&128)===128}var NP=new Map,w3=0;function I3(){return w3++}function E3(n){NP.set(n[zp],n)}function b3(n){NP.delete(n[zp])}var iN="__ngContext__";function Ro(n,e){bo(e)?(n[iN]=e[zp],E3(e)):n[iN]=e}function PP(n){return MP(n[Vu])}function kP(n){return MP(n[Rr])}function MP(n){for(;n!==null&&!Bi(n);)n=n[Rr];return n}var hw;function OP(n){hw=n}function C3(){if(hw!==void 0)return hw;if(typeof document<"u")return document;throw new ie(210,!1)}var Yp=new fe("",{providedIn:"root",factory:()=>T3}),T3="ng",rI=new fe(""),ws=new fe("",{providedIn:"platform",factory:()=>"unknown"});var iI=new fe("",{providedIn:"root",factory:()=>C3().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var S3="h",D3="b";var A3=()=>null;function sI(n,e,t=!1){return A3(n,e,t)}var FP=!1,x3=new fe("",{providedIn:"root",factory:()=>FP});var cp;function R3(){if(cp===void 0&&(cp=null,vn.trustedTypes))try{cp=vn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return cp}function sN(n){return R3()?.createScriptURL(n)||n}var Ap=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${CN})`}};function Jp(n){return n instanceof Ap?n.changingThisBreaksApplicationSecurity:n}function oI(n,e){let t=N3(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${CN})`)}return t===e}function N3(n){return n instanceof Ap&&n.getTypeName()||null}var P3=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function LP(n){return n=String(n),n.match(P3)?n:"unsafe:"+n}var Xp=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Xp||{});function yc(n){let e=UP();return e?e.sanitize(Xp.URL,n)||"":oI(n,"URL")?Jp(n):LP(qt(n))}function k3(n){let e=UP();if(e)return sN(e.sanitize(Xp.RESOURCE_URL,n)||"");if(oI(n,"ResourceURL"))return sN(Jp(n));throw new ie(904,!1)}function M3(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?k3:yc}function VP(n,e,t){return M3(e,t)(n)}function UP(){let n=qe();return n&&n[Pr].sanitizer}function BP(n){return n instanceof Function?n():n}function O3(n){return(n??J(Mr)).get(ws)==="browser"}var Mo=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Mo||{}),F3;function aI(n,e){return F3(n,e)}function sc(n,e,t,r,i){if(r!=null){let s,o=!1;Bi(r)?s=r:bo(r)&&(o=!0,r=r[Ui]);let a=ti(r);n===0&&t!==null?i==null?zP(e,t,a):xp(e,t,a,i||null,!0):n===1&&t!==null?xp(e,t,a,i||null,!0):n===2?Z3(e,a,o):n===3&&e.destroyNode(a),s!=null&&t4(e,n,s,t,i)}}function L3(n,e){return n.createText(e)}function V3(n,e,t){n.setValue(e,t)}function jP(n,e,t){return n.createElement(e,t)}function U3(n,e){$P(n,e),e[Ui]=null,e[kr]=null}function B3(n,e,t,r,i,s){r[Ui]=i,r[kr]=e,Zp(n,r,t,1,i,s)}function $P(n,e){e[Pr].changeDetectionScheduler?.notify(1),Zp(n,e,e[Zt],2,null,null)}function j3(n){let e=n[Vu];if(!e)return Gv(n[Ae],n);for(;e;){let t=null;if(bo(e))t=e[Vu];else{let r=e[cr];r&&(t=r)}if(!t){for(;e&&!e[Rr]&&e!==n;)bo(e)&&Gv(e[Ae],e),e=e[ln];e===null&&(e=n),bo(e)&&Gv(e[Ae],e),t=e&&e[Rr]}e=t}}function $3(n,e,t,r){let i=cr+r,s=t.length;r>0&&(t[i-1][Rr]=e),r<s-cr?(e[Rr]=t[i],MN(t,cr+r,e)):(t.push(e),e[Rr]=null),e[ln]=t;let o=e[qp];o!==null&&t!==o&&H3(o,e);let a=e[fc];a!==null&&a.insertView(n),sw(e),e[he]|=128}function H3(n,e){let t=n[Ep],i=e[ln][ln][Zr];e[Zr]!==i&&(n[he]|=Hw.HasTransplantedViews),t===null?n[Ep]=[e]:t.push(e)}function HP(n,e){let t=n[Ep],r=t.indexOf(e);t.splice(r,1)}function fw(n,e){if(n.length<=cr)return;let t=cr+e,r=n[t];if(r){let i=r[qp];i!==null&&i!==n&&HP(i,r),e>0&&(n[t-1][Rr]=r[Rr]);let s=yp(n,cr+e);U3(r[Ae],r);let o=s[fc];o!==null&&o.detachView(s[Ae]),r[ln]=null,r[Rr]=null,r[he]&=-129}return r}function qP(n,e){if(!(e[he]&256)){let t=e[Zt];t.destroyNode&&Zp(n,e,t,3,null,null),j3(e)}}function Gv(n,e){if(e[he]&256)return;let t=Le(null);try{e[he]&=-129,e[he]|=256,e[So]&&hR(e[So]),z3(n,e),q3(n,e),e[Ae].type===1&&e[Zt].destroy();let r=e[qp];if(r!==null&&Bi(e[ln])){r!==e[ln]&&HP(r,e);let i=e[fc];i!==null&&i.detachView(n)}b3(e)}finally{Le(t)}}function q3(n,e){let t=n.cleanup,r=e[Lu];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[Lu]=null);let i=e[ps];if(i!==null){e[ps]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function z3(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof xo)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Yr(4,a,c);try{c.call(a)}finally{Yr(5,a,c)}}else{Yr(4,i,s);try{s.call(i)}finally{Yr(5,i,s)}}}}}function G3(n,e,t){return W3(n,e.parent,t)}function W3(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[Ui];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===Xr.None||s===Xr.Emulated)return null}return ur(r,t)}}function xp(n,e,t,r,i){n.insertBefore(e,t,r,i)}function zP(n,e,t){n.appendChild(e,t)}function oN(n,e,t,r,i){r!==null?xp(n,e,t,r,i):zP(n,e,t)}function K3(n,e,t,r){n.removeChild(e,t,r)}function cI(n,e){return n.parentNode(e)}function Q3(n,e){return n.nextSibling(e)}function Y3(n,e,t){return X3(n,e,t)}function J3(n,e,t){return n.type&40?ur(n,t):null}var X3=J3,aN;function lI(n,e,t,r){let i=G3(n,r,e),s=e[Zt],o=r.parent||e[kr],a=Y3(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)oN(s,i,t[c],a,!1);else oN(s,i,t,a,!1);aN!==void 0&&aN(s,r,e,t,i)}function pp(n,e){if(e!==null){let t=e.type;if(t&3)return ur(e,n);if(t&4)return pw(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return pp(n,r);{let i=n[e.index];return Bi(i)?pw(-1,i):ti(i)}}else{if(t&32)return aI(e,n)()||ti(n[e.index]);{let r=GP(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Bu(n[Zr]);return pp(i,r)}else return pp(n,e.next)}}}return null}function GP(n,e){if(e!==null){let r=n[Zr][kr],i=e.projection;return r.projection[i]}return null}function pw(n,e){let t=cr+n+1;if(t<e.length){let r=e[t],i=r[Ae].firstChild;if(i!==null)return pp(r,i)}return e[Do]}function Z3(n,e,t){let r=cI(n,e);r&&K3(n,r,e,t)}function uI(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&e===0&&(a&&Ro(ti(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)uI(n,e,t.child,r,i,s,!1),sc(e,n,i,a,s);else if(c&32){let l=aI(t,r),d;for(;d=l();)sc(e,n,i,d,s);sc(e,n,i,a,s)}else c&16?e4(n,e,r,t,i,s):sc(e,n,i,a,s);t=o?t.projectionNext:t.next}}function Zp(n,e,t,r,i,s){uI(t,r,n.firstChild,e,i,s,!1)}function e4(n,e,t,r,i,s){let o=t[Zr],c=o[kr].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];sc(e,n,i,d,s)}else{let l=c,d=o[ln];RP(r)&&(l.flags|=128),uI(n,e,l,d,i,s,!0)}}function t4(n,e,t,r,i){let s=t[Do],o=ti(t);s!==o&&sc(e,n,r,s,i);for(let a=cr;a<t.length;a++){let c=t[a];Zp(c[Ae],c,n,e,r,s)}}function n4(n,e,t){n.setAttribute(e,"style",t)}function WP(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function KP(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&ew(n,e,r),i!==null&&WP(n,e,i),s!==null&&n4(n,e,s)}var Vn={};function X(n=1){QP(dr(),qe(),Po()+n,!1)}function QP(n,e,t,r){if(!r)if((e[he]&3)===3){let s=n.preOrderCheckHooks;s!==null&&hp(e,s,t)}else{let s=n.preOrderHooks;s!==null&&fp(e,s,0,t)}Ao(t)}function te(n,e=be.Default){let t=qe();if(t===null)return ae(n,e);let r=Qn();return TP(r,t,yn(n),e)}function YP(){let n="invalid";throw new Error(n)}function JP(n,e,t,r,i,s){let o=Le(null);try{let a=null;i&lr.SignalBased&&(a=e[r][cR]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&lr.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):tP(e,a,r,s)}finally{Le(o)}}function r4(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Ao(~i);else{let s=i,o=t[++r],a=t[++r];JH(o,s);let c=e[s];a(2,c)}}}finally{Ao(-1)}}function em(n,e,t,r,i,s,o,a,c,l,d){let h=e.blueprint.slice();return h[Ui]=i,h[he]=r|4|128|8|64,(l!==null||n&&n[he]&2048)&&(h[he]|=2048),oP(h),h[ln]=h[gc]=n,h[Nr]=t,h[Pr]=o||n&&n[Pr],h[Zt]=a||n&&n[Zt],h[hc]=c||n&&n[hc]||null,h[kr]=s,h[zp]=I3(),h[wp]=d,h[XN]=l,h[Zr]=e.type==2?n[Zr]:h,h}function tm(n,e,t,r,i){let s=n.data[e];if(s===null)s=i4(n,e,t,r,i),YH()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=GH();s.injectorIndex=o===null?-1:o.injectorIndex}return zu(s,!0),s}function i4(n,e,t,r,i){let s=lP(),o=uP(),a=o?s:s&&s.parent,c=n.data[e]=l4(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function XP(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function ZP(n,e,t,r,i){let s=Po(),o=r&2;try{Ao(-1),o&&e.length>ei&&QP(n,e,ei,!1),Yr(o?2:0,i),t(r,i)}finally{Ao(s),Yr(o?3:1,i)}}function ek(n,e,t){if(eP(e)){let r=Le(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Le(r)}}}function tk(n,e,t){cP()&&(m4(n,e,t,ur(t,e)),(t.flags&64)===64&&ak(n,e,t))}function nk(n,e,t=ur){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function rk(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=dI(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function dI(n,e,t,r,i,s,o,a,c,l,d){let h=ei+r,p=h+i,_=s4(h,p),E=typeof l=="function"?l():l;return _[Ae]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:E,incompleteFirstPass:!1,ssrId:d}}function s4(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Vn);return t}function o4(n,e,t,r){let s=r.get(x3,FP)||t===Xr.ShadowDom,o=n.selectRootElement(e,s);return a4(o),o}function a4(n){c4(n)}var c4=()=>null;function l4(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return HH()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function cN(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=lr.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?lN(r,t,l,a,c):lN(r,t,l,a)}return r}function lN(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function u4(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,l=null;for(let d=r;d<i;d++){let h=s[d],p=t?t.get(h):null,_=p?p.inputs:null,E=p?p.outputs:null;c=cN(0,h.inputs,d,c,_),l=cN(1,h.outputs,d,l,E);let A=c!==null&&o!==null&&!Bw(e)?S4(c,d,o):null;a.push(A)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function d4(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function ik(n,e,t,r,i,s,o,a){let c=ur(e,t),l=e.inputs,d;!a&&l!=null&&(d=l[r])?(hI(n,t,d,r,i),Gp(e)&&h4(t,e.index)):e.type&3?(r=d4(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function h4(n,e){let t=vs(e,n);t[he]&16||(t[he]|=64)}function sk(n,e,t,r){if(cP()){let i=r===null?null:{"":-1},s=_4(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&ok(n,e,t,o,i,a),i&&y4(t,r,i)}t.mergedAttrs=Ou(t.mergedAttrs,t.attrs)}function ok(n,e,t,r,i,s){for(let l=0;l<r.length;l++)cw(Dp(t,e),n,r[l].type);w4(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=XP(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=Ou(t.mergedAttrs,d.hostAttrs),I4(n,t,e,c,d),v4(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}u4(n,t,s)}function f4(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;p4(o)!=a&&o.push(a),o.push(t,r,s)}}function p4(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function m4(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;Gp(t)&&E4(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Dp(t,e),Ro(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],l=pc(e,n,a,t);if(Ro(l,e),o!==null&&T4(e,a-i,l,c,t,o),gs(c)){let d=vs(t.index,e);d[Nr]=pc(e,n,a,t)}}}function ak(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=XH();try{Ao(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];ow(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&g4(c,l)}}finally{Ao(-1),ow(o)}}function g4(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function _4(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(rH(e,o.selectors,!1))if(r||(r=[]),gs(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;mw(n,e,c)}else r.unshift(o),mw(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function mw(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function y4(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new ie(-301,!1);r.push(e[i],s)}}}function v4(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;gs(e)&&(t[""]=n)}}function w4(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function I4(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=To(i.type,!0)),o=new xo(s,gs(i),te);n.blueprint[r]=o,t[r]=o,f4(n,e,r,XP(n,t,i.hostVars,Vn),i)}function E4(n,e,t){let r=ur(e,n),i=rk(t),s=n[Pr].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=nm(n,em(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function b4(n,e,t,r,i,s){let o=ur(n,e);C4(e[Zt],o,s,n.value,t,r,i)}function C4(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?qt(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function T4(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],d=o[a++],h=o[a++];JP(r,t,c,l,d,h)}}function S4(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function ck(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function lk(n,e){let t=n.contentQueries;if(t!==null){let r=Le(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];dP(s),a.contentQueries(2,e[o],o)}}}finally{Le(r)}}}function nm(n,e){return n[Vu]?n[XR][Rr]=e:n[Vu]=e,n[XR]=e,e}function gw(n,e,t){dP(0);let r=Le(null);try{e(n,t)}finally{Le(r)}}function D4(n){return n[Lu]||(n[Lu]=[])}function A4(n){return n.cleanup||(n.cleanup=[])}function uk(n,e){let t=n[hc],r=t?t.get(ni,null):null;r&&r.handleError(e)}function hI(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],d=n.data[o];JP(d,l,r,a,c,i)}}function Gu(n,e,t){let r=MH(e,n);V3(n[Zt],r,t)}function x4(n,e){let t=vs(e,n),r=t[Ae];R4(r,t);let i=t[Ui];i!==null&&t[wp]===null&&(t[wp]=sI(i,t[hc])),fI(r,t,t[Nr])}function R4(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function fI(n,e,t){Kw(e);try{let r=n.viewQuery;r!==null&&gw(1,r,t);let i=n.template;i!==null&&ZP(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[fc]?.finishViewCreation(n),n.staticContentQueries&&lk(n,e),n.staticViewQueries&&gw(2,n.viewQuery,t);let s=n.components;s!==null&&N4(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[he]&=-5,Qw()}}function N4(n,e){for(let t=0;t<e.length;t++)x4(n,e[t])}function P4(n,e,t,r){let i=Le(null);try{let s=e.tView,a=n[he]&4096?4096:16,c=em(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[qp]=l;let d=n[fc];return d!==null&&(c[fc]=d.createEmbeddedView(s)),fI(s,c,t),c}finally{Le(i)}}function uN(n,e){return!e||e.firstChild===null||RP(n)}function k4(n,e,t,r=!0){let i=e[Ae];if($3(i,e,n,t),r){let o=pw(t,n),a=e[Zt],c=cI(a,n[Do]);c!==null&&B3(i,n[kr],a,e,c,o)}let s=e[wp];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Rp(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(ti(s)),Bi(s)&&M4(s,r);let o=t.type;if(o&8)Rp(n,e,t.child,r);else if(o&32){let a=aI(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=GP(e,t);if(Array.isArray(a))r.push(...a);else{let c=Bu(e[Zr]);Rp(c[Ae],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function M4(n,e){for(let t=cr;t<n.length;t++){let r=n[t],i=r[Ae].firstChild;i!==null&&Rp(r[Ae],r,i,e)}n[Do]!==n[Ui]&&e.push(n[Do])}var dk=[];function O4(n){return n[So]??F4(n)}function F4(n){let e=dk.pop()??Object.create(V4);return e.lView=n,e}function L4(n){n.lView[So]!==n&&(n.lView=null,dk.push(n))}var V4=lt(q({},lR),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Uu(n.lView)},consumerOnSignalRead(){this.lView[So]=this}}),hk=100;function fk(n,e=!0,t=0){let r=n[Pr],i=r.rendererFactory,s=!1;s||i.begin?.();try{U4(n,t)}catch(o){throw e&&uk(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function U4(n,e){_w(n,e);let t=0;for(;Gw(n);){if(t===hk)throw new ie(103,!1);t++,_w(n,1)}}function B4(n,e,t,r){let i=e[he];if((i&256)===256)return;let s=!1;!s&&e[Pr].inlineEffectRunner?.flush(),Kw(e);let o=null,a=null;!s&&j4(n)&&(a=O4(e),o=uR(a));try{oP(e),QH(n.bindingStartIndex),t!==null&&ZP(n,e,t,2,r);let c=(i&3)===3;if(!s)if(c){let h=n.preOrderCheckHooks;h!==null&&hp(e,h,null)}else{let h=n.preOrderHooks;h!==null&&fp(e,h,0,null),$v(e,0)}if($4(e),pk(e,0),n.contentQueries!==null&&lk(n,e),!s)if(c){let h=n.contentCheckHooks;h!==null&&hp(e,h)}else{let h=n.contentHooks;h!==null&&fp(e,h,1),$v(e,1)}r4(n,e);let l=n.components;l!==null&&gk(e,l,0);let d=n.viewQuery;if(d!==null&&gw(2,d,r),!s)if(c){let h=n.viewCheckHooks;h!==null&&hp(e,h)}else{let h=n.viewHooks;h!==null&&fp(e,h,2),$v(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[jv]){for(let h of e[jv])h();e[jv]=null}s||(e[he]&=-73)}catch(c){throw Uu(e),c}finally{a!==null&&(dR(a,o),L4(a)),Qw()}}function j4(n){return n.type!==2}function pk(n,e){for(let t=PP(n);t!==null;t=kP(t))for(let r=cr;r<t.length;r++){let i=t[r];mk(i,e)}}function $4(n){for(let e=PP(n);e!==null;e=kP(e)){if(!(e[he]&Hw.HasTransplantedViews))continue;let t=e[Ep];for(let r=0;r<t.length;r++){let i=t[r],s=i[ln];LH(i)}}}function H4(n,e,t){let r=vs(e,n);mk(r,t)}function mk(n,e){zw(n)&&_w(n,e)}function _w(n,e){let r=n[Ae],i=n[he],s=n[So],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Ev(s)),s&&(s.dirty=!1),n[he]&=-9217,o)B4(r,n,r.template,n[Nr]);else if(i&8192){pk(n,1);let a=r.components;a!==null&&gk(n,a,1)}}function gk(n,e,t){for(let r=0;r<e.length;r++)H4(n,e[r],t)}function pI(n){for(n[Pr].changeDetectionScheduler?.notify();n;){n[he]|=64;let e=Bu(n);if(SH(n)&&!e)return n;n=e}return null}var No=class{get rootNodes(){let e=this._lView,t=e[Ae];return Rp(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Nr]}set context(e){this._lView[Nr]=e}get destroyed(){return(this._lView[he]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[ln];if(Bi(e)){let t=e[Ip],r=t?t.indexOf(this):-1;r>-1&&(fw(e,r),yp(t,r))}this._attachedToViewContainer=!1}qP(this._lView[Ae],this._lView)}onDestroy(e){aP(this._lView,e)}markForCheck(){pI(this._cdRefInjectingView||this._lView)}detach(){this._lView[he]&=-129}reattach(){sw(this._lView),this._lView[he]|=128}detectChanges(){this._lView[he]|=1024,fk(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ie(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,$P(this._lView[Ae],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ie(902,!1);this._appRef=e,sw(this._lView)}},rm=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=G4;let n=e;return n})(),q4=rm,z4=class extends q4{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=P4(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new No(i)}};function G4(){return W4(Qn(),qe())}function W4(n,e){return n.type&4?new z4(e,n,Qp(n,e)):null}var yoe=new RegExp(`^(\\d+)*(${D3}|${S3})*(.*)`);var K4=()=>null;function dN(n,e){return K4(n,e)}var Np=class{},yw=class{},Pp=class{};function Q4(n){let e=Error(`No component factory found for ${Mn(n)}.`);return e[Y4]=n,e}var Y4="ngComponent";var vw=class{resolveComponentFactory(e){throw Q4(e)}},im=(()=>{let e=class e{};e.NULL=new vw;let n=e;return n})(),ju=class{},Is=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>J4();let n=e;return n})();function J4(){let n=qe(),e=Qn(),t=vs(e.index,n);return(bo(t)?t:n)[Zt]}var X4=(()=>{let e=class e{};e.\u0275prov=oe({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),Wv={};var hN=new Set;function mI(n){hN.has(n)||(hN.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function fN(...n){}function Z4(){let n=typeof vn.requestAnimationFrame=="function",e=vn[n?"requestAnimationFrame":"setTimeout"],t=vn[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var et=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new cn(!1),this.onMicrotaskEmpty=new cn(!1),this.onStable=new cn(!1),this.onError=new cn(!1),typeof Zone>"u")throw new ie(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=Z4().nativeRequestAnimationFrame,nq(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ie(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ie(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,eq,fN,fN);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},eq={};function gI(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function tq(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(vn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,ww(n),n.isCheckStableRunning=!0,gI(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),ww(n))}function nq(n){let e=()=>{tq(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(rq(a))return t.invokeTask(i,s,o,a);try{return pN(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),mN(n)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return pN(n),t.invoke(i,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),mN(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,ww(n),gI(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function ww(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function pN(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function mN(n){n._nesting--,gI(n)}var Iw=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new cn,this.onMicrotaskEmpty=new cn,this.onStable=new cn,this.onError=new cn}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function rq(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}function iq(n="zone.js",e){return n==="noop"?new Iw:n==="zone.js"?new et(e):n}var oc=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(oc||{}),sq={destroy(){}};function sm(n,e){!e&&bH(sm);let t=e?.injector??J(Mr);if(!O3(t))return sq;mI("NgAfterNextRender");let r=t.get(_I),i=r.handler??=new bw,s=e?.phase??oc.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(nI).onDestroy(o),c=Vi(t,()=>new Ew(s,()=>{o(),n()}));return i.register(c),{destroy:o}}var Ew=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=J(et),this.errorHandler=J(ni,{optional:!0}),J(Np,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},bw=class{constructor(){this.executingCallbacks=!1,this.buckets={[oc.EarlyRead]:new Set,[oc.Write]:new Set,[oc.MixedReadWrite]:new Set,[oc.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},_I=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=oe({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function Cw(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=$R(i,a);else if(s==2){let c=a,l=e[++o];r=$R(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var kp=class extends im{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=ms(e);return new mc(t,this.ngModule)}};function gN(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function oq(n){let e=n.toLowerCase();return e==="svg"?RH:e==="math"?NH:null}var Tw=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=jp(r);let i=this.injector.get(e,Wv,r);return i!==Wv||t===Wv?i:this.parentInjector.get(e,t,r)}},mc=class extends Pp{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=gN(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return gN(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=aH(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Le(null);try{i=i||this.ngModule;let o=i instanceof On?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Tw(e,o):e,c=a.get(ju,null);if(c===null)throw new ie(407,!1);let l=a.get(X4,null),d=a.get(_I,null),h=a.get(Np,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},_=c.createRenderer(null,this.componentDef),E=this.componentDef.selectors[0][0]||"div",A=r?o4(_,r,this.componentDef.encapsulation,a):jP(_,E,oq(E)),R=512;this.componentDef.signals?R|=4096:this.componentDef.onPush||(R|=16);let L=null;A!==null&&(L=sI(A,a,!0));let Y=dI(0,null,null,1,0,null,null,null,null,null,null),j=em(null,Y,null,R,null,null,p,_,a,null,L);Kw(j);let Z,ue;try{let ne=this.componentDef,S,v=null;ne.findHostDirectiveDefs?(S=[],v=new Map,ne.findHostDirectiveDefs(ne,S,v),S.push(ne)):S=[ne];let b=aq(j,A),D=cq(b,A,ne,S,j,p,_);ue=sP(Y,ei),A&&dq(_,ne,A,r),t!==void 0&&hq(ue,this.ngContentSelectors,t),Z=uq(D,ne,S,v,j,[fq]),fI(Y,j,null)}finally{Qw()}return new Sw(this.componentType,Z,Qp(ue,j),j,ue)}finally{Le(s)}}},Sw=class extends yw{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new No(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;hI(s[Ae],s,i,e,t),this.previousInputValues.set(e,t);let o=vs(this._tNode.index,s);pI(o)}}get injector(){return new Co(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function aq(n,e){let t=n[Ae],r=ei;return n[r]=e,tm(t,r,2,"#host",null)}function cq(n,e,t,r,i,s,o){let a=i[Ae];lq(r,n,e,o);let c=null;e!==null&&(c=sI(e,i[hc]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=em(i,rk(t),null,d,i[n.index],n,s,l,null,null,c);return a.firstCreatePass&&mw(a,n,r.length-1),nm(i,h),i[n.index]=h}function lq(n,e,t,r){for(let i of n)e.mergedAttrs=Ou(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Cw(e,e.mergedAttrs,!0),t!==null&&KP(r,t,e))}function uq(n,e,t,r,i,s){let o=Qn(),a=i[Ae],c=ur(o,i);ok(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,p=pc(i,a,h,o);Ro(p,i)}ak(a,i,o),c&&Ro(c,i);let l=pc(i,a,o.directiveStart+o.componentOffset,o);if(n[Nr]=i[Nr]=l,s!==null)for(let d of s)d(l,e);return ek(a,o,i),l}function dq(n,e,t,r){if(r)ew(n,t,["ng-version","17.3.11"]);else{let{attrs:i,classes:s}=cH(e.selectors[0]);i&&ew(n,t,i),s&&s.length>0&&WP(n,t,s.join(" "))}}function hq(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function fq(){let n=Qn();Zw(qe()[Ae],n)}var vc=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=pq;let n=e;return n})();function pq(){let n=Qn();return gq(n,qe())}var mq=vc,_k=class extends mq{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Qp(this._hostTNode,this._hostLView)}get injector(){return new Co(this._hostTNode,this._hostLView)}get parentInjector(){let e=eI(this._hostTNode,this._hostLView);if(vP(e)){let t=Tp(e,this._hostLView),r=Cp(e),i=t[Ae].data[r+8];return new Co(i,t)}else return new Co(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=_N(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-cr}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=dN(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,uN(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!TH(e),a;if(o)a=t;else{let E=t||{};a=E.index,r=E.injector,i=E.projectableNodes,s=E.environmentInjector||E.ngModuleRef}let c=o?e:new mc(ms(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let A=(o?l:this.parentInjector).get(On,null);A&&(s=A)}let d=ms(c.componentType??{}),h=dN(this._lContainer,d?.id??null),p=h?.firstChild??null,_=c.create(l,i,p,s);return this.insertImpl(_.hostView,a,uN(this._hostTNode,h)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(FH(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[ln],l=new _k(c,c[kr],c[ln]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return k4(o,i,s,r),e.attachToViewContainerRef(),MN(Kv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=_N(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=fw(this._lContainer,t);r&&(yp(Kv(this._lContainer),t),qP(r[Ae],r))}detach(e){let t=this._adjustIndex(e,-1),r=fw(this._lContainer,t);return r&&yp(Kv(this._lContainer),t)!=null?new No(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function _N(n){return n[Ip]}function Kv(n){return n[Ip]||(n[Ip]=[])}function gq(n,e){let t,r=e[n.index];return Bi(r)?t=r:(t=ck(r,e,null,n),e[n.index]=t,nm(e,t)),yq(t,e,n,r),new _k(t,n,e)}function _q(n,e){let t=n[Zt],r=t.createComment(""),i=ur(e,n),s=cI(t,i);return xp(t,s,r,Q3(t,i),!1),r}var yq=Iq,vq=()=>!1;function wq(n,e,t){return vq(n,e,t)}function Iq(n,e,t,r){if(n[Do])return;let i;t.type&8?i=ti(r):i=_q(e,t),n[Do]=i}function Eq(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(Sq))}return s}return Mp.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,d=i.styleUrls;i.styleUrls.forEach((h,p)=>{a.push(""),o.push(r(h).then(_=>{a[l+p]=_,d.splice(d.indexOf(h),1),d.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>Dq(s));e.push(c)}),Cq(),Promise.all(e).then(()=>{})}var Mp=new Map,bq=new Set;function Cq(){let n=Mp;return Mp=new Map,n}function Tq(){return Mp.size===0}function Sq(n){return typeof n=="string"?n:n.text()}function Dq(n){bq.delete(n)}function Aq(n){return Object.getPrototypeOf(n.prototype).constructor}function Wu(n){let e=Aq(n.type),t=!0,r=[n];for(;e;){let i;if(gs(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ie(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let o=n;o.inputs=lp(n.inputs),o.inputTransforms=lp(n.inputTransforms),o.declaredInputs=lp(n.declaredInputs),o.outputs=lp(n.outputs);let a=i.hostBindings;a&&kq(n,a);let c=i.viewQuery,l=i.contentQueries;if(c&&Nq(n,c),l&&Pq(n,l),xq(n,i),P$(n.outputs,i.outputs),gs(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===Wu&&(t=!1)}}e=Object.getPrototypeOf(e)}Rq(r)}function xq(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function Rq(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Ou(i.hostAttrs,t=Ou(t,i.hostAttrs))}}function lp(n){return n===lc?{}:n===xr?[]:n}function Nq(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function Pq(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function kq(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function yI(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var _s=class{},$u=class{};var Op=class extends _s{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new kp(this);let i=qN(e);this._bootstrapComponents=BP(i.bootstrap),this._r3Injector=AP(e,t,[{provide:_s,useValue:this},{provide:im,useValue:this.componentFactoryResolver},...r],Mn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Fp=class extends $u{constructor(e){super(),this.moduleType=e}create(e){return new Op(this.moduleType,e,[])}};function Mq(n,e,t){return new Op(n,e,t)}var Dw=class extends _s{constructor(e){super(),this.componentFactoryResolver=new kp(this),this.instance=null;let t=new Fu([...e.providers,{provide:_s,useValue:this},{provide:im,useValue:this.componentFactoryResolver}],e.parent||$w(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function om(n,e,t=null){return new Dw({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var am=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new De(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function yk(n){return Fq(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function Oq(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function Fq(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Lq(n,e,t){return n[e]=t}function ys(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function Lp(n,e,t,r){let i=ys(n,e,t);return ys(n,e+1,r)||i}function Vq(n,e,t,r,i){let s=Lp(n,e,t,r);return ys(n,e+2,i)||s}function vk(n,e,t,r,i,s){let o=Lp(n,e,t,r);return Lp(n,e+2,i,s)||o}function Uq(n){return(n.flags&32)===32}function Bq(n,e,t,r,i,s,o,a,c){let l=e.consts,d=tm(e,n,4,o||null,bp(l,a));sk(e,t,d,bp(l,c)),Zw(e,d);let h=d.tView=dI(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}function Se(n,e,t,r,i,s,o,a){let c=qe(),l=dr(),d=n+ei,h=l.firstCreatePass?Bq(d,l,c,e,t,r,i,s,o):l.data[d];zu(h,!1);let p=jq(l,c,h,n);Jw()&&lI(l,c,p,h),Ro(p,c);let _=ck(p,c,p,h);return c[d]=_,nm(c,_),wq(_,h,c),qw(h)&&tk(l,c,h),o!=null&&nk(c,h,a),Se}var jq=$q;function $q(n,e,t,r){return Xw(!0),e[Zt].createComment("")}function cm(n,e,t,r){let i=qe(),s=Ww();if(ys(i,s,e)){let o=dr(),a=Yw();b4(a,i,n,e,t,r)}return cm}function wk(n,e,t,r){return ys(n,Ww(),t)?e+qt(t)+r:Vn}function Hq(n,e,t,r,i,s){let o=Wp(),a=Lp(n,o,t,i);return Kp(2),a?e+qt(t)+r+qt(i)+s:Vn}function qq(n,e,t,r,i,s,o,a){let c=Wp(),l=Vq(n,c,t,i,o);return Kp(3),l?e+qt(t)+r+qt(i)+s+qt(o)+a:Vn}function zq(n,e,t,r,i,s,o,a,c,l){let d=Wp(),h=vk(n,d,t,i,o,c);return Kp(4),h?e+qt(t)+r+qt(i)+s+qt(o)+a+qt(c)+l:Vn}function Gq(n,e,t,r,i,s,o,a,c,l,d,h){let p=Wp(),_=vk(n,p,t,i,o,c);return _=ys(n,p+4,d)||_,Kp(5),_?e+qt(t)+r+qt(i)+s+qt(o)+a+qt(c)+l+qt(d)+h:Vn}function ce(n,e,t){let r=qe(),i=Ww();if(ys(r,i,e)){let s=dr(),o=Yw();ik(s,o,r,n,e,r[Zt],t,!1)}return ce}function yN(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";hI(n,t,s[o],o,r)}function Wq(n,e,t,r,i,s){let o=e.consts,a=bp(o,i),c=tm(e,n,2,r,a);return sk(e,t,c,bp(o,s)),c.attrs!==null&&Cw(c,c.attrs,!1),c.mergedAttrs!==null&&Cw(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function w(n,e,t,r){let i=qe(),s=dr(),o=ei+n,a=i[Zt],c=s.firstCreatePass?Wq(o,s,i,e,t,r):s.data[o],l=Kq(s,i,c,a,e,n);i[o]=l;let d=qw(c);return zu(c,!0),KP(a,l,c),!Uq(c)&&Jw()&&lI(s,i,l,c),BH()===0&&Ro(l,i),jH(),d&&(tk(s,i,c),ek(s,c,i)),r!==null&&nk(i,c),w}function I(){let n=Qn();uP()?WH():(n=n.parent,zu(n,!1));let e=n;qH(e)&&zH(),$H();let t=dr();return t.firstCreatePass&&(Zw(t,n),eP(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&s3(e)&&yN(t,e,qe(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&o3(e)&&yN(t,e,qe(),e.stylesWithoutHost,!1),I}function Q(n,e,t,r){return w(n,e,t,r),I(),Q}var Kq=(n,e,t,r,i,s)=>(Xw(!0),jP(r,i,t3()));function st(){return qe()}var Vp="en-US";var Qq=Vp;function Yq(n){typeof n=="string"&&(Qq=n.toLowerCase().replace(/_/g,"-"))}function H(n,e,t,r){let i=qe(),s=dr(),o=Qn();return Xq(s,i,i[Zt],o,n,e,r),H}function Jq(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Lu],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function Xq(n,e,t,r,i,s,o){let a=qw(r),l=n.firstCreatePass&&A4(n),d=e[Nr],h=D4(e),p=!0;if(r.type&3||o){let A=ur(r,e),R=o?o(A):A,L=h.length,Y=o?Z=>o(ti(Z[r.index])):r.index,j=null;if(!o&&a&&(j=Jq(n,e,i,r.index)),j!==null){let Z=j.__ngLastListenerFn__||j;Z.__ngNextListenerFn__=s,j.__ngLastListenerFn__=s,p=!1}else{s=wN(r,e,d,s,!1);let Z=t.listen(R,i,s);h.push(s,Z),l&&l.push(i,Y,L,L+1)}}else s=wN(r,e,d,s,!1);let _=r.outputs,E;if(p&&_!==null&&(E=_[i])){let A=E.length;if(A)for(let R=0;R<A;R+=2){let L=E[R],Y=E[R+1],ue=e[L][Y].subscribe(s),ne=h.length;h.push(s,ue),l&&l.push(i,r.index,ne,-(ne+1))}}}function vN(n,e,t,r){let i=Le(null);try{return Yr(6,e,t),t(r)!==!1}catch(s){return uk(n,s),!1}finally{Yr(7,e,t),Le(i)}}function wN(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?vs(n.index,e):e;pI(a);let c=vN(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)c=vN(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function me(n=1){return e3(n)}function Ku(n,e,t){return wn(n,"",e,"",t),Ku}function wn(n,e,t,r,i){let s=qe(),o=wk(s,e,t,r);if(o!==Vn){let a=dr(),c=Yw();ik(a,c,s,n,o,s[Zt],i,!1)}return wn}function Zq(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function T(n,e=""){let t=qe(),r=dr(),i=n+ei,s=r.firstCreatePass?tm(r,i,1,e,null):r.data[i],o=ez(r,t,s,e,n);t[i]=o,Jw()&&lI(r,t,o,s),zu(s,!1)}var ez=(n,e,t,r,i)=>(Xw(!0),L3(e[Zt],r));function Ct(n){return $i("",n,""),Ct}function $i(n,e,t){let r=qe(),i=wk(r,n,e,t);return i!==Vn&&Gu(r,Po(),i),$i}function vI(n,e,t,r,i){let s=qe(),o=Hq(s,n,e,t,r,i);return o!==Vn&&Gu(s,Po(),o),vI}function wI(n,e,t,r,i,s,o){let a=qe(),c=qq(a,n,e,t,r,i,s,o);return c!==Vn&&Gu(a,Po(),c),wI}function II(n,e,t,r,i,s,o,a,c){let l=qe(),d=zq(l,n,e,t,r,i,s,o,a,c);return d!==Vn&&Gu(l,Po(),d),II}function EI(n,e,t,r,i,s,o,a,c,l,d){let h=qe(),p=Gq(h,n,e,t,r,i,s,o,a,c,l,d);return p!==Vn&&Gu(h,Po(),p),EI}function tz(n,e,t){let r=dr();if(r.firstCreatePass){let i=gs(n);Aw(t,r.data,r.blueprint,i,!0),Aw(e,r.data,r.blueprint,i,!1)}}function Aw(n,e,t,r,i){if(n=yn(n),Array.isArray(n))for(let s=0;s<n.length;s++)Aw(n[s],e,t,r,i);else{let s=dr(),o=qe(),a=Qn(),c=dc(n)?n:yn(n.provide),l=YN(n),d=a.providerIndexes&1048575,h=a.directiveStart,p=a.providerIndexes>>20;if(dc(n)||!n.multi){let _=new xo(l,i,te),E=Yv(c,e,i?d:d+p,h);E===-1?(cw(Dp(a,o),s,c),Qv(s,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(_),o.push(_)):(t[E]=_,o[E]=_)}else{let _=Yv(c,e,d+p,h),E=Yv(c,e,d,d+p),A=_>=0&&t[_],R=E>=0&&t[E];if(i&&!R||!i&&!A){cw(Dp(a,o),s,c);let L=iz(i?rz:nz,t.length,i,r,l);!i&&R&&(t[E].providerFactory=L),Qv(s,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(L),o.push(L)}else{let L=Ik(t[i?E:_],l,!i&&r);Qv(s,n,_>-1?_:E,L)}!i&&r&&R&&t[E].componentProviders++}}}function Qv(n,e,t,r){let i=dc(e),s=gH(e);if(i||s){let c=(s?yn(e.useClass):e).prototype.ngOnDestroy;if(c){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=l.indexOf(t);d===-1?l.push(t,[r,c]):l[d+1].push(r,c)}else l.push(t,c)}}}function Ik(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Yv(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function nz(n,e,t,r){return xw(this.multi,[])}function rz(n,e,t,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=pc(t,t[Ae],this.providerFactory.index,r);s=a.slice(0,o),xw(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],xw(i,s);return s}function xw(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function iz(n,e,t,r,i){let s=new xo(n,t,te);return s.multi=[],s.index=e,s.componentProviders=0,Ik(s,i,r&&!t),s}function bI(n,e=[]){return t=>{t.providersResolver=(r,i)=>tz(r,i?i(n):n,e)}}var sz=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=WN(!1,r.type),s=i.length>0?om([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=oe({token:e,providedIn:"environment",factory:()=>new e(ae(On))});let n=e;return n})();function Ek(n){mI("NgStandalone"),n.getStandaloneInjector=e=>e.get(sz).getOrCreateStandaloneInjector(n)}function oz(n,e){let t=n[e];return t===Vn?void 0:t}function az(n,e,t,r,i,s){let o=e+t;return ys(n,o,i)?Lq(n,o+1,s?r.call(s,i):r(i)):oz(n,o+1)}function Un(n,e){let t=dr(),r,i=n+ei;t.firstCreatePass?(r=cz(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=To(r.type,!0)),o,a=kn(te);try{let c=Sp(!1),l=s();return Sp(c),Zq(t,qe(),i,l),l}finally{kn(a)}}function cz(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function Bn(n,e,t){let r=n+ei,i=qe(),s=OH(i,r);return lz(i,r)?az(i,KH(),e,s.transform,t,s):s.transform(t)}function lz(n,e){return n[Ae].data[e].pure}var up=null;function uz(n){up!==null&&(n.defaultEncapsulation!==up.defaultEncapsulation||n.preserveWhitespaces!==up.preserveWhitespaces)||(up=n)}var lm=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var CI=new fe(""),Qu=new fe(""),um=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,TI||(dz(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{et.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(ae(et),ae(dm),ae(Qu))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),dm=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return TI?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function dz(n){TI=n}var TI;function Oo(n){return!!n&&typeof n.then=="function"}function SI(n){return!!n&&typeof n.subscribe=="function"}var hm=new fe(""),bk=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=J(hm,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Oo(o))r.push(o);else if(SI(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),DI=new fe("");function hz(){fR(()=>{throw new ie(600,!1)})}function fz(n){return n.isBoundToModule}function pz(n,e,t){try{let r=t();return Oo(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function Ck(n,e){return Array.isArray(e)?e.reduce(Ck,n):q(q({},n),e)}var wc=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=J(xP),this.afterRenderEffectManager=J(_I),this.externalTestViews=new Set,this.beforeRender=new an,this.afterTick=new an,this.componentTypes=[],this.components=[],this.isStable=J(am).hasPendingTasks.pipe(Me(r=>!r)),this._injector=J(On)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Pp;if(!this._injector.get(bk).done){let _=!s&&HN(r),E=!1;throw new ie(405,E)}let a;s?a=r:a=this._injector.get(im).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=fz(a)?void 0:this._injector.get(_s),l=i||a.selector,d=a.create(Mr.NULL,[],l,c),h=d.location.nativeElement,p=d.injector.get(CI,null);return p?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),mp(this.components,d),p?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new ie(101,!1);let i=Le(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Le(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===hk)throw new ie(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)mz(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Rw(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Rw(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;mp(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(DI,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>mp(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new ie(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function mp(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function mz(n,e,t){!e&&!Rw(n)||gz(n,t,e)}function Rw(n){return Gw(n)}function gz(n,e,t){let r;t?(r=0,n[he]|=1024):n[he]&64?r=0:r=1,fk(n,e,r)}var Nw=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},fm=(()=>{let e=class e{compileModuleSync(r){return new Fp(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=qN(r),o=BP(s.declarations).reduce((a,c)=>{let l=ms(c);return l&&a.push(new mc(l)),a},[]);return new Nw(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),_z=new fe("");function yz(n,e,t){let r=new Fp(t);return Promise.resolve(r)}function IN(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var vz=(()=>{let e=class e{constructor(){this.zone=J(et),this.applicationRef=J(wc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function wz(n){return[{provide:et,useFactory:n},{provide:uc,multi:!0,useFactory:()=>{let e=J(vz,{optional:!0});return()=>e.initialize()}},{provide:uc,multi:!0,useFactory:()=>{let e=J(bz);return()=>{e.initialize()}}},{provide:xP,useFactory:Iz}]}function Iz(){let n=J(et),e=J(ni);return t=>n.runOutsideAngular(()=>e.handleError(t))}function Ez(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var bz=(()=>{let e=class e{constructor(){this.subscription=new Bt,this.initialized=!1,this.zone=J(et),this.pendingTasks=J(am)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{et.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{et.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Cz(){return typeof $localize<"u"&&$localize.locale||Vp}var AI=new fe("",{providedIn:"root",factory:()=>J(AI,be.Optional|be.SkipSelf)||Cz()});var Tk=new fe(""),Sk=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=iq(i?.ngZone,Ez({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=Mq(r.moduleType,this.injector,wz(()=>s)),a=o.injector.get(ni,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{mp(this._modules,o),c.unsubscribe()})}),pz(a,s,()=>{let c=o.injector.get(bk);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(AI,Vp);return Yq(l||Vp),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=Ck({},i);return yz(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(wc);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new ie(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ie(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(Tk,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(ae(Mr))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),ku=null,Dk=new fe("");function Tz(n){if(ku&&!ku.get(Dk,!1))throw new ie(400,!1);hz(),ku=n;let e=n.get(Sk);return Az(n),e}function xI(n,e,t=[]){let r=`Platform: ${e}`,i=new fe(r);return(s=[])=>{let o=Ak();if(!o||o.injector.get(Dk,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):Tz(Sz(a,r))}return Dz(i)}}function Sz(n=[],e){return Mr.create({name:e,providers:[{provide:Hp,useValue:"platform"},{provide:Tk,useValue:new Set([()=>ku=null])},...n]})}function Dz(n){let e=Ak();if(!e)throw new ie(401,!1);return e}function Ak(){return ku?.get(Sk)??null}function Az(n){n.get(rI,null)?.forEach(t=>t())}var Fo=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=xz;let n=e;return n})();function xz(n){return Rz(Qn(),qe(),(n&16)===16)}function Rz(n,e,t){if(Gp(n)&&!t){let r=vs(n.index,e);return new No(r,r)}else if(n.type&47){let r=e[Zr];return new No(r,e)}return null}var Pw=class{constructor(){}supports(e){return yk(e)}create(e){return new kw(e)}},Nz=(n,e)=>e,kw=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Nz}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<EN(r,i,s)?t:r,a=EN(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,d=c-i;if(l!=d){for(let p=0;p<l;p++){let _=p<s.length?s[p]:s[p]=0,E=_+p;d<=E&&E<l&&(s[p]=_+1)}let h=o.previousIndex;s[h]=d-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!yk(e))throw new ie(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,Oq(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new Mw(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Up),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Up),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Mw=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Ow=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Up=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Ow,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function EN(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function bN(){return new RI([new Pw])}var RI=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||bN()),deps:[[e,new Vw,new $p]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new ie(901,!1)}};e.\u0275prov=oe({token:e,providedIn:"root",factory:bN});let n=e;return n})();var xk=xI(null,"core",[]),Rk=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(ae(wc))},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({});let n=e;return n})();function Ic(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function NI(n){let e=Le(null);try{return n()}finally{Le(e)}}function Nk(n){let e=ms(n);if(!e)return null;let t=new mc(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var Fk=null;function Lo(){return Fk}function Lk(n){Fk??=n}var pm=class{};var jn=new fe(""),UI=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>J(Pz),providedIn:"platform"});let n=e;return n})(),Vk=new fe(""),Pz=(()=>{let e=class e extends UI{constructor(){super(),this._doc=J(jn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Lo().getBaseHref(this._doc)}onPopState(r){let i=Lo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=Lo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function BI(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function Pk(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Hi(n){return n&&n[0]!=="?"?"?"+n:n}var Or=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>J(jI),providedIn:"root"});let n=e;return n})(),Uk=new fe(""),jI=(()=>{let e=class e extends Or{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??J(jn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return BI(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Hi(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Hi(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Hi(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(ae(UI),ae(Uk,8))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),gm=(()=>{let e=class e extends Or{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=BI(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Hi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Hi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(ae(UI),ae(Uk,8))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),Ec=(()=>{let e=class e{constructor(r){this._subject=new cn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=Oz(Pk(kk(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Hi(i))}normalize(r){return e.stripTrailingSlash(Mz(this._basePath,kk(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Hi(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Hi(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Hi,e.joinWithSlash=BI,e.stripTrailingSlash=Pk,e.\u0275fac=function(i){return new(i||e)(ae(Or))},e.\u0275prov=oe({token:e,factory:()=>kz(),providedIn:"root"});let n=e;return n})();function kz(){return new Ec(ae(Or))}function Mz(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function kk(n){return n.replace(/\/index.html$/,"")}function Oz(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function Bk(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var PI=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},hr=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new PI(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),Mk(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);Mk(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(te(vc),te(rm),te(RI))},e.\u0275dir=Kn({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let n=e;return n})();function Mk(n,e){n.context.$implicit=e.item}var fr=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new kI,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){Ok("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){Ok("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(te(vc),te(rm))},e.\u0275dir=Kn({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let n=e;return n})(),kI=class{constructor(){this.$implicit=null,this.ngIf=null}};function Ok(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${Mn(e)}'.`)}function Fz(n,e){return new ie(2100,!1)}var MI=class{createSubscription(e,t){return NI(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){NI(()=>e.unsubscribe())}},OI=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},Lz=new OI,Vz=new MI,pr=(()=>{let e=class e{constructor(r){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=r}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(r){if(!this._obj){if(r)try{this.markForCheckOnValueUpdate=!1,this._subscribe(r)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return r!==this._obj?(this._dispose(),this.transform(r)):this._latestValue}_subscribe(r){this._obj=r,this._strategy=this._selectStrategy(r),this._subscription=this._strategy.createSubscription(r,i=>this._updateLatestValue(r,i))}_selectStrategy(r){if(Oo(r))return Lz;if(SI(r))return Vz;throw Fz(e,r)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(r,i){r===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}};e.\u0275fac=function(i){return new(i||e)(te(Fo,16))},e.\u0275pipe=BN({name:"async",type:e,pure:!1,standalone:!0});let n=e;return n})();var jk=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({});let n=e;return n})(),$I="browser",Uz="server";function Bz(n){return n===$I}function HI(n){return n===Uz}var $k=(()=>{let e=class e{};e.\u0275prov=oe({token:e,providedIn:"root",factory:()=>Bz(J(ws))?new FI(J(jn),window):new LI});let n=e;return n})(),FI=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=jz(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function jz(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var LI=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},mm=class{};var GI=class extends pm{constructor(){super(...arguments),this.supportsDOMEvents=!0}},WI=class n extends GI{static makeCurrent(){Lk(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Hz();return t==null?null:qz(t)}resetBaseElement(){Yu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Bk(document.cookie,e)}},Yu=null;function Hz(){return Yu=Yu||document.querySelector("base"),Yu?Yu.getAttribute("href"):null}function qz(n){return new URL(n,document.baseURI).pathname}var KI=class{addToWindow(e){vn.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new ie(5103,!1);return s},vn.getAllAngularTestabilities=()=>e.getAllTestabilities(),vn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=vn.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};vn.frameworkStabilizers||(vn.frameworkStabilizers=[]),vn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?Lo().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},zz=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),QI=new fe(""),Gk=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new ie(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(ae(QI),ae(et))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),_m=class{constructor(e){this._doc=e}},qI="ng-app-id",Wk=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=HI(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${qI}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(qI),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(qI,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(ae(jn),ae(Yp),ae(iI,8),ae(ws))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),zI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},JI=/%COMP%/g,Kk="%COMP%",Gz=`_nghost-${Kk}`,Wz=`_ngcontent-${Kk}`,Kz=!0,Qz=new fe("",{providedIn:"root",factory:()=>Kz});function Yz(n){return Wz.replace(JI,n)}function Jz(n){return Gz.replace(JI,n)}function Qk(n,e){return e.map(t=>t.replace(JI,n))}var Hk=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=HI(c),this.defaultRenderer=new Ju(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Xr.ShadowDom&&(i=lt(q({},i),{encapsulation:Xr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof ym?s.applyToHost(r):s instanceof Xu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(i.encapsulation){case Xr.Emulated:o=new ym(l,d,i,this.appId,h,a,c,p);break;case Xr.ShadowDom:return new YI(l,d,r,i,a,c,this.nonce,p);default:o=new Xu(l,d,i,h,a,c,p);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(ae(Gk),ae(Wk),ae(Yp),ae(Qz),ae(jn),ae(ws),ae(et),ae(iI))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),Ju=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(zI[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(qk(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(qk(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ie(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=zI[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=zI[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Mo.DashCase|Mo.Important)?e.style.setProperty(t,r,i&Mo.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Mo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=Lo().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function qk(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var YI=class extends Ju{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=Qk(i.id,i.styles);for(let d of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Xu=class extends Ju{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?Qk(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},ym=class extends Xu{constructor(e,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,l),this.contentAttr=Yz(l),this.hostAttr=Jz(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},Xz=(()=>{let e=class e extends _m{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(ae(jn))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),zk=["alt","control","meta","shift"],Zz={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},eG={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},tG=(()=>{let e=class e extends _m{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Lo().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),zk.forEach(d=>{let h=i.indexOf(d);h>-1&&(i.splice(h,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=Zz[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),zk.forEach(a=>{if(a!==s){let c=eG[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(ae(jn))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})();function nG(){WI.makeCurrent()}function rG(){return new ni}function iG(){return OP(document),document}var sG=[{provide:ws,useValue:$I},{provide:rI,useValue:nG,multi:!0},{provide:jn,useFactory:iG,deps:[]}],Yk=xI(xk,"browser",sG),oG=new fe(""),aG=[{provide:Qu,useClass:KI,deps:[]},{provide:CI,useClass:um,deps:[et,dm,Qu]},{provide:um,useClass:um,deps:[et,dm,Qu]}],cG=[{provide:Hp,useValue:"root"},{provide:ni,useFactory:rG,deps:[]},{provide:QI,useClass:Xz,multi:!0,deps:[jn,et,ws]},{provide:QI,useClass:tG,multi:!0,deps:[jn]},Hk,Wk,Gk,{provide:ju,useExisting:Hk},{provide:mm,useClass:zz,deps:[]},[]],Jk=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Yp,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(ae(oG,12))},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({providers:[...cG,...aG],imports:[jk,Rk]});let n=e;return n})();var Xk=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(ae(jn))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var ve="primary",fd=Symbol("RouteTitle"),nE=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Dc(n){return new nE(n)}function lG(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function uG(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ri(n[t],e[t]))return!1;return!0}function ri(n,e){let t=n?rE(n):void 0,r=e?rE(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!cM(n[i],e[i]))return!1;return!0}function rE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function cM(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function lM(n){return n.length>0?n[n.length-1]:null}function Ts(n){return Mv(n)?n:Oo(n)?bt(Promise.resolve(n)):de(n)}var dG={exact:dM,subset:hM},uM={exact:hG,subset:fG,ignored:()=>!0};function eM(n,e,t){return dG[t.paths](n.root,e.root,t.matrixParams)&&uM[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function hG(n,e){return ri(n,e)}function dM(n,e,t){if(!Uo(n.segments,e.segments)||!Im(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!dM(n.children[r],e.children[r],t))return!1;return!0}function fG(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>cM(n[t],e[t]))}function hM(n,e,t){return fM(n,e,e.segments,t)}function fM(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Uo(i,t)||e.hasChildren()||!Im(i,t,r))}else if(n.segments.length===t.length){if(!Uo(n.segments,t)||!Im(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!hM(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Uo(n.segments,i)||!Im(n.segments,i,r)||!n.children[ve]?!1:fM(n.children[ve],e,s,r)}}function Im(n,e,t){return e.every((r,i)=>uM[t](n[i].parameters,r.parameters))}var Es=class{constructor(e=new $e([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Dc(this.queryParams),this._queryParamMap}toString(){return gG.serialize(this)}},$e=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Em(this)}},Vo=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Dc(this.parameters),this._parameterMap}toString(){return mM(this)}};function pG(n,e){return Uo(n,e)&&n.every((t,r)=>ri(t.parameters,e[r].parameters))}function Uo(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function mG(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===ve&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==ve&&(t=t.concat(e(i,r)))}),t}var pd=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>new sd,providedIn:"root"});let n=e;return n})(),sd=class{parse(e){let t=new sE(e);return new Es(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Zu(e.root,!0)}`,r=vG(e.queryParams),i=typeof e.fragment=="string"?`#${_G(e.fragment)}`:"";return`${t}${r}${i}`}},gG=new sd;function Em(n){return n.segments.map(e=>mM(e)).join("/")}function Zu(n,e){if(!n.hasChildren())return Em(n);if(e){let t=n.children[ve]?Zu(n.children[ve],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==ve&&r.push(`${i}:${Zu(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=mG(n,(r,i)=>i===ve?[Zu(n.children[ve],!1)]:[`${i}:${Zu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[ve]!=null?`${Em(n)}/${t[0]}`:`${Em(n)}/(${t.join("//")})`}}function pM(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function vm(n){return pM(n).replace(/%3B/gi,";")}function _G(n){return encodeURI(n)}function iE(n){return pM(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function bm(n){return decodeURIComponent(n)}function tM(n){return bm(n.replace(/\+/g,"%20"))}function mM(n){return`${iE(n.path)}${yG(n.parameters)}`}function yG(n){return Object.entries(n).map(([e,t])=>`;${iE(e)}=${iE(t)}`).join("")}function vG(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${vm(t)}=${vm(i)}`).join("&"):`${vm(t)}=${vm(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var wG=/^[^\/()?;#]+/;function XI(n){let e=n.match(wG);return e?e[0]:""}var IG=/^[^\/()?;=#]+/;function EG(n){let e=n.match(IG);return e?e[0]:""}var bG=/^[^=?&#]+/;function CG(n){let e=n.match(bG);return e?e[0]:""}var TG=/^[^&#]+/;function SG(n){let e=n.match(TG);return e?e[0]:""}var sE=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new $e([],{}):new $e([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[ve]=new $e(e,t)),r}parseSegment(){let e=XI(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ie(4009,!1);return this.capture(e),new Vo(bm(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=EG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=XI(this.remaining);i&&(r=i,this.capture(r))}e[bm(t)]=bm(r)}parseQueryParam(e){let t=CG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=SG(this.remaining);o&&(r=o,this.capture(r))}let i=tM(t),s=tM(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=XI(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ie(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ve);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[ve]:new $e([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ie(4011,!1)}};function gM(n){return n.segments.length>0?new $e([],{[ve]:n}):n}function _M(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=_M(i);if(r===ve&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new $e(n.segments,e);return DG(t)}function DG(n){if(n.numberOfChildren===1&&n.children[ve]){let e=n.children[ve];return new $e(n.segments.concat(e.segments),e.children)}return n}function Ac(n){return n instanceof Es}function AG(n,e,t=null,r=null){let i=yM(n);return vM(i,e,t,r)}function yM(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new $e(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=gM(r);return e??i}function vM(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return ZI(i,i,i,t,r);let s=xG(e);if(s.toRoot())return ZI(i,i,new $e([],{}),t,r);let o=RG(s,i,n),a=o.processChildren?nd(o.segmentGroup,o.index,s.commands):IM(o.segmentGroup,o.index,s.commands);return ZI(i,o.segmentGroup,a,t,r)}function Cm(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function od(n){return typeof n=="object"&&n!=null&&n.outlets}function ZI(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=wM(n,e,t);let a=gM(_M(o));return new Es(a,s,i)}function wM(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=wM(s,e,t)}),new $e(n.segments,r)}var Tm=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Cm(r[0]))throw new ie(4003,!1);let i=r.find(od);if(i&&i!==lM(r))throw new ie(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function xG(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Tm(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Tm(t,e,r)}var Tc=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function RG(n,e,t){if(n.isAbsolute)return new Tc(e,!0,0);if(!t)return new Tc(e,!1,NaN);if(t.parent===null)return new Tc(t,!0,0);let r=Cm(n.commands[0])?0:1,i=t.segments.length-1+r;return NG(t,i,n.numberOfDoubleDots)}function NG(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new ie(4005,!1);i=r.segments.length}return new Tc(r,!1,i-s)}function PG(n){return od(n[0])?n[0].outlets:{[ve]:n}}function IM(n,e,t){if(n??=new $e([],{}),n.segments.length===0&&n.hasChildren())return nd(n,e,t);let r=kG(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new $e(n.segments.slice(0,r.pathIndex),{});return s.children[ve]=new $e(n.segments.slice(r.pathIndex),n.children),nd(s,0,i)}else return r.match&&i.length===0?new $e(n.segments,{}):r.match&&!n.hasChildren()?oE(n,e,t):r.match?nd(n,0,i):oE(n,e,t)}function nd(n,e,t){if(t.length===0)return new $e(n.segments,{});{let r=PG(t),i={};if(Object.keys(r).some(s=>s!==ve)&&n.children[ve]&&n.numberOfChildren===1&&n.children[ve].segments.length===0){let s=nd(n.children[ve],e,t);return new $e(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=IM(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new $e(n.segments,i)}}function kG(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(od(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!rM(c,l,o))return s;r+=2}else{if(!rM(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function oE(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(od(s)){let c=MG(s.outlets);return new $e(r,c)}if(i===0&&Cm(t[0])){let c=n.segments[e];r.push(new Vo(c.path,nM(t[0]))),i++;continue}let o=od(s)?s.outlets[ve]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Cm(a)?(r.push(new Vo(o,nM(a))),i+=2):(r.push(new Vo(o,{})),i++)}return new $e(r,{})}function MG(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=oE(new $e([],{}),0,r))}),e}function nM(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function rM(n,e,t){return n==t.path&&ri(e,t.parameters)}var rd="imperative",zt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(zt||{}),mr=class{constructor(e,t){this.id=e,this.url=t}},xc=class extends mr{constructor(e,t,r="imperative",i=null){super(e,t),this.type=zt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ii=class extends mr{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=zt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Jn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Jn||{}),Sm=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Sm||{}),bs=class extends mr{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=zt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Cs=class extends mr{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=zt.NavigationSkipped}},ad=class extends mr{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=zt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Dm=class extends mr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=zt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},aE=class extends mr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=zt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},cE=class extends mr{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=zt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},lE=class extends mr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=zt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},uE=class extends mr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=zt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},dE=class{constructor(e){this.route=e,this.type=zt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},hE=class{constructor(e){this.route=e,this.type=zt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},fE=class{constructor(e){this.snapshot=e,this.type=zt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},pE=class{constructor(e){this.snapshot=e,this.type=zt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mE=class{constructor(e){this.snapshot=e,this.type=zt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},gE=class{constructor(e){this.snapshot=e,this.type=zt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Am=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=zt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},cd=class{},ld=class{constructor(e){this.url=e}};var _E=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new md,this.attachRef=null}},md=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new _E,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),xm=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=yE(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=yE(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=vE(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return vE(e,this._root).map(t=>t.value)}};function yE(n,e){if(n===e.value)return e;for(let t of e.children){let r=yE(n,t);if(r)return r}return null}function vE(n,e){if(n===e.value)return[e];for(let t of e.children){let r=vE(n,t);if(r.length)return r.unshift(e),r}return[]}var Yn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Cc(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Rm=class extends xm{constructor(e,t){super(e),this.snapshot=t,xE(this,e)}toString(){return this.snapshot.toString()}};function EM(n){let e=OG(n),t=new De([new Vo("",{})]),r=new De({}),i=new De({}),s=new De({}),o=new De(""),a=new Fr(t,r,s,o,i,ve,n,e.root);return a.snapshot=e.root,new Rm(new Yn(a,[]),e)}function OG(n){let e={},t={},r={},i="",s=new ud([],e,r,i,t,ve,n,null,{});return new Nm("",new Yn(s,[]))}var Fr=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Me(l=>l[fd]))??de(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Me(e=>Dc(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Me(e=>Dc(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function AE(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:q(q({},e.params),n.params),data:q(q({},e.data),n.data),resolve:q(q(q(q({},n.data),e.data),i?.data),n._resolvedData)}:r={params:q({},n.params),data:q({},n.data),resolve:q(q({},n.data),n._resolvedData??{})},i&&CM(i)&&(r.resolve[fd]=i.title),r}var ud=class{get title(){return this.data?.[fd]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Dc(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Dc(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Nm=class extends xm{constructor(e,t){super(t),this.url=e,xE(this,t)}toString(){return bM(this._root)}};function xE(n,e){e.value._routerState=n,e.children.forEach(t=>xE(n,t))}function bM(n){let e=n.children.length>0?` { ${n.children.map(bM).join(", ")} } `:"";return`${n.value}${e}`}function eE(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ri(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),ri(e.params,t.params)||n.paramsSubject.next(t.params),uG(e.url,t.url)||n.urlSubject.next(t.url),ri(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function wE(n,e){let t=ri(n.params,e.params)&&pG(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||wE(n.parent,e.parent))}function CM(n){return typeof n.title=="string"||n.title===null}var RE=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ve,this.activateEvents=new cn,this.deactivateEvents=new cn,this.attachEvents=new cn,this.detachEvents=new cn,this.parentContexts=J(md),this.location=J(vc),this.changeDetector=J(Fo),this.environmentInjector=J(On),this.inputBinder=J(Fm,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ie(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ie(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ie(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new ie(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new IE(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Kn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[_c]});let n=e;return n})(),IE=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Fr?this.route:e===md?this.childContexts:this.parent.get(e,t)}},Fm=new fe(""),iM=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Ru([i.queryParams,i.params,i.data]).pipe(ar(([o,a,c],l)=>(c=q(q(q({},o),a),c),l===0?de(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=Nk(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})();function FG(n,e,t){let r=dd(n,e._root,t?t._root:void 0);return new Rm(r,e)}function dd(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=LG(n,e,t);return new Yn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>dd(n,a)),o}}let r=VG(e.value),i=e.children.map(s=>dd(n,s));return new Yn(r,i)}}function LG(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return dd(n,r,i);return dd(n,r)})}function VG(n){return new Fr(new De(n.url),new De(n.params),new De(n.queryParams),new De(n.fragment),new De(n.data),n.outlet,n.component,n)}var TM="ngNavigationCancelingError";function SM(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Ac(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=DM(!1,Jn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function DM(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[TM]=!0,t.cancellationCode=e,t}function UG(n){return AM(n)&&Ac(n.url)}function AM(n){return!!n&&n[TM]}var BG=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=xe({type:e,selectors:[["ng-component"]],standalone:!0,features:[Ek],decls:1,vars:0,template:function(i,s){i&1&&Q(0,"router-outlet")},dependencies:[RE],encapsulation:2});let n=e;return n})();function jG(n,e){return n.providers&&!n._injector&&(n._injector=om(n.providers,e,`Route: ${n.path}`)),n._injector??e}function NE(n){let e=n.children&&n.children.map(NE),t=e?lt(q({},n),{children:e}):q({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ve&&(t.component=BG),t}function si(n){return n.outlet||ve}function $G(n,e){let t=n.filter(r=>si(r)===e);return t.push(...n.filter(r=>si(r)!==e)),t}function gd(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var HG=(n,e,t,r)=>Me(i=>(new EE(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),EE=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),eE(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Cc(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Cc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Cc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Cc(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new gE(s.value.snapshot))}),e.children.length&&this.forwardEvent(new pE(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(eE(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),eE(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=gd(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Pm=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Sc=class{constructor(e,t){this.component=e,this.route=t}};function qG(n,e,t){let r=n._root,i=e?e._root:null;return ed(r,i,t,[r.value])}function zG(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Nc(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!DN(n)?n:e.get(n):r}function ed(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Cc(e);return n.children.forEach(o=>{GG(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>id(a,t.getContext(o),i)),i}function GG(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=WG(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Pm(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?ed(n,e,a?a.children:null,r,i):ed(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Sc(a.outlet.component,o))}else o&&id(e,a,i),i.canActivateChecks.push(new Pm(r)),s.component?ed(n,null,a?a.children:null,r,i):ed(n,null,t,r,i);return i}function WG(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Uo(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Uo(n.url,e.url)||!ri(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!wE(n,e)||!ri(n.queryParams,e.queryParams);case"paramsChange":default:return!wE(n,e)}}function id(n,e,t){let r=Cc(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?id(o,e.children.getContext(s),t):id(o,null,t):id(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Sc(e.outlet.component,i)):t.canDeactivateChecks.push(new Sc(null,i)):t.canDeactivateChecks.push(new Sc(null,i))}function _d(n){return typeof n=="function"}function KG(n){return typeof n=="boolean"}function QG(n){return n&&_d(n.canLoad)}function YG(n){return n&&_d(n.canActivate)}function JG(n){return n&&_d(n.canActivateChild)}function XG(n){return n&&_d(n.canDeactivate)}function ZG(n){return n&&_d(n.canMatch)}function xM(n){return n instanceof Fi||n?.name==="EmptyError"}var wm=Symbol("INITIAL_VALUE");function Rc(){return ar(n=>Ru(n.map(e=>e.pipe(Li(1),Vv(wm)))).pipe(Me(e=>{for(let t of e)if(t!==!0){if(t===wm)return wm;if(t===!1||t instanceof Es)return t}return!0}),or(e=>e!==wm),Li(1)))}function eW(n,e){return Rt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?de(lt(q({},t),{guardsResult:!0})):tW(o,r,i,n).pipe(Rt(a=>a&&KG(a)?nW(r,s,n,e):de(a)),Me(a=>lt(q({},t),{guardsResult:a})))})}function tW(n,e,t,r){return bt(n).pipe(Rt(i=>aW(i.component,i.route,t,e,r)),Qr(i=>i!==!0,!0))}function nW(n,e,t,r){return bt(e).pipe(Eo(i=>tc(iW(i.route.parent,r),rW(i.route,r),oW(n,i.path,t),sW(n,i.route,t))),Qr(i=>i!==!0,!0))}function rW(n,e){return n!==null&&e&&e(new mE(n)),de(!0)}function iW(n,e){return n!==null&&e&&e(new fE(n)),de(!0)}function sW(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return de(!0);let i=r.map(s=>sp(()=>{let o=gd(e)??t,a=Nc(s,o),c=YG(a)?a.canActivate(e,n):Vi(o,()=>a(e,n));return Ts(c).pipe(Qr())}));return de(i).pipe(Rc())}function oW(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>zG(o)).filter(o=>o!==null).map(o=>sp(()=>{let a=o.guards.map(c=>{let l=gd(o.node)??t,d=Nc(c,l),h=JG(d)?d.canActivateChild(r,n):Vi(l,()=>d(r,n));return Ts(h).pipe(Qr())});return de(a).pipe(Rc())}));return de(s).pipe(Rc())}function aW(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return de(!0);let o=s.map(a=>{let c=gd(e)??i,l=Nc(a,c),d=XG(l)?l.canDeactivate(n,e,t,r):Vi(c,()=>l(n,e,t,r));return Ts(d).pipe(Qr())});return de(o).pipe(Rc())}function cW(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return de(!0);let s=i.map(o=>{let a=Nc(o,n),c=QG(a)?a.canLoad(e,t):Vi(n,()=>a(e,t));return Ts(c)});return de(s).pipe(Rc(),RM(r))}function RM(n){return Rv(Xt(e=>{if(Ac(e))throw SM(n,e)}),Me(e=>e===!0))}function lW(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return de(!0);let s=i.map(o=>{let a=Nc(o,n),c=ZG(a)?a.canMatch(e,t):Vi(n,()=>a(e,t));return Ts(c)});return de(s).pipe(Rc(),RM(r))}var hd=class{constructor(e){this.segmentGroup=e||null}},km=class extends Error{constructor(e){super(),this.urlTree=e}};function bc(n){return Za(new hd(n))}function uW(n){return Za(new ie(4e3,!1))}function dW(n){return Za(DM(!1,Jn.GuardRejected))}var bE=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return de(r);if(i.numberOfChildren>1||!i.children[ve])return uW(e.redirectTo);i=i.children[ve]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new km(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Es(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new $e(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ie(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},CE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function hW(n,e,t,r,i){let s=PE(n,e,t);return s.matched?(r=jG(e,r),lW(r,e,t,i).pipe(Me(o=>o===!0?s:q({},CE)))):de(s)}function PE(n,e,t){if(e.path==="**")return fW(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?q({},CE):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||lG)(t,n,e);if(!i)return q({},CE);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?q(q({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function fW(n){return{matched:!0,parameters:n.length>0?lM(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function sM(n,e,t,r){return t.length>0&&gW(n,t,r)?{segmentGroup:new $e(e,mW(r,new $e(t,n.children))),slicedSegments:[]}:t.length===0&&_W(n,t,r)?{segmentGroup:new $e(n.segments,pW(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new $e(n.segments,n.children),slicedSegments:t}}function pW(n,e,t,r){let i={};for(let s of t)if(Lm(n,e,s)&&!r[si(s)]){let o=new $e([],{});i[si(s)]=o}return q(q({},r),i)}function mW(n,e){let t={};t[ve]=e;for(let r of n)if(r.path===""&&si(r)!==ve){let i=new $e([],{});t[si(r)]=i}return t}function gW(n,e,t){return t.some(r=>Lm(n,e,r)&&si(r)!==ve)}function _W(n,e,t){return t.some(r=>Lm(n,e,r))}function Lm(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function yW(n,e,t,r){return si(n)!==r&&(r===ve||!Lm(e,t,n))?!1:PE(e,n,t).matched}function vW(n,e,t){return e.length===0&&!n.children[t]}var TE=class{};function wW(n,e,t,r,i,s,o="emptyOnly"){return new SE(n,e,t,r,i,o,s).recognize()}var IW=31,SE=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new bE(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ie(4002,`'${e.segmentGroup}'`)}recognize(){let e=sM(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Me(t=>{let r=new ud([],Object.freeze({}),Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,{},ve,this.rootComponentType,null,{}),i=new Yn(r,t),s=new Nm("",i),o=AG(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ve).pipe(ds(r=>{if(r instanceof km)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof hd?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=AE(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Me(s=>s instanceof Yn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return bt(i).pipe(Eo(s=>{let o=r.children[s],a=$G(t,s);return this.processSegmentGroup(e,a,o,s)}),Lv((s,o)=>(s.push(...o),s)),hs(null),Fv(),Rt(s=>{if(s===null)return bc(r);let o=NM(s);return EW(o),de(o)}))}processSegment(e,t,r,i,s,o){return bt(t).pipe(Eo(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(ds(c=>{if(c instanceof hd)return de(null);throw c}))),Qr(a=>!!a),ds(a=>{if(xM(a))return vW(r,i,s)?de(new TE):bc(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return yW(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):bc(i):bc(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:d}=PE(t,i,s);if(!a)return bc(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>IW&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,h).pipe(Rt(p=>this.processSegment(e,r,t,p.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=hW(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(ar(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(ar(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:p}=a,_=new ud(d,p,Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,CW(r),si(r),r.component??r._loadedComponent??null,r,TW(r)),{segmentGroup:E,slicedSegments:A}=sM(t,d,h,c);if(A.length===0&&E.hasChildren())return this.processChildren(l,c,E).pipe(Me(L=>L===null?null:new Yn(_,L)));if(c.length===0&&A.length===0)return de(new Yn(_,[]));let R=si(r)===s;return this.processSegment(l,c,E,A,R?ve:s,!0).pipe(Me(L=>new Yn(_,L instanceof Yn?[L]:[])))}))):bc(t)))}getChildConfig(e,t,r){return t.children?de({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?de({routes:t._loadedRoutes,injector:t._loadedInjector}):cW(e,t,r,this.urlSerializer).pipe(Rt(i=>i?this.configLoader.loadChildren(e,t).pipe(Xt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):dW(t))):de({routes:[],injector:e})}};function EW(n){n.sort((e,t)=>e.value.outlet===ve?-1:t.value.outlet===ve?1:e.value.outlet.localeCompare(t.value.outlet))}function bW(n){let e=n.value.routeConfig;return e&&e.path===""}function NM(n){let e=[],t=new Set;for(let r of n){if(!bW(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=NM(r.children);e.push(new Yn(r.value,i))}return e.filter(r=>!t.has(r))}function CW(n){return n.data||{}}function TW(n){return n.resolve||{}}function SW(n,e,t,r,i,s){return Rt(o=>wW(n,e,t,r,o.extractedUrl,i,s).pipe(Me(({state:a,tree:c})=>lt(q({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function DW(n,e){return Rt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return de(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of PM(c))o.add(l);let a=0;return bt(o).pipe(Eo(c=>s.has(c)?AW(c,r,n,e):(c.data=AE(c,c.parent,n).resolve,de(void 0))),Xt(()=>a++),nc(1),Rt(c=>a===o.size?de(t):Wn))})}function PM(n){let e=n.children.map(t=>PM(t)).flat();return[n,...e]}function AW(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!CM(i)&&(s[fd]=i.title),xW(s,n,e,r).pipe(Me(o=>(n._resolvedData=o,n.data=AE(n,n.parent,t).resolve,null)))}function xW(n,e,t,r){let i=rE(n);if(i.length===0)return de({});let s={};return bt(i).pipe(Rt(o=>RW(n[o],e,t,r).pipe(Qr(),Xt(a=>{s[o]=a}))),nc(1),Ov(s),ds(o=>xM(o)?Wn:Za(o)))}function RW(n,e,t,r){let i=gd(e)??r,s=Nc(n,i),o=s.resolve?s.resolve(e,t):Vi(i,()=>s(e,t));return Ts(o)}function tE(n){return ar(e=>{let t=n(e);return t?bt(t).pipe(Me(()=>e)):de(e)})}var kM=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===ve);return i}getResolvedTitleForRoute(r){return r.data[fd]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>J(NW),providedIn:"root"});let n=e;return n})(),NW=(()=>{let e=class e extends kM{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(ae(Xk))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),yd=new fe("",{providedIn:"root",factory:()=>({})}),Mm=new fe(""),kE=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=J(fm)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return de(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Ts(r.loadComponent()).pipe(Me(MM),Xt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Nu(()=>{this.componentLoaders.delete(r)})),s=new Xa(i,()=>new an).pipe(Ja());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return de({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=PW(i,this.compiler,r,this.onLoadEndListener).pipe(Nu(()=>{this.childrenLoaders.delete(i)})),a=new Xa(o,()=>new an).pipe(Ja());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function PW(n,e,t,r){return Ts(n.loadChildren()).pipe(Me(MM),Rt(i=>i instanceof $u||Array.isArray(i)?de(i):bt(e.compileModuleAsync(i))),Me(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(Mm,[],{optional:!0,self:!0}).flat()),{routes:o.map(NE),injector:s}}))}function kW(n){return n&&typeof n=="object"&&"default"in n}function MM(n){return kW(n)?n.default:n}var ME=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>J(MW),providedIn:"root"});let n=e;return n})(),MW=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),OM=new fe(""),FM=new fe("");function OW(n,e,t){let r=n.get(FM),i=n.get(jn);return n.get(et).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),FW(n))),{onViewTransitionCreated:c}=r;return c&&Vi(n,()=>c({transition:a,from:e,to:t})),o})}function FW(n){return new Promise(e=>{sm(e,{injector:n})})}var OE=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new an,this.transitionAbortSubject=new an,this.configLoader=J(kE),this.environmentInjector=J(On),this.urlSerializer=J(pd),this.rootContexts=J(md),this.location=J(Ec),this.inputBindingEnabled=J(Fm,{optional:!0})!==null,this.titleStrategy=J(kM),this.options=J(yd,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=J(ME),this.createViewTransition=J(OM,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>de(void 0),this.rootComponentType=null;let r=s=>this.events.next(new dE(s)),i=s=>this.events.next(new hE(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(lt(q(q({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new De({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:rd,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(or(o=>o.id!==0),Me(o=>lt(q({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),ar(o=>{let a=!1,c=!1;return de(o).pipe(ar(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Jn.SupersededByNewNavigation),Wn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?lt(q({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&h!=="reload"){let p="";return this.events.next(new Cs(l.id,this.urlSerializer.serialize(l.rawUrl),p,Sm.IgnoredSameUrlNavigation)),l.resolve(null),Wn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return de(l).pipe(ar(p=>{let _=this.transitions?.getValue();return this.events.next(new xc(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),_!==this.transitions?.getValue()?Wn:Promise.resolve(p)}),SW(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Xt(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=lt(q({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let _=new Dm(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(_)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:_,source:E,restoredState:A,extras:R}=l,L=new xc(p,this.urlSerializer.serialize(_),E,A);this.events.next(L);let Y=EM(this.rootComponentType).snapshot;return this.currentTransition=o=lt(q({},l),{targetSnapshot:Y,urlAfterRedirects:_,extras:lt(q({},R),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=_,de(o)}else{let p="";return this.events.next(new Cs(l.id,this.urlSerializer.serialize(l.extractedUrl),p,Sm.IgnoredByUrlHandlingStrategy)),l.resolve(null),Wn}}),Xt(l=>{let d=new aE(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Me(l=>(this.currentTransition=o=lt(q({},l),{guards:qG(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),eW(this.environmentInjector,l=>this.events.next(l)),Xt(l=>{if(o.guardsResult=l.guardsResult,Ac(l.guardsResult))throw SM(this.urlSerializer,l.guardsResult);let d=new cE(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),or(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Jn.GuardRejected),!1)),tE(l=>{if(l.guards.canActivateChecks.length)return de(l).pipe(Xt(d=>{let h=new lE(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),ar(d=>{let h=!1;return de(d).pipe(DW(this.paramsInheritanceStrategy,this.environmentInjector),Xt({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",Jn.NoDataFromResolver)}}))}),Xt(d=>{let h=new uE(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),tE(l=>{let d=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(Xt(_=>{h.component=_}),Me(()=>{})));for(let _ of h.children)p.push(...d(_));return p};return Ru(d(l.targetSnapshot.root)).pipe(hs(null),Li(1))}),tE(()=>this.afterPreactivation()),ar(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return h?bt(h).pipe(Me(()=>o)):de(o)}),Me(l=>{let d=FG(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=lt(q({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),Xt(()=>{this.events.next(new cd)}),HG(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Li(1),Xt({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ii(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Uv(this.transitionAbortSubject.pipe(Xt(l=>{throw l}))),Nu(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Jn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),ds(l=>{if(c=!0,AM(l))this.events.next(new bs(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),UG(l)?this.events.next(new ld(l.url)):o.resolve(!1);else{this.events.next(new ad(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Wn}))}))}cancelNavigationTransition(r,i,s){let o=new bs(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function LW(n){return n!==rd}var VW=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>J(UW),providedIn:"root"});let n=e;return n})(),DE=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},UW=(()=>{let e=class e extends DE{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ko(e)))(s||e)}})(),e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),LM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>J(BW),providedIn:"root"});let n=e;return n})(),BW=(()=>{let e=class e extends LM{constructor(){super(...arguments),this.location=J(Ec),this.urlSerializer=J(pd),this.options=J(yd,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=J(ME),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Es,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=EM(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof xc)this.stateMemento=this.createStateMemento();else if(r instanceof Cs)this.rawUrlTree=i.initialUrl;else if(r instanceof Dm){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof cd?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof bs&&(r.code===Jn.GuardRejected||r.code===Jn.NoDataFromResolver)?this.restoreHistory(i):r instanceof ad?this.restoreHistory(i,!0):r instanceof ii&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=q(q({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=q(q({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ko(e)))(s||e)}})(),e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),td=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(td||{});function VM(n,e){n.events.pipe(or(t=>t instanceof ii||t instanceof bs||t instanceof ad||t instanceof Cs),Me(t=>t instanceof ii||t instanceof Cs?td.COMPLETE:(t instanceof bs?t.code===Jn.Redirect||t.code===Jn.SupersededByNewNavigation:!1)?td.REDIRECTING:td.FAILED),or(t=>t!==td.REDIRECTING),Li(1)).subscribe(()=>{e()})}function jW(n){throw n}var $W={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},HW={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},tt=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=J(lm),this.stateManager=J(LM),this.options=J(yd,{optional:!0})||{},this.pendingTasks=J(am),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=J(OE),this.urlSerializer=J(pd),this.location=J(Ec),this.urlHandlingStrategy=J(ME),this._events=new an,this.errorHandler=this.options.errorHandler||jW,this.navigated=!1,this.routeReuseStrategy=J(VW),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=J(Mm,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!J(Fm,{optional:!0}),this.eventsSubscription=new Bt,this.isNgZoneEnabled=J(et)instanceof et&&et.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof bs&&i.code!==Jn.Redirect&&i.code!==Jn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof ii)this.navigated=!0;else if(i instanceof ld){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||LW(s.source)};this.scheduleNavigation(a,rd,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}zW(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),rd,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=q({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(NE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=q(q({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let _=s?s.snapshot:this.routerState.snapshot.root;p=yM(_)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),p=this.currentUrlTree.root}return vM(p,r,h,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Ac(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,rd,null,i)}navigate(r,i={skipLocationChange:!1}){return qW(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=q({},$W):i===!1?s=q({},HW):s=i,Ac(r))return eM(this.currentUrlTree,r,s);let o=this.parseUrl(r);return eM(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,d;a?(c=a.resolve,l=a.reject,d=a.promise):d=new Promise((p,_)=>{c=p,l=_});let h=this.pendingTasks.add();return VM(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function qW(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ie(4008,!1)}function zW(n){return!(n instanceof cd)&&!(n instanceof ld)}var Pc=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new an,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof ii&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:VP(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(te(tt),te(Fr),tI("tabindex"),te(Is),te(ji),te(Or))},e.\u0275dir=Kn({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&H("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&cm("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[lr.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Ic],skipLocationChange:[lr.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Ic],replaceUrl:[lr.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Ic],routerLink:"routerLink"},standalone:!0,features:[yI,_c]});let n=e;return n})();var Om=class{};var GW=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(or(r=>r instanceof ii),Eo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=om(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return bt(s).pipe(ec())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=de(null);let o=s.pipe(Rt(a=>a===null?de(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return bt([o,a]).pipe(ec())}else return o})}};e.\u0275fac=function(i){return new(i||e)(ae(tt),ae(fm),ae(On),ae(Om),ae(kE))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),UM=new fe(""),WW=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=J(On),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof xc?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof ii?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Cs&&r.code===Sm.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Am&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>g(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),sm(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Am(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){YP()},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})();function KW(n){return n.routerState.root}function vd(n,e){return{\u0275kind:n,\u0275providers:e}}function QW(){let n=J(Mr);return e=>{let t=n.get(wc);if(e!==t.components[0])return;let r=n.get(tt),i=n.get(BM);n.get(FE)===1&&r.initialNavigation(),n.get(jM,null,be.Optional)?.setUpPreloading(),n.get(UM,null,be.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var BM=new fe("",{factory:()=>new an}),FE=new fe("",{providedIn:"root",factory:()=>1});function YW(){return vd(2,[{provide:FE,useValue:0},{provide:hm,multi:!0,deps:[Mr],useFactory:e=>{let t=e.get(Vk,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(tt),s=e.get(BM);VM(i,()=>{r(!0)}),e.get(OE).afterPreactivation=()=>(r(!0),s.closed?de(void 0):s),i.initialNavigation()}))}}])}function JW(){return vd(3,[{provide:hm,multi:!0,useFactory:()=>{let e=J(tt);return()=>{e.setUpLocationChangeListener()}}},{provide:FE,useValue:2}])}var jM=new fe("");function XW(n){return vd(0,[{provide:jM,useExisting:GW},{provide:Om,useExisting:n}])}function ZW(){return vd(8,[iM,{provide:Fm,useExisting:iM}])}function e5(n){let e=[{provide:OM,useValue:OW},{provide:FM,useValue:q({skipNextTransition:!!n?.skipInitialTransition},n)}];return vd(9,e)}var oM=new fe("ROUTER_FORROOT_GUARD"),t5=[Ec,{provide:pd,useClass:sd},tt,md,{provide:Fr,useFactory:KW,deps:[tt]},kE,[]],LE=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[t5,[],{provide:Mm,multi:!0,useValue:r},{provide:oM,useFactory:s5,deps:[[tt,new $p,new Vw]]},{provide:yd,useValue:i||{}},i?.useHash?r5():i5(),n5(),i?.preloadingStrategy?XW(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?o5(i):[],i?.bindToComponentInputs?ZW().\u0275providers:[],i?.enableViewTransitions?e5().\u0275providers:[],a5()]}}static forChild(r){return{ngModule:e,providers:[{provide:Mm,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(ae(oM,8))},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({});let n=e;return n})();function n5(){return{provide:UM,useFactory:()=>{let n=J($k),e=J(et),t=J(yd),r=J(OE),i=J(pd);return t.scrollOffset&&n.setOffset(t.scrollOffset),new WW(i,r,n,e,t)}}}function r5(){return{provide:Or,useClass:gm}}function i5(){return{provide:Or,useClass:jI}}function s5(n){return"guarded"}function o5(n){return[n.initialNavigation==="disabled"?JW().\u0275providers:[],n.initialNavigation==="enabledBlocking"?YW().\u0275providers:[]]}var aM=new fe("");function a5(){return[{provide:aM,useFactory:QW},{provide:DI,multi:!0,useExisting:aM}]}var UE={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var $=function(n,e){if(!n)throw Bo(e)},Bo=function(n){return new Error("Firebase Database ("+UE.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var HM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},c5=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Um={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4,p=(a&15)<<2|l>>6,_=l&63;c||(_=64,o||(p=64)),r.push(t[d],t[h],t[p],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(HM(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):c5(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new BE;let p=s<<2|a>>4;if(r.push(p),l!==64){let _=a<<4&240|l>>2;if(r.push(_),h!==64){let E=l<<6&192|h;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},BE=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},$E=function(n){let e=HM(n);return Um.encodeByteArray(e,!0)},wd=function(n){return $E(n).replace(/\./g,"")},Id=function(n){try{return Um.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function qM(n){return Mc(void 0,n)}function Mc(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!l5(t)||(n[t]=Mc(n[t],e[t]));return n}function l5(n){return n!=="__proto__"}function u5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var d5=()=>u5().__FIREBASE_DEFAULTS__,h5=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},f5=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Id(n[1]);return e&&JSON.parse(e)},HE=()=>{try{return d5()||h5()||f5()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var qE=()=>{var n;return(n=HE())===null||n===void 0?void 0:n.config},zM=n=>{var e;return(e=HE())===null||e===void 0?void 0:e[`_${n}`]};var jt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Oc(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[wd(JSON.stringify(t)),wd(JSON.stringify(o)),""].join(".")}function Je(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ed(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Je())}function Bm(){var n;let e=(n=HE())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function jm(){return typeof self=="object"&&self.self===self}function $m(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function jo(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Hm(){let n=Je();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ai(){return UE.NODE_CLIENT===!0||UE.NODE_ADMIN===!0}function zE(){return!Bm()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ss(){try{return typeof indexedDB=="object"}catch{return!1}}function GM(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var p5="FirebaseError",yt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=p5,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gr.prototype.create)}},gr=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?m5(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new yt(i,a,r)}};function m5(n,e){return n.replace(g5,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var g5=/\{\$([^}]+)}/g;function kc(n){return JSON.parse(n)}function Nt(n){return JSON.stringify(n)}var WM=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=kc(Id(s[0])||""),t=kc(Id(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var KM=function(n){let e=WM(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},QM=function(n){let e=WM(n).claims;return typeof e=="object"&&e.admin===!0};function In(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ds(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Fc(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function bd(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function As(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if($M(s)&&$M(o)){if(!As(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function $M(n){return n!==null&&typeof n=="object"}function zi(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function xs(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Lc(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var Vm=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){let p=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(p<<1|p>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,d;for(let h=0;h<80;h++){h<40?h<20?(l=a^s&(o^a),d=1518500249):(l=s^o^a,d=1859775393):h<60?(l=s&o|a&(s|o),d=2400959708):(l=s^o^a,d=3395469782);let p=(i<<5|i>>>27)+l+c+d+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=p}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function qm(n,e){let t=new jE(n,e);return t.subscribe.bind(t)}var jE=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");_5(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=VE),i.error===void 0&&(i.error=VE),i.complete===void 0&&(i.complete=VE);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function _5(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function VE(){}var le=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){let s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function un(n,e){return`${n} failed: ${e} argument `}function $t(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(un(n,e)+"must be a valid function.")}function GE(n,e,t,r){if(!(r&&!t)&&(typeof t!="object"||t===null))throw new Error(un(n,e)+"must be a valid context object.")}var YM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,$(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Cd=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var xae=4*60*60*1e3;function G(n){return n&&n._delegate?n._delegate:n}var Ke=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var $o="[DEFAULT]";var Ho=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new jt;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(v5(e))try{this.getOrInitializeService({instanceIdentifier:$o})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=$o){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=$o){return this.instances.has(e)}getOptions(e=$o){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:y5(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$o){return this.component?this.component.multipleInstances?e:$o:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function y5(n){return n===$o?void 0:n}function v5(n){return n.instantiationMode==="EAGER"}var Rs=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Ho(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var c0={};s$(c0,{FirebaseError:()=>yt,SDK_VERSION:()=>bn,_DEFAULT_ENTRY_NAME:()=>li,_addComponent:()=>Bc,_addOrOverwriteComponent:()=>s0,_apps:()=>Ns,_clearComponents:()=>o9,_components:()=>Uc,_getProvider:()=>jc,_isFirebaseApp:()=>d1,_isFirebaseServerApp:()=>ft,_registerComponent:()=>En,_removeServiceInstance:()=>u1,_serverApps:()=>Vc,deleteApp:()=>Qm,getApp:()=>Sd,getApps:()=>l9,initializeApp:()=>Km,initializeServerApp:()=>c9,onLog:()=>o0,registerVersion:()=>Tt,setLogLevel:()=>a0});var WE=[],we=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(we||{}),JM={debug:we.DEBUG,verbose:we.VERBOSE,info:we.INFO,warn:we.WARN,error:we.ERROR,silent:we.SILENT},w5=we.INFO,I5={[we.DEBUG]:"log",[we.VERBOSE]:"log",[we.INFO]:"info",[we.WARN]:"warn",[we.ERROR]:"error"},E5=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=I5[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},$n=class{constructor(e){this.name=e,this._logLevel=w5,this._logHandler=E5,this._userLogHandler=null,WE.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in we))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?JM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,we.DEBUG,...e),this._logHandler(this,we.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,we.VERBOSE,...e),this._logHandler(this,we.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,we.INFO,...e),this._logHandler(this,we.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,we.WARN,...e),this._logHandler(this,we.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,we.ERROR,...e),this._logHandler(this,we.ERROR,...e)}};function XM(n){WE.forEach(e=>{e.setLogLevel(n)})}function ZM(n,e){for(let t of WE){let r=null;e&&e.level&&(r=JM[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:we[s].toLowerCase(),message:a,args:o,type:i.name})}}}var b5=(n,e)=>e.some(t=>n instanceof t),e1,t1;function C5(){return e1||(e1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function T5(){return t1||(t1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var n1=new WeakMap,QE=new WeakMap,r1=new WeakMap,KE=new WeakMap,JE=new WeakMap;function S5(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(ci(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&n1.set(t,n)}).catch(()=>{}),JE.set(e,n),e}function D5(n){if(QE.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});QE.set(n,e)}var YE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return QE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||r1.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ci(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function i1(n){YE=n(YE)}function A5(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(zm(this),e,...t);return r1.set(r,e.sort?e.sort():[e]),ci(r)}:T5().includes(n)?function(...e){return n.apply(zm(this),e),ci(n1.get(this))}:function(...e){return ci(n.apply(zm(this),e))}}function x5(n){return typeof n=="function"?A5(n):(n instanceof IDBTransaction&&D5(n),b5(n,C5())?new Proxy(n,YE):n)}function ci(n){if(n instanceof IDBRequest)return S5(n);if(KE.has(n))return KE.get(n);let e=x5(n);return e!==n&&(KE.set(n,e),JE.set(e,n)),e}var zm=n=>JE.get(n);function o1(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=ci(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ci(o.result),c.oldVersion,c.newVersion,ci(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var R5=["get","getKey","getAll","getAllKeys","count"],N5=["put","add","delete","clear"],XE=new Map;function s1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(XE.get(e))return XE.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=N5.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||R5.includes(t)))return;let s=function(o,...a){return g(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return XE.set(e,s),s}i1(n=>lt(q({},n),{get:(e,t,r)=>s1(e,t)||n.get(e,t,r),has:(e,t)=>!!s1(e,t)||n.has(e,t)}));var e0=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(P5(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function P5(n){let e=n.getComponent();return e?.type==="VERSION"}var Gm="@firebase/app",t0="0.10.5";var qo=new $n("@firebase/app"),k5="@firebase/app-compat",M5="@firebase/analytics-compat",O5="@firebase/analytics",F5="@firebase/app-check-compat",L5="@firebase/app-check",V5="@firebase/auth",U5="@firebase/auth-compat",B5="@firebase/database",j5="@firebase/database-compat",$5="@firebase/functions",H5="@firebase/functions-compat",q5="@firebase/installations",z5="@firebase/installations-compat",G5="@firebase/messaging",W5="@firebase/messaging-compat",K5="@firebase/performance",Q5="@firebase/performance-compat",Y5="@firebase/remote-config",J5="@firebase/remote-config-compat",X5="@firebase/storage",Z5="@firebase/storage-compat",e9="@firebase/firestore",t9="@firebase/vertexai-preview",n9="@firebase/firestore-compat",r9="firebase",i9="10.12.2";var li="[DEFAULT]",s9={[Gm]:"fire-core",[k5]:"fire-core-compat",[O5]:"fire-analytics",[M5]:"fire-analytics-compat",[L5]:"fire-app-check",[F5]:"fire-app-check-compat",[V5]:"fire-auth",[U5]:"fire-auth-compat",[B5]:"fire-rtdb",[j5]:"fire-rtdb-compat",[$5]:"fire-fn",[H5]:"fire-fn-compat",[q5]:"fire-iid",[z5]:"fire-iid-compat",[G5]:"fire-fcm",[W5]:"fire-fcm-compat",[K5]:"fire-perf",[Q5]:"fire-perf-compat",[Y5]:"fire-rc",[J5]:"fire-rc-compat",[X5]:"fire-gcs",[Z5]:"fire-gcs-compat",[e9]:"fire-fst",[n9]:"fire-fst-compat",[t9]:"fire-vertex","fire-js":"fire-js",[r9]:"fire-js-all"};var Ns=new Map,Vc=new Map,Uc=new Map;function Bc(n,e){try{n.container.addComponent(e)}catch(t){qo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function s0(n,e){n.container.addOrOverwriteComponent(e)}function En(n){let e=n.name;if(Uc.has(e))return qo.debug(`There were multiple attempts to register component ${e}.`),!1;Uc.set(e,n);for(let t of Ns.values())Bc(t,n);for(let t of Vc.values())Bc(t,n);return!0}function jc(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function u1(n,e,t=li){jc(n,e).clearInstance(t)}function d1(n){return n.options!==void 0}function ft(n){return n.settings!==void 0}function o9(){Uc.clear()}var a9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_r=new gr("app","Firebase",a9);var Wm=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ke("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _r.create("app-deleted",{appName:this._name})}};var n0=class extends Wm{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Tt(Gm,t0,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Qm(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw _r.create("server-app-deleted")}};var bn=i9;function Km(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:li,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw _r.create("bad-app-name",{appName:String(i)});if(t||(t=qE()),!t)throw _r.create("no-options");let s=Ns.get(i);if(s){if(As(t,s.options)&&As(r,s.config))return s;throw _r.create("duplicate-app",{appName:i})}let o=new Rs(i);for(let c of Uc.values())o.addComponent(c);let a=new Wm(t,r,o);return Ns.set(i,a),a}function c9(n,e){if(jm())throw _r.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;d1(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=l=>[...l].reduce((d,h)=>Math.imul(31,d)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw _r.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=Vc.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new Rs(s);for(let l of Uc.values())a.addComponent(l);let c=new n0(t,e,s,a);return Vc.set(s,c),c}function Sd(n=li){let e=Ns.get(n);if(!e&&n===li&&qE())return Km();if(!e)throw _r.create("no-app",{appName:n});return e}function l9(){return Array.from(Ns.values())}function Qm(n){return g(this,null,function*(){let e=!1,t=n.name;Ns.has(t)?(e=!0,Ns.delete(t)):Vc.has(t)&&n.decRefCount()<=0&&(Vc.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function Tt(n,e,t){var r;let i=(r=s9[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qo.warn(a.join(" "));return}En(new Ke(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function o0(n,e){if(n!==null&&typeof n!="function")throw _r.create("invalid-log-argument");ZM(n,e)}function a0(n){XM(n)}var u9="firebase-heartbeat-database",d9=1,Td="firebase-heartbeat-store",ZE=null;function h1(){return ZE||(ZE=o1(u9,d9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Td)}catch(t){console.warn(t)}}}}).catch(n=>{throw _r.create("idb-open",{originalErrorMessage:n.message})})),ZE}function h9(n){return g(this,null,function*(){try{let t=(yield h1()).transaction(Td),r=yield t.objectStore(Td).get(f1(n));return yield t.done,r}catch(e){if(e instanceof yt)qo.warn(e.message);else{let t=_r.create("idb-get",{originalErrorMessage:e?.message});qo.warn(t.message)}}})}function a1(n,e){return g(this,null,function*(){try{let r=(yield h1()).transaction(Td,"readwrite");yield r.objectStore(Td).put(e,f1(n)),yield r.done}catch(t){if(t instanceof yt)qo.warn(t.message);else{let r=_r.create("idb-set",{originalErrorMessage:t?.message});qo.warn(r.message)}}})}function f1(n){return`${n.name}!${n.options.appId}`}var f9=1024,p9=30*24*60*60*1e3,r0=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new i0(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return g(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=c1();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=p9}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return g(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=c1(),{heartbeatsToSend:r,unsentEntries:i}=m9(this._heartbeatsCache.heartbeats),s=wd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function c1(){return new Date().toISOString().substring(0,10)}function m9(n,e=f9){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),l1(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),l1(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var i0=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return Ss()?GM().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield h9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return a1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return a1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function l1(n){return wd(JSON.stringify({version:2,heartbeats:n})).length}function g9(n){En(new Ke("platform-logger",e=>new e0(e),"PRIVATE")),En(new Ke("heartbeat",e=>new r0(e),"PRIVATE")),Tt(Gm,t0,n),Tt(Gm,t0,"esm2017"),Tt("fire-js","")}g9("");var l0=class{constructor(e,t){this._delegate=e,this.firebase=t,Bc(e,new Ke("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Qm(this._delegate)))}_getService(e,t=li){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=li){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Bc(this._delegate,e)}_addOrOverwriteComponent(e){s0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var _9={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},p1=new gr("app-compat","Firebase",_9);function y9(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Tt,setLogLevel:a0,onLog:o0,apps:null,SDK_VERSION:bn,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:c0}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||li,!In(e,l))throw p1.create("no-app",{appName:l});return e[l]}i.App=n;function s(l,d={}){let h=Km(l,d);if(In(e,h.name))return e[h.name];let p=new n(h,t);return e[h.name]=p,p}function o(){return Object.keys(e).map(l=>e[l])}function a(l){let d=l.name,h=d.replace("-compat","");if(En(l)&&l.type==="PUBLIC"){let p=(_=i())=>{if(typeof _[h]!="function")throw p1.create("invalid-app-argument",{appName:d});return _[h]()};l.serviceProps!==void 0&&Mc(p,l.serviceProps),t[h]=p,n.prototype[h]=function(..._){return this._getService.bind(this,d).apply(this,l.multipleInstances?_:[])}}return l.type==="PUBLIC"?t[h]:null}function c(l,d){return d==="serverAuth"?null:d}return t}function g1(){let n=y9(l0);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:g1,extendNamespace:e,createSubscribe:qm,ErrorFactory:gr,deepExtend:Mc});function e(t){Mc(n,t)}return n}var v9=g1();var m1=new $n("@firebase/app-compat"),w9="@firebase/app-compat",I9="0.2.35";function E9(n){Tt(w9,I9,n)}if(jm()&&self.firebase!==void 0){m1.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);let n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&m1.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var U=v9;E9();var Yo={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var Fs={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function b9(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function P1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var B0=b9,k1=P1,M1=new gr("auth","Firebase",P1());var Zm=new $n("@firebase/auth");function C9(n,...e){Zm.logLevel<=we.WARN&&Zm.warn(`Auth (${bn}): ${n}`,...e)}function Jm(n,...e){Zm.logLevel<=we.ERROR&&Zm.error(`Auth (${bn}): ${n}`,...e)}function Mt(n,...e){throw $0(n,...e)}function kt(n,...e){return $0(n,...e)}function j0(n,e,t){let r=Object.assign(Object.assign({},k1()),{[e]:t});return new gr("auth","Firebase",r).create(e,{appName:n.name})}function Gt(n){return j0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qc(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Mt(n,"argument-error"),j0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function $0(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return M1.create(n,...e)}function B(n,e,...t){if(!n)throw $0(e,...t)}function ui(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Jm(e),new Error(e)}function yr(n,e){n||ui(e)}function Nd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function H0(){return _1()==="http:"||_1()==="https:"}function _1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function T9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(H0()||$m()||"connection"in navigator)?navigator.onLine:!0}function S9(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var zo=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,yr(t>e,"Short delay should be less than long delay!"),this.isMobile=Ed()||jo()}get(){return T9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function q0(n,e){yr(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Pd=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ui("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ui("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ui("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var D9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var A9=new zo(3e4,6e4);function vt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function wt(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){return O1(n,i,()=>g(this,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let h=zi(Object.assign({key:n.config.apiKey},d)).slice(1),p=yield n._getAdditionalHeaders();return p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode),Pd.fetch()(F1(n,n.config.apiHost,t,h),Object.assign({method:e,headers:p,referrerPolicy:"no-referrer"},l))}))})}function O1(n,e,t){return g(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},D9),e);try{let i=new p0(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Dd(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Dd(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Dd(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Dd(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw j0(n,d,l);Mt(n,d)}}catch(i){if(i instanceof yt)throw i;Mt(n,"network-request-failed",{message:String(i)})}})}function Ki(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){let l=yield wt(n,e,t,r,i);return"mfaPendingCredential"in l&&Mt(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function F1(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?q0(n.config,i):`${n.config.apiScheme}://${i}`}function x9(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var p0=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(kt(this.auth,"network-request-failed")),A9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Dd(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=kt(n,e,r);return i.customData._tokenResponse=t,i}function y1(n){return n!==void 0&&n.getResponse!==void 0}function v1(n){return n!==void 0&&n.enterprise!==void 0}var m0=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return x9(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function R9(n){return g(this,null,function*(){return(yield wt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})}function N9(n,e){return g(this,null,function*(){return wt(n,"GET","/v2/recaptchaConfig",vt(n,e))})}function P9(n,e){return g(this,null,function*(){return wt(n,"POST","/v1/accounts:delete",e)})}function k9(n,e){return g(this,null,function*(){return wt(n,"POST","/v1/accounts:update",e)})}function L1(n,e){return g(this,null,function*(){return wt(n,"POST","/v1/accounts:lookup",e)})}function Ad(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function V1(n,e=!1){return g(this,null,function*(){let t=G(n),r=yield t.getIdToken(e),i=ug(r);B(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Ad(u0(i.auth_time)),issuedAtTime:Ad(u0(i.iat)),expirationTime:Ad(u0(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function u0(n){return Number(n)*1e3}function ug(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Jm("JWT malformed, contained fewer than 3 sections"),null;try{let i=Id(t);return i?JSON.parse(i):(Jm("Failed to decode base64 JWT payload"),null)}catch(i){return Jm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function w1(n){let e=ug(n);return B(e,"internal-error"),B(typeof e.exp<"u","internal-error"),B(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Wi(n,e,t=!1){return g(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof yt&&M9(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function M9({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var g0=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var kd=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ad(this.lastLoginAt),this.creationTime=Ad(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Md(n){return g(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Wi(n,L1(t,{idToken:r}));B(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?B1(s.providerUserInfo):[],a=O9(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,d=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new kd(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,h)})}function U1(n){return g(this,null,function*(){let e=G(n);yield Md(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function O9(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function B1(n){return n.map(e=>{var{providerId:t}=e,r=Gf(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function F9(n,e){return g(this,null,function*(){let t=yield O1(n,{},()=>g(this,null,function*(){let r=zi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=F1(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Pd.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function L9(n,e){return g(this,null,function*(){return wt(n,"POST","/v2/accounts:revokeToken",vt(n,e))})}var xd=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){B(e.idToken,"internal-error"),B(typeof e.idToken<"u","internal-error"),B(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):w1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){B(e.length!==0,"internal-error");let t=w1(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return g(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(B(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield F9(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(B(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(B(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(B(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return ui("not implemented")}};function Ps(n,e){B(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Go=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Gf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new g0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new kd(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let t=yield Wi(this,this.stsTokenManager.getToken(this.auth,e));return B(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return V1(this,e)}reload(){return U1(this)}_assign(e){this!==e&&(B(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){B(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Md(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(ft(this.auth.app))return Promise.reject(Gt(this.auth));let e=yield this.getIdToken();return yield Wi(this,P9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,d;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=t.photoURL)!==null&&o!==void 0?o:void 0,A=(a=t.tenantId)!==null&&a!==void 0?a:void 0,R=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,L=(l=t.createdAt)!==null&&l!==void 0?l:void 0,Y=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:j,emailVerified:Z,isAnonymous:ue,providerData:ne,stsTokenManager:S}=t;B(j&&S,e,"internal-error");let v=xd.fromJSON(this.name,S);B(typeof j=="string",e,"internal-error"),Ps(h,e.name),Ps(p,e.name),B(typeof Z=="boolean",e,"internal-error"),B(typeof ue=="boolean",e,"internal-error"),Ps(_,e.name),Ps(E,e.name),Ps(A,e.name),Ps(R,e.name),Ps(L,e.name),Ps(Y,e.name);let b=new n({uid:j,auth:e,email:p,emailVerified:Z,displayName:h,isAnonymous:ue,photoURL:E,phoneNumber:_,tenantId:A,stsTokenManager:v,createdAt:L,lastLoginAt:Y});return ne&&Array.isArray(ne)&&(b.providerData=ne.map(D=>Object.assign({},D))),R&&(b._redirectEventId=R),b}static _fromIdTokenResponse(e,t,r=!1){return g(this,null,function*(){let i=new xd;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Md(s),s})}static _fromGetAccountInfoResponse(e,t,r){return g(this,null,function*(){let i=t.users[0];B(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?B1(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new xd;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new kd(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var I1=new Map;function dn(n){yr(n instanceof Function,"Expected a class definition");let e=I1.get(n);return e?(yr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,I1.set(n,e),e)}var V9=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(t,r){return g(this,null,function*(){this.storage[t]=r})}_get(t){return g(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return g(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Ms=V9;function di(n,e,t){return`firebase:${n}:${e}:${t}`}var eg=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=di(this.userKey,i.apiKey,s),this.fullPersistenceKey=di("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Go._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return g(this,null,function*(){if(!t.length)return new n(dn(Ms),e,r);let i=(yield Promise.all(t.map(l=>g(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||dn(Ms),o=di(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let d=yield l._get(o);if(d){let h=Go._fromJSON(e,d);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>g(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,r))})}};function E1(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(H1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(j1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(q1(e))return"Blackberry";if(z1(e))return"Webos";if(z0(e))return"Safari";if((e.includes("chrome/")||$1(e))&&!e.includes("edge/"))return"Chrome";if(zc(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function j1(n=Je()){return/firefox\//i.test(n)}function z0(n=Je()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function $1(n=Je()){return/crios\//i.test(n)}function H1(n=Je()){return/iemobile/i.test(n)}function zc(n=Je()){return/android/i.test(n)}function q1(n=Je()){return/blackberry/i.test(n)}function z1(n=Je()){return/webos/i.test(n)}function Jo(n=Je()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function G1(n=Je()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function U9(n=Je()){var e;return Jo(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function B9(){return Hm()&&document.documentMode===10}function W1(n=Je()){return Jo(n)||zc(n)||z1(n)||q1(n)||/windows phone/i.test(n)||H1(n)}function j9(){try{return!!(window&&window!==window.top)}catch{return!1}}function G0(n,e=[]){let t;switch(n){case"Browser":t=E1(Je());break;case"Worker":t=`${E1(Je())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${bn}/${r}`}var _0=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function $9(t){return g(this,arguments,function*(n,e={}){return wt(n,"GET","/v2/passwordPolicy",vt(n,e))})}var H9=6,y0=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:H9,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var tg=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ng(this),this.idTokenSubscription=new ng(this),this.beforeStateQueue=new _0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=M1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=dn(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield eg.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let t=yield L1(this,{idToken:e}),r=yield Go._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var t;if(ft(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return B(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield Md(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=S9()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(ft(this.app))return Promise.reject(Gt(this));let t=e?G(e):null;return t&&B(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&B(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return ft(this.app)?Promise.reject(Gt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return ft(this.app)?Promise.reject(Gt(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(dn(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield $9(this),t=new y0(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new gr("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield L9(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&dn(e)||this._popupRedirectResolver;B(t,this,"argument-error"),this.redirectPersistenceManager=yield eg.create(this,[dn(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(B(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return B(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=G0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return g(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&C9(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function ot(n){return G(n)}var ng=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=qm(t=>this.observer=t)}get next(){return B(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var qd={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function q9(n){qd=n}function W0(n){return qd.loadJS(n)}function z9(){return qd.recaptchaV2Script}function G9(){return qd.recaptchaEnterpriseScript}function W9(){return qd.gapiScript}function K1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var K9="recaptcha-enterprise",Q9="NO_RECAPTCHA",v0=class{constructor(e){this.type=K9,this.auth=ot(e)}verify(e="verify",t=!1){return g(this,null,function*(){function r(s){return g(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>g(this,null,function*(){N9(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let l=new m0(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;v1(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(Q9)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&v1(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=G9();c.length!==0&&(c+=a),W0(c).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})})}};function b1(n,e,t,r=!1){return g(this,null,function*(){let i=new v0(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function Od(n,e,t,r){return g(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield b1(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>g(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield b1(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function Y9(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(dn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function K0(n,e,t){let r=ot(n);B(r._canInitEmulator,r,"emulator-config-failed"),B(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Q1(e),{host:o,port:a}=J9(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||X9()}function Q1(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function J9(n){let e=Q1(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:C1(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:C1(o)}}}function C1(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function X9(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var hi=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ui("not implemented")}_getIdTokenResponse(e){return ui("not implemented")}_linkToIdToken(e,t){return ui("not implemented")}_getReauthenticationResolver(e){return ui("not implemented")}};function Y1(n,e){return g(this,null,function*(){return wt(n,"POST","/v1/accounts:resetPassword",vt(n,e))})}function Z9(n,e){return g(this,null,function*(){return wt(n,"POST","/v1/accounts:update",e)})}function e6(n,e){return g(this,null,function*(){return wt(n,"POST","/v1/accounts:signUp",e)})}function t6(n,e){return g(this,null,function*(){return wt(n,"POST","/v1/accounts:update",vt(n,e))})}function n6(n,e){return g(this,null,function*(){return Ki(n,"POST","/v1/accounts:signInWithPassword",vt(n,e))})}function dg(n,e){return g(this,null,function*(){return wt(n,"POST","/v1/accounts:sendOobCode",vt(n,e))})}function r6(n,e){return g(this,null,function*(){return dg(n,e)})}function i6(n,e){return g(this,null,function*(){return dg(n,e)})}function s6(n,e){return g(this,null,function*(){return dg(n,e)})}function o6(n,e){return g(this,null,function*(){return dg(n,e)})}function a6(n,e){return g(this,null,function*(){return Ki(n,"POST","/v1/accounts:signInWithEmailLink",vt(n,e))})}function c6(n,e){return g(this,null,function*(){return Ki(n,"POST","/v1/accounts:signInWithEmailLink",vt(n,e))})}var Fd=class n extends hi{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return g(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Od(e,t,"signInWithPassword",n6);case"emailLink":return a6(e,{email:this._email,oobCode:this._password});default:Mt(e,"internal-error")}})}_linkToIdToken(e,t){return g(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Od(e,r,"signUpPassword",e6);case"emailLink":return c6(e,{idToken:t,email:this._email,oobCode:this._password});default:Mt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Gi(n,e){return g(this,null,function*(){return Ki(n,"POST","/v1/accounts:signInWithIdp",vt(n,e))})}var l6="http://localhost",Lr=class n extends hi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Mt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Gf(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return Gi(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Gi(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Gi(e,t)}buildRequest(){let e={requestUri:l6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=zi(t)}return e}};function u6(n,e){return g(this,null,function*(){return wt(n,"POST","/v1/accounts:sendVerificationCode",vt(n,e))})}function d6(n,e){return g(this,null,function*(){return Ki(n,"POST","/v1/accounts:signInWithPhoneNumber",vt(n,e))})}function h6(n,e){return g(this,null,function*(){let t=yield Ki(n,"POST","/v1/accounts:signInWithPhoneNumber",vt(n,e));if(t.temporaryProof)throw Dd(n,"account-exists-with-different-credential",t);return t})}var f6={USER_NOT_FOUND:"user-not-found"};function p6(n,e){return g(this,null,function*(){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Ki(n,"POST","/v1/accounts:signInWithPhoneNumber",vt(n,t),f6)})}var $c=class n extends hi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return d6(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return h6(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return p6(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function m6(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function g6(n){let e=xs(Lc(n)).link,t=e?xs(Lc(e)).deep_link_id:null,r=xs(Lc(n)).deep_link_id;return(r?xs(Lc(r)).link:null)||r||t||e||n}var Ld=class n{constructor(e){var t,r,i,s,o,a;let c=xs(Lc(e)),l=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=m6((i=c.mode)!==null&&i!==void 0?i:null);B(l&&d&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=g6(e);try{return new n(t)}catch{return null}}};var zd=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Fd._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Ld.parseLink(r);return B(i,"argument-error"),Fd._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Vr=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Os=class extends Vr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},Hc=class n extends Os{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return B("providerId"in t&&"signInMethod"in t,"argument-error"),Lr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return B(e.idToken||e.accessToken,"argument-error"),Lr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var hg=(()=>{class n extends Os{constructor(){super("facebook.com")}static credential(t){return Lr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.FACEBOOK_SIGN_IN_METHOD="facebook.com",n.PROVIDER_ID="facebook.com";return n})(),fg=(()=>{class n extends Os{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Lr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})(),pg=(()=>{class n extends Os{constructor(){super("github.com")}static credential(t){return Lr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.GITHUB_SIGN_IN_METHOD="github.com",n.PROVIDER_ID="github.com";return n})(),_6="http://localhost",Wo=class n extends hi{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return Gi(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Gi(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Gi(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:_6,returnSecureToken:!0,pendingToken:this.pendingToken}}};var y6="saml.",Vd=class n extends Vr{constructor(e){B(e.startsWith(y6),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=Wo.fromJSON(e);return B(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Wo._create(r,t)}catch{return null}}};var mg=(()=>{class n extends Os{constructor(){super("twitter.com")}static credential(t,r){return Lr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return n.credential(r,i)}catch{return null}}}n.TWITTER_SIGN_IN_METHOD="twitter.com",n.PROVIDER_ID="twitter.com";return n})();function J1(n,e){return g(this,null,function*(){return Ki(n,"POST","/v1/accounts:signUp",vt(n,e))})}var Ur=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return g(this,null,function*(){let s=yield Go._fromIdTokenResponse(e,r,i),o=T1(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return g(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=T1(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function T1(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function Q0(n){return g(this,null,function*(){var e;if(ft(n.app))return Promise.reject(Gt(n));let t=ot(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Ur({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield J1(t,{returnSecureToken:!0}),i=yield Ur._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var w0=class n extends yt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function X1(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?w0._fromErrorAndOperation(n,s,e,r):s})}function Z1(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}function Y0(n,e){return g(this,null,function*(){let t=G(n);yield gg(!0,t,e);let{providerUserInfo:r}=yield k9(t.auth,{idToken:yield t.getIdToken(),deleteProvider:[e]}),i=Z1(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),yield t.auth._persistUserIfCurrent(t),t})}function J0(n,e,t=!1){return g(this,null,function*(){let r=yield Wi(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Ur._forOperation(n,"link",r)})}function gg(n,e,t){return g(this,null,function*(){yield Md(e);let r=Z1(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";B(r.has(t)===n,e.auth,i)})}function eO(n,e,t=!1){return g(this,null,function*(){let{auth:r}=n;if(ft(r.app))return Promise.reject(Gt(r));let i="reauthenticate";try{let s=yield Wi(n,X1(r,i,e,n),t);B(s.idToken,r,"internal-error");let o=ug(s.idToken);B(o,r,"internal-error");let{sub:a}=o;return B(n.uid===a,r,"user-mismatch"),Ur._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Mt(r,"user-mismatch"),s}})}function tO(n,e,t=!1){return g(this,null,function*(){if(ft(n.app))return Promise.reject(Gt(n));let r="signIn",i=yield X1(n,r,e),s=yield Ur._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Gc(n,e){return g(this,null,function*(){return tO(ot(n),e)})}function _g(n,e){return g(this,null,function*(){let t=G(n);return yield gg(!1,t,e.providerId),J0(t,e)})}function yg(n,e){return g(this,null,function*(){return eO(G(n),e)})}function v6(n,e){return g(this,null,function*(){return Ki(n,"POST","/v1/accounts:signInWithCustomToken",vt(n,e))})}function X0(n,e){return g(this,null,function*(){if(ft(n.app))return Promise.reject(Gt(n));let t=ot(n),r=yield v6(t,{token:e,returnSecureToken:!0}),i=yield Ur._fromIdTokenResponse(t,"signIn",r);return yield t._updateCurrentUser(i.user),i})}var Ko=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?I0._fromServerResponse(e,t):"totpInfo"in t?E0._fromServerResponse(e,t):Mt(e,"internal-error")}},I0=class n extends Ko{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},E0=class n extends Ko{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function vg(n,e,t){var r;B(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),B(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(B(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(B(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function Z0(n){return g(this,null,function*(){let e=ot(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function eb(n,e,t){return g(this,null,function*(){let r=ot(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&vg(r,i,t),yield Od(r,i,"getOobCode",i6)})}function tb(n,e,t){return g(this,null,function*(){yield Y1(G(n),{oobCode:e,newPassword:t}).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Z0(n),r}))})}function nb(n,e){return g(this,null,function*(){yield t6(G(n),{oobCode:e})})}function wg(n,e){return g(this,null,function*(){let t=G(n),r=yield Y1(t,{oobCode:e}),i=r.requestType;switch(B(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":B(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":B(r.mfaInfo,t,"internal-error");default:B(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=Ko._fromServerResponse(ot(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}})}function rb(n,e){return g(this,null,function*(){let{data:t}=yield wg(G(n),e);return t.email})}function ib(n,e,t){return g(this,null,function*(){if(ft(n.app))return Promise.reject(Gt(n));let r=ot(n),o=yield Od(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",J1).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Z0(n),c}),a=yield Ur._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function sb(n,e,t){return ft(n.app)?Promise.reject(Gt(n)):Gc(G(n),zd.credential(e,t)).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Z0(n),r}))}function ob(n,e,t){return g(this,null,function*(){let r=ot(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){B(a.handleCodeInApp,r,"argument-error"),a&&vg(r,o,a)}s(i,t),yield Od(r,i,"getOobCode",s6)})}function ab(n,e){let t=Ld.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}function cb(n,e,t){return g(this,null,function*(){if(ft(n.app))return Promise.reject(Gt(n));let r=G(n),i=zd.credentialWithLink(e,t||Nd());return B(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Gc(r,i)})}function w6(n,e){return g(this,null,function*(){return wt(n,"POST","/v1/accounts:createAuthUri",vt(n,e))})}function lb(n,e){return g(this,null,function*(){let t=H0()?Nd():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=yield w6(G(n),r);return i||[]})}function ub(n,e){return g(this,null,function*(){let t=G(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&vg(t.auth,i,e);let{email:s}=yield r6(t.auth,i);s!==n.email&&(yield n.reload())})}function db(n,e,t){return g(this,null,function*(){let r=G(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield n.getIdToken(),newEmail:e};t&&vg(r.auth,s,t);let{email:o}=yield o6(r.auth,s);o!==n.email&&(yield n.reload())})}function I6(n,e){return g(this,null,function*(){return wt(n,"POST","/v1/accounts:update",e)})}function hb(r,i){return g(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=G(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield Wi(s,I6(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let l=s.providerData.find(({providerId:d})=>d==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function fb(n,e){let t=G(n);return ft(t.auth.app)?Promise.reject(Gt(t.auth)):nO(t,e,null)}function pb(n,e){return nO(G(n),null,e)}function nO(n,e,t){return g(this,null,function*(){let{auth:r}=n,s={idToken:yield n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=yield Wi(n,Z9(r,s));yield n._updateTokensIfNecessary(o,!0)})}function E6(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=ug(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new ks(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new b0(s,i);case"github.com":return new C0(s,i);case"google.com":return new T0(s,i);case"twitter.com":return new S0(s,i,n.screenName||null);case"custom":case"anonymous":return new ks(s,null);default:return new ks(s,r,i)}}var ks=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},rg=class extends ks{constructor(e,t,r,i){super(e,t,r),this.username=i}},b0=class extends ks{constructor(e,t){super(e,"facebook.com",t)}},C0=class extends rg{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},T0=class extends ks{constructor(e,t){super(e,"google.com",t)}},S0=class extends rg{constructor(e,t,r){super(e,"twitter.com",t,r)}};function mb(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:E6(t)}var ig=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var D0=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=ot(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>Ko._fromServerResponse(r,a));B(i.mfaPendingCredential,r,"internal-error");let o=ig._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,a=>g(this,null,function*(){let c=yield a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let l=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let d=yield Ur._fromIdTokenResponse(r,t.operationType,l);return yield r._updateCurrentUser(d.user),d;case"reauthenticate":return B(t.user,r,"internal-error"),Ur._forOperation(t.user,t.operationType,l);default:Mt(r,"internal-error")}}))}resolveSignIn(e){return g(this,null,function*(){let t=e;return this.signInResolver(t)})}};function gb(n,e){var t;let r=G(n),i=e;return B(e.customData.operationType,r,"argument-error"),B((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),D0._fromError(r,i)}function b6(n,e){return wt(n,"POST","/v2/accounts/mfaEnrollment:start",vt(n,e))}function C6(n,e){return wt(n,"POST","/v2/accounts/mfaEnrollment:finalize",vt(n,e))}function T6(n,e){return wt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",vt(n,e))}var A0=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Ko._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}getSession(){return g(this,null,function*(){return ig._fromIdtoken(yield this.user.getIdToken(),this.user)})}enroll(e,t){return g(this,null,function*(){let r=e,i=yield this.getSession(),s=yield Wi(this.user,r._process(this.user.auth,i,t));return yield this.user._updateTokensIfNecessary(s),this.user.reload()})}unenroll(e){return g(this,null,function*(){let t=typeof e=="string"?e:e.uid,r=yield this.user.getIdToken();try{let i=yield Wi(this.user,T6(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),yield this.user._updateTokensIfNecessary(i),yield this.user.reload()}catch(i){throw i}})}},d0=new WeakMap;function _b(n){let e=G(n);return d0.has(e)||d0.set(e,A0._fromUser(e)),d0.get(e)}var sg="__sak";var og=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(sg,"1"),this.storage.removeItem(sg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function S6(){let n=Je();return z0(n)||Jo(n)}var D6=1e3,A6=10,x6=(()=>{class n extends og{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=S6()&&j9(),this.fallbackToPolling=W1(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(i);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);B9()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,A6):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},D6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return g(this,null,function*(){yield Kr(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return g(this,null,function*(){let r=yield Kr(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return g(this,null,function*(){yield Kr(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Wc=x6;var R6=(()=>{class n extends og{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),fi=R6;function N6(n){return Promise.all(n.map(e=>g(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var P6=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return g(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>g(this,null,function*(){return d(r.origin,o)})),l=yield N6(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Xo(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var x0=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return g(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=Xo("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let p=h;if(p.data.eventId===l)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function Pt(){return window}function k6(n){Pt().location.href=n}function yb(){return typeof Pt().WorkerGlobalScope<"u"&&typeof Pt().importScripts=="function"}function M6(){return g(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function O6(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function F6(){return yb()?self:null}var rO="firebaseLocalStorageDb",L6=1,ag="firebaseLocalStorage",iO="fbase_key",Qo=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Ig(n,e){return n.transaction([ag],e?"readwrite":"readonly").objectStore(ag)}function V6(){let n=indexedDB.deleteDatabase(rO);return new Qo(n).toPromise()}function R0(){let n=indexedDB.open(rO,L6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(ag,{keyPath:iO})}catch(i){t(i)}}),n.addEventListener("success",()=>g(this,null,function*(){let r=n.result;r.objectStoreNames.contains(ag)?e(r):(r.close(),yield V6(),e(yield R0()))}))})}function S1(n,e,t){return g(this,null,function*(){let r=Ig(n,!0).put({[iO]:e,value:t});return new Qo(r).toPromise()})}function U6(n,e){return g(this,null,function*(){let t=Ig(n,!1).get(e),r=yield new Qo(t).toPromise();return r===void 0?null:r.value})}function D1(n,e){let t=Ig(n,!0).delete(e);return new Qo(t).toPromise()}var B6=800,j6=3,$6=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db?this.db:(this.db=yield R0(),this.db)})}_withRetries(t){return g(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>j6)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return yb()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=P6._getInstance(F6()),this.receiver._subscribe("keyChanged",(t,r)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var t,r;if(this.activeServiceWorker=yield M6(),!this.activeServiceWorker)return;this.sender=new x0(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return g(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||O6()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;let t=yield R0();return yield S1(t,sg,"1"),yield D1(t,sg),!0}catch{}return!1})}_withPendingWrite(t){return g(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(i=>S1(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return g(this,null,function*(){let r=yield this._withRetries(i=>U6(i,t));return this.localCache[t]=r,r})}_remove(t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(r=>D1(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return g(this,null,function*(){let t=yield this._withRetries(s=>{let o=Ig(s,!1).getAll();return new Qo(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),B6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Zo=$6;function H6(n,e){return wt(n,"POST","/v2/accounts/mfaSignIn:start",vt(n,e))}function q6(n,e){return wt(n,"POST","/v2/accounts/mfaSignIn:finalize",vt(n,e))}var z6=500,G6=6e4,Ym=1e12,N0=class{constructor(e){this.auth=e,this.counter=Ym,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new P0(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||Ym;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||Ym;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}execute(e){return g(this,null,function*(){var t;let r=e||Ym;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""})}},P0=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;B(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=W6(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},G6)},z6))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function W6(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var h0=K1("rcb"),K6=new zo(3e4,6e4),k0=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Pt().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return B(Q6(t),e,"argument-error"),this.shouldResolveImmediately(t)&&y1(Pt().grecaptcha)?Promise.resolve(Pt().grecaptcha):new Promise((r,i)=>{let s=Pt().setTimeout(()=>{i(kt(e,"network-request-failed"))},K6.get());Pt()[h0]=()=>{Pt().clearTimeout(s),delete Pt()[h0];let a=Pt().grecaptcha;if(!a||!y1(a)){i(kt(e,"internal-error"));return}let c=a.render;a.render=(l,d)=>{let h=c(l,d);return this.counter++,h},this.hostLanguage=t,r(a)};let o=`${z9()}?${zi({onload:h0,render:"explicit",hl:t})}`;W0(o).catch(()=>{clearTimeout(s),i(kt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=Pt().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function Q6(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var M0=class{load(e){return g(this,null,function*(){return new N0(e)})}clearedOneInstance(){}};var sO="recaptcha",Y6={theme:"light",type:"image"},Ud=class{constructor(e,t,r=Object.assign({},Y6)){this.parameters=r,this.type=sO,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=ot(e),this.isInvisible=this.parameters.size==="invisible",B(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;B(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new M0:new k0,this.validateStartingState()}verify(){return g(this,null,function*(){this.assertNotDestroyed();let e=yield this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){B(!this.parameters.sitekey,this.auth,"argument-error"),B(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),B(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=Pt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){B(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){return g(this,null,function*(){if(yield this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId})}init(){return g(this,null,function*(){B(H0()&&!yb(),this.auth,"internal-error"),yield J6(),this.recaptcha=yield this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=yield R9(this.auth);B(e,this.auth,"internal-error"),this.parameters.sitekey=e})}getAssertedRecaptcha(){return B(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function J6(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var Bd=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=$c._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};function vb(n,e,t){return g(this,null,function*(){if(ft(n.app))return Promise.reject(Gt(n));let r=ot(n),i=yield Eg(r,e,G(t));return new Bd(i,s=>Gc(r,s))})}function wb(n,e,t){return g(this,null,function*(){let r=G(n);yield gg(!1,r,"phone");let i=yield Eg(r.auth,e,G(t));return new Bd(i,s=>_g(r,s))})}function Ib(n,e,t){return g(this,null,function*(){let r=G(n);if(ft(r.auth.app))return Promise.reject(Gt(r.auth));let i=yield Eg(r.auth,e,G(t));return new Bd(i,s=>yg(r,s))})}function Eg(n,e,t){return g(this,null,function*(){var r;let i=yield t.verify();try{B(typeof i=="string",n,"argument-error"),B(t.type===sO,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return B(o.type==="enroll",n,"internal-error"),(yield b6(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{B(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return B(a,n,"missing-multi-factor-info"),(yield H6(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=yield u6(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}})}function Eb(n,e){return g(this,null,function*(){let t=G(n);if(ft(t.auth.app))return Promise.reject(Gt(t.auth));yield J0(t,e)})}var ea=(()=>{class n{constructor(t){this.providerId=n.PROVIDER_ID,this.auth=ot(t)}verifyPhoneNumber(t,r){return Eg(this.auth,t,G(r))}static credential(t,r){return $c._fromVerification(t,r)}static credentialFromResult(t){let r=t;return n.credentialFromTaggedObject(r)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{phoneNumber:r,temporaryProof:i}=t;return r&&i?$c._fromTokenResponse(r,i):null}}n.PROVIDER_ID="phone",n.PHONE_SIGN_IN_METHOD="phone";return n})();function ta(n,e){return e?dn(e):(B(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var jd=class extends hi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Gi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Gi(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function X6(n){return tO(n.auth,new jd(n),n.bypassAuthState)}function Z6(n){let{auth:e,user:t}=n;return B(t,e,"internal-error"),eO(t,new jd(n),n.bypassAuthState)}function e8(n){return g(this,null,function*(){let{auth:e,user:t}=n;return B(t,e,"internal-error"),J0(t,new jd(n),n.bypassAuthState)})}var cg=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return g(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return X6;case"linkViaPopup":case"linkViaRedirect":return e8;case"reauthViaPopup":case"reauthViaRedirect":return Z6;default:Mt(this.auth,"internal-error")}}resolve(e){yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var t8=new zo(2e3,1e4);function bb(n,e,t){return g(this,null,function*(){if(ft(n.app))return Promise.reject(kt(n,"operation-not-supported-in-this-environment"));let r=ot(n);qc(n,e,Vr);let i=ta(r,t);return new Sb(r,"signInViaPopup",e,i).executeNotNull()})}function Cb(n,e,t){return g(this,null,function*(){let r=G(n);if(ft(r.auth.app))return Promise.reject(kt(r.auth,"operation-not-supported-in-this-environment"));qc(r.auth,e,Vr);let i=ta(r.auth,t);return new Sb(r.auth,"reauthViaPopup",e,i,r).executeNotNull()})}function Tb(n,e,t){return g(this,null,function*(){let r=G(n);qc(r.auth,e,Vr);let i=ta(r.auth,t);return new Sb(r.auth,"linkViaPopup",e,i,r).executeNotNull()})}var Sb=(()=>{class n extends cg{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return g(this,null,function*(){let t=yield this.execute();return B(t,this.auth,"internal-error"),t})}onExecution(){return g(this,null,function*(){yr(this.filter.length===1,"Popup operations only handle one event");let t=Xo();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(kt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(kt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(kt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,t8.get())};t()}}n.currentPopupAction=null;return n})(),n8="pendingRedirect",Rd=new Map,O0=class n extends cg{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return g(this,null,function*(){let e=Rd.get(this.auth._key());if(!e){try{let r=(yield r8(this.resolver,this.auth))?yield Kr(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Rd.set(this.auth._key(),e)}return this.bypassAuthState||Rd.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if(e.type==="signInViaRedirect")return Kr(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Kr(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return g(this,null,function*(){})}cleanUp(){}};function r8(n,e){return g(this,null,function*(){let t=cO(e),r=aO(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Db(n,e){return g(this,null,function*(){return aO(n)._set(cO(e),"true")})}function oO(){Rd.clear()}function Kc(n,e){Rd.set(n._key(),e)}function aO(n){return dn(n._redirectPersistence)}function cO(n){return di(n8,n.config.apiKey,n.name)}function Ab(n,e,t){return i8(n,e,t)}function i8(n,e,t){return g(this,null,function*(){if(ft(n.app))return Promise.reject(Gt(n));let r=ot(n);qc(n,e,Vr),yield r._initializationPromise;let i=ta(r,t);return yield Db(i,r),i._openRedirect(r,e,"signInViaRedirect")})}function xb(n,e,t){return s8(n,e,t)}function s8(n,e,t){return g(this,null,function*(){let r=G(n);if(qc(r.auth,e,Vr),ft(r.auth.app))return Promise.reject(Gt(r.auth));yield r.auth._initializationPromise;let i=ta(r.auth,t);yield Db(i,r.auth);let s=yield lO(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)})}function Rb(n,e,t){return o8(n,e,t)}function o8(n,e,t){return g(this,null,function*(){let r=G(n);qc(r.auth,e,Vr),yield r.auth._initializationPromise;let i=ta(r.auth,t);yield gg(!1,r,e.providerId),yield Db(i,r.auth);let s=yield lO(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)})}function Nb(n,e){return g(this,null,function*(){return yield ot(n)._initializationPromise,na(n,e,!1)})}function na(n,e,t=!1){return g(this,null,function*(){if(ft(n.app))return Promise.reject(Gt(n));let r=ot(n),i=ta(r,e),o=yield new O0(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}function lO(n){return g(this,null,function*(){let e=Xo(`${n.uid}:::`);return n._redirectEventId=e,yield n.auth._setRedirectUser(n),yield n.auth._persistUserIfCurrent(n),e})}var a8=10*60*1e3,$d=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!c8(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!uO(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(kt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=a8&&this.cachedEventUids.clear(),this.cachedEventUids.has(A1(e))}saveEventToCache(e){this.cachedEventUids.add(A1(e)),this.lastProcessedEventTime=Date.now()}};function A1(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function uO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function c8(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return uO(n);default:return!1}}function Pb(t){return g(this,arguments,function*(n,e={}){return wt(n,"GET","/v1/projects",e)})}var l8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,u8=/^https?/;function d8(n){return g(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield Pb(n);for(let t of e)try{if(h8(t))return}catch{}Mt(n,"unauthorized-domain")})}function h8(n){let e=Nd(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!u8.test(t))return!1;if(l8.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var f8=new zo(3e4,6e4);function x1(){let n=Pt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function p8(n){return new Promise((e,t)=>{var r,i,s;function o(){x1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{x1(),t(kt(n,"network-request-failed"))},timeout:f8.get()})}if(!((i=(r=Pt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Pt().gapi)===null||s===void 0)&&s.load)o();else{let a=K1("iframefcb");return Pt()[a]=()=>{gapi.load?o():t(kt(n,"network-request-failed"))},W0(`${W9()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Xm=null,e})}var Xm=null;function m8(n){return Xm=Xm||p8(n),Xm}var g8=new zo(5e3,15e3),_8="__/auth/iframe",y8="emulator/auth/iframe",v8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},w8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function I8(n){let e=n.config;B(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?q0(e,y8):`https://${n.config.authDomain}/${_8}`,r={apiKey:e.apiKey,appName:n.name,v:bn},i=w8.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${zi(r).slice(1)}`}function E8(n){return g(this,null,function*(){let e=yield m8(n),t=Pt().gapi;return B(t,n,"internal-error"),e.open({where:document.body,url:I8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:v8,dontclear:!0},r=>new Promise((i,s)=>g(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=kt(n,"network-request-failed"),a=Pt().setTimeout(()=>{s(o)},g8.get());function c(){Pt().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var b8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},C8=500,T8=600,S8="_blank",D8="http://localhost",Hd=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function A8(n,e,t,r=C8,i=T8){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},b8),{width:r.toString(),height:i.toString(),top:s,left:o}),l=Je().toLowerCase();t&&(a=$1(l)?S8:t),j1(l)&&(e=e||D8,c.scrollbars="yes");let d=Object.entries(c).reduce((p,[_,E])=>`${p}${_}=${E},`,"");if(U9(l)&&a!=="_self")return x8(e||"",a),new Hd(null);let h=window.open(e||"",a,d);B(h,n,"popup-blocked");try{h.focus()}catch{}return new Hd(h)}function x8(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var R8="__/auth/handler",N8="emulator/auth/handler",P8=encodeURIComponent("fac");function lg(n,e,t,r,i,s){return g(this,null,function*(){B(n.config.authDomain,n,"auth-domain-config-required"),B(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:bn,eventId:i};if(e instanceof Vr){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Fc(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(s||{}))o[d]=h}if(e instanceof Os){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),l=c?`#${P8}=${encodeURIComponent(c)}`:"";return`${k8(n)}?${zi(a).slice(1)}${l}`})}function k8({config:n}){return n.emulator?q0(n,N8):`https://${n.authDomain}/${R8}`}var f0="webStorageSupport",F0=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fi,this._completeRedirectFn=na,this._overrideRedirectResult=Kc}_openPopup(e,t,r,i){return g(this,null,function*(){var s;yr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield lg(e,t,r,Nd(),i);return A8(e,o,Xo())})}_openRedirect(e,t,r,i){return g(this,null,function*(){yield this._originValidation(e);let s=yield lg(e,t,r,Nd(),i);return k6(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(yr(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return g(this,null,function*(){let t=yield E8(e),r=new $d(e);return t.register("authEvent",i=>(B(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(f0,{type:f0},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[f0];o!==void 0&&t(!!o),Mt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=d8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return W1()||z0()||Jo()}},kb=F0,L0=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return ui("unexpected MultiFactorSessionType")}}},V0=class n extends L0{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return C6(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return q6(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},Mb=(()=>{class n{constructor(){}static assertion(t){return V0._fromCredential(t)}}return n.FACTOR_ID="phone",n})();var R1="@firebase/auth",N1="1.7.4";var U0=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){B(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function M8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function O8(n){En(new Ke("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;B(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:G0(n)},l=new tg(r,i,s,c);return Y9(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),En(new Ke("auth-internal",e=>{let t=ot(e.getProvider("auth").getImmediate());return(r=>new U0(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Tt(R1,N1,M8(n)),Tt(R1,N1,"esm2017")}var F8=5*60,rce=zM("authIdTokenMaxAge")||F8;function L8(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}q9({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=kt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",L8().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});O8("Browser");function ra(){return window}var V8=2e3;function U8(n,e,t){return g(this,null,function*(){var r;let{BuildInfo:i}=ra();yr(e.sessionId,"AuthEvent did not contain a session ID");let s=yield q8(e.sessionId),o={};return Jo()?o.ibi=i.packageName:zc()?o.apn=i.packageName:Mt(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,lg(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)})}function B8(n){return g(this,null,function*(){let{BuildInfo:e}=ra(),t={};Jo()?t.iosBundleId=e.packageName:zc()?t.androidPackageName=e.packageName:Mt(n,"operation-not-supported-in-this-environment"),yield Pb(n,t)})}function j8(n){let{cordova:e}=ra();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,G1()?"_blank":"_system","location=yes"),t(i)})})}function $8(n,e,t){return g(this,null,function*(){let{cordova:r}=ra(),i=()=>{};try{yield new Promise((s,o)=>{let a=null;function c(){var h;s();let p=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof p=="function"&&p(),typeof t?.close=="function"&&t.close()}function l(){a||(a=window.setTimeout(()=>{o(kt(n,"redirect-cancelled-by-user"))},V8))}function d(){document?.visibilityState==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),zc()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}})}function H8(n){var e,t,r,i,s,o,a,c,l,d;let h=ra();B(typeof((e=h?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),B(typeof((t=h?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),B(typeof((s=(i=(r=h?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),B(typeof((c=(a=(o=h?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),B(typeof((d=(l=h?.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function q8(n){return g(this,null,function*(){let e=z8(n),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")})}function z8(n){if(yr(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var G8=20,Ob=class extends $d{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}initialized(){return g(this,null,function*(){yield this.initPromise})}};function W8(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:Y8(),postBody:null,tenantId:n.tenantId,error:kt(n,"no-auth-event")}}function K8(n,e){return Fb()._set(Lb(n),e)}function dO(n){return g(this,null,function*(){let e=yield Fb()._get(Lb(n));return e&&(yield Fb()._remove(Lb(n))),e})}function Q8(n,e){var t,r;let i=X8(e);if(i.includes("/__/auth/callback")){let s=bg(i),o=s.firebaseError?J8(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?kt(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function Y8(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<G8;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function Fb(){return dn(Wc)}function Lb(n){return di("authEvent",n.config.apiKey,n.name)}function J8(n){try{return JSON.parse(n)}catch{return null}}function X8(n){let e=bg(n),t=e.link?decodeURIComponent(e.link):void 0,r=bg(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return bg(i).link||i||r||t||n}function bg(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return xs(t.join("?"))}var Z8=500,Vb=class{constructor(){this._redirectPersistence=fi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=na,this._overrideRedirectResult=Kc}_initialize(e){return g(this,null,function*(){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new Ob(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r})}_openPopup(e){Mt(e,"operation-not-supported-in-this-environment")}_openRedirect(e,t,r,i){return g(this,null,function*(){H8(e);let s=yield this._initialize(e);yield s.initialized(),s.resetRedirect(),oO(),yield this._originValidation(e);let o=W8(e,r,i);yield K8(e,o);let a=yield U8(e,o,t),c=yield j8(a);return $8(e,s,c)})}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=B8(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=ra(),o=setTimeout(()=>g(this,null,function*(){yield dO(e),t.onEvent(hO())}),Z8),a=d=>g(this,null,function*(){clearTimeout(o);let h=yield dO(e),p=null;h&&d?.url&&(p=Q8(h,d.url)),t.onEvent(p||hO())});typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,l=`${s.packageName.toLowerCase()}://`;ra().handleOpenURL=d=>g(this,null,function*(){if(d.toLowerCase().startsWith(l)&&a({url:d}),typeof c=="function")try{c(d)}catch(h){console.error(h)}})}},fO=Vb;function hO(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:kt("no-auth-event")}}function pO(n,e){ot(n)._logFramework(e)}var tK="@firebase/auth-compat",nK="0.5.9";var rK=1e3;function Kd(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function iK(){return Kd()==="http:"||Kd()==="https:"}function _O(n=Je()){return!!((Kd()==="file:"||Kd()==="ionic:"||Kd()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function sK(){return jo()||Bm()}function oK(){return Hm()&&document?.documentMode===11}function aK(n=Je()){return/Edge\/\d+/.test(n)}function cK(n=Je()){return oK()||aK(n)}function yO(){try{let n=self.localStorage,e=Xo();if(n)return n.setItem(e,"1"),n.removeItem(e),cK()?Ss():!0}catch{return qb()&&Ss()}return!1}function qb(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Ub(){return(iK()||$m()||_O())&&!sK()&&yO()&&!qb()}function vO(){return _O()&&typeof document<"u"}function lK(){return g(this,null,function*(){return vO()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},rK);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1})}function uK(){return typeof window<"u"?window:null}var Xn={LOCAL:"local",NONE:"none",SESSION:"session"},Gd=B,wO="persistence";function dK(n,e){if(Gd(Object.values(Xn).includes(e),n,"invalid-persistence-type"),jo()){Gd(e!==Xn.SESSION,n,"unsupported-persistence-type");return}if(Bm()){Gd(e===Xn.NONE,n,"unsupported-persistence-type");return}if(qb()){Gd(e===Xn.NONE||e===Xn.LOCAL&&Ss(),n,"unsupported-persistence-type");return}Gd(e===Xn.NONE||yO(),n,"unsupported-persistence-type")}function Bb(n){return g(this,null,function*(){yield n._initializationPromise;let e=IO(),t=di(wO,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())})}function hK(n,e){let t=IO();if(!t)return[];let r=di(wO,n,e);switch(t.getItem(r)){case Xn.NONE:return[Ms];case Xn.LOCAL:return[Zo,fi];case Xn.SESSION:return[fi];default:return[]}}function IO(){var n;try{return((n=uK())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var fK=B,pi=class{constructor(){this.browserResolver=dn(kb),this.cordovaResolver=dn(fO),this.underlyingResolver=null,this._redirectPersistence=fi,this._completeRedirectFn=na,this._overrideRedirectResult=Kc}_initialize(e){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)})}_openPopup(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)})}_openRedirect(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)})}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return vO()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return fK(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){return g(this,null,function*(){if(this.underlyingResolver)return;let e=yield lK();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver})}};function EO(n){return n.unwrap()}function pK(n){return n.wrapped()}function mK(n){return bO(n)}function gK(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new $b(n,gb(n,e))}else if(r){let i=bO(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function bO(n){let{_tokenResponse:e}=n instanceof yt?n.customData:n;if(!e)return null;if(!(n instanceof yt)&&"temporaryProof"in e&&"phoneNumber"in e)return ea.credentialFromResult(n);let t=e.providerId;if(!t||t===Yo.PASSWORD)return null;let r;switch(t){case Yo.GOOGLE:r=fg;break;case Yo.FACEBOOK:r=hg;break;case Yo.GITHUB:r=pg;break;case Yo.TWITTER:r=mg;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?Wo._create(t,a):Lr._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new Hc(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof yt?r.credentialFromError(n):r.credentialFromResult(n)}function Hn(n,e){return e.catch(t=>{throw t instanceof yt&&gK(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:mK(t),additionalUserInfo:mb(t),user:Qc.getOrCreate(i)}})}function jb(n,e){return g(this,null,function*(){let t=yield e;return{verificationId:t.verificationId,confirm:r=>Hn(n,t.confirm(r))}})}var $b=class{constructor(e,t){this.resolver=t,this.auth=pK(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Hn(EO(this.auth),this.resolver.resolveSignIn(e))}};var Qc=class n{constructor(e){this._delegate=e,this.multiFactor=_b(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}linkWithCredential(e){return g(this,null,function*(){return Hn(this.auth,_g(this._delegate,e))})}linkWithPhoneNumber(e,t){return g(this,null,function*(){return jb(this.auth,wb(this._delegate,e,t))})}linkWithPopup(e){return g(this,null,function*(){return Hn(this.auth,Tb(this._delegate,e,pi))})}linkWithRedirect(e){return g(this,null,function*(){return yield Bb(ot(this.auth)),Rb(this._delegate,e,pi)})}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}reauthenticateWithCredential(e){return g(this,null,function*(){return Hn(this.auth,yg(this._delegate,e))})}reauthenticateWithPhoneNumber(e,t){return jb(this.auth,Ib(this._delegate,e,t))}reauthenticateWithPopup(e){return Hn(this.auth,Cb(this._delegate,e,pi))}reauthenticateWithRedirect(e){return g(this,null,function*(){return yield Bb(ot(this.auth)),xb(this._delegate,e,pi)})}sendEmailVerification(e){return ub(this._delegate,e)}unlink(e){return g(this,null,function*(){return yield Y0(this._delegate,e),this})}updateEmail(e){return fb(this._delegate,e)}updatePassword(e){return pb(this._delegate,e)}updatePhoneNumber(e){return Eb(this._delegate,e)}updateProfile(e){return hb(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return db(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Qc.USER_MAP=new WeakMap;var Wd=B,mO=(()=>{class n{constructor(t,r){if(this.app=t,r.isInitialized()){this._delegate=r.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:i}=t.options;Wd(i,"invalid-api-key",{appName:t.name}),Wd(i,"invalid-api-key",{appName:t.name});let s=typeof window<"u"?pi:void 0;this._delegate=r.initialize({options:{persistence:_K(i,t.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(B0),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Qc.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,r){K0(this._delegate,t,r)}applyActionCode(t){return nb(this._delegate,t)}checkActionCode(t){return wg(this._delegate,t)}confirmPasswordReset(t,r){return tb(this._delegate,t,r)}createUserWithEmailAndPassword(t,r){return g(this,null,function*(){return Hn(this._delegate,ib(this._delegate,t,r))})}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return lb(this._delegate,t)}isSignInWithEmailLink(t){return ab(this._delegate,t)}getRedirectResult(){return g(this,null,function*(){Wd(Ub(),this._delegate,"operation-not-supported-in-this-environment");let t=yield Nb(this._delegate,pi);return t?Hn(this._delegate,Promise.resolve(t)):{credential:null,user:null}})}addFrameworkForLogging(t){pO(this._delegate,t)}onAuthStateChanged(t,r,i){let{next:s,error:o,complete:a}=gO(t,r,i);return this._delegate.onAuthStateChanged(s,o,a)}onIdTokenChanged(t,r,i){let{next:s,error:o,complete:a}=gO(t,r,i);return this._delegate.onIdTokenChanged(s,o,a)}sendSignInLinkToEmail(t,r){return ob(this._delegate,t,r)}sendPasswordResetEmail(t,r){return eb(this._delegate,t,r||void 0)}setPersistence(t){return g(this,null,function*(){dK(this._delegate,t);let r;switch(t){case Xn.SESSION:r=fi;break;case Xn.LOCAL:r=(yield dn(Zo)._isAvailable())?Zo:Wc;break;case Xn.NONE:r=Ms;break;default:return Mt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)})}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return Hn(this._delegate,Q0(this._delegate))}signInWithCredential(t){return Hn(this._delegate,Gc(this._delegate,t))}signInWithCustomToken(t){return Hn(this._delegate,X0(this._delegate,t))}signInWithEmailAndPassword(t,r){return Hn(this._delegate,sb(this._delegate,t,r))}signInWithEmailLink(t,r){return Hn(this._delegate,cb(this._delegate,t,r))}signInWithPhoneNumber(t,r){return jb(this._delegate,vb(this._delegate,t,r))}signInWithPopup(t){return g(this,null,function*(){return Wd(Ub(),this._delegate,"operation-not-supported-in-this-environment"),Hn(this._delegate,bb(this._delegate,t,pi))})}signInWithRedirect(t){return g(this,null,function*(){return Wd(Ub(),this._delegate,"operation-not-supported-in-this-environment"),yield Bb(this._delegate),Ab(this._delegate,t,pi)})}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return rb(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=Xn,n})();function gO(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&Qc.getOrCreate(o)),error:e,complete:t}}function _K(n,e){let t=hK(n,e);if(typeof self<"u"&&!t.includes(Zo)&&t.push(Zo),typeof window<"u")for(let r of[Wc,fi])t.includes(r)||t.push(r);return t.includes(Ms)||t.push(Ms),t}var Qd=class{constructor(){this.providerId="phone",this._delegate=new ea(EO(U.auth()))}static credential(e,t){return ea.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};Qd.PHONE_SIGN_IN_METHOD=ea.PHONE_SIGN_IN_METHOD;Qd.PROVIDER_ID=ea.PROVIDER_ID;var yK=B,Hb=class{constructor(e,t,r=U.app()){var i;yK((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new Ud(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var vK="auth-compat";function wK(n){n.INTERNAL.registerComponent(new Ke(vK,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new mO(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Fs.EMAIL_SIGNIN,PASSWORD_RESET:Fs.PASSWORD_RESET,RECOVER_EMAIL:Fs.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Fs.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Fs.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Fs.VERIFY_EMAIL}},EmailAuthProvider:zd,FacebookAuthProvider:hg,GithubAuthProvider:pg,GoogleAuthProvider:fg,OAuthProvider:Hc,SAMLAuthProvider:Vd,PhoneAuthProvider:Qd,PhoneMultiFactorGenerator:Mb,RecaptchaVerifier:Hb,TwitterAuthProvider:mg,Auth:mO,AuthCredential:hi,Error:yt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(tK,nK)}wK(U);var CO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},TO={};var Ls,zb;(function(){var n;function e(S,v){function b(){}b.prototype=v.prototype,S.D=v.prototype,S.prototype=new b,S.prototype.constructor=S,S.C=function(D,x,P){for(var C=Array(arguments.length-2),ki=2;ki<arguments.length;ki++)C[ki-2]=arguments[ki];return v.prototype[x].apply(D,C)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,v,b){b||(b=0);var D=Array(16);if(typeof v=="string")for(var x=0;16>x;++x)D[x]=v.charCodeAt(b++)|v.charCodeAt(b++)<<8|v.charCodeAt(b++)<<16|v.charCodeAt(b++)<<24;else for(x=0;16>x;++x)D[x]=v[b++]|v[b++]<<8|v[b++]<<16|v[b++]<<24;v=S.g[0],b=S.g[1],x=S.g[2];var P=S.g[3],C=v+(P^b&(x^P))+D[0]+3614090360&4294967295;v=b+(C<<7&4294967295|C>>>25),C=P+(x^v&(b^x))+D[1]+3905402710&4294967295,P=v+(C<<12&4294967295|C>>>20),C=x+(b^P&(v^b))+D[2]+606105819&4294967295,x=P+(C<<17&4294967295|C>>>15),C=b+(v^x&(P^v))+D[3]+3250441966&4294967295,b=x+(C<<22&4294967295|C>>>10),C=v+(P^b&(x^P))+D[4]+4118548399&4294967295,v=b+(C<<7&4294967295|C>>>25),C=P+(x^v&(b^x))+D[5]+1200080426&4294967295,P=v+(C<<12&4294967295|C>>>20),C=x+(b^P&(v^b))+D[6]+2821735955&4294967295,x=P+(C<<17&4294967295|C>>>15),C=b+(v^x&(P^v))+D[7]+4249261313&4294967295,b=x+(C<<22&4294967295|C>>>10),C=v+(P^b&(x^P))+D[8]+1770035416&4294967295,v=b+(C<<7&4294967295|C>>>25),C=P+(x^v&(b^x))+D[9]+2336552879&4294967295,P=v+(C<<12&4294967295|C>>>20),C=x+(b^P&(v^b))+D[10]+4294925233&4294967295,x=P+(C<<17&4294967295|C>>>15),C=b+(v^x&(P^v))+D[11]+2304563134&4294967295,b=x+(C<<22&4294967295|C>>>10),C=v+(P^b&(x^P))+D[12]+1804603682&4294967295,v=b+(C<<7&4294967295|C>>>25),C=P+(x^v&(b^x))+D[13]+4254626195&4294967295,P=v+(C<<12&4294967295|C>>>20),C=x+(b^P&(v^b))+D[14]+2792965006&4294967295,x=P+(C<<17&4294967295|C>>>15),C=b+(v^x&(P^v))+D[15]+1236535329&4294967295,b=x+(C<<22&4294967295|C>>>10),C=v+(x^P&(b^x))+D[1]+4129170786&4294967295,v=b+(C<<5&4294967295|C>>>27),C=P+(b^x&(v^b))+D[6]+3225465664&4294967295,P=v+(C<<9&4294967295|C>>>23),C=x+(v^b&(P^v))+D[11]+643717713&4294967295,x=P+(C<<14&4294967295|C>>>18),C=b+(P^v&(x^P))+D[0]+3921069994&4294967295,b=x+(C<<20&4294967295|C>>>12),C=v+(x^P&(b^x))+D[5]+3593408605&4294967295,v=b+(C<<5&4294967295|C>>>27),C=P+(b^x&(v^b))+D[10]+38016083&4294967295,P=v+(C<<9&4294967295|C>>>23),C=x+(v^b&(P^v))+D[15]+3634488961&4294967295,x=P+(C<<14&4294967295|C>>>18),C=b+(P^v&(x^P))+D[4]+3889429448&4294967295,b=x+(C<<20&4294967295|C>>>12),C=v+(x^P&(b^x))+D[9]+568446438&4294967295,v=b+(C<<5&4294967295|C>>>27),C=P+(b^x&(v^b))+D[14]+3275163606&4294967295,P=v+(C<<9&4294967295|C>>>23),C=x+(v^b&(P^v))+D[3]+4107603335&4294967295,x=P+(C<<14&4294967295|C>>>18),C=b+(P^v&(x^P))+D[8]+1163531501&4294967295,b=x+(C<<20&4294967295|C>>>12),C=v+(x^P&(b^x))+D[13]+2850285829&4294967295,v=b+(C<<5&4294967295|C>>>27),C=P+(b^x&(v^b))+D[2]+4243563512&4294967295,P=v+(C<<9&4294967295|C>>>23),C=x+(v^b&(P^v))+D[7]+1735328473&4294967295,x=P+(C<<14&4294967295|C>>>18),C=b+(P^v&(x^P))+D[12]+2368359562&4294967295,b=x+(C<<20&4294967295|C>>>12),C=v+(b^x^P)+D[5]+4294588738&4294967295,v=b+(C<<4&4294967295|C>>>28),C=P+(v^b^x)+D[8]+2272392833&4294967295,P=v+(C<<11&4294967295|C>>>21),C=x+(P^v^b)+D[11]+1839030562&4294967295,x=P+(C<<16&4294967295|C>>>16),C=b+(x^P^v)+D[14]+4259657740&4294967295,b=x+(C<<23&4294967295|C>>>9),C=v+(b^x^P)+D[1]+2763975236&4294967295,v=b+(C<<4&4294967295|C>>>28),C=P+(v^b^x)+D[4]+1272893353&4294967295,P=v+(C<<11&4294967295|C>>>21),C=x+(P^v^b)+D[7]+4139469664&4294967295,x=P+(C<<16&4294967295|C>>>16),C=b+(x^P^v)+D[10]+3200236656&4294967295,b=x+(C<<23&4294967295|C>>>9),C=v+(b^x^P)+D[13]+681279174&4294967295,v=b+(C<<4&4294967295|C>>>28),C=P+(v^b^x)+D[0]+3936430074&4294967295,P=v+(C<<11&4294967295|C>>>21),C=x+(P^v^b)+D[3]+3572445317&4294967295,x=P+(C<<16&4294967295|C>>>16),C=b+(x^P^v)+D[6]+76029189&4294967295,b=x+(C<<23&4294967295|C>>>9),C=v+(b^x^P)+D[9]+3654602809&4294967295,v=b+(C<<4&4294967295|C>>>28),C=P+(v^b^x)+D[12]+3873151461&4294967295,P=v+(C<<11&4294967295|C>>>21),C=x+(P^v^b)+D[15]+530742520&4294967295,x=P+(C<<16&4294967295|C>>>16),C=b+(x^P^v)+D[2]+3299628645&4294967295,b=x+(C<<23&4294967295|C>>>9),C=v+(x^(b|~P))+D[0]+4096336452&4294967295,v=b+(C<<6&4294967295|C>>>26),C=P+(b^(v|~x))+D[7]+1126891415&4294967295,P=v+(C<<10&4294967295|C>>>22),C=x+(v^(P|~b))+D[14]+2878612391&4294967295,x=P+(C<<15&4294967295|C>>>17),C=b+(P^(x|~v))+D[5]+4237533241&4294967295,b=x+(C<<21&4294967295|C>>>11),C=v+(x^(b|~P))+D[12]+1700485571&4294967295,v=b+(C<<6&4294967295|C>>>26),C=P+(b^(v|~x))+D[3]+2399980690&4294967295,P=v+(C<<10&4294967295|C>>>22),C=x+(v^(P|~b))+D[10]+4293915773&4294967295,x=P+(C<<15&4294967295|C>>>17),C=b+(P^(x|~v))+D[1]+2240044497&4294967295,b=x+(C<<21&4294967295|C>>>11),C=v+(x^(b|~P))+D[8]+1873313359&4294967295,v=b+(C<<6&4294967295|C>>>26),C=P+(b^(v|~x))+D[15]+4264355552&4294967295,P=v+(C<<10&4294967295|C>>>22),C=x+(v^(P|~b))+D[6]+2734768916&4294967295,x=P+(C<<15&4294967295|C>>>17),C=b+(P^(x|~v))+D[13]+1309151649&4294967295,b=x+(C<<21&4294967295|C>>>11),C=v+(x^(b|~P))+D[4]+4149444226&4294967295,v=b+(C<<6&4294967295|C>>>26),C=P+(b^(v|~x))+D[11]+3174756917&4294967295,P=v+(C<<10&4294967295|C>>>22),C=x+(v^(P|~b))+D[2]+718787259&4294967295,x=P+(C<<15&4294967295|C>>>17),C=b+(P^(x|~v))+D[9]+3951481745&4294967295,S.g[0]=S.g[0]+v&4294967295,S.g[1]=S.g[1]+(x+(C<<21&4294967295|C>>>11))&4294967295,S.g[2]=S.g[2]+x&4294967295,S.g[3]=S.g[3]+P&4294967295}r.prototype.u=function(S,v){v===void 0&&(v=S.length);for(var b=v-this.blockSize,D=this.B,x=this.h,P=0;P<v;){if(x==0)for(;P<=b;)i(this,S,P),P+=this.blockSize;if(typeof S=="string"){for(;P<v;)if(D[x++]=S.charCodeAt(P++),x==this.blockSize){i(this,D),x=0;break}}else for(;P<v;)if(D[x++]=S[P++],x==this.blockSize){i(this,D),x=0;break}}this.h=x,this.o+=v},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var v=1;v<S.length-8;++v)S[v]=0;var b=8*this.o;for(v=S.length-8;v<S.length;++v)S[v]=b&255,b/=256;for(this.u(S),S=Array(16),v=b=0;4>v;++v)for(var D=0;32>D;D+=8)S[b++]=this.g[v]>>>D&255;return S};function s(S,v){var b=a;return Object.prototype.hasOwnProperty.call(b,S)?b[S]:b[S]=v(S)}function o(S,v){this.h=v;for(var b=[],D=!0,x=S.length-1;0<=x;x--){var P=S[x]|0;D&&P==v||(b[x]=P,D=!1)}this.g=b}var a={};function c(S){return-128<=S&&128>S?s(S,function(v){return new o([v|0],0>v?-1:0)}):new o([S|0],0>S?-1:0)}function l(S){if(isNaN(S)||!isFinite(S))return h;if(0>S)return R(l(-S));for(var v=[],b=1,D=0;S>=b;D++)v[D]=S/b|0,b*=4294967296;return new o(v,0)}function d(S,v){if(S.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(S.charAt(0)=="-")return R(d(S.substring(1),v));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=l(Math.pow(v,8)),D=h,x=0;x<S.length;x+=8){var P=Math.min(8,S.length-x),C=parseInt(S.substring(x,x+P),v);8>P?(P=l(Math.pow(v,P)),D=D.j(P).add(l(C))):(D=D.j(b),D=D.add(l(C)))}return D}var h=c(0),p=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(A(this))return-R(this).m();for(var S=0,v=1,b=0;b<this.g.length;b++){var D=this.i(b);S+=(0<=D?D:4294967296+D)*v,v*=4294967296}return S},n.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(E(this))return"0";if(A(this))return"-"+R(this).toString(S);for(var v=l(Math.pow(S,6)),b=this,D="";;){var x=Z(b,v).g;b=L(b,x.j(v));var P=((0<b.g.length?b.g[0]:b.h)>>>0).toString(S);if(b=x,E(b))return P+D;for(;6>P.length;)P="0"+P;D=P+D}},n.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function E(S){if(S.h!=0)return!1;for(var v=0;v<S.g.length;v++)if(S.g[v]!=0)return!1;return!0}function A(S){return S.h==-1}n.l=function(S){return S=L(this,S),A(S)?-1:E(S)?0:1};function R(S){for(var v=S.g.length,b=[],D=0;D<v;D++)b[D]=~S.g[D];return new o(b,~S.h).add(p)}n.abs=function(){return A(this)?R(this):this},n.add=function(S){for(var v=Math.max(this.g.length,S.g.length),b=[],D=0,x=0;x<=v;x++){var P=D+(this.i(x)&65535)+(S.i(x)&65535),C=(P>>>16)+(this.i(x)>>>16)+(S.i(x)>>>16);D=C>>>16,P&=65535,C&=65535,b[x]=C<<16|P}return new o(b,b[b.length-1]&-2147483648?-1:0)};function L(S,v){return S.add(R(v))}n.j=function(S){if(E(this)||E(S))return h;if(A(this))return A(S)?R(this).j(R(S)):R(R(this).j(S));if(A(S))return R(this.j(R(S)));if(0>this.l(_)&&0>S.l(_))return l(this.m()*S.m());for(var v=this.g.length+S.g.length,b=[],D=0;D<2*v;D++)b[D]=0;for(D=0;D<this.g.length;D++)for(var x=0;x<S.g.length;x++){var P=this.i(D)>>>16,C=this.i(D)&65535,ki=S.i(x)>>>16,lu=S.i(x)&65535;b[2*D+2*x]+=C*lu,Y(b,2*D+2*x),b[2*D+2*x+1]+=P*lu,Y(b,2*D+2*x+1),b[2*D+2*x+1]+=C*ki,Y(b,2*D+2*x+1),b[2*D+2*x+2]+=P*ki,Y(b,2*D+2*x+2)}for(D=0;D<v;D++)b[D]=b[2*D+1]<<16|b[2*D];for(D=v;D<2*v;D++)b[D]=0;return new o(b,0)};function Y(S,v){for(;(S[v]&65535)!=S[v];)S[v+1]+=S[v]>>>16,S[v]&=65535,v++}function j(S,v){this.g=S,this.h=v}function Z(S,v){if(E(v))throw Error("division by zero");if(E(S))return new j(h,h);if(A(S))return v=Z(R(S),v),new j(R(v.g),R(v.h));if(A(v))return v=Z(S,R(v)),new j(R(v.g),v.h);if(30<S.g.length){if(A(S)||A(v))throw Error("slowDivide_ only works with positive integers.");for(var b=p,D=v;0>=D.l(S);)b=ue(b),D=ue(D);var x=ne(b,1),P=ne(D,1);for(D=ne(D,2),b=ne(b,2);!E(D);){var C=P.add(D);0>=C.l(S)&&(x=x.add(b),P=C),D=ne(D,1),b=ne(b,1)}return v=L(S,x.j(v)),new j(x,v)}for(x=h;0<=S.l(v);){for(b=Math.max(1,Math.floor(S.m()/v.m())),D=Math.ceil(Math.log(b)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),P=l(b),C=P.j(v);A(C)||0<C.l(S);)b-=D,P=l(b),C=P.j(v);E(P)&&(P=p),x=x.add(P),S=L(S,C)}return new j(x,S)}n.A=function(S){return Z(this,S).h},n.and=function(S){for(var v=Math.max(this.g.length,S.g.length),b=[],D=0;D<v;D++)b[D]=this.i(D)&S.i(D);return new o(b,this.h&S.h)},n.or=function(S){for(var v=Math.max(this.g.length,S.g.length),b=[],D=0;D<v;D++)b[D]=this.i(D)|S.i(D);return new o(b,this.h|S.h)},n.xor=function(S){for(var v=Math.max(this.g.length,S.g.length),b=[],D=0;D<v;D++)b[D]=this.i(D)^S.i(D);return new o(b,this.h^S.h)};function ue(S){for(var v=S.g.length+1,b=[],D=0;D<v;D++)b[D]=S.i(D)<<1|S.i(D-1)>>>31;return new o(b,S.h)}function ne(S,v){var b=v>>5;v%=32;for(var D=S.g.length-b,x=[],P=0;P<D;P++)x[P]=0<v?S.i(P+b)>>>v|S.i(P+b+1)<<32-v:S.i(P+b);return new o(x,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,zb=TO.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,Ls=TO.Integer=o}).apply(typeof CO<"u"?CO:typeof self<"u"?self:typeof window<"u"?window:{});var Cg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Qi={};var Gb,Wb,Yc,Kb,Yd,Tg,Qb,Yb,Jb;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,m){return u==Array.prototype||u==Object.prototype||(u[f]=m.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cg=="object"&&Cg];for(var f=0;f<u.length;++f){var m=u[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=t(this);function i(u,f){if(f)e:{var m=r;u=u.split(".");for(var y=0;y<u.length-1;y++){var N=u[y];if(!(N in m))break e;m=m[N]}u=u[u.length-1],y=m[u],f=f(y),f!=y&&f!=null&&e(m,u,{configurable:!0,writable:!0,value:f})}}function s(u,f){u instanceof String&&(u+="");var m=0,y=!1,N={next:function(){if(!y&&m<u.length){var M=m++;return{value:f(M,u[M]),done:!1}}return y=!0,{done:!0,value:void 0}}};return N[Symbol.iterator]=function(){return N},N}i("Array.prototype.values",function(u){return u||function(){return s(this,function(f,m){return m})}});var o=o||{},a=this||self;function c(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function l(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function d(u,f,m){return u.call.apply(u.bind,arguments)}function h(u,f,m){if(!u)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var N=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(N,y),u.apply(f,N)}}return function(){return u.apply(f,arguments)}}function p(u,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function _(u,f){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),u.apply(this,y)}}function E(u,f){function m(){}m.prototype=f.prototype,u.aa=f.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(y,N,M){for(var z=Array(arguments.length-2),Qe=2;Qe<arguments.length;Qe++)z[Qe-2]=arguments[Qe];return f.prototype[N].apply(y,z)}}function A(u){let f=u.length;if(0<f){let m=Array(f);for(let y=0;y<f;y++)m[y]=u[y];return m}return[]}function R(u,f){for(let m=1;m<arguments.length;m++){let y=arguments[m];if(c(y)){let N=u.length||0,M=y.length||0;u.length=N+M;for(let z=0;z<M;z++)u[N+z]=y[z]}else u.push(y)}}class L{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function Y(u){return/^[\s\xa0]*$/.test(u)}function j(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function Z(u){return Z[" "](u),u}Z[" "]=function(){};var ue=j().indexOf("Gecko")!=-1&&!(j().toLowerCase().indexOf("webkit")!=-1&&j().indexOf("Edge")==-1)&&!(j().indexOf("Trident")!=-1||j().indexOf("MSIE")!=-1)&&j().indexOf("Edge")==-1;function ne(u,f,m){for(let y in u)f.call(m,u[y],y,u)}function S(u,f){for(let m in u)f.call(void 0,u[m],m,u)}function v(u){let f={};for(let m in u)f[m]=u[m];return f}let b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(u,f){let m,y;for(let N=1;N<arguments.length;N++){y=arguments[N];for(m in y)u[m]=y[m];for(let M=0;M<b.length;M++)m=b[M],Object.prototype.hasOwnProperty.call(y,m)&&(u[m]=y[m])}}function x(u){var f=1;u=u.split(":");let m=[];for(;0<f&&u.length;)m.push(u.shift()),f--;return u.length&&m.push(u.join(":")),m}function P(u){a.setTimeout(()=>{throw u},0)}function C(){var u=Yy;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class ki{constructor(){this.h=this.g=null}add(f,m){let y=lu.get();y.set(f,m),this.h?this.h.next=y:this.g=y,this.h=y}}var lu=new L(()=>new vj,u=>u.reset());class vj{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let uu,du=!1,Yy=new ki,rx=()=>{let u=a.Promise.resolve(void 0);uu=()=>{u.then(wj)}};var wj=()=>{for(var u;u=C();){try{u.h.call(u.g)}catch(m){P(m)}var f=lu;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}du=!1};function os(){this.s=this.s,this.C=this.C}os.prototype.s=!1,os.prototype.ma=function(){this.s||(this.s=!0,this.N())},os.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function nn(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}nn.prototype.h=function(){this.defaultPrevented=!0};var Ij=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return u}();function hu(u,f){if(nn.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,y=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(ue){e:{try{Z(f.nodeName);var N=!0;break e}catch{}N=!1}N||(f=null)}}else m=="mouseover"?f=u.fromElement:m=="mouseout"&&(f=u.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Ej[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&hu.aa.h.call(this)}}E(hu,nn);var Ej={2:"touch",3:"pen",4:"mouse"};hu.prototype.h=function(){hu.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var fu="closure_listenable_"+(1e6*Math.random()|0),bj=0;function Cj(u,f,m,y,N){this.listener=u,this.proxy=null,this.src=f,this.type=m,this.capture=!!y,this.ha=N,this.key=++bj,this.da=this.fa=!1}function bf(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Cf(u){this.src=u,this.g={},this.h=0}Cf.prototype.add=function(u,f,m,y,N){var M=u.toString();u=this.g[M],u||(u=this.g[M]=[],this.h++);var z=Xy(u,f,y,N);return-1<z?(f=u[z],m||(f.fa=!1)):(f=new Cj(f,this.src,M,!!y,N),f.fa=m,u.push(f)),f};function Jy(u,f){var m=f.type;if(m in u.g){var y=u.g[m],N=Array.prototype.indexOf.call(y,f,void 0),M;(M=0<=N)&&Array.prototype.splice.call(y,N,1),M&&(bf(f),u.g[m].length==0&&(delete u.g[m],u.h--))}}function Xy(u,f,m,y){for(var N=0;N<u.length;++N){var M=u[N];if(!M.da&&M.listener==f&&M.capture==!!m&&M.ha==y)return N}return-1}var Zy="closure_lm_"+(1e6*Math.random()|0),ev={};function ix(u,f,m,y,N){if(y&&y.once)return ox(u,f,m,y,N);if(Array.isArray(f)){for(var M=0;M<f.length;M++)ix(u,f[M],m,y,N);return null}return m=iv(m),u&&u[fu]?u.K(f,m,l(y)?!!y.capture:!!y,N):sx(u,f,m,!1,y,N)}function sx(u,f,m,y,N,M){if(!f)throw Error("Invalid event type");var z=l(N)?!!N.capture:!!N,Qe=nv(u);if(Qe||(u[Zy]=Qe=new Cf(u)),m=Qe.add(f,m,y,z,M),m.proxy)return m;if(y=Tj(),m.proxy=y,y.src=u,y.listener=m,u.addEventListener)Ij||(N=z),N===void 0&&(N=!1),u.addEventListener(f.toString(),y,N);else if(u.attachEvent)u.attachEvent(cx(f.toString()),y);else if(u.addListener&&u.removeListener)u.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function Tj(){function u(m){return f.call(u.src,u.listener,m)}let f=Sj;return u}function ox(u,f,m,y,N){if(Array.isArray(f)){for(var M=0;M<f.length;M++)ox(u,f[M],m,y,N);return null}return m=iv(m),u&&u[fu]?u.L(f,m,l(y)?!!y.capture:!!y,N):sx(u,f,m,!0,y,N)}function ax(u,f,m,y,N){if(Array.isArray(f))for(var M=0;M<f.length;M++)ax(u,f[M],m,y,N);else y=l(y)?!!y.capture:!!y,m=iv(m),u&&u[fu]?(u=u.i,f=String(f).toString(),f in u.g&&(M=u.g[f],m=Xy(M,m,y,N),-1<m&&(bf(M[m]),Array.prototype.splice.call(M,m,1),M.length==0&&(delete u.g[f],u.h--)))):u&&(u=nv(u))&&(f=u.g[f.toString()],u=-1,f&&(u=Xy(f,m,y,N)),(m=-1<u?f[u]:null)&&tv(m))}function tv(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[fu])Jy(f.i,u);else{var m=u.type,y=u.proxy;f.removeEventListener?f.removeEventListener(m,y,u.capture):f.detachEvent?f.detachEvent(cx(m),y):f.addListener&&f.removeListener&&f.removeListener(y),(m=nv(f))?(Jy(m,u),m.h==0&&(m.src=null,f[Zy]=null)):bf(u)}}}function cx(u){return u in ev?ev[u]:ev[u]="on"+u}function Sj(u,f){if(u.da)u=!0;else{f=new hu(f,this);var m=u.listener,y=u.ha||u.src;u.fa&&tv(u),u=m.call(y,f)}return u}function nv(u){return u=u[Zy],u instanceof Cf?u:null}var rv="__closure_events_fn_"+(1e9*Math.random()>>>0);function iv(u){return typeof u=="function"?u:(u[rv]||(u[rv]=function(f){return u.handleEvent(f)}),u[rv])}function rn(){os.call(this),this.i=new Cf(this),this.M=this,this.F=null}E(rn,os),rn.prototype[fu]=!0,rn.prototype.removeEventListener=function(u,f,m,y){ax(this,u,f,m,y)};function gn(u,f){var m,y=u.F;if(y)for(m=[];y;y=y.F)m.push(y);if(u=u.M,y=f.type||f,typeof f=="string")f=new nn(f,u);else if(f instanceof nn)f.target=f.target||u;else{var N=f;f=new nn(y,u),D(f,N)}if(N=!0,m)for(var M=m.length-1;0<=M;M--){var z=f.g=m[M];N=Tf(z,y,!0,f)&&N}if(z=f.g=u,N=Tf(z,y,!0,f)&&N,N=Tf(z,y,!1,f)&&N,m)for(M=0;M<m.length;M++)z=f.g=m[M],N=Tf(z,y,!1,f)&&N}rn.prototype.N=function(){if(rn.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var m=u.g[f],y=0;y<m.length;y++)bf(m[y]);delete u.g[f],u.h--}}this.F=null},rn.prototype.K=function(u,f,m,y){return this.i.add(String(u),f,!1,m,y)},rn.prototype.L=function(u,f,m,y){return this.i.add(String(u),f,!0,m,y)};function Tf(u,f,m,y){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var N=!0,M=0;M<f.length;++M){var z=f[M];if(z&&!z.da&&z.capture==m){var Qe=z.listener,Jt=z.ha||z.src;z.fa&&Jy(u.i,z),N=Qe.call(Jt,y)!==!1&&N}}return N&&!y.defaultPrevented}function lx(u,f,m){if(typeof u=="function")m&&(u=p(u,m));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function ux(u){u.g=lx(()=>{u.g=null,u.i&&(u.i=!1,ux(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class Dj extends os{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:ux(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pu(u){os.call(this),this.h=u,this.g={}}E(pu,os);var dx=[];function hx(u){ne(u.g,function(f,m){this.g.hasOwnProperty(m)&&tv(f)},u),u.g={}}pu.prototype.N=function(){pu.aa.N.call(this),hx(this)},pu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var sv=a.JSON.stringify,Aj=a.JSON.parse,xj=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function ov(){}ov.prototype.h=null;function fx(u){return u.h||(u.h=u.i())}function px(){}var mu={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function av(){nn.call(this,"d")}E(av,nn);function cv(){nn.call(this,"c")}E(cv,nn);var mo={},mx=null;function Sf(){return mx=mx||new rn}mo.La="serverreachability";function gx(u){nn.call(this,mo.La,u)}E(gx,nn);function gu(u){let f=Sf();gn(f,new gx(f))}mo.STAT_EVENT="statevent";function _x(u,f){nn.call(this,mo.STAT_EVENT,u),this.stat=f}E(_x,nn);function _n(u){let f=Sf();gn(f,new _x(f,u))}mo.Ma="timingevent";function yx(u,f){nn.call(this,mo.Ma,u),this.size=f}E(yx,nn);function _u(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function yu(){this.g=!0}yu.prototype.xa=function(){this.g=!1};function Rj(u,f,m,y,N,M){u.info(function(){if(u.g)if(M)for(var z="",Qe=M.split("&"),Jt=0;Jt<Qe.length;Jt++){var Ve=Qe[Jt].split("=");if(1<Ve.length){var sn=Ve[0];Ve=Ve[1];var on=sn.split("_");z=2<=on.length&&on[1]=="type"?z+(sn+"="+Ve+"&"):z+(sn+"=redacted&")}}else z=null;else z=M;return"XMLHTTP REQ ("+y+") [attempt "+N+"]: "+f+`
`+m+`
`+z})}function Nj(u,f,m,y,N,M,z){u.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+N+"]: "+f+`
`+m+`
`+M+" "+z})}function $a(u,f,m,y){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+kj(u,m)+(y?" "+y:"")})}function Pj(u,f){u.info(function(){return"TIMEOUT: "+f})}yu.prototype.info=function(){};function kj(u,f){if(!u.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var y=m[u];if(!(2>y.length)){var N=y[1];if(Array.isArray(N)&&!(1>N.length)){var M=N[0];if(M!="noop"&&M!="stop"&&M!="close")for(var z=1;z<N.length;z++)N[z]=""}}}}return sv(m)}catch{return f}}var Df={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vx={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},lv;function Af(){}E(Af,ov),Af.prototype.g=function(){return new XMLHttpRequest},Af.prototype.i=function(){return{}},lv=new Af;function as(u,f,m,y){this.j=u,this.i=f,this.l=m,this.R=y||1,this.U=new pu(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new wx}function wx(){this.i=null,this.g="",this.h=!1}var Ix={},uv={};function dv(u,f,m){u.L=1,u.v=Pf(Mi(f)),u.m=m,u.P=!0,Ex(u,null)}function Ex(u,f){u.F=Date.now(),xf(u),u.A=Mi(u.v);var m=u.A,y=u.R;Array.isArray(y)||(y=[String(y)]),Fx(m.i,"t",y),u.C=0,m=u.j.J,u.h=new wx,u.g=eR(u.j,m?f:null,!u.m),0<u.O&&(u.M=new Dj(p(u.Y,u,u.g),u.O)),f=u.U,m=u.g,y=u.ca;var N="readystatechange";Array.isArray(N)||(N&&(dx[0]=N.toString()),N=dx);for(var M=0;M<N.length;M++){var z=ix(m,N[M],y||f.handleEvent,!1,f.h||f);if(!z)break;f.g[z.key]=z}f=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),gu(),Rj(u.i,u.u,u.A,u.l,u.R,u.m)}as.prototype.ca=function(u){u=u.target;let f=this.M;f&&Oi(u)==3?f.j():this.Y(u)},as.prototype.Y=function(u){try{if(u==this.g)e:{let on=Oi(this.g);var f=this.g.Ba();let za=this.g.Z();if(!(3>on)&&(on!=3||this.g&&(this.h.h||this.g.oa()||Hx(this.g)))){this.J||on!=4||f==7||(f==8||0>=za?gu(3):gu(2)),hv(this);var m=this.g.Z();this.X=m;t:if(bx(this)){var y=Hx(this.g);u="";var N=y.length,M=Oi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){go(this),vu(this);var z="";break t}this.h.i=new a.TextDecoder}for(f=0;f<N;f++)this.h.h=!0,u+=this.h.i.decode(y[f],{stream:!(M&&f==N-1)});y.length=0,this.h.g+=u,this.C=0,z=this.h.g}else z=this.g.oa();if(this.o=m==200,Nj(this.i,this.u,this.A,this.l,this.R,on,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Qe,Jt=this.g;if((Qe=Jt.g?Jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(Qe)){var Ve=Qe;break t}}Ve=null}if(m=Ve)$a(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,fv(this,m);else{this.o=!1,this.s=3,_n(12),go(this),vu(this);break e}}if(this.P){m=!0;let Sr;for(;!this.J&&this.C<z.length;)if(Sr=Mj(this,z),Sr==uv){on==4&&(this.s=4,_n(14),m=!1),$a(this.i,this.l,null,"[Incomplete Response]");break}else if(Sr==Ix){this.s=4,_n(15),$a(this.i,this.l,z,"[Invalid Chunk]"),m=!1;break}else $a(this.i,this.l,Sr,null),fv(this,Sr);if(bx(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),on!=4||z.length!=0||this.h.h||(this.s=1,_n(16),m=!1),this.o=this.o&&m,!m)$a(this.i,this.l,z,"[Invalid Chunked Response]"),go(this),vu(this);else if(0<z.length&&!this.W){this.W=!0;var sn=this.j;sn.g==this&&sn.ba&&!sn.M&&(sn.j.info("Great, no buffering proxy detected. Bytes received: "+z.length),vv(sn),sn.M=!0,_n(11))}}else $a(this.i,this.l,z,null),fv(this,z);on==4&&go(this),this.o&&!this.J&&(on==4?Yx(this.j,this):(this.o=!1,xf(this)))}else Jj(this.g),m==400&&0<z.indexOf("Unknown SID")?(this.s=3,_n(12)):(this.s=0,_n(13)),go(this),vu(this)}}}catch{}finally{}};function bx(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Mj(u,f){var m=u.C,y=f.indexOf(`
`,m);return y==-1?uv:(m=Number(f.substring(m,y)),isNaN(m)?Ix:(y+=1,y+m>f.length?uv:(f=f.slice(y,y+m),u.C=y+m,f)))}as.prototype.cancel=function(){this.J=!0,go(this)};function xf(u){u.S=Date.now()+u.I,Cx(u,u.I)}function Cx(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=_u(p(u.ba,u),f)}function hv(u){u.B&&(a.clearTimeout(u.B),u.B=null)}as.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(Pj(this.i,this.A),this.L!=2&&(gu(),_n(17)),go(this),this.s=2,vu(this)):Cx(this,this.S-u)};function vu(u){u.j.G==0||u.J||Yx(u.j,u)}function go(u){hv(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,hx(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function fv(u,f){try{var m=u.j;if(m.G!=0&&(m.g==u||pv(m.h,u))){if(!u.K&&pv(m.h,u)&&m.G==3){try{var y=m.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var N=y;if(N[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)Lf(m),Of(m);else break e;yv(m),_n(18)}}else m.za=N[1],0<m.za-m.T&&37500>N[2]&&m.F&&m.v==0&&!m.C&&(m.C=_u(p(m.Za,m),6e3));if(1>=Dx(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else yo(m,11)}else if((u.K||m.g==u)&&Lf(m),!Y(f))for(N=m.Da.g.parse(f),f=0;f<N.length;f++){let Ve=N[f];if(m.T=Ve[0],Ve=Ve[1],m.G==2)if(Ve[0]=="c"){m.K=Ve[1],m.ia=Ve[2];let sn=Ve[3];sn!=null&&(m.la=sn,m.j.info("VER="+m.la));let on=Ve[4];on!=null&&(m.Aa=on,m.j.info("SVER="+m.Aa));let za=Ve[5];za!=null&&typeof za=="number"&&0<za&&(y=1.5*za,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;let Sr=u.g;if(Sr){let Uf=Sr.g?Sr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Uf){var M=y.h;M.g||Uf.indexOf("spdy")==-1&&Uf.indexOf("quic")==-1&&Uf.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(mv(M,M.h),M.h=null))}if(y.D){let wv=Sr.g?Sr.g.getResponseHeader("X-HTTP-Session-Id"):null;wv&&(y.ya=wv,it(y.I,y.D,wv))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var z=u;if(y.qa=Zx(y,y.J?y.ia:null,y.W),z.K){Ax(y.h,z);var Qe=z,Jt=y.L;Jt&&(Qe.I=Jt),Qe.B&&(hv(Qe),xf(Qe)),y.g=z}else Kx(y);0<m.i.length&&Ff(m)}else Ve[0]!="stop"&&Ve[0]!="close"||yo(m,7);else m.G==3&&(Ve[0]=="stop"||Ve[0]=="close"?Ve[0]=="stop"?yo(m,7):_v(m):Ve[0]!="noop"&&m.l&&m.l.ta(Ve),m.v=0)}}gu(4)}catch{}}var Oj=class{constructor(u,f){this.g=u,this.map=f}};function Tx(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Sx(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Dx(u){return u.h?1:u.g?u.g.size:0}function pv(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function mv(u,f){u.g?u.g.add(f):u.h=f}function Ax(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}Tx.prototype.cancel=function(){if(this.i=xx(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function xx(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let m of u.g.values())f=f.concat(m.D);return f}return A(u.i)}function Fj(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var f=[],m=u.length,y=0;y<m;y++)f.push(u[y]);return f}f=[],m=0;for(y in u)f[m++]=u[y];return f}function Lj(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var f=[];u=u.length;for(var m=0;m<u;m++)f.push(m);return f}f=[],m=0;for(let y in u)f[m++]=y;return f}}}function Rx(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var m=Lj(u),y=Fj(u),N=y.length,M=0;M<N;M++)f.call(void 0,y[M],m&&m[M],u)}var Nx=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vj(u,f){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var y=u[m].indexOf("="),N=null;if(0<=y){var M=u[m].substring(0,y);N=u[m].substring(y+1)}else M=u[m];f(M,N?decodeURIComponent(N.replace(/\+/g," ")):"")}}}function _o(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof _o){this.h=u.h,Rf(this,u.j),this.o=u.o,this.g=u.g,Nf(this,u.s),this.l=u.l;var f=u.i,m=new Eu;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),Px(this,m),this.m=u.m}else u&&(f=String(u).match(Nx))?(this.h=!1,Rf(this,f[1]||"",!0),this.o=wu(f[2]||""),this.g=wu(f[3]||"",!0),Nf(this,f[4]),this.l=wu(f[5]||"",!0),Px(this,f[6]||"",!0),this.m=wu(f[7]||"")):(this.h=!1,this.i=new Eu(null,this.h))}_o.prototype.toString=function(){var u=[],f=this.j;f&&u.push(Iu(f,kx,!0),":");var m=this.g;return(m||f=="file")&&(u.push("//"),(f=this.o)&&u.push(Iu(f,kx,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(Iu(m,m.charAt(0)=="/"?jj:Bj,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",Iu(m,Hj)),u.join("")};function Mi(u){return new _o(u)}function Rf(u,f,m){u.j=m?wu(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function Nf(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function Px(u,f,m){f instanceof Eu?(u.i=f,qj(u.i,u.h)):(m||(f=Iu(f,$j)),u.i=new Eu(f,u.h))}function it(u,f,m){u.i.set(f,m)}function Pf(u){return it(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function wu(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Iu(u,f,m){return typeof u=="string"?(u=encodeURI(u).replace(f,Uj),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Uj(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var kx=/[#\/\?@]/g,Bj=/[#\?:]/g,jj=/[#\?]/g,$j=/[#\?@]/g,Hj=/#/g;function Eu(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function cs(u){u.g||(u.g=new Map,u.h=0,u.i&&Vj(u.i,function(f,m){u.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=Eu.prototype,n.add=function(u,f){cs(this),this.i=null,u=Ha(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(f),this.h+=1,this};function Mx(u,f){cs(u),f=Ha(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function Ox(u,f){return cs(u),f=Ha(u,f),u.g.has(f)}n.forEach=function(u,f){cs(this),this.g.forEach(function(m,y){m.forEach(function(N){u.call(f,N,y,this)},this)},this)},n.na=function(){cs(this);let u=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let y=0;y<f.length;y++){let N=u[y];for(let M=0;M<N.length;M++)m.push(f[y])}return m},n.V=function(u){cs(this);let f=[];if(typeof u=="string")Ox(this,u)&&(f=f.concat(this.g.get(Ha(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)f=f.concat(u[m])}return f},n.set=function(u,f){return cs(this),this.i=null,u=Ha(this,u),Ox(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function Fx(u,f,m){Mx(u,f),0<m.length&&(u.i=null,u.g.set(Ha(u,f),A(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var y=f[m];let M=encodeURIComponent(String(y)),z=this.V(y);for(y=0;y<z.length;y++){var N=M;z[y]!==""&&(N+="="+encodeURIComponent(String(z[y]))),u.push(N)}}return this.i=u.join("&")};function Ha(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function qj(u,f){f&&!u.j&&(cs(u),u.i=null,u.g.forEach(function(m,y){var N=y.toLowerCase();y!=N&&(Mx(this,y),Fx(this,N,m))},u)),u.j=f}function zj(u,f){let m=new yu;if(a.Image){let y=new Image;y.onload=_(ls,m,"TestLoadImage: loaded",!0,f,y),y.onerror=_(ls,m,"TestLoadImage: error",!1,f,y),y.onabort=_(ls,m,"TestLoadImage: abort",!1,f,y),y.ontimeout=_(ls,m,"TestLoadImage: timeout",!1,f,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=u}else f(!1)}function Gj(u,f){let m=new yu,y=new AbortController,N=setTimeout(()=>{y.abort(),ls(m,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:y.signal}).then(M=>{clearTimeout(N),M.ok?ls(m,"TestPingServer: ok",!0,f):ls(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(N),ls(m,"TestPingServer: error",!1,f)})}function ls(u,f,m,y,N){try{N&&(N.onload=null,N.onerror=null,N.onabort=null,N.ontimeout=null),y(m)}catch{}}function Wj(){this.g=new xj}function Kj(u,f,m){let y=m||"";try{Rx(u,function(N,M){let z=N;l(N)&&(z=sv(N)),f.push(y+M+"="+encodeURIComponent(z))})}catch(N){throw f.push(y+"type="+encodeURIComponent("_badmap")),N}}function bu(u){this.l=u.Ub||null,this.j=u.eb||!1}E(bu,ov),bu.prototype.g=function(){return new kf(this.l,this.j)},bu.prototype.i=function(u){return function(){return u}}({});function kf(u,f){rn.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(kf,rn),n=kf.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,Tu(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Cu(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Tu(this)),this.g&&(this.readyState=3,Tu(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Lx(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Lx(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?Cu(this):Tu(this),this.readyState==3&&Lx(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Cu(this))},n.Qa=function(u){this.g&&(this.response=u,Cu(this))},n.ga=function(){this.g&&Cu(this)};function Cu(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Tu(u)}n.setRequestHeader=function(u,f){this.u.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=f.next();return u.join(`\r
`)};function Tu(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(kf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Vx(u){let f="";return ne(u,function(m,y){f+=y,f+=":",f+=m,f+=`\r
`}),f}function gv(u,f,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=Vx(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):it(u,f,m))}function _t(u){rn.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(_t,rn);var Qj=/^https?$/i,Yj=["POST","PUT"];n=_t.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,f,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():lv.g(),this.v=this.o?fx(this.o):fx(lv),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(M){Ux(this,M);return}if(u=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var N in y)m.set(N,y[N]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let M of y.keys())m.set(M,y.get(M));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(M=>M.toLowerCase()=="content-type"),N=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Yj,f,void 0))||y||N||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[M,z]of m)this.g.setRequestHeader(M,z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$x(this),this.u=!0,this.g.send(u),this.u=!1}catch(M){Ux(this,M)}};function Ux(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,Bx(u),Mf(u)}function Bx(u){u.A||(u.A=!0,gn(u,"complete"),gn(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,gn(this,"complete"),gn(this,"abort"),Mf(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mf(this,!0)),_t.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?jx(this):this.bb())},n.bb=function(){jx(this)};function jx(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Oi(u)!=4||u.Z()!=2)){if(u.u&&Oi(u)==4)lx(u.Ea,0,u);else if(gn(u,"readystatechange"),Oi(u)==4){u.h=!1;try{let z=u.Z();e:switch(z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var y;if(y=z===0){var N=String(u.D).match(Nx)[1]||null;!N&&a.self&&a.self.location&&(N=a.self.location.protocol.slice(0,-1)),y=!Qj.test(N?N.toLowerCase():"")}m=y}if(m)gn(u,"complete"),gn(u,"success");else{u.m=6;try{var M=2<Oi(u)?u.g.statusText:""}catch{M=""}u.l=M+" ["+u.Z()+"]",Bx(u)}}finally{Mf(u)}}}}function Mf(u,f){if(u.g){$x(u);let m=u.g,y=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||gn(u,"ready");try{m.onreadystatechange=y}catch{}}}function $x(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Oi(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Oi(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),Aj(f)}};function Hx(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Jj(u){let f={};u=(u.g&&2<=Oi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<u.length;y++){if(Y(u[y]))continue;var m=x(u[y]);let N=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let M=f[N]||[];f[N]=M,M.push(m)}S(f,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Su(u,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||f}function qx(u){this.Aa=0,this.i=[],this.j=new yu,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Su("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Su("baseRetryDelayMs",5e3,u),this.cb=Su("retryDelaySeedMs",1e4,u),this.Wa=Su("forwardChannelMaxRetries",2,u),this.wa=Su("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Tx(u&&u.concurrentRequestLimit),this.Da=new Wj,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=qx.prototype,n.la=8,n.G=1,n.connect=function(u,f,m,y){_n(0),this.W=u,this.H=f||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=Zx(this,null,this.W),Ff(this)};function _v(u){if(zx(u),u.G==3){var f=u.U++,m=Mi(u.I);if(it(m,"SID",u.K),it(m,"RID",f),it(m,"TYPE","terminate"),Du(u,m),f=new as(u,u.j,f),f.L=2,f.v=Pf(Mi(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=eR(f.j,null),f.g.ea(f.v)),f.F=Date.now(),xf(f)}Xx(u)}function Of(u){u.g&&(vv(u),u.g.cancel(),u.g=null)}function zx(u){Of(u),u.u&&(a.clearTimeout(u.u),u.u=null),Lf(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Ff(u){if(!Sx(u.h)&&!u.s){u.s=!0;var f=u.Ga;uu||rx(),du||(uu(),du=!0),Yy.add(f,u),u.B=0}}function Xj(u,f){return Dx(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=_u(p(u.Ga,u,f),Jx(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let N=new as(this,this.j,u),M=this.o;if(this.S&&(M?(M=v(M),D(M,this.S)):M=this.S),this.m!==null||this.O||(N.H=M,M=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=Wx(this,N,f),m=Mi(this.I),it(m,"RID",u),it(m,"CVER",22),this.D&&it(m,"X-HTTP-Session-Id",this.D),Du(this,m),M&&(this.O?f="headers="+encodeURIComponent(String(Vx(M)))+"&"+f:this.m&&gv(m,this.m,M)),mv(this.h,N),this.Ua&&it(m,"TYPE","init"),this.P?(it(m,"$req",f),it(m,"SID","null"),N.T=!0,dv(N,m,null)):dv(N,m,f),this.G=2}}else this.G==3&&(u?Gx(this,u):this.i.length==0||Sx(this.h)||Gx(this))};function Gx(u,f){var m;f?m=f.l:m=u.U++;let y=Mi(u.I);it(y,"SID",u.K),it(y,"RID",m),it(y,"AID",u.T),Du(u,y),u.m&&u.o&&gv(y,u.m,u.o),m=new as(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),f&&(u.i=f.D.concat(u.i)),f=Wx(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),mv(u.h,m),dv(m,y,f)}function Du(u,f){u.H&&ne(u.H,function(m,y){it(f,y,m)}),u.l&&Rx({},function(m,y){it(f,y,m)})}function Wx(u,f,m){m=Math.min(u.i.length,m);var y=u.l?p(u.l.Na,u.l,u):null;e:{var N=u.i;let M=-1;for(;;){let z=["count="+m];M==-1?0<m?(M=N[0].g,z.push("ofs="+M)):M=0:z.push("ofs="+M);let Qe=!0;for(let Jt=0;Jt<m;Jt++){let Ve=N[Jt].g,sn=N[Jt].map;if(Ve-=M,0>Ve)M=Math.max(0,N[Jt].g-100),Qe=!1;else try{Kj(sn,z,"req"+Ve+"_")}catch{y&&y(sn)}}if(Qe){y=z.join("&");break e}}}return u=u.i.splice(0,m),f.D=u,y}function Kx(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;uu||rx(),du||(uu(),du=!0),Yy.add(f,u),u.v=0}}function yv(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=_u(p(u.Fa,u),Jx(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Qx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=_u(p(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_n(10),Of(this),Qx(this))};function vv(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Qx(u){u.g=new as(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=Mi(u.qa);it(f,"RID","rpc"),it(f,"SID",u.K),it(f,"AID",u.T),it(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&it(f,"TO",u.ja),it(f,"TYPE","xmlhttp"),Du(u,f),u.m&&u.o&&gv(f,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=Pf(Mi(f)),m.m=null,m.P=!0,Ex(m,u)}n.Za=function(){this.C!=null&&(this.C=null,Of(this),yv(this),_n(19))};function Lf(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Yx(u,f){var m=null;if(u.g==f){Lf(u),vv(u),u.g=null;var y=2}else if(pv(u.h,f))m=f.D,Ax(u.h,f),y=1;else return;if(u.G!=0){if(f.o)if(y==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var N=u.B;y=Sf(),gn(y,new yx(y,m)),Ff(u)}else Kx(u);else if(N=f.s,N==3||N==0&&0<f.X||!(y==1&&Xj(u,f)||y==2&&yv(u)))switch(m&&0<m.length&&(f=u.h,f.i=f.i.concat(m)),N){case 1:yo(u,5);break;case 4:yo(u,10);break;case 3:yo(u,6);break;default:yo(u,2)}}}function Jx(u,f){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*f}function yo(u,f){if(u.j.info("Error code "+f),f==2){var m=p(u.fb,u),y=u.Xa;let N=!y;y=new _o(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Rf(y,"https"),Pf(y),N?zj(y.toString(),m):Gj(y.toString(),m)}else _n(2);u.G=0,u.l&&u.l.sa(f),Xx(u),zx(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),_n(2)):(this.j.info("Failed to ping google.com"),_n(1))};function Xx(u){if(u.G=0,u.ka=[],u.l){let f=xx(u.h);(f.length!=0||u.i.length!=0)&&(R(u.ka,f),R(u.ka,u.i),u.h.i.length=0,A(u.i),u.i.length=0),u.l.ra()}}function Zx(u,f,m){var y=m instanceof _o?Mi(m):new _o(m);if(y.g!="")f&&(y.g=f+"."+y.g),Nf(y,y.s);else{var N=a.location;y=N.protocol,f=f?f+"."+N.hostname:N.hostname,N=+N.port;var M=new _o(null);y&&Rf(M,y),f&&(M.g=f),N&&Nf(M,N),m&&(M.l=m),y=M}return m=u.D,f=u.ya,m&&f&&it(y,m,f),it(y,"VER",u.la),Du(u,y),y}function eR(u,f,m){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new _t(new bu({eb:m})):new _t(u.pa),f.Ha(u.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function tR(){}n=tR.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Vf(){}Vf.prototype.g=function(u,f){return new zn(u,f)};function zn(u,f){rn.call(this),this.g=new qx(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!Y(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!Y(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new qa(this)}E(zn,rn),zn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},zn.prototype.close=function(){_v(this.g)},zn.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=sv(u),u=m);f.i.push(new Oj(f.Ya++,u)),f.G==3&&Ff(f)},zn.prototype.N=function(){this.g.l=null,delete this.j,_v(this.g),delete this.g,zn.aa.N.call(this)};function nR(u){av.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(let m in f){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}E(nR,av);function rR(){cv.call(this),this.status=1}E(rR,cv);function qa(u){this.g=u}E(qa,tR),qa.prototype.ua=function(){gn(this.g,"a")},qa.prototype.ta=function(u){gn(this.g,new nR(u))},qa.prototype.sa=function(u){gn(this.g,new rR)},qa.prototype.ra=function(){gn(this.g,"b")},Vf.prototype.createWebChannel=Vf.prototype.g,zn.prototype.send=zn.prototype.o,zn.prototype.open=zn.prototype.m,zn.prototype.close=zn.prototype.close,Jb=Qi.createWebChannelTransport=function(){return new Vf},Yb=Qi.getStatEventTarget=function(){return Sf()},Qb=Qi.Event=mo,Tg=Qi.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Df.NO_ERROR=0,Df.TIMEOUT=8,Df.HTTP_ERROR=6,Yd=Qi.ErrorCode=Df,vx.COMPLETE="complete",Kb=Qi.EventType=vx,px.EventType=mu,mu.OPEN="a",mu.CLOSE="b",mu.ERROR="c",mu.MESSAGE="d",rn.prototype.listen=rn.prototype.K,Yc=Qi.WebChannel=px,Wb=Qi.FetchXmlHttpFactory=bu,_t.prototype.listenOnce=_t.prototype.L,_t.prototype.getLastError=_t.prototype.Ka,_t.prototype.getLastErrorCode=_t.prototype.Ba,_t.prototype.getStatus=_t.prototype.Z,_t.prototype.getResponseJson=_t.prototype.Oa,_t.prototype.getResponseText=_t.prototype.oa,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Ha,Gb=Qi.XhrIo=_t}).apply(typeof Cg<"u"?Cg:typeof self<"u"?self:typeof window<"u"?window:{});var SO="@firebase/firestore";var Lt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Lt.UNAUTHENTICATED=new Lt(null),Lt.GOOGLE_CREDENTIALS=new Lt("google-credentials-uid"),Lt.FIRST_PARTY=new Lt("first-party-uid"),Lt.MOCK_USER=new Lt("mock-user");var Sl="10.12.1";var zs=new $n("@firebase/firestore");function tl(){return zs.logLevel}function DF(n){zs.setLogLevel(n)}function V(n,...e){if(zs.logLevel<=we.DEBUG){let t=e.map(rS);zs.debug(`Firestore (${Sl}): ${n}`,...t)}}function St(n,...e){if(zs.logLevel<=we.ERROR){let t=e.map(rS);zs.error(`Firestore (${Sl}): ${n}`,...t)}}function wr(n,...e){if(zs.logLevel<=we.WARN){let t=e.map(rS);zs.warn(`Firestore (${Sl}): ${n}`,...t)}}function rS(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function ee(n="Unexpected state"){let e=`FIRESTORE (${Sl}) INTERNAL ASSERTION FAILED: `+n;throw St(e),new Error(e)}function re(n,e){n||ee()}function AF(n,e){n||ee()}function W(n,e){return n}var O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},F=class extends yt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Dt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Fg=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},nC=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Lt.UNAUTHENTICATED))}shutdown(){}},rC=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},iC=class{constructor(e){this.t=e,this.currentUser=Lt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Dt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Dt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Dt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(re(typeof r.accessToken=="string"),new Fg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return re(e===null||typeof e=="string"),new Lt(e)}},sC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Lt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},oC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new sC(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Lt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},aC=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},cC=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,V("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(re(typeof t.token=="string"),this.R=t.token,new aC(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function IK(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Lg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=IK(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function ge(n,e){return n<e?-1:n>e?1:0}function ll(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function xF(n){return n+"\0"}var pt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new F(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ge(this.nanoseconds,e.nanoseconds):ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var se=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new pt(0,0))}static max(){return new n(new pt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Vg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&ee(),r===void 0?r=e.length-t:r>e.length-t&&ee(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Fe=class n extends Vg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new F(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},EK=/^[_a-zA-Z][_a-zA-Z0-9]*$/,At=class n extends Vg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return EK.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new F(O.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new F(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new F(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new F(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var K=class n{constructor(e){this.path=e}static fromPath(e){return new n(Fe.fromString(e))}static fromName(e){return new n(Fe.fromString(e).popFirst(5))}static empty(){return new n(Fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Fe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Fe(e.slice()))}};var ul=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function lC(n){return n.fields.find(e=>e.kind===2)}function sa(n){return n.fields.filter(e=>e.kind!==2)}ul.UNKNOWN_ID=-1;var ol=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var ch=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Ir.min())}};function RF(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=se.fromTimestamp(r===1e9?new pt(t+1,0):new pt(t,r));return new Ir(i,K.empty(),e)}function NF(n){return new Ir(n.readTime,n.key,-1)}var Ir=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(se.min(),K.empty(),-1)}static max(){return new n(se.max(),K.empty(),-1)}};function iS(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=K.comparator(n.documentKey,e.documentKey),t!==0?t:ge(n.largestBatchId,e.largestBatchId))}var PF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ug=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function to(n){return g(this,null,function*(){if(n.code!==O.FAILED_PRECONDITION||n.message!==PF)throw n;V("LocalStore","Unexpectedly lost primary lease")})}var k=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ee(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var Bg=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Dt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new da(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=sS(r.target.error);this.V.reject(new da(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new da(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(V("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new dC(t)}},Gs=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(Je())===12.2&&St("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return V("SimpleDb","Removing database:",e),oa(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Ss())return!1;if(n.C())return!0;let e=Je(),t=n.S(e),r=0<t&&t<10,i=kF(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return g(this,null,function*(){return this.db||(V("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new da(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new F(O.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new F(O.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new da(e,o))},i.onupgradeneeded=s=>{V("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{V("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return g(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=Bg.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),k.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(V("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function kF(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var uC=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return oa(this.B.delete())}},da=class extends F{constructor(e,t){super(O.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function no(n){return n.name==="IndexedDbTransactionError"}var dC=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(V("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(V("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),oa(r)}add(e){return V("SimpleDb","ADD",this.store.name,e,e),oa(this.store.add(e))}get(e){return oa(this.store.get(e)).next(t=>(t===void 0&&(t=null),V("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return V("SimpleDb","DELETE",this.store.name,e),oa(this.store.delete(e))}count(){return V("SimpleDb","COUNT",this.store.name),oa(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new k((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new k((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){V("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new k((r,i)=>{t.onerror=s=>{let o=sS(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new k((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new uC(a),l=t(a.primaryKey,a.value,c);if(l instanceof k){let d=l.catch(h=>(c.done(),k.reject(h)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>k.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function oa(n){return new k((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=sS(r.target.error);t(i)}})}var DO=!1;function sS(n){let e=Gs.S(Je());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new F("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return DO||(DO=!0,setTimeout(()=>{throw r},0)),r}}return n}var hC=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){V("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{V("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){no(t)?V("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield to(t)}yield this.X(6e4)}))}},fC=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return k.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return V("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(V("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=NF(s);iS(o,r)>0&&(r=o)}),new Ir(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Zn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Rh(n){return n==null}function lh(n){return n===0&&1/n==-1/0}function MF(n){return typeof n=="number"&&Number.isInteger(n)&&!lh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Cn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=AO(e)),e=bK(n.get(t),e);return AO(e)}function bK(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function AO(n){return n+""}function mi(n){let e=n.length;if(re(e>=2),e===2)return re(n.charAt(0)===""&&n.charAt(1)===""),Fe.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&ee(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:ee()}s=o+2}return new Fe(r)}var xO=["userId","batchId"];function Rg(n,e){return[n,Cn(e)]}function OF(n,e,t){return[n,Cn(e),t]}var CK={},TK=["prefixPath","collectionGroup","readTime","documentId"],SK=["prefixPath","collectionGroup","documentId"],DK=["collectionGroup","readTime","prefixPath","documentId"],AK=["canonicalId","targetId"],xK=["targetId","path"],RK=["path","targetId"],NK=["collectionId","parent"],PK=["indexId","uid"],kK=["uid","sequenceNumber"],MK=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],OK=["indexId","uid","orderedDocumentKey"],FK=["userId","collectionPath","documentId"],LK=["userId","collectionPath","largestBatchId"],VK=["userId","collectionGroup","largestBatchId"],FF=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],UK=[...FF,"documentOverlays"],LF=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],VF=LF,UF=[...VF,"indexConfiguration","indexState","indexEntries"],BK=UF;var uh=class extends Ug{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Kt(n,e){let t=W(n);return Gs.F(t._e,e)}function RO(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ba(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function jK(n,e){let t=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function BF(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var at=class n{constructor(e,t){this.comparator=e,this.root=t||_i.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_i.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_i.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sl(this.root,e,this.comparator,!1)}getReverseIterator(){return new sl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sl(this.root,e,this.comparator,!0)}},sl=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},_i=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ee();let e=this.left.check();if(e!==this.right.check())throw ee();return e+(this.isRed()?0:1)}};_i.EMPTY=null,_i.RED=!0,_i.BLACK=!1;_i.EMPTY=new class{constructor(){this.size=0}get key(){throw ee()}get value(){throw ee()}get color(){throw ee()}get left(){throw ee()}get right(){throw ee()}copy(e,t,r,i,s){return this}insert(e,t,r){return new _i(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Xe=class n{constructor(e){this.comparator=e,this.data=new at(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new jg(this.data.getIterator())}getIteratorFrom(e){return new jg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},jg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Jc(n){return n.hasNext()?n.getNext():void 0}var er=class n{constructor(e){this.fields=e,e.sort(At.comparator)}static empty(){return new n([])}unionWith(e){let t=new Xe(At.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ll(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var $g=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function jF(){return typeof atob<"u"}var Wt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new $g("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Wt.EMPTY_BYTE_STRING=new Wt("");var $K=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xi(n){if(re(!!n),typeof n=="string"){let e=0,t=$K.exec(n);if(re(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:It(n.seconds),nanos:It(n.nanos)}}function It(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ws(n){return typeof n=="string"?Wt.fromBase64String(n):Wt.fromUint8Array(n)}function P_(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function oS(n){let e=n.mapValue.fields.__previous_value__;return P_(e)?oS(e):e}function dh(n){let e=Xi(n.mapValue.fields.__local_write_time__.timestampValue);return new pt(e.seconds,e.nanos)}var pC=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Ks=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Hs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ng={nullValue:"NULL_VALUE"};function ha(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?P_(n)?4:$F(n)?9007199254740991:10:ee()}function wi(n,e){if(n===e)return!0;let t=ha(n);if(t!==ha(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return dh(n).isEqual(dh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Xi(i.timestampValue),a=Xi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Ws(i.bytesValue).isEqual(Ws(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return It(i.geoPointValue.latitude)===It(s.geoPointValue.latitude)&&It(i.geoPointValue.longitude)===It(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return It(i.integerValue)===It(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=It(i.doubleValue),a=It(s.doubleValue);return o===a?lh(o)===lh(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return ll(n.arrayValue.values||[],e.arrayValue.values||[],wi);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(RO(o)!==RO(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!wi(o[c],a[c])))return!1;return!0}(n,e);default:return ee()}}function hh(n,e){return(n.values||[]).find(t=>wi(t,e))!==void 0}function Qs(n,e){if(n===e)return 0;let t=ha(n),r=ha(e);if(t!==r)return ge(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ge(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=It(s.integerValue||s.doubleValue),c=It(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return NO(n.timestampValue,e.timestampValue);case 4:return NO(dh(n),dh(e));case 5:return ge(n.stringValue,e.stringValue);case 6:return function(s,o){let a=Ws(s),c=Ws(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=ge(a[l],c[l]);if(d!==0)return d}return ge(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ge(It(s.latitude),It(o.latitude));return a!==0?a:ge(It(s.longitude),It(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){let d=Qs(a[l],c[l]);if(d)return d}return ge(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Hs.mapValue&&o===Hs.mapValue)return 0;if(s===Hs.mapValue)return 1;if(o===Hs.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let p=ge(c[h],d[h]);if(p!==0)return p;let _=Qs(a[c[h]],l[d[h]]);if(_!==0)return _}return ge(c.length,d.length)}(n.mapValue,e.mapValue);default:throw ee()}}function NO(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ge(n,e);let t=Xi(n),r=Xi(e),i=ge(t.seconds,r.seconds);return i!==0?i:ge(t.nanos,r.nanos)}function dl(n){return mC(n)}function mC(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Xi(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ws(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return K.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=mC(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${mC(t.fields[o])}`;return i+"}"}(n.mapValue):ee()}function fa(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function gC(n){return!!n&&"integerValue"in n}function fh(n){return!!n&&"arrayValue"in n}function PO(n){return!!n&&"nullValue"in n}function kO(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Pg(n){return!!n&&"mapValue"in n}function rh(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return ba(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=rh(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=rh(n.arrayValue.values[t]);return e}return Object.assign({},n)}function $F(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function HK(n){return"nullValue"in n?Ng:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?fa(Ks.empty(),K.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:ee()}function qK(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?fa(Ks.empty(),K.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Hs:ee()}function MO(n,e){let t=Qs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function OO(n,e){let t=Qs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var fn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Pg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=rh(t)}setAll(e){let t=At.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=rh(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Pg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return wi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Pg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ba(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(rh(this.value))}};function HF(n){let e=[];return ba(n.fields,(t,r)=>{let i=new At([t]);if(Pg(r)){let s=HF(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new er(e)}var Vt=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,se.min(),se.min(),se.min(),fn.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,se.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,se.min(),se.min(),fn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,se.min(),se.min(),fn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ii=class{constructor(e,t){this.position=e,this.inclusive=t}};function FO(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=K.comparator(K.fromName(o.referenceValue),t.key):r=Qs(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function LO(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!wi(n.position[t],e.position[t]))return!1;return!0}var pa=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function zK(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Hg=class{},Re=class n extends Hg{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new vC(e,t,r):t==="array-contains"?new EC(e,r):t==="in"?new qg(e,r):t==="not-in"?new bC(e,r):t==="array-contains-any"?new CC(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new wC(e,r):new IC(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Qs(t,this.value)):t!==null&&ha(this.value)===ha(t)&&this.matchesComparison(Qs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ee()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},We=class n extends Hg{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return hl(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function hl(n){return n.op==="and"}function _C(n){return n.op==="or"}function aS(n){return qF(n)&&hl(n)}function qF(n){for(let e of n.filters)if(e instanceof We)return!1;return!0}function yC(n){if(n instanceof Re)return n.field.canonicalString()+n.op.toString()+dl(n.value);if(aS(n))return n.filters.map(e=>yC(e)).join(",");{let e=n.filters.map(t=>yC(t)).join(",");return`${n.op}(${e})`}}function zF(n,e){return n instanceof Re?function(r,i){return i instanceof Re&&r.op===i.op&&r.field.isEqual(i.field)&&wi(r.value,i.value)}(n,e):n instanceof We?function(r,i){return i instanceof We&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&zF(o,i.filters[a]),!0):!1}(n,e):void ee()}function GF(n,e){let t=n.filters.concat(e);return We.create(t,n.op)}function WF(n){return n instanceof Re?function(t){return`${t.field.canonicalString()} ${t.op} ${dl(t.value)}`}(n):n instanceof We?function(t){return t.op.toString()+" {"+t.getFilters().map(WF).join(" ,")+"}"}(n):"Filter"}var vC=class extends Re{constructor(e,t,r){super(e,t,r),this.key=K.fromName(r.referenceValue)}matches(e){let t=K.comparator(e.key,this.key);return this.matchesComparison(t)}},wC=class extends Re{constructor(e,t){super(e,"in",t),this.keys=KF("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},IC=class extends Re{constructor(e,t){super(e,"not-in",t),this.keys=KF("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function KF(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>K.fromName(r.referenceValue))}var EC=class extends Re{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return fh(t)&&hh(t.arrayValue,this.value)}},qg=class extends Re{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&hh(this.value.arrayValue,t)}},bC=class extends Re{constructor(e,t){super(e,"not-in",t)}matches(e){if(hh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!hh(this.value.arrayValue,t)}},CC=class extends Re{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!fh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>hh(this.value.arrayValue,r))}};var TC=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function SC(n,e=null,t=[],r=[],i=null,s=null,o=null){return new TC(n,e,t,r,i,s,o)}function ma(n){let e=W(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>yC(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Rh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>dl(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>dl(r)).join(",")),e.ue=t}return e.ue}function Nh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!zK(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!zF(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!LO(n.startAt,e.startAt)&&LO(n.endAt,e.endAt)}function zg(n){return K.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Gg(n,e){return n.filters.filter(t=>t instanceof Re&&t.field.isEqual(e))}function VO(n,e,t){let r=Ng,i=!0;for(let s of Gg(n,e)){let o=Ng,a=!0;switch(s.op){case"<":case"<=":o=HK(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Ng}MO({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];MO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function UO(n,e,t){let r=Hs,i=!0;for(let s of Gg(n,e)){let o=Hs,a=!0;switch(s.op){case">=":case">":o=qK(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Hs}OO({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];OO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var Br=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function QF(n,e,t,r,i,s,o,a){return new Br(n,e,t,r,i,s,o,a)}function Dl(n){return new Br(n)}function BO(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function cS(n){return n.collectionGroup!==null}function al(n){let e=W(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Xe(At.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new pa(s,r))}),t.has(At.keyField().canonicalString())||e.ce.push(new pa(At.keyField(),r))}return e.ce}function Tn(n){let e=W(n);return e.le||(e.le=YF(e,al(n))),e.le}function GK(n){let e=W(n);return e.he||(e.he=YF(e,n.explicitOrderBy)),e.he}function YF(n,e){if(n.limitType==="F")return SC(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new pa(i.field,s)});let t=n.endAt?new Ii(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ii(n.startAt.position,n.startAt.inclusive):null;return SC(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function DC(n,e){let t=n.filters.concat([e]);return new Br(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Wg(n,e,t){return new Br(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ph(n,e){return Nh(Tn(n),Tn(e))&&n.limitType===e.limitType}function JF(n){return`${ma(Tn(n))}|lt:${n.limitType}`}function nl(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>WF(i)).join(", ")}]`),Rh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>dl(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>dl(i)).join(",")),`Target(${r})`}(Tn(n))}; limitType=${n.limitType})`}function kh(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):K.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of al(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=FO(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,al(r),i)||r.endAt&&!function(o,a,c){let l=FO(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,al(r),i))}(n,e)}function XF(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ZF(n){return(e,t)=>{let r=!1;for(let i of al(n)){let s=WK(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function WK(n,e,t){let r=n.field.isKeyField()?K.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?Qs(c,l):ee()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ee()}}var Ei=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ba(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return BF(this.inner)}size(){return this.innerSize}};var KK=new at(K.comparator);function qn(){return KK}var eL=new at(K.comparator);function th(...n){let e=eL;for(let t of n)e=e.insert(t.key,t);return e}function tL(n){let e=eL;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function gi(){return ih()}function nL(){return ih()}function ih(){return new Ei(n=>n.toString(),(n,e)=>n.isEqual(e))}var QK=new at(K.comparator),YK=new Xe(K.comparator);function ye(...n){let e=YK;for(let t of n)e=e.add(t);return e}var JK=new Xe(ge);function lS(){return JK}function rL(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:lh(e)?"-0":e}}function iL(n){return{integerValue:""+n}}function sL(n,e){return MF(e)?iL(e):rL(n,e)}var fl=class{constructor(){this._=void 0}};function XK(n,e,t){return n instanceof Ys?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&P_(s)&&(s=oS(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Zi?aL(n,e):n instanceof es?cL(n,e):function(i,s){let o=oL(i,s),a=jO(o)+jO(i.Pe);return gC(o)&&gC(i.Pe)?iL(a):rL(i.serializer,a)}(n,e)}function ZK(n,e,t){return n instanceof Zi?aL(n,e):n instanceof es?cL(n,e):t}function oL(n,e){return n instanceof Js?function(r){return gC(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Ys=class extends fl{},Zi=class extends fl{constructor(e){super(),this.elements=e}};function aL(n,e){let t=lL(e);for(let r of n.elements)t.some(i=>wi(i,r))||t.push(r);return{arrayValue:{values:t}}}var es=class extends fl{constructor(e){super(),this.elements=e}};function cL(n,e){let t=lL(e);for(let r of n.elements)t=t.filter(i=>!wi(i,r));return{arrayValue:{values:t}}}var Js=class extends fl{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function jO(n){return It(n.integerValue||n.doubleValue)}function lL(n){return fh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var ga=class{constructor(e,t){this.field=e,this.transform=t}};function e7(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Zi&&i instanceof Zi||r instanceof es&&i instanceof es?ll(r.elements,i.elements,wi):r instanceof Js&&i instanceof Js?wi(r.Pe,i.Pe):r instanceof Ys&&i instanceof Ys}(n.transform,e.transform)}var AC=class{constructor(e,t){this.version=e,this.transformResults=t}},Et=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function kg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var pl=class{};function uL(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Zs(n.key,Et.none()):new Xs(n.key,n.data,Et.none());{let t=n.data,r=fn.empty(),i=new Xe(At.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new jr(n.key,r,new er(i.toArray()),Et.none())}}function t7(n,e,t){n instanceof Xs?function(i,s,o){let a=i.value.clone(),c=HO(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof jr?function(i,s,o){if(!kg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=HO(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(dL(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function sh(n,e,t,r){return n instanceof Xs?function(s,o,a,c){if(!kg(s.precondition,o))return a;let l=s.value.clone(),d=qO(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof jr?function(s,o,a,c){if(!kg(s.precondition,o))return a;let l=qO(s.fieldTransforms,c,o),d=o.data;return d.setAll(dL(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return kg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function n7(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=oL(r.transform,i||null);s!=null&&(t===null&&(t=fn.empty()),t.set(r.field,s))}return t||null}function $O(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ll(r,i,(s,o)=>e7(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Xs=class extends pl{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},jr=class extends pl{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function dL(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function HO(n,e,t){let r=new Map;re(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,ZK(o,a,t[i]))}return r}function qO(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,XK(s,o,e))}return r}var Zs=class extends pl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ph=class extends pl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var mh=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&t7(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=sh(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=sh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=nL();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=uL(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(se.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ye())}isEqual(e){return this.batchId===e.batchId&&ll(this.mutations,e.mutations,(t,r)=>$O(t,r))&&ll(this.baseMutations,e.baseMutations,(t,r)=>$O(t,r))}},xC=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){re(e.mutations.length===r.length);let i=function(){return QK}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var gh=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var RC=class{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}};var NC=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ot,Oe;function hL(n){switch(n){default:return ee();case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0}}function fL(n){if(n===void 0)return St("GRPC error has no .code"),O.UNKNOWN;switch(n){case Ot.OK:return O.OK;case Ot.CANCELLED:return O.CANCELLED;case Ot.UNKNOWN:return O.UNKNOWN;case Ot.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case Ot.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case Ot.INTERNAL:return O.INTERNAL;case Ot.UNAVAILABLE:return O.UNAVAILABLE;case Ot.UNAUTHENTICATED:return O.UNAUTHENTICATED;case Ot.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case Ot.NOT_FOUND:return O.NOT_FOUND;case Ot.ALREADY_EXISTS:return O.ALREADY_EXISTS;case Ot.PERMISSION_DENIED:return O.PERMISSION_DENIED;case Ot.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case Ot.ABORTED:return O.ABORTED;case Ot.OUT_OF_RANGE:return O.OUT_OF_RANGE;case Ot.UNIMPLEMENTED:return O.UNIMPLEMENTED;case Ot.DATA_LOSS:return O.DATA_LOSS;default:return ee()}}(Oe=Ot||(Ot={}))[Oe.OK=0]="OK",Oe[Oe.CANCELLED=1]="CANCELLED",Oe[Oe.UNKNOWN=2]="UNKNOWN",Oe[Oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oe[Oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oe[Oe.NOT_FOUND=5]="NOT_FOUND",Oe[Oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oe[Oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oe[Oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oe[Oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oe[Oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oe[Oe.ABORTED=10]="ABORTED",Oe[Oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oe[Oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oe[Oe.INTERNAL=13]="INTERNAL",Oe[Oe.UNAVAILABLE=14]="UNAVAILABLE",Oe[Oe.DATA_LOSS=15]="DATA_LOSS";var zO=null;function pL(){return new TextEncoder}var r7=new Ls([4294967295,4294967295],0);function GO(n){let e=pL().encode(n),t=new zb;return t.update(e),new Uint8Array(t.digest())}function WO(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ls([t,r],0),new Ls([i,s],0)]}var PC=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ua(`Invalid padding: ${t}`);if(r<0)throw new ua(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ua(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ua(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ls.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Ls.fromNumber(r)));return i.compare(r7)===1&&(i=new Ls([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=GO(e),[r,i]=WO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=GO(e),[r,i]=WO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},ua=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var _h=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,yh.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(se.min(),i,new at(ge),qn(),ye())}},yh=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ye(),ye(),ye())}};var cl=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Kg=class{constructor(e,t){this.targetId=e,this.me=t}},Qg=class{constructor(e,t,r=Wt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Yg=class{constructor(){this.fe=0,this.ge=QO(),this.pe=Wt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=ye(),t=ye(),r=ye();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ee()}}),new yh(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=QO()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,re(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},kC=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=qn(),this.qe=KO(),this.Qe=new at(ge)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:ee()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(zg(s))if(r===0){let o=new K(s.path);this.Ue(t,o,Vt.newNoDocument(o,se.min()))}else re(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}zO?.et(function(d,h,p,_,E){var A,R,L,Y,j,Z;let ue={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},ne=h.unchangedNames;return ne&&(ue.bloomFilter={applied:E===0,hashCount:(A=ne?.hashCount)!==null&&A!==void 0?A:0,bitmapLength:(Y=(L=(R=ne?.bits)===null||R===void 0?void 0:R.bitmap)===null||L===void 0?void 0:L.length)!==null&&Y!==void 0?Y:0,padding:(Z=(j=ne?.bits)===null||j===void 0?void 0:j.padding)!==null&&Z!==void 0?Z:0,mightContain:S=>{var v;return(v=_?.mightContain(S))!==null&&v!==void 0&&v}}),ue}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=Ws(r).toUint8Array()}catch(c){if(c instanceof $g)return wr("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new PC(o,i,s)}catch(c){return wr(c instanceof ua?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&zg(a.target)){let c=new K(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Vt.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let r=ye();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new _h(e,t,this.Qe,this.ke,r);return this.ke=qn(),this.qe=KO(),this.Qe=new at(ge),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Yg,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Xe(ge),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Yg),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function KO(){return new at(K.comparator)}function QO(){return new at(K.comparator)}var i7={asc:"ASCENDING",desc:"DESCENDING"},s7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},o7={and:"AND",or:"OR"},MC=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function OC(n,e){return n.useProto3Json||Rh(e)?e:{value:e}}function ml(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function a7(n,e){return ml(n,e.toTimestamp())}function xt(n){return re(!!n),se.fromTimestamp(function(t){let r=Xi(t);return new pt(r.seconds,r.nanos)}(n))}function uS(n,e){return FC(n,e).canonicalString()}function FC(n,e){let t=function(i){return new Fe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function gL(n){let e=Fe.fromString(n);return re(TL(e)),e}function vh(n,e){return uS(n.databaseId,e.path)}function yi(n,e){let t=gL(e);if(t.get(1)!==n.databaseId.projectId)throw new F(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new F(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new K(vL(t))}function _L(n,e){return uS(n.databaseId,e)}function yL(n){let e=gL(n);return e.length===4?Fe.emptyPath():vL(e)}function LC(n){return new Fe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function vL(n){return re(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function YO(n,e,t){return{name:vh(n,e),fields:t.value.mapValue.fields}}function wL(n,e,t){let r=yi(n,e.name),i=xt(e.updateTime),s=e.createTime?xt(e.createTime):se.min(),o=new fn({mapValue:{fields:e.fields}}),a=Vt.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function c7(n,e){return"found"in e?function(r,i){re(!!i.found),i.found.name,i.found.updateTime;let s=yi(r,i.found.name),o=xt(i.found.updateTime),a=i.found.createTime?xt(i.found.createTime):se.min(),c=new fn({mapValue:{fields:i.found.fields}});return Vt.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){re(!!i.missing),re(!!i.readTime);let s=yi(r,i.missing),o=xt(i.readTime);return Vt.newNoDocument(s,o)}(n,e):ee()}function l7(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:ee()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(re(d===void 0||typeof d=="string"),Wt.fromBase64String(d||"")):(re(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Wt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?O.UNKNOWN:fL(l.code);return new F(d,l.message||"")}(o);t=new Qg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=yi(n,r.document.name),s=xt(r.document.updateTime),o=r.document.createTime?xt(r.document.createTime):se.min(),a=new fn({mapValue:{fields:r.document.fields}}),c=Vt.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new cl(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=yi(n,r.document),s=r.readTime?xt(r.readTime):se.min(),o=Vt.newNoDocument(i,s),a=r.removedTargetIds||[];t=new cl([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=yi(n,r.document),s=r.removedTargetIds||[];t=new cl([],s,i,null)}else{if(!("filter"in e))return ee();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new NC(i,s),a=r.targetId;t=new Kg(a,o)}}return t}function wh(n,e){let t;if(e instanceof Xs)t={update:YO(n,e.key,e.value)};else if(e instanceof Zs)t={delete:vh(n,e.key)};else if(e instanceof jr)t={update:YO(n,e.key,e.data),updateMask:g7(e.fieldMask)};else{if(!(e instanceof ph))return ee();t={verify:vh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Ys)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Zi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof es)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Js)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw ee()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:a7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ee()}(n,e.precondition)),t}function VC(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?Et.updateTime(xt(s.updateTime)):s.exists!==void 0?Et.exists(s.exists):Et.none()}(e.currentDocument):Et.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)re(a.setToServerValue==="REQUEST_TIME"),c=new Ys;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new Zi(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new es(d)}else"increment"in a?c=new Js(o,a.increment):ee();let l=At.fromServerFormat(a.fieldPath);return new ga(l,c)}(n,i)):[];if(e.update){e.update.name;let i=yi(n,e.update.name),s=new fn({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new er(l.map(d=>At.fromServerFormat(d)))}(e.updateMask);return new jr(i,s,o,t,r)}return new Xs(i,s,t,r)}if(e.delete){let i=yi(n,e.delete);return new Zs(i,t)}if(e.verify){let i=yi(n,e.verify);return new ph(i,t)}return ee()}function u7(n,e){return n&&n.length>0?(re(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?xt(i.updateTime):xt(s);return o.isEqual(se.min())&&(o=xt(s)),new AC(o,i.transformResults||[])}(t,e))):[]}function IL(n,e){return{documents:[_L(n,e.path)]}}function dS(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=_L(n,i);let s=function(l){if(l.length!==0)return CL(We.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(p){return{field:Bs(p.field),direction:f7(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=OC(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function d7(n,e,t,r){let{_t:i,parent:s}=dS(n,e),o={},a=[],c=0;return t.forEach(l=>{let d=r?l.alias:"aggregate_"+c++;o[d]=l.alias,l.aggregateType==="count"?a.push({alias:d,count:{}}):l.aggregateType==="avg"?a.push({alias:d,avg:{field:Bs(l.fieldPath)}}):l.aggregateType==="sum"&&a.push({alias:d,sum:{field:Bs(l.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},ut:o,parent:s}}function EL(n){let e=yL(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){re(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let p=bL(h);return p instanceof We&&aS(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(p=>function(E){return new pa(rl(E.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,Rh(p)?null:p}(t.limit));let c=null;t.startAt&&(c=function(h){let p=!!h.before,_=h.values||[];return new Ii(_,p)}(t.startAt));let l=null;return t.endAt&&(l=function(h){let p=!h.before,_=h.values||[];return new Ii(_,p)}(t.endAt)),QF(e,i,o,s,a,"F",c,l)}function h7(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ee()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function bL(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=rl(t.unaryFilter.field);return Re.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=rl(t.unaryFilter.field);return Re.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=rl(t.unaryFilter.field);return Re.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=rl(t.unaryFilter.field);return Re.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ee()}}(n):n.fieldFilter!==void 0?function(t){return Re.create(rl(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ee()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return We.create(t.compositeFilter.filters.map(r=>bL(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ee()}}(t.compositeFilter.op))}(n):ee()}function f7(n){return i7[n]}function p7(n){return s7[n]}function m7(n){return o7[n]}function Bs(n){return{fieldPath:n.canonicalString()}}function rl(n){return At.fromServerFormat(n.fieldPath)}function CL(n){return n instanceof Re?function(t){if(t.op==="=="){if(kO(t.value))return{unaryFilter:{field:Bs(t.field),op:"IS_NAN"}};if(PO(t.value))return{unaryFilter:{field:Bs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(kO(t.value))return{unaryFilter:{field:Bs(t.field),op:"IS_NOT_NAN"}};if(PO(t.value))return{unaryFilter:{field:Bs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bs(t.field),op:p7(t.op),value:t.value}}}(n):n instanceof We?function(t){let r=t.getFilters().map(i=>CL(i));return r.length===1?r[0]:{compositeFilter:{op:m7(t.op),filters:r}}}(n):ee()}function g7(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function TL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var gl=class n{constructor(e,t,r,i,s=se.min(),o=se.min(),a=Wt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Jg=class{constructor(e){this.ct=e}};function _7(n,e){let t;if(e.document)t=wL(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=K.fromSegments(e.noDocument.path),i=ya(e.noDocument.readTime);t=Vt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ee();{let r=K.fromSegments(e.unknownDocument.path),i=ya(e.unknownDocument.version);t=Vt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new pt(i[0],i[1]);return se.fromTimestamp(s)}(e.readTime)),t}function JO(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Xg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:vh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:ml(s,o.version.toTimestamp()),createTime:ml(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:_a(e.version)};else{if(!e.isUnknownDocument())return ee();r.unknownDocument={path:t.path.toArray(),version:_a(e.version)}}return r}function Xg(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function _a(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ya(n){let e=new pt(n.seconds,n.nanoseconds);return se.fromTimestamp(e)}function aa(n,e){let t=(e.baseMutations||[]).map(s=>VC(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>VC(n.ct,s)),i=pt.fromMillis(e.localWriteTimeMs);return new mh(e.batchId,i,t,r)}function nh(n){let e=ya(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ya(n.lastLimboFreeSnapshotVersion):se.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return re(s.documents.length===1),Tn(Dl(yL(s.documents[0])))}(n.query):function(s){return Tn(EL(s))}(n.query),new gl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Wt.fromBase64String(n.resumeToken))}function SL(n,e){let t=_a(e.snapshotVersion),r=_a(e.lastLimboFreeSnapshotVersion),i;i=zg(e.target)?IL(n.ct,e.target):dS(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ma(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function hS(n){let e=EL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Wg(e,e.limit,"L"):e}function Xb(n,e){return new gh(e.largestBatchId,VC(n.ct,e.overlayMutation))}function XO(n,e){let t=e.path.lastSegment();return[n,Cn(e.path.popLast()),t]}function ZO(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:_a(r.readTime),documentKey:Cn(r.documentKey.path),largestBatchId:r.largestBatchId}}var UC=class{getBundleMetadata(e,t){return eF(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:ya(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return eF(e).put(function(i){return{bundleId:i.id,createTime:_a(xt(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return tF(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:hS(s.bundledQuery),readTime:ya(s.readTime)}}(r)})}saveNamedQuery(e,t){return tF(e).put(function(i){return{name:i.name,readTime:_a(xt(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function eF(n){return Kt(n,"bundles")}function tF(n){return Kt(n,"namedQueries")}var Zg=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Jd(e).get(XO(this.userId,t)).next(r=>r?Xb(this.serializer,r):null)}getOverlays(e,t){let r=gi();return k.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new gh(t,o);i.push(this.ht(e,a))}),k.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(Cn(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Jd(e).j("collectionPathOverlayIndex",a))}),k.waitFor(s)}getOverlaysForCollection(e,t,r){let i=gi(),s=Cn(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Jd(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=Xb(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=gi(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Jd(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,d)=>{let h=Xb(this.serializer,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return Jd(e).put(function(i,s,o){let[a,c,l]=XO(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:wh(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function Jd(n){return Kt(n,"documentOverlays")}var Yi=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(It(e.integerValue));else if("doubleValue"in e){let r=It(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),lh(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=Xi(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Ws(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?$F(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):ee()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),K.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};Yi.bt=new Yi;function y7(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function nF(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=y7(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var BC=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ct(r.value),r=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Mt(r.value),r=t.next();this.xt()}Ot(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let t=this.Bt(e),r=nF(t);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){let t=this.Bt(e),r=nF(t);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},jC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},$C=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},ca=class{constructor(){this.Gt=new BC,this.zt=new jC(this.Gt),this.jt=new $C(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var la=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function Vs(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=rF(n.arrayValue,e.arrayValue),t!==0?t:(t=rF(n.directionalValue,e.directionalValue),t!==0?t:K.comparator(n.documentKey,e.documentKey)))}function rF(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var e_=class{constructor(e){this.Yt=new Xe((t,r)=>At.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let r=t;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(re(e.collectionGroup===this.collectionId),this.en)return!1;let t=lC(e);if(t!==void 0&&!this.nn(t))return!1;let r=sa(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Xe(At.comparator),t=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new ol(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new ol(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new ol(r.field,r.dir==="asc"?0:1)));return new ul(ul.UNKNOWN_ID,this.collectionId,t,ch.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function DL(n){var e,t;if(re(n instanceof Re||n instanceof We),n instanceof Re){if(n instanceof qg){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Re.create(n.field,"==",s)))||[];return We.create(i,"or")}return n}let r=n.filters.map(i=>DL(i));return We.create(r,n.op)}function v7(n){if(n.getFilters().length===0)return[];let e=zC(DL(n));return re(AL(e)),HC(e)||qC(e)?[e]:e.getFilters()}function HC(n){return n instanceof Re}function qC(n){return n instanceof We&&aS(n)}function AL(n){return HC(n)||qC(n)||function(t){if(t instanceof We&&_C(t)){for(let r of t.getFilters())if(!HC(r)&&!qC(r))return!1;return!0}return!1}(n)}function zC(n){if(re(n instanceof Re||n instanceof We),n instanceof Re)return n;if(n.filters.length===1)return zC(n.filters[0]);let e=n.filters.map(r=>zC(r)),t=We.create(e,n.op);return t=t_(t),AL(t)?t:(re(t instanceof We),re(hl(t)),re(t.filters.length>1),t.filters.reduce((r,i)=>fS(r,i)))}function fS(n,e){let t;return re(n instanceof Re||n instanceof We),re(e instanceof Re||e instanceof We),t=n instanceof Re?e instanceof Re?function(i,s){return We.create([i,s],"and")}(n,e):iF(n,e):e instanceof Re?iF(e,n):function(i,s){if(re(i.filters.length>0&&s.filters.length>0),hl(i)&&hl(s))return GF(i,s.getFilters());let o=_C(i)?i:s,a=_C(i)?s:i,c=o.filters.map(l=>fS(l,a));return We.create(c,"or")}(n,e),t_(t)}function iF(n,e){if(hl(e))return GF(e,n.getFilters());{let t=e.filters.map(r=>fS(n,r));return We.create(t,"or")}}function t_(n){if(re(n instanceof Re||n instanceof We),n instanceof Re)return n;let e=n.getFilters();if(e.length===1)return t_(e[0]);if(qF(n))return n;let t=e.map(i=>t_(i)),r=[];return t.forEach(i=>{i instanceof Re?r.push(i):i instanceof We&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:We.create(r,n.op)}var GC=class{constructor(){this._n=new Ih}addToCollectionParentIndex(e,t){return this._n.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(Ir.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(Ir.min())}updateCollectionGroup(e,t,r){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}},Ih=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Xe(Fe.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Xe(Fe.comparator)).toArray()}};var Sg=new Uint8Array(0),WC=class{constructor(e,t){this.databaseId=t,this.an=new Ih,this.un=new Ei(r=>ma(r),(r,i)=>Nh(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:r,parent:Cn(i)};return sF(e).put(s)}return k.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[xF(t),""],!1,!0);return sF(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(mi(o.parent))}return r})}addFieldIndex(e,t){let r=Xd(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=Zc(e);return s.next(a=>{o.put(ZO(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=Xd(e),i=Zc(e),s=Xc(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Xd(e),r=Xc(e),i=Zc(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return k.forEach(this.cn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new e_(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=Xc(e),i=!0,s=new Map;return k.forEach(this.cn(t),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ye(),a=[];return k.forEach(s,(c,l)=>{V("IndexedDbIndexManager",`Using index ${function(j){return`id=${j.indexId}|cg=${j.collectionGroup}|f=${j.fields.map(Z=>`${Z.fieldPath}:${Z.kind}`).join(",")}`}(c)} to execute ${ma(t)}`);let d=function(j,Z){let ue=lC(Z);if(ue===void 0)return null;for(let ne of Gg(j,ue.fieldPath))switch(ne.op){case"array-contains-any":return ne.value.arrayValue.values||[];case"array-contains":return[ne.value]}return null}(l,c),h=function(j,Z){let ue=new Map;for(let ne of sa(Z))for(let S of Gg(j,ne.fieldPath))switch(S.op){case"==":case"in":ue.set(ne.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return ue.set(ne.fieldPath.canonicalString(),S.value),Array.from(ue.values())}return null}(l,c),p=function(j,Z){let ue=[],ne=!0;for(let S of sa(Z)){let v=S.kind===0?VO(j,S.fieldPath,j.startAt):UO(j,S.fieldPath,j.startAt);ue.push(v.value),ne&&(ne=v.inclusive)}return new Ii(ue,ne)}(l,c),_=function(j,Z){let ue=[],ne=!0;for(let S of sa(Z)){let v=S.kind===0?UO(j,S.fieldPath,j.endAt):VO(j,S.fieldPath,j.endAt);ue.push(v.value),ne&&(ne=v.inclusive)}return new Ii(ue,ne)}(l,c),E=this.hn(c,l,p),A=this.hn(c,l,_),R=this.Pn(c,l,h),L=this.In(c.indexId,d,E,p.inclusive,A,_.inclusive,R);return k.forEach(L,Y=>r.G(Y,t.limit).next(j=>{j.forEach(Z=>{let ue=K.fromSegments(Z.documentKey);o.has(ue)||(o=o.add(ue),a.push(ue))})}))}).next(()=>a)}return k.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=v7(We.create(e.filters,"and")).map(r=>SC(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),l=c/(t!=null?t.length:1),d=[];for(let h=0;h<c;++h){let p=t?this.Tn(t[h/l]):Sg,_=this.En(e,p,r[h%l],i),E=this.dn(e,p,s[h%l],o),A=a.map(R=>this.En(e,p,R,!0));d.push(...this.createRange(_,E,A))}return d}En(e,t,r,i){let s=new la(e,K.empty(),t,r);return i?s:s.Jt()}dn(e,t,r,i){let s=new la(e,K.empty(),t,r);return i?s.Jt():s}ln(e,t){let r=new e_(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.cn(t);return k.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new Xe(At.comparator),d=!1;for(let h of c.filters)for(let p of h.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?d=!0:l=l.add(p.field));for(let h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}An(e,t){let r=new ca;for(let i of sa(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Yi.bt.Pt(s,o)}return r.Wt()}Tn(e){let t=new ca;return Yi.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let r=new ca;return Yi.bt.Pt(fa(this.databaseId,t),r.Ht(function(s){let o=sa(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,t,r){if(r===null)return[];let i=[];i.push(new ca);let s=0;for(let o of sa(e)){let a=r[s++];for(let c of i)if(this.Vn(t,o.fieldPath)&&fh(a))i=this.mn(i,o,a);else{let l=c.Ht(o.kind);Yi.bt.Pt(a,l)}}return this.fn(i)}hn(e,t,r){return this.Pn(e,t,r.position)}fn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Wt();return t}mn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new ca;c.seed(a.Wt()),Yi.bt.Pt(o,c.Ht(t.kind)),s.push(c)}return s}Vn(e,t){return!!e.filters.find(r=>r instanceof Re&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Xd(e),i=Zc(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return k.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,h){let p=h?new ch(h.sequenceNumber,new Ir(ya(h.readTime),new K(mi(h.documentKey)),h.largestBatchId)):ch.empty(),_=d.fields.map(([E,A])=>new ol(At.fromServerFormat(E),A));return new ul(d.indexId,d.collectionGroup,_,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ge(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Xd(e),s=Zc(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>k.forEach(a,c=>s.put(ZO(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return k.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?k.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),k.forEach(a,c=>this.pn(e,i,c).next(l=>{let d=this.yn(s,c);return l.isEqual(d)?k.resolve():this.wn(e,s,c,l,d)}))))})}Sn(e,t,r,i){return Xc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,t.key),documentKey:t.key.path.toArray()})}bn(e,t,r,i){return Xc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,t.key),t.key.path.toArray()])}pn(e,t,r){let i=Xc(e),s=new Xe(Vs);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,t)])},(o,a)=>{s=s.add(new la(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,t){let r=new Xe(Vs),i=this.An(t,e);if(i==null)return r;let s=lC(t);if(s!=null){let o=e.data.field(s.fieldPath);if(fh(o))for(let a of o.arrayValue.values||[])r=r.add(new la(t.indexId,e.key,this.Tn(a),i))}else r=r.add(new la(t.indexId,e.key,Sg,i));return r}wn(e,t,r,i,s){V("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,d,h,p){let _=c.getIterator(),E=l.getIterator(),A=Jc(_),R=Jc(E);for(;A||R;){let L=!1,Y=!1;if(A&&R){let j=d(A,R);j<0?Y=!0:j>0&&(L=!0)}else A!=null?Y=!0:L=!0;L?(h(R),R=Jc(E)):Y?(p(A),A=Jc(_)):(A=Jc(_),R=Jc(E))}}(i,s,Vs,a=>{o.push(this.Sn(e,t,r,a))},a=>{o.push(this.bn(e,t,r,a))}),k.waitFor(o)}gn(e){let t=1;return Zc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Vs(o,a)).filter((o,a,c)=>!a||Vs(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Vs(o,e),c=Vs(o,t);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Sg,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Sg,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,t){return Vs(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(oF)}getMinOffset(e,t){return k.mapArray(this.cn(t),r=>this.ln(e,r).next(i=>i||ee())).next(oF)}};function sF(n){return Kt(n,"collectionParents")}function Xc(n){return Kt(n,"indexEntries")}function Xd(n){return Kt(n,"indexConfiguration")}function Zc(n){return Kt(n,"indexState")}function oF(n){re(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;iS(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ir(e.readTime,e.documentKey,t)}var aF={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vr=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function xL(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,h,p)=>(a++,p.delete()));s.push(c.next(()=>{re(a===1)}));let l=[];for(let d of t.mutations){let h=OF(e,d.key.path,t.batchId);s.push(i.delete(h)),l.push(d.key)}return k.waitFor(s).next(()=>l)}function n_(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ee();e=n.noDocument}return JSON.stringify(e).length}vr.DEFAULT_COLLECTION_PERCENTILE=10,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vr.DEFAULT=new vr(41943040,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vr.DISABLED=new vr(-1,0,0);var r_=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,t,r,i){re(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Us(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=il(e),o=Us(e);return o.add({}).next(a=>{re(typeof a=="number");let c=new mh(a,t,r,i),l=function(_,E,A){let R=A.baseMutations.map(Y=>wh(_.ct,Y)),L=A.mutations.map(Y=>wh(_.ct,Y));return{userId:E,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:R,mutations:L}}(this.serializer,this.userId,c),d=[],h=new Xe((p,_)=>ge(p.canonicalString(),_.canonicalString()));for(let p of i){let _=OF(this.userId,p.key.path,a);h=h.add(p.key.path.popLast()),d.push(o.put(l)),d.push(s.put(_,CK))}return h.forEach(p=>{d.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),k.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return Us(e).get(t).next(r=>r?(re(r.userId===this.userId),aa(this.serializer,r)):null)}vn(e,t){return this.Cn[t]?k.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Us(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(re(a.batchId>=r),s=aa(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Us(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Us(e).U("userMutationsIndex",t).next(r=>r.map(i=>aa(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Rg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return il(e).J({range:i},(o,a,c)=>{let[l,d,h]=o,p=mi(d);if(l===this.userId&&t.path.isEqual(p))return Us(e).get(h).next(_=>{if(!_)throw ee();re(_.userId===this.userId),s.push(aa(this.serializer,_))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Xe(ge),i=[];return t.forEach(s=>{let o=Rg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=il(e).J({range:a},(l,d,h)=>{let[p,_,E]=l,A=mi(_);p===this.userId&&s.path.isEqual(A)?r=r.add(E):h.done()});i.push(c)}),k.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Rg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Xe(ge);return il(e).J({range:o},(c,l,d)=>{let[h,p,_]=c,E=mi(p);h===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(_)):d.done()}).next(()=>this.Fn(e,a))}Fn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(Us(e).get(s).next(o=>{if(o===null)throw ee();re(o.userId===this.userId),r.push(aa(this.serializer,o))}))}),k.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return xL(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),k.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return k.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return il(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=mi(s[1]);i.push(c)}else a.done()}).next(()=>{re(i.length===0)})})}containsKey(e,t){return RL(e,this.userId,t)}xn(e){return NL(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function RL(n,e,t){let r=Rg(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return il(n).J({range:s,H:!0},(a,c,l)=>{let[d,h,p]=a;d===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function Us(n){return Kt(n,"mutations")}function il(n){return Kt(n,"documentMutations")}function NL(n){return Kt(n,"mutationQueues")}var _l=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var KC=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let r=new _l(t.highestTargetId);return t.highestTargetId=r.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>se.fromTimestamp(new pt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(t,r),this.kn(e,r))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>el(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(re(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return el(e).J((o,a)=>{let c=nh(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>k.waitFor(s)).next(()=>i)}forEachTarget(e,t){return el(e).J((r,i)=>{let s=nh(i);t(s)})}Bn(e){return cF(e).get("targetGlobalKey").next(t=>(re(t!==null),t))}kn(e,t){return cF(e).put("targetGlobalKey",t)}qn(e,t){return el(e).put(SL(this.serializer,t))}Qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=ma(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return el(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=nh(a);Nh(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=js(e);return t.forEach(o=>{let a=Cn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),k.waitFor(i)}removeMatchingKeys(e,t,r){let i=js(e);return k.forEach(t,s=>{let o=Cn(s.path);return k.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=js(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=js(e),s=ye();return i.J({range:r,H:!0},(o,a,c)=>{let l=mi(o[1]),d=new K(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=Cn(t.path),i=IDBKeyRange.bound([r],[xF(r)],!1,!0),s=0;return js(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return el(e).get(t).next(r=>r?nh(r):null)}};function el(n){return Kt(n,"targets")}function cF(n){return Kt(n,"targetGlobal")}function js(n){return Kt(n,"targetDocuments")}function lF([n,e],[t,r]){let i=ge(n,t);return i===0?ge(e,r):i}var QC=class{constructor(e){this.Kn=e,this.buffer=new Xe(lF),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();lF(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},YC=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){V("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){no(t)?V("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield to(t)}yield this.zn(3e5)}))}},JC=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return k.resolve(Zn.oe);let r=new QC(t);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(aF)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),aF):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let r,i,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),tl()<=we.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function w7(n,e){return new JC(n,e)}var XC=class{constructor(e,t){this.db=e,this.garbageCollector=w7(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Zn(e){let t=0;return this.Jn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(r,i)=>t(i))}addReference(e,t,r){return Dg(e,r)}removeReference(e,t,r){return Dg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Dg(e,t)}er(e,t){return function(i,s){let o=!1;return NL(i).Y(a=>RL(i,a,s).next(c=>(c&&(o=!0),k.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=t){let c=this.er(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,se.min()),js(e).delete(function(h){return[0,Cn(h.path)]}(o))))});i.push(c)}}).next(()=>k.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Dg(e,t)}Xn(e,t){let r=js(e),i,s=Zn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==Zn.oe&&t(new K(mi(i)),s),s=l,i=c):s=Zn.oe}).next(()=>{s!==Zn.oe&&t(new K(mi(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Dg(n,e){return js(n).put(function(r,i){return{targetId:0,path:Cn(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var i_=class{constructor(){this.changes=new Ei(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?k.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ZC=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ia(e).put(r)}removeEntry(e,t,r){return ia(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Xg(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.tr(e,r)))}getEntry(e,t){let r=Vt.newInvalidDocument(t);return ia(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Zd(t))},(i,s)=>{r=this.nr(t,s)}).next(()=>r)}rr(e,t){let r={size:0,document:Vt.newInvalidDocument(t)};return ia(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Zd(t))},(i,s)=>{r={document:this.nr(t,s),size:n_(s)}}).next(()=>r)}getEntries(e,t){let r=qn();return this.ir(e,t,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,t){let r=qn(),i=new at(K.comparator);return this.ir(e,t,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,n_(o))}).next(()=>({documents:r,_r:i}))}ir(e,t,r){if(t.isEmpty())return k.resolve();let i=new Xe(hF);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(Zd(i.first()),Zd(i.last())),o=i.getIterator(),a=o.getNext();return ia(e).J({index:"documentKeyIndex",range:s},(c,l,d)=>{let h=K.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&hF(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(Zd(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Xg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ia(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=qn();for(let h of l){let p=this.nr(K.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);p.isFoundDocument()&&(kh(t,p)||i.has(p.key))&&(d=d.insert(p.key,p))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=qn(),o=dF(t,r),a=dF(t,Ir.max());return ia(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,d)=>{let h=this.nr(K.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new eT(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return uF(e).get("remoteDocumentGlobalKey").next(t=>(re(!!t),t))}tr(e,t){return uF(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let r=_7(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(se.min())))return r}return Vt.newInvalidDocument(e)}};function PL(n){return new ZC(n)}var eT=class extends i_{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new Ei(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Xe((s,o)=>ge(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=JO(this.ar.serializer,o);i=i.add(s.path.popLast());let l=n_(c);r+=l-a.size,t.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=JO(this.ar.serializer,o.convertToNoDocument(se.min()));t.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,r)),k.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(r=>(this.ur.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function uF(n){return Kt(n,"remoteDocumentGlobal")}function ia(n){return Kt(n,"remoteDocumentsV14")}function Zd(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function dF(n,e){let t=e.documentKey.path.toArray();return[n,Xg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function hF(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ge(t[s],r[s]),i)return i;return i=ge(t.length,r.length),i||(i=ge(t[t.length-2],r[r.length-2]),i||ge(t[t.length-1],r[r.length-1]))}var tT=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var s_=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&sh(r.mutation,i,er.empty(),pt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ye()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ye()){let i=gi();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=th();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=gi();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ye()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=qn(),o=ih(),a=function(){return ih()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof jr)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),sh(d.mutation,l,d.mutation.getFieldMask(),pt.now())):o.set(l.key,er.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var h;return a.set(l,new tT(d,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=ih(),i=new at((o,a)=>o-a),s=ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||er.empty();d=a.applyToLocalView(l,d),r.set(c,d);let h=(i.get(a.batchId)||ye()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,h=nL();d.forEach(p=>{if(!s.has(p)){let _=uL(t.get(p),r.get(p));_!==null&&h.set(p,_),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return k.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return K.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):cS(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):k.resolve(gi()),a=-1,c=s;return o.next(l=>k.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?k.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,ye())).next(d=>({batchId:a,changes:tL(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new K(t)).next(r=>{let i=th();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=th();return this.indexManager.getCollectionParents(e,s).next(a=>k.forEach(a,c=>{let l=function(h,p){return new Br(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,p)=>{o=o.insert(h,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,Vt.newInvalidDocument(d)))});let a=th();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&sh(d.mutation,l,er.empty(),pt.now()),kh(t,l)&&(a=a.insert(c,l))}),a})}};var nT=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return k.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:xt(i.createTime)}}(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:hS(i.bundledQuery),readTime:xt(i.readTime)}}(t)),k.resolve()}};var rT=class{constructor(){this.overlays=new at(K.comparator),this.hr=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){let r=gi();return k.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),k.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),k.resolve()}getOverlaysForCollection(e,t,r){let i=gi(),s=t.length+1,o=new K(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return k.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new at((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=gi(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=gi(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return k.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new gh(t,r));let s=this.hr.get(t);s===void 0&&(s=ye(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var Eh=class{constructor(){this.Pr=new Xe(Ft.Ir),this.Tr=new Xe(Ft.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new Ft(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new Ft(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new K(new Fe([])),r=new Ft(t,e),i=new Ft(t,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new K(new Fe([])),r=new Ft(t,e),i=new Ft(t,e+1),s=ye();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Ft(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ft=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return K.comparator(e.key,t.key)||ge(e.pr,t.pr)}static Er(e,t){return ge(e.pr,t.pr)||K.comparator(e.key,t.key)}};var iT=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new Xe(Ft.Ir)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new mh(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new Ft(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return k.resolve(o)}lookupMutationBatch(e,t){return k.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return k.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ft(t,0),i=new Ft(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),k.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Xe(ge);return t.forEach(i=>{let s=new Ft(i,0),o=new Ft(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),k.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;K.isDocumentKey(s)||(s=s.child(""));let o=new Ft(new K(s),0),a=new Xe(ge);return this.wr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.pr)),!0)},o),k.resolve(this.Dr(a))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){re(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return k.forEach(t.mutations,i=>{let s=new Ft(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new Ft(t,0),i=this.wr.firstAfterOrEqual(r);return k.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var sT=class{constructor(e){this.vr=e,this.docs=function(){return new at(K.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return k.resolve(r?r.document.mutableCopy():Vt.newInvalidDocument(t))}getEntries(e,t){let r=qn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Vt.newInvalidDocument(i))}),k.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=qn(),o=t.path,a=new K(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||iS(NF(d),r)<=0||(i.has(d.key)||kh(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return k.resolve(s)}getAllFromCollectionGroup(e,t,r,i){ee()}Fr(e,t){return k.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new oT(this)}getSize(e){return k.resolve(this.size)}},oT=class extends i_{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),k.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var aT=class{constructor(e){this.persistence=e,this.Mr=new Ei(t=>ma(t),Nh),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Eh,this.targetCount=0,this.Lr=_l.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),k.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new _l(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.qn(t),k.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),k.waitFor(s).next(()=>i)}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return k.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),k.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),k.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),k.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return k.resolve(r)}containsKey(e,t){return k.resolve(this.Nr.containsKey(t))}};var o_=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new Zn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new aT(this),this.indexManager=new GC,this.remoteDocumentCache=function(i){return new sT(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Jg(t),this.$r=new nT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new rT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new iT(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);let i=new cT(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return k.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},cT=class extends Ug{constructor(e){super(),this.currentSequenceNumber=e}},a_=class n{constructor(e){this.persistence=e,this.zr=new Eh,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw ee()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),k.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),k.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.Jr,r=>{let i=K.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,se.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return k.or([()=>k.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var lT=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new Bg("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xO,{unique:!0}),c.createObjectStore("documentMutations")}(e),fF(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=k.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),fF(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:se.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xO,{unique:!0});let h=l.store("mutations"),p=d.map(_=>h.put(_));return k.waitFor(p)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:FK});l.createIndex("collectionPathOverlayIndex",LK,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",VK,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:TK});l.createIndex("documentKeyIndex",SK),l.createIndex("collectionGroupIndex",DK)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:PK}).createIndex("sequenceNumberIndex",kK,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:MK}).createIndex("documentKeyIndex",OK,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=n_(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>k.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>k.forEach(a,c=>{re(c.userId===s.userId);let l=aa(this.serializer,c);return xL(e,s.userId,l).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new Fe(o),l=function(h){return[0,Cn(h)]}(c);s.push(t.get(l).next(d=>d?k.resolve():(h=>t.put({targetId:0,path:Cn(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>k.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:NK});let r=t.store("collectionParents"),i=new Ih,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Cn(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new Fe(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],l)=>{let d=mi(a);return s(d.popLast())}))}ri(e){let t=e.store("targets");return t.J((r,i)=>{let s=nh(i),o=SL(this.serializer,s);return t.put(o)})}ii(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(h){return h.document?new K(Fe.fromString(h.document.name).popFirst(5)):h.noDocument?K.fromSegments(h.noDocument.path):h.unknownDocument?K.fromSegments(h.unknownDocument.path):ee()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>k.waitFor(i))}si(e,t){let r=t.store("mutations"),i=PL(this.serializer),s=new o_(a_.Hr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:ye();aa(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),k.forEach(a,(c,l)=>{let d=new Lt(l),h=Zg.lt(this.serializer,d),p=s.getIndexManager(d),_=r_.lt(d,this.serializer,p,s.referenceDelegate);return new s_(i,_,h,p).recalculateAndSaveOverlaysForDocumentKeys(new uh(t,Zn.oe),c).next()})})}};function fF(n){n.createObjectStore("targetDocuments",{keyPath:xK}).createIndex("documentTargetsIndex",RK,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",AK,{unique:!0}),n.createObjectStore("targetGlobal")}var Zb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",uT=class n{constructor(e,t,r,i,s,o,a,c,l,d,h=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=l,this.ai=d,this.ui=h,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=p=>Promise.resolve(),!n.D())throw new F(O.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new XC(this,i),this.Ti=t+"main",this.serializer=new Jg(c),this.Ei=new Gs(this.Ti,this.ui,new lT(this.serializer)),this.Qr=new KC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=PL(this.serializer),this.$r=new UC,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,d===!1&&St("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new F(O.FAILED_PRECONDITION,Zb);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new Zn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>g(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>g(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ag(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(no(e))return V("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return V("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return eh(e).get("owner").next(t=>k.resolve(this.Si(t)))}bi(e){return Ag(e).delete(this.clientId)}Di(){return g(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Kt(t,"clientMetadata");return r.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return k.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?k.resolve(!0):eh(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new F(O.FAILED_PRECONDITION,Zb);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ag(e).U().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&V("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return g(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new uh(e,Zn.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(r=>this.Ci(r.updateTimeMs,t)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Ag(e).U().next(t=>this.vi(t,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return r_.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new WC(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Zg.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,r){V("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===16?BK:c===15?UF:c===14?VF:c===13?LF:c===12?UK:c===11?FF:void ee()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new uh(a,this.kr?this.kr.next():Zn.oe),t==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw St(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new F(O.FAILED_PRECONDITION,PF);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return eh(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new F(O.FAILED_PRECONDITION,Zb)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return eh(e).put("owner",t)}static D(){return Gs.D()}yi(e){let t=eh(e);return t.get("owner").next(r=>this.Si(r)?(V("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):k.resolve())}Ci(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(St(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;zE()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let r=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return V("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return St("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){St("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function eh(n){return Kt(n,"owner")}function Ag(n){return Kt(n,"clientMetadata")}function pS(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var dT=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=ye(),i=ye();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var hT=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var c_=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return zE()?8:kF(Je())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new hT;return this.Ji(e,t,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(tl()<=we.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",nl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),k.resolve()):(tl()<=we.DEBUG&&V("QueryEngine","Query:",nl(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(tl()<=we.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",nl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Tn(t))):k.resolve())}ji(e,t){if(BO(t))return k.resolve(null);let r=Tn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Wg(t,null,"F"),r=Tn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ye(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.Zi(t,a);return this.Xi(t,l,o,c.readTime)?this.ji(e,Wg(t,null,"F")):this.es(e,l,t,c)}))})))}Hi(e,t,r,i){return BO(t)||i.isEqual(se.min())?k.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,r,i)?k.resolve(null):(tl()<=we.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),nl(t)),this.es(e,o,t,RF(i,-1)).next(a=>a))})}Zi(e,t){let r=new Xe(ZF(e));return t.forEach((i,s)=>{kh(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return tl()<=we.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",nl(t)),this.zi.getDocumentsMatchingQuery(e,t,Ir.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var fT=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new at(ge),this.rs=new Ei(s=>ma(s),Nh),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new s_(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function kL(n,e,t,r){return new fT(n,e,t,r)}function ML(n,e){return g(this,null,function*(){let t=W(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=ye();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})})}function I7(n,e){let t=W(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let h=l.batch,p=h.keys(),_=k.resolve();return p.forEach(E=>{_=_.next(()=>d.getEntry(c,E)).next(A=>{let R=l.docVersions.get(E);re(R!==null),A.version.compareTo(R)<0&&(h.applyToRemoteDocument(A,l),A.isValidDocument()&&(A.setReadTime(l.commitVersion),d.addEntry(A)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ye();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function OL(n){let e=W(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function E7(n,e){let t=W(n),r=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let a=[];e.targetChanges.forEach((d,h)=>{let p=i.get(h);if(!p)return;a.push(t.Qr.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Qr.addMatchingKeys(s,d.addedDocuments,h)));let _=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?_=_.withResumeToken(Wt.EMPTY_BYTE_STRING,se.min()).withLastLimboFreeSnapshotVersion(se.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(h,_),function(A,R,L){return A.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(p,_,d)&&a.push(t.Qr.updateTargetData(s,_))});let c=qn(),l=ye();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(FL(s,o,e.documentUpdates).next(d=>{c=d.cs,l=d.ls})),!r.isEqual(se.min())){let d=t.Qr.getLastRemoteSnapshotVersion(s).next(h=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return k.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.ns=i,s))}function FL(n,e,t){let r=ye(),i=ye();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=qn();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(se.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):V("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:i}})}function b7(n,e){let t=W(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function yl(n,e){let t=W(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,k.resolve(i)):t.Qr.allocateTargetId(r).next(o=>(i=new gl(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}function vl(n,e,t){return g(this,null,function*(){let r=W(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!no(o))throw o;V("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function l_(n,e,t){let r=W(n),i=se.min(),s=ye();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let h=W(c),p=h.rs.get(d);return p!==void 0?k.resolve(h.ns.get(p)):h.Qr.getTargetData(l,d)}(r,o,Tn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?i:se.min(),t?s:ye())).next(a=>(UL(r,XF(e),a),{documents:a,hs:s})))}function LL(n,e){let t=W(n),r=W(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function VL(n,e){let t=W(n),r=t.ss.get(e)||se.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,RF(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(UL(t,e,i),i))}function UL(n,e,t){let r=n.ss.get(e)||se.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}function C7(n,e,t,r){return g(this,null,function*(){let i=W(n),s=ye(),o=qn();for(let l of t){let d=e.Ps(l.metadata.name);l.document&&(s=s.add(d));let h=e.Is(l);h.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(d,h)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield yl(i,function(d){return Tn(Dl(Fe.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>FL(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Qr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.cs,d.ls)).next(()=>d.cs)))})}function T7(r,i){return g(this,arguments,function*(n,e,t=ye()){let s=yield yl(n,Tn(hS(e.bundledQuery))),o=W(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=xt(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let l=s.withResumeToken(Wt.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(a,l).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,t,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function pF(n,e){return`firestore_clients_${n}_${e}`}function mF(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function eC(n,e){return`firestore_targets_${n}_${e}`}var u_=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Es(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new F(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(St("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},oh=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Es(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new F(r.error.code,r.error.message))),s?new n(e,r.state,i):(St("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},d_=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=lS();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=MF(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(St("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},pT=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(St("SharedClientState",`Failed to parse online state: ${e}`),null)}},bh=class{constructor(){this.activeTargetIds=lS()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},ah=class{constructor(e,t,r,i,s){this.window=e,this.oi=t,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new at(ge),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=pF(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new bh),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(pF(this.persistenceKey,r));if(i){let s=d_.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let r=this.xs(t);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,r){this.Ls(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(eC(this.persistenceKey,e));if(r){let i=oh.Es(e,r);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(eC(this.persistenceKey,e))}updateQueryState(e,t,r){this.qs(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return V("SharedClientState","READ",e,t),t}setItem(e,t){V("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){V("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(V("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void St("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let r=this.$s(t.key);return this.Us(r,null)}{let r=this.Ws(t.key,t.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let r=this.Gs(t.key,t.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let r=this.js(t.key,t.newValue);if(r)return this.Hs(r)}}else if(t.key===this.vs){if(t.newValue!==null){let r=this.xs(t.newValue);if(r)return this.Os(r)}}else if(t.key===this.Ss){let r=function(s){let o=Zn.oe;if(s!=null)try{let a=JSON.parse(s);re(typeof a=="number"),o=a}catch(a){St("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Zn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Fs){let r=this.Js(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,r){let i=new u_(this.currentUser,e,t,r),s=mF(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let t=mF(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,r){let i=eC(this.persistenceKey,e),s=new oh(e,t,r);this.setItem(i,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let r=this.$s(e);return d_.Es(r,t)}Gs(e,t){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return u_.Es(new Lt(s),i,t)}js(e,t){let r=this.Cs.exec(e),i=Number(r[1]);return oh.Es(i,t)}xs(e){return pT.Es(e)}Js(e){return JSON.parse(e)}zs(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);V("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let r=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=lS();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},h_=class{constructor(){this.no=new bh,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new bh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var mT=class{io(e){}shutdown(){}};var f_=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){V("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){V("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var xg=null;function tC(){return xg===null?xg=function(){return 268435456+Math.round(2147483648*Math.random())}():xg++,"0x"+xg.toString(16)}var S7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var gT=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var hn="WebChannelConnection",_T=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,o){let a=tC(),c=this.vo(t,r.toUriEncodedString());V("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(l,s,o),this.Mo(t,c,l,i).then(d=>(V("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw wr("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}xo(t,r,i,s,o,a){return this.Co(t,r,i,s,o)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Sl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,r){let i=S7[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=tC();return new Promise((o,a)=>{let c=new Gb;c.setWithCredentials(!0),c.listenOnce(Kb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Yd.NO_ERROR:let d=c.getResponseJson();V(hn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Yd.TIMEOUT:V(hn,`RPC '${e}' ${s} timed out`),a(new F(O.DEADLINE_EXCEEDED,"Request time out"));break;case Yd.HTTP_ERROR:let h=c.getStatus();if(V(hn,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);let _=p?.error;if(_&&_.status&&_.message){let E=function(R){let L=R.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(L)>=0?L:O.UNKNOWN}(_.status);a(new F(E,_.message))}else a(new F(O.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new F(O.UNAVAILABLE,"Connection failed."));break;default:ee()}}finally{V(hn,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);V(hn,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Oo(e,t,r){let i=tC(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Jb(),a=Yb(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Wb({})),this.Fo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");V(hn,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c),p=!1,_=!1,E=new gT({lo:R=>{_?V(hn,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(p||(V(hn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),V(hn,`RPC '${e}' stream ${i} sending:`,R),h.send(R))},ho:()=>h.close()}),A=(R,L,Y)=>{R.listen(L,j=>{try{Y(j)}catch(Z){setTimeout(()=>{throw Z},0)}})};return A(h,Yc.EventType.OPEN,()=>{_||(V(hn,`RPC '${e}' stream ${i} transport opened.`),E.mo())}),A(h,Yc.EventType.CLOSE,()=>{_||(_=!0,V(hn,`RPC '${e}' stream ${i} transport closed`),E.po())}),A(h,Yc.EventType.ERROR,R=>{_||(_=!0,wr(hn,`RPC '${e}' stream ${i} transport errored:`,R),E.po(new F(O.UNAVAILABLE,"The operation could not be completed")))}),A(h,Yc.EventType.MESSAGE,R=>{var L;if(!_){let Y=R.data[0];re(!!Y);let j=Y,Z=j.error||((L=j[0])===null||L===void 0?void 0:L.error);if(Z){V(hn,`RPC '${e}' stream ${i} received error:`,Z);let ue=Z.status,ne=function(b){let D=Ot[b];if(D!==void 0)return fL(D)}(ue),S=Z.message;ne===void 0&&(ne=O.INTERNAL,S="Unknown error status: "+ue+" with message "+Z.message),_=!0,E.po(new F(ne,S)),h.close()}else V(hn,`RPC '${e}' stream ${i} received:`,Y),E.yo(Y)}}),A(a,Qb.STAT_EVENT,R=>{R.stat===Tg.PROXY?V(hn,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Tg.NOPROXY&&V(hn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.fo()},0),E}};function BL(){return typeof window<"u"?window:null}function Mg(){return typeof document<"u"?document:null}function Mh(n){return new MC(n,!0)}var Ch=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var p_=class{constructor(e,t,r,i,s,o,a,c){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Ch(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return g(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return g(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return g(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(St(t.toString()),St("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new F(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>g(this,null,function*(){this.state=0,this.start()}))}c_(e){return V("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(V("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},yT=class extends p_{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=l7(this.serializer,e),r=function(s){if(!("targetChange"in s))return se.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?se.min():o.readTime?xt(o.readTime):se.min()}(e);return this.listener.h_(t,r)}P_(e){let t={};t.database=LC(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=zg(c)?{documents:IL(s,c)}:{query:dS(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=mL(s,o.resumeToken);let l=OC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(se.min())>0){a.readTime=ml(s,o.snapshotVersion.toTimestamp());let l=OC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=h7(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){let t={};t.database=LC(this.serializer),t.removeTarget=e,this.i_(t)}},vT=class extends p_{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(re(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=u7(e.writeResults,e.commitTime),r=xt(e.commitTime);return this.listener.A_(r,t)}return re(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=LC(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>wh(this.serializer,r))};this.i_(t)}};var wT=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new F(O.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,FC(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new F(O.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,FC(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new F(O.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},IT=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(St(t),this.y_=!1):V("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var ET=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>g(this,null,function*(){ro(this)&&(V("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let l=W(c);l.M_.add(4),yield Al(l),l.N_.set("Unknown"),l.M_.delete(4),yield Oh(l)})}(this))}))}),this.N_=new IT(r,i)}};function Oh(n){return g(this,null,function*(){if(ro(n))for(let e of n.x_)yield e(!0)})}function Al(n){return g(this,null,function*(){for(let e of n.x_)yield e(!1)})}function k_(n,e){let t=W(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),_S(t)?gS(t):Rl(t).Xo()&&mS(t,e))}function wl(n,e){let t=W(n),r=Rl(t);t.F_.delete(e),r.Xo()&&jL(t,e),t.F_.size===0&&(r.Xo()?r.n_():ro(t)&&t.N_.set("Unknown"))}function mS(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(se.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Rl(n).P_(e)}function jL(n,e){n.L_.xe(e),Rl(n).I_(e)}function gS(n){n.L_=new kC({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Rl(n).start(),n.N_.w_()}function _S(n){return ro(n)&&!Rl(n).Zo()&&n.F_.size>0}function ro(n){return W(n).M_.size===0}function $L(n){n.L_=void 0}function D7(n){return g(this,null,function*(){n.N_.set("Online")})}function A7(n){return g(this,null,function*(){n.F_.forEach((e,t)=>{mS(n,e)})})}function x7(n,e){return g(this,null,function*(){$L(n),_S(n)?(n.N_.D_(e),gS(n)):n.N_.set("Unknown")})}function R7(n,e,t){return g(this,null,function*(){if(n.N_.set("Online"),e instanceof Qg&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(n,e)}catch(r){V("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield m_(n,r)}else if(e instanceof cl?n.L_.Ke(e):e instanceof Kg?n.L_.He(e):n.L_.We(e),!t.isEqual(se.min()))try{let r=yield OL(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.F_.get(l);d&&s.F_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.F_.get(c);if(!d)return;s.F_.set(c,d.withResumeToken(Wt.EMPTY_BYTE_STRING,d.snapshotVersion)),jL(s,c);let h=new gl(d.target,c,l,d.sequenceNumber);mS(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){V("RemoteStore","Failed to raise snapshot:",r),yield m_(n,r)}})}function m_(n,e,t){return g(this,null,function*(){if(!no(e))throw e;n.M_.add(1),yield Al(n),n.N_.set("Offline"),t||(t=()=>OL(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){V("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield Oh(n)}))})}function HL(n,e){return e().catch(t=>m_(n,t,e))}function xl(n){return g(this,null,function*(){let e=W(n),t=eo(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;N7(e);)try{let i=yield b7(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,P7(e,i)}catch(i){yield m_(e,i)}qL(e)&&zL(e)})}function N7(n){return ro(n)&&n.v_.length<10}function P7(n,e){n.v_.push(e);let t=eo(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function qL(n){return ro(n)&&!eo(n).Zo()&&n.v_.length>0}function zL(n){eo(n).start()}function k7(n){return g(this,null,function*(){eo(n).V_()})}function M7(n){return g(this,null,function*(){let e=eo(n);for(let t of n.v_)e.d_(t.mutations)})}function O7(n,e,t){return g(this,null,function*(){let r=n.v_.shift(),i=xC.from(r,e,t);yield HL(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield xl(n)})}function F7(n,e){return g(this,null,function*(){e&&eo(n).E_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return hL(o)&&o!==O.ABORTED}(i.code)){let s=r.v_.shift();eo(r).t_(),yield HL(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield xl(r)}})}(n,e)),qL(n)&&zL(n)})}function gF(n,e){return g(this,null,function*(){let t=W(n);t.asyncQueue.verifyOperationInProgress(),V("RemoteStore","RemoteStore received new credentials");let r=ro(t);t.M_.add(3),yield Al(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield Oh(t)})}function bT(n,e){return g(this,null,function*(){let t=W(n);e?(t.M_.delete(2),yield Oh(t)):e||(t.M_.add(2),yield Al(t),t.N_.set("Unknown"))})}function Rl(n){return n.B_||(n.B_=function(t,r,i){let s=W(t);return s.f_(),new yT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:D7.bind(null,n),To:A7.bind(null,n),Ao:x7.bind(null,n),h_:R7.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.B_.t_(),_S(n)?gS(n):n.N_.set("Unknown")):(yield n.B_.stop(),$L(n))}))),n.B_}function eo(n){return n.k_||(n.k_=function(t,r,i){let s=W(t);return s.f_(),new vT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:k7.bind(null,n),Ao:F7.bind(null,n),R_:M7.bind(null,n),A_:O7.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.k_.t_(),yield xl(n)):(yield n.k_.stop(),n.v_.length>0&&(V("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var CT=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Dt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Nl(n,e){if(St("AsyncQueue",`${e}: ${n}`),no(n))return new F(O.UNAVAILABLE,`${e}: ${n}`);throw n}var g_=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||K.comparator(t.key,r.key):(t,r)=>K.comparator(t.key,r.key),this.keyedMap=th(),this.sortedSet=new at(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var __=class{constructor(){this.q_=new at(K.comparator)}track(e){let t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):ee():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}},Il=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,g_.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ph(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var TT=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},ST=class{constructor(){this.queries=new Ei(e=>JF(e),Ph),this.onlineState="Unknown",this.z_=new Set}};function yS(n,e){return g(this,null,function*(){let t=W(n),r=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new TT,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=Nl(o,`Initialization of query '${nl(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&wS(t)})}function vS(n,e){return g(this,null,function*(){let t=W(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function L7(n,e){let t=W(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&wS(t)}function V7(n,e,t){let r=W(n),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(t);r.queries.delete(e)}function wS(n){n.z_.forEach(e=>{e.next()})}var DT,_F;(_F=DT||(DT={})).J_="default",_F.Cache="cache";var Th=class{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Il(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Il.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==DT.Cache}};var AT=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var y_=class{constructor(e){this.serializer=e}Ps(e){return yi(this.serializer,e)}Is(e){return e.metadata.exists?wL(this.serializer,e.document,!1):Vt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return xt(e)}},xT=class{constructor(e,t,r){this.oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=GL(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let r=Fe.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,r=new y_(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||ye()).add(s);t.set(o,a)}}return t}complete(){return g(this,null,function*(){let e=yield C7(this.localStore,new y_(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let r of this.queries)yield T7(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function GL(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var v_=class{constructor(e){this.key=e}},w_=class{constructor(e){this.key=e}},I_=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=ye(),this.mutatedKeys=ye(),this.Ia=ZF(e),this.Ta=new g_(this.Ia)}get Ea(){return this.la}da(e,t){let r=t?t.Aa:new __,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let p=i.get(d),_=kh(this.query,h)?h:null,E=!!p&&this.mutatedKeys.has(p.key),A=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),R=!1;p&&_?p.data.isEqual(_.data)?E!==A&&(r.track({type:3,doc:_}),R=!0):this.Ra(p,_)||(r.track({type:2,doc:_}),R=!0,(c&&this.Ia(_,c)>0||l&&this.Ia(_,l)<0)&&(a=!0)):!p&&_?(r.track({type:0,doc:_}),R=!0):p&&!_&&(r.track({type:1,doc:p}),R=!0,(c||l)&&(a=!0)),R&&(_?(o=o.add(_),s=A?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((d,h)=>function(_,E){let A=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ee()}};return A(_)-A(E)}(d.type,h.type)||this.Ia(d.doc,h.doc)),this.Va(r),i=i!=null&&i;let a=t&&!i?this.ma():[],c=this.Pa.size===0&&this.current&&!i?1:0,l=c!==this.ha;return this.ha=c,o.length!==0||l?{snapshot:new Il(this.query,e.Ta,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new __,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=ye(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new w_(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new v_(r))}),t}pa(e){this.la=e.hs,this.Pa=ye();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Il.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},RT=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},NT=class{constructor(e){this.key=e,this.wa=!1}},PT=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new Ei(a=>JF(a),Ph),this.Da=new Map,this.Ca=new Set,this.va=new at(K.comparator),this.Fa=new Map,this.Ma=new Eh,this.xa={},this.Oa=new Map,this.Na=_l.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function U7(n,e,t=!0){return g(this,null,function*(){let r=M_(n),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield WL(r,e,t,!0),i})}function B7(n,e){return g(this,null,function*(){let t=M_(n);yield WL(t,e,!0,!1)})}function WL(n,e,t,r){return g(this,null,function*(){let i=yield yl(n.localStore,Tn(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield IS(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&k_(n.remoteStore,i),a})}function IS(n,e,t,r,i){return g(this,null,function*(){n.Ba=(h,p,_)=>function(A,R,L,Y){return g(this,null,function*(){let j=R.view.da(L);j.Xi&&(j=yield l_(A.localStore,R.query,!1).then(({documents:S})=>R.view.da(S,j)));let Z=Y&&Y.targetChanges.get(R.targetId),ue=Y&&Y.targetMismatches.get(R.targetId)!=null,ne=R.view.applyChanges(j,A.isPrimaryClient,Z,ue);return kT(A,R.targetId,ne.fa),ne.snapshot})}(n,h,p,_);let s=yield l_(n.localStore,e,!0),o=new I_(e,s.hs),a=o.da(s.documents),c=yh.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);kT(n,t,l.fa);let d=new RT(e,t,o);return n.ba.set(e,d),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),l.snapshot})}function j7(n,e,t){return g(this,null,function*(){let r=W(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!Ph(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield vl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&wl(r.remoteStore,i.targetId),El(r,i.targetId)}).catch(to))):(El(r,i.targetId),yield vl(r.localStore,i.targetId,!0))})}function $7(n,e){return g(this,null,function*(){let t=W(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),wl(t.remoteStore,r.targetId))})}function H7(n,e,t){return g(this,null,function*(){let r=TS(n);try{let i=yield function(o,a){let c=W(o),l=pt.now(),d=a.reduce((_,E)=>_.add(E.key),ye()),h,p;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=qn(),A=ye();return c.os.getEntries(_,d).next(R=>{E=R,E.forEach((L,Y)=>{Y.isValidDocument()||(A=A.add(L))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,E)).next(R=>{h=R;let L=[];for(let Y of a){let j=n7(Y,h.get(Y.key).overlayedDocument);j!=null&&L.push(new jr(Y.key,j,HF(j.value.mapValue),Et.exists(!0)))}return c.mutationQueue.addMutationBatch(_,l,L,a)}).next(R=>{p=R;let L=R.applyToLocalDocumentSet(h,A);return c.documentOverlayCache.saveOverlays(_,R.batchId,L)})}).then(()=>({batchId:p.batchId,changes:tL(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.xa[o.currentUser.toKey()];l||(l=new at(ge)),l=l.insert(a,c),o.xa[o.currentUser.toKey()]=l}(r,i.batchId,t),yield ns(r,i.changes),yield xl(r.remoteStore)}catch(i){let s=Nl(i,"Failed to persist write");t.reject(s)}})}function KL(n,e){return g(this,null,function*(){let t=W(n);try{let r=yield E7(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(re(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?re(o.wa):i.removedDocuments.size>0&&(re(o.wa),o.wa=!1))}),yield ns(t,r,e)}catch(r){yield to(r)}})}function yF(n,e,t){let r=W(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=W(o);c.onlineState=a;let l=!1;c.queries.forEach((d,h)=>{for(let p of h.U_)p.j_(a)&&(l=!0)}),l&&wS(c)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function q7(n,e,t){return g(this,null,function*(){let r=W(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new at(K.comparator);o=o.insert(s,Vt.newNoDocument(s,se.min()));let a=ye().add(s),c=new _h(se.min(),new Map,new at(ge),o,a);yield KL(r,c),r.va=r.va.remove(s),r.Fa.delete(e),CS(r)}else yield vl(r.localStore,e,!1).then(()=>El(r,e,t)).catch(to)})}function z7(n,e){return g(this,null,function*(){let t=W(n),r=e.batch.batchId;try{let i=yield I7(t.localStore,e);bS(t,r,null),ES(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ns(t,i)}catch(i){yield to(i)}})}function G7(n,e,t){return g(this,null,function*(){let r=W(n);try{let i=yield function(o,a){let c=W(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(re(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);bS(r,e,t),ES(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ns(r,i)}catch(i){yield to(i)}})}function W7(n,e){return g(this,null,function*(){let t=W(n);ro(t.remoteStore)||V("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=W(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Oa.get(r)||[];i.push(e),t.Oa.set(r,i)}catch(r){let i=Nl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function ES(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function bS(n,e,t){let r=W(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function El(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||QL(n,r)})}function QL(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(wl(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),CS(n))}function kT(n,e,t){for(let r of t)r instanceof v_?(n.Ma.addReference(r.key,e),K7(n,r)):r instanceof w_?(V("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||QL(n,r.key)):ee()}function K7(n,e){let t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(V("SyncEngine","New document in limbo: "+t),n.Ca.add(r),CS(n))}function CS(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new K(Fe.fromString(e)),r=n.Na.next();n.Fa.set(r,new NT(t)),n.va=n.va.insert(t,r),k_(n.remoteStore,new gl(Tn(Dl(t.path)),r,"TargetPurposeLimboResolution",Zn.oe))}}function ns(n,e,t){return g(this,null,function*(){let r=W(n),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,c)=>{o.push(r.Ba(c,e,t).then(l=>{if((l||t)&&r.isPrimaryClient){let d=l&&!l.fromCache;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);let d=dT.Ki(c.targetId,l);s.push(d)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(c,l){return g(this,null,function*(){let d=W(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>k.forEach(l,p=>k.forEach(p.qi,_=>d.persistence.referenceDelegate.addReference(h,p.targetId,_)).next(()=>k.forEach(p.Qi,_=>d.persistence.referenceDelegate.removeReference(h,p.targetId,_)))))}catch(h){if(!no(h))throw h;V("LocalStore","Failed to update sequence numbers: "+h)}for(let h of l){let p=h.targetId;if(!h.fromCache){let _=d.ns.get(p),E=_.snapshotVersion,A=_.withLastLimboFreeSnapshotVersion(E);d.ns=d.ns.insert(p,A)}}})}(r.localStore,s))})}function Q7(n,e){return g(this,null,function*(){let t=W(n);if(!t.currentUser.isEqual(e)){V("SyncEngine","User change. New user:",e.toKey());let r=yield ML(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(c=>{c.reject(new F(O.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ns(t,r.us)}})}function Y7(n,e){let t=W(n),r=t.Fa.get(e);if(r&&r.wa)return ye().add(r.key);{let i=ye(),s=t.Da.get(e);if(!s)return i;for(let o of s){let a=t.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function J7(n,e){return g(this,null,function*(){let t=W(n),r=yield l_(t.localStore,e.query,!0),i=e.view.pa(r);return t.isPrimaryClient&&kT(t,e.targetId,i.fa),i})}function X7(n,e){return g(this,null,function*(){let t=W(n);return VL(t.localStore,e).then(r=>ns(t,r))})}function Z7(n,e,t,r){return g(this,null,function*(){let i=W(n),s=yield function(a,c){let l=W(a),d=W(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.vn(h,c).next(p=>p?l.localDocuments.getDocuments(h,p):k.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield xl(i.remoteStore):t==="acknowledged"||t==="rejected"?(bS(i,e,r||null),ES(i,e),function(a,c){W(W(a).mutationQueue).Mn(c)}(i.localStore,e)):ee(),yield ns(i,s)):V("SyncEngine","Cannot apply mutation batch with id: "+e)})}function eQ(n,e){return g(this,null,function*(){let t=W(n);if(M_(t),TS(t),e===!0&&t.La!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield vF(t,r.toArray());t.La=!0,yield bT(t.remoteStore,!0);for(let s of i)k_(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let r=[],i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(El(t,o),vl(t.localStore,o,!0))),wl(t.remoteStore,o)}),yield i,yield vF(t,r),function(o){let a=W(o);a.Fa.forEach((c,l)=>{wl(a.remoteStore,l)}),a.Ma.mr(),a.Fa=new Map,a.va=new at(K.comparator)}(t),t.La=!1,yield bT(t.remoteStore,!1)}})}function vF(n,e,t){return g(this,null,function*(){let r=W(n),i=[],s=[];for(let o of e){let a,c=r.Da.get(o);if(c&&c.length!==0){a=yield yl(r.localStore,Tn(c[0]));for(let l of c){let d=r.ba.get(l),h=yield J7(r,d);h.snapshot&&s.push(h.snapshot)}}else{let l=yield LL(r.localStore,o);a=yield yl(r.localStore,l),yield IS(r,YL(l),o,!1,a.resumeToken)}i.push(a)}return r.Sa.h_(s),i})}function YL(n){return QF(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function tQ(n){return function(t){return W(W(t).persistence).Bi()}(W(n).localStore)}function nQ(n,e,t,r){return g(this,null,function*(){let i=W(n);if(i.La)return void V("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield VL(i.localStore,XF(s[0])),a=_h.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Wt.EMPTY_BYTE_STRING);yield ns(i,o,a);break}case"rejected":yield vl(i.localStore,e,!0),El(i,e,r);break;default:ee()}})}function rQ(n,e,t){return g(this,null,function*(){let r=M_(n);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){V("SyncEngine","Adding an already active target "+i);continue}let s=yield LL(r.localStore,i),o=yield yl(r.localStore,s);yield IS(r,YL(s),o.targetId,!1,o.resumeToken),k_(r.remoteStore,o)}for(let i of t)r.Da.has(i)&&(yield vl(r.localStore,i,!1).then(()=>{wl(r.remoteStore,i),El(r,i)}).catch(to))}})}function M_(n){let e=W(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=KL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Y7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=q7.bind(null,e),e.Sa.h_=L7.bind(null,e.eventManager),e.Sa.ka=V7.bind(null,e.eventManager),e}function TS(n){let e=W(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=z7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=G7.bind(null,e),e}function iQ(n,e,t){let r=W(n);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(_,E){let A=W(_),R=xt(E.createTime);return A.persistence.runTransaction("hasNewerBundle","readonly",L=>A.$r.getBundleMetadata(L,E.id)).then(L=>!!L&&L.createTime.compareTo(R)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(GL(c));let l=new xT(c,s.localStore,o.serializer),d=yield o.qa();for(;d;){let p=yield l._a(d);p&&a._updateProgress(p),d=yield o.qa()}let h=yield l.complete();return yield ns(s,h.ca,void 0),yield function(_,E){let A=W(_);return A.persistence.runTransaction("Save bundle","readwrite",R=>A.$r.saveBundleMetadata(R,E))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.ua)}catch(c){return wr("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Sh=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=Mh(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return kL(this.persistence,new c_,e.initialUser,this.serializer)}createPersistence(e){return new o_(a_.Hr,this.serializer)}createSharedClientState(e){return new h_}terminate(){return g(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var E_=class n extends Sh{constructor(e,t,r){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield Kr(n.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield TS(this.Qa.syncEngine),yield xl(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return kL(this.persistence,new c_,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new YC(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new fC(t,this.persistence);return new hC(e.asyncQueue,r)}createPersistence(e){let t=pS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?vr.withCacheSize(this.cacheSizeBytes):vr.DEFAULT;return new uT(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,BL(),Mg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new h_}},MT=class n extends E_{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield Kr(n.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof ah&&(this.sharedClientState.syncEngine={Zs:Z7.bind(null,t),Xs:nQ.bind(null,t),eo:rQ.bind(null,t),Bi:tQ.bind(null,t),Ys:X7.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>g(this,null,function*(){yield eQ(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=BL();if(!ah.D(t))throw new F(O.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=pS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ah(t,e.asyncQueue,r,e.clientId,e.initialUser)}},Dh=class{initialize(e,t){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>yF(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Q7.bind(null,this.syncEngine),yield bT(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new ST}()}createDatastore(e){let t=Mh(e.databaseInfo.databaseId),r=function(s){return new _T(s)}(e.databaseInfo);return function(s,o,a,c){return new wT(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new ET(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>yF(this.syncEngine,t,0),function(){return f_.D()?new f_:new mT}())}createSyncEngine(e,t){return function(i,s,o,a,c,l,d){let h=new PT(i,s,o,a,c,l);return d&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return g(this,null,function*(){var e;yield function(r){return g(this,null,function*(){let i=W(r);V("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Al(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function wF(n,e=10240){let t=0;return{read(){return g(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var bl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):St("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var OT=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new Dt,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}qa(){return g(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return g(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),r=Number(t);isNaN(r)&&this.ja(`length string (${t}) is not valid number`);let i=yield this.Ha(r);return new AT(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return g(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return g(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var FT=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new F(O.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return g(this,null,function*(){let o=W(i),a={documents:s.map(h=>vh(o.serializer,h))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,Fe.emptyPath(),a,s.length),l=new Map;c.forEach(h=>{let p=c7(o.serializer,h);l.set(p.key.toString(),p)});let d=[];return s.forEach(h=>{let p=l.get(h.toString());re(!!p),d.push(p)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Zs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=K.fromPath(r);this.mutations.push(new ph(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=W(r),o={writes:i.map(a=>wh(s.serializer,a))};yield s.Co("Commit",s.serializer.databaseId,Fe.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ee();t=se.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new F(O.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(se.min())?Et.exists(!1):Et.updateTime(t):Et.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(se.min()))throw new F(O.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Et.updateTime(t)}return Et.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var LT=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Yo=new Ch(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>g(this,null,function*(){let e=new FT(this.datastore),t=this.tu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let t=this.updateFunction(e);return!Rh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!hL(t)}return!1}};var VT=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Lt.UNAUTHENTICATED,this.clientId=Lg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){V("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(V("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new F(O.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Dt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Nl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Og(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),V("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield ML(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function UT(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield SS(n);V("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>gF(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>gF(e.remoteStore,i)),n._onlineComponents=e})}function JL(n){return n.name==="FirebaseError"?n.code===O.FAILED_PRECONDITION||n.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function SS(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Og(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!JL(t))throw t;wr("Error using user provided cache. Falling back to memory cache: "+t),yield Og(n,new Sh)}}else V("FirestoreClient","Using default OfflineComponentProvider"),yield Og(n,new Sh);return n._offlineComponents})}function O_(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(V("FirestoreClient","Using user provided OnlineComponentProvider"),yield UT(n,n._uninitializedComponentsProvider._online)):(V("FirestoreClient","Using default OnlineComponentProvider"),yield UT(n,new Dh))),n._onlineComponents})}function XL(n){return SS(n).then(e=>e.persistence)}function DS(n){return SS(n).then(e=>e.localStore)}function ZL(n){return O_(n).then(e=>e.remoteStore)}function AS(n){return O_(n).then(e=>e.syncEngine)}function eV(n){return O_(n).then(e=>e.datastore)}function Cl(n){return g(this,null,function*(){let e=yield O_(n),t=e.eventManager;return t.onListen=U7.bind(null,e.syncEngine),t.onUnlisten=j7.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=B7.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=$7.bind(null,e.syncEngine),t})}function sQ(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield XL(n),t=yield ZL(n);return e.setNetworkEnabled(!0),function(i){let s=W(i);return s.M_.delete(0),Oh(s)}(t)}))}function oQ(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield XL(n),t=yield ZL(n);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=W(i);s.M_.add(0),yield Al(s),s.N_.set("Offline")})}(t)}))}function aQ(n,e){let t=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(l,d){let h=W(l);return h.persistence.runTransaction("read document","readonly",p=>h.localDocuments.getDocument(p,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new F(O.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Nl(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield DS(n),e,t)})),t.promise}function tV(n,e,t={}){let r=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new bl({next:p=>{o.enqueueAndForget(()=>vS(s,h));let _=p.docs.has(a);!_&&p.fromCache?l.reject(new F(O.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&c&&c.source==="server"?l.reject(new F(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new Th(Dl(a.path),d,{includeMetadataChanges:!0,ra:!0});return yS(s,h)}(yield Cl(n),n.asyncQueue,e,t,r)})),r.promise}function cQ(n,e){let t=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield l_(i,s,!0),c=new I_(s,a.hs),l=c.da(a.documents),d=c.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let c=Nl(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield DS(n),e,t)})),t.promise}function nV(n,e,t={}){let r=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new bl({next:p=>{o.enqueueAndForget(()=>vS(s,h)),p.fromCache&&c.source==="server"?l.reject(new F(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new Th(a,d,{includeMetadataChanges:!0,ra:!0});return yS(s,h)}(yield Cl(n),n.asyncQueue,e,t,r)})),r.promise}function lQ(n,e,t){let r=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){try{let i=yield eV(n);r.resolve(function(o,a,c){return g(this,null,function*(){var l;let d=W(o),{request:h,ut:p,parent:_}=d7(d.serializer,GK(a),c);d.connection.Do||delete h.parent;let E=(yield d.xo("RunAggregationQuery",d.serializer.databaseId,_,h,1)).filter(R=>!!R.result);re(E.length===1);let A=(l=E[0].result)===null||l===void 0?void 0:l.aggregateFields;return Object.keys(A).reduce((R,L)=>(R[p[L]]=A[L],R),{})})}(i,e,t))}catch(i){r.reject(i)}})),r.promise}function uQ(n,e){let t=new bl(e);return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){W(i).z_.add(s),s.next()}(yield Cl(n),t)})),()=>{t.$a(),n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){W(i).z_.delete(s)}(yield Cl(n),t)}))}}function dQ(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?pL().encode(o):o,function(d,h){return new OT(d,h)}(function(d,h){if(d instanceof Uint8Array)return wF(d,h);if(d instanceof ArrayBuffer)return wF(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,Mh(e));n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){iQ(yield AS(n),i,r)}))}function hQ(n,e){return n.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=W(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield DS(n),e)}))}function rV(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var IF=new Map;function xS(n,e,t){if(!t)throw new F(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function RS(n,e,t,r){if(e===!0&&r===!0)throw new F(O.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function EF(n){if(!K.isDocumentKey(n))throw new F(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function bF(n){if(K.isDocumentKey(n))throw new F(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function F_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ee()}function Ne(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new F(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=F_(n);throw new F(O.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function iV(n,e){if(e<=0)throw new F(O.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var b_=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new F(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new F(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}RS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rV((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},va=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new b_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new F(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new F(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new b_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new nC;switch(r.type){case"firstParty":return new oC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new F(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=IF.get(t);r&&(V("ComponentProvider","Removing Datastore"),IF.delete(t),r.terminate())}(this),Promise.resolve()}};function sV(n,e,t,r={}){var i;let s=(n=Ne(n,va))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&wr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Lt.MOCK_USER;else{a=Oc(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new F(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Lt(l)}n._authCredentials=new rC(new Fg(a,c))}}var en=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},nt=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},vi=class n extends en{constructor(e,t,r){super(e,t,Dl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new nt(this.firestore,null,new K(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function rs(n,e,...t){if(n=G(n),xS("collection","path",e),n instanceof va){let r=Fe.fromString(e,...t);return bF(r),new vi(n,null,r)}{if(!(n instanceof nt||n instanceof vi))throw new F(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Fe.fromString(e,...t));return bF(r),new vi(n.firestore,null,r)}}function oV(n,e){if(n=Ne(n,va),xS("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new F(O.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new en(n,null,function(r){return new Br(Fe.emptyPath(),r)}(e))}function Fh(n,e,...t){if(n=G(n),arguments.length===1&&(e=Lg.newId()),xS("doc","path",e),n instanceof va){let r=Fe.fromString(e,...t);return EF(r),new nt(n,null,new K(r))}{if(!(n instanceof nt||n instanceof vi))throw new F(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Fe.fromString(e,...t));return EF(r),new nt(n.firestore,n instanceof vi?n.converter:null,new K(r))}}function NS(n,e){return n=G(n),e=G(e),(n instanceof nt||n instanceof vi)&&(e instanceof nt||e instanceof vi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function PS(n,e){return n=G(n),e=G(e),n instanceof en&&e instanceof en&&n.firestore===e.firestore&&Ph(n._query,e._query)&&n.converter===e.converter}var BT=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Ch(this,"async_queue_retry"),this.hu=()=>{let t=Mg();t&&V("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=Mg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=Mg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new Dt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return g(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!no(e))throw e;V("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw St("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=CT.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&ee()}verifyOperationInProgress(){}du(){return g(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function jT(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var $T=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Dt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var aV=-1,ct=class extends va{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new BT}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||cV(this),this._firestoreClient.terminate()}};function Ut(n){return n._firestoreClient||cV(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function cV(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,d){return new pC(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,rV(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new VT(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function lV(n,e){yV(n=Ne(n,ct));let t=Ut(n);if(t._uninitializedComponentsProvider)throw new F(O.FAILED_PRECONDITION,"SDK cache is already specified.");wr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new Dh;return dV(t,i,new E_(i,r.cacheSizeBytes,e?.forceOwnership))}function uV(n){yV(n=Ne(n,ct));let e=Ut(n);if(e._uninitializedComponentsProvider)throw new F(O.FAILED_PRECONDITION,"SDK cache is already specified.");wr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new Dh;return dV(e,r,new MT(r,t.cacheSizeBytes))}function dV(n,e,t){let r=new Dt;return n.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield Og(n,t),yield UT(n,e),r.resolve()}catch(i){let s=i;if(!JL(s))throw s;wr("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function hV(n){if(n._initialized&&!n._terminated)throw new F(O.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Dt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!Gs.D())return Promise.resolve();let i=r+"main";yield Gs.delete(i)})}(pS(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function fV(n){return function(t){let r=new Dt;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return W7(yield AS(t),r)})),r.promise}(Ut(n=Ne(n,ct)))}function pV(n){return sQ(Ut(n=Ne(n,ct)))}function mV(n){return oQ(Ut(n=Ne(n,ct)))}function gV(n,e){let t=Ut(n=Ne(n,ct)),r=new $T;return dQ(t,n._databaseId,e,r),r}function _V(n,e){return hQ(Ut(n=Ne(n,ct)),e).then(t=>t?new en(n,null,t.query):null)}function yV(n){if(n._initialized||n._terminated)throw new F(O.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var HT=class{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}},qT=class{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}};var bi=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Wt.fromBase64String(e))}catch(t){throw new F(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Wt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var $r=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new At(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ts=class{constructor(e){this._methodName=e}};var wa=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ge(this._lat,e._lat)||ge(this._long,e._long)}};var fQ=/^__.*__$/,zT=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new jr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Xs(e,this.data,t,this.fieldTransforms)}},C_=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new jr(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function vV(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ee()}}var T_=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return S_(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(vV(this.fu)&&fQ.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},GT=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Mh(e)}Fu(e,t,r,i=!1){return new T_({fu:e,methodName:t,vu:r,path:At.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Ca(n){let e=n._freezeSettings(),t=Mh(n._databaseId);return new GT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function L_(n,e,t,r,i,s={}){let o=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);OS("Data must be an object, but it was:",o,r);let a=EV(r,o),c,l;if(s.merge)c=new er(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let p=JT(e,h,t);if(!o.contains(p))throw new F(O.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);CV(d,p)||d.push(p)}c=new er(d),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new zT(new fn(a),c,l)}var Ah=class n extends ts{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function wV(n,e,t){return new T_({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var WT=class n extends ts{_toFieldTransform(e){return new ga(e.path,new Ys)}isEqual(e){return e instanceof n}},KT=class n extends ts{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=wV(this,e,!0),r=this.Mu.map(s=>Ta(s,t)),i=new Zi(r);return new ga(e.path,i)}isEqual(e){return e instanceof n&&As(this.Mu,e.Mu)}},QT=class n extends ts{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=wV(this,e,!0),r=this.Mu.map(s=>Ta(s,t)),i=new es(r);return new ga(e.path,i)}isEqual(e){return e instanceof n&&As(this.Mu,e.Mu)}},YT=class n extends ts{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new Js(e.serializer,sL(e.serializer,this.xu));return new ga(e.path,t)}isEqual(e){return e instanceof n&&this.xu===e.xu}};function kS(n,e,t,r){let i=n.Fu(1,e,t);OS("Data must be an object, but it was:",i,r);let s=[],o=fn.empty();ba(r,(c,l)=>{let d=FS(e,c,t);l=G(l);let h=i.Su(d);if(l instanceof Ah)s.push(d);else{let p=Ta(l,h);p!=null&&(s.push(d),o.set(d,p))}});let a=new er(s);return new C_(o,a,i.fieldTransforms)}function MS(n,e,t,r,i,s){let o=n.Fu(1,e,t),a=[JT(e,r,t)],c=[i];if(s.length%2!=0)throw new F(O.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(JT(e,s[p])),c.push(s[p+1]);let l=[],d=fn.empty();for(let p=a.length-1;p>=0;--p)if(!CV(l,a[p])){let _=a[p],E=c[p];E=G(E);let A=o.Su(_);if(E instanceof Ah)l.push(_);else{let R=Ta(E,A);R!=null&&(l.push(_),d.set(_,R))}}let h=new er(l);return new C_(d,h,o.fieldTransforms)}function IV(n,e,t,r=!1){return Ta(t,n.Fu(r?4:3,e))}function Ta(n,e){if(bV(n=G(n)))return OS("Unsupported field value:",e,n),EV(n,e);if(n instanceof ts)return function(r,i){if(!vV(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Ta(a,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=G(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return sL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=pt.fromDate(r);return{timestampValue:ml(i.serializer,s)}}if(r instanceof pt){let s=new pt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ml(i.serializer,s)}}if(r instanceof wa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof bi)return{bytesValue:mL(i.serializer,r._byteString)};if(r instanceof nt){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:uS(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${F_(r)}`)}(n,e)}function EV(n,e){let t={};return BF(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ba(n,(r,i)=>{let s=Ta(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function bV(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof pt||n instanceof wa||n instanceof bi||n instanceof nt||n instanceof ts)}function OS(n,e,t){if(!bV(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=F_(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function JT(n,e,t){if((e=G(e))instanceof $r)return e._internalPath;if(typeof e=="string")return FS(n,e);throw S_("Field path arguments must be of type string or ",n,!1,void 0,t)}var pQ=new RegExp("[~\\*/\\[\\]]");function FS(n,e,t){if(e.search(pQ)>=0)throw S_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new $r(...e.split("."))._internalPath}catch{throw S_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function S_(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new F(O.INVALID_ARGUMENT,a+n+c)}function CV(n,e){return n.some(t=>t.isEqual(e))}var Ia=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new nt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new XT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(V_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},XT=class extends Ia{data(){return super.data()}};function V_(n,e){return typeof e=="string"?FS(n,e):e instanceof $r?e._internalPath:e._delegate._internalPath}function TV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new F(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var xh=class{},Ea=class extends xh{};function qr(n,e,...t){let r=[];e instanceof xh&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof ZT).length,a=s.filter(c=>c instanceof D_).length;if(o>1||o>0&&a>0)throw new F(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var D_=class n extends Ea{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return MV(e._query,t),new en(e.firestore,e.converter,DC(e._query,t))}_parse(e){let t=Ca(e.firestore);return function(s,o,a,c,l,d,h){let p;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new F(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){TF(h,d);let _=[];for(let E of h)_.push(CF(c,s,E));p={arrayValue:{values:_}}}else p=CF(c,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||TF(h,d),p=IV(a,o,h,d==="in"||d==="not-in");return Re.create(l,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function U_(n,e,t){let r=e,i=V_("where",n);return D_._create(i,r,t)}var ZT=class n extends xh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:We.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)MV(o,c),o=DC(o,c)}(e._query,t),new en(e.firestore,e.converter,DC(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var eS=class n extends Ea{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new F(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new F(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new pa(s,o)}(e._query,this._field,this._direction);return new en(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Br(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function SV(n,e="asc"){let t=e,r=V_("orderBy",n);return eS._create(r,t)}var A_=class n extends Ea{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new en(e.firestore,e.converter,Wg(e._query,this._limit,this._limitType))}};function DV(n){return iV("limit",n),A_._create("limit",n,"F")}function AV(n){return iV("limitToLast",n),A_._create("limitToLast",n,"L")}var x_=class n extends Ea{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=kV(e,this.type,this._docOrFields,this._inclusive);return new en(e.firestore,e.converter,function(i,s){return new Br(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function xV(...n){return x_._create("startAt",n,!0)}function RV(...n){return x_._create("startAfter",n,!1)}var R_=class n extends Ea{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=kV(e,this.type,this._docOrFields,this._inclusive);return new en(e.firestore,e.converter,function(i,s){return new Br(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function NV(...n){return R_._create("endBefore",n,!1)}function PV(...n){return R_._create("endAt",n,!0)}function kV(n,e,t,r){if(t[0]=G(t[0]),t[0]instanceof Ia)return function(s,o,a,c,l){if(!c)throw new F(O.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of al(s))if(h.field.isKeyField())d.push(fa(o,c.key));else{let p=c.data.field(h.field);if(P_(p))throw new F(O.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let _=h.field.canonicalString();throw new F(O.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(p)}return new Ii(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Ca(n.firestore);return function(o,a,c,l,d,h){let p=o.explicitOrderBy;if(d.length>p.length)throw new F(O.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let _=[];for(let E=0;E<d.length;E++){let A=d[E];if(p[E].field.isKeyField()){if(typeof A!="string")throw new F(O.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof A}`);if(!cS(o)&&A.indexOf("/")!==-1)throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${A}' contains a slash.`);let R=o.path.child(Fe.fromString(A));if(!K.isDocumentKey(R))throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let L=new K(R);_.push(fa(a,L))}else{let R=IV(c,l,A);_.push(R)}}return new Ii(_,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function CF(n,e,t){if(typeof(t=G(t))=="string"){if(t==="")throw new F(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cS(e)&&t.indexOf("/")!==-1)throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Fe.fromString(t));if(!K.isDocumentKey(r))throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fa(n,new K(r))}if(t instanceof nt)return fa(n,t._key);throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${F_(t)}.`)}function TF(n,e){if(!Array.isArray(n)||n.length===0)throw new F(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function MV(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new F(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new F(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Tl=class{convertValue(e,t="none"){switch(ha(e)){case 0:return null;case 1:return e.booleanValue;case 2:return It(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ws(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ee()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return ba(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new wa(It(e.latitude),It(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=oS(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(dh(e));default:return null}}convertTimestamp(e){let t=Xi(e);return new pt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Fe.fromString(e);re(TL(r));let i=new Ks(r.get(1),r.get(3)),s=new K(r.popFirst(5));return i.isEqual(t)||St(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function B_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var tS=class extends Tl{constructor(e){super(),this.firestore=e}convertBytes(e){return new bi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new nt(this.firestore,null,t)}};function mQ(){return new HT("count")}var Ji=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Er=class extends Ia{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new qs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(V_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},qs=class extends Er{data(e={}){return super.data(e)}},Hr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ji(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new qs(this._firestore,this._userDataWriter,r.key,r,new Ji(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new qs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ji(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new qs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ji(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:gQ(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function gQ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ee()}}function LS(n,e){return n instanceof Er&&e instanceof Er?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Hr&&e instanceof Hr&&n._firestore===e._firestore&&PS(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function OV(n){n=Ne(n,nt);let e=Ne(n.firestore,ct);return tV(Ut(e),n._key).then(t=>BS(e,n,t))}var Ci=class extends Tl{constructor(e){super(),this.firestore=e}convertBytes(e){return new bi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new nt(this.firestore,null,t)}};function FV(n){n=Ne(n,nt);let e=Ne(n.firestore,ct),t=Ut(e),r=new Ci(e);return aQ(t,n._key).then(i=>new Er(e,r,n._key,i,new Ji(i!==null&&i.hasLocalMutations,!0),n.converter))}function LV(n){n=Ne(n,nt);let e=Ne(n.firestore,ct);return tV(Ut(e),n._key,{source:"server"}).then(t=>BS(e,n,t))}function VV(n){n=Ne(n,en);let e=Ne(n.firestore,ct),t=Ut(e),r=new Ci(e);return TV(n._query),nV(t,n._query).then(i=>new Hr(e,r,n,i))}function UV(n){n=Ne(n,en);let e=Ne(n.firestore,ct),t=Ut(e),r=new Ci(e);return cQ(t,n._query).then(i=>new Hr(e,r,n,i))}function BV(n){n=Ne(n,en);let e=Ne(n.firestore,ct),t=Ut(e),r=new Ci(e);return nV(t,n._query,{source:"server"}).then(i=>new Hr(e,r,n,i))}function VS(n,e,t){n=Ne(n,nt);let r=Ne(n.firestore,ct),i=B_(n.converter,e,t);return Pl(r,[L_(Ca(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Et.none())])}function US(n,e,t,...r){n=Ne(n,nt);let i=Ne(n.firestore,ct),s=Ca(i),o;return o=typeof(e=G(e))=="string"||e instanceof $r?MS(s,"updateDoc",n._key,e,t,r):kS(s,"updateDoc",n._key,e),Pl(i,[o.toMutation(n._key,Et.exists(!0))])}function jV(n){return Pl(Ne(n.firestore,ct),[new Zs(n._key,Et.none())])}function $V(n,e){let t=Ne(n.firestore,ct),r=Fh(n),i=B_(n.converter,e);return Pl(t,[L_(Ca(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Et.exists(!1))]).then(()=>r)}function Lh(n,...e){var t,r,i;n=G(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||jT(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(jT(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,d;if(n instanceof nt)l=Ne(n.firestore,ct),d=Dl(n._key.path),c={next:h=>{e[o]&&e[o](BS(l,n,h))},error:e[o+1],complete:e[o+2]};else{let h=Ne(n,en);l=Ne(h.firestore,ct),d=h._query;let p=new Ci(l);c={next:_=>{e[o]&&e[o](new Hr(l,p,h,_))},error:e[o+1],complete:e[o+2]},TV(n._query)}return function(p,_,E,A){let R=new bl(A),L=new Th(_,R,E);return p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return yS(yield Cl(p),L)})),()=>{R.$a(),p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return vS(yield Cl(p),L)}))}}(Ut(l),d,a,c)}function HV(n,e){return uQ(Ut(n=Ne(n,ct)),jT(e)?e:{next:e})}function Pl(n,e){return function(r,i){let s=new Dt;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return H7(yield AS(r),i,s)})),s.promise}(Ut(n),e)}function BS(n,e,t){let r=t.docs.get(e._key),i=new Ci(n);return new Er(n,i,e._key,r,new Ji(t.hasPendingWrites,t.fromCache),e.converter)}function j_(n){return _Q(n,{count:mQ()})}function _Q(n,e){let t=Ne(n.firestore,ct),r=Ut(t),i=jK(e,(s,o)=>new RC(o,s.aggregateType,s._internalFieldPath));return lQ(r,n._query,i).then(s=>function(a,c,l){let d=new Ci(a);return new qT(c,d,l)}(t,n,s))}var yQ={maxAttempts:5};var N_=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ca(e)}set(e,t,r){this._verifyNotCommitted();let i=$s(e,this._firestore),s=B_(i.converter,t,r),o=L_(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Et.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=$s(e,this._firestore),o;return o=typeof(t=G(t))=="string"||t instanceof $r?MS(this._dataReader,"WriteBatch.update",s._key,t,r,i):kS(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Et.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=$s(e,this._firestore);return this._mutations=this._mutations.concat(new Zs(t._key,Et.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new F(O.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function $s(n,e){if((n=G(n)).firestore!==e)throw new F(O.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var nS=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Ca(t)}get(t){let r=$s(t,this._firestore),i=new tS(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return ee();let o=s[0];if(o.isFoundDocument())return new Ia(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Ia(this._firestore,i,r._key,null,r.converter);throw ee()})}set(t,r,i){let s=$s(t,this._firestore),o=B_(s.converter,r,i),a=L_(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=$s(t,this._firestore),a;return a=typeof(r=G(r))=="string"||r instanceof $r?MS(this._dataReader,"Transaction.update",o._key,r,i,s):kS(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=$s(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=$s(e,this._firestore),r=new Ci(this._firestore);return super.get(e).then(i=>new Er(this._firestore,r,t._key,i._document,new Ji(!1,!1),t.converter))}};function qV(n,e,t){n=Ne(n,ct);let r=Object.assign(Object.assign({},yQ),t);return function(s){if(s.maxAttempts<1)throw new F(O.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new Dt;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let l=yield eV(s);new LT(s.asyncQueue,l,a,o,c).Xa()})),c.promise}(Ut(n),i=>e(new nS(n,i)),r)}function zV(){return new Ah("deleteField")}function GV(){return new WT("serverTimestamp")}function WV(...n){return new KT("arrayUnion",n)}function KV(...n){return new QT("arrayRemove",n)}function QV(n){return new YT("increment",n)}(function(e,t=!0){(function(i){Sl=i})(bn),En(new Ke("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new ct(new iC(r.getProvider("auth-internal")),new cC(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new F(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ks(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Tt(SO,"4.6.3",e),Tt(SO,"4.6.3","esm2017")})();var vQ="@firebase/firestore-compat",wQ="0.3.32";function GS(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new F("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function YV(){if(typeof Uint8Array>"u")throw new F("unimplemented","Uint8Arrays are not available in this environment.")}function JV(){if(!jF())throw new F("unimplemented","Blobs are unavailable in Firestore in this environment.")}var $_=class n{constructor(e){this._delegate=e}static fromBase64String(e){return JV(),new n(bi.fromBase64String(e))}static fromUint8Array(e){return YV(),new n(bi.fromUint8Array(e))}toBase64(){return JV(),this._delegate.toBase64()}toUint8Array(){return YV(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function jS(n){return IQ(n,["next","error","complete"])}function IQ(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var $S=class{enableIndexedDbPersistence(e,t){return lV(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return uV(e._delegate)}clearIndexedDbPersistence(e){return hV(e._delegate)}},H_=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ks||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&wr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){sV(this._delegate,e,t,r)}enableNetwork(){return pV(this._delegate)}disableNetwork(){return mV(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,RS("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return fV(this._delegate)}onSnapshotsInSync(e){return HV(this._delegate,e)}get app(){if(!this._appCompat)throw new F("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ol(this,rs(this._delegate,e))}catch(t){throw Sn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ti(this,Fh(this._delegate,e))}catch(t){throw Sn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new xa(this,oV(this._delegate,e))}catch(t){throw Sn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return qV(this._delegate,t=>e(new q_(this,t)))}batch(){return Ut(this._delegate),new z_(new N_(this._delegate,e=>Pl(this._delegate,e)))}loadBundle(e){return gV(this._delegate,e)}namedQuery(e){return _V(this._delegate,e).then(t=>t?new xa(this,t):null)}},kl=class extends Tl{constructor(e){super(),this.firestore=e}convertBytes(e){return new $_(new bi(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Ti.forKey(t,this.firestore,null)}};function EQ(n){DF(n)}var q_=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new kl(e)}get(e){let t=Sa(e);return this._delegate.get(t).then(r=>new Da(this._firestore,new Er(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Sa(e);return r?(GS("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Sa(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Sa(e);return this._delegate.delete(t),this}},z_=class{constructor(e){this._delegate=e}set(e,t,r){let i=Sa(e);return r?(GS("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Sa(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Sa(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Ml=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new qs(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Aa(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new kl(e),t),i.set(t,s)),s}};Ml.INSTANCES=new WeakMap;var Ti=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new kl(e)}static forPath(e,t,r){if(e.length%2!==0)throw new F("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new nt(t._delegate,r,new K(e)))}static forKey(e,t,r){return new n(t,new nt(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ol(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ol(this.firestore,rs(this._delegate,e))}catch(t){throw Sn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=G(e),e instanceof nt?NS(this._delegate,e):!1}set(e,t){t=GS("DocumentReference.set",t);try{return t?VS(this._delegate,e,t):VS(this._delegate,e)}catch(r){throw Sn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?US(this._delegate,e):US(this._delegate,e,t,...r)}catch(i){throw Sn(i,"updateDoc()","DocumentReference.update()")}}delete(){return jV(this._delegate)}onSnapshot(...e){let t=XV(e),r=ZV(e,i=>new Da(this.firestore,new Er(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Lh(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=FV(this._delegate):e?.source==="server"?t=LV(this._delegate):t=OV(this._delegate),t.then(r=>new Da(this.firestore,new Er(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ml.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Sn(n,e,t){return n.message=n.message.replace(e,t),n}function XV(n){for(let e of n)if(typeof e=="object"&&!jS(e))return e;return{}}function ZV(n,e){var t,r;let i;return jS(n[0])?i=n[0]:jS(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Da=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ti(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return LS(this._delegate,e._delegate)}},Aa=class extends Da{data(e){let t=this._delegate.data(e);return this._delegate._converter||AF(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},xa=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new kl(e)}where(e,t,r){try{return new n(this.firestore,qr(this._delegate,U_(e,t,r)))}catch(i){throw Sn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,qr(this._delegate,SV(e,t)))}catch(r){throw Sn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,qr(this._delegate,DV(e)))}catch(t){throw Sn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,qr(this._delegate,AV(e)))}catch(t){throw Sn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,qr(this._delegate,xV(...e)))}catch(t){throw Sn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,qr(this._delegate,RV(...e)))}catch(t){throw Sn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,qr(this._delegate,NV(...e)))}catch(t){throw Sn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,qr(this._delegate,PV(...e)))}catch(t){throw Sn(t,"endAt()","Query.endAt()")}}isEqual(e){return PS(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=UV(this._delegate):e?.source==="server"?t=BV(this._delegate):t=VV(this._delegate),t.then(r=>new Vh(this.firestore,new Hr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=XV(e),r=ZV(e,i=>new Vh(this.firestore,new Hr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Lh(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ml.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},HS=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Aa(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Vh=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new xa(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Aa(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new HS(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Aa(this._firestore,r))})}isEqual(e){return LS(this._delegate,e._delegate)}},Ol=class n extends xa{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Ti(this.firestore,e):null}doc(e){try{return e===void 0?new Ti(this.firestore,Fh(this._delegate)):new Ti(this.firestore,Fh(this._delegate,e))}catch(t){throw Sn(t,"doc()","CollectionReference.doc()")}}add(e){return $V(this._delegate,e).then(t=>new Ti(this.firestore,t))}isEqual(e){return NS(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ml.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Sa(n){return Ne(n,nt)}var qS=class n{constructor(...e){this._delegate=new $r(...e)}static documentId(){return new n(At.keyField().canonicalString())}isEqual(e){return e=G(e),e instanceof $r?this._delegate._internalPath.isEqual(e._internalPath):!1}};var zS=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=GV();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=zV();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=WV(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=KV(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=QV(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var bQ={Firestore:H_,GeoPoint:wa,Timestamp:pt,Blob:$_,Transaction:q_,WriteBatch:z_,DocumentReference:Ti,DocumentSnapshot:Da,Query:xa,QueryDocumentSnapshot:Aa,QuerySnapshot:Vh,CollectionReference:Ol,FieldPath:qS,FieldValue:zS,setLogLevel:EQ,CACHE_SIZE_UNLIMITED:aV};function CQ(n,e){n.INTERNAL.registerComponent(new Ke("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},bQ)))}function TQ(n){CQ(n,(e,t)=>new H_(e,t,new $S)),n.registerVersion(vQ,wQ)}TQ(U);var c2="firebasestorage.googleapis.com",l2="storageBucket",SQ=2*60*1e3,DQ=10*60*1e3,AQ=1e3;var mt=class n extends yt{constructor(e,t,r=0){super(WS(e),`Firebase Storage: ${t} (${WS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return WS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},dt=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(dt||{});function WS(n){return"storage/"+n}function tD(){let n="An unknown error occurred, please check the error payload for server response.";return new mt(dt.UNKNOWN,n)}function xQ(n){return new mt(dt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function RQ(n){return new mt(dt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function NQ(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new mt(dt.UNAUTHENTICATED,n)}function PQ(){return new mt(dt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function kQ(n){return new mt(dt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function u2(){return new mt(dt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function d2(){return new mt(dt.CANCELED,"User canceled the upload/download.")}function MQ(n){return new mt(dt.INVALID_URL,"Invalid URL '"+n+"'.")}function OQ(n){return new mt(dt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function FQ(){return new mt(dt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+l2+"' property when initializing the app?")}function h2(){return new mt(dt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function LQ(){return new mt(dt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function VQ(){return new mt(dt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function UQ(n){return new mt(dt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ra(n){return new mt(dt.INVALID_ARGUMENT,n)}function f2(){return new mt(dt.APP_DELETED,"The Firebase app was deleted.")}function nD(n){return new mt(dt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Bh(n,e){return new mt(dt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Uh(n){throw new mt(dt.INTERNAL_ERROR,"Internal error: "+n)}var Dn=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw OQ(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(Z){Z.path.charAt(Z.path.length-1)==="/"&&(Z.path_=Z.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(Z){Z.path_=decodeURIComponent(Z.path)}let d="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",_=new RegExp(`^https?://${h}/${d}/b/${i}/o${p}`,"i"),E={bucket:1,path:3},A=t===c2?"(?:storage.googleapis.com|storage.cloud.google.com)":t,R="([^?#]*)",L=new RegExp(`^https?://${A}/${i}/${R}`,"i"),j=[{regex:a,indices:c,postModify:s},{regex:_,indices:E,postModify:l},{regex:L,indices:{bucket:1,path:2},postModify:l}];for(let Z=0;Z<j.length;Z++){let ue=j[Z],ne=ue.regex.exec(e);if(ne){let S=ne[ue.indices.bucket],v=ne[ue.indices.path];v||(v=""),r=new n(S,v),ue.postModify(r);break}}if(r==null)throw MQ(e);return r}},QS=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function BQ(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...R){l||(l=!0,e.apply(null,R))}function h(R){i=setTimeout(()=>{i=null,n(_,c())},R)}function p(){s&&clearTimeout(s)}function _(R,...L){if(l){p();return}if(R){p(),d.call(null,R,...L);return}if(c()||o){p(),d.call(null,R,...L);return}r<64&&(r*=2);let j;a===1?(a=2,j=0):j=(r+Math.random())*1e3,h(j)}let E=!1;function A(R){E||(E=!0,p(),!l&&(i!==null?(R||(a=2),clearTimeout(i),h(0)):R||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,A(!0)},t),A}function jQ(n){n(!1)}function $Q(n){return n!==void 0}function HQ(n){return typeof n=="function"}function qQ(n){return typeof n=="object"&&!Array.isArray(n)}function K_(n){return typeof n=="string"||n instanceof String}function e2(n){return rD()&&n instanceof Blob}function rD(){return typeof Blob<"u"}function YS(n,e,t,r){if(r<e)throw Ra(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Ra(`Invalid value for '${n}'. Expected ${t} or less.`)}function io(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function p2(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Vl=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Vl||{});function m2(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var JS=class{constructor(e,t,r,i,s,o,a,c,l,d,h,p=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,E)=>{this.resolve_=_,this.reject_=E,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Ll(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Vl.NO_ERROR,c=s.getStatus();if(!a||m2(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===Vl.ABORT;r(!1,new Ll(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new Ll(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());$Q(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=tD();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?f2():d2();o(c)}else{let c=u2();o(c)}};this.canceled_?t(!1,new Ll(!1,null,!0)):this.backoffId_=BQ(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&jQ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Ll=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function zQ(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function GQ(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function WQ(n,e){e&&(n["X-Firebase-GMPID"]=e)}function KQ(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function QQ(n,e,t,r,i,s,o=!0){let a=p2(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return WQ(l,e),zQ(l,t),GQ(l,s),KQ(l,r),new JS(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function YQ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function JQ(...n){let e=YQ();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(rD())return new Blob(n);throw new mt(dt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function XQ(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function ZQ(n){if(typeof atob>"u")throw UQ("base-64");return atob(n)}var tr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},jh=class{constructor(e,t){this.data=e,this.contentType=t||null}};function iD(n,e){switch(n){case tr.RAW:return new jh(g2(e));case tr.BASE64:case tr.BASE64URL:return new jh(_2(n,e));case tr.DATA_URL:return new jh(tY(e),nY(e))}throw tD()}function g2(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function eY(n){let e;try{e=decodeURIComponent(n)}catch{throw Bh(tr.DATA_URL,"Malformed data URL.")}return g2(e)}function _2(n,e){switch(n){case tr.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Bh(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case tr.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Bh(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=ZQ(e)}catch(i){throw i.message.includes("polyfill")?i:Bh(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var W_=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw Bh(tr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=rY(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function tY(n){let e=new W_(n);return e.base64?_2(tr.BASE64,e.rest):eY(e.rest)}function nY(n){return new W_(n).contentType}function rY(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var Ul=class n{constructor(e,t){let r=0,i="";e2(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(e2(this.data_)){let r=this.data_,i=XQ(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(rD()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(JQ.apply(null,t))}else{let t=e.map(o=>K_(o)?iD(tr.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function sD(n){let e;try{e=JSON.parse(n)}catch{return null}return qQ(e)?e:null}function iY(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function sY(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function y2(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function oY(n,e){return e}var tn=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||oY}},G_=null;function aY(n){return!K_(n)||n.length<2?n:y2(n)}function Q_(){if(G_)return G_;let n=[];n.push(new tn("bucket")),n.push(new tn("generation")),n.push(new tn("metageneration")),n.push(new tn("name","fullPath",!0));function e(s,o){return aY(o)}let t=new tn("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new tn("size");return i.xform=r,n.push(i),n.push(new tn("timeCreated")),n.push(new tn("updated")),n.push(new tn("md5Hash",null,!0)),n.push(new tn("cacheControl",null,!0)),n.push(new tn("contentDisposition",null,!0)),n.push(new tn("contentEncoding",null,!0)),n.push(new tn("contentLanguage",null,!0)),n.push(new tn("contentType",null,!0)),n.push(new tn("metadata","customMetadata",!0)),G_=n,G_}function cY(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new Dn(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function lY(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return cY(r,n),r}function v2(n,e,t){let r=sD(e);return r===null?null:lY(n,r,t)}function uY(n,e,t,r){let i=sD(e);if(i===null||!K_(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=n.bucket,h=n.fullPath,p="/b/"+o(d)+"/o/"+o(h),_=io(p,t,r),E=p2({alt:"media",token:l});return _+E})[0]}function oD(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var t2="prefixes",n2="items";function dY(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[t2])for(let i of t[t2]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new Dn(e,s));r.prefixes.push(o)}if(t[n2])for(let i of t[n2]){let s=n._makeStorageReference(new Dn(e,i.name));r.items.push(s)}return r}function hY(n,e,t){let r=sD(t);return r===null?null:dY(n,e,r)}var zr=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Di(n){if(!n)throw tD()}function Y_(n,e){function t(r,i){let s=v2(n,i,e);return Di(s!==null),s}return t}function fY(n,e){function t(r,i){let s=hY(n,e,i);return Di(s!==null),s}return t}function pY(n,e){function t(r,i){let s=v2(n,i,e);return Di(s!==null),uY(s,i,n.host,n._protocol)}return t}function $l(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=PQ():i=NQ():t.getStatus()===402?i=RQ(n.bucket):t.getStatus()===403?i=kQ(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function J_(n){let e=$l(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=xQ(n.path)),s.serverResponse=i.serverResponse,s}return t}function w2(n,e,t){let r=e.fullServerUrl(),i=io(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new zr(i,s,Y_(n,t),o);return a.errorHandler=J_(e),a}function mY(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=io(o,n.host,n._protocol),c="GET",l=n.maxOperationRetryTime,d=new zr(a,c,fY(n,e.bucket),l);return d.urlParams=s,d.errorHandler=$l(e),d}function gY(n,e,t){let r=e.fullServerUrl(),i=io(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new zr(i,s,pY(n,t),o);return a.errorHandler=J_(e),a}function _Y(n,e,t,r){let i=e.fullServerUrl(),s=io(i,n.host,n._protocol),o="PATCH",a=oD(t,r),c={"Content-Type":"application/json; charset=utf-8"},l=n.maxOperationRetryTime,d=new zr(s,o,Y_(n,r),l);return d.headers=c,d.body=a,d.errorHandler=J_(e),d}function yY(n,e){let t=e.fullServerUrl(),r=io(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,l){}let a=new zr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=J_(e),a}function vY(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function I2(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=vY(null,e)),r}function wY(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let j="";for(let Z=0;Z<2;Z++)j=j+Math.random().toString().slice(2);return j}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let l=I2(e,r,i),d=oD(l,t),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,p=`\r
--`+c+"--",_=Ul.getBlob(h,r,p);if(_===null)throw h2();let E={name:l.fullPath},A=io(s,n.host,n._protocol),R="POST",L=n.maxUploadRetryTime,Y=new zr(A,R,Y_(n,t),L);return Y.urlParams=E,Y.headers=o,Y.body=_.uploadData(),Y.errorHandler=$l(e),Y}var Bl=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function aD(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{Di(!1)}return Di(!!t&&(e||["active"]).indexOf(t)!==-1),t}function IY(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=I2(e,r,i),a={name:o.fullPath},c=io(s,n.host,n._protocol),l="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=oD(o,t),p=n.maxUploadRetryTime;function _(A){aD(A);let R;try{R=A.getResponseHeader("X-Goog-Upload-URL")}catch{Di(!1)}return Di(K_(R)),R}let E=new zr(c,l,_,p);return E.urlParams=a,E.headers=d,E.body=h,E.errorHandler=$l(e),E}function EY(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(l){let d=aD(l,["active","final"]),h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Di(!1)}h||Di(!1);let p=Number(h);return Di(!isNaN(p)),new Bl(p,r.size(),d==="final")}let o="POST",a=n.maxUploadRetryTime,c=new zr(t,o,s,a);return c.headers=i,c.errorHandler=$l(e),c}var r2=256*1024;function bY(n,e,t,r,i,s,o,a){let c=new Bl(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw LQ();let l=c.total-c.current,d=l;i>0&&(d=Math.min(d,i));let h=c.current,p=h+d,_="";d===0?_="finalize":l===d?_="upload, finalize":_="upload";let E={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${c.current}`},A=r.slice(h,p);if(A===null)throw h2();function R(Z,ue){let ne=aD(Z,["active","final"]),S=c.current+d,v=r.size(),b;return ne==="final"?b=Y_(e,s)(Z,ue):b=null,new Bl(S,v,ne==="final",b)}let L="POST",Y=e.maxUploadRetryTime,j=new zr(t,L,R,Y);return j.headers=E,j.body=A.uploadData(),j.progressCallback=a||null,j.errorHandler=$l(n),j}var E2={STATE_CHANGED:"state_changed"},pn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function KS(n){switch(n){case"running":case"pausing":case"canceling":return pn.RUNNING;case"paused":return pn.PAUSED;case"success":return pn.SUCCESS;case"canceled":return pn.CANCELED;case"error":return pn.ERROR;default:return pn.ERROR}}var XS=class{constructor(e,t,r){if(HQ(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Fl(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var i2=null,ZS=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Vl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Vl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Vl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw Uh("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Uh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Uh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Uh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Uh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},eD=class extends ZS{initXhr(){this.xhr_.responseType="text"}};function Si(){return i2?i2():new eD}var $h=class{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=Q_(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(dt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(m2(i.status,[]))if(s)i=u2();else{this.sleepTime=Math.max(this.sleepTime*2,AQ),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(dt.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=IY(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Si,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=EY(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Si,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=r2*this._chunkMultiplier,t=new Bl(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=bY(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,Si,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){r2*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=w2(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Si,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=wY(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Si,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=d2(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=KS(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new XS(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(KS(this._state)){case pn.SUCCESS:Fl(this._resolve.bind(null,this.snapshot))();break;case pn.CANCELED:case pn.ERROR:let t=this._reject;Fl(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(KS(this._state)){case pn.RUNNING:case pn.PAUSED:e.next&&Fl(e.next.bind(e,this.snapshot))();break;case pn.SUCCESS:e.complete&&Fl(e.complete.bind(e))();break;case pn.CANCELED:case pn.ERROR:e.error&&Fl(e.error.bind(e,this._error))();break;default:e.error&&Fl(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var jl=class n{constructor(e,t){this._service=e,t instanceof Dn?this._location=t:this._location=Dn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Dn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return y2(this._location.path)}get storage(){return this._service}get parent(){let e=iY(this._location.path);if(e===null)return null;let t=new Dn(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw nD(e)}};function CY(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new $h(n,new Ul(e),t)}function TY(n){let e={prefixes:[],items:[]};return b2(n,e).then(()=>e)}function b2(n,e,t){return g(this,null,function*(){let i=yield C2(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield b2(n,e,i.nextPageToken))})}function C2(n,e){e!=null&&typeof e.maxResults=="number"&&YS("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=mY(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Si)}function SY(n){n._throwIfRoot("getMetadata");let e=w2(n.storage,n._location,Q_());return n.storage.makeRequestWithTokens(e,Si)}function DY(n,e){n._throwIfRoot("updateMetadata");let t=_Y(n.storage,n._location,e,Q_());return n.storage.makeRequestWithTokens(t,Si)}function AY(n){n._throwIfRoot("getDownloadURL");let e=gY(n.storage,n._location,Q_());return n.storage.makeRequestWithTokens(e,Si).then(t=>{if(t===null)throw VQ();return t})}function xY(n){n._throwIfRoot("deleteObject");let e=yY(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Si)}function T2(n,e){let t=sY(n._location.path,e),r=new Dn(n._location.bucket,t);return new jl(n.storage,r)}function RY(n){return/^[A-Za-z]+:\/\//.test(n)}function NY(n,e){return new jl(n,e)}function S2(n,e){if(n instanceof Hh){let t=n;if(t._bucket==null)throw FQ();let r=new jl(t,t._bucket);return e!=null?S2(r,e):r}else return e!==void 0?T2(n,e):n}function PY(n,e){if(e&&RY(e)){if(n instanceof Hh)return NY(n,e);throw Ra("To use ref(service, url), the first argument must be a Storage instance.")}else return S2(n,e)}function s2(n,e){let t=e?.[l2];return t==null?null:Dn.makeFromBucketSpec(t,n)}function kY(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:Oc(i,n.app.options.projectId))}var Hh=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=c2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=SQ,this._maxUploadRetryTime=DQ,this._requests=new Set,i!=null?this._bucket=Dn.makeFromBucketSpec(i,this._host):this._bucket=s2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Dn.makeFromBucketSpec(this._url,e):this._bucket=s2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){YS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){YS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return g(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return g(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new jl(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new QS(f2());{let o=QQ(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return g(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},o2="@firebase/storage",a2="0.12.5";var MY="storage";function X_(n,e,t){return n=G(n),CY(n,e,t)}function D2(n){return n=G(n),SY(n)}function A2(n,e){return n=G(n),DY(n,e)}function x2(n,e){return n=G(n),C2(n,e)}function R2(n){return n=G(n),TY(n)}function Z_(n){return n=G(n),AY(n)}function ey(n){return n=G(n),xY(n)}function Na(n,e){return n=G(n),PY(n,e)}function N2(n,e){return T2(n,e)}function P2(n,e,t,r={}){kY(n,e,t,r)}function OY(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Hh(t,r,i,e,bn)}function FY(){En(new Ke(MY,OY,"PUBLIC").setMultipleInstances(!0)),Tt(o2,a2,""),Tt(o2,a2,"esm2017")}FY();var Hl=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var ty=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Hl(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new Hl(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new Hl(o,this,this._ref)):s={next:t.next?o=>t.next(new Hl(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},ny=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Pa(e,this._service))}get items(){return this._delegate.items.map(e=>new Pa(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var Pa=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=N2(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new ty(X_(this._delegate,e,t),this)}putString(e,t=tr.RAW,r){this._throwIfRoot("putString");let i=iD(t,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new ty(new $h(this._delegate,new Ul(i.data,!0),s),this)}listAll(){return R2(this._delegate).then(e=>new ny(e,this.storage))}list(e){return x2(this._delegate,e||void 0).then(t=>new ny(t,this.storage))}getMetadata(){return D2(this._delegate)}updateMetadata(e){return A2(this._delegate,e)}getDownloadURL(){return Z_(this._delegate)}delete(){return this._throwIfRoot("delete"),ey(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw nD(e)}};var ry=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(k2(e))throw Ra("ref() expected a child path but got a URL, use refFromURL instead.");return new Pa(Na(this._delegate,e),this)}refFromURL(e){if(!k2(e))throw Ra("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Dn.makeFromUrl(e,this._delegate.host)}catch{throw Ra("refFromUrl() expected a valid full URL but got an invalid one.")}return new Pa(Na(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){P2(this._delegate,e,t,r)}};function k2(n){return/^[A-Za-z]+:\/\//.test(n)}var LY="@firebase/storage-compat",VY="0.3.8";var UY="storage-compat";function BY(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new ry(t,r)}function jY(n){let e={TaskState:pn,TaskEvent:E2,StringFormat:tr,Storage:ry,Reference:Pa};n.INTERNAL.registerComponent(new Ke(UY,BY,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(LY,VY)}jY(U);var M2="@firebase/database",O2="1.0.5";var vA="";function wA(n){vA=n}var mD=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Nt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:kc(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var gD=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return In(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var hU=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new mD(e)}}catch{}return new gD},Ma=hU("localStorage"),_D=hU("sessionStorage");var Wl=new $n("@firebase/database"),fU=function(){let n=1;return function(){return n++}}(),pU=function(n){let e=YM(n),t=new Vm;t.update(e);let r=t.digest();return Um.encodeByteArray(r)},pf=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=pf.apply(null,r):typeof r=="object"?e+=Nt(r):e+=r,e+=" "}return e},Oa=null,F2=!0,mU=function(n,e){$(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Wl.logLevel=we.VERBOSE,Oa=Wl.log.bind(Wl),e&&_D.set("logging_enabled",!0)):typeof n=="function"?Oa=n:(Oa=null,_D.remove("logging_enabled"))},Qt=function(...n){if(F2===!0&&(F2=!1,Oa===null&&_D.get("logging_enabled")===!0&&mU(!0)),Oa){let e=pf.apply(null,n);Oa(e)}},mf=function(n){return function(...e){Qt(n,...e)}},yD=function(...n){let e="FIREBASE INTERNAL ERROR: "+pf(...n);Wl.error(e)},Ri=function(...n){let e=`FIREBASE FATAL ERROR: ${pf(...n)}`;throw Wl.error(e),new Error(e)},mn=function(...n){let e="FIREBASE WARNING: "+pf(...n);Wl.warn(e)},$Y=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&mn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ny=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},HY=function(n){if(ai()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},co="[MIN_NAME]",is="[MAX_NAME]",La=function(n,e){if(n===e)return 0;if(n===co||e===is)return-1;if(e===co||n===is)return 1;{let t=L2(n),r=L2(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},qY=function(n,e){return n===e?0:n<e?-1:1},qh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Nt(e))},IA=function(n){if(typeof n!="object"||n===null)return Nt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Nt(e[r]),t+=":",t+=IA(n[e[r]]);return t+="}",t},gU=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Yt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var _U=function(n){$(!Ny(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),h="";for(c=0;c<64;c+=8){let p=parseInt(d.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),h=h+p}return h.toLowerCase()},zY=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},GY=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function WY(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var KY=new RegExp("^-?(0*)\\d{1,10}$"),QY=-2147483648,YY=2147483647,L2=function(n){if(KY.test(n)){let e=Number(n);if(e>=QY&&e<=YY)return e}return null},nu=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw mn("Exception was thrown by user callback.",t),e},Math.floor(0))}},JY=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Kh=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var vD=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){mn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var wD=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Qt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',mn(e)}},Qh=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),sy="5",yU="v",vU="s",wU="r",IU="f",EU=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,bU="ls",CU="p",ID="ac",TU="websocket",SU="long_polling";var oy=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ma.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ma.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function XY(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function DU(n,e,t){$(typeof e=="string","typeof type must == string"),$(typeof t=="object","typeof params must == object");let r;if(e===TU)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===SU)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);XY(n)&&(t.ns=n.namespace);let i=[];return Yt(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var ED=class{constructor(){this.counters_={}}incrementCounter(e,t=1){In(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return qM(this.counters_)}};var cD={},lD={};function EA(n){let e=n.toString();return cD[e]||(cD[e]=new ED),cD[e]}function ZY(n,e){let t=n.toString();return lD[t]||(lD[t]=e()),lD[t]}var bD=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&nu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var V2="start",eJ="close",tJ="pLPCommand",nJ="pRTLPCB",AU="id",xU="pw",RU="ser",rJ="cb",iJ="seg",sJ="ts",oJ="d",aJ="dframe",NU=1870,PU=30,cJ=NU-PU,lJ=25e3,uJ=3e4,Zh=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=mf(e),this.stats_=EA(t),this.urlFn=c=>(this.appCheckToken&&(c[ID]=this.appCheckToken),DU(t,SU,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new bD(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(uJ)),HY(()=>{if(this.isClosed_)return;this.scriptTagHolder=new CD((...s)=>{let[o,a,c,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===V2)this.id=a,this.password=c;else if(o===eJ)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[V2]="t",r[RU]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[rJ]=this.scriptTagHolder.uniqueCallbackIdentifier),r[yU]=sy,this.transportSessionId&&(r[vU]=this.transportSessionId),this.lastSessionId&&(r[bU]=this.lastSessionId),this.applicationId&&(r[CU]=this.applicationId),this.appCheckToken&&(r[ID]=this.appCheckToken),typeof location<"u"&&location.hostname&&EU.test(location.hostname)&&(r[wU]=IU);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return ai()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!zY()&&!GY()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=Nt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=$E(t),i=gU(r,cJ);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(ai())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[aJ]="t",r[AU]=e,r[xU]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=Nt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},CD=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ai())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=fU(),window[tJ+this.uniqueCallbackIdentifier]=e,window[nJ+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Qt("frame writing exception"),a.stack&&Qt(a.stack),Qt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Qt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[AU]=this.myID,e[xU]=this.myPW,e[RU]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+PU+r.length<=NU;){let o=this.pendingSegs.shift();r=r+"&"+iJ+i+"="+o.seg+"&"+sJ+i+"="+o.ts+"&"+oJ+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(lJ)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){ai()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Qt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var dJ=16384,hJ=45e3,ay=null;typeof MozWebSocket<"u"?ay=MozWebSocket:typeof WebSocket<"u"&&(ay=WebSocket);var zl=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=mf(this.connId),this.stats_=EA(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[yU]=sy,!ai()&&typeof location<"u"&&location.hostname&&EU.test(location.hostname)&&(a[wU]=IU),r&&(a[vU]=r),i&&(a[bU]=i),s&&(a[ID]=s),o&&(a[CU]=o),DU(t,TU,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ma.set("previous_websocket_failure",!0);try{let i;if(ai()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${sy}/${vA}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new ay(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&ay!==null&&!n.forceDisallow_}static previouslyFailed(){return Ma.isInMemoryStorage||Ma.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ma.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=kc(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if($(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=Nt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=gU(r,dJ);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(hJ))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),kU=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Zh,zl]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=zl&&zl.isAvailable(),i=r&&!zl.previouslyFailed();if(t.webSocketOnly&&(r||mn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[zl];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),fJ=6e4,pJ=5e3,mJ=10*1024,gJ=100*1024,uD="t",U2="d",_J="s",B2="r",yJ="e",j2="o",$2="a",H2="n",q2="p",vJ="h",TD=class{constructor(e,t,r,i,s,o,a,c,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=mf("c:"+this.id+":"),this.transportManager_=new kU(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Kh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>gJ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>mJ?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(uD in e){let t=e[uD];t===$2?this.upgradeIfSecondaryHealthy_():t===B2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===j2&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=qh("t",e),r=qh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:q2,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:$2,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:H2,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=qh("t",e),r=qh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=qh(uD,e);if(U2 in e){let r=e[U2];if(t===vJ){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===H2){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===_J?this.onConnectionShutdown_(r):t===B2?this.onReset_(r):t===yJ?yD("Server Error: "+r):t===j2?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):yD("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),sy!==r&&mn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Kh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(fJ))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Kh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(pJ))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:q2,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ma.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var cy=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var ly=class{constructor(e){this.allowedEvents_=e,this.listeners_={},$(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){$(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var uy=class n extends ly{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ed()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return $(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var z2=32,G2=768,Be=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Ue(){return new Be("")}function Ie(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function lo(n){return n.pieces_.length-n.pieceNum_}function Ze(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Be(n.pieces_,e)}function bA(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function wJ(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function ef(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function MU(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Be(e,0)}function ht(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Be)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Be(t,0)}function Ee(n){return n.pieceNum_>=n.pieces_.length}function An(n,e){let t=Ie(n),r=Ie(e);if(t===null)return e;if(t===r)return An(Ze(n),Ze(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function IJ(n,e){let t=ef(n,0),r=ef(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=La(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function CA(n,e){if(lo(n)!==lo(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function br(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(lo(n)>lo(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var SD=class{constructor(e,t){this.errorPrefix_=t,this.parts_=ef(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Cd(this.parts_[r]);OU(this)}};function EJ(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Cd(e),OU(n)}function bJ(n){let e=n.parts_.pop();n.byteLength_-=Cd(e),n.parts_.length>0&&(n.byteLength_-=1)}function OU(n){if(n.byteLength_>G2)throw new Error(n.errorPrefix_+"has a key path longer than "+G2+" bytes ("+n.byteLength_+").");if(n.parts_.length>z2)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+z2+") or object contains a cycle "+ka(n))}function ka(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var DD=class n extends ly{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return $(e==="visible","Unknown event type: "+e),[this.visible_]}};var zh=1e3,CJ=60*5*1e3,W2=30*1e3,TJ=1.3,SJ=3e4,DJ="server_kill",K2=3,TA=(()=>{class n extends cy{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=mf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=zh,this.maxReconnectDelay_=CJ,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!ai())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");DD.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&uy.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(Nt(o)),$(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new jt,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),$(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,d=c.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&In(t,"w")){let i=Ds(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();mn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||QM(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=W2)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=KM(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),$(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Nt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):yD("Unrecognized action received from server: "+Nt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){$(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=zh,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=zh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>SJ&&(this.reconnectDelay_=zh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*TJ)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},d=function(p){$(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(p)};this.realtime_={close:l,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[p,_]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?Qt("getToken() completed but was canceled"):(Qt("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=_&&_.token,c=new TD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,E=>{mn(E+" ("+this.repoInfo_.toString()+")"),this.interrupt(DJ)},o))}catch(p){this.log_("Failed to get token: "+p),a||(this.repoInfo_.nodeAdmin&&mn(p),l())}}})}interrupt(t){Qt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Qt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Fc(this.interruptReasons_)&&(this.reconnectDelay_=zh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>IA(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new Be(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Qt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=K2&&(this.reconnectDelay_=W2,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Qt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=K2&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";ai()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+vA.replace(/\./g,"-")]=1,Ed()?t["framework.cordova"]=1:jo()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=uy.getInstance().currentlyOnline();return Fc(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),Ce=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Kl=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new Ce(co,e),i=new Ce(co,t);return this.compare(r,i)!==0}minPost(){return Ce.MIN}};var iy,dy=class extends Kl{static get __EMPTY_NODE(){return iy}static set __EMPTY_NODE(e){iy=e}compare(e,t){return La(e.name,t.name)}isDefinedOn(e){throw Bo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ce.MIN}maxPost(){return new Ce(is,iy)}makePost(e,t){return $(typeof e=="string","KeyIndex indexValue must always be a string."),new Ce(e,iy)}toString(){return".key"}},xi=new dy;var Gl=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Gr=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Cr.EMPTY_NODE,this.right=o??Cr.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Cr.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Cr.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),AD=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new Gr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Cr=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Gr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Gr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Gl(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Gl(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Gl(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Gl(this.root_,null,this.comparator_,!0,e)}};Cr.EMPTY_NODE=new AD;function AJ(n,e){return La(n.name,e.name)}function SA(n,e){return La(n,e)}var xD;function xJ(n){xD=n}var FU=function(n){return typeof n=="number"?"number:"+_U(n):"string:"+n},LU=function(n){if(n.isLeafNode()){let e=n.val();$(typeof e=="string"||typeof e=="number"||typeof e=="object"&&In(e,".sv"),"Priority must be a string or number.")}else $(n===xD||n.isEmpty(),"priority of unexpected type.");$(n===xD||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Q2,Ql=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,$(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),LU(this.priorityNode_)}static set __childrenNodeConstructor(t){Q2=t}static get __childrenNodeConstructor(){return Q2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Ee(t)?this:Ie(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=Ie(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:($(i!==".priority"||lo(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ze(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+FU(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=_U(this.value_):t+=this.value_,this.lazyHash_=pU(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:($(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return $(s>=0,"Unknown leaf type: "+r),$(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),VU,UU;function RJ(n){VU=n}function NJ(n){UU=n}var RD=class extends Kl{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?La(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ce.MIN}maxPost(){return new Ce(is,new Ql("[PRIORITY-POST]",UU))}makePost(e,t){let r=VU(e);return new Ce(t,new Ql("[PRIORITY-POST]",r))}toString(){return".priority"}},rt=new RD;var PJ=Math.log(2),ND=class{constructor(e){let t=s=>parseInt(Math.log(s)/PJ,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},hy=function(n,e,t,r){n.sort(e);let i=function(c,l){let d=l-c,h,p;if(d===0)return null;if(d===1)return h=n[c],p=t?t(h):h,new Gr(p,h.node,Gr.BLACK,null,null);{let _=parseInt(d/2,10)+c,E=i(c,_),A=i(_+1,l);return h=n[_],p=t?t(h):h,new Gr(p,h.node,Gr.BLACK,E,A)}},s=function(c){let l=null,d=null,h=n.length,p=function(E,A){let R=h-E,L=h;h-=E;let Y=i(R+1,L),j=n[R],Z=t?t(j):j;_(new Gr(Z,j.node,A,null,Y))},_=function(E){l?(l.left=E,l=E):(d=E,l=E)};for(let E=0;E<c.count;++E){let A=c.nextBitIsOne(),R=Math.pow(2,c.count-(E+1));A?p(R,Gr.BLACK):(p(R,Gr.BLACK),p(R,Gr.RED))}return d},o=new ND(n.length),a=s(o);return new Cr(r||e,a)};var dD,ql={},Yl=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return $(ql&&rt,"ChildrenNode.ts has not been loaded"),dD=dD||new n({".priority":ql},{".priority":rt}),dD}get(e){let t=Ds(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Cr?t:null}hasIndex(e){return In(this.indexSet_,e.toString())}addIndex(e,t){$(e!==xi,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(Ce.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=hy(r,e.getCompare()):a=ql;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,l)}addToIndexes(e,t){let r=bd(this.indexes_,(i,s)=>{let o=Ds(this.indexSet_,s);if($(o,"Missing index implementation for "+s),i===ql)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(Ce.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),hy(a,o.getCompare())}else return ql;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new Ce(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=bd(this.indexes_,i=>{if(i===ql)return i;{let s=t.get(e.name);return s?i.remove(new Ce(e.name,s)):i}});return new n(r,this.indexSet_)}};var Gh,_e=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&LU(this.priorityNode_),this.children_.isEmpty()&&$(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Gh||(Gh=new n(new Cr(SA),null,Yl.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Gh}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Gh:r}}getChild(t){let r=Ie(t);return r===null?this:this.getImmediateChild(r).getChild(Ze(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if($(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new Ce(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Gh:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=Ie(t);if(i===null)return r;{$(Ie(t)!==".priority"||lo(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ze(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(rt,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+FU(this.getPriority().val())+":"),this.forEachChild(rt,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":pU(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new Ce(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new Ce(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new Ce(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,Ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,Ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===gf?-1:0}withIndex(t){if(t===xi||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===xi||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(rt),s=r.getIterator(rt),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===xi?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),PD=class extends _e{constructor(){super(new Cr(SA),_e.EMPTY_NODE,Yl.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return _e.EMPTY_NODE}isEmpty(){return!1}},gf=new PD;Object.defineProperties(Ce,{MIN:{value:new Ce(co,_e.EMPTY_NODE)},MAX:{value:new Ce(is,gf)}});dy.__EMPTY_NODE=_e.EMPTY_NODE;Ql.__childrenNodeConstructor=_e;xJ(gf);NJ(gf);var kJ=!0;function gt(n,e=null){if(n===null)return _e.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),$(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Ql(t,gt(e))}if(!(n instanceof Array)&&kJ){let t=[],r=!1;if(Yt(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=gt(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Ce(o,c)))}}),t.length===0)return _e.EMPTY_NODE;let s=hy(t,AJ,o=>o.name,SA);if(r){let o=hy(t,rt.getCompare());return new _e(s,gt(e),new Yl({".priority":o},{".priority":rt}))}else return new _e(s,gt(e),Yl.Default)}else{let t=_e.EMPTY_NODE;return Yt(n,(r,i)=>{if(In(n,r)&&r.substring(0,1)!=="."){let s=gt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(gt(e))}}RJ(gt);var tf=class extends Kl{constructor(e){super(),this.indexPath_=e,$(!Ee(e)&&Ie(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?La(e.name,t.name):s}makePost(e,t){let r=gt(e),i=_e.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ce(t,i)}maxPost(){let e=_e.EMPTY_NODE.updateChild(this.indexPath_,gf);return new Ce(is,e)}toString(){return ef(this.indexPath_,0).join("/")}};var kD=class extends Kl{compare(e,t){let r=e.node.compareTo(t.node);return r===0?La(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ce.MIN}maxPost(){return Ce.MAX}makePost(e,t){let r=gt(e);return new Ce(t,r)}toString(){return".value"}},DA=new kD;function BU(n){return{type:"value",snapshotNode:n}}function Jl(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function nf(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function rf(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function MJ(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var sf=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){$(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(nf(t,a)):$(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Jl(t,r)):o.trackChildChange(rf(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(rt,(i,s)=>{t.hasChild(i)||r.trackChildChange(nf(i,s))}),t.isLeafNode()||t.forEachChild(rt,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(rf(i,s,o))}else r.trackChildChange(Jl(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?_e.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var fy=class n{constructor(e){this.indexedFilter_=new sf(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new Ce(t,r))||(r=_e.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=_e.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(_e.EMPTY_NODE);let s=this;return t.forEachChild(rt,(o,a)=>{s.matches(new Ce(o,a))||(i=i.updateImmediateChild(o,_e.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var MD=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new fy(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new Ce(t,r))||(r=_e.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=_e.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=_e.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(_e.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,_e.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(p,_)=>h(_,p)}else o=this.index_.getCompare();let a=e;$(a.numChildren()===this.limit_,"");let c=new Ce(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(t)){let h=a.getImmediateChild(t),p=i.getChildAfterChild(this.index_,l,this.reverse_);for(;p!=null&&(p.name===t||a.hasChild(p.name));)p=i.getChildAfterChild(this.index_,p,this.reverse_);let _=p==null?1:o(p,c);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(rf(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(nf(t,h));let A=a.updateImmediateChild(t,_e.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(s?.trackChildChange(Jl(p.name,p.node)),A.updateImmediateChild(p.name,p.node)):A}}else return r.isEmpty()?e:d&&o(l,c)>=0?(s!=null&&(s.trackChildChange(nf(l.name,l.node)),s.trackChildChange(Jl(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,_e.EMPTY_NODE)):e}};var of=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=rt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return $(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return $(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:co}hasEnd(){return this.endSet_}getIndexEndValue(){return $(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return $(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:is}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return $(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===rt}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function OJ(n){return n.loadsAllData()?new sf(n.getIndex()):n.hasLimit()?new MD(n):new fy(n)}function FJ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function LJ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function OD(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function VJ(n,e,t){let r;return n.index_===xi||t?r=OD(n,e,t):r=OD(n,e,is),r.startAfterSet_=!0,r}function FD(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function UJ(n,e,t){let r;return n.index_===xi||t?r=FD(n,e,t):r=FD(n,e,co),r.endBeforeSet_=!0,r}function Py(n,e){let t=n.copy();return t.index_=e,t}function Y2(n){let e={};if(n.isDefault())return e;let t;if(n.index_===rt?t="$priority":n.index_===DA?t="$value":n.index_===xi?t="$key":($(n.index_ instanceof tf,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Nt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=Nt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Nt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Nt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Nt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function J2(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==rt&&(e.i=n.index_.toString()),e}var LD=class n extends cy{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=mf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:($(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=Y2(e._queryParams);this.restRequest_(s+".json",c,(l,d)=>{let h=d;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),Ds(this.listens_,o)===a){let p;l?l===401?p="permission_denied":p="rest_error:"+l:p="ok",i(p,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=Y2(e._queryParams),r=e._path.toString(),i=new jt;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+zi(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=kc(a.responseText)}catch{mn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&mn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var VD=class{constructor(){this.rootNode_=_e.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function py(){return{value:null,children:new Map}}function ru(n,e,t){if(Ee(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=Ie(e);n.children.has(r)||n.children.set(r,py());let i=n.children.get(r);e=Ze(e),ru(i,e,t)}}function UD(n,e){if(Ee(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(rt,(r,i)=>{ru(n,new Be(r),i)}),UD(n,e)}}else if(n.children.size>0){let t=Ie(e);return e=Ze(e),n.children.has(t)&&UD(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function BD(n,e,t){n.value!==null?t(e,n.value):BJ(n,(r,i)=>{let s=new Be(e.toString()+"/"+r);BD(i,s,t)})}function BJ(n,e){n.children.forEach((t,r)=>{e(r,t)})}var jD=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Yt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var X2=10*1e3,jJ=30*1e3,$J=5*60*1e3,$D=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new jD(e);let r=X2+(jJ-X2)*Math.random();Kh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Yt(e,(i,s)=>{s>0&&In(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Kh(this.reportStats_.bind(this),Math.floor(Math.random()*2*$J))}};var Ai=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Ai||{});function AA(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function xA(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function RA(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var HD=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ai.ACK_USER_WRITE,this.source=AA()}operationForChild(e){if(Ee(this.path)){if(this.affectedTree.value!=null)return $(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new Be(e));return new n(Ue(),t,this.revert)}}else return $(Ie(this.path)===e,"operationForChild called for unrelated child."),new n(Ze(this.path),this.affectedTree,this.revert)}};var my=class n{constructor(e,t){this.source=e,this.path=t,this.type=Ai.LISTEN_COMPLETE}operationForChild(e){return Ee(this.path)?new n(this.source,Ue()):new n(this.source,Ze(this.path))}};var Xl=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ai.OVERWRITE}operationForChild(e){return Ee(this.path)?new n(this.source,Ue(),this.snap.getImmediateChild(e)):new n(this.source,Ze(this.path),this.snap)}};var af=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ai.MERGE}operationForChild(e){if(Ee(this.path)){let t=this.children.subtree(new Be(e));return t.isEmpty()?null:t.value?new Xl(this.source,Ue(),t.value):new n(this.source,Ue(),t)}else return $(Ie(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Ze(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Ni=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ee(e))return this.isFullyInitialized()&&!this.filtered_;let t=Ie(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var qD=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function HJ(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(MJ(o.childName,o.snapshotNode))}),Wh(n,i,"child_removed",e,r,t),Wh(n,i,"child_added",e,r,t),Wh(n,i,"child_moved",s,r,t),Wh(n,i,"child_changed",e,r,t),Wh(n,i,"value",e,r,t),i}function Wh(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>zJ(n,a,c)),o.forEach(a=>{let c=qJ(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function qJ(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function zJ(n,e,t){if(e.childName==null||t.childName==null)throw Bo("Should only compare child_ events.");let r=new Ce(e.childName,e.snapshotNode),i=new Ce(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function ky(n,e){return{eventCache:n,serverCache:e}}function Yh(n,e,t,r){return ky(new Ni(e,t,r),n.serverCache)}function jU(n,e,t,r){return ky(n.eventCache,new Ni(e,t,r))}function gy(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Fa(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var hD,GJ=()=>(hD||(hD=new Cr(qY)),hD),xn=class n{constructor(e,t=GJ()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Yt(e,(r,i)=>{t=t.set(new Be(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Ue(),value:this.value};if(Ee(e))return null;{let r=Ie(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ze(e),t);return s!=null?{path:ht(new Be(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ee(e))return this;{let t=Ie(e),r=this.children.get(t);return r!==null?r.subtree(Ze(e)):new n(null)}}set(e,t){if(Ee(e))return new n(t,this.children);{let r=Ie(e),s=(this.children.get(r)||new n(null)).set(Ze(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(Ee(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=Ie(e),r=this.children.get(t);if(r){let i=r.remove(Ze(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(Ee(e))return this.value;{let t=Ie(e),r=this.children.get(t);return r?r.get(Ze(e)):null}}setTree(e,t){if(Ee(e))return t;{let r=Ie(e),s=(this.children.get(r)||new n(null)).setTree(Ze(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Ue(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(ht(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Ue(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(Ee(e))return null;{let s=Ie(e),o=this.children.get(s);return o?o.findOnPath_(Ze(e),ht(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ue(),t)}foreachOnPath_(e,t,r){if(Ee(e))return this;{this.value&&r(t,this.value);let i=Ie(e),s=this.children.get(i);return s?s.foreachOnPath_(Ze(e),ht(t,i),r):new n(null)}}foreach(e){this.foreach_(Ue(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(ht(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Wr=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new xn(null))}};function Jh(n,e,t){if(Ee(e))return new Wr(new xn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=An(i,e);return s=s.updateChild(o,t),new Wr(n.writeTree_.set(i,s))}else{let i=new xn(t),s=n.writeTree_.setTree(e,i);return new Wr(s)}}}function zD(n,e,t){let r=n;return Yt(t,(i,s)=>{r=Jh(r,ht(e,i),s)}),r}function Z2(n,e){if(Ee(e))return Wr.empty();{let t=n.writeTree_.setTree(e,new xn(null));return new Wr(t)}}function GD(n,e){return Va(n,e)!=null}function Va(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(An(t.path,e)):null}function eU(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(rt,(r,i)=>{e.push(new Ce(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Ce(r,i.value))}),e}function oo(n,e){if(Ee(e))return n;{let t=Va(n,e);return t!=null?new Wr(new xn(t)):new Wr(n.writeTree_.subtree(e))}}function WD(n){return n.writeTree_.isEmpty()}function Zl(n,e){return $U(Ue(),n.writeTree_,e)}function $U(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?($(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=$U(ht(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(ht(n,".priority"),r)),t}}function My(n,e){return GU(e,n)}function WJ(n,e,t,r,i){$(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Jh(n.visibleWrites,e,t)),n.lastWriteId=r}function KJ(n,e,t,r){$(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=zD(n.visibleWrites,e,t),n.lastWriteId=r}function QJ(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function YJ(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);$(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&JJ(a,r.path)?i=!1:br(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return XJ(n),!0;if(r.snap)n.visibleWrites=Z2(n.visibleWrites,r.path);else{let a=r.children;Yt(a,c=>{n.visibleWrites=Z2(n.visibleWrites,ht(r.path,c))})}return!0}else return!1}function JJ(n,e){if(n.snap)return br(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&br(ht(n.path,t),e))return!0;return!1}function XJ(n){n.visibleWrites=HU(n.allWrites,ZJ,Ue()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function ZJ(n){return n.visible}function HU(n,e,t){let r=Wr.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)br(t,o)?(a=An(t,o),r=Jh(r,a,s.snap)):br(o,t)&&(a=An(o,t),r=Jh(r,Ue(),s.snap.getChild(a)));else if(s.children){if(br(t,o))a=An(t,o),r=zD(r,a,s.children);else if(br(o,t))if(a=An(o,t),Ee(a))r=zD(r,Ue(),s.children);else{let c=Ds(s.children,Ie(a));if(c){let l=c.getChild(Ze(a));r=Jh(r,Ue(),l)}}}else throw Bo("WriteRecord should have .snap or .children")}}return r}function qU(n,e,t,r,i){if(!r&&!i){let s=Va(n.visibleWrites,e);if(s!=null)return s;{let o=oo(n.visibleWrites,e);if(WD(o))return t;if(t==null&&!GD(o,Ue()))return null;{let a=t||_e.EMPTY_NODE;return Zl(o,a)}}}else{let s=oo(n.visibleWrites,e);if(!i&&WD(s))return t;if(!i&&t==null&&!GD(s,Ue()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(br(l.path,e)||br(e,l.path))},a=HU(n.allWrites,o,e),c=t||_e.EMPTY_NODE;return Zl(a,c)}}}function eX(n,e,t){let r=_e.EMPTY_NODE,i=Va(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(rt,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=oo(n.visibleWrites,e);return t.forEachChild(rt,(o,a)=>{let c=Zl(oo(s,new Be(o)),a);r=r.updateImmediateChild(o,c)}),eU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=oo(n.visibleWrites,e);return eU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function tX(n,e,t,r,i){$(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=ht(e,t);if(GD(n.visibleWrites,s))return null;{let o=oo(n.visibleWrites,s);return WD(o)?i.getChild(t):Zl(o,i.getChild(t))}}function nX(n,e,t,r){let i=ht(e,t),s=Va(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=oo(n.visibleWrites,i);return Zl(o,r.getNode().getImmediateChild(t))}else return null}function rX(n,e){return Va(n.visibleWrites,e)}function iX(n,e,t,r,i,s,o){let a,c=oo(n.visibleWrites,e),l=Va(c,Ue());if(l!=null)a=l;else if(t!=null)a=Zl(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),p=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=p.getNext();for(;_&&d.length<i;)h(_,r)!==0&&d.push(_),_=p.getNext();return d}else return[]}function sX(){return{visibleWrites:Wr.empty(),allWrites:[],lastWriteId:-1}}function _y(n,e,t,r){return qU(n.writeTree,n.treePath,e,t,r)}function NA(n,e){return eX(n.writeTree,n.treePath,e)}function tU(n,e,t,r){return tX(n.writeTree,n.treePath,e,t,r)}function yy(n,e){return rX(n.writeTree,ht(n.treePath,e))}function oX(n,e,t,r,i,s){return iX(n.writeTree,n.treePath,e,t,r,i,s)}function PA(n,e,t){return nX(n.writeTree,n.treePath,e,t)}function zU(n,e){return GU(ht(n.treePath,e),n.writeTree)}function GU(n,e){return{treePath:n,writeTree:e}}var KD=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;$(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),$(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,rf(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,nf(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,Jl(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,rf(r,e.snapshotNode,i.oldSnap));else throw Bo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var QD=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},WU=new QD,cf=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Ni(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return PA(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Fa(this.viewCache_),s=oX(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function aX(n){return{filter:n}}function cX(n,e){$(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),$(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function lX(n,e,t,r,i){let s=new KD,o,a;if(t.type===Ai.OVERWRITE){let l=t;l.source.fromUser?o=YD(n,e,l.path,l.snap,r,i,s):($(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!Ee(l.path),o=vy(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===Ai.MERGE){let l=t;l.source.fromUser?o=dX(n,e,l.path,l.children,r,i,s):($(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=JD(n,e,l.path,l.children,r,i,a,s))}else if(t.type===Ai.ACK_USER_WRITE){let l=t;l.revert?o=pX(n,e,l.path,r,i,s):o=hX(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===Ai.LISTEN_COMPLETE)o=fX(n,e,t.path,r,s);else throw Bo("Unknown operation type: "+t.type);let c=s.getChanges();return uX(e,o,c),{viewCache:o,changes:c}}function uX(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=gy(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(BU(gy(e)))}}function KU(n,e,t,r,i,s){let o=e.eventCache;if(yy(r,t)!=null)return e;{let a,c;if(Ee(t))if($(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Fa(e),d=l instanceof _e?l:_e.EMPTY_NODE,h=NA(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=_y(r,Fa(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=Ie(t);if(l===".priority"){$(lo(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let h=tU(r,t,d,c);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=Ze(t),h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let p=tU(r,t,o.getNode(),c);p!=null?h=o.getNode().getImmediateChild(l).updateChild(d,p):h=o.getNode().getImmediateChild(l)}else h=PA(r,l,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),l,h,d,i,s):a=o.getNode()}}return Yh(e,a,o.isFullyInitialized()||Ee(t),n.filter.filtersNodes())}}function vy(n,e,t,r,i,s,o,a){let c=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(Ee(t))l=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);l=d.updateFullNode(c.getNode(),_,null)}else{let _=Ie(t);if(!c.isCompleteForPath(t)&&lo(t)>1)return e;let E=Ze(t),R=c.getNode().getImmediateChild(_).updateChild(E,r);_===".priority"?l=d.updatePriority(c.getNode(),R):l=d.updateChild(c.getNode(),_,R,E,WU,null)}let h=jU(e,l,c.isFullyInitialized()||Ee(t),d.filtersNodes()),p=new cf(i,h,s);return KU(n,h,t,i,p,a)}function YD(n,e,t,r,i,s,o){let a=e.eventCache,c,l,d=new cf(i,e,s);if(Ee(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Yh(e,l,!0,n.filter.filtersNodes());else{let h=Ie(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=Yh(e,l,a.isFullyInitialized(),a.isFiltered());else{let p=Ze(t),_=a.getNode().getImmediateChild(h),E;if(Ee(p))E=r;else{let A=d.getCompleteChild(h);A!=null?bA(p)===".priority"&&A.getChild(MU(p)).isEmpty()?E=A:E=A.updateChild(p,r):E=_e.EMPTY_NODE}if(_.equals(E))c=e;else{let A=n.filter.updateChild(a.getNode(),h,E,p,d,o);c=Yh(e,A,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function nU(n,e){return n.eventCache.isCompleteForChild(e)}function dX(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let d=ht(t,c);nU(e,Ie(d))&&(a=YD(n,a,d,l,i,s,o))}),r.foreach((c,l)=>{let d=ht(t,c);nU(e,Ie(d))||(a=YD(n,a,d,l,i,s,o))}),a}function rU(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function JD(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;Ee(t)?l=r:l=new xn(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((h,p)=>{if(d.hasChild(h)){let _=e.serverCache.getNode().getImmediateChild(h),E=rU(n,_,p);c=vy(n,c,new Be(h),E,i,s,o,a)}}),l.children.inorderTraversal((h,p)=>{let _=!e.serverCache.isCompleteForChild(h)&&p.value===null;if(!d.hasChild(h)&&!_){let E=e.serverCache.getNode().getImmediateChild(h),A=rU(n,E,p);c=vy(n,c,new Be(h),A,i,s,o,a)}}),c}function hX(n,e,t,r,i,s,o){if(yy(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Ee(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return vy(n,e,t,c.getNode().getChild(t),i,s,a,o);if(Ee(t)){let l=new xn(null);return c.getNode().forEachChild(xi,(d,h)=>{l=l.set(new Be(d),h)}),JD(n,e,t,l,i,s,a,o)}else return e}else{let l=new xn(null);return r.foreach((d,h)=>{let p=ht(t,d);c.isCompleteForPath(p)&&(l=l.set(d,c.getNode().getChild(p)))}),JD(n,e,t,l,i,s,a,o)}}function fX(n,e,t,r,i){let s=e.serverCache,o=jU(e,s.getNode(),s.isFullyInitialized()||Ee(t),s.isFiltered());return KU(n,o,t,r,WU,i)}function pX(n,e,t,r,i,s){let o;if(yy(r,t)!=null)return e;{let a=new cf(r,e,i),c=e.eventCache.getNode(),l;if(Ee(t)||Ie(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=_y(r,Fa(e));else{let h=e.serverCache.getNode();$(h instanceof _e,"serverChildren would be complete if leaf node"),d=NA(r,h)}d=d,l=n.filter.updateFullNode(c,d,s)}else{let d=Ie(t),h=PA(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?l=n.filter.updateChild(c,d,h,Ze(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(c,d,_e.EMPTY_NODE,Ze(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=_y(r,Fa(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||yy(r,Ue())!=null,Yh(e,l,o,n.filter.filtersNodes())}}var XD=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new sf(r.getIndex()),s=OJ(r);this.processor_=aX(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(_e.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(_e.EMPTY_NODE,a.getNode(),null),d=new Ni(c,o.isFullyInitialized(),i.filtersNodes()),h=new Ni(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=ky(h,d),this.eventGenerator_=new qD(this.query_)}get query(){return this.query_}};function mX(n){return n.viewCache_.serverCache.getNode()}function gX(n){return gy(n.viewCache_)}function _X(n,e){let t=Fa(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ee(e)&&!t.getImmediateChild(Ie(e)).isEmpty())?t.getChild(e):null}function iU(n){return n.eventRegistrations_.length===0}function yX(n,e){n.eventRegistrations_.push(e)}function sU(n,e,t){let r=[];if(t){$(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function oU(n,e,t,r){e.type===Ai.MERGE&&e.source.queryId!==null&&($(Fa(n.viewCache_),"We should always have a full cache before handling merges"),$(gy(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=lX(n.processor_,i,e,t,r);return cX(n.processor_,s.viewCache),$(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,QU(n,s.changes,s.viewCache.eventCache.getNode(),null)}function vX(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(rt,(s,o)=>{r.push(Jl(s,o))}),t.isFullyInitialized()&&r.push(BU(t.getNode())),QU(n,r,t.getNode(),e)}function QU(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return HJ(n.eventGenerator_,e,t,i)}var wy,Iy=class{constructor(){this.views=new Map}};function wX(n){$(!wy,"__referenceConstructor has already been defined"),wy=n}function IX(){return $(wy,"Reference.ts has not been loaded"),wy}function EX(n){return n.views.size===0}function kA(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return $(s!=null,"SyncTree gave us an op for an invalid query."),oU(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(oU(o,e,t,r));return s}}function YU(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=_y(t,i?r:null),c=!1;a?c=!0:r instanceof _e?(a=NA(t,r),c=!1):(a=_e.EMPTY_NODE,c=!1);let l=ky(new Ni(a,c,!1),new Ni(r,i,!1));return new XD(e,l)}return o}function bX(n,e,t,r,i,s){let o=YU(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),yX(o,t),vX(o,t)}function CX(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=uo(n);if(i==="default")for(let[c,l]of n.views.entries())o=o.concat(sU(l,t,r)),iU(l)&&(n.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=n.views.get(i);c&&(o=o.concat(sU(c,t,r)),iU(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!uo(n)&&s.push(new(IX())(e._repo,e._path)),{removed:s,events:o}}function JU(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function ao(n,e){let t=null;for(let r of n.views.values())t=t||_X(r,e);return t}function XU(n,e){if(e._queryParams.loadsAllData())return Oy(n);{let r=e._queryIdentifier;return n.views.get(r)}}function ZU(n,e){return XU(n,e)!=null}function uo(n){return Oy(n)!=null}function Oy(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Ey;function TX(n){$(!Ey,"__referenceConstructor has already been defined"),Ey=n}function SX(){return $(Ey,"Reference.ts has not been loaded"),Ey}var DX=1,by=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new xn(null),this.pendingWriteTree_=sX(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function MA(n,e,t,r,i){return WJ(n.pendingWriteTree_,e,t,r,i),i?iu(n,new Xl(AA(),e,t)):[]}function AX(n,e,t,r){KJ(n.pendingWriteTree_,e,t,r);let i=xn.fromObject(t);return iu(n,new af(AA(),e,i))}function so(n,e,t=!1){let r=QJ(n.pendingWriteTree_,e);if(YJ(n.pendingWriteTree_,e)){let s=new xn(null);return r.snap!=null?s=s.set(Ue(),!0):Yt(r.children,o=>{s=s.set(new Be(o),!0)}),iu(n,new HD(r.path,s,t))}else return[]}function _f(n,e,t){return iu(n,new Xl(xA(),e,t))}function xX(n,e,t){let r=xn.fromObject(t);return iu(n,new af(xA(),e,r))}function RX(n,e){return iu(n,new my(xA(),e))}function NX(n,e,t){let r=OA(n,t);if(r){let i=FA(r),s=i.path,o=i.queryId,a=An(s,e),c=new my(RA(o),a);return LA(n,s,c)}else return[]}function Cy(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||ZU(o,e))){let c=CX(o,e,t,r);EX(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let d=l.findIndex(p=>p._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(p,_)=>uo(_));if(d&&!h){let p=n.syncPointTree_.subtree(s);if(!p.isEmpty()){let _=MX(p);for(let E=0;E<_.length;++E){let A=_[E],R=A.query,L=rB(n,A);n.listenProvider_.startListening(Xh(R),lf(n,R),L.hashFn,L.onComplete)}}}!h&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(Xh(e),null):l.forEach(p=>{let _=n.queryToTagMap.get(Ly(p));n.listenProvider_.stopListening(Xh(p),_)}))}OX(n,l)}return a}function eB(n,e,t,r){let i=OA(n,r);if(i!=null){let s=FA(i),o=s.path,a=s.queryId,c=An(o,e),l=new Xl(RA(a),c,t);return LA(n,o,l)}else return[]}function PX(n,e,t,r){let i=OA(n,r);if(i){let s=FA(i),o=s.path,a=s.queryId,c=An(o,e),l=xn.fromObject(t),d=new af(RA(a),c,l);return LA(n,o,d)}else return[]}function ZD(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(p,_)=>{let E=An(p,i);s=s||ao(_,E),o=o||uo(_)});let a=n.syncPointTree_.get(i);a?(o=o||uo(a),s=s||ao(a,Ue())):(a=new Iy,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=_e.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,E)=>{let A=ao(E,Ue());A&&(s=s.updateImmediateChild(_,A))}));let l=ZU(a,e);if(!l&&!e._queryParams.loadsAllData()){let p=Ly(e);$(!n.queryToTagMap.has(p),"View does not exist, but we have a tag");let _=FX();n.queryToTagMap.set(p,_),n.tagToQueryMap.set(_,p)}let d=My(n.pendingWriteTree_,i),h=bX(a,e,t,d,s,c);if(!l&&!o&&!r){let p=XU(a,e);h=h.concat(LX(n,e,p))}return h}function Fy(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=An(o,e),l=ao(a,c);if(l)return l});return qU(i,e,s,t,!0)}function kX(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let h=An(l,t);r=r||ao(d,h)});let i=n.syncPointTree_.get(t);i?r=r||ao(i,Ue()):(i=new Iy,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new Ni(r,!0,!1):null,a=My(n.pendingWriteTree_,e._path),c=YU(i,e,a,s?o.getNode():_e.EMPTY_NODE,s);return gX(c)}function iu(n,e){return tB(e,n.syncPointTree_,null,My(n.pendingWriteTree_,Ue()))}function tB(n,e,t,r){if(Ee(n.path))return nB(n,e,t,r);{let i=e.get(Ue());t==null&&i!=null&&(t=ao(i,Ue()));let s=[],o=Ie(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,d=zU(r,o);s=s.concat(tB(a,c,l,d))}return i&&(s=s.concat(kA(i,n,r,t))),s}}function nB(n,e,t,r){let i=e.get(Ue());t==null&&i!=null&&(t=ao(i,Ue()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=zU(r,o),d=n.operationForChild(o);d&&(s=s.concat(nB(d,a,c,l)))}),i&&(s=s.concat(kA(i,n,r,t))),s}function rB(n,e){let t=e.query,r=lf(n,t);return{hashFn:()=>(mX(e)||_e.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?NX(n,t._path,r):RX(n,t._path);{let s=WY(i,t);return Cy(n,t,null,s)}}}}function lf(n,e){let t=Ly(e);return n.queryToTagMap.get(t)}function Ly(n){return n._path.toString()+"$"+n._queryIdentifier}function OA(n,e){return n.tagToQueryMap.get(e)}function FA(n){let e=n.indexOf("$");return $(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Be(n.substr(0,e))}}function LA(n,e,t){let r=n.syncPointTree_.get(e);$(r,"Missing sync point for query tag that we're tracking");let i=My(n.pendingWriteTree_,e);return kA(r,t,i,null)}function MX(n){return n.fold((e,t,r)=>{if(t&&uo(t))return[Oy(t)];{let i=[];return t&&(i=JU(t)),Yt(r,(s,o)=>{i=i.concat(o)}),i}})}function Xh(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(SX())(n._repo,n._path):n}function OX(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=Ly(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function FX(){return DX++}function LX(n,e,t){let r=e._path,i=lf(n,e),s=rB(n,t),o=n.listenProvider_.startListening(Xh(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)$(!uo(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,d,h)=>{if(!Ee(l)&&d&&uo(d))return[Oy(d).query];{let p=[];return d&&(p=p.concat(JU(d).map(_=>_.query))),Yt(h,(_,E)=>{p=p.concat(E)}),p}});for(let l=0;l<c.length;++l){let d=c[l];n.listenProvider_.stopListening(Xh(d),lf(n,d))}}return o}var eA=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},tA=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=ht(this.path_,e);return new n(this.syncTree_,t)}node(){return Fy(this.syncTree_,this.path_)}},VX=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},aU=function(n,e,t){if(!n||typeof n!="object")return n;if($(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return UX(n[".sv"],e,t);if(typeof n[".sv"]=="object")return BX(n[".sv"],e);$(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},UX=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:$(!1,"Unexpected server value: "+n)}},BX=function(n,e,t){n.hasOwnProperty("increment")||$(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&$(!1,"Unexpected increment value: "+r);let i=e.node();if($(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},iB=function(n,e,t,r){return UA(e,new tA(t,n),r)},VA=function(n,e,t){return UA(n,new eA(e),t)};function UA(n,e,t){let r=n.getPriority().val(),i=aU(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=aU(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Ql(a,gt(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Ql(i))),o.forEachChild(rt,(a,c)=>{let l=UA(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var uf=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function Vy(n,e){let t=e instanceof Be?e:new Be(e),r=n,i=Ie(t);for(;i!==null;){let s=Ds(r.node.children,i)||{children:{},childCount:0};r=new uf(i,r,s),t=Ze(t),i=Ie(t)}return r}function Ua(n){return n.node.value}function BA(n,e){n.node.value=e,nA(n)}function sB(n){return n.node.childCount>0}function jX(n){return Ua(n)===void 0&&!sB(n)}function Uy(n,e){Yt(n.node.children,(t,r)=>{e(new uf(t,n,r))})}function oB(n,e,t,r){t&&!r&&e(n),Uy(n,i=>{oB(i,e,!0,r)}),t&&r&&e(n)}function $X(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function yf(n){return new Be(n.parent===null?n.name:yf(n.parent)+"/"+n.name)}function nA(n){n.parent!==null&&HX(n.parent,n.name,n)}function HX(n,e,t){let r=jX(t),i=In(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,nA(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,nA(n))}var qX=/[\[\].#$\/\u0000-\u001F\u007F]/,zX=/[\[\].#$\u0000-\u001F\u007F]/,fD=10*1024*1024,By=function(n){return typeof n=="string"&&n.length!==0&&!qX.test(n)},aB=function(n){return typeof n=="string"&&n.length!==0&&!zX.test(n)},GX=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),aB(n)},df=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Ny(n)||n&&typeof n=="object"&&In(n,".sv")},Pi=function(n,e,t,r){r&&e===void 0||vf(un(n,"value"),e,t)},vf=function(n,e,t){let r=t instanceof Be?new SD(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+ka(r));if(typeof e=="function")throw new Error(n+"contains a function "+ka(r)+" with contents = "+e.toString());if(Ny(e))throw new Error(n+"contains "+e.toString()+" "+ka(r));if(typeof e=="string"&&e.length>fD/3&&Cd(e)>fD)throw new Error(n+"contains a string greater than "+fD+" utf8 bytes "+ka(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Yt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!By(o)))throw new Error(n+" contains an invalid key ("+o+") "+ka(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);EJ(r,o),vf(n,a,r),bJ(r)}),i&&s)throw new Error(n+' contains ".value" child '+ka(r)+" in addition to actual children.")}},WX=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=ef(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!By(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(IJ);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&br(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},cB=function(n,e,t,r){if(r&&e===void 0)return;let i=un(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Yt(e,(o,a)=>{let c=new Be(o);if(vf(i,a,ht(t,c)),bA(c)===".priority"&&!df(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),WX(i,s)},jA=function(n,e,t){if(!(t&&e===void 0)){if(Ny(e))throw new Error(un(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!df(e))throw new Error(un(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},wf=function(n,e,t,r){if(!(r&&t===void 0)&&!By(t))throw new Error(un(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},su=function(n,e,t,r){if(!(r&&t===void 0)&&!aB(t))throw new Error(un(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},KX=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),su(n,e,t,r)},nr=function(n,e){if(Ie(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},lB=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!By(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!GX(t))throw new Error(un(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var rA=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function jy(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!CA(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function uB(n,e,t){jy(n,t),dB(n,r=>CA(r,e))}function rr(n,e,t){jy(n,t),dB(n,r=>br(r,e)||br(e,r))}function dB(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(QX(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function QX(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Oa&&Qt("event: "+t.toString()),nu(r)}}}var hB="repo_interrupt",YX=25,iA=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new rA,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=py(),this.transactionQueueTree_=new uf,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function JX(n,e,t){if(n.stats_=EA(n.repoInfo_),n.forceRestClient_||JY())n.server_=new LD(n.repoInfo_,(r,i,s,o)=>{cU(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>lU(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Nt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new TA(n.repoInfo_,e,(r,i,s,o)=>{cU(n,r,i,s,o)},r=>{lU(n,r)},r=>{XX(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=ZY(n.repoInfo_,()=>new $D(n.stats_,n.server_)),n.infoData_=new VD,n.infoSyncTree_=new by({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=_f(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),$A(n,"connected",!1),n.serverSyncTree_=new by({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);rr(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function fB(n){let t=n.infoData_.getNode(new Be(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function If(n){return VX({timestamp:fB(n)})}function cU(n,e,t,r,i){n.dataUpdateCount++;let s=new Be(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=bd(t,l=>gt(l));o=PX(n.serverSyncTree_,s,c,i)}else{let c=gt(t);o=eB(n.serverSyncTree_,s,c,i)}else if(r){let c=bd(t,l=>gt(l));o=xX(n.serverSyncTree_,s,c)}else{let c=gt(t);o=_f(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=eu(n,s)),rr(n.eventQueue_,a,o)}function lU(n,e){$A(n,"connected",e),e===!1&&tZ(n)}function XX(n,e){Yt(e,(t,r)=>{$A(n,t,r)})}function $A(n,e,t){let r=new Be("/.info/"+e),i=gt(t);n.infoData_.updateSnapshot(r,i);let s=_f(n.infoSyncTree_,r,i);rr(n.eventQueue_,r,s)}function $y(n){return n.nextWriteId_++}function ZX(n,e,t){let r=kX(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=gt(i).withIndex(e._queryParams.getIndex());ZD(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=_f(n.serverSyncTree_,e._path,s);else{let a=lf(n.serverSyncTree_,e);o=eB(n.serverSyncTree_,e._path,s,a)}return rr(n.eventQueue_,e._path,o),Cy(n.serverSyncTree_,e,t,null,!0),s},i=>(ou(n,"get for query "+Nt(e)+" failed: "+i),Promise.reject(new Error(i))))}function HA(n,e,t,r,i){ou(n,"set",{path:e.toString(),value:t,priority:r});let s=If(n),o=gt(t,r),a=Fy(n.serverSyncTree_,e),c=VA(o,a,s),l=$y(n),d=MA(n.serverSyncTree_,e,c,l,!0);jy(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(p,_)=>{let E=p==="ok";E||mn("set at "+e+" failed: "+p);let A=so(n.serverSyncTree_,l,!E);rr(n.eventQueue_,e,A),ho(n,i,p,_)});let h=zA(n,e);eu(n,h),rr(n.eventQueue_,h,[])}function eZ(n,e,t,r){ou(n,"update",{path:e.toString(),value:t});let i=!0,s=If(n),o={};if(Yt(t,(a,c)=>{i=!1,o[a]=iB(ht(e,a),gt(c),n.serverSyncTree_,s)}),i)Qt("update() called with empty data.  Don't do anything."),ho(n,r,"ok",void 0);else{let a=$y(n),c=AX(n.serverSyncTree_,e,o,a);jy(n.eventQueue_,c),n.server_.merge(e.toString(),t,(l,d)=>{let h=l==="ok";h||mn("update at "+e+" failed: "+l);let p=so(n.serverSyncTree_,a,!h),_=p.length>0?eu(n,e):e;rr(n.eventQueue_,_,p),ho(n,r,l,d)}),Yt(t,l=>{let d=zA(n,ht(e,l));eu(n,d)}),rr(n.eventQueue_,e,[])}}function tZ(n){ou(n,"onDisconnectEvents");let e=If(n),t=py();BD(n.onDisconnect_,Ue(),(i,s)=>{let o=iB(i,s,n.serverSyncTree_,e);ru(t,i,o)});let r=[];BD(t,Ue(),(i,s)=>{r=r.concat(_f(n.serverSyncTree_,i,s));let o=zA(n,i);eu(n,o)}),n.onDisconnect_=py(),rr(n.eventQueue_,Ue(),r)}function nZ(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&UD(n.onDisconnect_,e),ho(n,t,r,i)})}function uU(n,e,t,r){let i=gt(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&ru(n.onDisconnect_,e,i),ho(n,r,s,o)})}function rZ(n,e,t,r,i){let s=gt(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&ru(n.onDisconnect_,e,s),ho(n,i,o,a)})}function iZ(n,e,t,r){if(Fc(t)){Qt("onDisconnect().update() called with empty data.  Don't do anything."),ho(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Yt(t,(o,a)=>{let c=gt(a);ru(n.onDisconnect_,ht(e,o),c)}),ho(n,r,i,s)})}function sZ(n,e,t){let r;Ie(e._path)===".info"?r=ZD(n.infoSyncTree_,e,t):r=ZD(n.serverSyncTree_,e,t),uB(n.eventQueue_,e._path,r)}function sA(n,e,t){let r;Ie(e._path)===".info"?r=Cy(n.infoSyncTree_,e,t):r=Cy(n.serverSyncTree_,e,t),uB(n.eventQueue_,e._path,r)}function pB(n){n.persistentConnection_&&n.persistentConnection_.interrupt(hB)}function oZ(n){n.persistentConnection_&&n.persistentConnection_.resume(hB)}function ou(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Qt(t,...e)}function ho(n,e,t,r){e&&nu(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function aZ(n,e,t,r,i,s){ou(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:fU(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=qA(n,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{vf("transaction failed: Data returned ",c,o.path),o.status=0;let l=Vy(n.transactionQueueTree_,e),d=Ua(l)||[];d.push(o),BA(l,d);let h;typeof c=="object"&&c!==null&&In(c,".priority")?(h=Ds(c,".priority"),$(df(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Fy(n.serverSyncTree_,e)||_e.EMPTY_NODE).getPriority().val();let p=If(n),_=gt(c,h),E=VA(_,a,p);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=E,o.currentWriteId=$y(n);let A=MA(n.serverSyncTree_,e,E,o.currentWriteId,o.applyLocally);rr(n.eventQueue_,e,A),Hy(n,n.transactionQueueTree_)}}function qA(n,e,t){return Fy(n.serverSyncTree_,e,t)||_e.EMPTY_NODE}function Hy(n,e=n.transactionQueueTree_){if(e||qy(n,e),Ua(e)){let t=gB(n,e);$(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&cZ(n,yf(e),t)}else sB(e)&&Uy(e,t=>{Hy(n,t)})}function cZ(n,e,t){let r=t.map(l=>l.currentWriteId),i=qA(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];$(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=An(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{ou(n,"transaction put response",{path:c.toString(),status:l});let d=[];if(l==="ok"){let h=[];for(let p=0;p<t.length;p++)t[p].status=2,d=d.concat(so(n.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&h.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();qy(n,Vy(n.transactionQueueTree_,e)),Hy(n,n.transactionQueueTree_),rr(n.eventQueue_,e,d);for(let p=0;p<h.length;p++)nu(h[p])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{mn("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}eu(n,e)}},o)}function eu(n,e){let t=mB(n,e),r=yf(t),i=gB(n,t);return lZ(n,i,r),r}function lZ(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=An(t,c.path),d=!1,h;if($(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,i=i.concat(so(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=YX)d=!0,h="maxretry",i=i.concat(so(n.serverSyncTree_,c.currentWriteId,!0));else{let p=qA(n,c.path,o);c.currentInputSnapshot=p;let _=e[a].update(p.val());if(_!==void 0){vf("transaction failed: Data returned ",_,c.path);let E=gt(_);typeof _=="object"&&_!=null&&In(_,".priority")||(E=E.updatePriority(p.getPriority()));let R=c.currentWriteId,L=If(n),Y=VA(E,p,L);c.currentOutputSnapshotRaw=E,c.currentOutputSnapshotResolved=Y,c.currentWriteId=$y(n),o.splice(o.indexOf(R),1),i=i.concat(MA(n.serverSyncTree_,c.path,Y,c.currentWriteId,c.applyLocally)),i=i.concat(so(n.serverSyncTree_,R,!0))}else d=!0,h="nodata",i=i.concat(so(n.serverSyncTree_,c.currentWriteId,!0))}rr(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}qy(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)nu(r[a]);Hy(n,n.transactionQueueTree_)}function mB(n,e){let t,r=n.transactionQueueTree_;for(t=Ie(e);t!==null&&Ua(r)===void 0;)r=Vy(r,t),e=Ze(e),t=Ie(e);return r}function gB(n,e){let t=[];return _B(n,e,t),t.sort((r,i)=>r.order-i.order),t}function _B(n,e,t){let r=Ua(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Uy(e,i=>{_B(n,i,t)})}function qy(n,e){let t=Ua(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,BA(e,t.length>0?t:void 0)}Uy(e,r=>{qy(n,r)})}function zA(n,e){let t=yf(mB(n,e)),r=Vy(n.transactionQueueTree_,e);return $X(r,i=>{pD(n,i)}),pD(n,r),oB(r,i=>{pD(n,i)}),t}function pD(n,e){let t=Ua(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?($(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):($(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(so(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?BA(e,void 0):t.length=s+1,rr(n.eventQueue_,yf(e),i);for(let o=0;o<r.length;o++)nu(r[o])}}function uZ(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function dZ(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):mn(`Invalid query segment '${t}' in query '${n}'`)}return e}var oA=function(n,e){let t=hZ(n),r=t.namespace;t.domain==="firebase.com"&&Ri(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Ri("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||$Y();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new oy(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Be(t.pathString)}},hZ=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=uZ(n.substring(d,h)));let p=dZ(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let _=e.slice(0,l);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),t=e.substring(E+1),s=r}"ns"in p&&(s=p.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var dU="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",fZ=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=dU.charAt(t%64),t=Math.floor(t/64);$(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=dU.charAt(e[i]);return $(o.length===20,"nextPushId: Length should be 20."),o}}();var Ty=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Nt(this.snapshot.exportVal())}},Sy=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var hf=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return $(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Dy=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new jt;return nZ(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){nr("OnDisconnect.remove",this._path);let e=new jt;return uU(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){nr("OnDisconnect.set",this._path),Pi("OnDisconnect.set",e,this._path,!1);let t=new jt;return uU(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){nr("OnDisconnect.setWithPriority",this._path),Pi("OnDisconnect.setWithPriority",e,this._path,!1),jA("OnDisconnect.setWithPriority",t,!1);let r=new jt;return rZ(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){nr("OnDisconnect.update",this._path),cB("OnDisconnect.update",e,this._path,!1);let t=new jt;return iZ(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var Rn=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Ee(this._path)?null:bA(this._path)}get ref(){return new ir(this._repo,this._path)}get _queryIdentifier(){let e=J2(this._queryParams),t=IA(e);return t==="{}"?"default":t}get _queryObject(){return J2(this._queryParams)}isEqual(e){if(e=G(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=CA(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+wJ(this._path)}};function zy(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function po(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===xi){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==co)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==is)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===rt){if(e!=null&&!df(e)||t!=null&&!df(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if($(n.getIndex()instanceof tf||n.getIndex()===DA,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Gy(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var ir=class n extends Rn{constructor(e,t){super(e,t,new of,!1)}get parent(){let e=MU(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},tu=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new Be(e),r=fo(this.ref,e);return new n(this._node.getChild(t),r,rt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,fo(this.ref,r),rt)))}hasChild(e){let t=new Be(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function GA(n,e){return n=G(n),n._checkNotDeleted("ref"),e!==void 0?fo(n._root,e):n._root}function WA(n,e){n=G(n),n._checkNotDeleted("refFromURL");let t=oA(e,n._repo.repoInfo_.nodeAdmin);lB("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Ri("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),GA(n,t.path.toString())}function fo(n,e){return n=G(n),Ie(n._path)===null?KX("child","path",e,!1):su("child","path",e,!1),new ir(n._repo,ht(n._path,e))}function yB(n,e){n=G(n),nr("push",n._path),Pi("push",e,n._path,!0);let t=fB(n._repo),r=fZ(t),i=fo(n,r),s=fo(n,r),o;return e!=null?o=Wy(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function vB(n){return nr("remove",n._path),Wy(n,null)}function Wy(n,e){n=G(n),nr("set",n._path),Pi("set",e,n._path,!1);let t=new jt;return HA(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function wB(n,e){n=G(n),nr("setPriority",n._path),jA("setPriority",e,!1);let t=new jt;return HA(n._repo,ht(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function IB(n,e,t){if(nr("setWithPriority",n._path),Pi("setWithPriority",e,n._path,!1),jA("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new jt;return HA(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function EB(n,e){cB("update",e,n._path,!1);let t=new jt;return eZ(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function bB(n){n=G(n);let e=new hf(()=>{}),t=new ff(e);return ZX(n._repo,n,t).then(r=>new tu(r,new ir(n._repo,n._path),n._queryParams.getIndex()))}var ff=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new Ty("value",this,new tu(e.snapshotNode,new ir(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Sy(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Ay=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Sy(this,e,t):null}createEvent(e,t){$(e.childName!=null,"Child events should have a childName.");let r=fo(new ir(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new Ty(e.type,this,new tu(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Ef(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,l=(d,h)=>{sA(n._repo,n,a),c(d,h)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new hf(t,s||void 0),a=e==="value"?new ff(o):new Ay(e,o);return sZ(n._repo,n,a),()=>sA(n._repo,n,a)}function Ky(n,e,t,r){return Ef(n,"value",e,t,r)}function KA(n,e,t,r){return Ef(n,"child_added",e,t,r)}function QA(n,e,t,r){return Ef(n,"child_changed",e,t,r)}function YA(n,e,t,r){return Ef(n,"child_moved",e,t,r)}function JA(n,e,t,r){return Ef(n,"child_removed",e,t,r)}function XA(n,e,t){let r=null,i=t?new hf(t):null;e==="value"?r=new ff(i):e&&(r=new Ay(e,i)),sA(n._repo,n,r)}var sr=class{},xy=class extends sr{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Pi("endAt",this._value,e._path,!0);let t=FD(e._queryParams,this._value,this._key);if(Gy(t),po(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Rn(e._repo,e._path,t,e._orderByCalled)}};function CB(n,e){return wf("endAt","key",e,!0),new xy(n,e)}var aA=class extends sr{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Pi("endBefore",this._value,e._path,!1);let t=UJ(e._queryParams,this._value,this._key);if(Gy(t),po(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Rn(e._repo,e._path,t,e._orderByCalled)}};function TB(n,e){return wf("endBefore","key",e,!0),new aA(n,e)}var Ry=class extends sr{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Pi("startAt",this._value,e._path,!0);let t=OD(e._queryParams,this._value,this._key);if(Gy(t),po(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Rn(e._repo,e._path,t,e._orderByCalled)}};function SB(n=null,e){return wf("startAt","key",e,!0),new Ry(n,e)}var cA=class extends sr{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Pi("startAfter",this._value,e._path,!1);let t=VJ(e._queryParams,this._value,this._key);if(Gy(t),po(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Rn(e._repo,e._path,t,e._orderByCalled)}};function DB(n,e){return wf("startAfter","key",e,!0),new cA(n,e)}var lA=class extends sr{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Rn(e._repo,e._path,FJ(e._queryParams,this._limit),e._orderByCalled)}};function AB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new lA(n)}var uA=class extends sr{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Rn(e._repo,e._path,LJ(e._queryParams,this._limit),e._orderByCalled)}};function xB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new uA(n)}var dA=class extends sr{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){zy(e,"orderByChild");let t=new Be(this._path);if(Ee(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new tf(t),i=Py(e._queryParams,r);return po(i),new Rn(e._repo,e._path,i,!0)}};function RB(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return su("orderByChild","path",n,!1),new dA(n)}var hA=class extends sr{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){zy(e,"orderByKey");let t=Py(e._queryParams,xi);return po(t),new Rn(e._repo,e._path,t,!0)}};function NB(){return new hA}var fA=class extends sr{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){zy(e,"orderByPriority");let t=Py(e._queryParams,rt);return po(t),new Rn(e._repo,e._path,t,!0)}};function PB(){return new fA}var pA=class extends sr{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){zy(e,"orderByValue");let t=Py(e._queryParams,DA);return po(t),new Rn(e._repo,e._path,t,!0)}};function kB(){return new pA}var mA=class extends sr{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Pi("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new xy(this._value,this._key)._apply(new Ry(this._value,this._key)._apply(e))}};function MB(n,e){return wf("equalTo","key",e,!0),new mA(n,e)}function Tr(n,...e){let t=G(n);for(let r of e)t=r._apply(t);return t}wX(ir);TX(ir);var pZ="FIREBASE_DATABASE_EMULATOR_HOST",gA={},mZ=!1;function gZ(n,e,t,r){n.repoInfo_=new oy(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function ZA(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Ri("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Qt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=oA(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[pZ]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=oA(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new Qh(Qh.OWNER):new wD(n.name,n.options,e);lB("Invalid Firebase Database URL",o),Ee(o.path)||Ri("Database URL must point to the root of a Firebase Database (not including a child path).");let h=yZ(a,n,d,new vD(n.name,t));return new _A(h,n)}function _Z(n,e){let t=gA[e];(!t||t[n.key]!==n)&&Ri(`Database ${e}(${n.repoInfo_}) has already been deleted.`),pB(n),delete t[n.key]}function yZ(n,e,t,r){let i=gA[e.name];i||(i={},gA[e.name]=i);let s=i[n.toURLString()];return s&&Ri("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new iA(n,mZ,t,r),i[n.toURLString()]=s,s}var _A=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(JX(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ir(this._repo,Ue())),this._rootInternal}_delete(){return this._rootInternal!==null&&(_Z(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ri("Cannot call "+e+" on a deleted database.")}};function OB(){kU.IS_TRANSPORT_INITIALIZED&&mn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function FB(){OB(),Zh.forceDisallow()}function LB(){OB(),zl.forceDisallow(),Zh.forceAllow()}function VB(n,e,t,r={}){n=G(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Ri("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Ri('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Qh(Qh.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Oc(r.mockUserToken,n.app.options.projectId);s=new Qh(o)}gZ(i,e,t,s)}function UB(n){n=G(n),n._checkNotDeleted("goOffline"),pB(n._repo)}function BB(n){n=G(n),n._checkNotDeleted("goOnline"),oZ(n._repo)}function jB(n,e){mU(n,e)}function vZ(n){wA(bn),En(new Ke("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return ZA(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),Tt(M2,O2,n),Tt(M2,O2,"esm2017")}var wZ={".sv":"timestamp"};function $B(){return wZ}function HB(n){return{".sv":{increment:n}}}var yA=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function qB(n,e,t){var r;if(n=G(n),nr("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new jt,o=(c,l,d)=>{let h=null;c?s.reject(c):(h=new tu(d,new ir(n._repo,n._path),rt),s.resolve(new yA(l,h)))},a=Ky(n,()=>{});return aZ(n._repo,n._path,e,o,a,i),s.promise}TA.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};TA.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};vZ();var IZ="@firebase/database-compat",EZ="1.0.5";var bZ=new $n("@firebase/database-compat"),zB=function(n){let e="FIREBASE WARNING: "+n;bZ.warn(e)};var CZ=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(un(n,e)+"must be a boolean.")},TZ=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(un(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var ex=class{constructor(e){this._delegate=e}cancel(e){le("OnDisconnect.cancel",0,1,arguments.length),$t("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){le("OnDisconnect.remove",0,1,arguments.length),$t("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){le("OnDisconnect.set",1,2,arguments.length),$t("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){le("OnDisconnect.setWithPriority",2,3,arguments.length),$t("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(le("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,zB("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}$t("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var tx=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return le("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Ba=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return le("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return le("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return le("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return le("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return le("DataSnapshot.child",0,1,arguments.length),e=String(e),su("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return le("DataSnapshot.hasChild",1,1,arguments.length),su("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return le("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return le("DataSnapshot.forEach",1,1,arguments.length),$t("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return le("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return le("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return le("DataSnapshot.ref",0,0,arguments.length),new ss(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Qy=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;le("Query.on",2,4,arguments.length),$t("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new Ba(this.database,l),d)};a.userCallback=t,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Ky(this._delegate,a,c),t;case"child_added":return KA(this._delegate,a,c),t;case"child_removed":return JA(this._delegate,a,c),t;case"child_changed":return QA(this._delegate,a,c),t;case"child_moved":return YA(this._delegate,a,c),t;default:throw new Error(un("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(le("Query.off",0,3,arguments.length),TZ("Query.off",e,!0),$t("Query.off","callback",t,!0),GE("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,XA(this._delegate,e,i)}else XA(this._delegate,e)}get(){return bB(this._delegate).then(e=>new Ba(this.database,e))}once(e,t,r,i){le("Query.once",1,4,arguments.length),$t("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new jt,a=(l,d)=>{let h=new Ba(this.database,l);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":Ky(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":KA(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":JA(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":QA(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":YA(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(un("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return le("Query.limitToFirst",1,1,arguments.length),new n(this.database,Tr(this._delegate,AB(e)))}limitToLast(e){return le("Query.limitToLast",1,1,arguments.length),new n(this.database,Tr(this._delegate,xB(e)))}orderByChild(e){return le("Query.orderByChild",1,1,arguments.length),new n(this.database,Tr(this._delegate,RB(e)))}orderByKey(){return le("Query.orderByKey",0,0,arguments.length),new n(this.database,Tr(this._delegate,NB()))}orderByPriority(){return le("Query.orderByPriority",0,0,arguments.length),new n(this.database,Tr(this._delegate,PB()))}orderByValue(){return le("Query.orderByValue",0,0,arguments.length),new n(this.database,Tr(this._delegate,kB()))}startAt(e=null,t){return le("Query.startAt",0,2,arguments.length),new n(this.database,Tr(this._delegate,SB(e,t)))}startAfter(e=null,t){return le("Query.startAfter",0,2,arguments.length),new n(this.database,Tr(this._delegate,DB(e,t)))}endAt(e=null,t){return le("Query.endAt",0,2,arguments.length),new n(this.database,Tr(this._delegate,CB(e,t)))}endBefore(e=null,t){return le("Query.endBefore",0,2,arguments.length),new n(this.database,Tr(this._delegate,TB(e,t)))}equalTo(e,t){return le("Query.equalTo",1,2,arguments.length),new n(this.database,Tr(this._delegate,MB(e,t)))}toString(){return le("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return le("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(le("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,$t(e,"cancel",i.cancel,!0),i.context=r,GE(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(un(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new ss(this.database,new ir(this._delegate._repo,this._delegate._path))}},ss=class n extends Qy{constructor(e,t){super(e,new Rn(t._repo,t._path,new of,!1)),this.database=e,this._delegate=t}getKey(){return le("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return le("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,fo(this._delegate,e))}getParent(){le("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return le("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){le("Reference.set",1,2,arguments.length),$t("Reference.set","onComplete",t,!0);let r=Wy(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(le("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,zB("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}nr("Reference.update",this._delegate._path),$t("Reference.update","onComplete",t,!0);let r=EB(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){le("Reference.setWithPriority",2,3,arguments.length),$t("Reference.setWithPriority","onComplete",r,!0);let i=IB(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){le("Reference.remove",0,1,arguments.length),$t("Reference.remove","onComplete",e,!0);let t=vB(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){le("Reference.transaction",1,3,arguments.length),$t("Reference.transaction","transactionUpdate",e,!1),$t("Reference.transaction","onComplete",t,!0),CZ("Reference.transaction","applyLocally",r,!0);let i=qB(this._delegate,e,{applyLocally:r}).then(s=>new tx(s.committed,new Ba(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){le("Reference.setPriority",1,2,arguments.length),$t("Reference.setPriority","onComplete",t,!0);let r=wB(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){le("Reference.push",0,2,arguments.length),$t("Reference.push","onComplete",t,!0);let r=yB(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return nr("Reference.onDisconnect",this._delegate._path),new ex(new Dy(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var ja=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:FB,forceLongPolling:LB}}useEmulator(e,t,r={}){VB(this._delegate,e,t,r)}ref(e){if(le("database.ref",0,1,arguments.length),e instanceof ss){let t=WA(this._delegate,e.toString());return new ss(this,t)}else{let t=GA(this._delegate,e);return new ss(this,t)}}refFromURL(e){le("database.refFromURL",1,1,arguments.length);let r=WA(this._delegate,e);return new ss(this,r)}goOffline(){return le("database.goOffline",0,0,arguments.length),UB(this._delegate)}goOnline(){return le("database.goOnline",0,0,arguments.length),BB(this._delegate)}};ja.ServerValue={TIMESTAMP:$B(),increment:n=>HB(n)};function SZ({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){wA(t);let a=new Rs("database-standalone"),c=new Ho("auth-internal",a);c.setComponent(new Ke("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new Ho("app-check-internal",a),l.setComponent(new Ke("app-check-internal",()=>i,"PRIVATE"))),{instance:new ja(ZA(n,c,l,e,o),n),namespace:s}}var DZ=Object.freeze({__proto__:null,initStandalone:SZ});var AZ=ja.ServerValue;function xZ(n){n.INTERNAL.registerComponent(new Ke("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new ja(i,r)},"PUBLIC").setServiceProps({Reference:ss,Query:Qy,Database:ja,DataSnapshot:Ba,enableLogging:jB,INTERNAL:DZ,ServerValue:AZ}).setMultipleInstances(!0)),n.registerVersion(IZ,EZ)}xZ(U);var RZ="firebase",NZ="10.12.2";U.registerVersion(RZ,NZ,"app-compat");var GB=(()=>{let e=class e{constructor(r){this.router=r}ngOnInit(){U.auth().onAuthStateChanged(r=>{r?this.router.navigate(["/chat"]):(this.router.navigate(["/log"]),document.getElementById("sidebar-container").style.display="none",document.getElementById("sidebar").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%")})}};e.\u0275fac=function(i){return new(i||e)(te(tt))},e.\u0275cmp=xe({type:e,selectors:[["app-log"]],decls:9,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],["routerLink","/login",1,"button"],["routerLink","/register",1,"button"]],template:function(i,s){i&1&&(w(0,"div",0),Q(1,"div",1),w(2,"div",2),Q(3,"img",3),w(4,"button",4),T(5,"Accedi"),I(),w(6,"button",5),T(7,"Registrati"),I()(),Q(8,"div",1),I())},dependencies:[Pc]});let n=e;return n})();var He=(()=>{let e=class e{constructor(r){this.router=r,this.currentSectorId="",this.linkObject={},this.linkCounter=0,this.ticketToRead=!1,this.isAdmin=!1,this.messageQueue=[]}initNormalScreen(){window.innerWidth>=899&&(document.getElementById("sidebar-container").style.display="flex",document.getElementById("sidebar").style.display="flex",document.getElementById("header").style.display="flex",document.getElementById("router-outlet-container").style.height="calc(100% - 3.5rem)",document.getElementById("router-outlet-container").style.width="calc(100% - 18rem)")}getUserData(){U.auth().onAuthStateChanged(r=>{r?U.firestore().collection("users_data").doc(r.uid).get().then(i=>{if(i.exists){var s=i.data();this.currentUser=s,document.getElementById("header-name-display").innerText=this.currentUser.name,document.getElementById("header-surname-display").innerText=this.currentUser.surname,document.getElementById("header-email-display").innerText=this.currentUser.email,document.getElementById("header-agency-display").innerText=this.currentUser.agencyName}else this.presentToast("Nessun utente trovato"),this.router.navigate(["/log"])}).catch(i=>{this.presentToast("Errore durante il recupero dell'utente:"+i.message)}):(console.log("Nessun utente loggato."),this.router.navigate(["/log"]))})}convertTimestamp(r){let i=new Date(r),s=String(i.getDate()).padStart(2,"0"),o=String(i.getMonth()+1).padStart(2,"0"),a=String(i.getFullYear()),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0"),d=String(i.getSeconds()).padStart(2,"0");return`${s}/${o}/${a} ${c}:${l}:${d}`}presentToast(r){this.animate1("toast-message"),this.messageQueue.push(r),this.messageQueue.length===1&&this.showMessageFromQueue()}showMessageFromQueue(){let r=this.messageQueue[0];document.getElementById("toast-message").style.display="flex",document.getElementById("toast-message-text").innerText=r,setTimeout(()=>{this.hideToastMessage()},3e3)}hideToastMessage(){this.animateFadeOut("toast-message"),setTimeout(()=>{document.getElementById("toast-message").style.display="none"},100),this.messageQueue.shift(),this.messageQueue.length>0&&(this.showMessageFromQueue(),this.animate1("toast-message"))}openCloseSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}animate1(r){var i=document.getElementById(r),s=[{opacity:0},{opacity:1}],o={duration:150,easing:"ease-in-out"};i.animate(s,o)}animateFadeOut(r){var i=document.getElementById(r),s=[{opacity:1},{opacity:0}],o={duration:150,easing:"ease-out"};i.animate(s,o)}};e.\u0275fac=function(i){return new(i||e)(ae(tt))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var WB=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}login(){var r=document.getElementById("email-login-input").value,i=document.getElementById("password-login-input").value;U.auth().signInWithEmailAndPassword(r,i).then(s=>{var o=s.user;this.generalService.presentToast("Login effettuato con successo"),document.getElementById("header").style.display="flex",this.router.navigate(["/company"])}).catch(s=>{s.code=="auth/invalid-credential"&&this.generalService.presentToast("Email o password non validi")})}};e.\u0275fac=function(i){return new(i||e)(te(He),te(tt))},e.\u0275cmp=xe({type:e,selectors:[["app-login"]],decls:17,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate",2,"color","#333"],["id","email-login-input","type","text","placeholder","Email",1,"input"],["id","password-login-input","type","text","placeholder","Password",1,"input"],[1,"button",3,"click"],["routerLink","/change-password",1,"a1"]],template:function(i,s){i&1&&(w(0,"div",0),Q(1,"div",1),w(2,"div",2),Q(3,"img",3),w(4,"div",4)(5,"span",5),T(6,"mail"),I(),Q(7,"input",6),I(),w(8,"div",4)(9,"span",5),T(10,"key"),I(),Q(11,"input",7),I(),w(12,"button",8),H("click",function(){return s.login()}),T(13,"Accedi"),I(),w(14,"a",9),T(15,"Password dimenticata?"),I()(),Q(16,"div",1),I())},dependencies:[Pc]});let n=e;return n})();var PZ=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(te(Is),te(ji))},e.\u0275dir=Kn({type:e});let n=e;return n})(),QB=(()=>{let e=class e extends PZ{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ko(e)))(s||e)}})(),e.\u0275dir=Kn({type:e,features:[Wu]});let n=e;return n})(),YB=new fe("");var kZ={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},lue=lt(q({},kZ),{"[class.ng-submitted]":"isSubmitted"});var MZ=new fe("CallSetDisabledState",{providedIn:"root",factory:()=>JB}),JB="always";var OZ={provide:YB,useExisting:qu(()=>ZB),multi:!0};function XB(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function FZ(n){return n.split(":")[0]}var ZB=(()=>{let e=class e extends QB{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=XB(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=FZ(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ko(e)))(s||e)}})(),e.\u0275dir=Kn({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&H("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[bI([OZ]),Wu]});let n=e;return n})(),au=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(XB(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(te(ji),te(Is),te(ZB,9))},e.\u0275dir=Kn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let n=e;return n})(),LZ={provide:YB,useExisting:qu(()=>ej),multi:!0};function KB(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function VZ(n){return n.split(":")[0]}var ej=(()=>{let e=class e extends QB{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let l=a[c],d=this._getOptionValue(l.value);s.push(d)}}else{let a=i.options;for(let c=0;c<a.length;c++){let l=a[c];if(l.selected){let d=this._getOptionValue(l.value);s.push(d)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=VZ(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ko(e)))(s||e)}})(),e.\u0275dir=Kn({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&H("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[bI([LZ]),Wu]});let n=e;return n})(),cu=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(KB(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(KB(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(te(ji),te(Is),te(ej,9))},e.\u0275dir=Kn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let n=e;return n})();var UZ=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({});let n=e;return n})();var tj=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:MZ,useValue:r.callSetDisabledState??JB}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({imports:[UZ]});let n=e;return n})();var nj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}register(){var r=document.getElementById("email-register-input").value,i=document.getElementById("password-register-input").value,s=document.getElementById("confirm-password-register-input").value,o=document.getElementById("name-register-input").value,a=document.getElementById("surname-register-input").value,c=document.getElementById("agency-name-register-input").value;i==s?U.auth().createUserWithEmailAndPassword(r,i).then(l=>{let d=l.user;var h=U.firestore();h.collection("users_data").doc(d.uid).set({uid:d.uid,name:o,surname:a,agencyName:c,email:r,registration_date:U.firestore.FieldValue.serverTimestamp()}).catch(p=>{this.generalService.presentToast("Errore nel salvataggio dei dati dell'utente durante la registrazione: "+p.message)}),this.generalService.presentToast("Registrazione completata con successo"),document.getElementById("header").style.display="flex",this.router.navigate(["/company"])}).catch(l=>{l.code=="auth/invalid-email"&&this.generalService.presentToast("Email non valida"),l.code=="auth/weak-password"&&this.generalService.presentToast("Password troppo debole")}):this.generalService.presentToast("Le password inserite non corrispondono")}};e.\u0275fac=function(i){return new(i||e)(te(He),te(tt))},e.\u0275cmp=xe({type:e,selectors:[["app-register"]],decls:43,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate"],["id","name-register-input","type","text","placeholder","Nome",1,"input"],["id","surname-register-input","type","text","placeholder","Cognome",1,"input"],["id","agency-name-register-input",2,"width","100%","height","100%","background","transparent","border","1px solid transparent"],["value","TORINO"],["value","ALBA"],["value","GRINZANE CAVOUR"],["value","ASTI"],["value","BRA"],["value","VADO LIGURE"],["id","email-register-input","type","email","placeholder","Email",1,"input"],["id","password-register-input","type","email","placeholder","Password",1,"input"],["id","confirm-password-register-input","type","email","placeholder","Conferma password",1,"input"],[1,"button",2,"width","100%","height","2.5rem",3,"click"]],template:function(i,s){i&1&&(w(0,"div",0),Q(1,"div",1),w(2,"div",2),Q(3,"img",3),w(4,"div",4)(5,"span",5),T(6,"person"),I(),Q(7,"input",6),I(),w(8,"div",4)(9,"span",5),T(10,"person"),I(),Q(11,"input",7),I(),w(12,"div",4)(13,"span",5),T(14,"store"),I(),w(15,"select",8)(16,"option",9),T(17,"TORINO"),I(),w(18,"option",10),T(19,"ALBA"),I(),w(20,"option",11),T(21,"GRINZANE CAVOUR"),I(),w(22,"option",12),T(23,"ASTI"),I(),w(24,"option",13),T(25,"BRA"),I(),w(26,"option",14),T(27,"VADO LIGURE"),I()()(),w(28,"div",4)(29,"span",5),T(30,"mail"),I(),Q(31,"input",15),I(),w(32,"div",4)(33,"span",5),T(34,"lock"),I(),Q(35,"input",16),I(),w(36,"div",4)(37,"span",5),T(38,"lock"),I(),Q(39,"input",17),I(),w(40,"button",18),H("click",function(){return s.register()}),T(41,"Register"),I()(),Q(42,"div",1),I())},dependencies:[au,cu]});let n=e;return n})();function BZ(n,e){n&1&&(w(0,"div",2)(1,"p"),T(2,"Seleziona una chat"),I()())}function jZ(n,e){if(n&1){let t=st();w(0,"span",14),H("click",function(){ze(t);let i=me(2);return Ge(i.deleteChat())}),T(1,"delete"),I()}}function $Z(n,e){if(n&1){let t=st();w(0,"button",15),H("click",function(){ze(t);let i=me(2);return Ge(i.getMoreChatMessages())}),T(1,"Carica altri messaggi"),I()}}function HZ(n,e){if(n&1){let t=st();w(0,"span",21),H("click",function(){ze(t);let i=me().$implicit,s=me(2);return Ge(s.deleteMessage(i))}),T(1,"delete"),I()}}function qZ(n,e){if(n&1&&(w(0,"div",16)(1,"span",17)(2,"strong"),T(3),I(),w(4,"span"),T(5),I(),Q(6,"div",18),Se(7,HZ,2,0,"span",19),I(),w(8,"p",20),T(9),I()()),n&2){let t=e.$implicit,r=me(2);wn("id","chat-message-id-",t.id,""),X(3),wI("",t.creator_name," ",t.creator_surname," ",r.formatTimestamp(t.createdAt),""),X(2),Ct(t.creator_agency_name),X(2),ce("ngIf",r.generalService.isAdmin==!0),X(2),Ct(t.message)}}function zZ(n,e){if(n&1){let t=st();w(0,"div",3)(1,"div",4)(2,"h2"),T(3),I(),Se(4,jZ,2,0,"span",5),I(),w(5,"div",6),Se(6,$Z,2,0,"button",7),w(7,"div",8),Se(8,qZ,10,8,"div",9),Un(9,"async"),I()(),w(10,"div",10)(11,"input",11),H("keydown.enter",function(){ze(t);let i=me();return Ge(i.sendMessage())}),I(),w(12,"button",12),H("click",function(){ze(t);let i=me();return Ge(i.sendMessage())}),w(13,"span",13),T(14,"send"),I()()()()}if(n&2){let t=me();X(3),Ct(t.chatName),X(),ce("ngIf",t.generalService.isAdmin==!0),X(2),ce("ngIf",t.nextPageAvailable),X(2),ce("ngForOf",Bn(9,4,t.documents))}}var rj=(()=>{let e=class e{constructor(r,i,s){this.generalService=r,this.route=i,this.router=s,this.chatName="",this.showChatPlaceholder=!0,this.documents=new De([]),this.nextPageAvailable=!1}ngOnInit(){this.route.queryParams.subscribe(r=>{this.currentChatId=r.id,this.chatName=r.name,this.currentChatId?(this.showChatPlaceholder=!1,this.getChatMessages(),setTimeout(()=>{document.getElementById(this.currentChatId+"-to-read-messages-count").style.display="none"},1e3)):this.showChatPlaceholder=!0})}sendMessage(){var r={creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,creator_email:this.generalService.currentUser.email,chat_id:this.currentChatId,createdAt:U.firestore.FieldValue.serverTimestamp(),message:document.getElementById("chat-message-input").value};U.firestore().collection("chat_messages").doc().set(r).then(()=>{document.getElementById("chat-message-input").value=""}).catch(i=>{this.generalService.presentToast("Errore durante l'invio del messaggio:"+i.message)})}deleteChat(){confirm("Sei sicuro di voler cancellare questa chat?")&&U.firestore().collection("chats").doc(this.currentChatId).delete().then(()=>{this.showChatPlaceholder=!0,this.generalService.presentToast("Chat eliminata con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'eliminazione della chat: "+r.message)})}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}getChatMessages(){return U.firestore().collection("chat_messages").orderBy("createdAt","desc").where("chat_id","==",this.currentChatId).limit(40).onSnapshot(r=>{let i=[];if(r.forEach(o=>{i.push(q({id:o.id},o.data()))}),r){var s=i.length>0?i[0]:null;s!=null&&localStorage.setItem(this.currentChatId+"-last-message-seconds-timestamp-check",s.createdAt.seconds)}i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i tuoi ticket: "+r.message)})}getMoreChatMessages(){!this.lastVisible||!this.nextPageAvailable||U.firestore().collection("chat_messages").orderBy("createdAt","desc").where("chat_id","==",this.currentChatId).startAfter(this.lastVisible).limit(40).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}deleteMessage(r){confirm("Sei sicuro di voler eliminare questo messaggio?")&&(document.getElementById("chat-message-id-"+r.id).innerHTML="Messaggio eliminato",U.firestore().collection("chat_messages").doc(r.id).delete().then(()=>{this.generalService.presentToast("Messaggio eliminato con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione del messaggio: "+i.message)}))}};e.\u0275fac=function(i){return new(i||e)(te(He),te(Fr),te(tt))},e.\u0275cmp=xe({type:e,selectors:[["app-chat"]],decls:2,vars:2,consts:[["style","height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; padding-left: 1rem; overflow-x: hidden; overflow-y: hidden;",4,"ngIf"],["style","height: 100%; display: flex; flex-direction: column; padding-left: 1rem; overflow-x: hidden; overflow-y: hidden;",4,"ngIf"],[2,"height","100%","display","flex","flex-direction","column","align-items","center","justify-content","center","padding-left","1rem","overflow-x","hidden","overflow-y","hidden"],[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],["style","color: #333; cursor: pointer;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"display","flex","flex-direction","column","gap","1rem","overflow-y","auto","height","calc(100% - 4rem)","padding-top","1rem"],["class","button",3,"click",4,"ngIf"],["id","chat-container",2,"display","flex","flex-direction","column","gap","1rem"],["class","chat-card","style","padding-top: 0.5rem;",3,"id",4,"ngFor","ngForOf"],[2,"height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem","margin-top","1rem","margin-right","1rem"],["id","chat-message-input","placeholder","Inserisci qui il tuo messaggio",2,"width","calc(100% - 3.5rem)","border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'",3,"keydown.enter"],[2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer",3,"click"],[1,"button",3,"click"],[1,"chat-card",2,"padding-top","0.5rem",3,"id"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.2rem"],[2,"flex","1"],["style","font-size: 1.5rem; color: #333; cursor: pointer;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0.2rem","margin-bottom","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer",3,"click"]],template:function(i,s){i&1&&Se(0,BZ,3,0,"div",0)(1,zZ,15,6,"div",1),i&2&&(ce("ngIf",s.showChatPlaceholder==!0),X(),ce("ngIf",s.showChatPlaceholder==!1))},dependencies:[hr,fr,pr]});let n=e;return n})();var ij=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.generalService.initNormalScreen()}};e.\u0275fac=function(i){return new(i||e)(te(He))},e.\u0275cmp=xe({type:e,selectors:[["app-company"]],decls:24,vars:0,consts:[[2,"height","100%","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[1,"card",2,"padding","1rem","margin-top","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"width","3rem"],[2,"max-width","80%"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","flex-wrap","wrap","gap","1rem"],["href","https://www.agenziaautoteam.it/i-nostri-servizi/","target","_blank",1,"a_button",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"width","2rem"],[2,"margin-top","0rem","margin-bottom","0rem","color","black"],["href","assets\\pdf\\Web app autoteam nuova presentazione.pdf","target","_blank",1,"a_button",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"div",1)(2,"div",2),Q(3,"img",3),w(4,"h3"),T(5,"L'azienda | Mission"),I()(),w(6,"p",4)(7,"strong"),T(8,"CI SONO MOLTE AGENZIE DI PRATICHE AUTO, INFINITE POSSIBILIT\xC0 PER AUTOMOBILISTI E ADDETTI AI LAVORI. CHE COSA RENDE AUTOTEAM DIVERSA E UNICA?"),I()(),w(9,"p"),T(10,"NON CI SONO RICETTE SEGRETE: TUTTO PARTE DALLA PRECISA VOLONT\xC0 DI COSTRUIRE SOLIDE RELAZIONI CON I CLIENTI. DIALOGO, ASSISTENZA, PRESENZA: IN OGNI FASE DEL LAVORO, IN OGNI OCCASIONE, PER QUALSIASI NECESSIT\xC0, AUTOTEAM C'\xC8. UN'AMPIA GAMMA DI SERVIZI E UNA COSTANTE FORMAZIONE DEI COLLABORATORI GARANTISCE TEMPESTIVIT\xC0 E QUALIT\xC0 DEI SERVIZI, METTENDO A DISPOSIZIONE DELLA CLIENTELA PERSONALE ALTAMENTE QUALIFICATO E, DAL PUNTO DI VISTA UMANO, PERSONE DISPOSTE AD ASCOLTARE E A TROVARE LA SOLUZIONE MIGLIORE PER OGNI TIPO DI ESIGENZA."),I(),w(11,"p"),T(12,"UN TEAM FUNZIONA SE ALLA BASE CI SONO VALORI SOLIDI ECONDIVISI. AGENZIA AUTOTEAM CREDE PROFONDAMENTE NEL PROPRIO GRUPPO: STIMA, FIDUCIA, RISPETTO PER I COLLABORATORI SONO LE FONDAMENTA SULLE QUALI SI BASA LA NOSTRA IDEA DI GRUPPO."),I(),w(13,"p"),T(14,"OGNUNO \xC8 IMPORTANTE, IL CONTRIBUTO DI TUTTI CONTRIBUISCE ALLA CRESCITA E AL SUCCESSO."),I(),w(15,"div",5)(16,"a",6),Q(17,"img",7),w(18,"p",8),T(19,"Sito Web | Servizi"),I()(),w(20,"a",9),Q(21,"img",7),w(22,"p",8),T(23,"Presentazione Web App"),I()()()()())}});let n=e;return n})();function GZ(n,e){if(n&1){let t=st();w(0,"span",11),H("click",function(){ze(t);let i=me();return Ge(i.deleteSector())}),T(1,"delete"),I()}}function WZ(n,e){if(n&1){let t=st();w(0,"span",24),H("click",function(){ze(t);let i=me().$implicit,s=me(2);return Ge(s.deleteSectorFolder(i))}),T(1,"delete"),I()}}function KZ(n,e){if(n&1){let t=st();w(0,"div",21),H("click",function(){let i=ze(t).$implicit,s=me(2);return Ge(s.openSectorFolder(i))}),w(1,"span",22),T(2,"folder"),I(),T(3),Se(4,WZ,2,0,"span",23),I()}if(n&2){let t=e.$implicit,r=me(2);X(3),$i(" ",t," "),X(),ce("ngIf",r.generalService.isAdmin==!0)}}function QZ(n,e){if(n&1&&(w(0,"div",18)(1,"h4",19),T(2,"Cartelle:"),I(),Se(3,KZ,5,2,"div",20),I()),n&2){let t=e.ngIf;X(3),ce("ngForOf",t)}}function YZ(n,e){if(n&1){let t=st();w(0,"span",34),H("click",function(){ze(t);let i=me().$implicit,s=me();return Ge(s.deleteProcedura(i))}),T(1,"delete"),I()}}function JZ(n,e){n&1&&(w(0,"span",39),T(1,"link"),I())}function XZ(n,e){n&1&&(w(0,"span",39),T(1,"picture_as_pdf"),I())}function ZZ(n,e){n&1&&(w(0,"span",39),T(1,"movie"),I())}function eee(n,e){n&1&&(w(0,"span",39),T(1,"movie"),I())}function tee(n,e){n&1&&(w(0,"span",39),T(1,"movie"),I())}function nee(n,e){n&1&&(w(0,"span",39),T(1,"volume_up"),I())}function ree(n,e){if(n&1&&(w(0,"a",35)(1,"div",36),Q(2,"img",37),Se(3,JZ,2,0,"span",38)(4,XZ,2,0,"span",38)(5,ZZ,2,0,"span",38)(6,eee,2,0,"span",38)(7,tee,2,0,"span",38)(8,nee,2,0,"span",38),T(9),I()()),n&2){let t=e.$implicit,r=me().$implicit;ce("href",r.links[t].link,yc),X(3),ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes(".com")),X(),ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("pdf")),X(),ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp4")),X(),ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mkv")),X(),ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("wmv")),X(),ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp3")),X(),$i(" ",r.links[t].label," ")}}function iee(n,e){n&1&&(w(0,"span",39),T(1,"picture_as_pdf"),I())}function see(n,e){n&1&&(w(0,"span",39),T(1,"movie"),I())}function oee(n,e){n&1&&(w(0,"span",39),T(1,"movie"),I())}function aee(n,e){n&1&&(w(0,"span",39),T(1,"movie"),I())}function cee(n,e){n&1&&(w(0,"span",39),T(1,"volume_up"),I())}function lee(n,e){if(n&1&&(w(0,"a",35)(1,"div",36)(2,"span",39),T(3,"draft"),I(),T(4," Download "),Se(5,iee,2,0,"span",38)(6,see,2,0,"span",38)(7,oee,2,0,"span",38)(8,aee,2,0,"span",38)(9,cee,2,0,"span",38),I()()),n&2){let t=me().$implicit;Ku("href",t.storage_resource_link,yc),X(5),ce("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("pdf")),X(),ce("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp4")),X(),ce("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mkv")),X(),ce("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("wmv")),X(),ce("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp3"))}}function uee(n,e){if(n&1&&(w(0,"div",25)(1,"h3",26),T(2),Q(3,"div",27),Se(4,YZ,2,0,"span",28),I(),w(5,"h4",29),T(6),I(),w(7,"p",30),T(8),I(),w(9,"div",31),Se(10,ree,10,8,"a",32)(11,lee,10,6,"a",33),I()()),n&2){let t=e.$implicit,r=me();wn("id","procedure-id-",t.id,""),X(2),EI(" ",t.creator_name," ",t.creator_surname," | ",t.creator_agency_name," | ",r.formatTimestamp(t.timestamp)," /",t.folder_name," "),X(2),ce("ngIf",r.generalService.isAdmin==!0||r.generalService.currentUser.uid==t.creator_uid),X(2),Ct(t.name),X(2),Ct(t.description),X(2),ce("ngForOf",r.getObjectKeys(t.links)),X(),ce("ngIf",t.storage_resource_link!="")}}function dee(n,e){if(n&1){let t=st();w(0,"button",7),H("click",function(){ze(t);let i=me();return Ge(i.getMoreSectorProcedures())}),T(1,"Recupera altre procedure"),I()}}var sj=(()=>{let e=class e{constructor(r,i,s){this.generalService=r,this.router=i,this.route=s,this.documents=new De([]),this.lastVisible="",this.nextPageAvailable=!0,this.matchingKeys$=new De([])}ngOnInit(){this.route.queryParams.subscribe(r=>{var i=r.sector_id,s=r.sector_name,o=r.sector_description;i==null&&this.router.navigate(["/chat"]),this.generalService.currentSectorId=i,document.getElementById("sector-name").innerText=s,document.getElementById("sector-description").innerText=o,this.getSectorProcedures(),this.getSectorFolders()})}getSectorProcedures(){return U.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).orderBy("timestamp","desc").where("folder_name","==","").limit(4).startAfter(this.lastVisible).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+r.message)})}getMoreSectorProcedures(){!this.lastVisible||!this.nextPageAvailable||U.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).orderBy("timestamp","desc").where("folder_name","==","").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}getSectorFolders(){this.matchingKeys$=new De([]),U.firestore().collection("sector_folders").doc("folders").get().then(r=>{if(r.exists){let i=r.data();if(this.matchingKeysUnfiltered=i,i){let s=[];for(let[o,a]of Object.entries(i))if(a===this.generalService.currentSectorId){let c=o.lastIndexOf("-"),l=c===-1?o:o.substring(0,c);s.push(l)}s.sort((o,a)=>o.localeCompare(a)),this.matchingKeys$.next(s),this.generalService.foldersNames}}else console.log("Documento non trovato!")}).catch(r=>{this.generalService.presentToast("Errore nel recuperare le cartelle di questo settore: "+r.message)})}closeAddNewProcedureFolderPopup(){document.getElementById("add-new-procedure-folder-popup").style.display="none"}addNewProcedureFolder(){let r=document.getElementById("add-procedure-folder-name-input");U.firestore().collection("sector_folders").doc("folders").set({[r.value+"-"+Date.now()]:this.generalService.currentSectorId},{merge:!0}).then(()=>{document.getElementById("add-new-procedure-folder-popup").style.display="none",this.getSectorFolders(),this.generalService.presentToast("Cartella aggiunta con successo")}).catch(i=>{this.generalService.presentToast("Errore durante la creazione della cartella: "+i.message)})}showAddProcedurePopup(){this.getSectorFolders(),this.generalService.linkObject={},this.generalService.linkCounter=0,this.fillFolderNameSelection(),document.getElementById("add-new-procedure-popup").style.display="flex"}fillFolderNameSelection(){let r=document.getElementById("add-procedure-folder-input");r.innerHTML='<option value="">SELEZIONA</option>',this.matchingKeys$.subscribe(i=>{i.forEach(s=>{let o=s.lastIndexOf("-"),a=o===-1?s:s.substring(0,o),c=document.createElement("option");c.value=a,c.textContent=a,r.appendChild(c)})})}showAddProcedureFolder(){document.getElementById("add-new-procedure-folder-popup").style.display="flex"}getObjectKeys(r){return Object.keys(r)}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}openSectorFolder(r){this.documents=new De([]),U.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).where("folder_name","==",r).orderBy("timestamp","desc").startAfter(this.lastVisible).get().then(i=>{let s=[];if(i.forEach(o=>{s.push(q({id:o.id},o.data()))}),s.length>0){let a=[...this.documents.getValue(),...s];this.documents.next(a),s.length===4?this.lastVisible=i.docs[i.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(i=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+i.message),this.nextPageAvailable=!1})}deleteProcedura(r){confirm("Sei sicuro di voler cancellare questa procedura e tutti i suoi allegati?")&&(document.getElementById("procedure-id-"+r.id).innerHTML="Procedura eliminata",U.firestore().collection("procedure").doc(r.id).delete().then(()=>{if(r.storage_resource_path!=""){let i=Na(U.storage(),r.storage_resource_path);ey(i).then(()=>{this.generalService.presentToast("La procedura e i relativi allegati sono stati eliminati con successo")}).catch(s=>{this.generalService.presentToast("Errore durante l'eliminazione della procedura: 'DELETE FILE ERROR' "+s.message)}).catch(s=>{this.generalService.presentToast("Errore durante l'eliminazione della procedura: 'DELETE DOC ERROR' "+s.message)})}else this.generalService.presentToast("La procedura e i relativi allegati sono stati eliminati con successo")}))}deleteSector(){confirm("Sei sicuro di voler cancellare questo settore?")&&U.firestore().collection("settori").doc(this.generalService.currentSectorId).delete().then(()=>{this.generalService.presentToast("Settore cancellato con successo")}).catch(r=>{this.generalService.presentToast("Errore durante la cancellazione del settore: "+r.message)})}deleteSectorFolder(r){if(confirm("Sei sicuro di voler cancellare questa cartella?")){let s=Object.keys(this.matchingKeysUnfiltered).find(o=>o.includes(r));if(!s){this.generalService.presentToast("Nessuna cartella corrispondente trovata");return}console.log(`Chiave da eliminare: ${s}`),U.firestore().collection("sector_folders").doc("folders").update({[s]:U.firestore.FieldValue.delete()}).then(()=>{this.getSectorFolders(),this.generalService.presentToast("Cartella eliminata con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'eliminazione della cartella: "+o.message)})}}};e.\u0275fac=function(i){return new(i||e)(te(He),te(tt),te(Fr))},e.\u0275cmp=xe({type:e,selectors:[["app-settori"]],decls:34,vars:8,consts:[["id","add-new-procedure-folder-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","30rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","space-between"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","black","cursor","pointer",3,"click"],[2,"width","100%","display","flex","flex-direction","row","flex-wrap","wrap","gap","1rem"],[2,"flex","1","min-width","15rem","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-procedure-folder-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],[1,"button",3,"click"],[2,"height","100%","overflow-y","auto","overflow-x","hidden","display","flex","flex-direction","column","padding-left","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.5rem","cursor","pointer","flex-wrap","wrap",3,"click"],["id","sector-name"],[1,"material-symbols-outlined","notranslate",2,"color","black","cursor","pointer","font-size","1.8rem",3,"click"],["style","color: black; cursor: pointer; font-size: 1.8rem;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],["id","sector-description",2,"margin-top","0rem"],["style","margin-bottom: 1rem;",4,"ngIf"],["id","procedure",2,"display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["class","card","style","padding-left: 1rem; padding-right: 1rem; padding-bottom: 1rem;",3,"id",4,"ngFor","ngForOf"],["class","button",3,"click",4,"ngIf"],[2,"margin-bottom","1rem"],[2,"margin-bottom","0.5rem"],["style","display: flex; flex-direction: row; align-items: center; gap: 0.5rem; cursor: pointer;",3,"click",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","cursor","pointer",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem"],["style","color: #333; font-size: 1.5rem;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem",3,"click"],[1,"card",2,"padding-left","1rem","padding-right","1rem","padding-bottom","1rem",3,"id"],[2,"margin-bottom","0.5rem","display","flex","flex-direction","row","align-items","center"],[2,"flex","1"],["style","font-size: 1.5rem; color: #333; cursor: pointer;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0rem","margin-bottom","0rem"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngFor","ngForOf"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer",3,"click"],["target","_blank",2,"text-decoration","none",3,"href"],[1,"card",2,"height","2.5rem","display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem","padding-left","0.5rem","padding-right","0.5rem","border-radius","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"height","2rem","width","2rem"],["style","color: #313131; font-size: 1.8rem;","class","material-symbols-outlined notranslate",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"color","#313131","font-size","1.8rem"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"div",1)(2,"h3",2),T(3,"Nuova cartella"),w(4,"span",3),H("click",function(){return s.closeAddNewProcedureFolderPopup()}),T(5,"close"),I()(),w(6,"div",4)(7,"div",5),Q(8,"input",6),I()(),w(9,"div",2)(10,"button",7),H("click",function(){return s.closeAddNewProcedureFolderPopup()}),T(11,"Annulla"),I(),w(12,"button",7),H("click",function(){return s.addNewProcedureFolder()}),T(13,"Conferma"),I()()()(),w(14,"div",8)(15,"h2",9),H("click",function(){return s.getSectorProcedures()}),Q(16,"span",10),T(17," | "),w(18,"span",11),H("click",function(){return s.showAddProcedurePopup()}),T(19,"add_notes"),I(),Q(20,"span",10),T(21," | "),w(22,"span",11),H("click",function(){return s.showAddProcedureFolder()}),T(23,"create_new_folder"),I(),Q(24,"span",10),T(25," | "),Se(26,GZ,2,0,"span",12),I(),Q(27,"p",13),Se(28,QZ,4,1,"div",14),Un(29,"async"),w(30,"div",15),Se(31,uee,12,12,"div",16),Un(32,"async"),Se(33,dee,2,0,"button",17),I()()),i&2&&(X(26),ce("ngIf",s.generalService.isAdmin==!0),X(2),ce("ngIf",Bn(29,4,s.matchingKeys$)),X(3),ce("ngForOf",Bn(32,6,s.documents)),X(2),ce("ngIf",s.nextPageAvailable))},dependencies:[hr,fr,pr]});let n=e;return n})();var oj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.generalService.initNormalScreen()}};e.\u0275fac=function(i){return new(i||e)(te(He))},e.\u0275cmp=xe({type:e,selectors:[["app-home"]],decls:1,vars:0,consts:[[2,"height","100%","padding-left","1rem","display","flex","flex-direction","row","flex-wrap","wrap"]],template:function(i,s){i&1&&Q(0,"div",0)}});let n=e;return n})();function hee(n,e){if(n&1){let t=st();w(0,"span",28),H("click",function(){ze(t);let i=me().$implicit,s=me();return Ge(s.openTicketMenuPopup(i))}),T(1,"more_vert"),I()}}function fee(n,e){n&1&&(w(0,"span"),T(1,"Aperto"),I())}function pee(n,e){n&1&&(w(0,"span"),T(1,"Chiuso"),I())}function mee(n,e){if(n&1){let t=st();w(0,"div",12)(1,"div",13)(2,"span",14),T(3,"account_circle"),I(),w(4,"p"),T(5),I(),Q(6,"div",11),Se(7,hee,2,0,"span",15),I(),w(8,"h3",16),T(9),Se(10,fee,2,0,"span",17)(11,pee,2,0,"span",17),I(),w(12,"p",18),T(13),I(),w(14,"div",19)(15,"div",20)(16,"div",21)(17,"span",22),T(18,"forum"),I(),w(19,"input",23),H("keydown.enter",function(){let i=ze(t).$implicit,s=me();return Ge(s.addComment(i))}),I()(),w(20,"button",24),H("click",function(){let i=ze(t).$implicit,s=me();return Ge(s.addComment(i))}),w(21,"span",25),T(22,"send"),I()()(),w(23,"p",26),H("click",function(){let i=ze(t).$implicit,s=me();return Ge(s.getComments(i))}),w(24,"span",25),T(25,"keyboard_arrow_down"),I(),T(26,"Vedi risposte"),I(),Q(27,"div",27),I()()}if(n&2){let t=e.$implicit,r=me();wn("id","ticket-id-",t.id,""),X(5),II("",t.name," ",t.surname," | ",r.convertTimestampToDate(t.timestamp.seconds)," | ",t.agencyName,""),X(2),ce("ngIf",r.generalService.isAdmin==!0||r.generalService.currentUser.uid==t.creator_id),X(2),$i("",t.argomento," | "),X(),ce("ngIf",t.status=="open"),X(),ce("ngIf",t.status=="close"),X(2),Ct(t.descrizione),X(6),wn("id","comment-input-",t.id,""),X(8),wn("id","comment-section-",t.id,"")}}function gee(n,e){if(n&1){let t=st();w(0,"button",29),H("click",function(){ze(t);let i=me();return Ge(i.getMoreTickets())}),T(1,"Recupera altri ticket"),I()}}var aj=(()=>{let e=class e{constructor(r){this.generalService=r,this.alredySavedMoreRecentOpenTicket=!1,this.documents=new De([]),this.nextPageAvailable=!1,this.comments=new De([])}ngOnInit(){this.generalService.initNormalScreen(),this.getOpenTickets(),this.setAllTicketsRead()}setAllTicketsRead(){return g(this,null,function*(){let r=rs(U.firestore(),"tickets"),i=yield j_(r);localStorage.setItem("last-ticket-count",i.data().count+""),this.generalService.ticketToRead=!1,localStorage.setItem("last-ticket-timestamp",Date.now()+""),document.getElementById("ticket-to-read-sidebar-container").style.display="none"})}openAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="flex"}openTicketMenuPopup(r){this.generalService.currentTicket=r,document.getElementById("edit-menu-ticket-popup").style.display="flex",r.status=="open"&&(document.getElementById("open-ticket-button").style.display="none",document.getElementById("close-ticket-button").style.display="flex"),r.status=="close"&&(document.getElementById("open-ticket-button").style.display="flex",document.getElementById("close-ticket-button").style.display="none")}showCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="flex"}hideCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="none"}addComment(r){var i=U.auth().currentUser;let s=document.getElementById("comment-input-"+r.id),o=s.value;o.trim()&&(U.database().ref("/comments/"+r.id+"/").push({text:o,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,timestamp:U.database.ServerValue.TIMESTAMP,creator_uid:i.uid}),s.value="",this.getComments(r))}getComments(r){let i=document.getElementById("comment-section-"+r.id);i.innerHTML="",i.style.display=="none"?U.database().ref(`/comments/${r.id}/`).once("value").then(s=>{s.forEach(a=>{let c=a.key,l=a.val(),d=document.getElementById("comment-section-"+r.id),h=document.createElement("div");h.className="comment";let p=document.createElement("p");p.style.marginBottom="0.5rem",p.textContent=l.name+" "+l.surname+" | "+l.agencyName+" | "+this.convertTimestamp(l.timestamp);let _=document.createElement("p");_.style.marginBottom="0.5rem",_.textContent=l.text,h.appendChild(p),h.appendChild(_),d.appendChild(h)});let o=document.getElementById("comment-section-"+r.id);o&&(o.style.display="flex")}).catch(s=>{console.error("Errore durante il recupero dei commenti:",s)}):i.style.display="none"}convertTimestampToDate(r){let i=new Date(r*1e3),s=String(i.getDate()).padStart(2,"0"),o=String(i.getMonth()+1).padStart(2,"0"),a=i.getFullYear(),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0"),d=String(i.getSeconds()).padStart(2,"0");return`${s}-${o}-${a} ${c}:${l}:${d}`}convertTimestamp(r){let s=new Date(r).toISOString(),[o,a]=s.split("T"),[c,l,d]=o.split("-"),[h]=a.split(".");return`${d}/${l}/${c} ${h}`}getTickets(){return U.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{console.error("Error getting documents: ",r)})}getOpenTickets(){return this.alredySavedMoreRecentOpenTicket=!1,U.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","open").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data())),this.alredySavedMoreRecentOpenTicket!=!0&&(this.alredySavedMoreRecentOpenTicket=!0,localStorage.setItem("last-ticket-timestamp",s.data().timestamp.seconds*1e3+""))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket aperti: "+r.message)})}getClosedTickets(){return U.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","close").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket chiusi: "+r.message)})}getMyTickets(){var r=U.auth().currentUser;return U.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("creator_id","==",r.uid).onSnapshot(i=>{let s=[];i.forEach(o=>{s.push(q({id:o.id},o.data()))}),s.length===4?(this.lastVisible=i.docs[i.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(s)},i=>{this.generalService.presentToast("Errore nel recuperare i tuoi ticket: "+i.message)})}getMoreTickets(){!this.lastVisible||!this.nextPageAvailable||U.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}};e.\u0275fac=function(i){return new(i||e)(te(He))},e.\u0275cmp=xe({type:e,selectors:[["app-tickets"]],decls:24,vars:4,consts:[[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","flex-wrap","wrap"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","black","font-size","1.8rem","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","border","1px solid rgba(0, 0, 0, 0.192)","border-radius","2rem","padding-left","1rem","padding-right","1rem","height","2.5rem","overflow-y","hidden","overflow-x","auto"],[2,"cursor","pointer",3,"click"],[2,"height","100%","width","1px","background","rgba(0, 0, 0, 0.192)"],[2,"overflow-y","auto","overflow-x","hidden","padding-bottom","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","card","style","padding-left: 1rem; padding-bottom: 1rem;",3,"id",4,"ngFor","ngForOf"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],[2,"flex","1"],[1,"card",2,"padding-left","1rem","padding-bottom","1rem",3,"id"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","padding-right","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem"],["style","color: #333; cursor: pointer; font-size: 1.8rem;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0rem","margin-bottom","0rem"],[4,"ngIf"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","column","align-items","center","padding-right","1rem"],[2,"width","100%","height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem"],[1,"input-group",2,"width","calc(100% - 3.5rem)"],[1,"material-symbols-outlined","notranslate"],["type","text","placeholder","Scrivi un commento",1,"input",3,"keydown.enter","id"],[2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[2,"cursor","pointer","display","flex","flex-direction","row","align-items","center","width","100%",3,"click"],[2,"display","none","flex-direction","column","gap","1rem","width","100%",3,"id"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem",3,"click"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"div",1)(2,"h2",2),T(3,"Tickets"),w(4,"span",3),H("click",function(){return s.openAddTicketPopup()}),T(5,"add_circle"),I()(),w(6,"div",4)(7,"h3",5),H("click",function(){return s.getOpenTickets()}),T(8,"Aperti"),I(),Q(9,"div",6),w(10,"h3",5),H("click",function(){return s.getClosedTickets()}),T(11,"Chiusi"),I(),Q(12,"div",6),w(13,"h3",5),H("click",function(){return s.getTickets()}),T(14,"Tutti"),I(),Q(15,"div",6),w(16,"h3",5),H("click",function(){return s.getMyTickets()}),T(17,"Pubblicati da me"),I()()(),w(18,"div",7)(19,"div",8),Se(20,mee,28,15,"div",9),Un(21,"async"),Se(22,gee,2,0,"button",10),I()(),Q(23,"div",11),I()),i&2&&(X(20),ce("ngForOf",Bn(21,2,s.documents)),X(2),ce("ngIf",s.nextPageAvailable))},dependencies:[hr,fr,pr]});let n=e;return n})();var cj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=xe({type:e,selectors:[["app-zoom"]],decls:26,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-y","auto","overflow-x","hidden","padding-left","1rem","padding-right","1rem"],[1,"card",2,"margin-top","1rem","padding-left","1rem","padding-bottom","1rem"],[2,"width","100%","display","flex","flex-direction","column","gap","0.5rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem"],[2,"color","#333","margin-top","0rem","margin-bottom","0rem"],["href","https://zoom.us/it/signin#/login","target","_blank",2,"color","#333","margin-top","0rem","margin-bottom","0rem"],[2,"color","#333","text-decoration","underline","margin-top","0rem","margin-bottom","0rem"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"div",1)(2,"h3"),T(3,"Chiamata Zoom"),I(),w(4,"div",2)(5,"div",3)(6,"span",4),T(7,"link"),I(),w(8,"p",5),T(9,"Link:"),I(),w(10,"a",6),T(11,"https://zoom.us/it/signin#/login"),I()(),w(12,"div",3)(13,"span",4),T(14,"person"),I(),w(15,"p",5),T(16,"Nome Utente:"),I(),w(17,"p",7),T(18,"erika.c@agenziaautoteam.it"),I()(),w(19,"div",3)(20,"span",4),T(21,"key"),I(),w(22,"p",5),T(23,"Password:"),I(),w(24,"p",7),T(25,"Autoteam2022"),I()()()()())}});let n=e;return n})();function _ee(n,e){n&1&&(w(0,"span",7),T(1,"add_circle"),I())}function yee(n,e){if(n&1){let t=st();w(0,"span",16),H("click",function(){ze(t);let i=me().$implicit,s=me();return Ge(s.deleteLink(i))}),T(1,"delete"),I()}}function vee(n,e){if(n&1&&(w(0,"div",8)(1,"p",9)(2,"span",10),T(3,"description"),I(),w(4,"strong"),T(5,"Nome: "),I(),Q(6,"span",11),Se(7,yee,2,0,"span",12),I(),w(8,"p",13),T(9),I(),w(10,"p",9)(11,"span",10),T(12,"format_list_bulleted"),I(),w(13,"strong"),T(14,"Descrizione: "),I()(),w(15,"p",13),T(16),I(),w(17,"p",14)(18,"span",10),T(19,"link"),I(),w(20,"strong"),T(21,"Url: "),I()(),w(22,"a",15),T(23),I()()),n&2){let t=e.$implicit,r=me();X(7),ce("ngIf",r.generalService.isAdmin==!0),X(2),Ct(t.name),X(7),Ct(t.description),X(6),Ku("href",t.url,yc),X(),Ct(t.url)}}function wee(n,e){if(n&1){let t=st();w(0,"button",17),H("click",function(){ze(t);let i=me();return Ge(i.getMoreUsefulLinks())}),T(1,"Recupera altri link utili"),I()}}var lj=(()=>{let e=class e{ngOnInit(){this.getUsefulLinks()}constructor(r){this.generalService=r,this.documents=new De([]),this.nextPageAvailable=!1}getUsefulLinks(){return U.firestore().collection("useful_links").orderBy("timestamp","desc").limit(4).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{console.error("Error getting documents: ",r)})}getMoreUsefulLinks(){!this.lastVisible||!this.nextPageAvailable||U.firestore().collection("useful_links").orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}deleteLink(r){confirm("Sei sicuro di voler cancellare questo link?")&&U.firestore().collection("useful_links").doc(r.id).delete().then(()=>{this.generalService.presentToast("Link cancellato con successo")}).catch(i=>{this.generalService.presentToast("Errore durante la cancellazione del link: "+i.message)})}};e.\u0275fac=function(i){return new(i||e)(te(He))},e.\u0275cmp=xe({type:e,selectors:[["app-links"]],decls:9,vars:5,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-y","auto","overflow-x","hidden","padding-left","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],["onclick","document.getElementById('add-new-useful-link-popup').style.display = 'flex'; ","style","color: black; font-size: 1.8rem; cursor: pointer;","class","material-symbols-outlined notranslate",4,"ngIf"],[2,"overflow-y","auto","overflow-x","hidden","padding-bottom","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","card","style","padding-left: 1rem; padding-right: 1rem; padding-bottom: 1rem;",4,"ngFor","ngForOf"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],["onclick","document.getElementById('add-new-useful-link-popup').style.display = 'flex'; ",1,"material-symbols-outlined","notranslate",2,"color","black","font-size","1.8rem","cursor","pointer"],[1,"card",2,"padding-left","1rem","padding-right","1rem","padding-bottom","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.3rem"],[1,"material-symbols-outlined","notranslate",2,"color","#313131","font-size","1.5rem"],[2,"flex","1"],["style","font-size: 1.5rem; color: #333; cursor: pointer; display: flex;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.2rem"],["target","_blank",2,"overflow-wrap","break-word","margin-top","0rem",3,"href"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer","display","flex",3,"click"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"h2",1),T(2,"Link utili "),Se(3,_ee,2,0,"span",2),I(),w(4,"div",3)(5,"div",4),Se(6,vee,24,5,"div",5),Un(7,"async"),Se(8,wee,2,0,"button",6),I()()()),i&2&&(X(3),ce("ngIf",s.generalService.isAdmin==!0),X(3),ce("ngForOf",Bn(7,3,s.documents)),X(2),ce("ngIf",s.nextPageAvailable))},dependencies:[hr,fr,pr]});let n=e;return n})();var uj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){}changePassword(){let r=document.getElementById("change-password-email-input").value;U.auth().sendPasswordResetEmail(r).then(()=>{document.getElementById("change-password-email-input").value="",this.generalService.presentToast("Link per il cambio password inviato con successo, controlla la tua casella di posta ("+r+")")}).catch(i=>{this.generalService.presentToast("Errore nell'inviare l'email per il cambio password: "+i.message)})}};e.\u0275fac=function(i){return new(i||e)(te(He))},e.\u0275cmp=xe({type:e,selectors:[["app-change-password"]],decls:12,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],[2,"width","100%","margin-top","0.5rem"],[2,"margin-top","0rem"],[1,"input-group"],[1,"material-symbols-outlined","notranslate",2,"color","#333"],["id","change-password-email-input","type","text","placeholder","Email",1,"input"],[1,"button",2,"margin-top","1rem",3,"click"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"h2",1),T(2,"Cambio password"),I(),w(3,"div",2)(4,"p",3),T(5,"Inserisci qui il tuo indirizzo email per ricevere un link per cambiare la tua password"),I(),w(6,"div",4)(7,"span",5),T(8,"mail"),I(),Q(9,"input",6),I(),w(10,"button",7),H("click",function(){return s.changePassword()}),T(11,"Conferma"),I()()())}});let n=e;return n})();function Iee(n,e){n&1&&(w(0,"div",4)(1,"h4",5),T(2,"Admin"),I(),w(3,"a",6),T(4,"Vai a utenti e permessi"),I()())}var dj=(()=>{let e=class e{ngOnInit(){}constructor(r){this.generalService=r}};e.\u0275fac=function(i){return new(i||e)(te(He))},e.\u0275cmp=xe({type:e,selectors:[["app-settings"]],decls:8,vars:1,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],["class","admin-elements",4,"ngIf"],["routerLink","/change-password",1,"a1",2,"margin-top","0.5rem"],[1,"admin-elements"],[2,"margin-bottom","0.5rem"],["href","assets\\settings\\permission-manager.html",1,"a1",2,"margin-top","0rem"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"h2",1),T(2,"Impostazioni"),I(),Se(3,Iee,5,0,"div",2),w(4,"h4",1),T(5,"Il mio account"),I(),w(6,"a",3),T(7,"Cambio password"),I()()),i&2&&(X(3),ce("ngIf",s.generalService.isAdmin))},dependencies:[fr,Pc]});let n=e;return n})();function Eee(n,e){if(n&1){let t=st();w(0,"tr",6)(1,"td",8),T(2),I(),w(3,"td",8),T(4),I(),w(5,"td",8),T(6),I(),w(7,"td",8)(8,"select",11),H("change",function(){let i=ze(t).$implicit,s=me();return Ge(s.changeUserPermission(i))}),Q(9,"option",12),w(10,"option",13),T(11,"Nessuno"),I(),w(12,"option",14),T(13,"Normale"),I(),w(14,"option",15),T(15,"Admin"),I()()(),w(16,"td",8),T(17),I(),w(18,"td",8),T(19),I(),w(20,"td",8)(21,"div",16)(22,"span",17),H("click",function(){let i=ze(t).$implicit,s=me();return Ge(s.deleteUser(i))}),T(23,"delete"),I()()()()}if(n&2){let t=e.$implicit,r=me();X(2),vI("",t.name," ",t.surname,""),X(2),Ct(t.email),X(2),Ct(t.agencyName),X(2),wn("id","change-permission-type-input-",t.uid,""),X(9),Ct(r.formatFirebaseTimestamp(t.registration_date)),X(2),Ct(t.id)}}var hj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.getUsersList(),setTimeout(()=>{this.getUserPermission()},2e3)}formatFirebaseTimestamp(r){let i=new Date(r.seconds*1e3+r.nanoseconds/1e6),s={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"};return i.toLocaleString("it-IT",s)}getUsersList(){this.users=new je(r=>Lh(rs(U.firestore(),"users_data"),s=>{let o=s.docs.map(a=>q({id:a.id},a.data()));r.next(o)},s=>{r.error(s)}))}getUserPermission(){U.firestore().collection("settings").doc("users_permissions").get().then(r=>{if(r.exists){let i=r.data();Object.entries(i).forEach(([s,o])=>{console.log(`Tag: ${s}, Valore: ${o}`),document.getElementById("change-permission-type-input-"+s).value=o})}else console.log("Documento non trovato.")}).catch(r=>{console.log("Errore nel recupero delle autorizzazioni:",r)})}changeUserPermission(r){let i=document.getElementById("change-permission-type-input-"+r.uid);confirm("Sei sicuro di voler modificare i permessi attribuiti a: "+r.email+"?")?i.value!=""&&U.firestore().collection("settings").doc("users_permissions").set({[r.uid]:i.value},{merge:!0}).then(()=>{alert("I permessi dell'utente: "+r.email+" sono stati modificati con successo")}).catch(s=>{alert("Errore durante la modifica dei permessi per questo utente: "+s.message)}):i.value=""}deleteUser(r){confirm("Sei sicuro di voler eliminare e di azzerare tutti i permessi per questo utente?")&&U.firestore().collection("users_data").doc(r.id).delete().then(()=>{U.firestore().collection("settings").doc("users_permissions").set({[r.uid]:"none"},{merge:!0}).catch(i=>{this.generalService.presentToast("Errore durante la modifica dei permessi per questo utente: "+i.message)}),this.generalService.presentToast("Utente e relativi permessi eliminati con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione dell'utente: "+i.message)})}};e.\u0275fac=function(i){return new(i||e)(te(He))},e.\u0275cmp=xe({type:e,selectors:[["app-admin"]],decls:26,vars:3,consts:[["id","settings-popup",2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],[2,"margin-top","0.5rem"],[2,"width","100%","overflow-x","auto","overflow-y","auto","border-radius","0.5rem"],[1,"table"],[1,"table-header"],[1,"table-row"],[1,"table-cell",2,"min-width","12rem"],[1,"table-cell"],[1,"table-body"],["class","table-row",4,"ngFor","ngForOf"],[3,"change","id"],["value",""],["value","none"],["value","normal"],["value","admin"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","1rem"],[1,"material-symbols-outlined","notranslate","table-button",3,"click"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"h2",1),T(2,"Impostazioni"),I(),w(3,"p",2),T(4,"Utenti e permessi"),I(),w(5,"div",3)(6,"table",4)(7,"thead",5)(8,"tr",6)(9,"th",7),T(10,"Nome e Cognome"),I(),w(11,"th",8),T(12,"Email"),I(),w(13,"th",8),T(14,"Agenzia"),I(),w(15,"th",8),T(16,"Permessi"),I(),w(17,"th",7),T(18,"Data Registrazione"),I(),w(19,"th",8),T(20,"ID"),I(),w(21,"th",8),T(22,"Azioni"),I()()(),w(23,"tbody",9),Se(24,Eee,24,8,"tr",10),Un(25,"async"),I()()()()),i&2&&(X(24),ce("ngForOf",Bn(25,1,s.users)))},dependencies:[hr,au,cu,pr]});let n=e;return n})();var bee=[{path:"",redirectTo:"chat",pathMatch:"full"},{path:"log",component:GB},{path:"login",component:WB},{path:"register",component:nj},{path:"company",component:ij},{path:"chat",component:rj},{path:"procedure",component:sj},{path:"home",component:oj},{path:"tickets",component:aj},{path:"zoom",component:cj},{path:"links",component:lj},{path:"change-password",component:uj},{path:"settings",component:dj},{path:"settings/admin",component:hj}],fj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ln({type:e}),e.\u0275inj=Fn({imports:[LE.forRoot(bee),LE]});let n=e;return n})();function Cee(n,e){if(n&1){let t=st();w(0,"button",11),H("click",function(){let i=ze(t).$implicit,s=me();return s.goToRoute("chat","close-sidebar"),Ge(s.openChat(i))}),w(1,"span",12),T(2,"message"),I(),T(3),Q(4,"div",16),w(5,"div",18),Q(6,"span",19),I()()}if(n&2){let t=e.$implicit;X(3),$i(" ",t.name," "),X(2),wn("id","",t.id,"-to-read-messages-count"),X(),wn("id","",t.id,"-to-read-messages-count-display")}}function Tee(n,e){if(n&1){let t=st();w(0,"button",11),H("click",function(){let i=ze(t).$implicit,s=me();return s.goToRoute("settori","close-sidebar"),Ge(s.showSectorProcedures(i))}),w(1,"span",12),T(2,"library_books"),I(),T(3),I()}if(n&2){let t=e.$implicit;X(3),Ct(t.name)}}var pj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.chatDocuments=new De([]),this.documents=new De([]),this.chats=new De([]),this.count=0}ngOnInit(){document.addEventListener("DOMContentLoaded",()=>{this.syncWithChatsCollectionChanges(),this.syncWithNewTickets()})}syncWithNewTickets(){U.firestore().collection("tickets").limit(1).onSnapshot(r=>{r.docChanges().forEach(i=>{(i.type==="added"||i.type==="modified")&&(console.log("Nuovo ticket"),this.checkForNewTickets())})})}goToRoute(r,i){this.closeSidebarMobile(),this.router.navigate(["/"+r])}closeSidebarMobile(){window.innerWidth<=899&&(document.getElementById("sidebar-container").style.display="none")}openChat(r){this.router.navigate(["/chat"],{queryParams:{id:r.id,name:r.name}})}newChat(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-chat-popup").style.display="flex"}newSector(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-sector-popup").style.display="flex"}hideOrShowSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}logout(){window.confirm("Sei sicuro di volerti disconnettere?")&&U.auth().signOut().then(()=>{this.generalService.presentToast("Disconnessione effettuata con successo"),this.router.navigate(["/log"])}).catch(r=>{this.generalService.presentToast("Errore durante la disconnessione: "+r.message)})}showSectorProcedures(r){this.router.navigate(["/procedure"],{queryParams:{sector_id:r.id,sector_name:r.name,sector_description:r.description}})}openCloseSettoriEProcedure(){let r=document.getElementById("settori-menu-container"),i=document.getElementById("open-menu-icon1");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):U.firestore().collection("settori").orderBy("name_query").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(q({id:a.id},a.data()))}),this.documents.next(o),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero dei settori: "+s.message)})}checkForNewTickets(){return g(this,null,function*(){let r=rs(U.firestore(),"tickets"),i=qr(r,U_("status","==","close")),s=yield j_(i);s.data().count!=0&&(document.getElementById("open-tickets-counter-container").style.display="flex",document.getElementById("open-tickets-sidebar-display").innerText=s.data().count+""),U.firestore().collection("tickets").orderBy("timestamp","desc").limit(1).get().then(o=>{o.forEach(a=>{var c=a.data().timestamp;console.log("Pi\xF9 recente: "+c.seconds*1e3),console.log("Ultimo memorizzato: "+localStorage.getItem("last-ticket-timestamp")),Number(localStorage.getItem("last-ticket-timestamp"))<c.seconds*1e3?(document.getElementById("ticket-to-read-sidebar-container").style.display="flex",this.generalService.ticketToRead=!0):document.getElementById("ticket-to-read-sidebar-container").style.display="none"})}).catch(o=>{console.log("Error getting more recent tickt timestamp:",o)})})}syncWithChatsCollectionChanges(){U.firestore().collection("chat_messages").limit(1).orderBy("createdAt","desc").onSnapshot(r=>{r.docChanges().forEach(i=>{U.auth().onAuthStateChanged(s=>{i.doc.data().creator_uid!=s.uid&&(document.getElementById("chats-menu-container").style.display="none",Notification.permission==="granted"?this.showChatMessageNotification(i.doc.data()):Notification.permission!=="denied"&&Notification.requestPermission().then(o=>{o==="granted"&&this.showChatMessageNotification(i.doc.data())})),this.openCloseChats(),console.log("chat messages update done")})})},r=>{console.error("Errore nel monitoraggio delle modifiche: ",r)})}showChatMessageNotification(r){let i=new Notification("AutoTeam | Nuovo Messaggio",{body:r.creator_name+" "+r.creator_surname+" | "+r.message,icon:"icon.png"});i.onclick=function(){window.open("https://serviziautoteam.it/app/#/chat?id="+r.chat_id)}}openCloseChats(){let r=document.getElementById("chats-menu-container"),i=document.getElementById("open-menu-icon2");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):U.firestore().collection("chats").orderBy("name_query").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(q({id:a.id},a.data())),this.checkForNewMessages(a.id)}),this.chats.next(o),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero delle chat: "+s.message)})}checkForNewMessages(r){return g(this,null,function*(){var i=yield this.getRecentDocumentTimestamp(r);if(i!="no_messages"){var s=i.seconds*1e3,o=Number(localStorage.getItem(r+"-last-message-seconds-timestamp-check"))*1e3;o?o<s?(console.log("Hai messaggi nuovi da leggere per la chat: "+r),document.getElementById(r+"-to-read-messages-count").style.display="flex"):document.getElementById(r+"-to-read-messages-count").style.display="none":(console.log("L'utente non ha mai controllato questa chat: "+r),document.getElementById(r+"-to-read-messages-count").style.display="flex")}})}getRecentDocumentTimestamp(r){return g(this,null,function*(){try{let s=yield U.firestore().collection("chat_messages").where("chat_id","==",r).orderBy("createdAt","desc").limit(1).get();return s.empty?"no_messages":s.docs[0].data().createdAt}catch(i){this.generalService.presentToast("Errore durante il controllo per i nuovi messaggi: "+i.message)}})}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}};e.\u0275fac=function(i){return new(i||e)(te(He),te(tt))},e.\u0275cmp=xe({type:e,selectors:[["app-sidebar"]],decls:51,vars:6,consts:[["id","sidebar-container",2,"display","flex","height","100%"],["id","sidebar",1,"desktop-element",2,"display","flex","flex-direction","column","width","18rem","flex-shrink","0","height","calc(100% - 3.5rem)","background","white","border-right","1px solid rgba(0, 0, 0, 0.192)","overflow-y","auto","overflow-x","hidden"],["src","assets\\imgs\\logo.png",2,"width","100%","margin-top","1rem"],[1,"sidebar-button",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","open-tickets-counter-container",2,"background","rgb(247, 150, 32)","border-radius","50%","width","1.8rem","height","1.8rem","display","none","align-items","center","justify-content","center"],["id","open-tickets-sidebar-display",2,"color","white"],["id","ticket-to-read-sidebar-container",2,"background","red","border-radius","50%","width","1.8rem","height","1.8rem","display","none","align-items","center","justify-content","center"],[1,"material-symbols-outlined","notranslate",2,"color","white","font-size","1.4rem"],["id","open-menu-icon2",1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","chats-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem"],[1,"sidebar-button",2,"width","100%",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.8rem"],["class","sidebar-button","style","width: 100%;",3,"click",4,"ngFor","ngForOf"],["id","open-menu-icon1",1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","settori-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem"],[2,"flex","1"],[1,"sidebar-button",2,"margin-bottom","1rem",3,"click"],[2,"display","none","background","red","border-radius","50%","width","1rem","height","1rem",3,"id"],[2,"color","white",3,"id"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"div",1),Q(2,"img",2),w(3,"button",3),H("click",function(){return s.goToRoute("company","close-sidebar")}),w(4,"span",4),T(5,"apartment"),I(),T(6,"L'azienda"),I(),w(7,"button",3),H("click",function(){return s.goToRoute("tickets","close-sidebar")}),w(8,"span",4),T(9,"style"),I(),T(10,"Tickets "),w(11,"div",5),Q(12,"span",6),I(),w(13,"div",7)(14,"span",8),T(15,"mark_email_unread"),I()()(),w(16,"button",3),H("click",function(){return s.openCloseChats()}),w(17,"span",9),T(18,"keyboard_arrow_down"),I(),T(19,"Chat"),I(),w(20,"div",10)(21,"button",11),H("click",function(){return s.newChat()}),w(22,"span",12),T(23,"add_circle"),I(),T(24,"Nuova chat"),I(),Se(25,Cee,7,5,"button",13),Un(26,"async"),I(),w(27,"button",3),H("click",function(){return s.openCloseSettoriEProcedure()}),w(28,"span",14),T(29,"keyboard_arrow_down"),I(),T(30,"Settori e procedure"),I(),w(31,"div",15)(32,"button",11),H("click",function(){return s.newSector()}),w(33,"span",12),T(34,"add_circle"),I(),T(35,"Nuovo settore"),I(),Se(36,Tee,4,1,"button",13),Un(37,"async"),I(),w(38,"button",3),H("click",function(){return s.goToRoute("links","close-sidebar")}),w(39,"span",4),T(40,"link"),I(),T(41,"Link utili"),I(),Q(42,"div",16),w(43,"button",3),H("click",function(){return s.goToRoute("settings","close-sidebar")}),w(44,"span",4),T(45,"settings"),I(),T(46,"Impostazioni"),I(),w(47,"button",17),H("click",function(){return s.logout()}),w(48,"span",4),T(49,"logout"),I(),T(50,"Disconnetti"),I()()()),i&2&&(X(25),ce("ngForOf",Bn(26,2,s.chats)),X(11),ce("ngForOf",Bn(37,4,s.documents)))},dependencies:[hr,pr]});let n=e;return n})();function Dee(n,e){if(n&1){let t=st();w(0,"button",10),H("click",function(){ze(t);let i=me();return Ge(i.deleteTicket())}),T(1,"Elimina"),I()}}var mj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.documents=new De([]),this.chatDocuments=new De([]),this.downloadURL=""}ngOnInit(){}openChangeTicketPopup(){document.getElementById("edit-menu-ticket-popup").style.display="none",document.getElementById("change-ticket-argomento-input").value=this.generalService.currentTicket.argomento,document.getElementById("change-ticket-description-input").value=this.generalService.currentTicket.descrizione,document.getElementById("change-ticket-popup").style.display="flex"}closeAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="none"}closeTicketMenuPopup(){document.getElementById("edit-menu-ticket-popup").style.display="none"}closeAddNewSectorPopup(){document.getElementById("add-new-sector-popup").style.display="none"}closeAddNewProcedurePopup(){document.getElementById("add-new-procedure-popup").style.display="none"}closeAddNewUsefulLinkPopup(){document.getElementById("add-new-useful-link-popup").style.display="none"}closeAddNewChatPopup(){document.getElementById("add-new-chat-popup").style.display="none"}closeChangeTicketPopup(){document.getElementById("change-ticket-popup").style.display="none"}changeTicket(){let r=document.getElementById("change-ticket-argomento-input").value,i=document.getElementById("change-ticket-description-input").value;U.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({argomento:r,descrizione:i},{merge:!0}).then(s=>{document.getElementById("change-ticket-popup").style.display="none",this.generalService.presentToast("Ticket salvato con successo")}).catch(s=>{this.generalService.presentToast("Errore durante il salvataggio del ticket: "+s.message)})}sendTicketEmail(r){fetch("https://apis.serviziautoteam.it/email/addTicket",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ticket:r})}).then(i=>i.json()).then(i=>{console.log("Risposta dal server:",i)}).catch(i=>{console.error("Errore durante l'invio dell'email:",i)})}addTicket(){let r=document.getElementById("add-ticket-argomento-input").value,i=document.getElementById("add-ticket-description-input").value;var s=U.auth().currentUser;let o={argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:s.email,creator_id:s.uid,timestamp:U.firestore.FieldValue.serverTimestamp(),status:"open"};U.firestore().collection("tickets").add(o).then(a=>{document.getElementById("add-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aggiunto con successo"),this.sendTicketEmail(o)}).catch(a=>{this.generalService.presentToast("Errore durante l'aggiunta del ticket: "+a.message)})}deleteTicket(){window.confirm("Sei sicuro di voler eliminare questo ticket?")&&(document.getElementById("ticket-id-"+this.generalService.currentTicket.id).innerHTML="Ticket eliminato",U.firestore().collection("tickets").doc(this.generalService.currentTicket.id).delete().then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket eliminato con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'eliminazione del ticket: "+r.message)}))}openTicket(){U.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"open"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aperto con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'apertura del ticket: "+r.message)})}closeTicket(){U.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"close"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket chiuso con successo")}).catch(r=>{this.generalService.presentToast("Errore durante la chiusura del ticket: "+r.message)})}addNewSector(){let r=document.getElementById("add-sector-name-input"),i=document.getElementById("add-sector-description-input");var s=U.auth().currentUser;U.firestore().collection("settori").doc().set({name:r.value,name_query:r.value.toLowerCase(),description:i.value,timestamp:U.firestore.FieldValue.serverTimestamp(),creator_id:s.uid}).then(()=>{document.getElementById("add-new-sector-popup").style.display="none",this.generalService.presentToast("Settore aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del settore: "+o.message)})}addNewProcedureLink(){let r=document.getElementById("add-procedure-label-input"),i=document.getElementById("add-procedure-link-input"),s=document.getElementById("add-procedure-links-container"),o={label:r.value,link:i.value};this.generalService.linkObject[`resource${this.generalService.linkCounter}`]=o;let a=document.createElement("div");a.className="card",a.id=`entry${this.generalService.linkCounter}`,a.style.paddingLeft="0.8rem",a.style.borderRadius="0.5rem";let c=document.createElement("div");c.className="card-body";let l=document.createElement("h5");l.className="card-title",l.innerText=r.value,l.style.marginTop="0.5rem",l.style.marginBottom="0.5rem";let d=document.createElement("a");d.className="card-link",d.href=i.value,d.innerText=i.value,d.target="_blank",d.style.marginBottom="0.5rem",c.appendChild(l),c.appendChild(d),a.appendChild(c),s.appendChild(a),this.generalService.linkCounter++,r.value="",i.value=""}addNewProcedure(){let r=document.getElementById("add-procedure-name-input"),i=document.getElementById("add-procedure-description-input"),s=document.getElementById("fileInput2"),o=document.getElementById("uploadProgress"),a=document.getElementById("uploadStatus"),c=document.getElementById("add-procedure-folder-input");if(s.files&&s.files.length>0){let d=s.files[0];var l="files/"+d.name+"-date"+Date.now();let h=Na(U.storage(),l),p=X_(h,d);p.on("state_changed",_=>{let E=_.bytesTransferred/_.totalBytes*100;switch(o&&(o.value=E),a&&(a.textContent=`Caricamento: ${E.toFixed(2)}%`),_.state){case"paused":console.log("Caricamento in pausa");break;case"running":console.log("Caricamento in corso");break}},_=>{console.error("Errore nel caricamento:",_),a&&(a.textContent="Errore nel caricamento")},()=>{Z_(p.snapshot.ref).then(_=>{this.downloadURL=_,a&&U.firestore().collection("procedure").doc().set({name:r.value,description:i.value,sector_id:this.generalService.currentSectorId,folder_name:c.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,timestamp:U.firestore.FieldValue.serverTimestamp(),links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:this.downloadURL,storage_resource_path:l}).then(()=>{document.getElementById("add-procedure-name-input").value="",document.getElementById("add-procedure-description-input").value="",document.getElementById("add-procedure-label-input").value="",document.getElementById("add-procedure-link-input").value="",document.getElementById("add-procedure-links-container").innerHTML="",document.getElementById("add-new-procedure-popup").style.display="none",this.generalService.presentToast("Procedura aggiunta con successo")}).catch(E=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+E.message)})})})}else U.firestore().collection("procedure").doc().set({name:r.value,description:i.value,sector_id:this.generalService.currentSectorId,folder_name:c.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,timestamp:U.firestore.FieldValue.serverTimestamp(),links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:"",storage_resource_path:""}).then(()=>{document.getElementById("add-procedure-name-input").value="",document.getElementById("add-procedure-description-input").value="",document.getElementById("add-procedure-label-input").value="",document.getElementById("add-procedure-link-input").value="",document.getElementById("add-procedure-links-container").innerHTML="",document.getElementById("add-new-procedure-popup").style.display="none",this.generalService.presentToast("Procedura aggiunta con successo")}).catch(d=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+d.message)})}addNewChat(){let r=document.getElementById("add-chat-name-input"),i=document.getElementById("add-chat-description-input");U.firestore().collection("chats").doc().set({name:r.value,name_query:r.value.toLowerCase(),description:i.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,timestamp:U.firestore.FieldValue.serverTimestamp()}).then(()=>{document.getElementById("add-chat-name-input").value="",document.getElementById("add-chat-description-input").value="",document.getElementById("add-new-chat-popup").style.display="none",this.generalService.presentToast("Chat creata con successo")}).catch(s=>{this.generalService.presentToast("Errore durante la creazione della chat: "+s.message)})}addNewUsefulLink(){let r=document.getElementById("add-useful-link-name-input"),i=document.getElementById("add-useful-link-description-input"),s=document.getElementById("add-useful-link-url-input");U.firestore().collection("useful_links").doc().set({name:r.value,description:i.value,url:s.value,timestamp:U.firestore.FieldValue.serverTimestamp()}).then(()=>{document.getElementById("add-new-useful-link-popup").style.display="none",this.generalService.presentToast("Link utile aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del link utile: "+o.message)})}};e.\u0275fac=function(i){return new(i||e)(te(He),te(tt))},e.\u0275cmp=xe({type:e,selectors:[["app-popups"]],decls:117,vars:1,consts:[["id","toast-message",2,"height","100%","width","100%","display","none","flex-direction","column","pointer-events","none","background","transparent","z-index","99999999","position","absolute","align-items","center","justify-content","end"],[1,"toastMessage",2,"pointer-events","all","width","95%"],["id","toast-message-text",2,"width","100%"],["id","add-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"min-width","18rem","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","space-between"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","black","cursor","pointer",3,"click"],[2,"width","100%","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-ticket-argomento-input","type","text","placeholder","Argomento",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-ticket-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[1,"button",3,"click"],["id","edit-menu-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","button",3,"click",4,"ngIf"],["id","open-ticket-button",1,"button",3,"click"],["id","close-ticket-button",1,"button",3,"click"],["id","add-new-chat-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-chat-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-chat-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-sector-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-sector-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-sector-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-procedure-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","50rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"width","100%","display","flex","flex-direction","row","flex-wrap","wrap","gap","1rem"],[2,"flex","1","min-width","15rem","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-procedure-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[2,"margin-top","-0.5rem","margin-bottom","-0.5rem","color","#333"],["id","add-procedure-folder-input",1,"inputGroup1",2,"height","2.5rem","border-radius","0.5rem"],["value",""],["id","add-procedure-label-input","type","text","placeholder","Etichetta",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-link-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-links-container",2,"display","flex","flex-direction","column","gap","0.5rem"],["id","fileInput2","type","file",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","padding-top","1rem"],["id","uploadProgress","value","0","max","100",2,"width","100%"],["id","uploadStatus"],["id","add-new-useful-link-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","30rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],["id","add-useful-link-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-useful-link-description-input","type","text","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","min-height","5.5rem","border-radius","0.5rem","resize","vertical"],["id","add-useful-link-url-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","change-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","change-ticket-argomento-input","type","text","placeholder","Argomento",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","change-ticket-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"div",1),Q(2,"p",2),I()(),w(3,"div",3)(4,"div",4)(5,"h3",5),T(6,"Nuovo Ticket"),w(7,"span",6),H("click",function(){return s.closeAddTicketPopup()}),T(8,"close"),I()(),w(9,"div",7),Q(10,"input",8)(11,"textarea",9),I(),w(12,"div",5)(13,"button",10),H("click",function(){return s.closeAddTicketPopup()}),T(14,"Annulla"),I(),w(15,"button",10),H("click",function(){return s.addTicket()}),T(16,"Pubblica"),I()()()(),w(17,"div",11)(18,"div",4)(19,"h3",5),T(20,"Men\xF9 ticket"),w(21,"span",6),H("click",function(){return s.closeTicketMenuPopup()}),T(22,"close"),I()(),w(23,"div",12)(24,"button",10),H("click",function(){return s.openChangeTicketPopup()}),T(25,"Modifica"),I(),Se(26,Dee,2,0,"button",13),w(27,"button",14),H("click",function(){return s.openTicket()}),T(28,"Apri Ticket"),I(),w(29,"button",15),H("click",function(){return s.closeTicket()}),T(30,"Chiudi Ticket"),I()()()(),w(31,"div",16)(32,"div",4)(33,"h3",5),T(34,"Nuova Chat"),w(35,"span",6),H("click",function(){return s.closeAddNewChatPopup()}),T(36,"close"),I()(),w(37,"div",7),Q(38,"input",17)(39,"textarea",18),I(),w(40,"div",5)(41,"button",10),H("click",function(){return s.closeAddNewChatPopup()}),T(42,"Annulla"),I(),w(43,"button",10),H("click",function(){return s.addNewChat()}),T(44,"Aggiungi"),I()()()(),w(45,"div",19)(46,"div",4)(47,"h3",5),T(48,"Nuovo settore"),w(49,"span",6),H("click",function(){return s.closeAddNewSectorPopup()}),T(50,"close"),I()(),w(51,"div",7),Q(52,"input",20)(53,"textarea",21),I(),w(54,"div",5)(55,"button",10),H("click",function(){return s.closeAddNewSectorPopup()}),T(56,"Annulla"),I(),w(57,"button",10),H("click",function(){return s.addNewSector()}),T(58,"Aggiungi"),I()()()(),w(59,"div",22)(60,"div",23)(61,"h3",5),T(62,"Nuova procedura"),w(63,"span",6),H("click",function(){return s.closeAddNewProcedurePopup()}),T(64,"close"),I()(),w(65,"div",24)(66,"div",25),Q(67,"input",26)(68,"textarea",27),w(69,"p",28),T(70,"Cartella"),I(),w(71,"select",29),Q(72,"option",30),I()(),w(73,"div",25),Q(74,"input",31)(75,"input",32),w(76,"button",10),H("click",function(){return s.addNewProcedureLink()}),T(77,"Aggiungi Risorsa"),I(),Q(78,"div",33)(79,"input",34)(80,"progress",35)(81,"span",36),I()(),w(82,"div",5)(83,"button",10),H("click",function(){return s.closeAddNewProcedurePopup()}),T(84,"Annulla"),I(),w(85,"button",10),H("click",function(){return s.addNewProcedure()}),T(86,"Conferma"),I()()()(),w(87,"div",37)(88,"div",38)(89,"h3",5),T(90,"Nuovo link"),w(91,"span",6),H("click",function(){return s.closeAddNewUsefulLinkPopup()}),T(92,"close"),I()(),w(93,"div",24)(94,"div",25),Q(95,"input",39)(96,"textarea",40)(97,"input",41),I()(),w(98,"div",5)(99,"button",10),H("click",function(){return s.closeAddNewUsefulLinkPopup()}),T(100,"Annulla"),I(),w(101,"button",10),H("click",function(){return s.addNewUsefulLink()}),T(102,"Conferma"),I()()()(),w(103,"div",42)(104,"div",38)(105,"h3",5),T(106,"Modifica Ticket"),w(107,"span",6),H("click",function(){return s.closeChangeTicketPopup()}),T(108,"close"),I()(),w(109,"div",7),Q(110,"input",43)(111,"textarea",44),I(),w(112,"div",5)(113,"button",10),H("click",function(){return s.closeChangeTicketPopup()}),T(114,"Annulla"),I(),w(115,"button",10),H("click",function(){return s.changeTicket()}),T(116,"Salva"),I()()()()),i&2&&(X(26),ce("ngIf",s.generalService.isAdmin==!0))},dependencies:[fr,au,cu]});let n=e;return n})();var gj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){}hideOrShowSidebar(){this.generalService.openCloseSidebar()}openCloseSidebar(){this.generalService.openCloseSidebar()}};e.\u0275fac=function(i){return new(i||e)(te(He))},e.\u0275cmp=xe({type:e,selectors:[["app-header"]],decls:16,vars:0,consts:[["id","header",2,"height","3.5rem","border-bottom","1px solid rgba(0, 0, 0, 0.192)","display","flex","flex-direction","row","align-items","center","flex-shrink","0","justify-content","space-between","padding-left","1rem","padding-right","1rem"],[1,"desktop-element",2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2rem","color","#333","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.3rem"],["id","header-name-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-surname-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-email-display",2,"margin-top","0rem","margin-bottom","0rem"],["id","header-agency-display",2,"margin-bottom","0rem","margin-top","0rem"],[1,"mobile-element",2,"display","none","flex-direction","row","align-items","center","gap","1rem"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"div",1)(2,"span",2),H("click",function(){return s.openCloseSidebar()}),T(3,"menu"),I(),w(4,"div")(5,"div",3),Q(6,"h3",4)(7,"h3",5),I(),Q(8,"p",6),I(),w(9,"p"),T(10," | "),I(),w(11,"div"),Q(12,"h3",7),I()(),w(13,"div",8)(14,"span",2),H("click",function(){return s.hideOrShowSidebar()}),T(15,"menu"),I()()())}});let n=e;return n})();var _j=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.initFirebase(),this.generalService.getUserData()}ngOnInit(){U.auth().onAuthStateChanged(r=>{r?(this.generalService.initNormalScreen(),this.getUserPremissionState()):this.router.navigate(["/log"])})}getUserPremissionState(){return g(this,null,function*(){let i=U.auth().currentUser;i?(yield i.getIdTokenResult()).claims.role=="admin"?(this.generalService.isAdmin=!0,console.log("isAdmin: "+this.generalService.isAdmin)):(this.generalService.isAdmin=!1,console.log("is Admin: "+this.generalService.isAdmin)):(this.router.navigate(["/log"]),console.log("Log in to fetch your current user permission state"),this.generalService.presentToast("Utente non loggato"))})}initFirebase(){let r={apiKey:"AIzaSyD_tP0OvuudgC3fbvxHs9SyCl5bMYnW3S4",authDomain:"ttm-db-82f02.firebaseapp.com",databaseURL:"https://ttm-db-82f02-default-rtdb.europe-west1.firebasedatabase.app",projectId:"ttm-db-82f02",storageBucket:"ttm-db-82f02.appspot.com",messagingSenderId:"264736388729",appId:"1:264736388729:web:4f5b8c6411d3ef47a786a8",measurementId:"G-FQYCE4Q6XN"};U.initializeApp(r)}openCloseSidebar(){this.generalService.openCloseSidebar()}};e.\u0275fac=function(i){return new(i||e)(te(He),te(tt))},e.\u0275cmp=xe({type:e,selectors:[["app-root"]],decls:7,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","row"],[2,"height","100%"],[2,"height","100%","width","100%"],["id","router-outlet-container",2,"flex","1","height","calc(100% - 3.5rem)"]],template:function(i,s){i&1&&(Q(0,"app-popups")(1,"app-header"),w(2,"div",0)(3,"div",1),Q(4,"app-sidebar",2),I(),w(5,"div",3),Q(6,"router-outlet"),I()())},dependencies:[RE,pj,mj,gj]});let n=e;return n})();var yj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ln({type:e,bootstrap:[_j]}),e.\u0275inj=Fn({providers:[{provide:Or,useClass:gm}],imports:[Jk,tj,fj]});let n=e;return n})();Yk().bootstrapModule(yj).catch(n=>console.error(n));
