var lx=Object.defineProperty,n$=Object.defineProperties;var r$=Object.getOwnPropertyDescriptors;var ax=Object.getOwnPropertySymbols,i$=Object.getPrototypeOf,s$=Object.prototype.hasOwnProperty,o$=Object.prototype.propertyIsEnumerable,a$=Reflect.get;var cx=(n,e,t)=>e in n?lx(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,H=(n,e)=>{for(var t in e||={})s$.call(e,t)&&cx(n,t,e[t]);if(ax)for(var t of ax(e))o$.call(e,t)&&cx(n,t,e[t]);return n},nt=(n,e)=>n$(n,r$(e));var c$=(n,e)=>{for(var t in e)lx(n,t,{get:e[t],enumerable:!0})};var jr=(n,e,t)=>a$(i$(n),t,e);var g=(n,e,t)=>new Promise((r,i)=>{var s=c=>{try{a(t.next(c))}catch(l){i(l)}},o=c=>{try{a(t.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(n,e)).next())});var ux=null;var Ev=1,dx=Symbol("SIGNAL");function Pe(n){let e=ux;return ux=n,e}var hx={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function l$(n){if(!(Tv(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Ev)){if(!n.producerMustRecompute(n)&&!bv(n)){n.dirty=!1,n.lastCleanEpoch=Ev;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Ev}}function fx(n){return n&&(n.nextProducerIndex=0),Pe(n)}function px(n,e){if(Pe(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Tv(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Cv(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function bv(n){Uf(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(l$(t),r!==t.version))return!0}return!1}function mx(n){if(Uf(n),Tv(n))for(let e=0;e<n.producerNode.length;e++)Cv(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Cv(n,e){if(u$(n),Uf(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)Cv(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Uf(i),i.producerIndexOfThis[r]=e}}function Tv(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Uf(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function u$(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function d$(){throw new Error}var h$=d$;function gx(n){h$=n}function fe(n){return typeof n=="function"}function Ha(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Bf=Ha(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Du(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Ot=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(fe(r))try{r()}catch(s){e=s instanceof Bf?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{_x(s)}catch(o){e=e??[],o instanceof Bf?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Bf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)_x(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Du(t,e)}remove(e){let{_finalizers:t}=this;t&&Du(t,e),e instanceof n&&e._removeParent(this)}};Ot.EMPTY=(()=>{let n=new Ot;return n.closed=!0,n})();var Dv=Ot.EMPTY;function jf(n){return n instanceof Ot||n&&"closed"in n&&fe(n.remove)&&fe(n.add)&&fe(n.unsubscribe)}function _x(n){fe(n)?n():n.unsubscribe()}var Ir={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var qa={setTimeout(n,e,...t){let{delegate:r}=qa;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=qa;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function $f(n){qa.setTimeout(()=>{let{onUnhandledError:e}=Ir;if(e)e(n);else throw n})}function Su(){}var yx=Sv("C",void 0,void 0);function vx(n){return Sv("E",void 0,n)}function wx(n){return Sv("N",n,void 0)}function Sv(n,e,t){return{kind:n,value:e,error:t}}var mo=null;function za(n){if(Ir.useDeprecatedSynchronousErrorHandling){let e=!mo;if(e&&(mo={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=mo;if(mo=null,t)throw r}}else n()}function Ix(n){Ir.useDeprecatedSynchronousErrorHandling&&mo&&(mo.errorThrown=!0,mo.error=n)}var go=class extends Ot{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,jf(e)&&e.add(this)):this.destination=m$}static create(e,t,r){return new Ga(e,t,r)}next(e){this.isStopped?Rv(wx(e),this):this._next(e)}error(e){this.isStopped?Rv(vx(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Rv(yx,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},f$=Function.prototype.bind;function Av(n,e){return f$.call(n,e)}var xv=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Hf(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Hf(r)}else Hf(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Hf(t)}}},Ga=class extends go{constructor(e,t,r){super();let i;if(fe(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Ir.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Av(e.next,s),error:e.error&&Av(e.error,s),complete:e.complete&&Av(e.complete,s)}):i=e}this.destination=new xv(i)}};function Hf(n){Ir.useDeprecatedSynchronousErrorHandling?Ix(n):$f(n)}function p$(n){throw n}function Rv(n,e){let{onStoppedNotification:t}=Ir;t&&qa.setTimeout(()=>t(n,e))}var m$={closed:!0,next:Su,error:p$,complete:Su};var Wa=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Un(n){return n}function Nv(...n){return Pv(n)}function Pv(n){return n.length===0?Un:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Be=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=_$(t)?t:new Ga(t,r,i);return za(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=Ex(r),new r((i,s)=>{let o=new Ga({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Wa](){return this}pipe(...t){return Pv(t)(this)}toPromise(t){return t=Ex(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function Ex(n){var e;return(e=n??Ir.Promise)!==null&&e!==void 0?e:Promise}function g$(n){return n&&fe(n.next)&&fe(n.error)&&fe(n.complete)}function _$(n){return n&&n instanceof go||g$(n)&&jf(n)}function Mv(n){return fe(n?.lift)}function Se(n){return e=>{if(Mv(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ae(n,e,t,r,i){return new kv(n,e,t,r,i)}var kv=class extends go{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ka(){return Se((n,e)=>{let t=null;n._refCount++;let r=Ae(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Qa=class extends Be{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Mv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ot;let t=this.getSubject();e.add(this.source.subscribe(Ae(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ot.EMPTY)}return e}refCount(){return Ka()(this)}};var bx=Ha(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var nn=(()=>{class n extends Be{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new qf(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new bx}next(t){za(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){za(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){za(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Dv:(this.currentObservers=null,s.push(t),new Ot(()=>{this.currentObservers=null,Du(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new Be;return t.source=this,t}}return n.create=(e,t)=>new qf(e,t),n})(),qf=class extends nn{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Dv}};var Me=class extends nn{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Bn=new Be(n=>n.complete());function Cx(n){return n&&fe(n.schedule)}function Tx(n){return n[n.length-1]}function Dx(n){return fe(Tx(n))?n.pop():void 0}function os(n){return Cx(Tx(n))?n.pop():void 0}function zf(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function Ax(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{l(r.next(d))}catch(h){o(h)}}function c(d){try{l(r.throw(d))}catch(h){o(h)}}function l(d){d.done?s(d.value):i(d.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function Sx(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function _o(n){return this instanceof _o?(this.v=n,this):new _o(n)}function Rx(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(w){return Promise.resolve(w).then(_,h)}}function a(_,w){r[_]&&(i[_]=function(S){return new Promise(function(R,L){s.push([_,S,R,L])>1||c(_,S)})},w&&(i[_]=w(i[_])))}function c(_,w){try{l(r[_](w))}catch(S){p(s[0][3],S)}}function l(_){_.value instanceof _o?Promise.resolve(_.value.v).then(d,h):p(s[0][2],_)}function d(_){c("next",_)}function h(_){c("throw",_)}function p(_,w){_(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function xx(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Sx=="function"?Sx(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Gf=n=>n&&typeof n.length=="number"&&typeof n!="function";function Wf(n){return fe(n?.then)}function Kf(n){return fe(n[Wa])}function Qf(n){return Symbol.asyncIterator&&fe(n?.[Symbol.asyncIterator])}function Yf(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function y$(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Jf=y$();function Xf(n){return fe(n?.[Jf])}function Zf(n){return Rx(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield _o(t.read());if(i)return yield _o(void 0);yield yield _o(r)}}finally{t.releaseLock()}})}function ep(n){return fe(n?.getReader)}function Bt(n){if(n instanceof Be)return n;if(n!=null){if(Kf(n))return v$(n);if(Gf(n))return w$(n);if(Wf(n))return I$(n);if(Qf(n))return Nx(n);if(Xf(n))return E$(n);if(ep(n))return b$(n)}throw Yf(n)}function v$(n){return new Be(e=>{let t=n[Wa]();if(fe(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function w$(n){return new Be(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function I$(n){return new Be(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,$f)})}function E$(n){return new Be(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function Nx(n){return new Be(e=>{C$(n,e).catch(t=>e.error(t))})}function b$(n){return Nx(Zf(n))}function C$(n,e){var t,r,i,s;return Ax(this,void 0,void 0,function*(){try{for(t=xx(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function An(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function tp(n,e=0){return Se((t,r)=>{t.subscribe(Ae(r,i=>An(r,n,()=>r.next(i),e),()=>An(r,n,()=>r.complete(),e),i=>An(r,n,()=>r.error(i),e)))})}function np(n,e=0){return Se((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function Px(n,e){return Bt(n).pipe(np(e),tp(e))}function Mx(n,e){return Bt(n).pipe(np(e),tp(e))}function kx(n,e){return new Be(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function Ox(n,e){return new Be(t=>{let r;return An(t,e,()=>{r=n[Jf](),An(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>fe(r?.return)&&r.return()})}function rp(n,e){if(!n)throw new Error("Iterable cannot be null");return new Be(t=>{An(t,e,()=>{let r=n[Symbol.asyncIterator]();An(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function Fx(n,e){return rp(Zf(n),e)}function Lx(n,e){if(n!=null){if(Kf(n))return Px(n,e);if(Gf(n))return kx(n,e);if(Wf(n))return Mx(n,e);if(Qf(n))return rp(n,e);if(Xf(n))return Ox(n,e);if(ep(n))return Fx(n,e)}throw Yf(n)}function at(n,e){return e?Lx(n,e):Bt(n)}function le(...n){let e=os(n);return at(n,e)}function Ya(n,e){let t=fe(n)?n:()=>n,r=i=>i.error(t());return new Be(e?i=>e.schedule(r,0,i):r)}function Ov(n){return!!n&&(n instanceof Be||fe(n.lift)&&fe(n.subscribe))}var Pi=Ha(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Re(n,e){return Se((t,r)=>{let i=0;t.subscribe(Ae(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:T$}=Array;function D$(n,e){return T$(e)?n(...e):n(e)}function Vx(n){return Re(e=>D$(n,e))}var{isArray:S$}=Array,{getPrototypeOf:A$,prototype:R$,keys:x$}=Object;function Ux(n){if(n.length===1){let e=n[0];if(S$(e))return{args:e,keys:null};if(N$(e)){let t=x$(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function N$(n){return n&&typeof n=="object"&&A$(n)===R$}function Bx(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Au(...n){let e=os(n),t=Dx(n),{args:r,keys:i}=Ux(n);if(r.length===0)return at([],e);let s=new Be(P$(r,e,i?o=>Bx(i,o):Un));return t?s.pipe(Vx(t)):s}function P$(n,e,t=Un){return r=>{jx(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)jx(e,()=>{let l=at(n[c],e),d=!1;l.subscribe(Ae(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function jx(n,e,t){n?An(t,n,e):e()}function $x(n,e,t,r,i,s,o,a){let c=[],l=0,d=0,h=!1,p=()=>{h&&!c.length&&!l&&e.complete()},_=S=>l<r?w(S):c.push(S),w=S=>{s&&e.next(S),l++;let R=!1;Bt(t(S,d++)).subscribe(Ae(e,L=>{i?.(L),s?_(L):e.next(L)},()=>{R=!0},void 0,()=>{if(R)try{for(l--;c.length&&l<r;){let L=c.shift();o?An(e,o,()=>w(L)):w(L)}p()}catch(L){e.error(L)}}))};return n.subscribe(Ae(e,_,()=>{h=!0,p()})),()=>{a?.()}}function Tt(n,e,t=1/0){return fe(e)?Tt((r,i)=>Re((s,o)=>e(r,s,i,o))(Bt(n(r,i))),t):(typeof e=="number"&&(t=e),Se((r,i)=>$x(r,i,n,t)))}function Ja(n=1/0){return Tt(Un,n)}function Hx(){return Ja(1)}function Xa(...n){return Hx()(at(n,os(n)))}function ip(n){return new Be(e=>{Bt(n()).subscribe(e)})}function tr(n,e){return Se((t,r)=>{let i=0;t.subscribe(Ae(r,s=>n.call(e,s,i++)&&r.next(s)))})}function as(n){return Se((e,t)=>{let r=null,i=!1,s;r=e.subscribe(Ae(t,void 0,void 0,o=>{s=Bt(n(o,as(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function qx(n,e,t,r,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Ae(o,d=>{let h=l++;c=a?n(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function yo(n,e){return fe(e)?Tt(n,e,1):Tt(n,1)}function cs(n){return Se((e,t)=>{let r=!1;e.subscribe(Ae(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Mi(n){return n<=0?()=>Bn:Se((e,t)=>{let r=0;e.subscribe(Ae(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Fv(n){return Re(()=>n)}function sp(n=M$){return Se((e,t)=>{let r=!1;e.subscribe(Ae(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function M$(){return new Pi}function Ru(n){return Se((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function $r(n,e){let t=arguments.length>=2;return r=>r.pipe(n?tr((i,s)=>n(i,s,r)):Un,Mi(1),t?cs(e):sp(()=>new Pi))}function Za(n){return n<=0?()=>Bn:Se((e,t)=>{let r=[];e.subscribe(Ae(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Lv(n,e){let t=arguments.length>=2;return r=>r.pipe(n?tr((i,s)=>n(i,s,r)):Un,Za(1),t?cs(e):sp(()=>new Pi))}function Vv(n,e){return Se(qx(n,e,arguments.length>=2,!0))}function Uv(...n){let e=os(n);return Se((t,r)=>{(e?Xa(n,t,e):Xa(n,t)).subscribe(r)})}function nr(n,e){return Se((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(Ae(r,c=>{i?.unsubscribe();let l=0,d=s++;Bt(n(c,d)).subscribe(i=Ae(r,h=>r.next(e?e(c,h,d,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Bv(n){return Se((e,t)=>{Bt(n).subscribe(Ae(t,()=>t.complete(),Su)),!t.closed&&e.subscribe(t)})}function Kt(n,e,t){let r=fe(n)||e||t?{next:n,error:e,complete:t}:n;return r?Se((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Ae(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Un}var SN="https://g.co/ng/security#xss",re=class extends Error{constructor(e,t){super(Lw(e,t)),this.code=e}};function Lw(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function ju(n){return{toString:n}.toString()}var op="__parameters__";function k$(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function AN(n,e,t){return ju(()=>{let r=k$(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let h=c.hasOwnProperty(op)?c[op]:Object.defineProperty(c,op,{value:[]})[op];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var _n=globalThis;function qe(n){for(let e in n)if(n[e]===qe)return e;throw Error("Could not find renamed property on target object.")}function O$(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function xn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(xn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function zx(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var F$=qe({__forward_ref__:qe});function $u(n){return n.__forward_ref__=$u,n.toString=function(){return xn(this())},n}function gn(n){return RN(n)?n():n}function RN(n){return typeof n=="function"&&n.hasOwnProperty(F$)&&n.__forward_ref__===$u}function se(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Pn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Up(n){return Gx(n,NN)||Gx(n,PN)}function xN(n){return Up(n)!==null}function Gx(n,e){return n.hasOwnProperty(e)?n[e]:null}function L$(n){let e=n&&(n[NN]||n[PN]);return e||null}function Wx(n){return n&&(n.hasOwnProperty(Kx)||n.hasOwnProperty(V$))?n[Kx]:null}var NN=qe({\u0275prov:qe}),Kx=qe({\u0275inj:qe}),PN=qe({ngInjectableDef:qe}),V$=qe({ngInjectorDef:qe}),de=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=se({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function MN(n){return n&&!!n.\u0275providers}var U$=qe({\u0275cmp:qe}),B$=qe({\u0275dir:qe}),j$=qe({\u0275pipe:qe}),$$=qe({\u0275mod:qe}),mp=qe({\u0275fac:qe}),xu=qe({__NG_ELEMENT_ID__:qe}),Qx=qe({__NG_ENV_ID__:qe});function jn(n){return typeof n=="string"?n:n==null?"":String(n)}function H$(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():jn(n)}function q$(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new re(-200,n)}function Vw(n,e){throw new re(-201,!1)}var Ie=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Ie||{}),Xv;function kN(){return Xv}function Rn(n){let e=Xv;return Xv=n,e}function ON(n,e,t){let r=Up(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&Ie.Optional)return null;if(e!==void 0)return e;Vw(n,"Injector")}var z$={},Pu=z$,Zv="__NG_DI_FLAG__",gp="ngTempTokenPath",G$="ngTokenPath",W$=/\n/gm,K$="\u0275",Yx="__source",ic;function Q$(){return ic}function ls(n){let e=ic;return ic=n,e}function Y$(n,e=Ie.Default){if(ic===void 0)throw new re(-203,!1);return ic===null?ON(n,void 0,e):ic.get(n,e&Ie.Optional?null:void 0,e)}function oe(n,e=Ie.Default){return(kN()||Y$)(gn(n),e)}function Q(n,e=Ie.Default){return oe(n,Bp(e))}function Bp(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function ew(n){let e=[];for(let t=0;t<n.length;t++){let r=gn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new re(900,!1);let i,s=Ie.Default;for(let o=0;o<r.length;o++){let a=r[o],c=J$(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(oe(i,s))}else e.push(oe(r))}return e}function FN(n,e){return n[Zv]=e,n.prototype[Zv]=e,n}function J$(n){return n[Zv]}function X$(n,e,t,r){let i=n[gp];throw e[Yx]&&i.unshift(e[Yx]),n.message=Z$(`
`+n.message,i,t,r),n[G$]=i,n[gp]=null,n}function Z$(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==K$?n.slice(2):n;let i=xn(e);if(Array.isArray(e))i=e.map(xn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):xn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(W$,`
  `)}`}var jp=FN(AN("Optional"),8);var Uw=FN(AN("SkipSelf"),4);function Io(n,e){let t=n.hasOwnProperty(mp);return t?n[mp]:null}function Bw(n,e){n.forEach(t=>Array.isArray(t)?Bw(t,e):e(t))}function LN(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function _p(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var oc={},br=[],ac=new de(""),VN=new de("",-1),UN=new de(""),yp=class{get(e,t=Pu){if(t===Pu){let r=new Error(`NullInjectorError: No provider for ${xn(e)}!`);throw r.name="NullInjectorError",r}return t}},BN=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(BN||{}),zr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(zr||{}),ir=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(ir||{});function eH(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function tw(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];tH(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function jN(n){return n===3||n===4||n===6}function tH(n){return n.charCodeAt(0)===64}function Mu(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?Jx(n,t,i,null,e[++r]):Jx(n,t,i,null,null))}}return n}function Jx(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var $N="ng-template";function nH(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&eH(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(jw(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function jw(n){return n.type===4&&n.value!==$N}function rH(n,e,t){let r=n.type===4&&!t?$N:n.value;return e===r}function iH(n,e,t){let r=4,i=n.attrs,s=i!==null?aH(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Er(r)&&!Er(c))return!1;if(o&&Er(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!rH(n,c,t)||c===""&&e.length===1){if(Er(r))return!1;o=!0}}else if(r&8){if(i===null||!nH(n,i,c,t)){if(Er(r))return!1;o=!0}}else{let l=e[++a],d=sH(c,i,jw(n),t);if(d===-1){if(Er(r))return!1;o=!0;continue}if(l!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(Er(r))return!1;o=!0}}}}return Er(r)||o}function Er(n){return(n&1)===0}function sH(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return cH(e,n)}function oH(n,e,t=!1){for(let r=0;r<e.length;r++)if(iH(n,e[r],t))return!0;return!1}function aH(n){for(let e=0;e<n.length;e++){let t=n[e];if(jN(t))return e}return n.length}function cH(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function Xx(n,e){return n?":not("+e.trim()+")":e}function lH(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Er(o)&&(e+=Xx(s,i),i=""),r=o,s=s||!Er(r);t++}return i!==""&&(e+=Xx(s,i)),e}function uH(n){return n.map(lH).join(",")}function dH(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!Er(i))break;i=s}r++}return{attrs:e,classes:t}}function Le(n){return ju(()=>{let e=KN(n),t=nt(H({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===BN.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||zr.Emulated,styles:n.styles||br,_:null,schemas:n.schemas||null,tView:null,id:""});QN(t);let r=n.dependencies;return t.directiveDefs=eN(r,!1),t.pipeDefs=eN(r,!0),t.id=pH(t),t})}function hH(n){return ds(n)||qN(n)}function fH(n){return n!==null}function Mn(n){return ju(()=>({type:n.type,bootstrap:n.bootstrap||br,declarations:n.declarations||br,imports:n.imports||br,exports:n.exports||br,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Zx(n,e){if(n==null)return oc;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=ir.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==ir.None?[r,a]:r,e[s]=o):t[s]=r}return t}function $n(n){return ju(()=>{let e=KN(n);return QN(e),e})}function HN(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function ds(n){return n[U$]||null}function qN(n){return n[B$]||null}function zN(n){return n[j$]||null}function GN(n){let e=ds(n)||qN(n)||zN(n);return e!==null?e.standalone:!1}function WN(n,e){let t=n[$$]||null;if(!t&&e===!0)throw new Error(`Type ${xn(n)} does not have '\u0275mod' property.`);return t}function KN(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||oc,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||br,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Zx(n.inputs,e),outputs:Zx(n.outputs),debugInfo:null}}function QN(n){n.features?.forEach(e=>e(n))}function eN(n,e){if(!n)return null;let t=e?zN:hH;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(fH)}function pH(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function mH(...n){return{\u0275providers:YN(!0,n),\u0275fromNgModule:!0}}function YN(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return Bw(e,o=>{let a=o;nw(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&JN(i,s),t}function JN(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];$w(i,s=>{e(s,r)})}}function nw(n,e,t,r){if(n=gn(n),!n)return!1;let i=null,s=Wx(n),o=!s&&ds(n);if(!s&&!o){let c=n.ngModule;if(s=Wx(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)nw(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Bw(s.imports,d=>{nw(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&JN(l,e)}if(!a){let l=Io(i)||(()=>new i);e({provide:i,useFactory:l,deps:br},i),e({provide:UN,useValue:i,multi:!0},i),e({provide:ac,useValue:()=>oe(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;$w(c,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function $w(n,e){for(let t of n)MN(t)&&(t=t.\u0275providers),Array.isArray(t)?$w(t,e):e(t)}var gH=qe({provide:String,useValue:qe});function XN(n){return n!==null&&typeof n=="object"&&gH in n}function _H(n){return!!(n&&n.useExisting)}function yH(n){return!!(n&&n.useFactory)}function cc(n){return typeof n=="function"}function vH(n){return!!n.useClass}var $p=new de(""),up={},wH={},jv;function Hw(){return jv===void 0&&(jv=new yp),jv}var Nn=class{},ku=class extends Nn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,iw(e,o=>this.processProvider(o)),this.records.set(VN,ec(void 0,this)),i.has("environment")&&this.records.set(Nn,ec(void 0,this));let s=this.records.get($p);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(UN,br,Ie.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Pe(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Pe(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=ls(this),r=Rn(void 0),i;try{return e()}finally{ls(t),Rn(r)}}get(e,t=Pu,r=Ie.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Qx))return e[Qx](this);r=Bp(r);let i,s=ls(this),o=Rn(void 0);try{if(!(r&Ie.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=TH(e)&&Up(e);l&&this.injectableDefInScope(l)?c=ec(rw(e),up):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&Ie.Self?Hw():this.parent;return t=r&Ie.Optional&&t===Pu?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[gp]=a[gp]||[]).unshift(xn(e)),s)throw a;return X$(a,e,"R3InjectorError",this.source)}else throw a}finally{Rn(o),ls(s)}}resolveInjectorInitializers(){let e=Pe(null),t=ls(this),r=Rn(void 0),i;try{let s=this.get(ac,br,Ie.Self);for(let o of s)o()}finally{ls(t),Rn(r),Pe(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(xn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new re(205,!1)}processProvider(e){e=gn(e);let t=cc(e)?e:gn(e&&e.provide),r=EH(e);if(!cc(e)&&e.multi===!0){let i=this.records.get(t);i||(i=ec(void 0,up,!0),i.factory=()=>ew(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Pe(null);try{return t.value===up&&(t.value=wH,t.value=t.factory()),typeof t.value=="object"&&t.value&&CH(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Pe(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=gn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function rw(n){let e=Up(n),t=e!==null?e.factory:Io(n);if(t!==null)return t;if(n instanceof de)throw new re(204,!1);if(n instanceof Function)return IH(n);throw new re(204,!1)}function IH(n){if(n.length>0)throw new re(204,!1);let t=L$(n);return t!==null?()=>t.factory(n):()=>new n}function EH(n){if(XN(n))return ec(void 0,n.useValue);{let e=ZN(n);return ec(e,up)}}function ZN(n,e,t){let r;if(cc(n)){let i=gn(n);return Io(i)||rw(i)}else if(XN(n))r=()=>gn(n.useValue);else if(yH(n))r=()=>n.useFactory(...ew(n.deps||[]));else if(_H(n))r=()=>oe(gn(n.useExisting));else{let i=gn(n&&(n.useClass||n.provide));if(bH(n))r=()=>new i(...ew(n.deps));else return Io(i)||rw(i)}return r}function ec(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function bH(n){return!!n.deps}function CH(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function TH(n){return typeof n=="function"||typeof n=="object"&&n instanceof de}function iw(n,e){for(let t of n)Array.isArray(t)?iw(t,e):t&&MN(t)?iw(t.\u0275providers,e):e(t)}function ki(n,e){n instanceof ku&&n.assertNotDestroyed();let t,r=ls(n),i=Rn(void 0);try{return e()}finally{ls(r),Rn(i)}}function eP(){return kN()!==void 0||Q$()!=null}function DH(n){if(!eP())throw new re(-203,!1)}function SH(n){let e=_n.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function AH(n){return typeof n=="function"}var Oi=0,Ce=1,ue=2,sn=3,Cr=4,Sr=5,vp=6,Ou=7,Tr=8,lc=9,Dr=10,Qt=11,Fu=12,tN=13,fc=14,Gr=15,Hp=16,tc=17,uc=18,qp=19,tP=20,us=21,$v=22,Eo=23,Wr=25,nP=1;var bo=7,wp=8,Ip=9,rr=10,qw=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(qw||{});function vo(n){return Array.isArray(n)&&typeof n[nP]=="object"}function Fi(n){return Array.isArray(n)&&n[nP]===!0}function rP(n){return(n.flags&4)!==0}function zp(n){return n.componentOffset>-1}function zw(n){return(n.flags&1)===1}function hs(n){return!!n.template}function RH(n){return(n[ue]&512)!==0}var sw=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function iP(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function pc(){return sP}function sP(n){return n.type.prototype.ngOnChanges&&(n.setInput=NH),xH}pc.ngInherit=!0;function xH(){let n=aP(this),e=n?.current;if(e){let t=n.previous;if(t===oc)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function NH(n,e,t,r,i){let s=this.declaredInputs[r],o=aP(n)||PH(n,{previous:oc,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new sw(l&&l.currentValue,t,c===oc),iP(n,e,i,t)}var oP="__ngSimpleChanges__";function aP(n){return n[oP]||null}function PH(n,e){return n[oP]=e}var nN=null;var Hr=function(n,e,t){nN?.(n,e,t)},MH="svg",kH="math",OH=!1;function FH(){return OH}function Kr(n){for(;Array.isArray(n);)n=n[Oi];return n}function LH(n,e){return Kr(e[n])}function sr(n,e){return Kr(e[n.index])}function cP(n,e){return n.data[e]}function VH(n,e){return n[e]}function ps(n,e){let t=e[n];return vo(t)?t:t[Oi]}function Gw(n){return(n[ue]&128)===128}function UH(n){return Fi(n[sn])}function Ep(n,e){return e==null?null:n[e]}function lP(n){n[tc]=0}function BH(n){n[ue]&1024||(n[ue]|=1024,Gw(n)&&Lu(n))}function jH(n,e){for(;n>0;)e=e[fc],n--;return e}function Ww(n){return!!(n[ue]&9216||n[Eo]?.dirty)}function ow(n){n[Dr].changeDetectionScheduler?.notify(1),Ww(n)?Lu(n):n[ue]&64&&(FH()?(n[ue]|=1024,Lu(n)):n[Dr].changeDetectionScheduler?.notify())}function Lu(n){n[Dr].changeDetectionScheduler?.notify();let e=Vu(n);for(;e!==null&&!(e[ue]&8192||(e[ue]|=8192,!Gw(e)));)e=Vu(e)}function uP(n,e){if((n[ue]&256)===256)throw new re(911,!1);n[us]===null&&(n[us]=[]),n[us].push(e)}function $H(n,e){if(n[us]===null)return;let t=n[us].indexOf(e);t!==-1&&n[us].splice(t,1)}function Vu(n){let e=n[sn];return Fi(e)?e[sn]:e}var be={lFrame:_P(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function HH(){return be.lFrame.elementDepthCount}function qH(){be.lFrame.elementDepthCount++}function zH(){be.lFrame.elementDepthCount--}function dP(){return be.bindingsEnabled}function GH(){return be.skipHydrationRootTNode!==null}function WH(n){return be.skipHydrationRootTNode===n}function KH(){be.skipHydrationRootTNode=null}function je(){return be.lFrame.lView}function or(){return be.lFrame.tView}function on(n){return be.lFrame.contextLView=n,n[Tr]}function an(n){return be.lFrame.contextLView=null,n}function Hn(){let n=hP();for(;n!==null&&n.type===64;)n=n.parent;return n}function hP(){return be.lFrame.currentTNode}function QH(){let n=be.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Hu(n,e){let t=be.lFrame;t.currentTNode=n,t.isParent=e}function fP(){return be.lFrame.isParent}function YH(){be.lFrame.isParent=!1}function JH(){let n=be.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Kw(){return be.lFrame.bindingIndex}function XH(n){return be.lFrame.bindingIndex=n}function Qw(){return be.lFrame.bindingIndex++}function Yw(n){let e=be.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function ZH(){return be.lFrame.inI18n}function eq(n,e){let t=be.lFrame;t.bindingIndex=t.bindingRootIndex=n,aw(e)}function tq(){return be.lFrame.currentDirectiveIndex}function aw(n){be.lFrame.currentDirectiveIndex=n}function pP(n){be.lFrame.currentQueryIndex=n}function nq(n){let e=n[Ce];return e.type===2?e.declTNode:e.type===1?n[Sr]:null}function mP(n,e,t){if(t&Ie.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&Ie.Host);)if(i=nq(s),i===null||(s=s[fc],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=be.lFrame=gP();return r.currentTNode=e,r.lView=n,!0}function Jw(n){let e=gP(),t=n[Ce];be.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function gP(){let n=be.lFrame,e=n===null?null:n.child;return e===null?_P(n):e}function _P(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function yP(){let n=be.lFrame;return be.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var vP=yP;function Xw(){let n=yP();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function rq(n){return(be.lFrame.contextLView=jH(n,be.lFrame.contextLView))[Tr]}function mc(){return be.lFrame.selectedIndex}function Co(n){be.lFrame.selectedIndex=n}function Zw(){let n=be.lFrame;return cP(n.tView,n.selectedIndex)}function iq(){return be.lFrame.currentNamespace}var wP=!0;function eI(){return wP}function tI(n){wP=n}function sq(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=sP(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function nI(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function dp(n,e,t){IP(n,e,3,t)}function hp(n,e,t,r){(n[ue]&3)===t&&IP(n,e,t,r)}function Hv(n,e){let t=n[ue];(t&3)===e&&(t&=16383,t+=1,n[ue]=t)}function IP(n,e,t,r){let i=r!==void 0?n[tc]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[tc]+=65536),(a<s||s==-1)&&(oq(n,t,e,c),n[tc]=(n[tc]&4294901760)+c+2),c++}function rN(n,e){Hr(4,n,e);let t=Pe(null);try{e.call(n)}finally{Pe(t),Hr(5,n,e)}}function oq(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[ue]>>14<n[tc]>>16&&(n[ue]&3)===e&&(n[ue]+=16384,rN(a,s)):rN(a,s)}var sc=-1,To=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function aq(n){return n instanceof To}function cq(n){return(n.flags&8)!==0}function lq(n){return(n.flags&16)!==0}function EP(n){return n!==sc}function bp(n){return n&32767}function uq(n){return n>>16}function Cp(n,e){let t=uq(n),r=e;for(;t>0;)r=r[fc],t--;return r}var cw=!0;function Tp(n){let e=cw;return cw=n,e}var dq=256,bP=dq-1,CP=5,hq=0,qr={};function fq(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(xu)&&(r=t[xu]),r==null&&(r=t[xu]=hq++);let i=r&bP,s=1<<i;e.data[n+(i>>CP)]|=s}function Dp(n,e){let t=TP(n,e);if(t!==-1)return t;let r=e[Ce];r.firstCreatePass&&(n.injectorIndex=e.length,qv(r.data,n),qv(e,null),qv(r.blueprint,null));let i=rI(n,e),s=n.injectorIndex;if(EP(i)){let o=bp(i),a=Cp(i,e),c=a[Ce].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function qv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function TP(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function rI(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=xP(i),r===null)return sc;if(t++,i=i[fc],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return sc}function lw(n,e,t){fq(n,e,t)}function pq(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(jN(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function DP(n,e,t){if(t&Ie.Optional||n!==void 0)return n;Vw(e,"NodeInjector")}function SP(n,e,t,r){if(t&Ie.Optional&&r===void 0&&(r=null),!(t&(Ie.Self|Ie.Host))){let i=n[lc],s=Rn(void 0);try{return i?i.get(e,r,t&Ie.Optional):ON(e,r,t&Ie.Optional)}finally{Rn(s)}}return DP(r,e,t)}function AP(n,e,t,r=Ie.Default,i){if(n!==null){if(e[ue]&2048&&!(r&Ie.Self)){let o=vq(n,e,t,r,qr);if(o!==qr)return o}let s=RP(n,e,t,r,qr);if(s!==qr)return s}return SP(e,t,r,i)}function RP(n,e,t,r,i){let s=_q(t);if(typeof s=="function"){if(!mP(e,n,r))return r&Ie.Host?DP(i,t,r):SP(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&Ie.Optional))Vw(t);else return o}finally{vP()}}else if(typeof s=="number"){let o=null,a=TP(n,e),c=sc,l=r&Ie.Host?e[Gr][Sr]:null;for((a===-1||r&Ie.SkipSelf)&&(c=a===-1?rI(n,e):e[a+8],c===sc||!sN(r,!1)?a=-1:(o=e[Ce],a=bp(c),e=Cp(c,e)));a!==-1;){let d=e[Ce];if(iN(s,a,d.data)){let h=mq(a,e,t,o,r,l);if(h!==qr)return h}c=e[a+8],c!==sc&&sN(r,e[Ce].data[a+8]===l)&&iN(s,a,e)?(o=d,a=bp(c),e=Cp(c,e)):a=-1}}return i}function mq(n,e,t,r,i,s){let o=e[Ce],a=o.data[n+8],c=r==null?zp(a)&&cw:r!=o&&(a.type&3)!==0,l=i&Ie.Host&&s===a,d=gq(a,o,t,c,l);return d!==null?dc(e,o,d,a):qr}function gq(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,d=s>>20,h=r?a:a+d,p=i?a+d:l;for(let _=h;_<p;_++){let w=o[_];if(_<c&&t===w||_>=c&&w.type===t)return _}if(i){let _=o[c];if(_&&hs(_)&&_.type===t)return c}return null}function dc(n,e,t,r){let i=n[t],s=e.data;if(aq(i)){let o=i;o.resolving&&q$(H$(s[t]));let a=Tp(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?Rn(o.injectImpl):null,d=mP(n,r,Ie.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&sq(t,s[t],e)}finally{l!==null&&Rn(l),Tp(a),o.resolving=!1,vP()}}return i}function _q(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(xu)?n[xu]:void 0;return typeof e=="number"?e>=0?e&bP:yq:e}function iN(n,e,t){let r=1<<n;return!!(t[e+(n>>CP)]&r)}function sN(n,e){return!(n&Ie.Self)&&!(n&Ie.Host&&e)}var wo=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return AP(this._tNode,this._lView,e,Bp(r),t)}};function yq(){return new wo(Hn(),je())}function Ro(n){return ju(()=>{let e=n.prototype.constructor,t=e[mp]||uw(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[mp]||uw(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function uw(n){return RN(n)?()=>{let e=uw(gn(n));return e&&e()}:Io(n)}function vq(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[ue]&2048&&!(o[ue]&512);){let a=RP(s,o,t,r|Ie.Self,qr);if(a!==qr)return a;let c=s.parent;if(!c){let l=o[tP];if(l){let d=l.get(t,qr,r);if(d!==qr)return d}c=xP(o),o=o[fc]}s=c}return i}function xP(n){let e=n[Ce],t=e.type;return t===2?e.declTNode:t===1?n[Sr]:null}function iI(n){return pq(Hn(),n)}function oN(n,e=null,t=null,r){let i=NP(n,e,t,r);return i.resolveInjectorInitializers(),i}function NP(n,e=null,t=null,r,i=new Set){let s=[t||br,mH(n)];return r=r||(typeof n=="object"?void 0:xn(n)),new ku(s,e||Hw(),r||null,i)}var Ar=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return oN({name:""},i,r,"");{let s=r.name??"";return oN({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Pu,e.NULL=new yp,e.\u0275prov=se({token:e,providedIn:"any",factory:()=>oe(VN)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var wq="ngOriginalError";function zv(n){return n[wq]}var Qr=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&zv(e);for(;t&&zv(t);)t=zv(t);return t||null}},PP=new de("",{providedIn:"root",factory:()=>Q(Qr).handleError.bind(void 0)}),sI=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Iq,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),dw=class extends sI{constructor(e){super(),this._lView=e}onDestroy(e){return uP(this._lView,e),()=>$H(this._lView,e)}};function Iq(){return new dw(je())}function Eq(){return Gp(Hn(),je())}function Gp(n,e){return new Li(sr(n,e))}var Li=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=Eq;let n=e;return n})();var hw=class extends nn{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,eP()&&(this.destroyRef=Q(sI,{optional:!0})??void 0)}emit(e){let t=Pe(null);try{super.next(e)}finally{Pe(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Gv(s),i&&(i=Gv(i)),o&&(o=Gv(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Ot&&e.add(a),a}};function Gv(n){return e=>{setTimeout(n,void 0,e)}}var rn=hw;function MP(n){return(n.flags&128)===128}var kP=new Map,bq=0;function Cq(){return bq++}function Tq(n){kP.set(n[qp],n)}function Dq(n){kP.delete(n[qp])}var aN="__ngContext__";function Do(n,e){vo(e)?(n[aN]=e[qp],Tq(e)):n[aN]=e}function OP(n){return LP(n[Fu])}function FP(n){return LP(n[Cr])}function LP(n){for(;n!==null&&!Fi(n);)n=n[Cr];return n}var fw;function VP(n){fw=n}function Sq(){if(fw!==void 0)return fw;if(typeof document<"u")return document;throw new re(210,!1)}var Wp=new de("",{providedIn:"root",factory:()=>Aq}),Aq="ng",oI=new de(""),ms=new de("",{providedIn:"platform",factory:()=>"unknown"});var aI=new de("",{providedIn:"root",factory:()=>Sq().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Rq="h",xq="b";var Nq=()=>null;function cI(n,e,t=!1){return Nq(n,e,t)}var UP=!1,Pq=new de("",{providedIn:"root",factory:()=>UP});var ap;function Mq(){if(ap===void 0&&(ap=null,_n.trustedTypes))try{ap=_n.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return ap}function cN(n){return Mq()?.createScriptURL(n)||n}var Sp=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${SN})`}};function Kp(n){return n instanceof Sp?n.changingThisBreaksApplicationSecurity:n}function lI(n,e){let t=kq(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${SN})`)}return t===e}function kq(n){return n instanceof Sp&&n.getTypeName()||null}var Oq=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function BP(n){return n=String(n),n.match(Oq)?n:"unsafe:"+n}var Qp=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Qp||{});function Yp(n){let e=$P();return e?e.sanitize(Qp.URL,n)||"":lI(n,"URL")?Kp(n):BP(jn(n))}function Fq(n){let e=$P();if(e)return cN(e.sanitize(Qp.RESOURCE_URL,n)||"");if(lI(n,"ResourceURL"))return cN(Kp(n));throw new re(904,!1)}function Lq(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?Fq:Yp}function jP(n,e,t){return Lq(e,t)(n)}function $P(){let n=je();return n&&n[Dr].sanitizer}function HP(n){return n instanceof Function?n():n}function Vq(n){return(n??Q(Ar)).get(ms)==="browser"}var xo=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(xo||{}),Uq;function uI(n,e){return Uq(n,e)}function nc(n,e,t,r,i){if(r!=null){let s,o=!1;Fi(r)?s=r:vo(r)&&(o=!0,r=r[Oi]);let a=Kr(r);n===0&&t!==null?i==null?KP(e,t,a):Ap(e,t,a,i||null,!0):n===1&&t!==null?Ap(e,t,a,i||null,!0):n===2?n4(e,a,o):n===3&&e.destroyNode(a),s!=null&&i4(e,n,s,t,i)}}function Bq(n,e){return n.createText(e)}function jq(n,e,t){n.setValue(e,t)}function qP(n,e,t){return n.createElement(e,t)}function $q(n,e){zP(n,e),e[Oi]=null,e[Sr]=null}function Hq(n,e,t,r,i,s){r[Oi]=i,r[Sr]=e,Jp(n,r,t,1,i,s)}function zP(n,e){e[Dr].changeDetectionScheduler?.notify(1),Jp(n,e,e[Qt],2,null,null)}function qq(n){let e=n[Fu];if(!e)return Wv(n[Ce],n);for(;e;){let t=null;if(vo(e))t=e[Fu];else{let r=e[rr];r&&(t=r)}if(!t){for(;e&&!e[Cr]&&e!==n;)vo(e)&&Wv(e[Ce],e),e=e[sn];e===null&&(e=n),vo(e)&&Wv(e[Ce],e),t=e&&e[Cr]}e=t}}function zq(n,e,t,r){let i=rr+r,s=t.length;r>0&&(t[i-1][Cr]=e),r<s-rr?(e[Cr]=t[i],LN(t,rr+r,e)):(t.push(e),e[Cr]=null),e[sn]=t;let o=e[Hp];o!==null&&t!==o&&Gq(o,e);let a=e[uc];a!==null&&a.insertView(n),ow(e),e[ue]|=128}function Gq(n,e){let t=n[Ip],i=e[sn][sn][Gr];e[Gr]!==i&&(n[ue]|=qw.HasTransplantedViews),t===null?n[Ip]=[e]:t.push(e)}function GP(n,e){let t=n[Ip],r=t.indexOf(e);t.splice(r,1)}function pw(n,e){if(n.length<=rr)return;let t=rr+e,r=n[t];if(r){let i=r[Hp];i!==null&&i!==n&&GP(i,r),e>0&&(n[t-1][Cr]=r[Cr]);let s=_p(n,rr+e);$q(r[Ce],r);let o=s[uc];o!==null&&o.detachView(s[Ce]),r[sn]=null,r[Cr]=null,r[ue]&=-129}return r}function WP(n,e){if(!(e[ue]&256)){let t=e[Qt];t.destroyNode&&Jp(n,e,t,3,null,null),qq(e)}}function Wv(n,e){if(e[ue]&256)return;let t=Pe(null);try{e[ue]&=-129,e[ue]|=256,e[Eo]&&mx(e[Eo]),Kq(n,e),Wq(n,e),e[Ce].type===1&&e[Qt].destroy();let r=e[Hp];if(r!==null&&Fi(e[sn])){r!==e[sn]&&GP(r,e);let i=e[uc];i!==null&&i.detachView(n)}Dq(e)}finally{Pe(t)}}function Wq(n,e){let t=n.cleanup,r=e[Ou];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[Ou]=null);let i=e[us];if(i!==null){e[us]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function Kq(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof To)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Hr(4,a,c);try{c.call(a)}finally{Hr(5,a,c)}}else{Hr(4,i,s);try{s.call(i)}finally{Hr(5,i,s)}}}}}function Qq(n,e,t){return Yq(n,e.parent,t)}function Yq(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[Oi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===zr.None||s===zr.Emulated)return null}return sr(r,t)}}function Ap(n,e,t,r,i){n.insertBefore(e,t,r,i)}function KP(n,e,t){n.appendChild(e,t)}function lN(n,e,t,r,i){r!==null?Ap(n,e,t,r,i):KP(n,e,t)}function Jq(n,e,t,r){n.removeChild(e,t,r)}function dI(n,e){return n.parentNode(e)}function Xq(n,e){return n.nextSibling(e)}function Zq(n,e,t){return t4(n,e,t)}function e4(n,e,t){return n.type&40?sr(n,t):null}var t4=e4,uN;function hI(n,e,t,r){let i=Qq(n,r,e),s=e[Qt],o=r.parent||e[Sr],a=Zq(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)lN(s,i,t[c],a,!1);else lN(s,i,t,a,!1);uN!==void 0&&uN(s,r,e,t,i)}function fp(n,e){if(e!==null){let t=e.type;if(t&3)return sr(e,n);if(t&4)return mw(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return fp(n,r);{let i=n[e.index];return Fi(i)?mw(-1,i):Kr(i)}}else{if(t&32)return uI(e,n)()||Kr(n[e.index]);{let r=QP(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Vu(n[Gr]);return fp(i,r)}else return fp(n,e.next)}}}return null}function QP(n,e){if(e!==null){let r=n[Gr][Sr],i=e.projection;return r.projection[i]}return null}function mw(n,e){let t=rr+n+1;if(t<e.length){let r=e[t],i=r[Ce].firstChild;if(i!==null)return fp(r,i)}return e[bo]}function n4(n,e,t){let r=dI(n,e);r&&Jq(n,r,e,t)}function fI(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&e===0&&(a&&Do(Kr(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)fI(n,e,t.child,r,i,s,!1),nc(e,n,i,a,s);else if(c&32){let l=uI(t,r),d;for(;d=l();)nc(e,n,i,d,s);nc(e,n,i,a,s)}else c&16?r4(n,e,r,t,i,s):nc(e,n,i,a,s);t=o?t.projectionNext:t.next}}function Jp(n,e,t,r,i,s){fI(t,r,n.firstChild,e,i,s,!1)}function r4(n,e,t,r,i,s){let o=t[Gr],c=o[Sr].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];nc(e,n,i,d,s)}else{let l=c,d=o[sn];MP(r)&&(l.flags|=128),fI(n,e,l,d,i,s,!0)}}function i4(n,e,t,r,i){let s=t[bo],o=Kr(t);s!==o&&nc(e,n,r,s,i);for(let a=rr;a<t.length;a++){let c=t[a];Jp(c[Ce],c,n,e,r,s)}}function s4(n,e,t){n.setAttribute(e,"style",t)}function YP(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function JP(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&tw(n,e,r),i!==null&&YP(n,e,i),s!==null&&s4(n,e,s)}var ar={};function he(n=1){XP(or(),je(),mc()+n,!1)}function XP(n,e,t,r){if(!r)if((e[ue]&3)===3){let s=n.preOrderCheckHooks;s!==null&&dp(e,s,t)}else{let s=n.preOrderHooks;s!==null&&hp(e,s,0,t)}Co(t)}function te(n,e=Ie.Default){let t=je();if(t===null)return oe(n,e);let r=Hn();return AP(r,t,gn(n),e)}function ZP(){let n="invalid";throw new Error(n)}function eM(n,e,t,r,i,s){let o=Pe(null);try{let a=null;i&ir.SignalBased&&(a=e[r][dx]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&ir.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):iP(e,a,r,s)}finally{Pe(o)}}function o4(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Co(~i);else{let s=i,o=t[++r],a=t[++r];eq(o,s);let c=e[s];a(2,c)}}}finally{Co(-1)}}function Xp(n,e,t,r,i,s,o,a,c,l,d){let h=e.blueprint.slice();return h[Oi]=i,h[ue]=r|4|128|8|64,(l!==null||n&&n[ue]&2048)&&(h[ue]|=2048),lP(h),h[sn]=h[fc]=n,h[Tr]=t,h[Dr]=o||n&&n[Dr],h[Qt]=a||n&&n[Qt],h[lc]=c||n&&n[lc]||null,h[Sr]=s,h[qp]=Cq(),h[vp]=d,h[tP]=l,h[Gr]=e.type==2?n[Gr]:h,h}function Zp(n,e,t,r,i){let s=n.data[e];if(s===null)s=a4(n,e,t,r,i),ZH()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=QH();s.injectorIndex=o===null?-1:o.injectorIndex}return Hu(s,!0),s}function a4(n,e,t,r,i){let s=hP(),o=fP(),a=o?s:s&&s.parent,c=n.data[e]=h4(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function tM(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function nM(n,e,t,r,i){let s=mc(),o=r&2;try{Co(-1),o&&e.length>Wr&&XP(n,e,Wr,!1),Hr(o?2:0,i),t(r,i)}finally{Co(s),Hr(o?3:1,i)}}function rM(n,e,t){if(rP(e)){let r=Pe(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Pe(r)}}}function iM(n,e,t){dP()&&(y4(n,e,t,sr(t,e)),(t.flags&64)===64&&uM(n,e,t))}function sM(n,e,t=sr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function oM(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=pI(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function pI(n,e,t,r,i,s,o,a,c,l,d){let h=Wr+r,p=h+i,_=c4(h,p),w=typeof l=="function"?l():l;return _[Ce]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:d}}function c4(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:ar);return t}function l4(n,e,t,r){let s=r.get(Pq,UP)||t===zr.ShadowDom,o=n.selectRootElement(e,s);return u4(o),o}function u4(n){d4(n)}var d4=()=>null;function h4(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return GH()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function dN(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=ir.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?hN(r,t,l,a,c):hN(r,t,l,a)}return r}function hN(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function f4(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,l=null;for(let d=r;d<i;d++){let h=s[d],p=t?t.get(h):null,_=p?p.inputs:null,w=p?p.outputs:null;c=dN(0,h.inputs,d,c,_),l=dN(1,h.outputs,d,l,w);let S=c!==null&&o!==null&&!jw(e)?R4(c,d,o):null;a.push(S)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function p4(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function aM(n,e,t,r,i,s,o,a){let c=sr(e,t),l=e.inputs,d;!a&&l!=null&&(d=l[r])?(mI(n,t,d,r,i),zp(e)&&m4(t,e.index)):e.type&3?(r=p4(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function m4(n,e){let t=ps(e,n);t[ue]&16||(t[ue]|=64)}function cM(n,e,t,r){if(dP()){let i=r===null?null:{"":-1},s=w4(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&lM(n,e,t,o,i,a),i&&I4(t,r,i)}t.mergedAttrs=Mu(t.mergedAttrs,t.attrs)}function lM(n,e,t,r,i,s){for(let l=0;l<r.length;l++)lw(Dp(t,e),n,r[l].type);b4(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=tM(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=Mu(t.mergedAttrs,d.hostAttrs),C4(n,t,e,c,d),E4(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}f4(n,t,s)}function g4(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;_4(o)!=a&&o.push(a),o.push(t,r,s)}}function _4(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function y4(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;zp(t)&&T4(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Dp(t,e),Do(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],l=dc(e,n,a,t);if(Do(l,e),o!==null&&A4(e,a-i,l,c,t,o),hs(c)){let d=ps(t.index,e);d[Tr]=dc(e,n,a,t)}}}function uM(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=tq();try{Co(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];aw(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&v4(c,l)}}finally{Co(-1),aw(o)}}function v4(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function w4(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(oH(e,o.selectors,!1))if(r||(r=[]),hs(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;gw(n,e,c)}else r.unshift(o),gw(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function gw(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function I4(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new re(-301,!1);r.push(e[i],s)}}}function E4(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;hs(e)&&(t[""]=n)}}function b4(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function C4(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Io(i.type,!0)),o=new To(s,hs(i),te);n.blueprint[r]=o,t[r]=o,g4(n,e,r,tM(n,t,i.hostVars,ar),i)}function T4(n,e,t){let r=sr(e,n),i=oM(t),s=n[Dr].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=em(n,Xp(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function D4(n,e,t,r,i,s){let o=sr(n,e);S4(e[Qt],o,s,n.value,t,r,i)}function S4(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?jn(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function A4(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],d=o[a++],h=o[a++];eM(r,t,c,l,d,h)}}function R4(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function dM(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function hM(n,e){let t=n.contentQueries;if(t!==null){let r=Pe(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];pP(s),a.contentQueries(2,e[o],o)}}}finally{Pe(r)}}}function em(n,e){return n[Fu]?n[tN][Cr]=e:n[Fu]=e,n[tN]=e,e}function _w(n,e,t){pP(0);let r=Pe(null);try{e(n,t)}finally{Pe(r)}}function x4(n){return n[Ou]||(n[Ou]=[])}function N4(n){return n.cleanup||(n.cleanup=[])}function fM(n,e){let t=n[lc],r=t?t.get(Qr,null):null;r&&r.handleError(e)}function mI(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],d=n.data[o];eM(d,l,r,a,c,i)}}function tm(n,e,t){let r=LH(e,n);jq(n[Qt],r,t)}function P4(n,e){let t=ps(e,n),r=t[Ce];M4(r,t);let i=t[Oi];i!==null&&t[vp]===null&&(t[vp]=cI(i,t[lc])),gI(r,t,t[Tr])}function M4(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function gI(n,e,t){Jw(e);try{let r=n.viewQuery;r!==null&&_w(1,r,t);let i=n.template;i!==null&&nM(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[uc]?.finishViewCreation(n),n.staticContentQueries&&hM(n,e),n.staticViewQueries&&_w(2,n.viewQuery,t);let s=n.components;s!==null&&k4(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ue]&=-5,Xw()}}function k4(n,e){for(let t=0;t<e.length;t++)P4(n,e[t])}function O4(n,e,t,r){let i=Pe(null);try{let s=e.tView,a=n[ue]&4096?4096:16,c=Xp(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[Hp]=l;let d=n[uc];return d!==null&&(c[uc]=d.createEmbeddedView(s)),gI(s,c,t),c}finally{Pe(i)}}function fN(n,e){return!e||e.firstChild===null||MP(n)}function F4(n,e,t,r=!0){let i=e[Ce];if(zq(i,e,n,t),r){let o=mw(t,n),a=e[Qt],c=dI(a,n[bo]);c!==null&&Hq(i,n[Sr],a,e,c,o)}let s=e[vp];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Rp(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(Kr(s)),Fi(s)&&L4(s,r);let o=t.type;if(o&8)Rp(n,e,t.child,r);else if(o&32){let a=uI(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=QP(e,t);if(Array.isArray(a))r.push(...a);else{let c=Vu(e[Gr]);Rp(c[Ce],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function L4(n,e){for(let t=rr;t<n.length;t++){let r=n[t],i=r[Ce].firstChild;i!==null&&Rp(r[Ce],r,i,e)}n[bo]!==n[Oi]&&e.push(n[bo])}var pM=[];function V4(n){return n[Eo]??U4(n)}function U4(n){let e=pM.pop()??Object.create(j4);return e.lView=n,e}function B4(n){n.lView[Eo]!==n&&(n.lView=null,pM.push(n))}var j4=nt(H({},hx),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Lu(n.lView)},consumerOnSignalRead(){this.lView[Eo]=this}}),mM=100;function gM(n,e=!0,t=0){let r=n[Dr],i=r.rendererFactory,s=!1;s||i.begin?.();try{$4(n,t)}catch(o){throw e&&fM(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function $4(n,e){yw(n,e);let t=0;for(;Ww(n);){if(t===mM)throw new re(103,!1);t++,yw(n,1)}}function H4(n,e,t,r){let i=e[ue];if((i&256)===256)return;let s=!1;!s&&e[Dr].inlineEffectRunner?.flush(),Jw(e);let o=null,a=null;!s&&q4(n)&&(a=V4(e),o=fx(a));try{lP(e),XH(n.bindingStartIndex),t!==null&&nM(n,e,t,2,r);let c=(i&3)===3;if(!s)if(c){let h=n.preOrderCheckHooks;h!==null&&dp(e,h,null)}else{let h=n.preOrderHooks;h!==null&&hp(e,h,0,null),Hv(e,0)}if(z4(e),_M(e,0),n.contentQueries!==null&&hM(n,e),!s)if(c){let h=n.contentCheckHooks;h!==null&&dp(e,h)}else{let h=n.contentHooks;h!==null&&hp(e,h,1),Hv(e,1)}o4(n,e);let l=n.components;l!==null&&vM(e,l,0);let d=n.viewQuery;if(d!==null&&_w(2,d,r),!s)if(c){let h=n.viewCheckHooks;h!==null&&dp(e,h)}else{let h=n.viewHooks;h!==null&&hp(e,h,2),Hv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[$v]){for(let h of e[$v])h();e[$v]=null}s||(e[ue]&=-73)}catch(c){throw Lu(e),c}finally{a!==null&&(px(a,o),B4(a)),Xw()}}function q4(n){return n.type!==2}function _M(n,e){for(let t=OP(n);t!==null;t=FP(t))for(let r=rr;r<t.length;r++){let i=t[r];yM(i,e)}}function z4(n){for(let e=OP(n);e!==null;e=FP(e)){if(!(e[ue]&qw.HasTransplantedViews))continue;let t=e[Ip];for(let r=0;r<t.length;r++){let i=t[r],s=i[sn];BH(i)}}}function G4(n,e,t){let r=ps(e,n);yM(r,t)}function yM(n,e){Gw(n)&&yw(n,e)}function yw(n,e){let r=n[Ce],i=n[ue],s=n[Eo],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&bv(s)),s&&(s.dirty=!1),n[ue]&=-9217,o)H4(r,n,r.template,n[Tr]);else if(i&8192){_M(n,1);let a=r.components;a!==null&&vM(n,a,1)}}function vM(n,e,t){for(let r=0;r<e.length;r++)G4(n,e[r],t)}function _I(n){for(n[Dr].changeDetectionScheduler?.notify();n;){n[ue]|=64;let e=Vu(n);if(RH(n)&&!e)return n;n=e}return null}var So=class{get rootNodes(){let e=this._lView,t=e[Ce];return Rp(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Tr]}set context(e){this._lView[Tr]=e}get destroyed(){return(this._lView[ue]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[sn];if(Fi(e)){let t=e[wp],r=t?t.indexOf(this):-1;r>-1&&(pw(e,r),_p(t,r))}this._attachedToViewContainer=!1}WP(this._lView[Ce],this._lView)}onDestroy(e){uP(this._lView,e)}markForCheck(){_I(this._cdRefInjectingView||this._lView)}detach(){this._lView[ue]&=-129}reattach(){ow(this._lView),this._lView[ue]|=128}detectChanges(){this._lView[ue]|=1024,gM(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new re(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,zP(this._lView[Ce],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new re(902,!1);this._appRef=e,ow(this._lView)}},nm=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Q4;let n=e;return n})(),W4=nm,K4=class extends W4{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=O4(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new So(i)}};function Q4(){return Y4(Hn(),je())}function Y4(n,e){return n.type&4?new K4(e,n,Gp(n,e)):null}var eoe=new RegExp(`^(\\d+)*(${xq}|${Rq})*(.*)`);var J4=()=>null;function pN(n,e){return J4(n,e)}var xp=class{},vw=class{},Np=class{};function X4(n){let e=Error(`No component factory found for ${xn(n)}.`);return e[Z4]=n,e}var Z4="ngComponent";var ww=class{resolveComponentFactory(e){throw X4(e)}},rm=(()=>{let e=class e{};e.NULL=new ww;let n=e;return n})(),Uu=class{},gs=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>ez();let n=e;return n})();function ez(){let n=je(),e=Hn(),t=ps(e.index,n);return(vo(t)?t:n)[Qt]}var tz=(()=>{let e=class e{};e.\u0275prov=se({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),Kv={};var mN=new Set;function yI(n){mN.has(n)||(mN.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function gN(...n){}function nz(){let n=typeof _n.requestAnimationFrame=="function",e=_n[n?"requestAnimationFrame":"setTimeout"],t=_n[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var Ke=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new rn(!1),this.onMicrotaskEmpty=new rn(!1),this.onStable=new rn(!1),this.onError=new rn(!1),typeof Zone>"u")throw new re(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=nz().nativeRequestAnimationFrame,sz(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new re(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new re(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,rz,gN,gN);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},rz={};function vI(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function iz(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(_n,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Iw(n),n.isCheckStableRunning=!0,vI(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Iw(n))}function sz(n){let e=()=>{iz(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(oz(a))return t.invokeTask(i,s,o,a);try{return _N(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),yN(n)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return _N(n),t.invoke(i,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),yN(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Iw(n),vI(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Iw(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function _N(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function yN(n){n._nesting--,vI(n)}var Ew=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new rn,this.onMicrotaskEmpty=new rn,this.onStable=new rn,this.onError=new rn}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function oz(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}function az(n="zone.js",e){return n==="noop"?new Ew:n==="zone.js"?new Ke(e):n}var rc=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(rc||{}),cz={destroy(){}};function im(n,e){!e&&DH(im);let t=e?.injector??Q(Ar);if(!Vq(t))return cz;yI("NgAfterNextRender");let r=t.get(wI),i=r.handler??=new Cw,s=e?.phase??rc.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(sI).onDestroy(o),c=ki(t,()=>new bw(s,()=>{o(),n()}));return i.register(c),{destroy:o}}var bw=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=Q(Ke),this.errorHandler=Q(Qr,{optional:!0}),Q(xp,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Cw=class{constructor(){this.executingCallbacks=!1,this.buckets={[rc.EarlyRead]:new Set,[rc.Write]:new Set,[rc.MixedReadWrite]:new Set,[rc.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},wI=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=se({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function Tw(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=zx(i,a);else if(s==2){let c=a,l=e[++o];r=zx(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Pp=class extends rm{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=ds(e);return new hc(t,this.ngModule)}};function vN(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function lz(n){let e=n.toLowerCase();return e==="svg"?MH:e==="math"?kH:null}var Dw=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Bp(r);let i=this.injector.get(e,Kv,r);return i!==Kv||t===Kv?i:this.parentInjector.get(e,t,r)}},hc=class extends Np{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=vN(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return vN(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=uH(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Pe(null);try{i=i||this.ngModule;let o=i instanceof Nn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Dw(e,o):e,c=a.get(Uu,null);if(c===null)throw new re(407,!1);let l=a.get(tz,null),d=a.get(wI,null),h=a.get(xp,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},_=c.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",S=r?l4(_,r,this.componentDef.encapsulation,a):qP(_,w,lz(w)),R=512;this.componentDef.signals?R|=4096:this.componentDef.onPush||(R|=16);let L=null;S!==null&&(L=cI(S,a,!0));let K=pI(0,null,null,1,0,null,null,null,null,null,null),B=Xp(null,K,null,R,null,null,p,_,a,null,L);Jw(B);let J,ce;try{let ee=this.componentDef,b,v=null;ee.findHostDirectiveDefs?(b=[],v=new Map,ee.findHostDirectiveDefs(ee,b,v),b.push(ee)):b=[ee];let I=uz(B,S),D=dz(I,S,ee,b,B,p,_);ce=cP(K,Wr),S&&pz(_,ee,S,r),t!==void 0&&mz(ce,this.ngContentSelectors,t),J=fz(D,ee,b,v,B,[gz]),gI(K,B,null)}finally{Xw()}return new Sw(this.componentType,J,Gp(ce,B),B,ce)}finally{Pe(s)}}},Sw=class extends vw{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new So(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;mI(s[Ce],s,i,e,t),this.previousInputValues.set(e,t);let o=ps(this._tNode.index,s);_I(o)}}get injector(){return new wo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function uz(n,e){let t=n[Ce],r=Wr;return n[r]=e,Zp(t,r,2,"#host",null)}function dz(n,e,t,r,i,s,o){let a=i[Ce];hz(r,n,e,o);let c=null;e!==null&&(c=cI(e,i[lc]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=Xp(i,oM(t),null,d,i[n.index],n,s,l,null,null,c);return a.firstCreatePass&&gw(a,n,r.length-1),em(i,h),i[n.index]=h}function hz(n,e,t,r){for(let i of n)e.mergedAttrs=Mu(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Tw(e,e.mergedAttrs,!0),t!==null&&JP(r,t,e))}function fz(n,e,t,r,i,s){let o=Hn(),a=i[Ce],c=sr(o,i);lM(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,p=dc(i,a,h,o);Do(p,i)}uM(a,i,o),c&&Do(c,i);let l=dc(i,a,o.directiveStart+o.componentOffset,o);if(n[Tr]=i[Tr]=l,s!==null)for(let d of s)d(l,e);return rM(a,o,i),l}function pz(n,e,t,r){if(r)tw(n,t,["ng-version","17.3.11"]);else{let{attrs:i,classes:s}=dH(e.selectors[0]);i&&tw(n,t,i),s&&s.length>0&&YP(n,t,s.join(" "))}}function mz(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function gz(){let n=Hn();nI(je()[Ce],n)}var gc=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=_z;let n=e;return n})();function _z(){let n=Hn();return vz(n,je())}var yz=gc,wM=class extends yz{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Gp(this._hostTNode,this._hostLView)}get injector(){return new wo(this._hostTNode,this._hostLView)}get parentInjector(){let e=rI(this._hostTNode,this._hostLView);if(EP(e)){let t=Cp(e,this._hostLView),r=bp(e),i=t[Ce].data[r+8];return new wo(i,t)}else return new wo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=wN(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-rr}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=pN(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,fN(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!AH(e),a;if(o)a=t;else{let w=t||{};a=w.index,r=w.injector,i=w.projectableNodes,s=w.environmentInjector||w.ngModuleRef}let c=o?e:new hc(ds(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let S=(o?l:this.parentInjector).get(Nn,null);S&&(s=S)}let d=ds(c.componentType??{}),h=pN(this._lContainer,d?.id??null),p=h?.firstChild??null,_=c.create(l,i,p,s);return this.insertImpl(_.hostView,a,fN(this._hostTNode,h)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(UH(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[sn],l=new wM(c,c[Sr],c[sn]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return F4(o,i,s,r),e.attachToViewContainerRef(),LN(Qv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=wN(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=pw(this._lContainer,t);r&&(_p(Qv(this._lContainer),t),WP(r[Ce],r))}detach(e){let t=this._adjustIndex(e,-1),r=pw(this._lContainer,t);return r&&_p(Qv(this._lContainer),t)!=null?new So(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function wN(n){return n[wp]}function Qv(n){return n[wp]||(n[wp]=[])}function vz(n,e){let t,r=e[n.index];return Fi(r)?t=r:(t=dM(r,e,null,n),e[n.index]=t,em(e,t)),Iz(t,e,n,r),new wM(t,n,e)}function wz(n,e){let t=n[Qt],r=t.createComment(""),i=sr(e,n),s=dI(t,i);return Ap(t,s,r,Xq(t,i),!1),r}var Iz=Cz,Ez=()=>!1;function bz(n,e,t){return Ez(n,e,t)}function Cz(n,e,t,r){if(n[bo])return;let i;t.type&8?i=Kr(r):i=wz(e,t),n[bo]=i}function Tz(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(Rz))}return s}return Mp.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,d=i.styleUrls;i.styleUrls.forEach((h,p)=>{a.push(""),o.push(r(h).then(_=>{a[l+p]=_,d.splice(d.indexOf(h),1),d.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>xz(s));e.push(c)}),Sz(),Promise.all(e).then(()=>{})}var Mp=new Map,Dz=new Set;function Sz(){let n=Mp;return Mp=new Map,n}function Az(){return Mp.size===0}function Rz(n){return typeof n=="string"?n:n.text()}function xz(n){Dz.delete(n)}function Nz(n){return Object.getPrototypeOf(n.prototype).constructor}function qu(n){let e=Nz(n.type),t=!0,r=[n];for(;e;){let i;if(hs(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new re(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let o=n;o.inputs=cp(n.inputs),o.inputTransforms=cp(n.inputTransforms),o.declaredInputs=cp(n.declaredInputs),o.outputs=cp(n.outputs);let a=i.hostBindings;a&&Fz(n,a);let c=i.viewQuery,l=i.contentQueries;if(c&&kz(n,c),l&&Oz(n,l),Pz(n,i),O$(n.outputs,i.outputs),hs(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===qu&&(t=!1)}}e=Object.getPrototypeOf(e)}Mz(r)}function Pz(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function Mz(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Mu(i.hostAttrs,t=Mu(t,i.hostAttrs))}}function cp(n){return n===oc?{}:n===br?[]:n}function kz(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function Oz(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function Fz(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function II(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var fs=class{},Bu=class{};var kp=class extends fs{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Pp(this);let i=WN(e);this._bootstrapComponents=HP(i.bootstrap),this._r3Injector=NP(e,t,[{provide:fs,useValue:this},{provide:rm,useValue:this.componentFactoryResolver},...r],xn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Op=class extends Bu{constructor(e){super(),this.moduleType=e}create(e){return new kp(this.moduleType,e,[])}};function Lz(n,e,t){return new kp(n,e,t)}var Aw=class extends fs{constructor(e){super(),this.componentFactoryResolver=new Pp(this),this.instance=null;let t=new ku([...e.providers,{provide:fs,useValue:this},{provide:rm,useValue:this.componentFactoryResolver}],e.parent||Hw(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function sm(n,e,t=null){return new Aw({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var om=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Me(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function IM(n){return Uz(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function Vz(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function Uz(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Bz(n,e,t){return n[e]=t}function Ao(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function Fp(n,e,t,r){let i=Ao(n,e,t);return Ao(n,e+1,r)||i}function jz(n,e,t,r,i){let s=Fp(n,e,t,r);return Ao(n,e+2,i)||s}function $z(n,e,t,r,i,s){let o=Fp(n,e,t,r);return Fp(n,e+2,i,s)||o}function Hz(n){return(n.flags&32)===32}function qz(n,e,t,r,i,s,o,a,c){let l=e.consts,d=Zp(e,n,4,o||null,Ep(l,a));cM(e,t,d,Ep(l,c)),nI(e,d);let h=d.tView=pI(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}function Ft(n,e,t,r,i,s,o,a){let c=je(),l=or(),d=n+Wr,h=l.firstCreatePass?qz(d,l,c,e,t,r,i,s,o):l.data[d];Hu(h,!1);let p=zz(l,c,h,n);eI()&&hI(l,c,p,h),Do(p,c);let _=dM(p,c,p,h);return c[d]=_,em(c,_),bz(_,h,c),zw(h)&&iM(l,c,h),o!=null&&sM(c,h,a),Ft}var zz=Gz;function Gz(n,e,t,r){return tI(!0),e[Qt].createComment("")}function am(n,e,t,r){let i=je(),s=Qw();if(Ao(i,s,e)){let o=or(),a=Zw();D4(a,i,n,e,t,r)}return am}function EM(n,e,t,r){return Ao(n,Qw(),t)?e+jn(t)+r:ar}function Wz(n,e,t,r,i,s){let o=Kw(),a=Fp(n,o,t,i);return Yw(2),a?e+jn(t)+r+jn(i)+s:ar}function Kz(n,e,t,r,i,s,o,a){let c=Kw(),l=jz(n,c,t,i,o);return Yw(3),l?e+jn(t)+r+jn(i)+s+jn(o)+a:ar}function Qz(n,e,t,r,i,s,o,a,c,l){let d=Kw(),h=$z(n,d,t,i,o,c);return Yw(4),h?e+jn(t)+r+jn(i)+s+jn(o)+a+jn(c)+l:ar}function Qe(n,e,t){let r=je(),i=Qw();if(Ao(r,i,e)){let s=or(),o=Zw();aM(s,o,r,n,e,r[Qt],t,!1)}return Qe}function IN(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";mI(n,t,s[o],o,r)}function Yz(n,e,t,r,i,s){let o=e.consts,a=Ep(o,i),c=Zp(e,n,2,r,a);return cM(e,t,c,Ep(o,s)),c.attrs!==null&&Tw(c,c.attrs,!1),c.mergedAttrs!==null&&Tw(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function C(n,e,t,r){let i=je(),s=or(),o=Wr+n,a=i[Qt],c=s.firstCreatePass?Yz(o,s,i,e,t,r):s.data[o],l=Jz(s,i,c,a,e,n);i[o]=l;let d=zw(c);return Hu(c,!0),JP(a,l,c),!Hz(c)&&eI()&&hI(s,i,l,c),HH()===0&&Do(l,i),qH(),d&&(iM(s,i,c),rM(s,c,i)),r!==null&&sM(i,c),C}function T(){let n=Hn();fP()?YH():(n=n.parent,Hu(n,!1));let e=n;WH(e)&&KH(),zH();let t=or();return t.firstCreatePass&&(nI(t,n),rP(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&cq(e)&&IN(t,e,je(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&lq(e)&&IN(t,e,je(),e.stylesWithoutHost,!1),T}function Z(n,e,t,r){return C(n,e,t,r),T(),Z}var Jz=(n,e,t,r,i,s)=>(tI(!0),qP(r,i,iq()));function qn(){return je()}var Lp="en-US";var Xz=Lp;function Zz(n){typeof n=="string"&&(Xz=n.toLowerCase().replace(/_/g,"-"))}function Y(n,e,t,r){let i=je(),s=or(),o=Hn();return t3(s,i,i[Qt],o,n,e,r),Y}function e3(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Ou],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function t3(n,e,t,r,i,s,o){let a=zw(r),l=n.firstCreatePass&&N4(n),d=e[Tr],h=x4(e),p=!0;if(r.type&3||o){let S=sr(r,e),R=o?o(S):S,L=h.length,K=o?J=>o(Kr(J[r.index])):r.index,B=null;if(!o&&a&&(B=e3(n,e,i,r.index)),B!==null){let J=B.__ngLastListenerFn__||B;J.__ngNextListenerFn__=s,B.__ngLastListenerFn__=s,p=!1}else{s=bN(r,e,d,s,!1);let J=t.listen(R,i,s);h.push(s,J),l&&l.push(i,K,L,L+1)}}else s=bN(r,e,d,s,!1);let _=r.outputs,w;if(p&&_!==null&&(w=_[i])){let S=w.length;if(S)for(let R=0;R<S;R+=2){let L=w[R],K=w[R+1],ce=e[L][K].subscribe(s),ee=h.length;h.push(s,ce),l&&l.push(i,r.index,ee,-(ee+1))}}}function EN(n,e,t,r){let i=Pe(null);try{return Hr(6,e,t),t(r)!==!1}catch(s){return fM(n,s),!1}finally{Hr(7,e,t),Pe(i)}}function bN(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?ps(n.index,e):e;_I(a);let c=EN(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)c=EN(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function yt(n=1){return rq(n)}function EI(n,e,t){return zu(n,"",e,"",t),EI}function zu(n,e,t,r,i){let s=je(),o=EM(s,e,t,r);if(o!==ar){let a=or(),c=Zw();aM(a,c,s,n,o,s[Qt],i,!1)}return zu}function n3(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function N(n,e=""){let t=je(),r=or(),i=n+Wr,s=r.firstCreatePass?Zp(r,i,1,e,null):r.data[i],o=r3(r,t,s,e,n);t[i]=o,eI()&&hI(r,t,o,s),Hu(s,!1)}var r3=(n,e,t,r,i)=>(tI(!0),Bq(e[Qt],r));function Lt(n){return No("",n,""),Lt}function No(n,e,t){let r=je(),i=EM(r,n,e,t);return i!==ar&&tm(r,mc(),i),No}function Gu(n,e,t,r,i){let s=je(),o=Wz(s,n,e,t,r,i);return o!==ar&&tm(s,mc(),o),Gu}function bI(n,e,t,r,i,s,o){let a=je(),c=Kz(a,n,e,t,r,i,s,o);return c!==ar&&tm(a,mc(),c),bI}function CI(n,e,t,r,i,s,o,a,c){let l=je(),d=Qz(l,n,e,t,r,i,s,o,a,c);return d!==ar&&tm(l,mc(),d),CI}function i3(n,e,t){let r=or();if(r.firstCreatePass){let i=hs(n);Rw(t,r.data,r.blueprint,i,!0),Rw(e,r.data,r.blueprint,i,!1)}}function Rw(n,e,t,r,i){if(n=gn(n),Array.isArray(n))for(let s=0;s<n.length;s++)Rw(n[s],e,t,r,i);else{let s=or(),o=je(),a=Hn(),c=cc(n)?n:gn(n.provide),l=ZN(n),d=a.providerIndexes&1048575,h=a.directiveStart,p=a.providerIndexes>>20;if(cc(n)||!n.multi){let _=new To(l,i,te),w=Jv(c,e,i?d:d+p,h);w===-1?(lw(Dp(a,o),s,c),Yv(s,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(_),o.push(_)):(t[w]=_,o[w]=_)}else{let _=Jv(c,e,d+p,h),w=Jv(c,e,d,d+p),S=_>=0&&t[_],R=w>=0&&t[w];if(i&&!R||!i&&!S){lw(Dp(a,o),s,c);let L=a3(i?o3:s3,t.length,i,r,l);!i&&R&&(t[w].providerFactory=L),Yv(s,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(L),o.push(L)}else{let L=bM(t[i?w:_],l,!i&&r);Yv(s,n,_>-1?_:w,L)}!i&&r&&R&&t[w].componentProviders++}}}function Yv(n,e,t,r){let i=cc(e),s=vH(e);if(i||s){let c=(s?gn(e.useClass):e).prototype.ngOnDestroy;if(c){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=l.indexOf(t);d===-1?l.push(t,[r,c]):l[d+1].push(r,c)}else l.push(t,c)}}}function bM(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Jv(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function s3(n,e,t,r){return xw(this.multi,[])}function o3(n,e,t,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=dc(t,t[Ce],this.providerFactory.index,r);s=a.slice(0,o),xw(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],xw(i,s);return s}function xw(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function a3(n,e,t,r,i){let s=new To(n,t,te);return s.multi=[],s.index=e,s.componentProviders=0,bM(s,i,r&&!t),s}function TI(n,e=[]){return t=>{t.providersResolver=(r,i)=>i3(r,i?i(n):n,e)}}var c3=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=YN(!1,r.type),s=i.length>0?sm([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=se({token:e,providedIn:"environment",factory:()=>new e(oe(Nn))});let n=e;return n})();function CM(n){yI("NgStandalone"),n.getStandaloneInjector=e=>e.get(c3).getOrCreateStandaloneInjector(n)}function l3(n,e){let t=n[e];return t===ar?void 0:t}function u3(n,e,t,r,i,s){let o=e+t;return Ao(n,o,i)?Bz(n,o+1,s?r.call(s,i):r(i)):l3(n,o+1)}function Yr(n,e){let t=or(),r,i=n+Wr;t.firstCreatePass?(r=d3(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=Io(r.type,!0)),o,a=Rn(te);try{let c=Tp(!1),l=s();return Tp(c),n3(t,je(),i,l),l}finally{Rn(a)}}function d3(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function Jr(n,e,t){let r=n+Wr,i=je(),s=VH(i,r);return h3(i,r)?u3(i,JH(),e,s.transform,t,s):s.transform(t)}function h3(n,e){return n[Ce].data[e].pure}var lp=null;function f3(n){lp!==null&&(n.defaultEncapsulation!==lp.defaultEncapsulation||n.preserveWhitespaces!==lp.preserveWhitespaces)||(lp=n)}var cm=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var DI=new de(""),Wu=new de(""),lm=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,SI||(p3(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ke.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(oe(Ke),oe(um),oe(Wu))},e.\u0275prov=se({token:e,factory:e.\u0275fac});let n=e;return n})(),um=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return SI?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function p3(n){SI=n}var SI;function Po(n){return!!n&&typeof n.then=="function"}function AI(n){return!!n&&typeof n.subscribe=="function"}var dm=new de(""),TM=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=Q(dm,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Po(o))r.push(o);else if(AI(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),RI=new de("");function m3(){gx(()=>{throw new re(600,!1)})}function g3(n){return n.isBoundToModule}function _3(n,e,t){try{let r=t();return Po(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function DM(n,e){return Array.isArray(e)?e.reduce(DM,n):H(H({},n),e)}var _c=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Q(PP),this.afterRenderEffectManager=Q(wI),this.externalTestViews=new Set,this.beforeRender=new nn,this.afterTick=new nn,this.componentTypes=[],this.components=[],this.isStable=Q(om).hasPendingTasks.pipe(Re(r=>!r)),this._injector=Q(Nn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Np;if(!this._injector.get(TM).done){let _=!s&&GN(r),w=!1;throw new re(405,w)}let a;s?a=r:a=this._injector.get(rm).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=g3(a)?void 0:this._injector.get(fs),l=i||a.selector,d=a.create(Ar.NULL,[],l,c),h=d.location.nativeElement,p=d.injector.get(DI,null);return p?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),pp(this.components,d),p?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new re(101,!1);let i=Pe(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Pe(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===mM)throw new re(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)y3(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Nw(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Nw(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;pp(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(RI,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>pp(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new re(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function pp(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function y3(n,e,t){!e&&!Nw(n)||v3(n,t,e)}function Nw(n){return Ww(n)}function v3(n,e,t){let r;t?(r=0,n[ue]|=1024):n[ue]&64?r=0:r=1,gM(n,e,r)}var Pw=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},hm=(()=>{let e=class e{compileModuleSync(r){return new Op(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=WN(r),o=HP(s.declarations).reduce((a,c)=>{let l=ds(c);return l&&a.push(new hc(l)),a},[]);return new Pw(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),w3=new de("");function I3(n,e,t){let r=new Op(t);return Promise.resolve(r)}function CN(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var E3=(()=>{let e=class e{constructor(){this.zone=Q(Ke),this.applicationRef=Q(_c)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function b3(n){return[{provide:Ke,useFactory:n},{provide:ac,multi:!0,useFactory:()=>{let e=Q(E3,{optional:!0});return()=>e.initialize()}},{provide:ac,multi:!0,useFactory:()=>{let e=Q(D3);return()=>{e.initialize()}}},{provide:PP,useFactory:C3}]}function C3(){let n=Q(Ke),e=Q(Qr);return t=>n.runOutsideAngular(()=>e.handleError(t))}function T3(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var D3=(()=>{let e=class e{constructor(){this.subscription=new Ot,this.initialized=!1,this.zone=Q(Ke),this.pendingTasks=Q(om)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Ke.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Ke.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function S3(){return typeof $localize<"u"&&$localize.locale||Lp}var xI=new de("",{providedIn:"root",factory:()=>Q(xI,Ie.Optional|Ie.SkipSelf)||S3()});var SM=new de(""),AM=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=az(i?.ngZone,T3({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=Lz(r.moduleType,this.injector,b3(()=>s)),a=o.injector.get(Qr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{pp(this._modules,o),c.unsubscribe()})}),_3(a,s,()=>{let c=o.injector.get(TM);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(xI,Lp);return Zz(l||Lp),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=DM({},i);return I3(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(_c);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new re(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new re(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(SM,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(oe(Ar))},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),Nu=null,RM=new de("");function A3(n){if(Nu&&!Nu.get(RM,!1))throw new re(400,!1);m3(),Nu=n;let e=n.get(AM);return N3(n),e}function NI(n,e,t=[]){let r=`Platform: ${e}`,i=new de(r);return(s=[])=>{let o=xM();if(!o||o.injector.get(RM,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):A3(R3(a,r))}return x3(i)}}function R3(n=[],e){return Ar.create({name:e,providers:[{provide:$p,useValue:"platform"},{provide:SM,useValue:new Set([()=>Nu=null])},...n]})}function x3(n){let e=xM();if(!e)throw new re(401,!1);return e}function xM(){return Nu?.get(AM)??null}function N3(n){n.get(oI,null)?.forEach(t=>t())}var Mo=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=P3;let n=e;return n})();function P3(n){return M3(Hn(),je(),(n&16)===16)}function M3(n,e,t){if(zp(n)&&!t){let r=ps(n.index,e);return new So(r,r)}else if(n.type&47){let r=e[Gr];return new So(r,e)}return null}var Mw=class{constructor(){}supports(e){return IM(e)}create(e){return new kw(e)}},k3=(n,e)=>e,kw=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||k3}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<TN(r,i,s)?t:r,a=TN(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,d=c-i;if(l!=d){for(let p=0;p<l;p++){let _=p<s.length?s[p]:s[p]=0,w=_+p;d<=w&&w<l&&(s[p]=_+1)}let h=o.previousIndex;s[h]=d-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!IM(e))throw new re(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,Vz(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new Ow(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Vp),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Vp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Ow=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Fw=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Vp=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Fw,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function TN(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function DN(){return new PI([new Mw])}var PI=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||DN()),deps:[[e,new Uw,new jp]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new re(901,!1)}};e.\u0275prov=se({token:e,providedIn:"root",factory:DN});let n=e;return n})();var NM=NI(null,"core",[]),PM=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(oe(_c))},e.\u0275mod=Mn({type:e}),e.\u0275inj=Pn({});let n=e;return n})();function yc(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function MI(n){let e=Pe(null);try{return n()}finally{Pe(e)}}function MM(n){let e=ds(n);if(!e)return null;let t=new hc(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var VM=null;function ko(){return VM}function UM(n){VM??=n}var fm=class{};var kn=new de(""),jI=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:()=>Q(O3),providedIn:"platform"});let n=e;return n})(),BM=new de(""),O3=(()=>{let e=class e extends jI{constructor(){super(),this._doc=Q(kn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ko().getBaseHref(this._doc)}onPopState(r){let i=ko().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=ko().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function $I(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function kM(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Vi(n){return n&&n[0]!=="?"?"?"+n:n}var Rr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:()=>Q(HI),providedIn:"root"});let n=e;return n})(),jM=new de(""),HI=(()=>{let e=class e extends Rr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Q(kn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return $I(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Vi(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Vi(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Vi(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(oe(jI),oe(jM,8))},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),mm=(()=>{let e=class e extends Rr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=$I(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Vi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Vi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(oe(jI),oe(jM,8))},e.\u0275prov=se({token:e,factory:e.\u0275fac});let n=e;return n})(),vc=(()=>{let e=class e{constructor(r){this._subject=new rn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=V3(kM(OM(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Vi(i))}normalize(r){return e.stripTrailingSlash(L3(this._basePath,OM(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Vi(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Vi(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Vi,e.joinWithSlash=$I,e.stripTrailingSlash=kM,e.\u0275fac=function(i){return new(i||e)(oe(Rr))},e.\u0275prov=se({token:e,factory:()=>F3(),providedIn:"root"});let n=e;return n})();function F3(){return new vc(oe(Rr))}function L3(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function OM(n){return n.replace(/\/index.html$/,"")}function V3(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function $M(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var kI=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Xr=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new kI(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),FM(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);FM(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(te(gc),te(nm),te(PI))},e.\u0275dir=$n({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let n=e;return n})();function FM(n,e){n.context.$implicit=e.item}var wc=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new OI,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){LM("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){LM("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(te(gc),te(nm))},e.\u0275dir=$n({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let n=e;return n})(),OI=class{constructor(){this.$implicit=null,this.ngIf=null}};function LM(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${xn(e)}'.`)}function U3(n,e){return new re(2100,!1)}var FI=class{createSubscription(e,t){return MI(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){MI(()=>e.unsubscribe())}},LI=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},B3=new LI,j3=new FI,_s=(()=>{let e=class e{constructor(r){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=r}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(r){if(!this._obj){if(r)try{this.markForCheckOnValueUpdate=!1,this._subscribe(r)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return r!==this._obj?(this._dispose(),this.transform(r)):this._latestValue}_subscribe(r){this._obj=r,this._strategy=this._selectStrategy(r),this._subscription=this._strategy.createSubscription(r,i=>this._updateLatestValue(r,i))}_selectStrategy(r){if(Po(r))return B3;if(AI(r))return j3;throw U3(e,r)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(r,i){r===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}};e.\u0275fac=function(i){return new(i||e)(te(Mo,16))},e.\u0275pipe=HN({name:"async",type:e,pure:!1,standalone:!0});let n=e;return n})();var HM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Mn({type:e}),e.\u0275inj=Pn({});let n=e;return n})(),qI="browser",$3="server";function H3(n){return n===qI}function zI(n){return n===$3}var qM=(()=>{let e=class e{};e.\u0275prov=se({token:e,providedIn:"root",factory:()=>H3(Q(ms))?new VI(Q(kn),window):new UI});let n=e;return n})(),VI=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=q3(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function q3(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var UI=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},pm=class{};var KI=class extends fm{constructor(){super(...arguments),this.supportsDOMEvents=!0}},QI=class n extends KI{static makeCurrent(){UM(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=G3();return t==null?null:W3(t)}resetBaseElement(){Ku=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return $M(document.cookie,e)}},Ku=null;function G3(){return Ku=Ku||document.querySelector("base"),Ku?Ku.getAttribute("href"):null}function W3(n){return new URL(n,document.baseURI).pathname}var YI=class{addToWindow(e){_n.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new re(5103,!1);return s},_n.getAllAngularTestabilities=()=>e.getAllTestabilities(),_n.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=_n.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};_n.frameworkStabilizers||(_n.frameworkStabilizers=[]),_n.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?ko().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},K3=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac});let n=e;return n})(),JI=new de(""),KM=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new re(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(oe(JI),oe(Ke))},e.\u0275prov=se({token:e,factory:e.\u0275fac});let n=e;return n})(),gm=class{constructor(e){this._doc=e}},GI="ng-app-id",QM=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=zI(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${GI}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(GI),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(GI,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(oe(kn),oe(Wp),oe(aI,8),oe(ms))},e.\u0275prov=se({token:e,factory:e.\u0275fac});let n=e;return n})(),WI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ZI=/%COMP%/g,YM="%COMP%",Q3=`_nghost-${YM}`,Y3=`_ngcontent-${YM}`,J3=!0,X3=new de("",{providedIn:"root",factory:()=>J3});function Z3(n){return Y3.replace(ZI,n)}function eG(n){return Q3.replace(ZI,n)}function JM(n,e){return e.map(t=>t.replace(ZI,n))}var zM=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=zI(c),this.defaultRenderer=new Qu(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===zr.ShadowDom&&(i=nt(H({},i),{encapsulation:zr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof _m?s.applyToHost(r):s instanceof Yu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(i.encapsulation){case zr.Emulated:o=new _m(l,d,i,this.appId,h,a,c,p);break;case zr.ShadowDom:return new XI(l,d,r,i,a,c,this.nonce,p);default:o=new Yu(l,d,i,h,a,c,p);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(oe(KM),oe(QM),oe(Wp),oe(X3),oe(kn),oe(ms),oe(Ke),oe(aI))},e.\u0275prov=se({token:e,factory:e.\u0275fac});let n=e;return n})(),Qu=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(WI[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(GM(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(GM(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new re(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=WI[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=WI[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(xo.DashCase|xo.Important)?e.style.setProperty(t,r,i&xo.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&xo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=ko().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function GM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var XI=class extends Qu{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=JM(i.id,i.styles);for(let d of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Yu=class extends Qu{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?JM(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},_m=class extends Yu{constructor(e,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,l),this.contentAttr=Z3(l),this.hostAttr=eG(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},tG=(()=>{let e=class e extends gm{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(oe(kn))},e.\u0275prov=se({token:e,factory:e.\u0275fac});let n=e;return n})(),WM=["alt","control","meta","shift"],nG={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},rG={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},iG=(()=>{let e=class e extends gm{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ko().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),WM.forEach(d=>{let h=i.indexOf(d);h>-1&&(i.splice(h,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=nG[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),WM.forEach(a=>{if(a!==s){let c=rG[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(oe(kn))},e.\u0275prov=se({token:e,factory:e.\u0275fac});let n=e;return n})();function sG(){QI.makeCurrent()}function oG(){return new Qr}function aG(){return VP(document),document}var cG=[{provide:ms,useValue:qI},{provide:oI,useValue:sG,multi:!0},{provide:kn,useFactory:aG,deps:[]}],XM=NI(NM,"browser",cG),lG=new de(""),uG=[{provide:Wu,useClass:YI,deps:[]},{provide:DI,useClass:lm,deps:[Ke,um,Wu]},{provide:lm,useClass:lm,deps:[Ke,um,Wu]}],dG=[{provide:$p,useValue:"root"},{provide:Qr,useFactory:oG,deps:[]},{provide:JI,useClass:tG,multi:!0,deps:[kn,Ke,ms]},{provide:JI,useClass:iG,multi:!0,deps:[kn]},zM,QM,KM,{provide:Uu,useExisting:zM},{provide:pm,useClass:K3,deps:[]},[]],ZM=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Wp,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(oe(lG,12))},e.\u0275mod=Mn({type:e}),e.\u0275inj=Pn({providers:[...dG,...uG],imports:[HM,PM]});let n=e;return n})();var ek=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(oe(kn))},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var _e="primary",dd=Symbol("RouteTitle"),iE=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Dc(n){return new iE(n)}function hG(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function fG(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Zr(n[t],e[t]))return!1;return!0}function Zr(n,e){let t=n?sE(n):void 0,r=e?sE(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!uk(n[i],e[i]))return!1;return!0}function sE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function uk(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function dk(n){return n.length>0?n[n.length-1]:null}function Is(n){return Ov(n)?n:Po(n)?at(Promise.resolve(n)):le(n)}var pG={exact:fk,subset:pk},hk={exact:mG,subset:gG,ignored:()=>!0};function nk(n,e,t){return pG[t.paths](n.root,e.root,t.matrixParams)&&hk[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function mG(n,e){return Zr(n,e)}function fk(n,e,t){if(!Fo(n.segments,e.segments)||!wm(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!fk(n.children[r],e.children[r],t))return!1;return!0}function gG(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>uk(n[t],e[t]))}function pk(n,e,t){return mk(n,e,e.segments,t)}function mk(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Fo(i,t)||e.hasChildren()||!wm(i,t,r))}else if(n.segments.length===t.length){if(!Fo(n.segments,t)||!wm(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!pk(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Fo(n.segments,i)||!wm(n.segments,i,r)||!n.children[_e]?!1:mk(n.children[_e],e,s,r)}}function wm(n,e,t){return e.every((r,i)=>hk[t](n[i].parameters,r.parameters))}var ys=class{constructor(e=new Ve([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Dc(this.queryParams),this._queryParamMap}toString(){return vG.serialize(this)}},Ve=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Im(this)}},Oo=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Dc(this.parameters),this._parameterMap}toString(){return _k(this)}};function _G(n,e){return Fo(n,e)&&n.every((t,r)=>Zr(t.parameters,e[r].parameters))}function Fo(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function yG(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===_e&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==_e&&(t=t.concat(e(i,r)))}),t}var hd=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:()=>new rd,providedIn:"root"});let n=e;return n})(),rd=class{parse(e){let t=new aE(e);return new ys(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Ju(e.root,!0)}`,r=EG(e.queryParams),i=typeof e.fragment=="string"?`#${wG(e.fragment)}`:"";return`${t}${r}${i}`}},vG=new rd;function Im(n){return n.segments.map(e=>_k(e)).join("/")}function Ju(n,e){if(!n.hasChildren())return Im(n);if(e){let t=n.children[_e]?Ju(n.children[_e],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==_e&&r.push(`${i}:${Ju(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=yG(n,(r,i)=>i===_e?[Ju(n.children[_e],!1)]:[`${i}:${Ju(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[_e]!=null?`${Im(n)}/${t[0]}`:`${Im(n)}/(${t.join("//")})`}}function gk(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ym(n){return gk(n).replace(/%3B/gi,";")}function wG(n){return encodeURI(n)}function oE(n){return gk(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Em(n){return decodeURIComponent(n)}function rk(n){return Em(n.replace(/\+/g,"%20"))}function _k(n){return`${oE(n.path)}${IG(n.parameters)}`}function IG(n){return Object.entries(n).map(([e,t])=>`;${oE(e)}=${oE(t)}`).join("")}function EG(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${ym(t)}=${ym(i)}`).join("&"):`${ym(t)}=${ym(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var bG=/^[^\/()?;#]+/;function eE(n){let e=n.match(bG);return e?e[0]:""}var CG=/^[^\/()?;=#]+/;function TG(n){let e=n.match(CG);return e?e[0]:""}var DG=/^[^=?&#]+/;function SG(n){let e=n.match(DG);return e?e[0]:""}var AG=/^[^&#]+/;function RG(n){let e=n.match(AG);return e?e[0]:""}var aE=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ve([],{}):new Ve([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[_e]=new Ve(e,t)),r}parseSegment(){let e=eE(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new re(4009,!1);return this.capture(e),new Oo(Em(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=TG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=eE(this.remaining);i&&(r=i,this.capture(r))}e[Em(t)]=Em(r)}parseQueryParam(e){let t=SG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=RG(this.remaining);o&&(r=o,this.capture(r))}let i=rk(t),s=rk(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=eE(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new re(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=_e);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[_e]:new Ve([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new re(4011,!1)}};function yk(n){return n.segments.length>0?new Ve([],{[_e]:n}):n}function vk(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=vk(i);if(r===_e&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Ve(n.segments,e);return xG(t)}function xG(n){if(n.numberOfChildren===1&&n.children[_e]){let e=n.children[_e];return new Ve(n.segments.concat(e.segments),e.children)}return n}function Sc(n){return n instanceof ys}function NG(n,e,t=null,r=null){let i=wk(n);return Ik(i,e,t,r)}function wk(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new Ve(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=yk(r);return e??i}function Ik(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return tE(i,i,i,t,r);let s=PG(e);if(s.toRoot())return tE(i,i,new Ve([],{}),t,r);let o=MG(s,i,n),a=o.processChildren?ed(o.segmentGroup,o.index,s.commands):bk(o.segmentGroup,o.index,s.commands);return tE(i,o.segmentGroup,a,t,r)}function bm(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function id(n){return typeof n=="object"&&n!=null&&n.outlets}function tE(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=Ek(n,e,t);let a=yk(vk(o));return new ys(a,s,i)}function Ek(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=Ek(s,e,t)}),new Ve(n.segments,r)}var Cm=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&bm(r[0]))throw new re(4003,!1);let i=r.find(id);if(i&&i!==dk(r))throw new re(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function PG(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Cm(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Cm(t,e,r)}var Cc=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function MG(n,e,t){if(n.isAbsolute)return new Cc(e,!0,0);if(!t)return new Cc(e,!1,NaN);if(t.parent===null)return new Cc(t,!0,0);let r=bm(n.commands[0])?0:1,i=t.segments.length-1+r;return kG(t,i,n.numberOfDoubleDots)}function kG(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new re(4005,!1);i=r.segments.length}return new Cc(r,!1,i-s)}function OG(n){return id(n[0])?n[0].outlets:{[_e]:n}}function bk(n,e,t){if(n??=new Ve([],{}),n.segments.length===0&&n.hasChildren())return ed(n,e,t);let r=FG(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Ve(n.segments.slice(0,r.pathIndex),{});return s.children[_e]=new Ve(n.segments.slice(r.pathIndex),n.children),ed(s,0,i)}else return r.match&&i.length===0?new Ve(n.segments,{}):r.match&&!n.hasChildren()?cE(n,e,t):r.match?ed(n,0,i):cE(n,e,t)}function ed(n,e,t){if(t.length===0)return new Ve(n.segments,{});{let r=OG(t),i={};if(Object.keys(r).some(s=>s!==_e)&&n.children[_e]&&n.numberOfChildren===1&&n.children[_e].segments.length===0){let s=ed(n.children[_e],e,t);return new Ve(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=bk(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ve(n.segments,i)}}function FG(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(id(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!sk(c,l,o))return s;r+=2}else{if(!sk(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function cE(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(id(s)){let c=LG(s.outlets);return new Ve(r,c)}if(i===0&&bm(t[0])){let c=n.segments[e];r.push(new Oo(c.path,ik(t[0]))),i++;continue}let o=id(s)?s.outlets[_e]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&bm(a)?(r.push(new Oo(o,ik(a))),i+=2):(r.push(new Oo(o,{})),i++)}return new Ve(r,{})}function LG(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=cE(new Ve([],{}),0,r))}),e}function ik(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function sk(n,e,t){return n==t.path&&Zr(e,t.parameters)}var td="imperative",jt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(jt||{}),cr=class{constructor(e,t){this.id=e,this.url=t}},Ac=class extends cr{constructor(e,t,r="imperative",i=null){super(e,t),this.type=jt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ei=class extends cr{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=jt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Gn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Gn||{}),Tm=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Tm||{}),vs=class extends cr{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=jt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ws=class extends cr{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=jt.NavigationSkipped}},sd=class extends cr{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=jt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Dm=class extends cr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=jt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},lE=class extends cr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=jt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},uE=class extends cr{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=jt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},dE=class extends cr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=jt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},hE=class extends cr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=jt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fE=class{constructor(e){this.route=e,this.type=jt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},pE=class{constructor(e){this.route=e,this.type=jt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},mE=class{constructor(e){this.snapshot=e,this.type=jt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},gE=class{constructor(e){this.snapshot=e,this.type=jt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},_E=class{constructor(e){this.snapshot=e,this.type=jt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yE=class{constructor(e){this.snapshot=e,this.type=jt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Sm=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=jt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},od=class{},ad=class{constructor(e){this.url=e}};var vE=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new fd,this.attachRef=null}},fd=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new vE,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Am=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=wE(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=wE(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=IE(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return IE(e,this._root).map(t=>t.value)}};function wE(n,e){if(n===e.value)return e;for(let t of e.children){let r=wE(n,t);if(r)return r}return null}function IE(n,e){if(n===e.value)return[e];for(let t of e.children){let r=IE(n,t);if(r.length)return r.unshift(e),r}return[]}var zn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function bc(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Rm=class extends Am{constructor(e,t){super(e),this.snapshot=t,NE(this,e)}toString(){return this.snapshot.toString()}};function Ck(n){let e=VG(n),t=new Me([new Oo("",{})]),r=new Me({}),i=new Me({}),s=new Me({}),o=new Me(""),a=new xr(t,r,s,o,i,_e,n,e.root);return a.snapshot=e.root,new Rm(new zn(a,[]),e)}function VG(n){let e={},t={},r={},i="",s=new cd([],e,r,i,t,_e,n,null,{});return new xm("",new zn(s,[]))}var xr=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Re(l=>l[dd]))??le(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Re(e=>Dc(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Re(e=>Dc(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function xE(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:H(H({},e.params),n.params),data:H(H({},e.data),n.data),resolve:H(H(H(H({},n.data),e.data),i?.data),n._resolvedData)}:r={params:H({},n.params),data:H({},n.data),resolve:H(H({},n.data),n._resolvedData??{})},i&&Dk(i)&&(r.resolve[dd]=i.title),r}var cd=class{get title(){return this.data?.[dd]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Dc(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Dc(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},xm=class extends Am{constructor(e,t){super(t),this.url=e,NE(this,t)}toString(){return Tk(this._root)}};function NE(n,e){e.value._routerState=n,e.children.forEach(t=>NE(n,t))}function Tk(n){let e=n.children.length>0?` { ${n.children.map(Tk).join(", ")} } `:"";return`${n.value}${e}`}function nE(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Zr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Zr(e.params,t.params)||n.paramsSubject.next(t.params),fG(e.url,t.url)||n.urlSubject.next(t.url),Zr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function EE(n,e){let t=Zr(n.params,e.params)&&_G(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||EE(n.parent,e.parent))}function Dk(n){return typeof n.title=="string"||n.title===null}var PE=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=_e,this.activateEvents=new rn,this.deactivateEvents=new rn,this.attachEvents=new rn,this.detachEvents=new rn,this.parentContexts=Q(fd),this.location=Q(gc),this.changeDetector=Q(Mo),this.environmentInjector=Q(Nn),this.inputBinder=Q(Om,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new re(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new re(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new re(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new re(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new bE(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=$n({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[pc]});let n=e;return n})(),bE=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===xr?this.route:e===fd?this.childContexts:this.parent.get(e,t)}},Om=new de(""),ok=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Au([i.queryParams,i.params,i.data]).pipe(nr(([o,a,c],l)=>(c=H(H(H({},o),a),c),l===0?le(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=MM(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac});let n=e;return n})();function UG(n,e,t){let r=ld(n,e._root,t?t._root:void 0);return new Rm(r,e)}function ld(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=BG(n,e,t);return new zn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>ld(n,a)),o}}let r=jG(e.value),i=e.children.map(s=>ld(n,s));return new zn(r,i)}}function BG(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return ld(n,r,i);return ld(n,r)})}function jG(n){return new xr(new Me(n.url),new Me(n.params),new Me(n.queryParams),new Me(n.fragment),new Me(n.data),n.outlet,n.component,n)}var Sk="ngNavigationCancelingError";function Ak(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Sc(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Rk(!1,Gn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function Rk(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Sk]=!0,t.cancellationCode=e,t}function $G(n){return xk(n)&&Sc(n.url)}function xk(n){return!!n&&n[Sk]}var HG=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Le({type:e,selectors:[["ng-component"]],standalone:!0,features:[CM],decls:1,vars:0,template:function(i,s){i&1&&Z(0,"router-outlet")},dependencies:[PE],encapsulation:2});let n=e;return n})();function qG(n,e){return n.providers&&!n._injector&&(n._injector=sm(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ME(n){let e=n.children&&n.children.map(ME),t=e?nt(H({},n),{children:e}):H({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==_e&&(t.component=HG),t}function ti(n){return n.outlet||_e}function zG(n,e){let t=n.filter(r=>ti(r)===e);return t.push(...n.filter(r=>ti(r)!==e)),t}function pd(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var GG=(n,e,t,r)=>Re(i=>(new CE(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),CE=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),nE(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=bc(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=bc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=bc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=bc(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new yE(s.value.snapshot))}),e.children.length&&this.forwardEvent(new gE(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(nE(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),nE(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=pd(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Nm=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Tc=class{constructor(e,t){this.component=e,this.route=t}};function WG(n,e,t){let r=n._root,i=e?e._root:null;return Xu(r,i,t,[r.value])}function KG(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function xc(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!xN(n)?n:e.get(n):r}function Xu(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=bc(e);return n.children.forEach(o=>{QG(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>nd(a,t.getContext(o),i)),i}function QG(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=YG(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Nm(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Xu(n,e,a?a.children:null,r,i):Xu(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Tc(a.outlet.component,o))}else o&&nd(e,a,i),i.canActivateChecks.push(new Nm(r)),s.component?Xu(n,null,a?a.children:null,r,i):Xu(n,null,t,r,i);return i}function YG(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Fo(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Fo(n.url,e.url)||!Zr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!EE(n,e)||!Zr(n.queryParams,e.queryParams);case"paramsChange":default:return!EE(n,e)}}function nd(n,e,t){let r=bc(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?nd(o,e.children.getContext(s),t):nd(o,null,t):nd(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Tc(e.outlet.component,i)):t.canDeactivateChecks.push(new Tc(null,i)):t.canDeactivateChecks.push(new Tc(null,i))}function md(n){return typeof n=="function"}function JG(n){return typeof n=="boolean"}function XG(n){return n&&md(n.canLoad)}function ZG(n){return n&&md(n.canActivate)}function eW(n){return n&&md(n.canActivateChild)}function tW(n){return n&&md(n.canDeactivate)}function nW(n){return n&&md(n.canMatch)}function Nk(n){return n instanceof Pi||n?.name==="EmptyError"}var vm=Symbol("INITIAL_VALUE");function Rc(){return nr(n=>Au(n.map(e=>e.pipe(Mi(1),Uv(vm)))).pipe(Re(e=>{for(let t of e)if(t!==!0){if(t===vm)return vm;if(t===!1||t instanceof ys)return t}return!0}),tr(e=>e!==vm),Mi(1)))}function rW(n,e){return Tt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?le(nt(H({},t),{guardsResult:!0})):iW(o,r,i,n).pipe(Tt(a=>a&&JG(a)?sW(r,s,n,e):le(a)),Re(a=>nt(H({},t),{guardsResult:a})))})}function iW(n,e,t,r){return at(n).pipe(Tt(i=>uW(i.component,i.route,t,e,r)),$r(i=>i!==!0,!0))}function sW(n,e,t,r){return at(e).pipe(yo(i=>Xa(aW(i.route.parent,r),oW(i.route,r),lW(n,i.path,t),cW(n,i.route,t))),$r(i=>i!==!0,!0))}function oW(n,e){return n!==null&&e&&e(new _E(n)),le(!0)}function aW(n,e){return n!==null&&e&&e(new mE(n)),le(!0)}function cW(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return le(!0);let i=r.map(s=>ip(()=>{let o=pd(e)??t,a=xc(s,o),c=ZG(a)?a.canActivate(e,n):ki(o,()=>a(e,n));return Is(c).pipe($r())}));return le(i).pipe(Rc())}function lW(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>KG(o)).filter(o=>o!==null).map(o=>ip(()=>{let a=o.guards.map(c=>{let l=pd(o.node)??t,d=xc(c,l),h=eW(d)?d.canActivateChild(r,n):ki(l,()=>d(r,n));return Is(h).pipe($r())});return le(a).pipe(Rc())}));return le(s).pipe(Rc())}function uW(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return le(!0);let o=s.map(a=>{let c=pd(e)??i,l=xc(a,c),d=tW(l)?l.canDeactivate(n,e,t,r):ki(c,()=>l(n,e,t,r));return Is(d).pipe($r())});return le(o).pipe(Rc())}function dW(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return le(!0);let s=i.map(o=>{let a=xc(o,n),c=XG(a)?a.canLoad(e,t):ki(n,()=>a(e,t));return Is(c)});return le(s).pipe(Rc(),Pk(r))}function Pk(n){return Nv(Kt(e=>{if(Sc(e))throw Ak(n,e)}),Re(e=>e===!0))}function hW(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return le(!0);let s=i.map(o=>{let a=xc(o,n),c=nW(a)?a.canMatch(e,t):ki(n,()=>a(e,t));return Is(c)});return le(s).pipe(Rc(),Pk(r))}var ud=class{constructor(e){this.segmentGroup=e||null}},Pm=class extends Error{constructor(e){super(),this.urlTree=e}};function Ec(n){return Ya(new ud(n))}function fW(n){return Ya(new re(4e3,!1))}function pW(n){return Ya(Rk(!1,Gn.GuardRejected))}var TE=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return le(r);if(i.numberOfChildren>1||!i.children[_e])return fW(e.redirectTo);i=i.children[_e]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new Pm(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new ys(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Ve(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new re(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},DE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function mW(n,e,t,r,i){let s=kE(n,e,t);return s.matched?(r=qG(e,r),hW(r,e,t,i).pipe(Re(o=>o===!0?s:H({},DE)))):le(s)}function kE(n,e,t){if(e.path==="**")return gW(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?H({},DE):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||hG)(t,n,e);if(!i)return H({},DE);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?H(H({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function gW(n){return{matched:!0,parameters:n.length>0?dk(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function ak(n,e,t,r){return t.length>0&&vW(n,t,r)?{segmentGroup:new Ve(e,yW(r,new Ve(t,n.children))),slicedSegments:[]}:t.length===0&&wW(n,t,r)?{segmentGroup:new Ve(n.segments,_W(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Ve(n.segments,n.children),slicedSegments:t}}function _W(n,e,t,r){let i={};for(let s of t)if(Fm(n,e,s)&&!r[ti(s)]){let o=new Ve([],{});i[ti(s)]=o}return H(H({},r),i)}function yW(n,e){let t={};t[_e]=e;for(let r of n)if(r.path===""&&ti(r)!==_e){let i=new Ve([],{});t[ti(r)]=i}return t}function vW(n,e,t){return t.some(r=>Fm(n,e,r)&&ti(r)!==_e)}function wW(n,e,t){return t.some(r=>Fm(n,e,r))}function Fm(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function IW(n,e,t,r){return ti(n)!==r&&(r===_e||!Fm(e,t,n))?!1:kE(e,n,t).matched}function EW(n,e,t){return e.length===0&&!n.children[t]}var SE=class{};function bW(n,e,t,r,i,s,o="emptyOnly"){return new AE(n,e,t,r,i,o,s).recognize()}var CW=31,AE=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new TE(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new re(4002,`'${e.segmentGroup}'`)}recognize(){let e=ak(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Re(t=>{let r=new cd([],Object.freeze({}),Object.freeze(H({},this.urlTree.queryParams)),this.urlTree.fragment,{},_e,this.rootComponentType,null,{}),i=new zn(r,t),s=new xm("",i),o=NG(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,_e).pipe(as(r=>{if(r instanceof Pm)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ud?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=xE(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Re(s=>s instanceof zn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return at(i).pipe(yo(s=>{let o=r.children[s],a=zG(t,s);return this.processSegmentGroup(e,a,o,s)}),Vv((s,o)=>(s.push(...o),s)),cs(null),Lv(),Tt(s=>{if(s===null)return Ec(r);let o=Mk(s);return TW(o),le(o)}))}processSegment(e,t,r,i,s,o){return at(t).pipe(yo(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(as(c=>{if(c instanceof ud)return le(null);throw c}))),$r(a=>!!a),as(a=>{if(Nk(a))return EW(r,i,s)?le(new SE):Ec(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return IW(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):Ec(i):Ec(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:d}=kE(t,i,s);if(!a)return Ec(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>CW&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,h).pipe(Tt(p=>this.processSegment(e,r,t,p.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=mW(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(nr(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(nr(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:p}=a,_=new cd(d,p,Object.freeze(H({},this.urlTree.queryParams)),this.urlTree.fragment,SW(r),ti(r),r.component??r._loadedComponent??null,r,AW(r)),{segmentGroup:w,slicedSegments:S}=ak(t,d,h,c);if(S.length===0&&w.hasChildren())return this.processChildren(l,c,w).pipe(Re(L=>L===null?null:new zn(_,L)));if(c.length===0&&S.length===0)return le(new zn(_,[]));let R=ti(r)===s;return this.processSegment(l,c,w,S,R?_e:s,!0).pipe(Re(L=>new zn(_,L instanceof zn?[L]:[])))}))):Ec(t)))}getChildConfig(e,t,r){return t.children?le({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?le({routes:t._loadedRoutes,injector:t._loadedInjector}):dW(e,t,r,this.urlSerializer).pipe(Tt(i=>i?this.configLoader.loadChildren(e,t).pipe(Kt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):pW(t))):le({routes:[],injector:e})}};function TW(n){n.sort((e,t)=>e.value.outlet===_e?-1:t.value.outlet===_e?1:e.value.outlet.localeCompare(t.value.outlet))}function DW(n){let e=n.value.routeConfig;return e&&e.path===""}function Mk(n){let e=[],t=new Set;for(let r of n){if(!DW(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=Mk(r.children);e.push(new zn(r.value,i))}return e.filter(r=>!t.has(r))}function SW(n){return n.data||{}}function AW(n){return n.resolve||{}}function RW(n,e,t,r,i,s){return Tt(o=>bW(n,e,t,r,o.extractedUrl,i,s).pipe(Re(({state:a,tree:c})=>nt(H({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function xW(n,e){return Tt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return le(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of kk(c))o.add(l);let a=0;return at(o).pipe(yo(c=>s.has(c)?NW(c,r,n,e):(c.data=xE(c,c.parent,n).resolve,le(void 0))),Kt(()=>a++),Za(1),Tt(c=>a===o.size?le(t):Bn))})}function kk(n){let e=n.children.map(t=>kk(t)).flat();return[n,...e]}function NW(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!Dk(i)&&(s[dd]=i.title),PW(s,n,e,r).pipe(Re(o=>(n._resolvedData=o,n.data=xE(n,n.parent,t).resolve,null)))}function PW(n,e,t,r){let i=sE(n);if(i.length===0)return le({});let s={};return at(i).pipe(Tt(o=>MW(n[o],e,t,r).pipe($r(),Kt(a=>{s[o]=a}))),Za(1),Fv(s),as(o=>Nk(o)?Bn:Ya(o)))}function MW(n,e,t,r){let i=pd(e)??r,s=xc(n,i),o=s.resolve?s.resolve(e,t):ki(i,()=>s(e,t));return Is(o)}function rE(n){return nr(e=>{let t=n(e);return t?at(t).pipe(Re(()=>e)):le(e)})}var Ok=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===_e);return i}getResolvedTitleForRoute(r){return r.data[dd]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:()=>Q(kW),providedIn:"root"});let n=e;return n})(),kW=(()=>{let e=class e extends Ok{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(oe(ek))},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),gd=new de("",{providedIn:"root",factory:()=>({})}),Mm=new de(""),OE=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Q(hm)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return le(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Is(r.loadComponent()).pipe(Re(Fk),Kt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Ru(()=>{this.componentLoaders.delete(r)})),s=new Qa(i,()=>new nn).pipe(Ka());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return le({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=OW(i,this.compiler,r,this.onLoadEndListener).pipe(Ru(()=>{this.childrenLoaders.delete(i)})),a=new Qa(o,()=>new nn).pipe(Ka());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function OW(n,e,t,r){return Is(n.loadChildren()).pipe(Re(Fk),Tt(i=>i instanceof Bu||Array.isArray(i)?le(i):at(e.compileModuleAsync(i))),Re(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(Mm,[],{optional:!0,self:!0}).flat()),{routes:o.map(ME),injector:s}}))}function FW(n){return n&&typeof n=="object"&&"default"in n}function Fk(n){return FW(n)?n.default:n}var FE=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:()=>Q(LW),providedIn:"root"});let n=e;return n})(),LW=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Lk=new de(""),Vk=new de("");function VW(n,e,t){let r=n.get(Vk),i=n.get(kn);return n.get(Ke).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),UW(n))),{onViewTransitionCreated:c}=r;return c&&ki(n,()=>c({transition:a,from:e,to:t})),o})}function UW(n){return new Promise(e=>{im(e,{injector:n})})}var LE=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new nn,this.transitionAbortSubject=new nn,this.configLoader=Q(OE),this.environmentInjector=Q(Nn),this.urlSerializer=Q(hd),this.rootContexts=Q(fd),this.location=Q(vc),this.inputBindingEnabled=Q(Om,{optional:!0})!==null,this.titleStrategy=Q(Ok),this.options=Q(gd,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Q(FE),this.createViewTransition=Q(Lk,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>le(void 0),this.rootComponentType=null;let r=s=>this.events.next(new fE(s)),i=s=>this.events.next(new pE(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(nt(H(H({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Me({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:td,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(tr(o=>o.id!==0),Re(o=>nt(H({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),nr(o=>{let a=!1,c=!1;return le(o).pipe(nr(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Gn.SupersededByNewNavigation),Bn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?nt(H({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&h!=="reload"){let p="";return this.events.next(new ws(l.id,this.urlSerializer.serialize(l.rawUrl),p,Tm.IgnoredSameUrlNavigation)),l.resolve(null),Bn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return le(l).pipe(nr(p=>{let _=this.transitions?.getValue();return this.events.next(new Ac(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),_!==this.transitions?.getValue()?Bn:Promise.resolve(p)}),RW(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Kt(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=nt(H({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let _=new Dm(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(_)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:_,source:w,restoredState:S,extras:R}=l,L=new Ac(p,this.urlSerializer.serialize(_),w,S);this.events.next(L);let K=Ck(this.rootComponentType).snapshot;return this.currentTransition=o=nt(H({},l),{targetSnapshot:K,urlAfterRedirects:_,extras:nt(H({},R),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=_,le(o)}else{let p="";return this.events.next(new ws(l.id,this.urlSerializer.serialize(l.extractedUrl),p,Tm.IgnoredByUrlHandlingStrategy)),l.resolve(null),Bn}}),Kt(l=>{let d=new lE(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Re(l=>(this.currentTransition=o=nt(H({},l),{guards:WG(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),rW(this.environmentInjector,l=>this.events.next(l)),Kt(l=>{if(o.guardsResult=l.guardsResult,Sc(l.guardsResult))throw Ak(this.urlSerializer,l.guardsResult);let d=new uE(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),tr(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Gn.GuardRejected),!1)),rE(l=>{if(l.guards.canActivateChecks.length)return le(l).pipe(Kt(d=>{let h=new dE(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),nr(d=>{let h=!1;return le(d).pipe(xW(this.paramsInheritanceStrategy,this.environmentInjector),Kt({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",Gn.NoDataFromResolver)}}))}),Kt(d=>{let h=new hE(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),rE(l=>{let d=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(Kt(_=>{h.component=_}),Re(()=>{})));for(let _ of h.children)p.push(...d(_));return p};return Au(d(l.targetSnapshot.root)).pipe(cs(null),Mi(1))}),rE(()=>this.afterPreactivation()),nr(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return h?at(h).pipe(Re(()=>o)):le(o)}),Re(l=>{let d=UG(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=nt(H({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),Kt(()=>{this.events.next(new od)}),GG(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Mi(1),Kt({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ei(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Bv(this.transitionAbortSubject.pipe(Kt(l=>{throw l}))),Ru(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Gn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),as(l=>{if(c=!0,xk(l))this.events.next(new vs(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),$G(l)?this.events.next(new ad(l.url)):o.resolve(!1);else{this.events.next(new sd(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Bn}))}))}cancelNavigationTransition(r,i,s){let o=new vs(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function BW(n){return n!==td}var jW=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:()=>Q($W),providedIn:"root"});let n=e;return n})(),RE=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},$W=(()=>{let e=class e extends RE{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ro(e)))(s||e)}})(),e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Uk=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:()=>Q(HW),providedIn:"root"});let n=e;return n})(),HW=(()=>{let e=class e extends Uk{constructor(){super(...arguments),this.location=Q(vc),this.urlSerializer=Q(hd),this.options=Q(gd,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Q(FE),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ys,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Ck(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Ac)this.stateMemento=this.createStateMemento();else if(r instanceof ws)this.rawUrlTree=i.initialUrl;else if(r instanceof Dm){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof od?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof vs&&(r.code===Gn.GuardRejected||r.code===Gn.NoDataFromResolver)?this.restoreHistory(i):r instanceof sd?this.restoreHistory(i,!0):r instanceof ei&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=H(H({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=H(H({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ro(e)))(s||e)}})(),e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Zu=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Zu||{});function Bk(n,e){n.events.pipe(tr(t=>t instanceof ei||t instanceof vs||t instanceof sd||t instanceof ws),Re(t=>t instanceof ei||t instanceof ws?Zu.COMPLETE:(t instanceof vs?t.code===Gn.Redirect||t.code===Gn.SupersededByNewNavigation:!1)?Zu.REDIRECTING:Zu.FAILED),tr(t=>t!==Zu.REDIRECTING),Mi(1)).subscribe(()=>{e()})}function qW(n){throw n}var zW={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},GW={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},rt=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=Q(cm),this.stateManager=Q(Uk),this.options=Q(gd,{optional:!0})||{},this.pendingTasks=Q(om),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Q(LE),this.urlSerializer=Q(hd),this.location=Q(vc),this.urlHandlingStrategy=Q(FE),this._events=new nn,this.errorHandler=this.options.errorHandler||qW,this.navigated=!1,this.routeReuseStrategy=Q(jW),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Q(Mm,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Q(Om,{optional:!0}),this.eventsSubscription=new Ot,this.isNgZoneEnabled=Q(Ke)instanceof Ke&&Ke.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof vs&&i.code!==Gn.Redirect&&i.code!==Gn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof ei)this.navigated=!0;else if(i instanceof ad){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||BW(s.source)};this.scheduleNavigation(a,td,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}KW(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),td,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=H({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(ME),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=H(H({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let _=s?s.snapshot:this.routerState.snapshot.root;p=wk(_)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),p=this.currentUrlTree.root}return Ik(p,r,h,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Sc(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,td,null,i)}navigate(r,i={skipLocationChange:!1}){return WW(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=H({},zW):i===!1?s=H({},GW):s=i,Sc(r))return nk(this.currentUrlTree,r,s);let o=this.parseUrl(r);return nk(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,d;a?(c=a.resolve,l=a.reject,d=a.promise):d=new Promise((p,_)=>{c=p,l=_});let h=this.pendingTasks.add();return Bk(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function WW(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new re(4008,!1)}function KW(n){return!(n instanceof od)&&!(n instanceof ad)}var jk=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new nn,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof ei&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:jP(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(te(rt),te(xr),iI("tabindex"),te(gs),te(Li),te(Rr))},e.\u0275dir=$n({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Y("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&am("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[ir.HasDecoratorInputTransform,"preserveFragment","preserveFragment",yc],skipLocationChange:[ir.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",yc],replaceUrl:[ir.HasDecoratorInputTransform,"replaceUrl","replaceUrl",yc],routerLink:"routerLink"},standalone:!0,features:[II,pc]});let n=e;return n})();var km=class{};var QW=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(tr(r=>r instanceof ei),yo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=sm(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return at(s).pipe(Ja())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=le(null);let o=s.pipe(Tt(a=>a===null?le(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return at([o,a]).pipe(Ja())}else return o})}};e.\u0275fac=function(i){return new(i||e)(oe(rt),oe(hm),oe(Nn),oe(km),oe(OE))},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),$k=new de(""),YW=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=Q(Nn),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Ac?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof ei?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof ws&&r.code===Tm.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Sm&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>g(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),im(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Sm(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){ZP()},e.\u0275prov=se({token:e,factory:e.\u0275fac});let n=e;return n})();function JW(n){return n.routerState.root}function _d(n,e){return{\u0275kind:n,\u0275providers:e}}function XW(){let n=Q(Ar);return e=>{let t=n.get(_c);if(e!==t.components[0])return;let r=n.get(rt),i=n.get(Hk);n.get(VE)===1&&r.initialNavigation(),n.get(qk,null,Ie.Optional)?.setUpPreloading(),n.get($k,null,Ie.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Hk=new de("",{factory:()=>new nn}),VE=new de("",{providedIn:"root",factory:()=>1});function ZW(){return _d(2,[{provide:VE,useValue:0},{provide:dm,multi:!0,deps:[Ar],useFactory:e=>{let t=e.get(BM,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(rt),s=e.get(Hk);Bk(i,()=>{r(!0)}),e.get(LE).afterPreactivation=()=>(r(!0),s.closed?le(void 0):s),i.initialNavigation()}))}}])}function e5(){return _d(3,[{provide:dm,multi:!0,useFactory:()=>{let e=Q(rt);return()=>{e.setUpLocationChangeListener()}}},{provide:VE,useValue:2}])}var qk=new de("");function t5(n){return _d(0,[{provide:qk,useExisting:QW},{provide:km,useExisting:n}])}function n5(){return _d(8,[ok,{provide:Om,useExisting:ok}])}function r5(n){let e=[{provide:Lk,useValue:VW},{provide:Vk,useValue:H({skipNextTransition:!!n?.skipInitialTransition},n)}];return _d(9,e)}var ck=new de("ROUTER_FORROOT_GUARD"),i5=[vc,{provide:hd,useClass:rd},rt,fd,{provide:xr,useFactory:JW,deps:[rt]},OE,[]],UE=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[i5,[],{provide:Mm,multi:!0,useValue:r},{provide:ck,useFactory:c5,deps:[[rt,new jp,new Uw]]},{provide:gd,useValue:i||{}},i?.useHash?o5():a5(),s5(),i?.preloadingStrategy?t5(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?l5(i):[],i?.bindToComponentInputs?n5().\u0275providers:[],i?.enableViewTransitions?r5().\u0275providers:[],u5()]}}static forChild(r){return{ngModule:e,providers:[{provide:Mm,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(oe(ck,8))},e.\u0275mod=Mn({type:e}),e.\u0275inj=Pn({});let n=e;return n})();function s5(){return{provide:$k,useFactory:()=>{let n=Q(qM),e=Q(Ke),t=Q(gd),r=Q(LE),i=Q(hd);return t.scrollOffset&&n.setOffset(t.scrollOffset),new YW(i,r,n,e,t)}}}function o5(){return{provide:Rr,useClass:mm}}function a5(){return{provide:Rr,useClass:HI}}function c5(n){return"guarded"}function l5(n){return[n.initialNavigation==="disabled"?e5().\u0275providers:[],n.initialNavigation==="enabledBlocking"?ZW().\u0275providers:[]]}var lk=new de("");function u5(){return[{provide:lk,useFactory:XW},{provide:RI,multi:!0,useExisting:lk}]}var jE={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var j=function(n,e){if(!n)throw Lo(e)},Lo=function(n){return new Error("Firebase Database ("+jE.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var Gk=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},d5=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Vm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4,p=(a&15)<<2|l>>6,_=l&63;c||(_=64,o||(p=64)),r.push(t[d],t[h],t[p],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Gk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):d5(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new $E;let p=s<<2|a>>4;if(r.push(p),l!==64){let _=a<<4&240|l>>2;if(r.push(_),h!==64){let w=l<<6&192|h;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},$E=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},qE=function(n){let e=Gk(n);return Vm.encodeByteArray(e,!0)},yd=function(n){return qE(n).replace(/\./g,"")},vd=function(n){try{return Vm.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Wk(n){return Pc(void 0,n)}function Pc(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!h5(t)||(n[t]=Pc(n[t],e[t]));return n}function h5(n){return n!=="__proto__"}function f5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var p5=()=>f5().__FIREBASE_DEFAULTS__,m5=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},g5=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&vd(n[1]);return e&&JSON.parse(e)},zE=()=>{try{return p5()||m5()||g5()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var GE=()=>{var n;return(n=zE())===null||n===void 0?void 0:n.config},Kk=n=>{var e;return(e=zE())===null||e===void 0?void 0:e[`_${n}`]};var Vt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Mc(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[yd(JSON.stringify(t)),yd(JSON.stringify(o)),""].join(".")}function ze(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wd(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ze())}function Um(){var n;let e=(n=zE())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Bm(){return typeof self=="object"&&self.self===self}function jm(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Vo(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $m(){let n=ze();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ni(){return jE.NODE_CLIENT===!0||jE.NODE_ADMIN===!0}function WE(){return!Um()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Es(){try{return typeof indexedDB=="object"}catch{return!1}}function Qk(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var _5="FirebaseError",ft=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=_5,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lr.prototype.create)}},lr=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?y5(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ft(i,a,r)}};function y5(n,e){return n.replace(v5,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var v5=/\{\$([^}]+)}/g;function Nc(n){return JSON.parse(n)}function Dt(n){return JSON.stringify(n)}var Yk=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=Nc(vd(s[0])||""),t=Nc(vd(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var Jk=function(n){let e=Yk(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Xk=function(n){let e=Yk(n).claims;return typeof e=="object"&&e.admin===!0};function yn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function bs(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function kc(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Id(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Cs(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(zk(s)&&zk(o)){if(!Cs(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function zk(n){return n!==null&&typeof n=="object"}function Bi(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ts(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Oc(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var Lm=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){let p=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(p<<1|p>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,d;for(let h=0;h<80;h++){h<40?h<20?(l=a^s&(o^a),d=1518500249):(l=s^o^a,d=1859775393):h<60?(l=s&o|a&(s|o),d=2400959708):(l=s^o^a,d=3395469782);let p=(i<<5|i>>>27)+l+c+d+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=p}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function Hm(n,e){let t=new HE(n,e);return t.subscribe.bind(t)}var HE=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");w5(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=BE),i.error===void 0&&(i.error=BE),i.complete===void 0&&(i.complete=BE);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function w5(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function BE(){}var ae=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){let s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function cn(n,e){return`${n} failed: ${e} argument `}function Ut(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(cn(n,e)+"must be a valid function.")}function KE(n,e,t,r){if(!(r&&!t)&&(typeof t!="object"||t===null))throw new Error(cn(n,e)+"must be a valid context object.")}var Zk=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,j(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Ed=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var dae=4*60*60*1e3;function q(n){return n&&n._delegate?n._delegate:n}var $e=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Uo="[DEFAULT]";var Bo=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Vt;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(E5(e))try{this.getOrInitializeService({instanceIdentifier:Uo})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Uo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Uo){return this.instances.has(e)}getOptions(e=Uo){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:I5(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Uo){return this.component?this.component.multipleInstances?e:Uo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function I5(n){return n===Uo?void 0:n}function E5(n){return n.instantiationMode==="EAGER"}var Ds=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Bo(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var u0={};c$(u0,{FirebaseError:()=>ft,SDK_VERSION:()=>wn,_DEFAULT_ENTRY_NAME:()=>ii,_addComponent:()=>Vc,_addOrOverwriteComponent:()=>a0,_apps:()=>Ss,_clearComponents:()=>l9,_components:()=>Lc,_getProvider:()=>Uc,_isFirebaseApp:()=>pO,_isFirebaseServerApp:()=>ct,_registerComponent:()=>vn,_removeServiceInstance:()=>fO,_serverApps:()=>Fc,deleteApp:()=>Km,getApp:()=>Cd,getApps:()=>h9,initializeApp:()=>Wm,initializeServerApp:()=>d9,onLog:()=>c0,registerVersion:()=>wt,setLogLevel:()=>l0});var QE=[],ye=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(ye||{}),eO={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},b5=ye.INFO,C5={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},T5=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=C5[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},On=class{constructor(e){this.name=e,this._logLevel=b5,this._logHandler=T5,this._userLogHandler=null,QE.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?eO[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}};function tO(n){QE.forEach(e=>{e.setLogLevel(n)})}function nO(n,e){for(let t of QE){let r=null;e&&e.level&&(r=eO[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:ye[s].toLowerCase(),message:a,args:o,type:i.name})}}}var D5=(n,e)=>e.some(t=>n instanceof t),rO,iO;function S5(){return rO||(rO=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function A5(){return iO||(iO=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var sO=new WeakMap,JE=new WeakMap,oO=new WeakMap,YE=new WeakMap,ZE=new WeakMap;function R5(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(ri(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&sO.set(t,n)}).catch(()=>{}),ZE.set(e,n),e}function x5(n){if(JE.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});JE.set(n,e)}var XE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return JE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||oO.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ri(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function aO(n){XE=n(XE)}function N5(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(qm(this),e,...t);return oO.set(r,e.sort?e.sort():[e]),ri(r)}:A5().includes(n)?function(...e){return n.apply(qm(this),e),ri(sO.get(this))}:function(...e){return ri(n.apply(qm(this),e))}}function P5(n){return typeof n=="function"?N5(n):(n instanceof IDBTransaction&&x5(n),D5(n,S5())?new Proxy(n,XE):n)}function ri(n){if(n instanceof IDBRequest)return R5(n);if(YE.has(n))return YE.get(n);let e=P5(n);return e!==n&&(YE.set(n,e),ZE.set(e,n)),e}var qm=n=>ZE.get(n);function lO(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=ri(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ri(o.result),c.oldVersion,c.newVersion,ri(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var M5=["get","getKey","getAll","getAllKeys","count"],k5=["put","add","delete","clear"],e0=new Map;function cO(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(e0.get(e))return e0.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=k5.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||M5.includes(t)))return;let s=function(o,...a){return g(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return e0.set(e,s),s}aO(n=>nt(H({},n),{get:(e,t,r)=>cO(e,t)||n.get(e,t,r),has:(e,t)=>!!cO(e,t)||n.has(e,t)}));var n0=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(O5(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function O5(n){let e=n.getComponent();return e?.type==="VERSION"}var zm="@firebase/app",r0="0.10.5";var jo=new On("@firebase/app"),F5="@firebase/app-compat",L5="@firebase/analytics-compat",V5="@firebase/analytics",U5="@firebase/app-check-compat",B5="@firebase/app-check",j5="@firebase/auth",$5="@firebase/auth-compat",H5="@firebase/database",q5="@firebase/database-compat",z5="@firebase/functions",G5="@firebase/functions-compat",W5="@firebase/installations",K5="@firebase/installations-compat",Q5="@firebase/messaging",Y5="@firebase/messaging-compat",J5="@firebase/performance",X5="@firebase/performance-compat",Z5="@firebase/remote-config",e9="@firebase/remote-config-compat",t9="@firebase/storage",n9="@firebase/storage-compat",r9="@firebase/firestore",i9="@firebase/vertexai-preview",s9="@firebase/firestore-compat",o9="firebase",a9="10.12.2";var ii="[DEFAULT]",c9={[zm]:"fire-core",[F5]:"fire-core-compat",[V5]:"fire-analytics",[L5]:"fire-analytics-compat",[B5]:"fire-app-check",[U5]:"fire-app-check-compat",[j5]:"fire-auth",[$5]:"fire-auth-compat",[H5]:"fire-rtdb",[q5]:"fire-rtdb-compat",[z5]:"fire-fn",[G5]:"fire-fn-compat",[W5]:"fire-iid",[K5]:"fire-iid-compat",[Q5]:"fire-fcm",[Y5]:"fire-fcm-compat",[J5]:"fire-perf",[X5]:"fire-perf-compat",[Z5]:"fire-rc",[e9]:"fire-rc-compat",[t9]:"fire-gcs",[n9]:"fire-gcs-compat",[r9]:"fire-fst",[s9]:"fire-fst-compat",[i9]:"fire-vertex","fire-js":"fire-js",[o9]:"fire-js-all"};var Ss=new Map,Fc=new Map,Lc=new Map;function Vc(n,e){try{n.container.addComponent(e)}catch(t){jo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function a0(n,e){n.container.addOrOverwriteComponent(e)}function vn(n){let e=n.name;if(Lc.has(e))return jo.debug(`There were multiple attempts to register component ${e}.`),!1;Lc.set(e,n);for(let t of Ss.values())Vc(t,n);for(let t of Fc.values())Vc(t,n);return!0}function Uc(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function fO(n,e,t=ii){Uc(n,e).clearInstance(t)}function pO(n){return n.options!==void 0}function ct(n){return n.settings!==void 0}function l9(){Lc.clear()}var u9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ur=new lr("app","Firebase",u9);var Gm=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $e("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ur.create("app-deleted",{appName:this._name})}};var i0=class extends Gm{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,wt(zm,r0,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Km(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw ur.create("server-app-deleted")}};var wn=a9;function Wm(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:ii,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw ur.create("bad-app-name",{appName:String(i)});if(t||(t=GE()),!t)throw ur.create("no-options");let s=Ss.get(i);if(s){if(Cs(t,s.options)&&Cs(r,s.config))return s;throw ur.create("duplicate-app",{appName:i})}let o=new Ds(i);for(let c of Lc.values())o.addComponent(c);let a=new Gm(t,r,o);return Ss.set(i,a),a}function d9(n,e){if(Bm())throw ur.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;pO(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=l=>[...l].reduce((d,h)=>Math.imul(31,d)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw ur.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=Fc.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new Ds(s);for(let l of Lc.values())a.addComponent(l);let c=new i0(t,e,s,a);return Fc.set(s,c),c}function Cd(n=ii){let e=Ss.get(n);if(!e&&n===ii&&GE())return Wm();if(!e)throw ur.create("no-app",{appName:n});return e}function h9(){return Array.from(Ss.values())}function Km(n){return g(this,null,function*(){let e=!1,t=n.name;Ss.has(t)?(e=!0,Ss.delete(t)):Fc.has(t)&&n.decRefCount()<=0&&(Fc.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function wt(n,e,t){var r;let i=(r=c9[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),jo.warn(a.join(" "));return}vn(new $e(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function c0(n,e){if(n!==null&&typeof n!="function")throw ur.create("invalid-log-argument");nO(n,e)}function l0(n){tO(n)}var f9="firebase-heartbeat-database",p9=1,bd="firebase-heartbeat-store",t0=null;function mO(){return t0||(t0=lO(f9,p9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(bd)}catch(t){console.warn(t)}}}}).catch(n=>{throw ur.create("idb-open",{originalErrorMessage:n.message})})),t0}function m9(n){return g(this,null,function*(){try{let t=(yield mO()).transaction(bd),r=yield t.objectStore(bd).get(gO(n));return yield t.done,r}catch(e){if(e instanceof ft)jo.warn(e.message);else{let t=ur.create("idb-get",{originalErrorMessage:e?.message});jo.warn(t.message)}}})}function uO(n,e){return g(this,null,function*(){try{let r=(yield mO()).transaction(bd,"readwrite");yield r.objectStore(bd).put(e,gO(n)),yield r.done}catch(t){if(t instanceof ft)jo.warn(t.message);else{let r=ur.create("idb-set",{originalErrorMessage:t?.message});jo.warn(r.message)}}})}function gO(n){return`${n.name}!${n.options.appId}`}var g9=1024,_9=30*24*60*60*1e3,s0=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new o0(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return g(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=dO();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=_9}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return g(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=dO(),{heartbeatsToSend:r,unsentEntries:i}=y9(this._heartbeatsCache.heartbeats),s=yd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function dO(){return new Date().toISOString().substring(0,10)}function y9(n,e=g9){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),hO(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),hO(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var o0=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return Es()?Qk().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield m9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return uO(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return uO(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function hO(n){return yd(JSON.stringify({version:2,heartbeats:n})).length}function v9(n){vn(new $e("platform-logger",e=>new n0(e),"PRIVATE")),vn(new $e("heartbeat",e=>new s0(e),"PRIVATE")),wt(zm,r0,n),wt(zm,r0,"esm2017"),wt("fire-js","")}v9("");var d0=class{constructor(e,t){this._delegate=e,this.firebase=t,Vc(e,new $e("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Km(this._delegate)))}_getService(e,t=ii){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=ii){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Vc(this._delegate,e)}_addOrOverwriteComponent(e){a0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var w9={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},_O=new lr("app-compat","Firebase",w9);function I9(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:wt,setLogLevel:l0,onLog:c0,apps:null,SDK_VERSION:wn,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:u0}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||ii,!yn(e,l))throw _O.create("no-app",{appName:l});return e[l]}i.App=n;function s(l,d={}){let h=Wm(l,d);if(yn(e,h.name))return e[h.name];let p=new n(h,t);return e[h.name]=p,p}function o(){return Object.keys(e).map(l=>e[l])}function a(l){let d=l.name,h=d.replace("-compat","");if(vn(l)&&l.type==="PUBLIC"){let p=(_=i())=>{if(typeof _[h]!="function")throw _O.create("invalid-app-argument",{appName:d});return _[h]()};l.serviceProps!==void 0&&Pc(p,l.serviceProps),t[h]=p,n.prototype[h]=function(..._){return this._getService.bind(this,d).apply(this,l.multipleInstances?_:[])}}return l.type==="PUBLIC"?t[h]:null}function c(l,d){return d==="serverAuth"?null:d}return t}function vO(){let n=I9(d0);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:vO,extendNamespace:e,createSubscribe:Hm,ErrorFactory:lr,deepExtend:Pc});function e(t){Pc(n,t)}return n}var E9=vO();var yO=new On("@firebase/app-compat"),b9="@firebase/app-compat",C9="0.2.35";function T9(n){wt(b9,C9,n)}if(Bm()&&self.firebase!==void 0){yO.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);let n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&yO.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var G=E9;T9();var Wo={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var Ps={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function D9(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function OO(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var $0=D9,FO=OO,LO=new lr("auth","Firebase",OO());var Xm=new On("@firebase/auth");function S9(n,...e){Xm.logLevel<=ye.WARN&&Xm.warn(`Auth (${wn}): ${n}`,...e)}function Ym(n,...e){Xm.logLevel<=ye.ERROR&&Xm.error(`Auth (${wn}): ${n}`,...e)}function Rt(n,...e){throw q0(n,...e)}function At(n,...e){return q0(n,...e)}function H0(n,e,t){let r=Object.assign(Object.assign({},FO()),{[e]:t});return new lr("auth","Firebase",r).create(e,{appName:n.name})}function $t(n){return H0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $c(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Rt(n,"argument-error"),H0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function q0(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return LO.create(n,...e)}function U(n,e,...t){if(!n)throw q0(e,...t)}function si(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ym(e),new Error(e)}function dr(n,e){n||si(e)}function Rd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function z0(){return wO()==="http:"||wO()==="https:"}function wO(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function A9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(z0()||jm()||"connection"in navigator)?navigator.onLine:!0}function R9(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var $o=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,dr(t>e,"Short delay should be less than long delay!"),this.isMobile=wd()||Vo()}get(){return A9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function G0(n,e){dr(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var xd=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;si("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;si("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;si("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var x9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var N9=new $o(3e4,6e4);function pt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function mt(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){return VO(n,i,()=>g(this,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let h=Bi(Object.assign({key:n.config.apiKey},d)).slice(1),p=yield n._getAdditionalHeaders();return p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode),xd.fetch()(UO(n,n.config.apiHost,t,h),Object.assign({method:e,headers:p,referrerPolicy:"no-referrer"},l))}))})}function VO(n,e,t){return g(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},x9),e);try{let i=new g0(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Td(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Td(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Td(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Td(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw H0(n,d,l);Rt(n,d)}}catch(i){if(i instanceof ft)throw i;Rt(n,"network-request-failed",{message:String(i)})}})}function Hi(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){let l=yield mt(n,e,t,r,i);return"mfaPendingCredential"in l&&Rt(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function UO(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?G0(n.config,i):`${n.config.apiScheme}://${i}`}function P9(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var g0=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(At(this.auth,"network-request-failed")),N9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Td(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=At(n,e,r);return i.customData._tokenResponse=t,i}function IO(n){return n!==void 0&&n.getResponse!==void 0}function EO(n){return n!==void 0&&n.enterprise!==void 0}var _0=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return P9(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function M9(n){return g(this,null,function*(){return(yield mt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})}function k9(n,e){return g(this,null,function*(){return mt(n,"GET","/v2/recaptchaConfig",pt(n,e))})}function O9(n,e){return g(this,null,function*(){return mt(n,"POST","/v1/accounts:delete",e)})}function F9(n,e){return g(this,null,function*(){return mt(n,"POST","/v1/accounts:update",e)})}function BO(n,e){return g(this,null,function*(){return mt(n,"POST","/v1/accounts:lookup",e)})}function Dd(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function jO(n,e=!1){return g(this,null,function*(){let t=q(n),r=yield t.getIdToken(e),i=lg(r);U(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Dd(h0(i.auth_time)),issuedAtTime:Dd(h0(i.iat)),expirationTime:Dd(h0(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function h0(n){return Number(n)*1e3}function lg(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ym("JWT malformed, contained fewer than 3 sections"),null;try{let i=vd(t);return i?JSON.parse(i):(Ym("Failed to decode base64 JWT payload"),null)}catch(i){return Ym("Caught error parsing JWT payload as JSON",i?.toString()),null}}function bO(n){let e=lg(n);return U(e,"internal-error"),U(typeof e.exp<"u","internal-error"),U(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function $i(n,e,t=!1){return g(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof ft&&L9(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function L9({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var y0=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Nd=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Dd(this.lastLoginAt),this.creationTime=Dd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Pd(n){return g(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield $i(n,BO(t,{idToken:r}));U(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?HO(s.providerUserInfo):[],a=V9(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,d=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Nd(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,h)})}function $O(n){return g(this,null,function*(){let e=q(n);yield Pd(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function V9(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function HO(n){return n.map(e=>{var{providerId:t}=e,r=zf(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function U9(n,e){return g(this,null,function*(){let t=yield VO(n,{},()=>g(this,null,function*(){let r=Bi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=UO(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",xd.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function B9(n,e){return g(this,null,function*(){return mt(n,"POST","/v2/accounts:revokeToken",pt(n,e))})}var Sd=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){U(e.idToken,"internal-error"),U(typeof e.idToken<"u","internal-error"),U(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):bO(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){U(e.length!==0,"internal-error");let t=bO(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return g(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(U(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield U9(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(U(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(U(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(U(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return si("not implemented")}};function As(n,e){U(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Ho=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=zf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new y0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Nd(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let t=yield $i(this,this.stsTokenManager.getToken(this.auth,e));return U(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return jO(this,e)}reload(){return $O(this)}_assign(e){this!==e&&(U(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Pd(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(ct(this.auth.app))return Promise.reject($t(this.auth));let e=yield this.getIdToken();return yield $i(this,O9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,d;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,w=(o=t.photoURL)!==null&&o!==void 0?o:void 0,S=(a=t.tenantId)!==null&&a!==void 0?a:void 0,R=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,L=(l=t.createdAt)!==null&&l!==void 0?l:void 0,K=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:B,emailVerified:J,isAnonymous:ce,providerData:ee,stsTokenManager:b}=t;U(B&&b,e,"internal-error");let v=Sd.fromJSON(this.name,b);U(typeof B=="string",e,"internal-error"),As(h,e.name),As(p,e.name),U(typeof J=="boolean",e,"internal-error"),U(typeof ce=="boolean",e,"internal-error"),As(_,e.name),As(w,e.name),As(S,e.name),As(R,e.name),As(L,e.name),As(K,e.name);let I=new n({uid:B,auth:e,email:p,emailVerified:J,displayName:h,isAnonymous:ce,photoURL:w,phoneNumber:_,tenantId:S,stsTokenManager:v,createdAt:L,lastLoginAt:K});return ee&&Array.isArray(ee)&&(I.providerData=ee.map(D=>Object.assign({},D))),R&&(I._redirectEventId=R),I}static _fromIdTokenResponse(e,t,r=!1){return g(this,null,function*(){let i=new Sd;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Pd(s),s})}static _fromGetAccountInfoResponse(e,t,r){return g(this,null,function*(){let i=t.users[0];U(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?HO(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new Sd;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Nd(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var CO=new Map;function ln(n){dr(n instanceof Function,"Expected a class definition");let e=CO.get(n);return e?(dr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,CO.set(n,e),e)}var j9=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(t,r){return g(this,null,function*(){this.storage[t]=r})}_get(t){return g(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return g(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),xs=j9;function oi(n,e,t){return`firebase:${n}:${e}:${t}`}var Zm=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=oi(this.userKey,i.apiKey,s),this.fullPersistenceKey=oi("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Ho._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return g(this,null,function*(){if(!t.length)return new n(ln(xs),e,r);let i=(yield Promise.all(t.map(l=>g(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||ln(xs),o=oi(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let d=yield l._get(o);if(d){let h=Ho._fromJSON(e,d);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>g(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,r))})}};function TO(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(GO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(WO(e))return"Blackberry";if(KO(e))return"Webos";if(W0(e))return"Safari";if((e.includes("chrome/")||zO(e))&&!e.includes("edge/"))return"Chrome";if(Hc(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function qO(n=ze()){return/firefox\//i.test(n)}function W0(n=ze()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function zO(n=ze()){return/crios\//i.test(n)}function GO(n=ze()){return/iemobile/i.test(n)}function Hc(n=ze()){return/android/i.test(n)}function WO(n=ze()){return/blackberry/i.test(n)}function KO(n=ze()){return/webos/i.test(n)}function Ko(n=ze()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function QO(n=ze()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function $9(n=ze()){var e;return Ko(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function H9(){return $m()&&document.documentMode===10}function YO(n=ze()){return Ko(n)||Hc(n)||KO(n)||WO(n)||/windows phone/i.test(n)||GO(n)}function q9(){try{return!!(window&&window!==window.top)}catch{return!1}}function K0(n,e=[]){let t;switch(n){case"Browser":t=TO(ze());break;case"Worker":t=`${TO(ze())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${wn}/${r}`}var v0=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function z9(t){return g(this,arguments,function*(n,e={}){return mt(n,"GET","/v2/passwordPolicy",pt(n,e))})}var G9=6,w0=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:G9,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var eg=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tg(this),this.idTokenSubscription=new tg(this),this.beforeStateQueue=new v0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=LO,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ln(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Zm.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let t=yield BO(this,{idToken:e}),r=yield Ho._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var t;if(ct(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return U(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield Pd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=R9()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(ct(this.app))return Promise.reject($t(this));let t=e?q(e):null;return t&&U(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&U(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return ct(this.app)?Promise.reject($t(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return ct(this.app)?Promise.reject($t(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(ln(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield z9(this),t=new w0(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new lr("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield B9(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&ln(e)||this._popupRedirectResolver;U(t,this,"argument-error"),this.redirectPersistenceManager=yield Zm.create(this,[ln(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(U(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=K0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return g(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&S9(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Ze(n){return q(n)}var tg=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Hm(t=>this.observer=t)}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var $d={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function W9(n){$d=n}function Q0(n){return $d.loadJS(n)}function K9(){return $d.recaptchaV2Script}function Q9(){return $d.recaptchaEnterpriseScript}function Y9(){return $d.gapiScript}function JO(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var J9="recaptcha-enterprise",X9="NO_RECAPTCHA",I0=class{constructor(e){this.type=J9,this.auth=Ze(e)}verify(e="verify",t=!1){return g(this,null,function*(){function r(s){return g(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>g(this,null,function*(){k9(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let l=new _0(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;EO(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(X9)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&EO(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Q9();c.length!==0&&(c+=a),Q0(c).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})})}};function DO(n,e,t,r=!1){return g(this,null,function*(){let i=new I0(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function Md(n,e,t,r){return g(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield DO(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>g(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield DO(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function Z9(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(ln);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Y0(n,e,t){let r=Ze(n);U(r._canInitEmulator,r,"emulator-config-failed"),U(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=XO(e),{host:o,port:a}=e6(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||t6()}function XO(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function e6(n){let e=XO(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:SO(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:SO(o)}}}function SO(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function t6(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var ai=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return si("not implemented")}_getIdTokenResponse(e){return si("not implemented")}_linkToIdToken(e,t){return si("not implemented")}_getReauthenticationResolver(e){return si("not implemented")}};function ZO(n,e){return g(this,null,function*(){return mt(n,"POST","/v1/accounts:resetPassword",pt(n,e))})}function n6(n,e){return g(this,null,function*(){return mt(n,"POST","/v1/accounts:update",e)})}function r6(n,e){return g(this,null,function*(){return mt(n,"POST","/v1/accounts:signUp",e)})}function i6(n,e){return g(this,null,function*(){return mt(n,"POST","/v1/accounts:update",pt(n,e))})}function s6(n,e){return g(this,null,function*(){return Hi(n,"POST","/v1/accounts:signInWithPassword",pt(n,e))})}function ug(n,e){return g(this,null,function*(){return mt(n,"POST","/v1/accounts:sendOobCode",pt(n,e))})}function o6(n,e){return g(this,null,function*(){return ug(n,e)})}function a6(n,e){return g(this,null,function*(){return ug(n,e)})}function c6(n,e){return g(this,null,function*(){return ug(n,e)})}function l6(n,e){return g(this,null,function*(){return ug(n,e)})}function u6(n,e){return g(this,null,function*(){return Hi(n,"POST","/v1/accounts:signInWithEmailLink",pt(n,e))})}function d6(n,e){return g(this,null,function*(){return Hi(n,"POST","/v1/accounts:signInWithEmailLink",pt(n,e))})}var kd=class n extends ai{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return g(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Md(e,t,"signInWithPassword",s6);case"emailLink":return u6(e,{email:this._email,oobCode:this._password});default:Rt(e,"internal-error")}})}_linkToIdToken(e,t){return g(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Md(e,r,"signUpPassword",r6);case"emailLink":return d6(e,{idToken:t,email:this._email,oobCode:this._password});default:Rt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function ji(n,e){return g(this,null,function*(){return Hi(n,"POST","/v1/accounts:signInWithIdp",pt(n,e))})}var h6="http://localhost",Nr=class n extends ai{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Rt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=zf(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return ji(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,ji(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,ji(e,t)}buildRequest(){let e={requestUri:h6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Bi(t)}return e}};function f6(n,e){return g(this,null,function*(){return mt(n,"POST","/v1/accounts:sendVerificationCode",pt(n,e))})}function p6(n,e){return g(this,null,function*(){return Hi(n,"POST","/v1/accounts:signInWithPhoneNumber",pt(n,e))})}function m6(n,e){return g(this,null,function*(){let t=yield Hi(n,"POST","/v1/accounts:signInWithPhoneNumber",pt(n,e));if(t.temporaryProof)throw Td(n,"account-exists-with-different-credential",t);return t})}var g6={USER_NOT_FOUND:"user-not-found"};function _6(n,e){return g(this,null,function*(){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Hi(n,"POST","/v1/accounts:signInWithPhoneNumber",pt(n,t),g6)})}var Bc=class n extends ai{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return p6(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return m6(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return _6(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function y6(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function v6(n){let e=Ts(Oc(n)).link,t=e?Ts(Oc(e)).deep_link_id:null,r=Ts(Oc(n)).deep_link_id;return(r?Ts(Oc(r)).link:null)||r||t||e||n}var Od=class n{constructor(e){var t,r,i,s,o,a;let c=Ts(Oc(e)),l=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=y6((i=c.mode)!==null&&i!==void 0?i:null);U(l&&d&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=v6(e);try{return new n(t)}catch{return null}}};var Hd=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return kd._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Od.parseLink(r);return U(i,"argument-error"),kd._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Pr=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Ns=class extends Pr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},jc=class n extends Ns{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return U("providerId"in t&&"signInMethod"in t,"argument-error"),Nr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return U(e.idToken||e.accessToken,"argument-error"),Nr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var dg=(()=>{class n extends Ns{constructor(){super("facebook.com")}static credential(t){return Nr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.FACEBOOK_SIGN_IN_METHOD="facebook.com",n.PROVIDER_ID="facebook.com";return n})(),hg=(()=>{class n extends Ns{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Nr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})(),fg=(()=>{class n extends Ns{constructor(){super("github.com")}static credential(t){return Nr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.GITHUB_SIGN_IN_METHOD="github.com",n.PROVIDER_ID="github.com";return n})(),w6="http://localhost",qo=class n extends ai{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return ji(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,ji(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,ji(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:w6,returnSecureToken:!0,pendingToken:this.pendingToken}}};var I6="saml.",Fd=class n extends Pr{constructor(e){U(e.startsWith(I6),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=qo.fromJSON(e);return U(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return qo._create(r,t)}catch{return null}}};var pg=(()=>{class n extends Ns{constructor(){super("twitter.com")}static credential(t,r){return Nr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return n.credential(r,i)}catch{return null}}}n.TWITTER_SIGN_IN_METHOD="twitter.com",n.PROVIDER_ID="twitter.com";return n})();function e1(n,e){return g(this,null,function*(){return Hi(n,"POST","/v1/accounts:signUp",pt(n,e))})}var Mr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return g(this,null,function*(){let s=yield Ho._fromIdTokenResponse(e,r,i),o=AO(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return g(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=AO(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function AO(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function J0(n){return g(this,null,function*(){var e;if(ct(n.app))return Promise.reject($t(n));let t=Ze(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Mr({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield e1(t,{returnSecureToken:!0}),i=yield Mr._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var E0=class n extends ft{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function t1(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?E0._fromErrorAndOperation(n,s,e,r):s})}function n1(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}function X0(n,e){return g(this,null,function*(){let t=q(n);yield mg(!0,t,e);let{providerUserInfo:r}=yield F9(t.auth,{idToken:yield t.getIdToken(),deleteProvider:[e]}),i=n1(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),yield t.auth._persistUserIfCurrent(t),t})}function Z0(n,e,t=!1){return g(this,null,function*(){let r=yield $i(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Mr._forOperation(n,"link",r)})}function mg(n,e,t){return g(this,null,function*(){yield Pd(e);let r=n1(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";U(r.has(t)===n,e.auth,i)})}function r1(n,e,t=!1){return g(this,null,function*(){let{auth:r}=n;if(ct(r.app))return Promise.reject($t(r));let i="reauthenticate";try{let s=yield $i(n,t1(r,i,e,n),t);U(s.idToken,r,"internal-error");let o=lg(s.idToken);U(o,r,"internal-error");let{sub:a}=o;return U(n.uid===a,r,"user-mismatch"),Mr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Rt(r,"user-mismatch"),s}})}function i1(n,e,t=!1){return g(this,null,function*(){if(ct(n.app))return Promise.reject($t(n));let r="signIn",i=yield t1(n,r,e),s=yield Mr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function qc(n,e){return g(this,null,function*(){return i1(Ze(n),e)})}function gg(n,e){return g(this,null,function*(){let t=q(n);return yield mg(!1,t,e.providerId),Z0(t,e)})}function _g(n,e){return g(this,null,function*(){return r1(q(n),e)})}function E6(n,e){return g(this,null,function*(){return Hi(n,"POST","/v1/accounts:signInWithCustomToken",pt(n,e))})}function eb(n,e){return g(this,null,function*(){if(ct(n.app))return Promise.reject($t(n));let t=Ze(n),r=yield E6(t,{token:e,returnSecureToken:!0}),i=yield Mr._fromIdTokenResponse(t,"signIn",r);return yield t._updateCurrentUser(i.user),i})}var zo=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?b0._fromServerResponse(e,t):"totpInfo"in t?C0._fromServerResponse(e,t):Rt(e,"internal-error")}},b0=class n extends zo{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},C0=class n extends zo{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function yg(n,e,t){var r;U(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),U(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(U(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(U(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function tb(n){return g(this,null,function*(){let e=Ze(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function nb(n,e,t){return g(this,null,function*(){let r=Ze(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&yg(r,i,t),yield Md(r,i,"getOobCode",a6)})}function rb(n,e,t){return g(this,null,function*(){yield ZO(q(n),{oobCode:e,newPassword:t}).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&tb(n),r}))})}function ib(n,e){return g(this,null,function*(){yield i6(q(n),{oobCode:e})})}function vg(n,e){return g(this,null,function*(){let t=q(n),r=yield ZO(t,{oobCode:e}),i=r.requestType;switch(U(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":U(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":U(r.mfaInfo,t,"internal-error");default:U(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=zo._fromServerResponse(Ze(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}})}function sb(n,e){return g(this,null,function*(){let{data:t}=yield vg(q(n),e);return t.email})}function ob(n,e,t){return g(this,null,function*(){if(ct(n.app))return Promise.reject($t(n));let r=Ze(n),o=yield Md(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",e1).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&tb(n),c}),a=yield Mr._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function ab(n,e,t){return ct(n.app)?Promise.reject($t(n)):qc(q(n),Hd.credential(e,t)).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&tb(n),r}))}function cb(n,e,t){return g(this,null,function*(){let r=Ze(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){U(a.handleCodeInApp,r,"argument-error"),a&&yg(r,o,a)}s(i,t),yield Md(r,i,"getOobCode",c6)})}function lb(n,e){let t=Od.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}function ub(n,e,t){return g(this,null,function*(){if(ct(n.app))return Promise.reject($t(n));let r=q(n),i=Hd.credentialWithLink(e,t||Rd());return U(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),qc(r,i)})}function b6(n,e){return g(this,null,function*(){return mt(n,"POST","/v1/accounts:createAuthUri",pt(n,e))})}function db(n,e){return g(this,null,function*(){let t=z0()?Rd():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=yield b6(q(n),r);return i||[]})}function hb(n,e){return g(this,null,function*(){let t=q(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&yg(t.auth,i,e);let{email:s}=yield o6(t.auth,i);s!==n.email&&(yield n.reload())})}function fb(n,e,t){return g(this,null,function*(){let r=q(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield n.getIdToken(),newEmail:e};t&&yg(r.auth,s,t);let{email:o}=yield l6(r.auth,s);o!==n.email&&(yield n.reload())})}function C6(n,e){return g(this,null,function*(){return mt(n,"POST","/v1/accounts:update",e)})}function pb(r,i){return g(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=q(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield $i(s,C6(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let l=s.providerData.find(({providerId:d})=>d==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function mb(n,e){let t=q(n);return ct(t.auth.app)?Promise.reject($t(t.auth)):s1(t,e,null)}function gb(n,e){return s1(q(n),null,e)}function s1(n,e,t){return g(this,null,function*(){let{auth:r}=n,s={idToken:yield n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=yield $i(n,n6(r,s));yield n._updateTokensIfNecessary(o,!0)})}function T6(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=lg(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new Rs(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new T0(s,i);case"github.com":return new D0(s,i);case"google.com":return new S0(s,i);case"twitter.com":return new A0(s,i,n.screenName||null);case"custom":case"anonymous":return new Rs(s,null);default:return new Rs(s,r,i)}}var Rs=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},ng=class extends Rs{constructor(e,t,r,i){super(e,t,r),this.username=i}},T0=class extends Rs{constructor(e,t){super(e,"facebook.com",t)}},D0=class extends ng{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},S0=class extends Rs{constructor(e,t){super(e,"google.com",t)}},A0=class extends ng{constructor(e,t,r){super(e,"twitter.com",t,r)}};function _b(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:T6(t)}var rg=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var R0=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=Ze(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>zo._fromServerResponse(r,a));U(i.mfaPendingCredential,r,"internal-error");let o=rg._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,a=>g(this,null,function*(){let c=yield a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let l=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let d=yield Mr._fromIdTokenResponse(r,t.operationType,l);return yield r._updateCurrentUser(d.user),d;case"reauthenticate":return U(t.user,r,"internal-error"),Mr._forOperation(t.user,t.operationType,l);default:Rt(r,"internal-error")}}))}resolveSignIn(e){return g(this,null,function*(){let t=e;return this.signInResolver(t)})}};function yb(n,e){var t;let r=q(n),i=e;return U(e.customData.operationType,r,"argument-error"),U((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),R0._fromError(r,i)}function D6(n,e){return mt(n,"POST","/v2/accounts/mfaEnrollment:start",pt(n,e))}function S6(n,e){return mt(n,"POST","/v2/accounts/mfaEnrollment:finalize",pt(n,e))}function A6(n,e){return mt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",pt(n,e))}var x0=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>zo._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}getSession(){return g(this,null,function*(){return rg._fromIdtoken(yield this.user.getIdToken(),this.user)})}enroll(e,t){return g(this,null,function*(){let r=e,i=yield this.getSession(),s=yield $i(this.user,r._process(this.user.auth,i,t));return yield this.user._updateTokensIfNecessary(s),this.user.reload()})}unenroll(e){return g(this,null,function*(){let t=typeof e=="string"?e:e.uid,r=yield this.user.getIdToken();try{let i=yield $i(this.user,A6(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),yield this.user._updateTokensIfNecessary(i),yield this.user.reload()}catch(i){throw i}})}},f0=new WeakMap;function vb(n){let e=q(n);return f0.has(e)||f0.set(e,x0._fromUser(e)),f0.get(e)}var ig="__sak";var sg=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ig,"1"),this.storage.removeItem(ig),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function R6(){let n=ze();return W0(n)||Ko(n)}var x6=1e3,N6=10,P6=(()=>{class n extends sg{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=R6()&&q9(),this.fallbackToPolling=YO(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(i);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);H9()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,N6):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},x6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return g(this,null,function*(){yield jr(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return g(this,null,function*(){let r=yield jr(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return g(this,null,function*(){yield jr(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),zc=P6;var M6=(()=>{class n extends sg{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),ci=M6;function k6(n){return Promise.all(n.map(e=>g(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var O6=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return g(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>g(this,null,function*(){return d(r.origin,o)})),l=yield k6(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Qo(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var N0=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return g(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=Qo("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let p=h;if(p.data.eventId===l)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function St(){return window}function F6(n){St().location.href=n}function wb(){return typeof St().WorkerGlobalScope<"u"&&typeof St().importScripts=="function"}function L6(){return g(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function V6(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function U6(){return wb()?self:null}var o1="firebaseLocalStorageDb",B6=1,og="firebaseLocalStorage",a1="fbase_key",Go=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function wg(n,e){return n.transaction([og],e?"readwrite":"readonly").objectStore(og)}function j6(){let n=indexedDB.deleteDatabase(o1);return new Go(n).toPromise()}function P0(){let n=indexedDB.open(o1,B6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(og,{keyPath:a1})}catch(i){t(i)}}),n.addEventListener("success",()=>g(this,null,function*(){let r=n.result;r.objectStoreNames.contains(og)?e(r):(r.close(),yield j6(),e(yield P0()))}))})}function RO(n,e,t){return g(this,null,function*(){let r=wg(n,!0).put({[a1]:e,value:t});return new Go(r).toPromise()})}function $6(n,e){return g(this,null,function*(){let t=wg(n,!1).get(e),r=yield new Go(t).toPromise();return r===void 0?null:r.value})}function xO(n,e){let t=wg(n,!0).delete(e);return new Go(t).toPromise()}var H6=800,q6=3,z6=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db?this.db:(this.db=yield P0(),this.db)})}_withRetries(t){return g(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>q6)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return wb()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=O6._getInstance(U6()),this.receiver._subscribe("keyChanged",(t,r)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var t,r;if(this.activeServiceWorker=yield L6(),!this.activeServiceWorker)return;this.sender=new N0(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return g(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||V6()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;let t=yield P0();return yield RO(t,ig,"1"),yield xO(t,ig),!0}catch{}return!1})}_withPendingWrite(t){return g(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(i=>RO(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return g(this,null,function*(){let r=yield this._withRetries(i=>$6(i,t));return this.localCache[t]=r,r})}_remove(t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(r=>xO(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return g(this,null,function*(){let t=yield this._withRetries(s=>{let o=wg(s,!1).getAll();return new Go(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),H6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Yo=z6;function G6(n,e){return mt(n,"POST","/v2/accounts/mfaSignIn:start",pt(n,e))}function W6(n,e){return mt(n,"POST","/v2/accounts/mfaSignIn:finalize",pt(n,e))}var K6=500,Q6=6e4,Qm=1e12,M0=class{constructor(e){this.auth=e,this.counter=Qm,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new k0(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||Qm;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||Qm;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}execute(e){return g(this,null,function*(){var t;let r=e||Qm;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""})}},k0=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;U(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=Y6(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},Q6)},K6))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function Y6(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var p0=JO("rcb"),J6=new $o(3e4,6e4),O0=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=St().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return U(X6(t),e,"argument-error"),this.shouldResolveImmediately(t)&&IO(St().grecaptcha)?Promise.resolve(St().grecaptcha):new Promise((r,i)=>{let s=St().setTimeout(()=>{i(At(e,"network-request-failed"))},J6.get());St()[p0]=()=>{St().clearTimeout(s),delete St()[p0];let a=St().grecaptcha;if(!a||!IO(a)){i(At(e,"internal-error"));return}let c=a.render;a.render=(l,d)=>{let h=c(l,d);return this.counter++,h},this.hostLanguage=t,r(a)};let o=`${K9()}?${Bi({onload:p0,render:"explicit",hl:t})}`;Q0(o).catch(()=>{clearTimeout(s),i(At(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=St().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function X6(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var F0=class{load(e){return g(this,null,function*(){return new M0(e)})}clearedOneInstance(){}};var c1="recaptcha",Z6={theme:"light",type:"image"},Ld=class{constructor(e,t,r=Object.assign({},Z6)){this.parameters=r,this.type=c1,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ze(e),this.isInvisible=this.parameters.size==="invisible",U(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;U(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new F0:new O0,this.validateStartingState()}verify(){return g(this,null,function*(){this.assertNotDestroyed();let e=yield this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){U(!this.parameters.sitekey,this.auth,"argument-error"),U(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),U(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=St()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){U(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){return g(this,null,function*(){if(yield this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId})}init(){return g(this,null,function*(){U(z0()&&!wb(),this.auth,"internal-error"),yield e8(),this.recaptcha=yield this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=yield M9(this.auth);U(e,this.auth,"internal-error"),this.parameters.sitekey=e})}getAssertedRecaptcha(){return U(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function e8(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var Vd=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=Bc._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};function Ib(n,e,t){return g(this,null,function*(){if(ct(n.app))return Promise.reject($t(n));let r=Ze(n),i=yield Ig(r,e,q(t));return new Vd(i,s=>qc(r,s))})}function Eb(n,e,t){return g(this,null,function*(){let r=q(n);yield mg(!1,r,"phone");let i=yield Ig(r.auth,e,q(t));return new Vd(i,s=>gg(r,s))})}function bb(n,e,t){return g(this,null,function*(){let r=q(n);if(ct(r.auth.app))return Promise.reject($t(r.auth));let i=yield Ig(r.auth,e,q(t));return new Vd(i,s=>_g(r,s))})}function Ig(n,e,t){return g(this,null,function*(){var r;let i=yield t.verify();try{U(typeof i=="string",n,"argument-error"),U(t.type===c1,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return U(o.type==="enroll",n,"internal-error"),(yield D6(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{U(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return U(a,n,"missing-multi-factor-info"),(yield G6(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=yield f6(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}})}function Cb(n,e){return g(this,null,function*(){let t=q(n);if(ct(t.auth.app))return Promise.reject($t(t.auth));yield Z0(t,e)})}var Jo=(()=>{class n{constructor(t){this.providerId=n.PROVIDER_ID,this.auth=Ze(t)}verifyPhoneNumber(t,r){return Ig(this.auth,t,q(r))}static credential(t,r){return Bc._fromVerification(t,r)}static credentialFromResult(t){let r=t;return n.credentialFromTaggedObject(r)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{phoneNumber:r,temporaryProof:i}=t;return r&&i?Bc._fromTokenResponse(r,i):null}}n.PROVIDER_ID="phone",n.PHONE_SIGN_IN_METHOD="phone";return n})();function Xo(n,e){return e?ln(e):(U(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Ud=class extends ai{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ji(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ji(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ji(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function t8(n){return i1(n.auth,new Ud(n),n.bypassAuthState)}function n8(n){let{auth:e,user:t}=n;return U(t,e,"internal-error"),r1(t,new Ud(n),n.bypassAuthState)}function r8(n){return g(this,null,function*(){let{auth:e,user:t}=n;return U(t,e,"internal-error"),Z0(t,new Ud(n),n.bypassAuthState)})}var ag=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return g(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return t8;case"linkViaPopup":case"linkViaRedirect":return r8;case"reauthViaPopup":case"reauthViaRedirect":return n8;default:Rt(this.auth,"internal-error")}}resolve(e){dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var i8=new $o(2e3,1e4);function Tb(n,e,t){return g(this,null,function*(){if(ct(n.app))return Promise.reject(At(n,"operation-not-supported-in-this-environment"));let r=Ze(n);$c(n,e,Pr);let i=Xo(r,t);return new Ab(r,"signInViaPopup",e,i).executeNotNull()})}function Db(n,e,t){return g(this,null,function*(){let r=q(n);if(ct(r.auth.app))return Promise.reject(At(r.auth,"operation-not-supported-in-this-environment"));$c(r.auth,e,Pr);let i=Xo(r.auth,t);return new Ab(r.auth,"reauthViaPopup",e,i,r).executeNotNull()})}function Sb(n,e,t){return g(this,null,function*(){let r=q(n);$c(r.auth,e,Pr);let i=Xo(r.auth,t);return new Ab(r.auth,"linkViaPopup",e,i,r).executeNotNull()})}var Ab=(()=>{class n extends ag{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return g(this,null,function*(){let t=yield this.execute();return U(t,this.auth,"internal-error"),t})}onExecution(){return g(this,null,function*(){dr(this.filter.length===1,"Popup operations only handle one event");let t=Qo();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(At(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(At(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(At(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,i8.get())};t()}}n.currentPopupAction=null;return n})(),s8="pendingRedirect",Ad=new Map,L0=class n extends ag{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return g(this,null,function*(){let e=Ad.get(this.auth._key());if(!e){try{let r=(yield o8(this.resolver,this.auth))?yield jr(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ad.set(this.auth._key(),e)}return this.bypassAuthState||Ad.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if(e.type==="signInViaRedirect")return jr(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,jr(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return g(this,null,function*(){})}cleanUp(){}};function o8(n,e){return g(this,null,function*(){let t=d1(e),r=u1(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Rb(n,e){return g(this,null,function*(){return u1(n)._set(d1(e),"true")})}function l1(){Ad.clear()}function Gc(n,e){Ad.set(n._key(),e)}function u1(n){return ln(n._redirectPersistence)}function d1(n){return oi(s8,n.config.apiKey,n.name)}function xb(n,e,t){return a8(n,e,t)}function a8(n,e,t){return g(this,null,function*(){if(ct(n.app))return Promise.reject($t(n));let r=Ze(n);$c(n,e,Pr),yield r._initializationPromise;let i=Xo(r,t);return yield Rb(i,r),i._openRedirect(r,e,"signInViaRedirect")})}function Nb(n,e,t){return c8(n,e,t)}function c8(n,e,t){return g(this,null,function*(){let r=q(n);if($c(r.auth,e,Pr),ct(r.auth.app))return Promise.reject($t(r.auth));yield r.auth._initializationPromise;let i=Xo(r.auth,t);yield Rb(i,r.auth);let s=yield h1(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)})}function Pb(n,e,t){return l8(n,e,t)}function l8(n,e,t){return g(this,null,function*(){let r=q(n);$c(r.auth,e,Pr),yield r.auth._initializationPromise;let i=Xo(r.auth,t);yield mg(!1,r,e.providerId),yield Rb(i,r.auth);let s=yield h1(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)})}function Mb(n,e){return g(this,null,function*(){return yield Ze(n)._initializationPromise,Zo(n,e,!1)})}function Zo(n,e,t=!1){return g(this,null,function*(){if(ct(n.app))return Promise.reject($t(n));let r=Ze(n),i=Xo(r,e),o=yield new L0(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}function h1(n){return g(this,null,function*(){let e=Qo(`${n.uid}:::`);return n._redirectEventId=e,yield n.auth._setRedirectUser(n),yield n.auth._persistUserIfCurrent(n),e})}var u8=10*60*1e3,Bd=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!d8(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!f1(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(At(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=u8&&this.cachedEventUids.clear(),this.cachedEventUids.has(NO(e))}saveEventToCache(e){this.cachedEventUids.add(NO(e)),this.lastProcessedEventTime=Date.now()}};function NO(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function f1({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function d8(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return f1(n);default:return!1}}function kb(t){return g(this,arguments,function*(n,e={}){return mt(n,"GET","/v1/projects",e)})}var h8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,f8=/^https?/;function p8(n){return g(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield kb(n);for(let t of e)try{if(m8(t))return}catch{}Rt(n,"unauthorized-domain")})}function m8(n){let e=Rd(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!f8.test(t))return!1;if(h8.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var g8=new $o(3e4,6e4);function PO(){let n=St().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function _8(n){return new Promise((e,t)=>{var r,i,s;function o(){PO(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{PO(),t(At(n,"network-request-failed"))},timeout:g8.get()})}if(!((i=(r=St().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=St().gapi)===null||s===void 0)&&s.load)o();else{let a=JO("iframefcb");return St()[a]=()=>{gapi.load?o():t(At(n,"network-request-failed"))},Q0(`${Y9()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Jm=null,e})}var Jm=null;function y8(n){return Jm=Jm||_8(n),Jm}var v8=new $o(5e3,15e3),w8="__/auth/iframe",I8="emulator/auth/iframe",E8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},b8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function C8(n){let e=n.config;U(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?G0(e,I8):`https://${n.config.authDomain}/${w8}`,r={apiKey:e.apiKey,appName:n.name,v:wn},i=b8.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Bi(r).slice(1)}`}function T8(n){return g(this,null,function*(){let e=yield y8(n),t=St().gapi;return U(t,n,"internal-error"),e.open({where:document.body,url:C8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:E8,dontclear:!0},r=>new Promise((i,s)=>g(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=At(n,"network-request-failed"),a=St().setTimeout(()=>{s(o)},v8.get());function c(){St().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var D8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},S8=500,A8=600,R8="_blank",x8="http://localhost",jd=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function N8(n,e,t,r=S8,i=A8){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},D8),{width:r.toString(),height:i.toString(),top:s,left:o}),l=ze().toLowerCase();t&&(a=zO(l)?R8:t),qO(l)&&(e=e||x8,c.scrollbars="yes");let d=Object.entries(c).reduce((p,[_,w])=>`${p}${_}=${w},`,"");if($9(l)&&a!=="_self")return P8(e||"",a),new jd(null);let h=window.open(e||"",a,d);U(h,n,"popup-blocked");try{h.focus()}catch{}return new jd(h)}function P8(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var M8="__/auth/handler",k8="emulator/auth/handler",O8=encodeURIComponent("fac");function cg(n,e,t,r,i,s){return g(this,null,function*(){U(n.config.authDomain,n,"auth-domain-config-required"),U(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:wn,eventId:i};if(e instanceof Pr){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",kc(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(s||{}))o[d]=h}if(e instanceof Ns){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),l=c?`#${O8}=${encodeURIComponent(c)}`:"";return`${F8(n)}?${Bi(a).slice(1)}${l}`})}function F8({config:n}){return n.emulator?G0(n,k8):`https://${n.authDomain}/${M8}`}var m0="webStorageSupport",V0=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ci,this._completeRedirectFn=Zo,this._overrideRedirectResult=Gc}_openPopup(e,t,r,i){return g(this,null,function*(){var s;dr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield cg(e,t,r,Rd(),i);return N8(e,o,Qo())})}_openRedirect(e,t,r,i){return g(this,null,function*(){yield this._originValidation(e);let s=yield cg(e,t,r,Rd(),i);return F6(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(dr(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return g(this,null,function*(){let t=yield T8(e),r=new Bd(e);return t.register("authEvent",i=>(U(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(m0,{type:m0},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[m0];o!==void 0&&t(!!o),Rt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=p8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return YO()||W0()||Ko()}},Ob=V0,U0=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return si("unexpected MultiFactorSessionType")}}},B0=class n extends U0{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return S6(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return W6(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},Fb=(()=>{class n{constructor(){}static assertion(t){return B0._fromCredential(t)}}return n.FACTOR_ID="phone",n})();var MO="@firebase/auth",kO="1.7.4";var j0=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function L8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function V8(n){vn(new $e("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;U(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:K0(n)},l=new eg(r,i,s,c);return Z9(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),vn(new $e("auth-internal",e=>{let t=Ze(e.getProvider("auth").getImmediate());return(r=>new j0(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),wt(MO,kO,L8(n)),wt(MO,kO,"esm2017")}var U8=5*60,Uae=Kk("authIdTokenMaxAge")||U8;function B8(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}W9({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=At("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",B8().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});V8("Browser");function ea(){return window}var j8=2e3;function $8(n,e,t){return g(this,null,function*(){var r;let{BuildInfo:i}=ea();dr(e.sessionId,"AuthEvent did not contain a session ID");let s=yield W8(e.sessionId),o={};return Ko()?o.ibi=i.packageName:Hc()?o.apn=i.packageName:Rt(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,cg(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)})}function H8(n){return g(this,null,function*(){let{BuildInfo:e}=ea(),t={};Ko()?t.iosBundleId=e.packageName:Hc()?t.androidPackageName=e.packageName:Rt(n,"operation-not-supported-in-this-environment"),yield kb(n,t)})}function q8(n){let{cordova:e}=ea();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,QO()?"_blank":"_system","location=yes"),t(i)})})}function z8(n,e,t){return g(this,null,function*(){let{cordova:r}=ea(),i=()=>{};try{yield new Promise((s,o)=>{let a=null;function c(){var h;s();let p=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof p=="function"&&p(),typeof t?.close=="function"&&t.close()}function l(){a||(a=window.setTimeout(()=>{o(At(n,"redirect-cancelled-by-user"))},j8))}function d(){document?.visibilityState==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),Hc()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}})}function G8(n){var e,t,r,i,s,o,a,c,l,d;let h=ea();U(typeof((e=h?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),U(typeof((t=h?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),U(typeof((s=(i=(r=h?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U(typeof((c=(a=(o=h?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U(typeof((d=(l=h?.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function W8(n){return g(this,null,function*(){let e=K8(n),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")})}function K8(n){if(dr(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var Q8=20,Lb=class extends Bd{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}initialized(){return g(this,null,function*(){yield this.initPromise})}};function Y8(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:Z8(),postBody:null,tenantId:n.tenantId,error:At(n,"no-auth-event")}}function J8(n,e){return Vb()._set(Ub(n),e)}function p1(n){return g(this,null,function*(){let e=yield Vb()._get(Ub(n));return e&&(yield Vb()._remove(Ub(n))),e})}function X8(n,e){var t,r;let i=tK(e);if(i.includes("/__/auth/callback")){let s=Eg(i),o=s.firebaseError?eK(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?At(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function Z8(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<Q8;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function Vb(){return ln(zc)}function Ub(n){return oi("authEvent",n.config.apiKey,n.name)}function eK(n){try{return JSON.parse(n)}catch{return null}}function tK(n){let e=Eg(n),t=e.link?decodeURIComponent(e.link):void 0,r=Eg(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Eg(i).link||i||r||t||n}function Eg(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return Ts(t.join("?"))}var nK=500,Bb=class{constructor(){this._redirectPersistence=ci,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Zo,this._overrideRedirectResult=Gc}_initialize(e){return g(this,null,function*(){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new Lb(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r})}_openPopup(e){Rt(e,"operation-not-supported-in-this-environment")}_openRedirect(e,t,r,i){return g(this,null,function*(){G8(e);let s=yield this._initialize(e);yield s.initialized(),s.resetRedirect(),l1(),yield this._originValidation(e);let o=Y8(e,r,i);yield J8(e,o);let a=yield $8(e,o,t),c=yield q8(a);return z8(e,s,c)})}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=H8(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=ea(),o=setTimeout(()=>g(this,null,function*(){yield p1(e),t.onEvent(m1())}),nK),a=d=>g(this,null,function*(){clearTimeout(o);let h=yield p1(e),p=null;h&&d?.url&&(p=X8(h,d.url)),t.onEvent(p||m1())});typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,l=`${s.packageName.toLowerCase()}://`;ea().handleOpenURL=d=>g(this,null,function*(){if(d.toLowerCase().startsWith(l)&&a({url:d}),typeof c=="function")try{c(d)}catch(h){console.error(h)}})}},g1=Bb;function m1(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:At("no-auth-event")}}function _1(n,e){Ze(n)._logFramework(e)}var iK="@firebase/auth-compat",sK="0.5.9";var oK=1e3;function Gd(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function aK(){return Gd()==="http:"||Gd()==="https:"}function w1(n=ze()){return!!((Gd()==="file:"||Gd()==="ionic:"||Gd()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function cK(){return Vo()||Um()}function lK(){return $m()&&document?.documentMode===11}function uK(n=ze()){return/Edge\/\d+/.test(n)}function dK(n=ze()){return lK()||uK(n)}function I1(){try{let n=self.localStorage,e=Qo();if(n)return n.setItem(e,"1"),n.removeItem(e),dK()?Es():!0}catch{return Gb()&&Es()}return!1}function Gb(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function jb(){return(aK()||jm()||w1())&&!cK()&&I1()&&!Gb()}function E1(){return w1()&&typeof document<"u"}function hK(){return g(this,null,function*(){return E1()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},oK);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1})}function fK(){return typeof window<"u"?window:null}var Wn={LOCAL:"local",NONE:"none",SESSION:"session"},qd=U,b1="persistence";function pK(n,e){if(qd(Object.values(Wn).includes(e),n,"invalid-persistence-type"),Vo()){qd(e!==Wn.SESSION,n,"unsupported-persistence-type");return}if(Um()){qd(e===Wn.NONE,n,"unsupported-persistence-type");return}if(Gb()){qd(e===Wn.NONE||e===Wn.LOCAL&&Es(),n,"unsupported-persistence-type");return}qd(e===Wn.NONE||I1(),n,"unsupported-persistence-type")}function $b(n){return g(this,null,function*(){yield n._initializationPromise;let e=C1(),t=oi(b1,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())})}function mK(n,e){let t=C1();if(!t)return[];let r=oi(b1,n,e);switch(t.getItem(r)){case Wn.NONE:return[xs];case Wn.LOCAL:return[Yo,ci];case Wn.SESSION:return[ci];default:return[]}}function C1(){var n;try{return((n=fK())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var gK=U,li=class{constructor(){this.browserResolver=ln(Ob),this.cordovaResolver=ln(g1),this.underlyingResolver=null,this._redirectPersistence=ci,this._completeRedirectFn=Zo,this._overrideRedirectResult=Gc}_initialize(e){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)})}_openPopup(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)})}_openRedirect(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)})}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return E1()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return gK(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){return g(this,null,function*(){if(this.underlyingResolver)return;let e=yield hK();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver})}};function T1(n){return n.unwrap()}function _K(n){return n.wrapped()}function yK(n){return D1(n)}function vK(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new qb(n,yb(n,e))}else if(r){let i=D1(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function D1(n){let{_tokenResponse:e}=n instanceof ft?n.customData:n;if(!e)return null;if(!(n instanceof ft)&&"temporaryProof"in e&&"phoneNumber"in e)return Jo.credentialFromResult(n);let t=e.providerId;if(!t||t===Wo.PASSWORD)return null;let r;switch(t){case Wo.GOOGLE:r=hg;break;case Wo.FACEBOOK:r=dg;break;case Wo.GITHUB:r=fg;break;case Wo.TWITTER:r=pg;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?qo._create(t,a):Nr._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new jc(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof ft?r.credentialFromError(n):r.credentialFromResult(n)}function Fn(n,e){return e.catch(t=>{throw t instanceof ft&&vK(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:yK(t),additionalUserInfo:_b(t),user:Wc.getOrCreate(i)}})}function Hb(n,e){return g(this,null,function*(){let t=yield e;return{verificationId:t.verificationId,confirm:r=>Fn(n,t.confirm(r))}})}var qb=class{constructor(e,t){this.resolver=t,this.auth=_K(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Fn(T1(this.auth),this.resolver.resolveSignIn(e))}};var Wc=class n{constructor(e){this._delegate=e,this.multiFactor=vb(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}linkWithCredential(e){return g(this,null,function*(){return Fn(this.auth,gg(this._delegate,e))})}linkWithPhoneNumber(e,t){return g(this,null,function*(){return Hb(this.auth,Eb(this._delegate,e,t))})}linkWithPopup(e){return g(this,null,function*(){return Fn(this.auth,Sb(this._delegate,e,li))})}linkWithRedirect(e){return g(this,null,function*(){return yield $b(Ze(this.auth)),Pb(this._delegate,e,li)})}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}reauthenticateWithCredential(e){return g(this,null,function*(){return Fn(this.auth,_g(this._delegate,e))})}reauthenticateWithPhoneNumber(e,t){return Hb(this.auth,bb(this._delegate,e,t))}reauthenticateWithPopup(e){return Fn(this.auth,Db(this._delegate,e,li))}reauthenticateWithRedirect(e){return g(this,null,function*(){return yield $b(Ze(this.auth)),Nb(this._delegate,e,li)})}sendEmailVerification(e){return hb(this._delegate,e)}unlink(e){return g(this,null,function*(){return yield X0(this._delegate,e),this})}updateEmail(e){return mb(this._delegate,e)}updatePassword(e){return gb(this._delegate,e)}updatePhoneNumber(e){return Cb(this._delegate,e)}updateProfile(e){return pb(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return fb(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Wc.USER_MAP=new WeakMap;var zd=U,y1=(()=>{class n{constructor(t,r){if(this.app=t,r.isInitialized()){this._delegate=r.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:i}=t.options;zd(i,"invalid-api-key",{appName:t.name}),zd(i,"invalid-api-key",{appName:t.name});let s=typeof window<"u"?li:void 0;this._delegate=r.initialize({options:{persistence:wK(i,t.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap($0),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Wc.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,r){Y0(this._delegate,t,r)}applyActionCode(t){return ib(this._delegate,t)}checkActionCode(t){return vg(this._delegate,t)}confirmPasswordReset(t,r){return rb(this._delegate,t,r)}createUserWithEmailAndPassword(t,r){return g(this,null,function*(){return Fn(this._delegate,ob(this._delegate,t,r))})}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return db(this._delegate,t)}isSignInWithEmailLink(t){return lb(this._delegate,t)}getRedirectResult(){return g(this,null,function*(){zd(jb(),this._delegate,"operation-not-supported-in-this-environment");let t=yield Mb(this._delegate,li);return t?Fn(this._delegate,Promise.resolve(t)):{credential:null,user:null}})}addFrameworkForLogging(t){_1(this._delegate,t)}onAuthStateChanged(t,r,i){let{next:s,error:o,complete:a}=v1(t,r,i);return this._delegate.onAuthStateChanged(s,o,a)}onIdTokenChanged(t,r,i){let{next:s,error:o,complete:a}=v1(t,r,i);return this._delegate.onIdTokenChanged(s,o,a)}sendSignInLinkToEmail(t,r){return cb(this._delegate,t,r)}sendPasswordResetEmail(t,r){return nb(this._delegate,t,r||void 0)}setPersistence(t){return g(this,null,function*(){pK(this._delegate,t);let r;switch(t){case Wn.SESSION:r=ci;break;case Wn.LOCAL:r=(yield ln(Yo)._isAvailable())?Yo:zc;break;case Wn.NONE:r=xs;break;default:return Rt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)})}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return Fn(this._delegate,J0(this._delegate))}signInWithCredential(t){return Fn(this._delegate,qc(this._delegate,t))}signInWithCustomToken(t){return Fn(this._delegate,eb(this._delegate,t))}signInWithEmailAndPassword(t,r){return Fn(this._delegate,ab(this._delegate,t,r))}signInWithEmailLink(t,r){return Fn(this._delegate,ub(this._delegate,t,r))}signInWithPhoneNumber(t,r){return Hb(this._delegate,Ib(this._delegate,t,r))}signInWithPopup(t){return g(this,null,function*(){return zd(jb(),this._delegate,"operation-not-supported-in-this-environment"),Fn(this._delegate,Tb(this._delegate,t,li))})}signInWithRedirect(t){return g(this,null,function*(){return zd(jb(),this._delegate,"operation-not-supported-in-this-environment"),yield $b(this._delegate),xb(this._delegate,t,li)})}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return sb(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=Wn,n})();function v1(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&Wc.getOrCreate(o)),error:e,complete:t}}function wK(n,e){let t=mK(n,e);if(typeof self<"u"&&!t.includes(Yo)&&t.push(Yo),typeof window<"u")for(let r of[zc,ci])t.includes(r)||t.push(r);return t.includes(xs)||t.push(xs),t}var Wd=class{constructor(){this.providerId="phone",this._delegate=new Jo(T1(G.auth()))}static credential(e,t){return Jo.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};Wd.PHONE_SIGN_IN_METHOD=Jo.PHONE_SIGN_IN_METHOD;Wd.PROVIDER_ID=Jo.PROVIDER_ID;var IK=U,zb=class{constructor(e,t,r=G.app()){var i;IK((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new Ld(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var EK="auth-compat";function bK(n){n.INTERNAL.registerComponent(new $e(EK,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new y1(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Ps.EMAIL_SIGNIN,PASSWORD_RESET:Ps.PASSWORD_RESET,RECOVER_EMAIL:Ps.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Ps.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Ps.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Ps.VERIFY_EMAIL}},EmailAuthProvider:Hd,FacebookAuthProvider:dg,GithubAuthProvider:fg,GoogleAuthProvider:hg,OAuthProvider:jc,SAMLAuthProvider:Fd,PhoneAuthProvider:Wd,PhoneMultiFactorGenerator:Fb,RecaptchaVerifier:zb,TwitterAuthProvider:pg,Auth:y1,AuthCredential:ai,Error:ft}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(iK,sK)}bK(G);var S1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},A1={};var Ms,Wb;(function(){var n;function e(b,v){function I(){}I.prototype=v.prototype,b.D=v.prototype,b.prototype=new I,b.prototype.constructor=b,b.C=function(D,A,P){for(var E=Array(arguments.length-2),Ri=2;Ri<arguments.length;Ri++)E[Ri-2]=arguments[Ri];return v.prototype[A].apply(D,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(b,v,I){I||(I=0);var D=Array(16);if(typeof v=="string")for(var A=0;16>A;++A)D[A]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(A=0;16>A;++A)D[A]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=b.g[0],I=b.g[1],A=b.g[2];var P=b.g[3],E=v+(P^I&(A^P))+D[0]+3614090360&4294967295;v=I+(E<<7&4294967295|E>>>25),E=P+(A^v&(I^A))+D[1]+3905402710&4294967295,P=v+(E<<12&4294967295|E>>>20),E=A+(I^P&(v^I))+D[2]+606105819&4294967295,A=P+(E<<17&4294967295|E>>>15),E=I+(v^A&(P^v))+D[3]+3250441966&4294967295,I=A+(E<<22&4294967295|E>>>10),E=v+(P^I&(A^P))+D[4]+4118548399&4294967295,v=I+(E<<7&4294967295|E>>>25),E=P+(A^v&(I^A))+D[5]+1200080426&4294967295,P=v+(E<<12&4294967295|E>>>20),E=A+(I^P&(v^I))+D[6]+2821735955&4294967295,A=P+(E<<17&4294967295|E>>>15),E=I+(v^A&(P^v))+D[7]+4249261313&4294967295,I=A+(E<<22&4294967295|E>>>10),E=v+(P^I&(A^P))+D[8]+1770035416&4294967295,v=I+(E<<7&4294967295|E>>>25),E=P+(A^v&(I^A))+D[9]+2336552879&4294967295,P=v+(E<<12&4294967295|E>>>20),E=A+(I^P&(v^I))+D[10]+4294925233&4294967295,A=P+(E<<17&4294967295|E>>>15),E=I+(v^A&(P^v))+D[11]+2304563134&4294967295,I=A+(E<<22&4294967295|E>>>10),E=v+(P^I&(A^P))+D[12]+1804603682&4294967295,v=I+(E<<7&4294967295|E>>>25),E=P+(A^v&(I^A))+D[13]+4254626195&4294967295,P=v+(E<<12&4294967295|E>>>20),E=A+(I^P&(v^I))+D[14]+2792965006&4294967295,A=P+(E<<17&4294967295|E>>>15),E=I+(v^A&(P^v))+D[15]+1236535329&4294967295,I=A+(E<<22&4294967295|E>>>10),E=v+(A^P&(I^A))+D[1]+4129170786&4294967295,v=I+(E<<5&4294967295|E>>>27),E=P+(I^A&(v^I))+D[6]+3225465664&4294967295,P=v+(E<<9&4294967295|E>>>23),E=A+(v^I&(P^v))+D[11]+643717713&4294967295,A=P+(E<<14&4294967295|E>>>18),E=I+(P^v&(A^P))+D[0]+3921069994&4294967295,I=A+(E<<20&4294967295|E>>>12),E=v+(A^P&(I^A))+D[5]+3593408605&4294967295,v=I+(E<<5&4294967295|E>>>27),E=P+(I^A&(v^I))+D[10]+38016083&4294967295,P=v+(E<<9&4294967295|E>>>23),E=A+(v^I&(P^v))+D[15]+3634488961&4294967295,A=P+(E<<14&4294967295|E>>>18),E=I+(P^v&(A^P))+D[4]+3889429448&4294967295,I=A+(E<<20&4294967295|E>>>12),E=v+(A^P&(I^A))+D[9]+568446438&4294967295,v=I+(E<<5&4294967295|E>>>27),E=P+(I^A&(v^I))+D[14]+3275163606&4294967295,P=v+(E<<9&4294967295|E>>>23),E=A+(v^I&(P^v))+D[3]+4107603335&4294967295,A=P+(E<<14&4294967295|E>>>18),E=I+(P^v&(A^P))+D[8]+1163531501&4294967295,I=A+(E<<20&4294967295|E>>>12),E=v+(A^P&(I^A))+D[13]+2850285829&4294967295,v=I+(E<<5&4294967295|E>>>27),E=P+(I^A&(v^I))+D[2]+4243563512&4294967295,P=v+(E<<9&4294967295|E>>>23),E=A+(v^I&(P^v))+D[7]+1735328473&4294967295,A=P+(E<<14&4294967295|E>>>18),E=I+(P^v&(A^P))+D[12]+2368359562&4294967295,I=A+(E<<20&4294967295|E>>>12),E=v+(I^A^P)+D[5]+4294588738&4294967295,v=I+(E<<4&4294967295|E>>>28),E=P+(v^I^A)+D[8]+2272392833&4294967295,P=v+(E<<11&4294967295|E>>>21),E=A+(P^v^I)+D[11]+1839030562&4294967295,A=P+(E<<16&4294967295|E>>>16),E=I+(A^P^v)+D[14]+4259657740&4294967295,I=A+(E<<23&4294967295|E>>>9),E=v+(I^A^P)+D[1]+2763975236&4294967295,v=I+(E<<4&4294967295|E>>>28),E=P+(v^I^A)+D[4]+1272893353&4294967295,P=v+(E<<11&4294967295|E>>>21),E=A+(P^v^I)+D[7]+4139469664&4294967295,A=P+(E<<16&4294967295|E>>>16),E=I+(A^P^v)+D[10]+3200236656&4294967295,I=A+(E<<23&4294967295|E>>>9),E=v+(I^A^P)+D[13]+681279174&4294967295,v=I+(E<<4&4294967295|E>>>28),E=P+(v^I^A)+D[0]+3936430074&4294967295,P=v+(E<<11&4294967295|E>>>21),E=A+(P^v^I)+D[3]+3572445317&4294967295,A=P+(E<<16&4294967295|E>>>16),E=I+(A^P^v)+D[6]+76029189&4294967295,I=A+(E<<23&4294967295|E>>>9),E=v+(I^A^P)+D[9]+3654602809&4294967295,v=I+(E<<4&4294967295|E>>>28),E=P+(v^I^A)+D[12]+3873151461&4294967295,P=v+(E<<11&4294967295|E>>>21),E=A+(P^v^I)+D[15]+530742520&4294967295,A=P+(E<<16&4294967295|E>>>16),E=I+(A^P^v)+D[2]+3299628645&4294967295,I=A+(E<<23&4294967295|E>>>9),E=v+(A^(I|~P))+D[0]+4096336452&4294967295,v=I+(E<<6&4294967295|E>>>26),E=P+(I^(v|~A))+D[7]+1126891415&4294967295,P=v+(E<<10&4294967295|E>>>22),E=A+(v^(P|~I))+D[14]+2878612391&4294967295,A=P+(E<<15&4294967295|E>>>17),E=I+(P^(A|~v))+D[5]+4237533241&4294967295,I=A+(E<<21&4294967295|E>>>11),E=v+(A^(I|~P))+D[12]+1700485571&4294967295,v=I+(E<<6&4294967295|E>>>26),E=P+(I^(v|~A))+D[3]+2399980690&4294967295,P=v+(E<<10&4294967295|E>>>22),E=A+(v^(P|~I))+D[10]+4293915773&4294967295,A=P+(E<<15&4294967295|E>>>17),E=I+(P^(A|~v))+D[1]+2240044497&4294967295,I=A+(E<<21&4294967295|E>>>11),E=v+(A^(I|~P))+D[8]+1873313359&4294967295,v=I+(E<<6&4294967295|E>>>26),E=P+(I^(v|~A))+D[15]+4264355552&4294967295,P=v+(E<<10&4294967295|E>>>22),E=A+(v^(P|~I))+D[6]+2734768916&4294967295,A=P+(E<<15&4294967295|E>>>17),E=I+(P^(A|~v))+D[13]+1309151649&4294967295,I=A+(E<<21&4294967295|E>>>11),E=v+(A^(I|~P))+D[4]+4149444226&4294967295,v=I+(E<<6&4294967295|E>>>26),E=P+(I^(v|~A))+D[11]+3174756917&4294967295,P=v+(E<<10&4294967295|E>>>22),E=A+(v^(P|~I))+D[2]+718787259&4294967295,A=P+(E<<15&4294967295|E>>>17),E=I+(P^(A|~v))+D[9]+3951481745&4294967295,b.g[0]=b.g[0]+v&4294967295,b.g[1]=b.g[1]+(A+(E<<21&4294967295|E>>>11))&4294967295,b.g[2]=b.g[2]+A&4294967295,b.g[3]=b.g[3]+P&4294967295}r.prototype.u=function(b,v){v===void 0&&(v=b.length);for(var I=v-this.blockSize,D=this.B,A=this.h,P=0;P<v;){if(A==0)for(;P<=I;)i(this,b,P),P+=this.blockSize;if(typeof b=="string"){for(;P<v;)if(D[A++]=b.charCodeAt(P++),A==this.blockSize){i(this,D),A=0;break}}else for(;P<v;)if(D[A++]=b[P++],A==this.blockSize){i(this,D),A=0;break}}this.h=A,this.o+=v},r.prototype.v=function(){var b=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);b[0]=128;for(var v=1;v<b.length-8;++v)b[v]=0;var I=8*this.o;for(v=b.length-8;v<b.length;++v)b[v]=I&255,I/=256;for(this.u(b),b=Array(16),v=I=0;4>v;++v)for(var D=0;32>D;D+=8)b[I++]=this.g[v]>>>D&255;return b};function s(b,v){var I=a;return Object.prototype.hasOwnProperty.call(I,b)?I[b]:I[b]=v(b)}function o(b,v){this.h=v;for(var I=[],D=!0,A=b.length-1;0<=A;A--){var P=b[A]|0;D&&P==v||(I[A]=P,D=!1)}this.g=I}var a={};function c(b){return-128<=b&&128>b?s(b,function(v){return new o([v|0],0>v?-1:0)}):new o([b|0],0>b?-1:0)}function l(b){if(isNaN(b)||!isFinite(b))return h;if(0>b)return R(l(-b));for(var v=[],I=1,D=0;b>=I;D++)v[D]=b/I|0,I*=4294967296;return new o(v,0)}function d(b,v){if(b.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(b.charAt(0)=="-")return R(d(b.substring(1),v));if(0<=b.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=l(Math.pow(v,8)),D=h,A=0;A<b.length;A+=8){var P=Math.min(8,b.length-A),E=parseInt(b.substring(A,A+P),v);8>P?(P=l(Math.pow(v,P)),D=D.j(P).add(l(E))):(D=D.j(I),D=D.add(l(E)))}return D}var h=c(0),p=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(S(this))return-R(this).m();for(var b=0,v=1,I=0;I<this.g.length;I++){var D=this.i(I);b+=(0<=D?D:4294967296+D)*v,v*=4294967296}return b},n.toString=function(b){if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(w(this))return"0";if(S(this))return"-"+R(this).toString(b);for(var v=l(Math.pow(b,6)),I=this,D="";;){var A=J(I,v).g;I=L(I,A.j(v));var P=((0<I.g.length?I.g[0]:I.h)>>>0).toString(b);if(I=A,w(I))return P+D;for(;6>P.length;)P="0"+P;D=P+D}},n.i=function(b){return 0>b?0:b<this.g.length?this.g[b]:this.h};function w(b){if(b.h!=0)return!1;for(var v=0;v<b.g.length;v++)if(b.g[v]!=0)return!1;return!0}function S(b){return b.h==-1}n.l=function(b){return b=L(this,b),S(b)?-1:w(b)?0:1};function R(b){for(var v=b.g.length,I=[],D=0;D<v;D++)I[D]=~b.g[D];return new o(I,~b.h).add(p)}n.abs=function(){return S(this)?R(this):this},n.add=function(b){for(var v=Math.max(this.g.length,b.g.length),I=[],D=0,A=0;A<=v;A++){var P=D+(this.i(A)&65535)+(b.i(A)&65535),E=(P>>>16)+(this.i(A)>>>16)+(b.i(A)>>>16);D=E>>>16,P&=65535,E&=65535,I[A]=E<<16|P}return new o(I,I[I.length-1]&-2147483648?-1:0)};function L(b,v){return b.add(R(v))}n.j=function(b){if(w(this)||w(b))return h;if(S(this))return S(b)?R(this).j(R(b)):R(R(this).j(b));if(S(b))return R(this.j(R(b)));if(0>this.l(_)&&0>b.l(_))return l(this.m()*b.m());for(var v=this.g.length+b.g.length,I=[],D=0;D<2*v;D++)I[D]=0;for(D=0;D<this.g.length;D++)for(var A=0;A<b.g.length;A++){var P=this.i(D)>>>16,E=this.i(D)&65535,Ri=b.i(A)>>>16,au=b.i(A)&65535;I[2*D+2*A]+=E*au,K(I,2*D+2*A),I[2*D+2*A+1]+=P*au,K(I,2*D+2*A+1),I[2*D+2*A+1]+=E*Ri,K(I,2*D+2*A+1),I[2*D+2*A+2]+=P*Ri,K(I,2*D+2*A+2)}for(D=0;D<v;D++)I[D]=I[2*D+1]<<16|I[2*D];for(D=v;D<2*v;D++)I[D]=0;return new o(I,0)};function K(b,v){for(;(b[v]&65535)!=b[v];)b[v+1]+=b[v]>>>16,b[v]&=65535,v++}function B(b,v){this.g=b,this.h=v}function J(b,v){if(w(v))throw Error("division by zero");if(w(b))return new B(h,h);if(S(b))return v=J(R(b),v),new B(R(v.g),R(v.h));if(S(v))return v=J(b,R(v)),new B(R(v.g),v.h);if(30<b.g.length){if(S(b)||S(v))throw Error("slowDivide_ only works with positive integers.");for(var I=p,D=v;0>=D.l(b);)I=ce(I),D=ce(D);var A=ee(I,1),P=ee(D,1);for(D=ee(D,2),I=ee(I,2);!w(D);){var E=P.add(D);0>=E.l(b)&&(A=A.add(I),P=E),D=ee(D,1),I=ee(I,1)}return v=L(b,A.j(v)),new B(A,v)}for(A=h;0<=b.l(v);){for(I=Math.max(1,Math.floor(b.m()/v.m())),D=Math.ceil(Math.log(I)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),P=l(I),E=P.j(v);S(E)||0<E.l(b);)I-=D,P=l(I),E=P.j(v);w(P)&&(P=p),A=A.add(P),b=L(b,E)}return new B(A,b)}n.A=function(b){return J(this,b).h},n.and=function(b){for(var v=Math.max(this.g.length,b.g.length),I=[],D=0;D<v;D++)I[D]=this.i(D)&b.i(D);return new o(I,this.h&b.h)},n.or=function(b){for(var v=Math.max(this.g.length,b.g.length),I=[],D=0;D<v;D++)I[D]=this.i(D)|b.i(D);return new o(I,this.h|b.h)},n.xor=function(b){for(var v=Math.max(this.g.length,b.g.length),I=[],D=0;D<v;D++)I[D]=this.i(D)^b.i(D);return new o(I,this.h^b.h)};function ce(b){for(var v=b.g.length+1,I=[],D=0;D<v;D++)I[D]=b.i(D)<<1|b.i(D-1)>>>31;return new o(I,b.h)}function ee(b,v){var I=v>>5;v%=32;for(var D=b.g.length-I,A=[],P=0;P<D;P++)A[P]=0<v?b.i(P+I)>>>v|b.i(P+I+1)<<32-v:b.i(P+I);return new o(A,b.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Wb=A1.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,Ms=A1.Integer=o}).apply(typeof S1<"u"?S1:typeof self<"u"?self:typeof window<"u"?window:{});var bg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},qi={};var Kb,Qb,Kc,Yb,Kd,Cg,Jb,Xb,Zb;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,m){return u==Array.prototype||u==Object.prototype||(u[f]=m.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof bg=="object"&&bg];for(var f=0;f<u.length;++f){var m=u[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=t(this);function i(u,f){if(f)e:{var m=r;u=u.split(".");for(var y=0;y<u.length-1;y++){var x=u[y];if(!(x in m))break e;m=m[x]}u=u[u.length-1],y=m[u],f=f(y),f!=y&&f!=null&&e(m,u,{configurable:!0,writable:!0,value:f})}}function s(u,f){u instanceof String&&(u+="");var m=0,y=!1,x={next:function(){if(!y&&m<u.length){var k=m++;return{value:f(k,u[k]),done:!1}}return y=!0,{done:!0,value:void 0}}};return x[Symbol.iterator]=function(){return x},x}i("Array.prototype.values",function(u){return u||function(){return s(this,function(f,m){return m})}});var o=o||{},a=this||self;function c(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function l(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function d(u,f,m){return u.call.apply(u.bind,arguments)}function h(u,f,m){if(!u)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var x=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(x,y),u.apply(f,x)}}return function(){return u.apply(f,arguments)}}function p(u,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function _(u,f){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),u.apply(this,y)}}function w(u,f){function m(){}m.prototype=f.prototype,u.aa=f.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(y,x,k){for(var $=Array(arguments.length-2),He=2;He<arguments.length;He++)$[He-2]=arguments[He];return f.prototype[x].apply(y,$)}}function S(u){let f=u.length;if(0<f){let m=Array(f);for(let y=0;y<f;y++)m[y]=u[y];return m}return[]}function R(u,f){for(let m=1;m<arguments.length;m++){let y=arguments[m];if(c(y)){let x=u.length||0,k=y.length||0;u.length=x+k;for(let $=0;$<k;$++)u[x+$]=y[$]}else u.push(y)}}class L{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function K(u){return/^[\s\xa0]*$/.test(u)}function B(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function J(u){return J[" "](u),u}J[" "]=function(){};var ce=B().indexOf("Gecko")!=-1&&!(B().toLowerCase().indexOf("webkit")!=-1&&B().indexOf("Edge")==-1)&&!(B().indexOf("Trident")!=-1||B().indexOf("MSIE")!=-1)&&B().indexOf("Edge")==-1;function ee(u,f,m){for(let y in u)f.call(m,u[y],y,u)}function b(u,f){for(let m in u)f.call(void 0,u[m],m,u)}function v(u){let f={};for(let m in u)f[m]=u[m];return f}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(u,f){let m,y;for(let x=1;x<arguments.length;x++){y=arguments[x];for(m in y)u[m]=y[m];for(let k=0;k<I.length;k++)m=I[k],Object.prototype.hasOwnProperty.call(y,m)&&(u[m]=y[m])}}function A(u){var f=1;u=u.split(":");let m=[];for(;0<f&&u.length;)m.push(u.shift()),f--;return u.length&&m.push(u.join(":")),m}function P(u){a.setTimeout(()=>{throw u},0)}function E(){var u=Jy;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class Ri{constructor(){this.h=this.g=null}add(f,m){let y=au.get();y.set(f,m),this.h?this.h.next=y:this.g=y,this.h=y}}var au=new L(()=>new Ej,u=>u.reset());class Ej{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let cu,lu=!1,Jy=new Ri,oR=()=>{let u=a.Promise.resolve(void 0);cu=()=>{u.then(bj)}};var bj=()=>{for(var u;u=E();){try{u.h.call(u.g)}catch(m){P(m)}var f=au;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}lu=!1};function ns(){this.s=this.s,this.C=this.C}ns.prototype.s=!1,ns.prototype.ma=function(){this.s||(this.s=!0,this.N())},ns.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Xt(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}Xt.prototype.h=function(){this.defaultPrevented=!0};var Cj=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return u}();function uu(u,f){if(Xt.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,y=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(ce){e:{try{J(f.nodeName);var x=!0;break e}catch{}x=!1}x||(f=null)}}else m=="mouseover"?f=u.fromElement:m=="mouseout"&&(f=u.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Tj[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&uu.aa.h.call(this)}}w(uu,Xt);var Tj={2:"touch",3:"pen",4:"mouse"};uu.prototype.h=function(){uu.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var du="closure_listenable_"+(1e6*Math.random()|0),Dj=0;function Sj(u,f,m,y,x){this.listener=u,this.proxy=null,this.src=f,this.type=m,this.capture=!!y,this.ha=x,this.key=++Dj,this.da=this.fa=!1}function Ef(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function bf(u){this.src=u,this.g={},this.h=0}bf.prototype.add=function(u,f,m,y,x){var k=u.toString();u=this.g[k],u||(u=this.g[k]=[],this.h++);var $=Zy(u,f,y,x);return-1<$?(f=u[$],m||(f.fa=!1)):(f=new Sj(f,this.src,k,!!y,x),f.fa=m,u.push(f)),f};function Xy(u,f){var m=f.type;if(m in u.g){var y=u.g[m],x=Array.prototype.indexOf.call(y,f,void 0),k;(k=0<=x)&&Array.prototype.splice.call(y,x,1),k&&(Ef(f),u.g[m].length==0&&(delete u.g[m],u.h--))}}function Zy(u,f,m,y){for(var x=0;x<u.length;++x){var k=u[x];if(!k.da&&k.listener==f&&k.capture==!!m&&k.ha==y)return x}return-1}var ev="closure_lm_"+(1e6*Math.random()|0),tv={};function aR(u,f,m,y,x){if(y&&y.once)return lR(u,f,m,y,x);if(Array.isArray(f)){for(var k=0;k<f.length;k++)aR(u,f[k],m,y,x);return null}return m=sv(m),u&&u[du]?u.K(f,m,l(y)?!!y.capture:!!y,x):cR(u,f,m,!1,y,x)}function cR(u,f,m,y,x,k){if(!f)throw Error("Invalid event type");var $=l(x)?!!x.capture:!!x,He=rv(u);if(He||(u[ev]=He=new bf(u)),m=He.add(f,m,y,$,k),m.proxy)return m;if(y=Aj(),m.proxy=y,y.src=u,y.listener=m,u.addEventListener)Cj||(x=$),x===void 0&&(x=!1),u.addEventListener(f.toString(),y,x);else if(u.attachEvent)u.attachEvent(dR(f.toString()),y);else if(u.addListener&&u.removeListener)u.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function Aj(){function u(m){return f.call(u.src,u.listener,m)}let f=Rj;return u}function lR(u,f,m,y,x){if(Array.isArray(f)){for(var k=0;k<f.length;k++)lR(u,f[k],m,y,x);return null}return m=sv(m),u&&u[du]?u.L(f,m,l(y)?!!y.capture:!!y,x):cR(u,f,m,!0,y,x)}function uR(u,f,m,y,x){if(Array.isArray(f))for(var k=0;k<f.length;k++)uR(u,f[k],m,y,x);else y=l(y)?!!y.capture:!!y,m=sv(m),u&&u[du]?(u=u.i,f=String(f).toString(),f in u.g&&(k=u.g[f],m=Zy(k,m,y,x),-1<m&&(Ef(k[m]),Array.prototype.splice.call(k,m,1),k.length==0&&(delete u.g[f],u.h--)))):u&&(u=rv(u))&&(f=u.g[f.toString()],u=-1,f&&(u=Zy(f,m,y,x)),(m=-1<u?f[u]:null)&&nv(m))}function nv(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[du])Xy(f.i,u);else{var m=u.type,y=u.proxy;f.removeEventListener?f.removeEventListener(m,y,u.capture):f.detachEvent?f.detachEvent(dR(m),y):f.addListener&&f.removeListener&&f.removeListener(y),(m=rv(f))?(Xy(m,u),m.h==0&&(m.src=null,f[ev]=null)):Ef(u)}}}function dR(u){return u in tv?tv[u]:tv[u]="on"+u}function Rj(u,f){if(u.da)u=!0;else{f=new uu(f,this);var m=u.listener,y=u.ha||u.src;u.fa&&nv(u),u=m.call(y,f)}return u}function rv(u){return u=u[ev],u instanceof bf?u:null}var iv="__closure_events_fn_"+(1e9*Math.random()>>>0);function sv(u){return typeof u=="function"?u:(u[iv]||(u[iv]=function(f){return u.handleEvent(f)}),u[iv])}function Zt(){ns.call(this),this.i=new bf(this),this.M=this,this.F=null}w(Zt,ns),Zt.prototype[du]=!0,Zt.prototype.removeEventListener=function(u,f,m,y){uR(this,u,f,m,y)};function pn(u,f){var m,y=u.F;if(y)for(m=[];y;y=y.F)m.push(y);if(u=u.M,y=f.type||f,typeof f=="string")f=new Xt(f,u);else if(f instanceof Xt)f.target=f.target||u;else{var x=f;f=new Xt(y,u),D(f,x)}if(x=!0,m)for(var k=m.length-1;0<=k;k--){var $=f.g=m[k];x=Cf($,y,!0,f)&&x}if($=f.g=u,x=Cf($,y,!0,f)&&x,x=Cf($,y,!1,f)&&x,m)for(k=0;k<m.length;k++)$=f.g=m[k],x=Cf($,y,!1,f)&&x}Zt.prototype.N=function(){if(Zt.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var m=u.g[f],y=0;y<m.length;y++)Ef(m[y]);delete u.g[f],u.h--}}this.F=null},Zt.prototype.K=function(u,f,m,y){return this.i.add(String(u),f,!1,m,y)},Zt.prototype.L=function(u,f,m,y){return this.i.add(String(u),f,!0,m,y)};function Cf(u,f,m,y){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var x=!0,k=0;k<f.length;++k){var $=f[k];if($&&!$.da&&$.capture==m){var He=$.listener,Wt=$.ha||$.src;$.fa&&Xy(u.i,$),x=He.call(Wt,y)!==!1&&x}}return x&&!y.defaultPrevented}function hR(u,f,m){if(typeof u=="function")m&&(u=p(u,m));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function fR(u){u.g=hR(()=>{u.g=null,u.i&&(u.i=!1,fR(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class xj extends ns{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:fR(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hu(u){ns.call(this),this.h=u,this.g={}}w(hu,ns);var pR=[];function mR(u){ee(u.g,function(f,m){this.g.hasOwnProperty(m)&&nv(f)},u),u.g={}}hu.prototype.N=function(){hu.aa.N.call(this),mR(this)},hu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ov=a.JSON.stringify,Nj=a.JSON.parse,Pj=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function av(){}av.prototype.h=null;function gR(u){return u.h||(u.h=u.i())}function _R(){}var fu={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function cv(){Xt.call(this,"d")}w(cv,Xt);function lv(){Xt.call(this,"c")}w(lv,Xt);var uo={},yR=null;function Tf(){return yR=yR||new Zt}uo.La="serverreachability";function vR(u){Xt.call(this,uo.La,u)}w(vR,Xt);function pu(u){let f=Tf();pn(f,new vR(f))}uo.STAT_EVENT="statevent";function wR(u,f){Xt.call(this,uo.STAT_EVENT,u),this.stat=f}w(wR,Xt);function mn(u){let f=Tf();pn(f,new wR(f,u))}uo.Ma="timingevent";function IR(u,f){Xt.call(this,uo.Ma,u),this.size=f}w(IR,Xt);function mu(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function gu(){this.g=!0}gu.prototype.xa=function(){this.g=!1};function Mj(u,f,m,y,x,k){u.info(function(){if(u.g)if(k)for(var $="",He=k.split("&"),Wt=0;Wt<He.length;Wt++){var ke=He[Wt].split("=");if(1<ke.length){var en=ke[0];ke=ke[1];var tn=en.split("_");$=2<=tn.length&&tn[1]=="type"?$+(en+"="+ke+"&"):$+(en+"=redacted&")}}else $=null;else $=k;return"XMLHTTP REQ ("+y+") [attempt "+x+"]: "+f+`
`+m+`
`+$})}function kj(u,f,m,y,x,k,$){u.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+x+"]: "+f+`
`+m+`
`+k+" "+$})}function Ua(u,f,m,y){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+Fj(u,m)+(y?" "+y:"")})}function Oj(u,f){u.info(function(){return"TIMEOUT: "+f})}gu.prototype.info=function(){};function Fj(u,f){if(!u.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var y=m[u];if(!(2>y.length)){var x=y[1];if(Array.isArray(x)&&!(1>x.length)){var k=x[0];if(k!="noop"&&k!="stop"&&k!="close")for(var $=1;$<x.length;$++)x[$]=""}}}}return ov(m)}catch{return f}}var Df={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ER={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},uv;function Sf(){}w(Sf,av),Sf.prototype.g=function(){return new XMLHttpRequest},Sf.prototype.i=function(){return{}},uv=new Sf;function rs(u,f,m,y){this.j=u,this.i=f,this.l=m,this.R=y||1,this.U=new hu(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new bR}function bR(){this.i=null,this.g="",this.h=!1}var CR={},dv={};function hv(u,f,m){u.L=1,u.v=Nf(xi(f)),u.m=m,u.P=!0,TR(u,null)}function TR(u,f){u.F=Date.now(),Af(u),u.A=xi(u.v);var m=u.A,y=u.R;Array.isArray(y)||(y=[String(y)]),UR(m.i,"t",y),u.C=0,m=u.j.J,u.h=new bR,u.g=rx(u.j,m?f:null,!u.m),0<u.O&&(u.M=new xj(p(u.Y,u,u.g),u.O)),f=u.U,m=u.g,y=u.ca;var x="readystatechange";Array.isArray(x)||(x&&(pR[0]=x.toString()),x=pR);for(var k=0;k<x.length;k++){var $=aR(m,x[k],y||f.handleEvent,!1,f.h||f);if(!$)break;f.g[$.key]=$}f=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),pu(),Mj(u.i,u.u,u.A,u.l,u.R,u.m)}rs.prototype.ca=function(u){u=u.target;let f=this.M;f&&Ni(u)==3?f.j():this.Y(u)},rs.prototype.Y=function(u){try{if(u==this.g)e:{let tn=Ni(this.g);var f=this.g.Ba();let $a=this.g.Z();if(!(3>tn)&&(tn!=3||this.g&&(this.h.h||this.g.oa()||GR(this.g)))){this.J||tn!=4||f==7||(f==8||0>=$a?pu(3):pu(2)),fv(this);var m=this.g.Z();this.X=m;t:if(DR(this)){var y=GR(this.g);u="";var x=y.length,k=Ni(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ho(this),_u(this);var $="";break t}this.h.i=new a.TextDecoder}for(f=0;f<x;f++)this.h.h=!0,u+=this.h.i.decode(y[f],{stream:!(k&&f==x-1)});y.length=0,this.h.g+=u,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=m==200,kj(this.i,this.u,this.A,this.l,this.R,tn,m),this.o){if(this.T&&!this.K){t:{if(this.g){var He,Wt=this.g;if((He=Wt.g?Wt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(He)){var ke=He;break t}}ke=null}if(m=ke)Ua(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,pv(this,m);else{this.o=!1,this.s=3,mn(12),ho(this),_u(this);break e}}if(this.P){m=!0;let wr;for(;!this.J&&this.C<$.length;)if(wr=Lj(this,$),wr==dv){tn==4&&(this.s=4,mn(14),m=!1),Ua(this.i,this.l,null,"[Incomplete Response]");break}else if(wr==CR){this.s=4,mn(15),Ua(this.i,this.l,$,"[Invalid Chunk]"),m=!1;break}else Ua(this.i,this.l,wr,null),pv(this,wr);if(DR(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tn!=4||$.length!=0||this.h.h||(this.s=1,mn(16),m=!1),this.o=this.o&&m,!m)Ua(this.i,this.l,$,"[Invalid Chunked Response]"),ho(this),_u(this);else if(0<$.length&&!this.W){this.W=!0;var en=this.j;en.g==this&&en.ba&&!en.M&&(en.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),wv(en),en.M=!0,mn(11))}}else Ua(this.i,this.l,$,null),pv(this,$);tn==4&&ho(this),this.o&&!this.J&&(tn==4?ZR(this.j,this):(this.o=!1,Af(this)))}else e$(this.g),m==400&&0<$.indexOf("Unknown SID")?(this.s=3,mn(12)):(this.s=0,mn(13)),ho(this),_u(this)}}}catch{}finally{}};function DR(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Lj(u,f){var m=u.C,y=f.indexOf(`
`,m);return y==-1?dv:(m=Number(f.substring(m,y)),isNaN(m)?CR:(y+=1,y+m>f.length?dv:(f=f.slice(y,y+m),u.C=y+m,f)))}rs.prototype.cancel=function(){this.J=!0,ho(this)};function Af(u){u.S=Date.now()+u.I,SR(u,u.I)}function SR(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=mu(p(u.ba,u),f)}function fv(u){u.B&&(a.clearTimeout(u.B),u.B=null)}rs.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(Oj(this.i,this.A),this.L!=2&&(pu(),mn(17)),ho(this),this.s=2,_u(this)):SR(this,this.S-u)};function _u(u){u.j.G==0||u.J||ZR(u.j,u)}function ho(u){fv(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,mR(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function pv(u,f){try{var m=u.j;if(m.G!=0&&(m.g==u||mv(m.h,u))){if(!u.K&&mv(m.h,u)&&m.G==3){try{var y=m.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var x=y;if(x[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)Ff(m),kf(m);else break e;vv(m),mn(18)}}else m.za=x[1],0<m.za-m.T&&37500>x[2]&&m.F&&m.v==0&&!m.C&&(m.C=mu(p(m.Za,m),6e3));if(1>=xR(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else po(m,11)}else if((u.K||m.g==u)&&Ff(m),!K(f))for(x=m.Da.g.parse(f),f=0;f<x.length;f++){let ke=x[f];if(m.T=ke[0],ke=ke[1],m.G==2)if(ke[0]=="c"){m.K=ke[1],m.ia=ke[2];let en=ke[3];en!=null&&(m.la=en,m.j.info("VER="+m.la));let tn=ke[4];tn!=null&&(m.Aa=tn,m.j.info("SVER="+m.Aa));let $a=ke[5];$a!=null&&typeof $a=="number"&&0<$a&&(y=1.5*$a,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;let wr=u.g;if(wr){let Vf=wr.g?wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vf){var k=y.h;k.g||Vf.indexOf("spdy")==-1&&Vf.indexOf("quic")==-1&&Vf.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(gv(k,k.h),k.h=null))}if(y.D){let Iv=wr.g?wr.g.getResponseHeader("X-HTTP-Session-Id"):null;Iv&&(y.ya=Iv,Xe(y.I,y.D,Iv))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var $=u;if(y.qa=nx(y,y.J?y.ia:null,y.W),$.K){NR(y.h,$);var He=$,Wt=y.L;Wt&&(He.I=Wt),He.B&&(fv(He),Af(He)),y.g=$}else JR(y);0<m.i.length&&Of(m)}else ke[0]!="stop"&&ke[0]!="close"||po(m,7);else m.G==3&&(ke[0]=="stop"||ke[0]=="close"?ke[0]=="stop"?po(m,7):yv(m):ke[0]!="noop"&&m.l&&m.l.ta(ke),m.v=0)}}pu(4)}catch{}}var Vj=class{constructor(u,f){this.g=u,this.map=f}};function AR(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function RR(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function xR(u){return u.h?1:u.g?u.g.size:0}function mv(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function gv(u,f){u.g?u.g.add(f):u.h=f}function NR(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}AR.prototype.cancel=function(){if(this.i=PR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function PR(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let m of u.g.values())f=f.concat(m.D);return f}return S(u.i)}function Uj(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var f=[],m=u.length,y=0;y<m;y++)f.push(u[y]);return f}f=[],m=0;for(y in u)f[m++]=u[y];return f}function Bj(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var f=[];u=u.length;for(var m=0;m<u;m++)f.push(m);return f}f=[],m=0;for(let y in u)f[m++]=y;return f}}}function MR(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var m=Bj(u),y=Uj(u),x=y.length,k=0;k<x;k++)f.call(void 0,y[k],m&&m[k],u)}var kR=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jj(u,f){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var y=u[m].indexOf("="),x=null;if(0<=y){var k=u[m].substring(0,y);x=u[m].substring(y+1)}else k=u[m];f(k,x?decodeURIComponent(x.replace(/\+/g," ")):"")}}}function fo(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof fo){this.h=u.h,Rf(this,u.j),this.o=u.o,this.g=u.g,xf(this,u.s),this.l=u.l;var f=u.i,m=new wu;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),OR(this,m),this.m=u.m}else u&&(f=String(u).match(kR))?(this.h=!1,Rf(this,f[1]||"",!0),this.o=yu(f[2]||""),this.g=yu(f[3]||"",!0),xf(this,f[4]),this.l=yu(f[5]||"",!0),OR(this,f[6]||"",!0),this.m=yu(f[7]||"")):(this.h=!1,this.i=new wu(null,this.h))}fo.prototype.toString=function(){var u=[],f=this.j;f&&u.push(vu(f,FR,!0),":");var m=this.g;return(m||f=="file")&&(u.push("//"),(f=this.o)&&u.push(vu(f,FR,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(vu(m,m.charAt(0)=="/"?qj:Hj,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",vu(m,Gj)),u.join("")};function xi(u){return new fo(u)}function Rf(u,f,m){u.j=m?yu(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function xf(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function OR(u,f,m){f instanceof wu?(u.i=f,Wj(u.i,u.h)):(m||(f=vu(f,zj)),u.i=new wu(f,u.h))}function Xe(u,f,m){u.i.set(f,m)}function Nf(u){return Xe(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function yu(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function vu(u,f,m){return typeof u=="string"?(u=encodeURI(u).replace(f,$j),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function $j(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var FR=/[#\/\?@]/g,Hj=/[#\?:]/g,qj=/[#\?]/g,zj=/[#\?@]/g,Gj=/#/g;function wu(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function is(u){u.g||(u.g=new Map,u.h=0,u.i&&jj(u.i,function(f,m){u.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=wu.prototype,n.add=function(u,f){is(this),this.i=null,u=Ba(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(f),this.h+=1,this};function LR(u,f){is(u),f=Ba(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function VR(u,f){return is(u),f=Ba(u,f),u.g.has(f)}n.forEach=function(u,f){is(this),this.g.forEach(function(m,y){m.forEach(function(x){u.call(f,x,y,this)},this)},this)},n.na=function(){is(this);let u=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let y=0;y<f.length;y++){let x=u[y];for(let k=0;k<x.length;k++)m.push(f[y])}return m},n.V=function(u){is(this);let f=[];if(typeof u=="string")VR(this,u)&&(f=f.concat(this.g.get(Ba(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)f=f.concat(u[m])}return f},n.set=function(u,f){return is(this),this.i=null,u=Ba(this,u),VR(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function UR(u,f,m){LR(u,f),0<m.length&&(u.i=null,u.g.set(Ba(u,f),S(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var y=f[m];let k=encodeURIComponent(String(y)),$=this.V(y);for(y=0;y<$.length;y++){var x=k;$[y]!==""&&(x+="="+encodeURIComponent(String($[y]))),u.push(x)}}return this.i=u.join("&")};function Ba(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function Wj(u,f){f&&!u.j&&(is(u),u.i=null,u.g.forEach(function(m,y){var x=y.toLowerCase();y!=x&&(LR(this,y),UR(this,x,m))},u)),u.j=f}function Kj(u,f){let m=new gu;if(a.Image){let y=new Image;y.onload=_(ss,m,"TestLoadImage: loaded",!0,f,y),y.onerror=_(ss,m,"TestLoadImage: error",!1,f,y),y.onabort=_(ss,m,"TestLoadImage: abort",!1,f,y),y.ontimeout=_(ss,m,"TestLoadImage: timeout",!1,f,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=u}else f(!1)}function Qj(u,f){let m=new gu,y=new AbortController,x=setTimeout(()=>{y.abort(),ss(m,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:y.signal}).then(k=>{clearTimeout(x),k.ok?ss(m,"TestPingServer: ok",!0,f):ss(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(x),ss(m,"TestPingServer: error",!1,f)})}function ss(u,f,m,y,x){try{x&&(x.onload=null,x.onerror=null,x.onabort=null,x.ontimeout=null),y(m)}catch{}}function Yj(){this.g=new Pj}function Jj(u,f,m){let y=m||"";try{MR(u,function(x,k){let $=x;l(x)&&($=ov(x)),f.push(y+k+"="+encodeURIComponent($))})}catch(x){throw f.push(y+"type="+encodeURIComponent("_badmap")),x}}function Iu(u){this.l=u.Ub||null,this.j=u.eb||!1}w(Iu,av),Iu.prototype.g=function(){return new Pf(this.l,this.j)},Iu.prototype.i=function(u){return function(){return u}}({});function Pf(u,f){Zt.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Pf,Zt),n=Pf.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,bu(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Eu(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,bu(this)),this.g&&(this.readyState=3,bu(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;BR(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function BR(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?Eu(this):bu(this),this.readyState==3&&BR(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Eu(this))},n.Qa=function(u){this.g&&(this.response=u,Eu(this))},n.ga=function(){this.g&&Eu(this)};function Eu(u){u.readyState=4,u.l=null,u.j=null,u.v=null,bu(u)}n.setRequestHeader=function(u,f){this.u.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=f.next();return u.join(`\r
`)};function bu(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Pf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function jR(u){let f="";return ee(u,function(m,y){f+=y,f+=":",f+=m,f+=`\r
`}),f}function _v(u,f,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=jR(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):Xe(u,f,m))}function ht(u){Zt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(ht,Zt);var Xj=/^https?$/i,Zj=["POST","PUT"];n=ht.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,f,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():uv.g(),this.v=this.o?gR(this.o):gR(uv),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(k){$R(this,k);return}if(u=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var x in y)m.set(x,y[x]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let k of y.keys())m.set(k,y.get(k));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(k=>k.toLowerCase()=="content-type"),x=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Zj,f,void 0))||y||x||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[k,$]of m)this.g.setRequestHeader(k,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zR(this),this.u=!0,this.g.send(u),this.u=!1}catch(k){$R(this,k)}};function $R(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,HR(u),Mf(u)}function HR(u){u.A||(u.A=!0,pn(u,"complete"),pn(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,pn(this,"complete"),pn(this,"abort"),Mf(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mf(this,!0)),ht.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?qR(this):this.bb())},n.bb=function(){qR(this)};function qR(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Ni(u)!=4||u.Z()!=2)){if(u.u&&Ni(u)==4)hR(u.Ea,0,u);else if(pn(u,"readystatechange"),Ni(u)==4){u.h=!1;try{let $=u.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var y;if(y=$===0){var x=String(u.D).match(kR)[1]||null;!x&&a.self&&a.self.location&&(x=a.self.location.protocol.slice(0,-1)),y=!Xj.test(x?x.toLowerCase():"")}m=y}if(m)pn(u,"complete"),pn(u,"success");else{u.m=6;try{var k=2<Ni(u)?u.g.statusText:""}catch{k=""}u.l=k+" ["+u.Z()+"]",HR(u)}}finally{Mf(u)}}}}function Mf(u,f){if(u.g){zR(u);let m=u.g,y=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||pn(u,"ready");try{m.onreadystatechange=y}catch{}}}function zR(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Ni(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Ni(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),Nj(f)}};function GR(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function e$(u){let f={};u=(u.g&&2<=Ni(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<u.length;y++){if(K(u[y]))continue;var m=A(u[y]);let x=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let k=f[x]||[];f[x]=k,k.push(m)}b(f,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Cu(u,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||f}function WR(u){this.Aa=0,this.i=[],this.j=new gu,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Cu("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Cu("baseRetryDelayMs",5e3,u),this.cb=Cu("retryDelaySeedMs",1e4,u),this.Wa=Cu("forwardChannelMaxRetries",2,u),this.wa=Cu("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new AR(u&&u.concurrentRequestLimit),this.Da=new Yj,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=WR.prototype,n.la=8,n.G=1,n.connect=function(u,f,m,y){mn(0),this.W=u,this.H=f||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=nx(this,null,this.W),Of(this)};function yv(u){if(KR(u),u.G==3){var f=u.U++,m=xi(u.I);if(Xe(m,"SID",u.K),Xe(m,"RID",f),Xe(m,"TYPE","terminate"),Tu(u,m),f=new rs(u,u.j,f),f.L=2,f.v=Nf(xi(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=rx(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Af(f)}tx(u)}function kf(u){u.g&&(wv(u),u.g.cancel(),u.g=null)}function KR(u){kf(u),u.u&&(a.clearTimeout(u.u),u.u=null),Ff(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Of(u){if(!RR(u.h)&&!u.s){u.s=!0;var f=u.Ga;cu||oR(),lu||(cu(),lu=!0),Jy.add(f,u),u.B=0}}function t$(u,f){return xR(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=mu(p(u.Ga,u,f),ex(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let x=new rs(this,this.j,u),k=this.o;if(this.S&&(k?(k=v(k),D(k,this.S)):k=this.S),this.m!==null||this.O||(x.H=k,k=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=YR(this,x,f),m=xi(this.I),Xe(m,"RID",u),Xe(m,"CVER",22),this.D&&Xe(m,"X-HTTP-Session-Id",this.D),Tu(this,m),k&&(this.O?f="headers="+encodeURIComponent(String(jR(k)))+"&"+f:this.m&&_v(m,this.m,k)),gv(this.h,x),this.Ua&&Xe(m,"TYPE","init"),this.P?(Xe(m,"$req",f),Xe(m,"SID","null"),x.T=!0,hv(x,m,null)):hv(x,m,f),this.G=2}}else this.G==3&&(u?QR(this,u):this.i.length==0||RR(this.h)||QR(this))};function QR(u,f){var m;f?m=f.l:m=u.U++;let y=xi(u.I);Xe(y,"SID",u.K),Xe(y,"RID",m),Xe(y,"AID",u.T),Tu(u,y),u.m&&u.o&&_v(y,u.m,u.o),m=new rs(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),f&&(u.i=f.D.concat(u.i)),f=YR(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),gv(u.h,m),hv(m,y,f)}function Tu(u,f){u.H&&ee(u.H,function(m,y){Xe(f,y,m)}),u.l&&MR({},function(m,y){Xe(f,y,m)})}function YR(u,f,m){m=Math.min(u.i.length,m);var y=u.l?p(u.l.Na,u.l,u):null;e:{var x=u.i;let k=-1;for(;;){let $=["count="+m];k==-1?0<m?(k=x[0].g,$.push("ofs="+k)):k=0:$.push("ofs="+k);let He=!0;for(let Wt=0;Wt<m;Wt++){let ke=x[Wt].g,en=x[Wt].map;if(ke-=k,0>ke)k=Math.max(0,x[Wt].g-100),He=!1;else try{Jj(en,$,"req"+ke+"_")}catch{y&&y(en)}}if(He){y=$.join("&");break e}}}return u=u.i.splice(0,m),f.D=u,y}function JR(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;cu||oR(),lu||(cu(),lu=!0),Jy.add(f,u),u.v=0}}function vv(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=mu(p(u.Fa,u),ex(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,XR(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=mu(p(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,mn(10),kf(this),XR(this))};function wv(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function XR(u){u.g=new rs(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=xi(u.qa);Xe(f,"RID","rpc"),Xe(f,"SID",u.K),Xe(f,"AID",u.T),Xe(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&Xe(f,"TO",u.ja),Xe(f,"TYPE","xmlhttp"),Tu(u,f),u.m&&u.o&&_v(f,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=Nf(xi(f)),m.m=null,m.P=!0,TR(m,u)}n.Za=function(){this.C!=null&&(this.C=null,kf(this),vv(this),mn(19))};function Ff(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function ZR(u,f){var m=null;if(u.g==f){Ff(u),wv(u),u.g=null;var y=2}else if(mv(u.h,f))m=f.D,NR(u.h,f),y=1;else return;if(u.G!=0){if(f.o)if(y==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var x=u.B;y=Tf(),pn(y,new IR(y,m)),Of(u)}else JR(u);else if(x=f.s,x==3||x==0&&0<f.X||!(y==1&&t$(u,f)||y==2&&vv(u)))switch(m&&0<m.length&&(f=u.h,f.i=f.i.concat(m)),x){case 1:po(u,5);break;case 4:po(u,10);break;case 3:po(u,6);break;default:po(u,2)}}}function ex(u,f){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*f}function po(u,f){if(u.j.info("Error code "+f),f==2){var m=p(u.fb,u),y=u.Xa;let x=!y;y=new fo(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Rf(y,"https"),Nf(y),x?Kj(y.toString(),m):Qj(y.toString(),m)}else mn(2);u.G=0,u.l&&u.l.sa(f),tx(u),KR(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),mn(2)):(this.j.info("Failed to ping google.com"),mn(1))};function tx(u){if(u.G=0,u.ka=[],u.l){let f=PR(u.h);(f.length!=0||u.i.length!=0)&&(R(u.ka,f),R(u.ka,u.i),u.h.i.length=0,S(u.i),u.i.length=0),u.l.ra()}}function nx(u,f,m){var y=m instanceof fo?xi(m):new fo(m);if(y.g!="")f&&(y.g=f+"."+y.g),xf(y,y.s);else{var x=a.location;y=x.protocol,f=f?f+"."+x.hostname:x.hostname,x=+x.port;var k=new fo(null);y&&Rf(k,y),f&&(k.g=f),x&&xf(k,x),m&&(k.l=m),y=k}return m=u.D,f=u.ya,m&&f&&Xe(y,m,f),Xe(y,"VER",u.la),Tu(u,y),y}function rx(u,f,m){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new ht(new Iu({eb:m})):new ht(u.pa),f.Ha(u.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ix(){}n=ix.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Lf(){}Lf.prototype.g=function(u,f){return new Vn(u,f)};function Vn(u,f){Zt.call(this),this.g=new WR(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!K(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!K(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new ja(this)}w(Vn,Zt),Vn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Vn.prototype.close=function(){yv(this.g)},Vn.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=ov(u),u=m);f.i.push(new Vj(f.Ya++,u)),f.G==3&&Of(f)},Vn.prototype.N=function(){this.g.l=null,delete this.j,yv(this.g),delete this.g,Vn.aa.N.call(this)};function sx(u){cv.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(let m in f){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}w(sx,cv);function ox(){lv.call(this),this.status=1}w(ox,lv);function ja(u){this.g=u}w(ja,ix),ja.prototype.ua=function(){pn(this.g,"a")},ja.prototype.ta=function(u){pn(this.g,new sx(u))},ja.prototype.sa=function(u){pn(this.g,new ox)},ja.prototype.ra=function(){pn(this.g,"b")},Lf.prototype.createWebChannel=Lf.prototype.g,Vn.prototype.send=Vn.prototype.o,Vn.prototype.open=Vn.prototype.m,Vn.prototype.close=Vn.prototype.close,Zb=qi.createWebChannelTransport=function(){return new Lf},Xb=qi.getStatEventTarget=function(){return Tf()},Jb=qi.Event=uo,Cg=qi.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Df.NO_ERROR=0,Df.TIMEOUT=8,Df.HTTP_ERROR=6,Kd=qi.ErrorCode=Df,ER.COMPLETE="complete",Yb=qi.EventType=ER,_R.EventType=fu,fu.OPEN="a",fu.CLOSE="b",fu.ERROR="c",fu.MESSAGE="d",Zt.prototype.listen=Zt.prototype.K,Kc=qi.WebChannel=_R,Qb=qi.FetchXmlHttpFactory=Iu,ht.prototype.listenOnce=ht.prototype.L,ht.prototype.getLastError=ht.prototype.Ka,ht.prototype.getLastErrorCode=ht.prototype.Ba,ht.prototype.getStatus=ht.prototype.Z,ht.prototype.getResponseJson=ht.prototype.Oa,ht.prototype.getResponseText=ht.prototype.oa,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Ha,Kb=qi.XhrIo=ht}).apply(typeof bg<"u"?bg:typeof self<"u"?self:typeof window<"u"?window:{});var R1="@firebase/firestore";var Pt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Pt.UNAUTHENTICATED=new Pt(null),Pt.GOOGLE_CREDENTIALS=new Pt("google-credentials-uid"),Pt.FIRST_PARTY=new Pt("first-party-uid"),Pt.MOCK_USER=new Pt("mock-user");var Cl="10.12.1";var js=new On("@firebase/firestore");function Zc(){return js.logLevel}function xF(n){js.setLogLevel(n)}function V(n,...e){if(js.logLevel<=ye.DEBUG){let t=e.map(sD);js.debug(`Firestore (${Cl}): ${n}`,...t)}}function It(n,...e){if(js.logLevel<=ye.ERROR){let t=e.map(sD);js.error(`Firestore (${Cl}): ${n}`,...t)}}function fr(n,...e){if(js.logLevel<=ye.WARN){let t=e.map(sD);js.warn(`Firestore (${Cl}): ${n}`,...t)}}function sD(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function X(n="Unexpected state"){let e=`FIRESTORE (${Cl}) INTERNAL ASSERTION FAILED: `+n;throw It(e),new Error(e)}function ne(n,e){n||X()}function NF(n,e){n||X()}function z(n,e){return n}var O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},F=class extends ft{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Et=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Og=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},iC=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Pt.UNAUTHENTICATED))}shutdown(){}},sC=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},oC=class{constructor(e){this.t=e,this.currentUser=Pt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Et;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Et,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Et)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ne(typeof r.accessToken=="string"),new Og(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return ne(e===null||typeof e=="string"),new Pt(e)}},aC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Pt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},cC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new aC(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Pt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},lC=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},uC=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,V("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ne(typeof t.token=="string"),this.R=t.token,new lC(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function CK(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Fg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=CK(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function pe(n,e){return n<e?-1:n>e?1:0}function al(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function PF(n){return n+"\0"}var lt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new F(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?pe(this.nanoseconds,e.nanoseconds):pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var ie=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new lt(0,0))}static max(){return new n(new lt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Lg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&X(),r===void 0?r=e.length-t:r>e.length-t&&X(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Ne=class n extends Lg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new F(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},TK=/^[_a-zA-Z][_a-zA-Z0-9]*$/,bt=class n extends Lg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return TK.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new F(O.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new F(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new F(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new F(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var W=class n{constructor(e){this.path=e}static fromPath(e){return new n(Ne.fromString(e))}static fromName(e){return new n(Ne.fromString(e).popFirst(5))}static empty(){return new n(Ne.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ne.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ne.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Ne(e.slice()))}};var cl=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function dC(n){return n.fields.find(e=>e.kind===2)}function na(n){return n.fields.filter(e=>e.kind!==2)}cl.UNKNOWN_ID=-1;var il=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var oh=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,pr.min())}};function MF(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ie.fromTimestamp(r===1e9?new lt(t+1,0):new lt(t,r));return new pr(i,W.empty(),e)}function kF(n){return new pr(n.readTime,n.key,-1)}var pr=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(ie.min(),W.empty(),-1)}static max(){return new n(ie.max(),W.empty(),-1)}};function oD(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=W.comparator(n.documentKey,e.documentKey),t!==0?t:pe(n.largestBatchId,e.largestBatchId))}var OF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Vg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Js(n){return g(this,null,function*(){if(n.code!==O.FAILED_PRECONDITION||n.message!==OF)throw n;V("LocalStore","Unexpectedly lost primary lease")})}var M=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&X(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var Ug=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Et,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ca(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=aD(r.target.error);this.V.reject(new ca(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new ca(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(V("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new fC(t)}},$s=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(ze())===12.2&&It("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return V("SimpleDb","Removing database:",e),ra(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Es())return!1;if(n.C())return!0;let e=ze(),t=n.S(e),r=0<t&&t<10,i=FF(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return g(this,null,function*(){return this.db||(V("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new ca(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new F(O.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new F(O.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ca(e,o))},i.onupgradeneeded=s=>{V("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{V("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return g(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=Ug.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),M.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(V("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function FF(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var hC=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ra(this.B.delete())}},ca=class extends F{constructor(e,t){super(O.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Xs(n){return n.name==="IndexedDbTransactionError"}var fC=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(V("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(V("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ra(r)}add(e){return V("SimpleDb","ADD",this.store.name,e,e),ra(this.store.add(e))}get(e){return ra(this.store.get(e)).next(t=>(t===void 0&&(t=null),V("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return V("SimpleDb","DELETE",this.store.name,e),ra(this.store.delete(e))}count(){return V("SimpleDb","COUNT",this.store.name),ra(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new M((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new M((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){V("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new M((r,i)=>{t.onerror=s=>{let o=aD(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new M((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new hC(a),l=t(a.primaryKey,a.value,c);if(l instanceof M){let d=l.catch(h=>(c.done(),M.reject(h)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>M.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function ra(n){return new M((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=aD(r.target.error);t(i)}})}var x1=!1;function aD(n){let e=$s.S(ze());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new F("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return x1||(x1=!0,setTimeout(()=>{throw r},0)),r}}return n}var pC=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){V("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{V("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){Xs(t)?V("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield Js(t)}yield this.X(6e4)}))}},mC=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return M.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return V("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(V("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=kF(s);oD(o,r)>0&&(r=o)}),new pr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Kn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Ah(n){return n==null}function ah(n){return n===0&&1/n==-1/0}function LF(n){return typeof n=="number"&&Number.isInteger(n)&&!ah(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function In(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=N1(e)),e=DK(n.get(t),e);return N1(e)}function DK(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function N1(n){return n+""}function ui(n){let e=n.length;if(ne(e>=2),e===2)return ne(n.charAt(0)===""&&n.charAt(1)===""),Ne.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&X(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:X()}s=o+2}return new Ne(r)}var P1=["userId","batchId"];function Rg(n,e){return[n,In(e)]}function VF(n,e,t){return[n,In(e),t]}var SK={},AK=["prefixPath","collectionGroup","readTime","documentId"],RK=["prefixPath","collectionGroup","documentId"],xK=["collectionGroup","readTime","prefixPath","documentId"],NK=["canonicalId","targetId"],PK=["targetId","path"],MK=["path","targetId"],kK=["collectionId","parent"],OK=["indexId","uid"],FK=["uid","sequenceNumber"],LK=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],VK=["indexId","uid","orderedDocumentKey"],UK=["userId","collectionPath","documentId"],BK=["userId","collectionPath","largestBatchId"],jK=["userId","collectionGroup","largestBatchId"],UF=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],$K=[...UF,"documentOverlays"],BF=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],jF=BF,$F=[...jF,"indexConfiguration","indexState","indexEntries"],HK=$F;var ch=class extends Vg{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function qt(n,e){let t=z(n);return $s.F(t._e,e)}function M1(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wa(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function qK(n,e){let t=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function HF(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var et=class n{constructor(e,t){this.comparator=e,this.root=t||hi.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,hi.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,hi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rl(this.root,e,this.comparator,!1)}getReverseIterator(){return new rl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rl(this.root,e,this.comparator,!0)}},rl=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},hi=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw X();let e=this.left.check();if(e!==this.right.check())throw X();return e+(this.isRed()?0:1)}};hi.EMPTY=null,hi.RED=!0,hi.BLACK=!1;hi.EMPTY=new class{constructor(){this.size=0}get key(){throw X()}get value(){throw X()}get color(){throw X()}get left(){throw X()}get right(){throw X()}copy(e,t,r,i,s){return this}insert(e,t,r){return new hi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ge=class n{constructor(e){this.comparator=e,this.data=new et(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Bg(this.data.getIterator())}getIteratorFrom(e){return new Bg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Bg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Qc(n){return n.hasNext()?n.getNext():void 0}var Qn=class n{constructor(e){this.fields=e,e.sort(bt.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ge(bt.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return al(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var jg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function qF(){return typeof atob<"u"}var Ht=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new jg("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ht.EMPTY_BYTE_STRING=new Ht("");var zK=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wi(n){if(ne(!!n),typeof n=="string"){let e=0,t=zK.exec(n);if(ne(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:gt(n.seconds),nanos:gt(n.nanos)}}function gt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Hs(n){return typeof n=="string"?Ht.fromBase64String(n):Ht.fromUint8Array(n)}function N_(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function cD(n){let e=n.mapValue.fields.__previous_value__;return N_(e)?cD(e):e}function lh(n){let e=Wi(n.mapValue.fields.__local_write_time__.timestampValue);return new lt(e.seconds,e.nanos)}var gC=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},qs=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Us={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},xg={nullValue:"NULL_VALUE"};function la(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?N_(n)?4:zF(n)?9007199254740991:10:X()}function mi(n,e){if(n===e)return!0;let t=la(n);if(t!==la(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return lh(n).isEqual(lh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Wi(i.timestampValue),a=Wi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Hs(i.bytesValue).isEqual(Hs(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return gt(i.geoPointValue.latitude)===gt(s.geoPointValue.latitude)&&gt(i.geoPointValue.longitude)===gt(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return gt(i.integerValue)===gt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=gt(i.doubleValue),a=gt(s.doubleValue);return o===a?ah(o)===ah(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return al(n.arrayValue.values||[],e.arrayValue.values||[],mi);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(M1(o)!==M1(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!mi(o[c],a[c])))return!1;return!0}(n,e);default:return X()}}function uh(n,e){return(n.values||[]).find(t=>mi(t,e))!==void 0}function zs(n,e){if(n===e)return 0;let t=la(n),r=la(e);if(t!==r)return pe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return pe(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=gt(s.integerValue||s.doubleValue),c=gt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return k1(n.timestampValue,e.timestampValue);case 4:return k1(lh(n),lh(e));case 5:return pe(n.stringValue,e.stringValue);case 6:return function(s,o){let a=Hs(s),c=Hs(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=pe(a[l],c[l]);if(d!==0)return d}return pe(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=pe(gt(s.latitude),gt(o.latitude));return a!==0?a:pe(gt(s.longitude),gt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){let d=zs(a[l],c[l]);if(d)return d}return pe(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Us.mapValue&&o===Us.mapValue)return 0;if(s===Us.mapValue)return 1;if(o===Us.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let p=pe(c[h],d[h]);if(p!==0)return p;let _=zs(a[c[h]],l[d[h]]);if(_!==0)return _}return pe(c.length,d.length)}(n.mapValue,e.mapValue);default:throw X()}}function k1(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return pe(n,e);let t=Wi(n),r=Wi(e),i=pe(t.seconds,r.seconds);return i!==0?i:pe(t.nanos,r.nanos)}function ll(n){return _C(n)}function _C(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Wi(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Hs(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return W.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=_C(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${_C(t.fields[o])}`;return i+"}"}(n.mapValue):X()}function ua(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function yC(n){return!!n&&"integerValue"in n}function dh(n){return!!n&&"arrayValue"in n}function O1(n){return!!n&&"nullValue"in n}function F1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ng(n){return!!n&&"mapValue"in n}function th(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return wa(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=th(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=th(n.arrayValue.values[t]);return e}return Object.assign({},n)}function zF(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function GK(n){return"nullValue"in n?xg:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ua(qs.empty(),W.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:X()}function WK(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ua(qs.empty(),W.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Us:X()}function L1(n,e){let t=zs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function V1(n,e){let t=zs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var dn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ng(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=th(t)}setAll(e){let t=bt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=th(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Ng(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return mi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ng(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){wa(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(th(this.value))}};function GF(n){let e=[];return wa(n.fields,(t,r)=>{let i=new bt([t]);if(Ng(r)){let s=GF(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Qn(e)}var Mt=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,ie.min(),ie.min(),ie.min(),dn.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,ie.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,ie.min(),ie.min(),dn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ie.min(),ie.min(),dn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var gi=class{constructor(e,t){this.position=e,this.inclusive=t}};function U1(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=W.comparator(W.fromName(o.referenceValue),t.key):r=zs(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function B1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!mi(n.position[t],e.position[t]))return!1;return!0}var da=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function KK(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var $g=class{},Te=class n extends $g{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new IC(e,t,r):t==="array-contains"?new CC(e,r):t==="in"?new Hg(e,r):t==="not-in"?new TC(e,r):t==="array-contains-any"?new DC(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new EC(e,r):new bC(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(zs(t,this.value)):t!==null&&la(this.value)===la(t)&&this.matchesComparison(zs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return X()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ue=class n extends $g{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return ul(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function ul(n){return n.op==="and"}function vC(n){return n.op==="or"}function lD(n){return WF(n)&&ul(n)}function WF(n){for(let e of n.filters)if(e instanceof Ue)return!1;return!0}function wC(n){if(n instanceof Te)return n.field.canonicalString()+n.op.toString()+ll(n.value);if(lD(n))return n.filters.map(e=>wC(e)).join(",");{let e=n.filters.map(t=>wC(t)).join(",");return`${n.op}(${e})`}}function KF(n,e){return n instanceof Te?function(r,i){return i instanceof Te&&r.op===i.op&&r.field.isEqual(i.field)&&mi(r.value,i.value)}(n,e):n instanceof Ue?function(r,i){return i instanceof Ue&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&KF(o,i.filters[a]),!0):!1}(n,e):void X()}function QF(n,e){let t=n.filters.concat(e);return Ue.create(t,n.op)}function YF(n){return n instanceof Te?function(t){return`${t.field.canonicalString()} ${t.op} ${ll(t.value)}`}(n):n instanceof Ue?function(t){return t.op.toString()+" {"+t.getFilters().map(YF).join(" ,")+"}"}(n):"Filter"}var IC=class extends Te{constructor(e,t,r){super(e,t,r),this.key=W.fromName(r.referenceValue)}matches(e){let t=W.comparator(e.key,this.key);return this.matchesComparison(t)}},EC=class extends Te{constructor(e,t){super(e,"in",t),this.keys=JF("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},bC=class extends Te{constructor(e,t){super(e,"not-in",t),this.keys=JF("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function JF(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>W.fromName(r.referenceValue))}var CC=class extends Te{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return dh(t)&&uh(t.arrayValue,this.value)}},Hg=class extends Te{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&uh(this.value.arrayValue,t)}},TC=class extends Te{constructor(e,t){super(e,"not-in",t)}matches(e){if(uh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!uh(this.value.arrayValue,t)}},DC=class extends Te{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!dh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>uh(this.value.arrayValue,r))}};var SC=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function AC(n,e=null,t=[],r=[],i=null,s=null,o=null){return new SC(n,e,t,r,i,s,o)}function ha(n){let e=z(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>wC(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ah(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ll(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ll(r)).join(",")),e.ue=t}return e.ue}function Rh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!KK(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!KF(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!B1(n.startAt,e.startAt)&&B1(n.endAt,e.endAt)}function qg(n){return W.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function zg(n,e){return n.filters.filter(t=>t instanceof Te&&t.field.isEqual(e))}function j1(n,e,t){let r=xg,i=!0;for(let s of zg(n,e)){let o=xg,a=!0;switch(s.op){case"<":case"<=":o=GK(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=xg}L1({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];L1({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function $1(n,e,t){let r=Us,i=!0;for(let s of zg(n,e)){let o=Us,a=!0;switch(s.op){case">=":case">":o=WK(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Us}V1({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];V1({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var kr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function XF(n,e,t,r,i,s,o,a){return new kr(n,e,t,r,i,s,o,a)}function Tl(n){return new kr(n)}function H1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function uD(n){return n.collectionGroup!==null}function sl(n){let e=z(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ge(bt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new da(s,r))}),t.has(bt.keyField().canonicalString())||e.ce.push(new da(bt.keyField(),r))}return e.ce}function En(n){let e=z(n);return e.le||(e.le=ZF(e,sl(n))),e.le}function QK(n){let e=z(n);return e.he||(e.he=ZF(e,n.explicitOrderBy)),e.he}function ZF(n,e){if(n.limitType==="F")return AC(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new da(i.field,s)});let t=n.endAt?new gi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new gi(n.startAt.position,n.startAt.inclusive):null;return AC(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function RC(n,e){let t=n.filters.concat([e]);return new kr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Gg(n,e,t){return new kr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function xh(n,e){return Rh(En(n),En(e))&&n.limitType===e.limitType}function eL(n){return`${ha(En(n))}|lt:${n.limitType}`}function el(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>YF(i)).join(", ")}]`),Ah(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ll(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ll(i)).join(",")),`Target(${r})`}(En(n))}; limitType=${n.limitType})`}function Nh(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):W.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of sl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=U1(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,sl(r),i)||r.endAt&&!function(o,a,c){let l=U1(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,sl(r),i))}(n,e)}function tL(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function nL(n){return(e,t)=>{let r=!1;for(let i of sl(n)){let s=YK(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function YK(n,e,t){let r=n.field.isKeyField()?W.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?zs(c,l):X()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return X()}}var _i=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wa(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return HF(this.inner)}size(){return this.innerSize}};var JK=new et(W.comparator);function Ln(){return JK}var rL=new et(W.comparator);function Zd(...n){let e=rL;for(let t of n)e=e.insert(t.key,t);return e}function iL(n){let e=rL;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function di(){return nh()}function sL(){return nh()}function nh(){return new _i(n=>n.toString(),(n,e)=>n.isEqual(e))}var XK=new et(W.comparator),ZK=new Ge(W.comparator);function ge(...n){let e=ZK;for(let t of n)e=e.add(t);return e}var e7=new Ge(pe);function dD(){return e7}function oL(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ah(e)?"-0":e}}function aL(n){return{integerValue:""+n}}function cL(n,e){return LF(e)?aL(e):oL(n,e)}var dl=class{constructor(){this._=void 0}};function t7(n,e,t){return n instanceof Gs?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&N_(s)&&(s=cD(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Ki?uL(n,e):n instanceof Qi?dL(n,e):function(i,s){let o=lL(i,s),a=q1(o)+q1(i.Pe);return yC(o)&&yC(i.Pe)?aL(a):oL(i.serializer,a)}(n,e)}function n7(n,e,t){return n instanceof Ki?uL(n,e):n instanceof Qi?dL(n,e):t}function lL(n,e){return n instanceof Ws?function(r){return yC(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Gs=class extends dl{},Ki=class extends dl{constructor(e){super(),this.elements=e}};function uL(n,e){let t=hL(e);for(let r of n.elements)t.some(i=>mi(i,r))||t.push(r);return{arrayValue:{values:t}}}var Qi=class extends dl{constructor(e){super(),this.elements=e}};function dL(n,e){let t=hL(e);for(let r of n.elements)t=t.filter(i=>!mi(i,r));return{arrayValue:{values:t}}}var Ws=class extends dl{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function q1(n){return gt(n.integerValue||n.doubleValue)}function hL(n){return dh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var fa=class{constructor(e,t){this.field=e,this.transform=t}};function r7(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Ki&&i instanceof Ki||r instanceof Qi&&i instanceof Qi?al(r.elements,i.elements,mi):r instanceof Ws&&i instanceof Ws?mi(r.Pe,i.Pe):r instanceof Gs&&i instanceof Gs}(n.transform,e.transform)}var xC=class{constructor(e,t){this.version=e,this.transformResults=t}},_t=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Pg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var hl=class{};function fL(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Qs(n.key,_t.none()):new Ks(n.key,n.data,_t.none());{let t=n.data,r=dn.empty(),i=new Ge(bt.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Or(n.key,r,new Qn(i.toArray()),_t.none())}}function i7(n,e,t){n instanceof Ks?function(i,s,o){let a=i.value.clone(),c=G1(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Or?function(i,s,o){if(!Pg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=G1(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(pL(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function rh(n,e,t,r){return n instanceof Ks?function(s,o,a,c){if(!Pg(s.precondition,o))return a;let l=s.value.clone(),d=W1(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof Or?function(s,o,a,c){if(!Pg(s.precondition,o))return a;let l=W1(s.fieldTransforms,c,o),d=o.data;return d.setAll(pL(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return Pg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function s7(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=lL(r.transform,i||null);s!=null&&(t===null&&(t=dn.empty()),t.set(r.field,s))}return t||null}function z1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&al(r,i,(s,o)=>r7(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Ks=class extends hl{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Or=class extends hl{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function pL(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function G1(n,e,t){let r=new Map;ne(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,n7(o,a,t[i]))}return r}function W1(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,t7(s,o,e))}return r}var Qs=class extends hl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},hh=class extends hl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var fh=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&i7(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=rh(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=rh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=sL();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=fL(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(ie.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ge())}isEqual(e){return this.batchId===e.batchId&&al(this.mutations,e.mutations,(t,r)=>z1(t,r))&&al(this.baseMutations,e.baseMutations,(t,r)=>z1(t,r))}},NC=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ne(e.mutations.length===r.length);let i=function(){return XK}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var ph=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var PC=class{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}};var MC=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var xt,xe;function mL(n){switch(n){default:return X();case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0}}function gL(n){if(n===void 0)return It("GRPC error has no .code"),O.UNKNOWN;switch(n){case xt.OK:return O.OK;case xt.CANCELLED:return O.CANCELLED;case xt.UNKNOWN:return O.UNKNOWN;case xt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case xt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case xt.INTERNAL:return O.INTERNAL;case xt.UNAVAILABLE:return O.UNAVAILABLE;case xt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case xt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case xt.NOT_FOUND:return O.NOT_FOUND;case xt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case xt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case xt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case xt.ABORTED:return O.ABORTED;case xt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case xt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case xt.DATA_LOSS:return O.DATA_LOSS;default:return X()}}(xe=xt||(xt={}))[xe.OK=0]="OK",xe[xe.CANCELLED=1]="CANCELLED",xe[xe.UNKNOWN=2]="UNKNOWN",xe[xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xe[xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xe[xe.NOT_FOUND=5]="NOT_FOUND",xe[xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",xe[xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",xe[xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",xe[xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xe[xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xe[xe.ABORTED=10]="ABORTED",xe[xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",xe[xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",xe[xe.INTERNAL=13]="INTERNAL",xe[xe.UNAVAILABLE=14]="UNAVAILABLE",xe[xe.DATA_LOSS=15]="DATA_LOSS";var K1=null;function _L(){return new TextEncoder}var o7=new Ms([4294967295,4294967295],0);function Q1(n){let e=_L().encode(n),t=new Wb;return t.update(e),new Uint8Array(t.digest())}function Y1(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ms([t,r],0),new Ms([i,s],0)]}var kC=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new aa(`Invalid padding: ${t}`);if(r<0)throw new aa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new aa(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new aa(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ms.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Ms.fromNumber(r)));return i.compare(o7)===1&&(i=new Ms([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Q1(e),[r,i]=Y1(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=Q1(e),[r,i]=Y1(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},aa=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var mh=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,gh.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(ie.min(),i,new et(pe),Ln(),ge())}},gh=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ge(),ge(),ge())}};var ol=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Wg=class{constructor(e,t){this.targetId=e,this.me=t}},Kg=class{constructor(e,t,r=Ht.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Qg=class{constructor(){this.fe=0,this.ge=X1(),this.pe=Ht.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=ge(),t=ge(),r=ge();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:X()}}),new gh(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=X1()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ne(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},OC=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ln(),this.qe=J1(),this.Qe=new et(pe)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:X()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(qg(s))if(r===0){let o=new W(s.path);this.Ue(t,o,Mt.newNoDocument(o,ie.min()))}else ne(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}K1?.et(function(d,h,p,_,w){var S,R,L,K,B,J;let ce={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},ee=h.unchangedNames;return ee&&(ce.bloomFilter={applied:w===0,hashCount:(S=ee?.hashCount)!==null&&S!==void 0?S:0,bitmapLength:(K=(L=(R=ee?.bits)===null||R===void 0?void 0:R.bitmap)===null||L===void 0?void 0:L.length)!==null&&K!==void 0?K:0,padding:(J=(B=ee?.bits)===null||B===void 0?void 0:B.padding)!==null&&J!==void 0?J:0,mightContain:b=>{var v;return(v=_?.mightContain(b))!==null&&v!==void 0&&v}}),ce}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=Hs(r).toUint8Array()}catch(c){if(c instanceof jg)return fr("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new kC(o,i,s)}catch(c){return fr(c instanceof aa?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&qg(a.target)){let c=new W(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Mt.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let r=ge();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new mh(e,t,this.Qe,this.ke,r);return this.ke=Ln(),this.qe=J1(),this.Qe=new et(pe),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Qg,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ge(pe),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Qg),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function J1(){return new et(W.comparator)}function X1(){return new et(W.comparator)}var a7={asc:"ASCENDING",desc:"DESCENDING"},c7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},l7={and:"AND",or:"OR"},FC=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function LC(n,e){return n.useProto3Json||Ah(e)?e:{value:e}}function fl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function yL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function u7(n,e){return fl(n,e.toTimestamp())}function Ct(n){return ne(!!n),ie.fromTimestamp(function(t){let r=Wi(t);return new lt(r.seconds,r.nanos)}(n))}function hD(n,e){return VC(n,e).canonicalString()}function VC(n,e){let t=function(i){return new Ne(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function vL(n){let e=Ne.fromString(n);return ne(AL(e)),e}function _h(n,e){return hD(n.databaseId,e.path)}function fi(n,e){let t=vL(e);if(t.get(1)!==n.databaseId.projectId)throw new F(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new F(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new W(EL(t))}function wL(n,e){return hD(n.databaseId,e)}function IL(n){let e=vL(n);return e.length===4?Ne.emptyPath():EL(e)}function UC(n){return new Ne(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function EL(n){return ne(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Z1(n,e,t){return{name:_h(n,e),fields:t.value.mapValue.fields}}function bL(n,e,t){let r=fi(n,e.name),i=Ct(e.updateTime),s=e.createTime?Ct(e.createTime):ie.min(),o=new dn({mapValue:{fields:e.fields}}),a=Mt.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function d7(n,e){return"found"in e?function(r,i){ne(!!i.found),i.found.name,i.found.updateTime;let s=fi(r,i.found.name),o=Ct(i.found.updateTime),a=i.found.createTime?Ct(i.found.createTime):ie.min(),c=new dn({mapValue:{fields:i.found.fields}});return Mt.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){ne(!!i.missing),ne(!!i.readTime);let s=fi(r,i.missing),o=Ct(i.readTime);return Mt.newNoDocument(s,o)}(n,e):X()}function h7(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:X()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(ne(d===void 0||typeof d=="string"),Ht.fromBase64String(d||"")):(ne(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Ht.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?O.UNKNOWN:gL(l.code);return new F(d,l.message||"")}(o);t=new Kg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=fi(n,r.document.name),s=Ct(r.document.updateTime),o=r.document.createTime?Ct(r.document.createTime):ie.min(),a=new dn({mapValue:{fields:r.document.fields}}),c=Mt.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new ol(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=fi(n,r.document),s=r.readTime?Ct(r.readTime):ie.min(),o=Mt.newNoDocument(i,s),a=r.removedTargetIds||[];t=new ol([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=fi(n,r.document),s=r.removedTargetIds||[];t=new ol([],s,i,null)}else{if(!("filter"in e))return X();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new MC(i,s),a=r.targetId;t=new Wg(a,o)}}return t}function yh(n,e){let t;if(e instanceof Ks)t={update:Z1(n,e.key,e.value)};else if(e instanceof Qs)t={delete:_h(n,e.key)};else if(e instanceof Or)t={update:Z1(n,e.key,e.data),updateMask:v7(e.fieldMask)};else{if(!(e instanceof hh))return X();t={verify:_h(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Gs)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ki)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Qi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ws)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw X()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:u7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:X()}(n,e.precondition)),t}function BC(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?_t.updateTime(Ct(s.updateTime)):s.exists!==void 0?_t.exists(s.exists):_t.none()}(e.currentDocument):_t.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)ne(a.setToServerValue==="REQUEST_TIME"),c=new Gs;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new Ki(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new Qi(d)}else"increment"in a?c=new Ws(o,a.increment):X();let l=bt.fromServerFormat(a.fieldPath);return new fa(l,c)}(n,i)):[];if(e.update){e.update.name;let i=fi(n,e.update.name),s=new dn({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new Qn(l.map(d=>bt.fromServerFormat(d)))}(e.updateMask);return new Or(i,s,o,t,r)}return new Ks(i,s,t,r)}if(e.delete){let i=fi(n,e.delete);return new Qs(i,t)}if(e.verify){let i=fi(n,e.verify);return new hh(i,t)}return X()}function f7(n,e){return n&&n.length>0?(ne(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?Ct(i.updateTime):Ct(s);return o.isEqual(ie.min())&&(o=Ct(s)),new xC(o,i.transformResults||[])}(t,e))):[]}function CL(n,e){return{documents:[wL(n,e.path)]}}function fD(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=wL(n,i);let s=function(l){if(l.length!==0)return SL(Ue.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(p){return{field:Fs(p.field),direction:g7(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=LC(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function p7(n,e,t,r){let{_t:i,parent:s}=fD(n,e),o={},a=[],c=0;return t.forEach(l=>{let d=r?l.alias:"aggregate_"+c++;o[d]=l.alias,l.aggregateType==="count"?a.push({alias:d,count:{}}):l.aggregateType==="avg"?a.push({alias:d,avg:{field:Fs(l.fieldPath)}}):l.aggregateType==="sum"&&a.push({alias:d,sum:{field:Fs(l.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},ut:o,parent:s}}function TL(n){let e=IL(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ne(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let p=DL(h);return p instanceof Ue&&lD(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(p=>function(w){return new da(tl(w.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,Ah(p)?null:p}(t.limit));let c=null;t.startAt&&(c=function(h){let p=!!h.before,_=h.values||[];return new gi(_,p)}(t.startAt));let l=null;return t.endAt&&(l=function(h){let p=!h.before,_=h.values||[];return new gi(_,p)}(t.endAt)),XF(e,i,o,s,a,"F",c,l)}function m7(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return X()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function DL(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=tl(t.unaryFilter.field);return Te.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=tl(t.unaryFilter.field);return Te.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=tl(t.unaryFilter.field);return Te.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=tl(t.unaryFilter.field);return Te.create(o,"!=",{nullValue:"NULL_VALUE"});default:return X()}}(n):n.fieldFilter!==void 0?function(t){return Te.create(tl(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return X()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ue.create(t.compositeFilter.filters.map(r=>DL(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return X()}}(t.compositeFilter.op))}(n):X()}function g7(n){return a7[n]}function _7(n){return c7[n]}function y7(n){return l7[n]}function Fs(n){return{fieldPath:n.canonicalString()}}function tl(n){return bt.fromServerFormat(n.fieldPath)}function SL(n){return n instanceof Te?function(t){if(t.op==="=="){if(F1(t.value))return{unaryFilter:{field:Fs(t.field),op:"IS_NAN"}};if(O1(t.value))return{unaryFilter:{field:Fs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(F1(t.value))return{unaryFilter:{field:Fs(t.field),op:"IS_NOT_NAN"}};if(O1(t.value))return{unaryFilter:{field:Fs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fs(t.field),op:_7(t.op),value:t.value}}}(n):n instanceof Ue?function(t){let r=t.getFilters().map(i=>SL(i));return r.length===1?r[0]:{compositeFilter:{op:y7(t.op),filters:r}}}(n):X()}function v7(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function AL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var pl=class n{constructor(e,t,r,i,s=ie.min(),o=ie.min(),a=Ht.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Yg=class{constructor(e){this.ct=e}};function w7(n,e){let t;if(e.document)t=bL(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=W.fromSegments(e.noDocument.path),i=ma(e.noDocument.readTime);t=Mt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return X();{let r=W.fromSegments(e.unknownDocument.path),i=ma(e.unknownDocument.version);t=Mt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new lt(i[0],i[1]);return ie.fromTimestamp(s)}(e.readTime)),t}function eF(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Jg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:_h(s,o.key),fields:o.data.value.mapValue.fields,updateTime:fl(s,o.version.toTimestamp()),createTime:fl(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:pa(e.version)};else{if(!e.isUnknownDocument())return X();r.unknownDocument={path:t.path.toArray(),version:pa(e.version)}}return r}function Jg(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function pa(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ma(n){let e=new lt(n.seconds,n.nanoseconds);return ie.fromTimestamp(e)}function ia(n,e){let t=(e.baseMutations||[]).map(s=>BC(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>BC(n.ct,s)),i=lt.fromMillis(e.localWriteTimeMs);return new fh(e.batchId,i,t,r)}function eh(n){let e=ma(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ma(n.lastLimboFreeSnapshotVersion):ie.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return ne(s.documents.length===1),En(Tl(IL(s.documents[0])))}(n.query):function(s){return En(TL(s))}(n.query),new pl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ht.fromBase64String(n.resumeToken))}function RL(n,e){let t=pa(e.snapshotVersion),r=pa(e.lastLimboFreeSnapshotVersion),i;i=qg(e.target)?CL(n.ct,e.target):fD(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ha(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function pD(n){let e=TL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Gg(e,e.limit,"L"):e}function eC(n,e){return new ph(e.largestBatchId,BC(n.ct,e.overlayMutation))}function tF(n,e){let t=e.path.lastSegment();return[n,In(e.path.popLast()),t]}function nF(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:pa(r.readTime),documentKey:In(r.documentKey.path),largestBatchId:r.largestBatchId}}var jC=class{getBundleMetadata(e,t){return rF(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:ma(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return rF(e).put(function(i){return{bundleId:i.id,createTime:pa(Ct(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return iF(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:pD(s.bundledQuery),readTime:ma(s.readTime)}}(r)})}saveNamedQuery(e,t){return iF(e).put(function(i){return{name:i.name,readTime:pa(Ct(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function rF(n){return qt(n,"bundles")}function iF(n){return qt(n,"namedQueries")}var Xg=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Qd(e).get(tF(this.userId,t)).next(r=>r?eC(this.serializer,r):null)}getOverlays(e,t){let r=di();return M.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new ph(t,o);i.push(this.ht(e,a))}),M.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(In(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Qd(e).j("collectionPathOverlayIndex",a))}),M.waitFor(s)}getOverlaysForCollection(e,t,r){let i=di(),s=In(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Qd(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=eC(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=di(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Qd(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,d)=>{let h=eC(this.serializer,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return Qd(e).put(function(i,s,o){let[a,c,l]=tF(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:yh(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function Qd(n){return qt(n,"documentOverlays")}var zi=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(gt(e.integerValue));else if("doubleValue"in e){let r=gt(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),ah(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=Wi(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Hs(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?zF(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):X()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),W.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};zi.bt=new zi;function I7(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function sF(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=I7(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var $C=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ct(r.value),r=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Mt(r.value),r=t.next();this.xt()}Ot(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let t=this.Bt(e),r=sF(t);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){let t=this.Bt(e),r=sF(t);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},HC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},qC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},sa=class{constructor(){this.Gt=new $C,this.zt=new HC(this.Gt),this.jt=new qC(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var oa=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function ks(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=oF(n.arrayValue,e.arrayValue),t!==0?t:(t=oF(n.directionalValue,e.directionalValue),t!==0?t:W.comparator(n.documentKey,e.documentKey)))}function oF(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Zg=class{constructor(e){this.Yt=new Ge((t,r)=>bt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let r=t;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(ne(e.collectionGroup===this.collectionId),this.en)return!1;let t=dC(e);if(t!==void 0&&!this.nn(t))return!1;let r=na(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Ge(bt.comparator),t=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new il(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new il(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new il(r.field,r.dir==="asc"?0:1)));return new cl(cl.UNKNOWN_ID,this.collectionId,t,oh.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function xL(n){var e,t;if(ne(n instanceof Te||n instanceof Ue),n instanceof Te){if(n instanceof Hg){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Te.create(n.field,"==",s)))||[];return Ue.create(i,"or")}return n}let r=n.filters.map(i=>xL(i));return Ue.create(r,n.op)}function E7(n){if(n.getFilters().length===0)return[];let e=WC(xL(n));return ne(NL(e)),zC(e)||GC(e)?[e]:e.getFilters()}function zC(n){return n instanceof Te}function GC(n){return n instanceof Ue&&lD(n)}function NL(n){return zC(n)||GC(n)||function(t){if(t instanceof Ue&&vC(t)){for(let r of t.getFilters())if(!zC(r)&&!GC(r))return!1;return!0}return!1}(n)}function WC(n){if(ne(n instanceof Te||n instanceof Ue),n instanceof Te)return n;if(n.filters.length===1)return WC(n.filters[0]);let e=n.filters.map(r=>WC(r)),t=Ue.create(e,n.op);return t=e_(t),NL(t)?t:(ne(t instanceof Ue),ne(ul(t)),ne(t.filters.length>1),t.filters.reduce((r,i)=>mD(r,i)))}function mD(n,e){let t;return ne(n instanceof Te||n instanceof Ue),ne(e instanceof Te||e instanceof Ue),t=n instanceof Te?e instanceof Te?function(i,s){return Ue.create([i,s],"and")}(n,e):aF(n,e):e instanceof Te?aF(e,n):function(i,s){if(ne(i.filters.length>0&&s.filters.length>0),ul(i)&&ul(s))return QF(i,s.getFilters());let o=vC(i)?i:s,a=vC(i)?s:i,c=o.filters.map(l=>mD(l,a));return Ue.create(c,"or")}(n,e),e_(t)}function aF(n,e){if(ul(e))return QF(e,n.getFilters());{let t=e.filters.map(r=>mD(n,r));return Ue.create(t,"or")}}function e_(n){if(ne(n instanceof Te||n instanceof Ue),n instanceof Te)return n;let e=n.getFilters();if(e.length===1)return e_(e[0]);if(WF(n))return n;let t=e.map(i=>e_(i)),r=[];return t.forEach(i=>{i instanceof Te?r.push(i):i instanceof Ue&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ue.create(r,n.op)}var KC=class{constructor(){this._n=new vh}addToCollectionParentIndex(e,t){return this._n.add(t),M.resolve()}getCollectionParents(e,t){return M.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return M.resolve()}deleteFieldIndex(e,t){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,t){return M.resolve()}getDocumentsMatchingTarget(e,t){return M.resolve(null)}getIndexType(e,t){return M.resolve(0)}getFieldIndexes(e,t){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,t){return M.resolve(pr.min())}getMinOffsetFromCollectionGroup(e,t){return M.resolve(pr.min())}updateCollectionGroup(e,t,r){return M.resolve()}updateIndexEntries(e,t){return M.resolve()}},vh=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ge(Ne.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ge(Ne.comparator)).toArray()}};var Tg=new Uint8Array(0),QC=class{constructor(e,t){this.databaseId=t,this.an=new vh,this.un=new _i(r=>ha(r),(r,i)=>Rh(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:r,parent:In(i)};return cF(e).put(s)}return M.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[PF(t),""],!1,!0);return cF(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(ui(o.parent))}return r})}addFieldIndex(e,t){let r=Yd(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=Jc(e);return s.next(a=>{o.put(nF(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=Yd(e),i=Jc(e),s=Yc(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Yd(e),r=Yc(e),i=Jc(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return M.forEach(this.cn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Zg(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=Yc(e),i=!0,s=new Map;return M.forEach(this.cn(t),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ge(),a=[];return M.forEach(s,(c,l)=>{V("IndexedDbIndexManager",`Using index ${function(B){return`id=${B.indexId}|cg=${B.collectionGroup}|f=${B.fields.map(J=>`${J.fieldPath}:${J.kind}`).join(",")}`}(c)} to execute ${ha(t)}`);let d=function(B,J){let ce=dC(J);if(ce===void 0)return null;for(let ee of zg(B,ce.fieldPath))switch(ee.op){case"array-contains-any":return ee.value.arrayValue.values||[];case"array-contains":return[ee.value]}return null}(l,c),h=function(B,J){let ce=new Map;for(let ee of na(J))for(let b of zg(B,ee.fieldPath))switch(b.op){case"==":case"in":ce.set(ee.fieldPath.canonicalString(),b.value);break;case"not-in":case"!=":return ce.set(ee.fieldPath.canonicalString(),b.value),Array.from(ce.values())}return null}(l,c),p=function(B,J){let ce=[],ee=!0;for(let b of na(J)){let v=b.kind===0?j1(B,b.fieldPath,B.startAt):$1(B,b.fieldPath,B.startAt);ce.push(v.value),ee&&(ee=v.inclusive)}return new gi(ce,ee)}(l,c),_=function(B,J){let ce=[],ee=!0;for(let b of na(J)){let v=b.kind===0?$1(B,b.fieldPath,B.endAt):j1(B,b.fieldPath,B.endAt);ce.push(v.value),ee&&(ee=v.inclusive)}return new gi(ce,ee)}(l,c),w=this.hn(c,l,p),S=this.hn(c,l,_),R=this.Pn(c,l,h),L=this.In(c.indexId,d,w,p.inclusive,S,_.inclusive,R);return M.forEach(L,K=>r.G(K,t.limit).next(B=>{B.forEach(J=>{let ce=W.fromSegments(J.documentKey);o.has(ce)||(o=o.add(ce),a.push(ce))})}))}).next(()=>a)}return M.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=E7(Ue.create(e.filters,"and")).map(r=>AC(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),l=c/(t!=null?t.length:1),d=[];for(let h=0;h<c;++h){let p=t?this.Tn(t[h/l]):Tg,_=this.En(e,p,r[h%l],i),w=this.dn(e,p,s[h%l],o),S=a.map(R=>this.En(e,p,R,!0));d.push(...this.createRange(_,w,S))}return d}En(e,t,r,i){let s=new oa(e,W.empty(),t,r);return i?s:s.Jt()}dn(e,t,r,i){let s=new oa(e,W.empty(),t,r);return i?s.Jt():s}ln(e,t){let r=new Zg(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.cn(t);return M.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new Ge(bt.comparator),d=!1;for(let h of c.filters)for(let p of h.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?d=!0:l=l.add(p.field));for(let h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}An(e,t){let r=new sa;for(let i of na(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);zi.bt.Pt(s,o)}return r.Wt()}Tn(e){let t=new sa;return zi.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let r=new sa;return zi.bt.Pt(ua(this.databaseId,t),r.Ht(function(s){let o=na(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,t,r){if(r===null)return[];let i=[];i.push(new sa);let s=0;for(let o of na(e)){let a=r[s++];for(let c of i)if(this.Vn(t,o.fieldPath)&&dh(a))i=this.mn(i,o,a);else{let l=c.Ht(o.kind);zi.bt.Pt(a,l)}}return this.fn(i)}hn(e,t,r){return this.Pn(e,t,r.position)}fn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Wt();return t}mn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new sa;c.seed(a.Wt()),zi.bt.Pt(o,c.Ht(t.kind)),s.push(c)}return s}Vn(e,t){return!!e.filters.find(r=>r instanceof Te&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Yd(e),i=Jc(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return M.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,h){let p=h?new oh(h.sequenceNumber,new pr(ma(h.readTime),new W(ui(h.documentKey)),h.largestBatchId)):oh.empty(),_=d.fields.map(([w,S])=>new il(bt.fromServerFormat(w),S));return new cl(d.indexId,d.collectionGroup,_,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:pe(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Yd(e),s=Jc(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>M.forEach(a,c=>s.put(nF(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return M.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?M.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),M.forEach(a,c=>this.pn(e,i,c).next(l=>{let d=this.yn(s,c);return l.isEqual(d)?M.resolve():this.wn(e,s,c,l,d)}))))})}Sn(e,t,r,i){return Yc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,t.key),documentKey:t.key.path.toArray()})}bn(e,t,r,i){return Yc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,t.key),t.key.path.toArray()])}pn(e,t,r){let i=Yc(e),s=new Ge(ks);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,t)])},(o,a)=>{s=s.add(new oa(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,t){let r=new Ge(ks),i=this.An(t,e);if(i==null)return r;let s=dC(t);if(s!=null){let o=e.data.field(s.fieldPath);if(dh(o))for(let a of o.arrayValue.values||[])r=r.add(new oa(t.indexId,e.key,this.Tn(a),i))}else r=r.add(new oa(t.indexId,e.key,Tg,i));return r}wn(e,t,r,i,s){V("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,d,h,p){let _=c.getIterator(),w=l.getIterator(),S=Qc(_),R=Qc(w);for(;S||R;){let L=!1,K=!1;if(S&&R){let B=d(S,R);B<0?K=!0:B>0&&(L=!0)}else S!=null?K=!0:L=!0;L?(h(R),R=Qc(w)):K?(p(S),S=Qc(_)):(S=Qc(_),R=Qc(w))}}(i,s,ks,a=>{o.push(this.Sn(e,t,r,a))},a=>{o.push(this.bn(e,t,r,a))}),M.waitFor(o)}gn(e){let t=1;return Jc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>ks(o,a)).filter((o,a,c)=>!a||ks(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=ks(o,e),c=ks(o,t);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Tg,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Tg,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,t){return ks(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(lF)}getMinOffset(e,t){return M.mapArray(this.cn(t),r=>this.ln(e,r).next(i=>i||X())).next(lF)}};function cF(n){return qt(n,"collectionParents")}function Yc(n){return qt(n,"indexEntries")}function Yd(n){return qt(n,"indexConfiguration")}function Jc(n){return qt(n,"indexState")}function lF(n){ne(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;oD(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new pr(e.readTime,e.documentKey,t)}var uF={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hr=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function PL(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,h,p)=>(a++,p.delete()));s.push(c.next(()=>{ne(a===1)}));let l=[];for(let d of t.mutations){let h=VF(e,d.key.path,t.batchId);s.push(i.delete(h)),l.push(d.key)}return M.waitFor(s).next(()=>l)}function t_(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw X();e=n.noDocument}return JSON.stringify(e).length}hr.DEFAULT_COLLECTION_PERCENTILE=10,hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hr.DEFAULT=new hr(41943040,hr.DEFAULT_COLLECTION_PERCENTILE,hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hr.DISABLED=new hr(-1,0,0);var n_=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,t,r,i){ne(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Os(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=nl(e),o=Os(e);return o.add({}).next(a=>{ne(typeof a=="number");let c=new fh(a,t,r,i),l=function(_,w,S){let R=S.baseMutations.map(K=>yh(_.ct,K)),L=S.mutations.map(K=>yh(_.ct,K));return{userId:w,batchId:S.batchId,localWriteTimeMs:S.localWriteTime.toMillis(),baseMutations:R,mutations:L}}(this.serializer,this.userId,c),d=[],h=new Ge((p,_)=>pe(p.canonicalString(),_.canonicalString()));for(let p of i){let _=VF(this.userId,p.key.path,a);h=h.add(p.key.path.popLast()),d.push(o.put(l)),d.push(s.put(_,SK))}return h.forEach(p=>{d.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),M.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return Os(e).get(t).next(r=>r?(ne(r.userId===this.userId),ia(this.serializer,r)):null)}vn(e,t){return this.Cn[t]?M.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Os(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(ne(a.batchId>=r),s=ia(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Os(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Os(e).U("userMutationsIndex",t).next(r=>r.map(i=>ia(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Rg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return nl(e).J({range:i},(o,a,c)=>{let[l,d,h]=o,p=ui(d);if(l===this.userId&&t.path.isEqual(p))return Os(e).get(h).next(_=>{if(!_)throw X();ne(_.userId===this.userId),s.push(ia(this.serializer,_))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ge(pe),i=[];return t.forEach(s=>{let o=Rg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=nl(e).J({range:a},(l,d,h)=>{let[p,_,w]=l,S=ui(_);p===this.userId&&s.path.isEqual(S)?r=r.add(w):h.done()});i.push(c)}),M.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Rg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Ge(pe);return nl(e).J({range:o},(c,l,d)=>{let[h,p,_]=c,w=ui(p);h===this.userId&&r.isPrefixOf(w)?w.length===i&&(a=a.add(_)):d.done()}).next(()=>this.Fn(e,a))}Fn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(Os(e).get(s).next(o=>{if(o===null)throw X();ne(o.userId===this.userId),r.push(ia(this.serializer,o))}))}),M.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return PL(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),M.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return M.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return nl(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=ui(s[1]);i.push(c)}else a.done()}).next(()=>{ne(i.length===0)})})}containsKey(e,t){return ML(e,this.userId,t)}xn(e){return kL(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function ML(n,e,t){let r=Rg(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return nl(n).J({range:s,H:!0},(a,c,l)=>{let[d,h,p]=a;d===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function Os(n){return qt(n,"mutations")}function nl(n){return qt(n,"documentMutations")}function kL(n){return qt(n,"mutationQueues")}var ml=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var YC=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let r=new ml(t.highestTargetId);return t.highestTargetId=r.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>ie.fromTimestamp(new lt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(t,r),this.kn(e,r))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Xc(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(ne(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return Xc(e).J((o,a)=>{let c=eh(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>M.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Xc(e).J((r,i)=>{let s=eh(i);t(s)})}Bn(e){return dF(e).get("targetGlobalKey").next(t=>(ne(t!==null),t))}kn(e,t){return dF(e).put("targetGlobalKey",t)}qn(e,t){return Xc(e).put(RL(this.serializer,t))}Qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=ha(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Xc(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=eh(a);Rh(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=Ls(e);return t.forEach(o=>{let a=In(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),M.waitFor(i)}removeMatchingKeys(e,t,r){let i=Ls(e);return M.forEach(t,s=>{let o=In(s.path);return M.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=Ls(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ls(e),s=ge();return i.J({range:r,H:!0},(o,a,c)=>{let l=ui(o[1]),d=new W(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=In(t.path),i=IDBKeyRange.bound([r],[PF(r)],!1,!0),s=0;return Ls(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return Xc(e).get(t).next(r=>r?eh(r):null)}};function Xc(n){return qt(n,"targets")}function dF(n){return qt(n,"targetGlobal")}function Ls(n){return qt(n,"targetDocuments")}function hF([n,e],[t,r]){let i=pe(n,t);return i===0?pe(e,r):i}var JC=class{constructor(e){this.Kn=e,this.buffer=new Ge(hF),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();hF(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},XC=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){V("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Xs(t)?V("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Js(t)}yield this.zn(3e5)}))}},ZC=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return M.resolve(Kn.oe);let r=new JC(t);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(uF)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uF):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let r,i,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),Zc()<=ye.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function b7(n,e){return new ZC(n,e)}var eT=class{constructor(e,t){this.db=e,this.garbageCollector=b7(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Zn(e){let t=0;return this.Jn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(r,i)=>t(i))}addReference(e,t,r){return Dg(e,r)}removeReference(e,t,r){return Dg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Dg(e,t)}er(e,t){return function(i,s){let o=!1;return kL(i).Y(a=>ML(i,a,s).next(c=>(c&&(o=!0),M.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=t){let c=this.er(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ie.min()),Ls(e).delete(function(h){return[0,In(h.path)]}(o))))});i.push(c)}}).next(()=>M.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Dg(e,t)}Xn(e,t){let r=Ls(e),i,s=Kn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==Kn.oe&&t(new W(ui(i)),s),s=l,i=c):s=Kn.oe}).next(()=>{s!==Kn.oe&&t(new W(ui(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Dg(n,e){return Ls(n).put(function(r,i){return{targetId:0,path:In(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var r_=class{constructor(){this.changes=new _i(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Mt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?M.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var tT=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ta(e).put(r)}removeEntry(e,t,r){return ta(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Jg(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.tr(e,r)))}getEntry(e,t){let r=Mt.newInvalidDocument(t);return ta(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Jd(t))},(i,s)=>{r=this.nr(t,s)}).next(()=>r)}rr(e,t){let r={size:0,document:Mt.newInvalidDocument(t)};return ta(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Jd(t))},(i,s)=>{r={document:this.nr(t,s),size:t_(s)}}).next(()=>r)}getEntries(e,t){let r=Ln();return this.ir(e,t,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,t){let r=Ln(),i=new et(W.comparator);return this.ir(e,t,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,t_(o))}).next(()=>({documents:r,_r:i}))}ir(e,t,r){if(t.isEmpty())return M.resolve();let i=new Ge(mF);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(Jd(i.first()),Jd(i.last())),o=i.getIterator(),a=o.getNext();return ta(e).J({index:"documentKeyIndex",range:s},(c,l,d)=>{let h=W.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&mF(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(Jd(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Jg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ta(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=Ln();for(let h of l){let p=this.nr(W.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);p.isFoundDocument()&&(Nh(t,p)||i.has(p.key))&&(d=d.insert(p.key,p))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=Ln(),o=pF(t,r),a=pF(t,pr.max());return ta(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,d)=>{let h=this.nr(W.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new nT(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return fF(e).get("remoteDocumentGlobalKey").next(t=>(ne(!!t),t))}tr(e,t){return fF(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let r=w7(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ie.min())))return r}return Mt.newInvalidDocument(e)}};function OL(n){return new tT(n)}var nT=class extends r_{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new _i(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Ge((s,o)=>pe(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=eF(this.ar.serializer,o);i=i.add(s.path.popLast());let l=t_(c);r+=l-a.size,t.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=eF(this.ar.serializer,o.convertToNoDocument(ie.min()));t.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,r)),M.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(r=>(this.ur.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function fF(n){return qt(n,"remoteDocumentGlobal")}function ta(n){return qt(n,"remoteDocumentsV14")}function Jd(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function pF(n,e){let t=e.documentKey.path.toArray();return[n,Jg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function mF(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=pe(t[s],r[s]),i)return i;return i=pe(t.length,r.length),i||(i=pe(t[t.length-2],r[r.length-2]),i||pe(t[t.length-1],r[r.length-1]))}var rT=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var i_=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&rh(r.mutation,i,Qn.empty(),lt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ge()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ge()){let i=di();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Zd();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=di();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ge()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Ln(),o=nh(),a=function(){return nh()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof Or)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),rh(d.mutation,l,d.mutation.getFieldMask(),lt.now())):o.set(l.key,Qn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var h;return a.set(l,new rT(d,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=nh(),i=new et((o,a)=>o-a),s=ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||Qn.empty();d=a.applyToLocalView(l,d),r.set(c,d);let h=(i.get(a.batchId)||ge()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,h=sL();d.forEach(p=>{if(!s.has(p)){let _=fL(t.get(p),r.get(p));_!==null&&h.set(p,_),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return M.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return W.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):uD(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):M.resolve(di()),a=-1,c=s;return o.next(l=>M.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?M.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,ge())).next(d=>({batchId:a,changes:iL(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new W(t)).next(r=>{let i=Zd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Zd();return this.indexManager.getCollectionParents(e,s).next(a=>M.forEach(a,c=>{let l=function(h,p){return new kr(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,p)=>{o=o.insert(h,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,Mt.newInvalidDocument(d)))});let a=Zd();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&rh(d.mutation,l,Qn.empty(),lt.now()),Nh(t,l)&&(a=a.insert(c,l))}),a})}};var iT=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return M.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ct(i.createTime)}}(t)),M.resolve()}getNamedQuery(e,t){return M.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:pD(i.bundledQuery),readTime:Ct(i.readTime)}}(t)),M.resolve()}};var sT=class{constructor(){this.overlays=new et(W.comparator),this.hr=new Map}getOverlay(e,t){return M.resolve(this.overlays.get(t))}getOverlays(e,t){let r=di();return M.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),M.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),M.resolve()}getOverlaysForCollection(e,t,r){let i=di(),s=t.length+1,o=new W(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return M.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new et((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=di(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=di(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return M.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new ph(t,r));let s=this.hr.get(t);s===void 0&&(s=ge(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var wh=class{constructor(){this.Pr=new Ge(Nt.Ir),this.Tr=new Ge(Nt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new Nt(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new Nt(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new W(new Ne([])),r=new Nt(t,e),i=new Nt(t,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new W(new Ne([])),r=new Nt(t,e),i=new Nt(t,e+1),s=ge();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Nt(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Nt=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return W.comparator(e.key,t.key)||pe(e.pr,t.pr)}static Er(e,t){return pe(e.pr,t.pr)||W.comparator(e.key,t.key)}};var oT=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new Ge(Nt.Ir)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new fh(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new Nt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return M.resolve(o)}lookupMutationBatch(e,t){return M.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return M.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Nt(t,0),i=new Nt(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),M.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ge(pe);return t.forEach(i=>{let s=new Nt(i,0),o=new Nt(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),M.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;W.isDocumentKey(s)||(s=s.child(""));let o=new Nt(new W(s),0),a=new Ge(pe);return this.wr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.pr)),!0)},o),M.resolve(this.Dr(a))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ne(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return M.forEach(t.mutations,i=>{let s=new Nt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new Nt(t,0),i=this.wr.firstAfterOrEqual(r);return M.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var aT=class{constructor(e){this.vr=e,this.docs=function(){return new et(W.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return M.resolve(r?r.document.mutableCopy():Mt.newInvalidDocument(t))}getEntries(e,t){let r=Ln();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Mt.newInvalidDocument(i))}),M.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ln(),o=t.path,a=new W(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||oD(kF(d),r)<=0||(i.has(d.key)||Nh(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return M.resolve(s)}getAllFromCollectionGroup(e,t,r,i){X()}Fr(e,t){return M.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new cT(this)}getSize(e){return M.resolve(this.size)}},cT=class extends r_{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),M.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var lT=class{constructor(e){this.persistence=e,this.Mr=new _i(t=>ha(t),Rh),this.lastRemoteSnapshotVersion=ie.min(),this.highestTargetId=0,this.Or=0,this.Nr=new wh,this.targetCount=0,this.Lr=ml.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),M.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new ml(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,M.resolve()}updateTargetData(e,t){return this.qn(t),M.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),M.waitFor(s).next(()=>i)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return M.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),M.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),M.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),M.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return M.resolve(r)}containsKey(e,t){return M.resolve(this.Nr.containsKey(t))}};var s_=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new Kn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new lT(this),this.indexManager=new KC,this.remoteDocumentCache=function(i){return new aT(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Yg(t),this.$r=new iT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new sT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new oT(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);let i=new uT(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return M.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},uT=class extends Vg{constructor(e){super(),this.currentSequenceNumber=e}},o_=class n{constructor(e){this.persistence=e,this.zr=new wh,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw X()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),M.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),M.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),M.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.Jr,r=>{let i=W.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,ie.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return M.or([()=>M.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var dT=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new Ug("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",P1,{unique:!0}),c.createObjectStore("documentMutations")}(e),gF(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=M.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),gF(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ie.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",P1,{unique:!0});let h=l.store("mutations"),p=d.map(_=>h.put(_));return M.waitFor(p)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:UK});l.createIndex("collectionPathOverlayIndex",BK,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",jK,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:AK});l.createIndex("documentKeyIndex",RK),l.createIndex("collectionGroupIndex",xK)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:OK}).createIndex("sequenceNumberIndex",FK,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:LK}).createIndex("documentKeyIndex",VK,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=t_(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>M.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>M.forEach(a,c=>{ne(c.userId===s.userId);let l=ia(this.serializer,c);return PL(e,s.userId,l).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new Ne(o),l=function(h){return[0,In(h)]}(c);s.push(t.get(l).next(d=>d?M.resolve():(h=>t.put({targetId:0,path:In(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>M.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:kK});let r=t.store("collectionParents"),i=new vh,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:In(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new Ne(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],l)=>{let d=ui(a);return s(d.popLast())}))}ri(e){let t=e.store("targets");return t.J((r,i)=>{let s=eh(i),o=RL(this.serializer,s);return t.put(o)})}ii(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(h){return h.document?new W(Ne.fromString(h.document.name).popFirst(5)):h.noDocument?W.fromSegments(h.noDocument.path):h.unknownDocument?W.fromSegments(h.unknownDocument.path):X()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>M.waitFor(i))}si(e,t){let r=t.store("mutations"),i=OL(this.serializer),s=new s_(o_.Hr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:ge();ia(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),M.forEach(a,(c,l)=>{let d=new Pt(l),h=Xg.lt(this.serializer,d),p=s.getIndexManager(d),_=n_.lt(d,this.serializer,p,s.referenceDelegate);return new i_(i,_,h,p).recalculateAndSaveOverlaysForDocumentKeys(new ch(t,Kn.oe),c).next()})})}};function gF(n){n.createObjectStore("targetDocuments",{keyPath:PK}).createIndex("documentTargetsIndex",MK,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",NK,{unique:!0}),n.createObjectStore("targetGlobal")}var tC="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",hT=class n{constructor(e,t,r,i,s,o,a,c,l,d,h=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=l,this.ai=d,this.ui=h,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=p=>Promise.resolve(),!n.D())throw new F(O.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new eT(this,i),this.Ti=t+"main",this.serializer=new Yg(c),this.Ei=new $s(this.Ti,this.ui,new dT(this.serializer)),this.Qr=new YC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=OL(this.serializer),this.$r=new jC,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,d===!1&&It("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new F(O.FAILED_PRECONDITION,tC);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new Kn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>g(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>g(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Sg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(Xs(e))return V("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return V("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return Xd(e).get("owner").next(t=>M.resolve(this.Si(t)))}bi(e){return Sg(e).delete(this.clientId)}Di(){return g(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=qt(t,"clientMetadata");return r.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return M.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?M.resolve(!0):Xd(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new F(O.FAILED_PRECONDITION,tC);return!1}}return!(!this.networkEnabled||!this.inForeground)||Sg(e).U().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&V("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return g(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new ch(e,Kn.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(r=>this.Ci(r.updateTimeMs,t)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Sg(e).U().next(t=>this.vi(t,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return n_.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new QC(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Xg.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,r){V("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===16?HK:c===15?$F:c===14?jF:c===13?BF:c===12?$K:c===11?UF:void X()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new ch(a,this.kr?this.kr.next():Kn.oe),t==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw It(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new F(O.FAILED_PRECONDITION,OF);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return Xd(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new F(O.FAILED_PRECONDITION,tC)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Xd(e).put("owner",t)}static D(){return $s.D()}yi(e){let t=Xd(e);return t.get("owner").next(r=>this.Si(r)?(V("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):M.resolve())}Ci(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(It(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;WE()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let r=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return V("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return It("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){It("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Xd(n){return qt(n,"owner")}function Sg(n){return qt(n,"clientMetadata")}function gD(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var fT=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=ge(),i=ge();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var pT=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var a_=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return WE()?8:FF(ze())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new pT;return this.Ji(e,t,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(Zc()<=ye.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",el(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),M.resolve()):(Zc()<=ye.DEBUG&&V("QueryEngine","Query:",el(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Zc()<=ye.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",el(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,En(t))):M.resolve())}ji(e,t){if(H1(t))return M.resolve(null);let r=En(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Gg(t,null,"F"),r=En(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ge(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.Zi(t,a);return this.Xi(t,l,o,c.readTime)?this.ji(e,Gg(t,null,"F")):this.es(e,l,t,c)}))})))}Hi(e,t,r,i){return H1(t)||i.isEqual(ie.min())?M.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,r,i)?M.resolve(null):(Zc()<=ye.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),el(t)),this.es(e,o,t,MF(i,-1)).next(a=>a))})}Zi(e,t){let r=new Ge(nL(e));return t.forEach((i,s)=>{Nh(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return Zc()<=ye.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",el(t)),this.zi.getDocumentsMatchingQuery(e,t,pr.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var mT=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new et(pe),this.rs=new _i(s=>ha(s),Rh),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new i_(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function FL(n,e,t,r){return new mT(n,e,t,r)}function LL(n,e){return g(this,null,function*(){let t=z(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=ge();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})})}function C7(n,e){let t=z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let h=l.batch,p=h.keys(),_=M.resolve();return p.forEach(w=>{_=_.next(()=>d.getEntry(c,w)).next(S=>{let R=l.docVersions.get(w);ne(R!==null),S.version.compareTo(R)<0&&(h.applyToRemoteDocument(S,l),S.isValidDocument()&&(S.setReadTime(l.commitVersion),d.addEntry(S)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ge();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function VL(n){let e=z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function T7(n,e){let t=z(n),r=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let a=[];e.targetChanges.forEach((d,h)=>{let p=i.get(h);if(!p)return;a.push(t.Qr.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Qr.addMatchingKeys(s,d.addedDocuments,h)));let _=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?_=_.withResumeToken(Ht.EMPTY_BYTE_STRING,ie.min()).withLastLimboFreeSnapshotVersion(ie.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(h,_),function(S,R,L){return S.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(p,_,d)&&a.push(t.Qr.updateTargetData(s,_))});let c=Ln(),l=ge();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(UL(s,o,e.documentUpdates).next(d=>{c=d.cs,l=d.ls})),!r.isEqual(ie.min())){let d=t.Qr.getLastRemoteSnapshotVersion(s).next(h=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return M.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.ns=i,s))}function UL(n,e,t){let r=ge(),i=ge();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Ln();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(ie.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):V("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:i}})}function D7(n,e){let t=z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function gl(n,e){let t=z(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,M.resolve(i)):t.Qr.allocateTargetId(r).next(o=>(i=new pl(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}function _l(n,e,t){return g(this,null,function*(){let r=z(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Xs(o))throw o;V("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function c_(n,e,t){let r=z(n),i=ie.min(),s=ge();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let h=z(c),p=h.rs.get(d);return p!==void 0?M.resolve(h.ns.get(p)):h.Qr.getTargetData(l,d)}(r,o,En(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?i:ie.min(),t?s:ge())).next(a=>($L(r,tL(e),a),{documents:a,hs:s})))}function BL(n,e){let t=z(n),r=z(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function jL(n,e){let t=z(n),r=t.ss.get(e)||ie.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,MF(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>($L(t,e,i),i))}function $L(n,e,t){let r=n.ss.get(e)||ie.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}function S7(n,e,t,r){return g(this,null,function*(){let i=z(n),s=ge(),o=Ln();for(let l of t){let d=e.Ps(l.metadata.name);l.document&&(s=s.add(d));let h=e.Is(l);h.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(d,h)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield gl(i,function(d){return En(Tl(Ne.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>UL(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Qr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.cs,d.ls)).next(()=>d.cs)))})}function A7(r,i){return g(this,arguments,function*(n,e,t=ge()){let s=yield gl(n,En(pD(e.bundledQuery))),o=z(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Ct(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let l=s.withResumeToken(Ht.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(a,l).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,t,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function _F(n,e){return`firestore_clients_${n}_${e}`}function yF(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function nC(n,e){return`firestore_targets_${n}_${e}`}var l_=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Es(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new F(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(It("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},ih=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Es(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new F(r.error.code,r.error.message))),s?new n(e,r.state,i):(It("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},u_=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=dD();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=LF(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(It("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},gT=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(It("SharedClientState",`Failed to parse online state: ${e}`),null)}},Ih=class{constructor(){this.activeTargetIds=dD()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},sh=class{constructor(e,t,r,i,s){this.window=e,this.oi=t,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new et(pe),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=_F(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Ih),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(_F(this.persistenceKey,r));if(i){let s=u_.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let r=this.xs(t);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,r){this.Ls(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(nC(this.persistenceKey,e));if(r){let i=ih.Es(e,r);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(nC(this.persistenceKey,e))}updateQueryState(e,t,r){this.qs(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return V("SharedClientState","READ",e,t),t}setItem(e,t){V("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){V("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(V("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void It("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let r=this.$s(t.key);return this.Us(r,null)}{let r=this.Ws(t.key,t.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let r=this.Gs(t.key,t.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let r=this.js(t.key,t.newValue);if(r)return this.Hs(r)}}else if(t.key===this.vs){if(t.newValue!==null){let r=this.xs(t.newValue);if(r)return this.Os(r)}}else if(t.key===this.Ss){let r=function(s){let o=Kn.oe;if(s!=null)try{let a=JSON.parse(s);ne(typeof a=="number"),o=a}catch(a){It("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Kn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Fs){let r=this.Js(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,r){let i=new l_(this.currentUser,e,t,r),s=yF(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let t=yF(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,r){let i=nC(this.persistenceKey,e),s=new ih(e,t,r);this.setItem(i,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let r=this.$s(e);return u_.Es(r,t)}Gs(e,t){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return l_.Es(new Pt(s),i,t)}js(e,t){let r=this.Cs.exec(e),i=Number(r[1]);return ih.Es(i,t)}xs(e){return gT.Es(e)}Js(e){return JSON.parse(e)}zs(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);V("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let r=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=dD();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},d_=class{constructor(){this.no=new Ih,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Ih,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var _T=class{io(e){}shutdown(){}};var h_=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){V("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){V("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ag=null;function rC(){return Ag===null?Ag=function(){return 268435456+Math.round(2147483648*Math.random())}():Ag++,"0x"+Ag.toString(16)}var R7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var yT=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var un="WebChannelConnection",vT=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,o){let a=rC(),c=this.vo(t,r.toUriEncodedString());V("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(l,s,o),this.Mo(t,c,l,i).then(d=>(V("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw fr("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}xo(t,r,i,s,o,a){return this.Co(t,r,i,s,o)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Cl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,r){let i=R7[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=rC();return new Promise((o,a)=>{let c=new Kb;c.setWithCredentials(!0),c.listenOnce(Yb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Kd.NO_ERROR:let d=c.getResponseJson();V(un,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Kd.TIMEOUT:V(un,`RPC '${e}' ${s} timed out`),a(new F(O.DEADLINE_EXCEEDED,"Request time out"));break;case Kd.HTTP_ERROR:let h=c.getStatus();if(V(un,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);let _=p?.error;if(_&&_.status&&_.message){let w=function(R){let L=R.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(L)>=0?L:O.UNKNOWN}(_.status);a(new F(w,_.message))}else a(new F(O.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new F(O.UNAVAILABLE,"Connection failed."));break;default:X()}}finally{V(un,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);V(un,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Oo(e,t,r){let i=rC(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Zb(),a=Xb(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Qb({})),this.Fo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");V(un,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c),p=!1,_=!1,w=new yT({lo:R=>{_?V(un,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(p||(V(un,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),V(un,`RPC '${e}' stream ${i} sending:`,R),h.send(R))},ho:()=>h.close()}),S=(R,L,K)=>{R.listen(L,B=>{try{K(B)}catch(J){setTimeout(()=>{throw J},0)}})};return S(h,Kc.EventType.OPEN,()=>{_||(V(un,`RPC '${e}' stream ${i} transport opened.`),w.mo())}),S(h,Kc.EventType.CLOSE,()=>{_||(_=!0,V(un,`RPC '${e}' stream ${i} transport closed`),w.po())}),S(h,Kc.EventType.ERROR,R=>{_||(_=!0,fr(un,`RPC '${e}' stream ${i} transport errored:`,R),w.po(new F(O.UNAVAILABLE,"The operation could not be completed")))}),S(h,Kc.EventType.MESSAGE,R=>{var L;if(!_){let K=R.data[0];ne(!!K);let B=K,J=B.error||((L=B[0])===null||L===void 0?void 0:L.error);if(J){V(un,`RPC '${e}' stream ${i} received error:`,J);let ce=J.status,ee=function(I){let D=xt[I];if(D!==void 0)return gL(D)}(ce),b=J.message;ee===void 0&&(ee=O.INTERNAL,b="Unknown error status: "+ce+" with message "+J.message),_=!0,w.po(new F(ee,b)),h.close()}else V(un,`RPC '${e}' stream ${i} received:`,K),w.yo(K)}}),S(a,Jb.STAT_EVENT,R=>{R.stat===Cg.PROXY?V(un,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Cg.NOPROXY&&V(un,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}};function HL(){return typeof window<"u"?window:null}function Mg(){return typeof document<"u"?document:null}function Ph(n){return new FC(n,!0)}var Eh=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var f_=class{constructor(e,t,r,i,s,o,a,c){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Eh(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return g(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return g(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return g(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(It(t.toString()),It("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new F(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>g(this,null,function*(){this.state=0,this.start()}))}c_(e){return V("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(V("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},wT=class extends f_{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=h7(this.serializer,e),r=function(s){if(!("targetChange"in s))return ie.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?ie.min():o.readTime?Ct(o.readTime):ie.min()}(e);return this.listener.h_(t,r)}P_(e){let t={};t.database=UC(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=qg(c)?{documents:CL(s,c)}:{query:fD(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=yL(s,o.resumeToken);let l=LC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(ie.min())>0){a.readTime=fl(s,o.snapshotVersion.toTimestamp());let l=LC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=m7(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){let t={};t.database=UC(this.serializer),t.removeTarget=e,this.i_(t)}},IT=class extends f_{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(ne(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=f7(e.writeResults,e.commitTime),r=Ct(e.commitTime);return this.listener.A_(r,t)}return ne(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=UC(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>yh(this.serializer,r))};this.i_(t)}};var ET=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new F(O.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,VC(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new F(O.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,VC(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new F(O.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},bT=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(It(t),this.y_=!1):V("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var CT=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>g(this,null,function*(){Zs(this)&&(V("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let l=z(c);l.M_.add(4),yield Dl(l),l.N_.set("Unknown"),l.M_.delete(4),yield Mh(l)})}(this))}))}),this.N_=new bT(r,i)}};function Mh(n){return g(this,null,function*(){if(Zs(n))for(let e of n.x_)yield e(!0)})}function Dl(n){return g(this,null,function*(){for(let e of n.x_)yield e(!1)})}function P_(n,e){let t=z(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),vD(t)?yD(t):Al(t).Xo()&&_D(t,e))}function yl(n,e){let t=z(n),r=Al(t);t.F_.delete(e),r.Xo()&&qL(t,e),t.F_.size===0&&(r.Xo()?r.n_():Zs(t)&&t.N_.set("Unknown"))}function _D(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ie.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Al(n).P_(e)}function qL(n,e){n.L_.xe(e),Al(n).I_(e)}function yD(n){n.L_=new OC({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Al(n).start(),n.N_.w_()}function vD(n){return Zs(n)&&!Al(n).Zo()&&n.F_.size>0}function Zs(n){return z(n).M_.size===0}function zL(n){n.L_=void 0}function x7(n){return g(this,null,function*(){n.N_.set("Online")})}function N7(n){return g(this,null,function*(){n.F_.forEach((e,t)=>{_D(n,e)})})}function P7(n,e){return g(this,null,function*(){zL(n),vD(n)?(n.N_.D_(e),yD(n)):n.N_.set("Unknown")})}function M7(n,e,t){return g(this,null,function*(){if(n.N_.set("Online"),e instanceof Kg&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(n,e)}catch(r){V("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield p_(n,r)}else if(e instanceof ol?n.L_.Ke(e):e instanceof Wg?n.L_.He(e):n.L_.We(e),!t.isEqual(ie.min()))try{let r=yield VL(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.F_.get(l);d&&s.F_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.F_.get(c);if(!d)return;s.F_.set(c,d.withResumeToken(Ht.EMPTY_BYTE_STRING,d.snapshotVersion)),qL(s,c);let h=new pl(d.target,c,l,d.sequenceNumber);_D(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){V("RemoteStore","Failed to raise snapshot:",r),yield p_(n,r)}})}function p_(n,e,t){return g(this,null,function*(){if(!Xs(e))throw e;n.M_.add(1),yield Dl(n),n.N_.set("Offline"),t||(t=()=>VL(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){V("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield Mh(n)}))})}function GL(n,e){return e().catch(t=>p_(n,t,e))}function Sl(n){return g(this,null,function*(){let e=z(n),t=Ys(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;k7(e);)try{let i=yield D7(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,O7(e,i)}catch(i){yield p_(e,i)}WL(e)&&KL(e)})}function k7(n){return Zs(n)&&n.v_.length<10}function O7(n,e){n.v_.push(e);let t=Ys(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function WL(n){return Zs(n)&&!Ys(n).Zo()&&n.v_.length>0}function KL(n){Ys(n).start()}function F7(n){return g(this,null,function*(){Ys(n).V_()})}function L7(n){return g(this,null,function*(){let e=Ys(n);for(let t of n.v_)e.d_(t.mutations)})}function V7(n,e,t){return g(this,null,function*(){let r=n.v_.shift(),i=NC.from(r,e,t);yield GL(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Sl(n)})}function U7(n,e){return g(this,null,function*(){e&&Ys(n).E_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return mL(o)&&o!==O.ABORTED}(i.code)){let s=r.v_.shift();Ys(r).t_(),yield GL(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Sl(r)}})}(n,e)),WL(n)&&KL(n)})}function vF(n,e){return g(this,null,function*(){let t=z(n);t.asyncQueue.verifyOperationInProgress(),V("RemoteStore","RemoteStore received new credentials");let r=Zs(t);t.M_.add(3),yield Dl(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield Mh(t)})}function TT(n,e){return g(this,null,function*(){let t=z(n);e?(t.M_.delete(2),yield Mh(t)):e||(t.M_.add(2),yield Dl(t),t.N_.set("Unknown"))})}function Al(n){return n.B_||(n.B_=function(t,r,i){let s=z(t);return s.f_(),new wT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:x7.bind(null,n),To:N7.bind(null,n),Ao:P7.bind(null,n),h_:M7.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.B_.t_(),vD(n)?yD(n):n.N_.set("Unknown")):(yield n.B_.stop(),zL(n))}))),n.B_}function Ys(n){return n.k_||(n.k_=function(t,r,i){let s=z(t);return s.f_(),new IT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:F7.bind(null,n),Ao:U7.bind(null,n),R_:L7.bind(null,n),A_:V7.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.k_.t_(),yield Sl(n)):(yield n.k_.stop(),n.v_.length>0&&(V("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var DT=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Et,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Rl(n,e){if(It("AsyncQueue",`${e}: ${n}`),Xs(n))return new F(O.UNAVAILABLE,`${e}: ${n}`);throw n}var m_=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||W.comparator(t.key,r.key):(t,r)=>W.comparator(t.key,r.key),this.keyedMap=Zd(),this.sortedSet=new et(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var g_=class{constructor(){this.q_=new et(W.comparator)}track(e){let t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):X():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}},vl=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,m_.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var ST=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},AT=class{constructor(){this.queries=new _i(e=>eL(e),xh),this.onlineState="Unknown",this.z_=new Set}};function wD(n,e){return g(this,null,function*(){let t=z(n),r=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new ST,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=Rl(o,`Initialization of query '${el(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&ED(t)})}function ID(n,e){return g(this,null,function*(){let t=z(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function B7(n,e){let t=z(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&ED(t)}function j7(n,e,t){let r=z(n),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(t);r.queries.delete(e)}function ED(n){n.z_.forEach(e=>{e.next()})}var RT,wF;(wF=RT||(RT={})).J_="default",wF.Cache="cache";var bh=class{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new vl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=vl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==RT.Cache}};var xT=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var __=class{constructor(e){this.serializer=e}Ps(e){return fi(this.serializer,e)}Is(e){return e.metadata.exists?bL(this.serializer,e.document,!1):Mt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Ct(e)}},NT=class{constructor(e,t,r){this.oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=QL(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let r=Ne.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,r=new __(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||ge()).add(s);t.set(o,a)}}return t}complete(){return g(this,null,function*(){let e=yield S7(this.localStore,new __(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let r of this.queries)yield A7(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function QL(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var y_=class{constructor(e){this.key=e}},v_=class{constructor(e){this.key=e}},w_=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=ge(),this.mutatedKeys=ge(),this.Ia=nL(e),this.Ta=new m_(this.Ia)}get Ea(){return this.la}da(e,t){let r=t?t.Aa:new g_,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let p=i.get(d),_=Nh(this.query,h)?h:null,w=!!p&&this.mutatedKeys.has(p.key),S=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),R=!1;p&&_?p.data.isEqual(_.data)?w!==S&&(r.track({type:3,doc:_}),R=!0):this.Ra(p,_)||(r.track({type:2,doc:_}),R=!0,(c&&this.Ia(_,c)>0||l&&this.Ia(_,l)<0)&&(a=!0)):!p&&_?(r.track({type:0,doc:_}),R=!0):p&&!_&&(r.track({type:1,doc:p}),R=!0,(c||l)&&(a=!0)),R&&(_?(o=o.add(_),s=S?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((d,h)=>function(_,w){let S=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return X()}};return S(_)-S(w)}(d.type,h.type)||this.Ia(d.doc,h.doc)),this.Va(r),i=i!=null&&i;let a=t&&!i?this.ma():[],c=this.Pa.size===0&&this.current&&!i?1:0,l=c!==this.ha;return this.ha=c,o.length!==0||l?{snapshot:new vl(this.query,e.Ta,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new g_,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=ge(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new v_(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new y_(r))}),t}pa(e){this.la=e.hs,this.Pa=ge();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return vl.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},PT=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},MT=class{constructor(e){this.key=e,this.wa=!1}},kT=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new _i(a=>eL(a),xh),this.Da=new Map,this.Ca=new Set,this.va=new et(W.comparator),this.Fa=new Map,this.Ma=new wh,this.xa={},this.Oa=new Map,this.Na=ml.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function $7(n,e,t=!0){return g(this,null,function*(){let r=M_(n),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield YL(r,e,t,!0),i})}function H7(n,e){return g(this,null,function*(){let t=M_(n);yield YL(t,e,!0,!1)})}function YL(n,e,t,r){return g(this,null,function*(){let i=yield gl(n.localStore,En(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield bD(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&P_(n.remoteStore,i),a})}function bD(n,e,t,r,i){return g(this,null,function*(){n.Ba=(h,p,_)=>function(S,R,L,K){return g(this,null,function*(){let B=R.view.da(L);B.Xi&&(B=yield c_(S.localStore,R.query,!1).then(({documents:b})=>R.view.da(b,B)));let J=K&&K.targetChanges.get(R.targetId),ce=K&&K.targetMismatches.get(R.targetId)!=null,ee=R.view.applyChanges(B,S.isPrimaryClient,J,ce);return OT(S,R.targetId,ee.fa),ee.snapshot})}(n,h,p,_);let s=yield c_(n.localStore,e,!0),o=new w_(e,s.hs),a=o.da(s.documents),c=gh.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);OT(n,t,l.fa);let d=new PT(e,t,o);return n.ba.set(e,d),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),l.snapshot})}function q7(n,e,t){return g(this,null,function*(){let r=z(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!xh(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield _l(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&yl(r.remoteStore,i.targetId),wl(r,i.targetId)}).catch(Js))):(wl(r,i.targetId),yield _l(r.localStore,i.targetId,!0))})}function z7(n,e){return g(this,null,function*(){let t=z(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),yl(t.remoteStore,r.targetId))})}function G7(n,e,t){return g(this,null,function*(){let r=SD(n);try{let i=yield function(o,a){let c=z(o),l=lt.now(),d=a.reduce((_,w)=>_.add(w.key),ge()),h,p;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let w=Ln(),S=ge();return c.os.getEntries(_,d).next(R=>{w=R,w.forEach((L,K)=>{K.isValidDocument()||(S=S.add(L))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,w)).next(R=>{h=R;let L=[];for(let K of a){let B=s7(K,h.get(K.key).overlayedDocument);B!=null&&L.push(new Or(K.key,B,GF(B.value.mapValue),_t.exists(!0)))}return c.mutationQueue.addMutationBatch(_,l,L,a)}).next(R=>{p=R;let L=R.applyToLocalDocumentSet(h,S);return c.documentOverlayCache.saveOverlays(_,R.batchId,L)})}).then(()=>({batchId:p.batchId,changes:iL(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.xa[o.currentUser.toKey()];l||(l=new et(pe)),l=l.insert(a,c),o.xa[o.currentUser.toKey()]=l}(r,i.batchId,t),yield Ji(r,i.changes),yield Sl(r.remoteStore)}catch(i){let s=Rl(i,"Failed to persist write");t.reject(s)}})}function JL(n,e){return g(this,null,function*(){let t=z(n);try{let r=yield T7(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(ne(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?ne(o.wa):i.removedDocuments.size>0&&(ne(o.wa),o.wa=!1))}),yield Ji(t,r,e)}catch(r){yield Js(r)}})}function IF(n,e,t){let r=z(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=z(o);c.onlineState=a;let l=!1;c.queries.forEach((d,h)=>{for(let p of h.U_)p.j_(a)&&(l=!0)}),l&&ED(c)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function W7(n,e,t){return g(this,null,function*(){let r=z(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new et(W.comparator);o=o.insert(s,Mt.newNoDocument(s,ie.min()));let a=ge().add(s),c=new mh(ie.min(),new Map,new et(pe),o,a);yield JL(r,c),r.va=r.va.remove(s),r.Fa.delete(e),DD(r)}else yield _l(r.localStore,e,!1).then(()=>wl(r,e,t)).catch(Js)})}function K7(n,e){return g(this,null,function*(){let t=z(n),r=e.batch.batchId;try{let i=yield C7(t.localStore,e);TD(t,r,null),CD(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ji(t,i)}catch(i){yield Js(i)}})}function Q7(n,e,t){return g(this,null,function*(){let r=z(n);try{let i=yield function(o,a){let c=z(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(ne(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);TD(r,e,t),CD(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ji(r,i)}catch(i){yield Js(i)}})}function Y7(n,e){return g(this,null,function*(){let t=z(n);Zs(t.remoteStore)||V("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=z(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Oa.get(r)||[];i.push(e),t.Oa.set(r,i)}catch(r){let i=Rl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function CD(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function TD(n,e,t){let r=z(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function wl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||XL(n,r)})}function XL(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(yl(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),DD(n))}function OT(n,e,t){for(let r of t)r instanceof y_?(n.Ma.addReference(r.key,e),J7(n,r)):r instanceof v_?(V("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||XL(n,r.key)):X()}function J7(n,e){let t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(V("SyncEngine","New document in limbo: "+t),n.Ca.add(r),DD(n))}function DD(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new W(Ne.fromString(e)),r=n.Na.next();n.Fa.set(r,new MT(t)),n.va=n.va.insert(t,r),P_(n.remoteStore,new pl(En(Tl(t.path)),r,"TargetPurposeLimboResolution",Kn.oe))}}function Ji(n,e,t){return g(this,null,function*(){let r=z(n),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,c)=>{o.push(r.Ba(c,e,t).then(l=>{if((l||t)&&r.isPrimaryClient){let d=l&&!l.fromCache;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);let d=fT.Ki(c.targetId,l);s.push(d)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(c,l){return g(this,null,function*(){let d=z(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>M.forEach(l,p=>M.forEach(p.qi,_=>d.persistence.referenceDelegate.addReference(h,p.targetId,_)).next(()=>M.forEach(p.Qi,_=>d.persistence.referenceDelegate.removeReference(h,p.targetId,_)))))}catch(h){if(!Xs(h))throw h;V("LocalStore","Failed to update sequence numbers: "+h)}for(let h of l){let p=h.targetId;if(!h.fromCache){let _=d.ns.get(p),w=_.snapshotVersion,S=_.withLastLimboFreeSnapshotVersion(w);d.ns=d.ns.insert(p,S)}}})}(r.localStore,s))})}function X7(n,e){return g(this,null,function*(){let t=z(n);if(!t.currentUser.isEqual(e)){V("SyncEngine","User change. New user:",e.toKey());let r=yield LL(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(c=>{c.reject(new F(O.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ji(t,r.us)}})}function Z7(n,e){let t=z(n),r=t.Fa.get(e);if(r&&r.wa)return ge().add(r.key);{let i=ge(),s=t.Da.get(e);if(!s)return i;for(let o of s){let a=t.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function eQ(n,e){return g(this,null,function*(){let t=z(n),r=yield c_(t.localStore,e.query,!0),i=e.view.pa(r);return t.isPrimaryClient&&OT(t,e.targetId,i.fa),i})}function tQ(n,e){return g(this,null,function*(){let t=z(n);return jL(t.localStore,e).then(r=>Ji(t,r))})}function nQ(n,e,t,r){return g(this,null,function*(){let i=z(n),s=yield function(a,c){let l=z(a),d=z(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.vn(h,c).next(p=>p?l.localDocuments.getDocuments(h,p):M.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield Sl(i.remoteStore):t==="acknowledged"||t==="rejected"?(TD(i,e,r||null),CD(i,e),function(a,c){z(z(a).mutationQueue).Mn(c)}(i.localStore,e)):X(),yield Ji(i,s)):V("SyncEngine","Cannot apply mutation batch with id: "+e)})}function rQ(n,e){return g(this,null,function*(){let t=z(n);if(M_(t),SD(t),e===!0&&t.La!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield EF(t,r.toArray());t.La=!0,yield TT(t.remoteStore,!0);for(let s of i)P_(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let r=[],i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(wl(t,o),_l(t.localStore,o,!0))),yl(t.remoteStore,o)}),yield i,yield EF(t,r),function(o){let a=z(o);a.Fa.forEach((c,l)=>{yl(a.remoteStore,l)}),a.Ma.mr(),a.Fa=new Map,a.va=new et(W.comparator)}(t),t.La=!1,yield TT(t.remoteStore,!1)}})}function EF(n,e,t){return g(this,null,function*(){let r=z(n),i=[],s=[];for(let o of e){let a,c=r.Da.get(o);if(c&&c.length!==0){a=yield gl(r.localStore,En(c[0]));for(let l of c){let d=r.ba.get(l),h=yield eQ(r,d);h.snapshot&&s.push(h.snapshot)}}else{let l=yield BL(r.localStore,o);a=yield gl(r.localStore,l),yield bD(r,ZL(l),o,!1,a.resumeToken)}i.push(a)}return r.Sa.h_(s),i})}function ZL(n){return XF(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function iQ(n){return function(t){return z(z(t).persistence).Bi()}(z(n).localStore)}function sQ(n,e,t,r){return g(this,null,function*(){let i=z(n);if(i.La)return void V("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield jL(i.localStore,tL(s[0])),a=mh.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ht.EMPTY_BYTE_STRING);yield Ji(i,o,a);break}case"rejected":yield _l(i.localStore,e,!0),wl(i,e,r);break;default:X()}})}function oQ(n,e,t){return g(this,null,function*(){let r=M_(n);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){V("SyncEngine","Adding an already active target "+i);continue}let s=yield BL(r.localStore,i),o=yield gl(r.localStore,s);yield bD(r,ZL(s),o.targetId,!1,o.resumeToken),P_(r.remoteStore,o)}for(let i of t)r.Da.has(i)&&(yield _l(r.localStore,i,!1).then(()=>{yl(r.remoteStore,i),wl(r,i)}).catch(Js))}})}function M_(n){let e=z(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=JL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Z7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=W7.bind(null,e),e.Sa.h_=B7.bind(null,e.eventManager),e.Sa.ka=j7.bind(null,e.eventManager),e}function SD(n){let e=z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=K7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Q7.bind(null,e),e}function aQ(n,e,t){let r=z(n);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(_,w){let S=z(_),R=Ct(w.createTime);return S.persistence.runTransaction("hasNewerBundle","readonly",L=>S.$r.getBundleMetadata(L,w.id)).then(L=>!!L&&L.createTime.compareTo(R)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(QL(c));let l=new NT(c,s.localStore,o.serializer),d=yield o.qa();for(;d;){let p=yield l._a(d);p&&a._updateProgress(p),d=yield o.qa()}let h=yield l.complete();return yield Ji(s,h.ca,void 0),yield function(_,w){let S=z(_);return S.persistence.runTransaction("Save bundle","readwrite",R=>S.$r.saveBundleMetadata(R,w))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.ua)}catch(c){return fr("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Ch=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=Ph(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return FL(this.persistence,new a_,e.initialUser,this.serializer)}createPersistence(e){return new s_(o_.Hr,this.serializer)}createSharedClientState(e){return new d_}terminate(){return g(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var I_=class n extends Ch{constructor(e,t,r){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield jr(n.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield SD(this.Qa.syncEngine),yield Sl(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return FL(this.persistence,new a_,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new XC(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new mC(t,this.persistence);return new pC(e.asyncQueue,r)}createPersistence(e){let t=gD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?hr.withCacheSize(this.cacheSizeBytes):hr.DEFAULT;return new hT(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,HL(),Mg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new d_}},FT=class n extends I_{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield jr(n.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof sh&&(this.sharedClientState.syncEngine={Zs:nQ.bind(null,t),Xs:sQ.bind(null,t),eo:oQ.bind(null,t),Bi:iQ.bind(null,t),Ys:tQ.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>g(this,null,function*(){yield rQ(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=HL();if(!sh.D(t))throw new F(O.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=gD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new sh(t,e.asyncQueue,r,e.clientId,e.initialUser)}},Th=class{initialize(e,t){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>IF(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=X7.bind(null,this.syncEngine),yield TT(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new AT}()}createDatastore(e){let t=Ph(e.databaseInfo.databaseId),r=function(s){return new vT(s)}(e.databaseInfo);return function(s,o,a,c){return new ET(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new CT(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>IF(this.syncEngine,t,0),function(){return h_.D()?new h_:new _T}())}createSyncEngine(e,t){return function(i,s,o,a,c,l,d){let h=new kT(i,s,o,a,c,l);return d&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return g(this,null,function*(){var e;yield function(r){return g(this,null,function*(){let i=z(r);V("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Dl(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function bF(n,e=10240){let t=0;return{read(){return g(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Il=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):It("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var LT=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new Et,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}qa(){return g(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return g(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),r=Number(t);isNaN(r)&&this.ja(`length string (${t}) is not valid number`);let i=yield this.Ha(r);return new xT(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return g(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return g(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var VT=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new F(O.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return g(this,null,function*(){let o=z(i),a={documents:s.map(h=>_h(o.serializer,h))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,Ne.emptyPath(),a,s.length),l=new Map;c.forEach(h=>{let p=d7(o.serializer,h);l.set(p.key.toString(),p)});let d=[];return s.forEach(h=>{let p=l.get(h.toString());ne(!!p),d.push(p)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Qs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=W.fromPath(r);this.mutations.push(new hh(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=z(r),o={writes:i.map(a=>yh(s.serializer,a))};yield s.Co("Commit",s.serializer.databaseId,Ne.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw X();t=ie.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new F(O.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ie.min())?_t.exists(!1):_t.updateTime(t):_t.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ie.min()))throw new F(O.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _t.updateTime(t)}return _t.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var UT=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Yo=new Eh(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>g(this,null,function*(){let e=new VT(this.datastore),t=this.tu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let t=this.updateFunction(e);return!Ah(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!mL(t)}return!1}};var BT=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Pt.UNAUTHENTICATED,this.clientId=Fg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){V("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(V("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new F(O.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Et;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Rl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function kg(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),V("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield LL(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function jT(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield AD(n);V("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>vF(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>vF(e.remoteStore,i)),n._onlineComponents=e})}function eV(n){return n.name==="FirebaseError"?n.code===O.FAILED_PRECONDITION||n.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function AD(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V("FirestoreClient","Using user provided OfflineComponentProvider");try{yield kg(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!eV(t))throw t;fr("Error using user provided cache. Falling back to memory cache: "+t),yield kg(n,new Ch)}}else V("FirestoreClient","Using default OfflineComponentProvider"),yield kg(n,new Ch);return n._offlineComponents})}function k_(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(V("FirestoreClient","Using user provided OnlineComponentProvider"),yield jT(n,n._uninitializedComponentsProvider._online)):(V("FirestoreClient","Using default OnlineComponentProvider"),yield jT(n,new Th))),n._onlineComponents})}function tV(n){return AD(n).then(e=>e.persistence)}function RD(n){return AD(n).then(e=>e.localStore)}function nV(n){return k_(n).then(e=>e.remoteStore)}function xD(n){return k_(n).then(e=>e.syncEngine)}function rV(n){return k_(n).then(e=>e.datastore)}function El(n){return g(this,null,function*(){let e=yield k_(n),t=e.eventManager;return t.onListen=$7.bind(null,e.syncEngine),t.onUnlisten=q7.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=H7.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=z7.bind(null,e.syncEngine),t})}function cQ(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield tV(n),t=yield nV(n);return e.setNetworkEnabled(!0),function(i){let s=z(i);return s.M_.delete(0),Mh(s)}(t)}))}function lQ(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield tV(n),t=yield nV(n);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=z(i);s.M_.add(0),yield Dl(s),s.N_.set("Offline")})}(t)}))}function uQ(n,e){let t=new Et;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(l,d){let h=z(l);return h.persistence.runTransaction("read document","readonly",p=>h.localDocuments.getDocument(p,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new F(O.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Rl(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield RD(n),e,t)})),t.promise}function iV(n,e,t={}){let r=new Et;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new Il({next:p=>{o.enqueueAndForget(()=>ID(s,h));let _=p.docs.has(a);!_&&p.fromCache?l.reject(new F(O.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&c&&c.source==="server"?l.reject(new F(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new bh(Tl(a.path),d,{includeMetadataChanges:!0,ra:!0});return wD(s,h)}(yield El(n),n.asyncQueue,e,t,r)})),r.promise}function dQ(n,e){let t=new Et;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield c_(i,s,!0),c=new w_(s,a.hs),l=c.da(a.documents),d=c.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let c=Rl(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield RD(n),e,t)})),t.promise}function sV(n,e,t={}){let r=new Et;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new Il({next:p=>{o.enqueueAndForget(()=>ID(s,h)),p.fromCache&&c.source==="server"?l.reject(new F(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new bh(a,d,{includeMetadataChanges:!0,ra:!0});return wD(s,h)}(yield El(n),n.asyncQueue,e,t,r)})),r.promise}function hQ(n,e,t){let r=new Et;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){try{let i=yield rV(n);r.resolve(function(o,a,c){return g(this,null,function*(){var l;let d=z(o),{request:h,ut:p,parent:_}=p7(d.serializer,QK(a),c);d.connection.Do||delete h.parent;let w=(yield d.xo("RunAggregationQuery",d.serializer.databaseId,_,h,1)).filter(R=>!!R.result);ne(w.length===1);let S=(l=w[0].result)===null||l===void 0?void 0:l.aggregateFields;return Object.keys(S).reduce((R,L)=>(R[p[L]]=S[L],R),{})})}(i,e,t))}catch(i){r.reject(i)}})),r.promise}function fQ(n,e){let t=new Il(e);return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){z(i).z_.add(s),s.next()}(yield El(n),t)})),()=>{t.$a(),n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){z(i).z_.delete(s)}(yield El(n),t)}))}}function pQ(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?_L().encode(o):o,function(d,h){return new LT(d,h)}(function(d,h){if(d instanceof Uint8Array)return bF(d,h);if(d instanceof ArrayBuffer)return bF(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,Ph(e));n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){aQ(yield xD(n),i,r)}))}function mQ(n,e){return n.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=z(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield RD(n),e)}))}function oV(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var CF=new Map;function ND(n,e,t){if(!t)throw new F(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function PD(n,e,t,r){if(e===!0&&r===!0)throw new F(O.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function TF(n){if(!W.isDocumentKey(n))throw new F(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function DF(n){if(W.isDocumentKey(n))throw new F(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function O_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":X()}function De(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new F(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=O_(n);throw new F(O.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function aV(n,e){if(e<=0)throw new F(O.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var E_=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new F(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new F(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}PD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=oV((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ga=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new E_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new F(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new F(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new E_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new iC;switch(r.type){case"firstParty":return new cC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new F(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=CF.get(t);r&&(V("ComponentProvider","Removing Datastore"),CF.delete(t),r.terminate())}(this),Promise.resolve()}};function cV(n,e,t,r={}){var i;let s=(n=De(n,ga))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&fr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Pt.MOCK_USER;else{a=Mc(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new F(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Pt(l)}n._authCredentials=new sC(new Og(a,c))}}var Yt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ye=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},pi=class n extends Yt{constructor(e,t,r){super(e,t,Tl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ye(this.firestore,null,new W(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function wi(n,e,...t){if(n=q(n),ND("collection","path",e),n instanceof ga){let r=Ne.fromString(e,...t);return DF(r),new pi(n,null,r)}{if(!(n instanceof Ye||n instanceof pi))throw new F(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ne.fromString(e,...t));return DF(r),new pi(n.firestore,null,r)}}function lV(n,e){if(n=De(n,ga),ND("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new F(O.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Yt(n,null,function(r){return new kr(Ne.emptyPath(),r)}(e))}function kh(n,e,...t){if(n=q(n),arguments.length===1&&(e=Fg.newId()),ND("doc","path",e),n instanceof ga){let r=Ne.fromString(e,...t);return TF(r),new Ye(n,null,new W(r))}{if(!(n instanceof Ye||n instanceof pi))throw new F(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ne.fromString(e,...t));return TF(r),new Ye(n.firestore,n instanceof pi?n.converter:null,new W(r))}}function MD(n,e){return n=q(n),e=q(e),(n instanceof Ye||n instanceof pi)&&(e instanceof Ye||e instanceof pi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function kD(n,e){return n=q(n),e=q(e),n instanceof Yt&&e instanceof Yt&&n.firestore===e.firestore&&xh(n._query,e._query)&&n.converter===e.converter}var $T=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Eh(this,"async_queue_retry"),this.hu=()=>{let t=Mg();t&&V("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=Mg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=Mg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new Et;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return g(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Xs(e))throw e;V("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw It("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=DT.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&X()}verifyOperationInProgress(){}du(){return g(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function HT(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var qT=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Et,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var uV=-1,tt=class extends ga{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new $T}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||dV(this),this._firestoreClient.terminate()}};function kt(n){return n._firestoreClient||dV(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function dV(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,d){return new gC(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,oV(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new BT(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function hV(n,e){IV(n=De(n,tt));let t=kt(n);if(t._uninitializedComponentsProvider)throw new F(O.FAILED_PRECONDITION,"SDK cache is already specified.");fr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new Th;return pV(t,i,new I_(i,r.cacheSizeBytes,e?.forceOwnership))}function fV(n){IV(n=De(n,tt));let e=kt(n);if(e._uninitializedComponentsProvider)throw new F(O.FAILED_PRECONDITION,"SDK cache is already specified.");fr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new Th;return pV(e,r,new FT(r,t.cacheSizeBytes))}function pV(n,e,t){let r=new Et;return n.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield kg(n,t),yield jT(n,e),r.resolve()}catch(i){let s=i;if(!eV(s))throw s;fr("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function mV(n){if(n._initialized&&!n._terminated)throw new F(O.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Et;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!$s.D())return Promise.resolve();let i=r+"main";yield $s.delete(i)})}(gD(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function gV(n){return function(t){let r=new Et;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return Y7(yield xD(t),r)})),r.promise}(kt(n=De(n,tt)))}function _V(n){return cQ(kt(n=De(n,tt)))}function yV(n){return lQ(kt(n=De(n,tt)))}function vV(n,e){let t=kt(n=De(n,tt)),r=new qT;return pQ(t,n._databaseId,e,r),r}function wV(n,e){return mQ(kt(n=De(n,tt)),e).then(t=>t?new Yt(n,null,t.query):null)}function IV(n){if(n._initialized||n._terminated)throw new F(O.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var zT=class{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}},GT=class{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}};var yi=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ht.fromBase64String(e))}catch(t){throw new F(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Fr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Yi=class{constructor(e){this._methodName=e}};var _a=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return pe(this._lat,e._lat)||pe(this._long,e._long)}};var gQ=/^__.*__$/,WT=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Or(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ks(e,this.data,t,this.fieldTransforms)}},b_=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Or(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function EV(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X()}}var C_=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return T_(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(EV(this.fu)&&gQ.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},KT=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ph(e)}Fu(e,t,r,i=!1){return new C_({fu:e,methodName:t,vu:r,path:bt.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Ia(n){let e=n._freezeSettings(),t=Ph(n._databaseId);return new KT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function F_(n,e,t,r,i,s={}){let o=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);LD("Data must be an object, but it was:",o,r);let a=TV(r,o),c,l;if(s.merge)c=new Qn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let p=ZT(e,h,t);if(!o.contains(p))throw new F(O.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);SV(d,p)||d.push(p)}c=new Qn(d),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new WT(new dn(a),c,l)}var Dh=class n extends Yi{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function bV(n,e,t){return new C_({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var QT=class n extends Yi{_toFieldTransform(e){return new fa(e.path,new Gs)}isEqual(e){return e instanceof n}},YT=class n extends Yi{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=bV(this,e,!0),r=this.Mu.map(s=>Ea(s,t)),i=new Ki(r);return new fa(e.path,i)}isEqual(e){return e instanceof n&&Cs(this.Mu,e.Mu)}},JT=class n extends Yi{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=bV(this,e,!0),r=this.Mu.map(s=>Ea(s,t)),i=new Qi(r);return new fa(e.path,i)}isEqual(e){return e instanceof n&&Cs(this.Mu,e.Mu)}},XT=class n extends Yi{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new Ws(e.serializer,cL(e.serializer,this.xu));return new fa(e.path,t)}isEqual(e){return e instanceof n&&this.xu===e.xu}};function OD(n,e,t,r){let i=n.Fu(1,e,t);LD("Data must be an object, but it was:",i,r);let s=[],o=dn.empty();wa(r,(c,l)=>{let d=VD(e,c,t);l=q(l);let h=i.Su(d);if(l instanceof Dh)s.push(d);else{let p=Ea(l,h);p!=null&&(s.push(d),o.set(d,p))}});let a=new Qn(s);return new b_(o,a,i.fieldTransforms)}function FD(n,e,t,r,i,s){let o=n.Fu(1,e,t),a=[ZT(e,r,t)],c=[i];if(s.length%2!=0)throw new F(O.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(ZT(e,s[p])),c.push(s[p+1]);let l=[],d=dn.empty();for(let p=a.length-1;p>=0;--p)if(!SV(l,a[p])){let _=a[p],w=c[p];w=q(w);let S=o.Su(_);if(w instanceof Dh)l.push(_);else{let R=Ea(w,S);R!=null&&(l.push(_),d.set(_,R))}}let h=new Qn(l);return new b_(d,h,o.fieldTransforms)}function CV(n,e,t,r=!1){return Ea(t,n.Fu(r?4:3,e))}function Ea(n,e){if(DV(n=q(n)))return LD("Unsupported field value:",e,n),TV(n,e);if(n instanceof Yi)return function(r,i){if(!EV(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Ea(a,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=q(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return cL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=lt.fromDate(r);return{timestampValue:fl(i.serializer,s)}}if(r instanceof lt){let s=new lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:fl(i.serializer,s)}}if(r instanceof _a)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof yi)return{bytesValue:yL(i.serializer,r._byteString)};if(r instanceof Ye){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:hD(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${O_(r)}`)}(n,e)}function TV(n,e){let t={};return HF(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wa(n,(r,i)=>{let s=Ea(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function DV(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof lt||n instanceof _a||n instanceof yi||n instanceof Ye||n instanceof Yi)}function LD(n,e,t){if(!DV(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=O_(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function ZT(n,e,t){if((e=q(e))instanceof Fr)return e._internalPath;if(typeof e=="string")return VD(n,e);throw T_("Field path arguments must be of type string or ",n,!1,void 0,t)}var _Q=new RegExp("[~\\*/\\[\\]]");function VD(n,e,t){if(e.search(_Q)>=0)throw T_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Fr(...e.split("."))._internalPath}catch{throw T_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function T_(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new F(O.INVALID_ARGUMENT,a+n+c)}function SV(n,e){return n.some(t=>t.isEqual(e))}var ya=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ye(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new eD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(L_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},eD=class extends ya{data(){return super.data()}};function L_(n,e){return typeof e=="string"?VD(n,e):e instanceof Fr?e._internalPath:e._delegate._internalPath}function AV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new F(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Sh=class{},va=class extends Sh{};function Xi(n,e,...t){let r=[];e instanceof Sh&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof tD).length,a=s.filter(c=>c instanceof D_).length;if(o>1||o>0&&a>0)throw new F(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var D_=class n extends va{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return VV(e._query,t),new Yt(e.firestore,e.converter,RC(e._query,t))}_parse(e){let t=Ia(e.firestore);return function(s,o,a,c,l,d,h){let p;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new F(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){AF(h,d);let _=[];for(let w of h)_.push(SF(c,s,w));p={arrayValue:{values:_}}}else p=SF(c,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||AF(h,d),p=CV(a,o,h,d==="in"||d==="not-in");return Te.create(l,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function RV(n,e,t){let r=e,i=L_("where",n);return D_._create(i,r,t)}var tD=class n extends Sh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ue.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)VV(o,c),o=RC(o,c)}(e._query,t),new Yt(e.firestore,e.converter,RC(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var nD=class n extends va{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new F(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new F(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new da(s,o)}(e._query,this._field,this._direction);return new Yt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new kr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function xV(n,e="asc"){let t=e,r=L_("orderBy",n);return nD._create(r,t)}var S_=class n extends va{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Yt(e.firestore,e.converter,Gg(e._query,this._limit,this._limitType))}};function NV(n){return aV("limit",n),S_._create("limit",n,"F")}function PV(n){return aV("limitToLast",n),S_._create("limitToLast",n,"L")}var A_=class n extends va{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=LV(e,this.type,this._docOrFields,this._inclusive);return new Yt(e.firestore,e.converter,function(i,s){return new kr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function MV(...n){return A_._create("startAt",n,!0)}function kV(...n){return A_._create("startAfter",n,!1)}var R_=class n extends va{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=LV(e,this.type,this._docOrFields,this._inclusive);return new Yt(e.firestore,e.converter,function(i,s){return new kr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function OV(...n){return R_._create("endBefore",n,!1)}function FV(...n){return R_._create("endAt",n,!0)}function LV(n,e,t,r){if(t[0]=q(t[0]),t[0]instanceof ya)return function(s,o,a,c,l){if(!c)throw new F(O.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of sl(s))if(h.field.isKeyField())d.push(ua(o,c.key));else{let p=c.data.field(h.field);if(N_(p))throw new F(O.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let _=h.field.canonicalString();throw new F(O.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(p)}return new gi(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Ia(n.firestore);return function(o,a,c,l,d,h){let p=o.explicitOrderBy;if(d.length>p.length)throw new F(O.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let _=[];for(let w=0;w<d.length;w++){let S=d[w];if(p[w].field.isKeyField()){if(typeof S!="string")throw new F(O.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof S}`);if(!uD(o)&&S.indexOf("/")!==-1)throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${S}' contains a slash.`);let R=o.path.child(Ne.fromString(S));if(!W.isDocumentKey(R))throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let L=new W(R);_.push(ua(a,L))}else{let R=CV(c,l,S);_.push(R)}}return new gi(_,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function SF(n,e,t){if(typeof(t=q(t))=="string"){if(t==="")throw new F(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!uD(e)&&t.indexOf("/")!==-1)throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Ne.fromString(t));if(!W.isDocumentKey(r))throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ua(n,new W(r))}if(t instanceof Ye)return ua(n,t._key);throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${O_(t)}.`)}function AF(n,e){if(!Array.isArray(n)||n.length===0)throw new F(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function VV(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new F(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new F(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var bl=class{convertValue(e,t="none"){switch(la(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Hs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw X()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return wa(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new _a(gt(e.latitude),gt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=cD(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(lh(e));default:return null}}convertTimestamp(e){let t=Wi(e);return new lt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Ne.fromString(e);ne(AL(r));let i=new qs(r.get(1),r.get(3)),s=new W(r.popFirst(5));return i.isEqual(t)||It(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function V_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var rD=class extends bl{constructor(e){super(),this.firestore=e}convertBytes(e){return new yi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ye(this.firestore,null,t)}};function yQ(){return new zT("count")}var Gi=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},mr=class extends ya{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Bs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(L_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Bs=class extends mr{data(e={}){return super.data(e)}},Lr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Gi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Bs(this._firestore,this._userDataWriter,r.key,r,new Gi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Bs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Gi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Bs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Gi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:vQ(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function vQ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return X()}}function UD(n,e){return n instanceof mr&&e instanceof mr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Lr&&e instanceof Lr&&n._firestore===e._firestore&&kD(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function UV(n){n=De(n,Ye);let e=De(n.firestore,tt);return iV(kt(e),n._key).then(t=>$D(e,n,t))}var vi=class extends bl{constructor(e){super(),this.firestore=e}convertBytes(e){return new yi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ye(this.firestore,null,t)}};function BV(n){n=De(n,Ye);let e=De(n.firestore,tt),t=kt(e),r=new vi(e);return uQ(t,n._key).then(i=>new mr(e,r,n._key,i,new Gi(i!==null&&i.hasLocalMutations,!0),n.converter))}function jV(n){n=De(n,Ye);let e=De(n.firestore,tt);return iV(kt(e),n._key,{source:"server"}).then(t=>$D(e,n,t))}function U_(n){n=De(n,Yt);let e=De(n.firestore,tt),t=kt(e),r=new vi(e);return AV(n._query),sV(t,n._query).then(i=>new Lr(e,r,n,i))}function $V(n){n=De(n,Yt);let e=De(n.firestore,tt),t=kt(e),r=new vi(e);return dQ(t,n._query).then(i=>new Lr(e,r,n,i))}function HV(n){n=De(n,Yt);let e=De(n.firestore,tt),t=kt(e),r=new vi(e);return sV(t,n._query,{source:"server"}).then(i=>new Lr(e,r,n,i))}function BD(n,e,t){n=De(n,Ye);let r=De(n.firestore,tt),i=V_(n.converter,e,t);return xl(r,[F_(Ia(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,_t.none())])}function jD(n,e,t,...r){n=De(n,Ye);let i=De(n.firestore,tt),s=Ia(i),o;return o=typeof(e=q(e))=="string"||e instanceof Fr?FD(s,"updateDoc",n._key,e,t,r):OD(s,"updateDoc",n._key,e),xl(i,[o.toMutation(n._key,_t.exists(!0))])}function qV(n){return xl(De(n.firestore,tt),[new Qs(n._key,_t.none())])}function zV(n,e){let t=De(n.firestore,tt),r=kh(n),i=V_(n.converter,e);return xl(t,[F_(Ia(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,_t.exists(!1))]).then(()=>r)}function Oh(n,...e){var t,r,i;n=q(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||HT(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(HT(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,d;if(n instanceof Ye)l=De(n.firestore,tt),d=Tl(n._key.path),c={next:h=>{e[o]&&e[o]($D(l,n,h))},error:e[o+1],complete:e[o+2]};else{let h=De(n,Yt);l=De(h.firestore,tt),d=h._query;let p=new vi(l);c={next:_=>{e[o]&&e[o](new Lr(l,p,h,_))},error:e[o+1],complete:e[o+2]},AV(n._query)}return function(p,_,w,S){let R=new Il(S),L=new bh(_,R,w);return p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return wD(yield El(p),L)})),()=>{R.$a(),p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return ID(yield El(p),L)}))}}(kt(l),d,a,c)}function GV(n,e){return fQ(kt(n=De(n,tt)),HT(e)?e:{next:e})}function xl(n,e){return function(r,i){let s=new Et;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return G7(yield xD(r),i,s)})),s.promise}(kt(n),e)}function $D(n,e,t){let r=t.docs.get(e._key),i=new vi(n);return new mr(n,i,e._key,r,new Gi(t.hasPendingWrites,t.fromCache),e.converter)}function B_(n){return wQ(n,{count:yQ()})}function wQ(n,e){let t=De(n.firestore,tt),r=kt(t),i=qK(e,(s,o)=>new PC(o,s.aggregateType,s._internalFieldPath));return hQ(r,n._query,i).then(s=>function(a,c,l){let d=new vi(a);return new GT(c,d,l)}(t,n,s))}var IQ={maxAttempts:5};var x_=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ia(e)}set(e,t,r){this._verifyNotCommitted();let i=Vs(e,this._firestore),s=V_(i.converter,t,r),o=F_(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,_t.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=Vs(e,this._firestore),o;return o=typeof(t=q(t))=="string"||t instanceof Fr?FD(this._dataReader,"WriteBatch.update",s._key,t,r,i):OD(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,_t.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Vs(e,this._firestore);return this._mutations=this._mutations.concat(new Qs(t._key,_t.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new F(O.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Vs(n,e){if((n=q(n)).firestore!==e)throw new F(O.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var iD=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Ia(t)}get(t){let r=Vs(t,this._firestore),i=new rD(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return X();let o=s[0];if(o.isFoundDocument())return new ya(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new ya(this._firestore,i,r._key,null,r.converter);throw X()})}set(t,r,i){let s=Vs(t,this._firestore),o=V_(s.converter,r,i),a=F_(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=Vs(t,this._firestore),a;return a=typeof(r=q(r))=="string"||r instanceof Fr?FD(this._dataReader,"Transaction.update",o._key,r,i,s):OD(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=Vs(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Vs(e,this._firestore),r=new vi(this._firestore);return super.get(e).then(i=>new mr(this._firestore,r,t._key,i._document,new Gi(!1,!1),t.converter))}};function WV(n,e,t){n=De(n,tt);let r=Object.assign(Object.assign({},IQ),t);return function(s){if(s.maxAttempts<1)throw new F(O.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new Et;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let l=yield rV(s);new UT(s.asyncQueue,l,a,o,c).Xa()})),c.promise}(kt(n),i=>e(new iD(n,i)),r)}function KV(){return new Dh("deleteField")}function QV(){return new QT("serverTimestamp")}function YV(...n){return new YT("arrayUnion",n)}function JV(...n){return new JT("arrayRemove",n)}function XV(n){return new XT("increment",n)}(function(e,t=!0){(function(i){Cl=i})(wn),vn(new $e("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new tt(new oC(r.getProvider("auth-internal")),new uC(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new F(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qs(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),wt(R1,"4.6.3",e),wt(R1,"4.6.3","esm2017")})();var EQ="@firebase/firestore-compat",bQ="0.3.32";function KD(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new F("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function ZV(){if(typeof Uint8Array>"u")throw new F("unimplemented","Uint8Arrays are not available in this environment.")}function e2(){if(!qF())throw new F("unimplemented","Blobs are unavailable in Firestore in this environment.")}var j_=class n{constructor(e){this._delegate=e}static fromBase64String(e){return e2(),new n(yi.fromBase64String(e))}static fromUint8Array(e){return ZV(),new n(yi.fromUint8Array(e))}toBase64(){return e2(),this._delegate.toBase64()}toUint8Array(){return ZV(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function HD(n){return CQ(n,["next","error","complete"])}function CQ(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var qD=class{enableIndexedDbPersistence(e,t){return hV(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return fV(e._delegate)}clearIndexedDbPersistence(e){return mV(e._delegate)}},$_=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof qs||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&fr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){cV(this._delegate,e,t,r)}enableNetwork(){return _V(this._delegate)}disableNetwork(){return yV(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,PD("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return gV(this._delegate)}onSnapshotsInSync(e){return GV(this._delegate,e)}get app(){if(!this._appCompat)throw new F("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ml(this,wi(this._delegate,e))}catch(t){throw bn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ii(this,kh(this._delegate,e))}catch(t){throw bn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Da(this,lV(this._delegate,e))}catch(t){throw bn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return WV(this._delegate,t=>e(new H_(this,t)))}batch(){return kt(this._delegate),new q_(new x_(this._delegate,e=>xl(this._delegate,e)))}loadBundle(e){return vV(this._delegate,e)}namedQuery(e){return wV(this._delegate,e).then(t=>t?new Da(this,t):null)}},Nl=class extends bl{constructor(e){super(),this.firestore=e}convertBytes(e){return new j_(new yi(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Ii.forKey(t,this.firestore,null)}};function TQ(n){xF(n)}var H_=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Nl(e)}get(e){let t=ba(e);return this._delegate.get(t).then(r=>new Ca(this._firestore,new mr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=ba(e);return r?(KD("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=ba(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=ba(e);return this._delegate.delete(t),this}},q_=class{constructor(e){this._delegate=e}set(e,t,r){let i=ba(e);return r?(KD("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=ba(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=ba(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Pl=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Bs(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ta(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new Nl(e),t),i.set(t,s)),s}};Pl.INSTANCES=new WeakMap;var Ii=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Nl(e)}static forPath(e,t,r){if(e.length%2!==0)throw new F("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Ye(t._delegate,r,new W(e)))}static forKey(e,t,r){return new n(t,new Ye(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ml(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ml(this.firestore,wi(this._delegate,e))}catch(t){throw bn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=q(e),e instanceof Ye?MD(this._delegate,e):!1}set(e,t){t=KD("DocumentReference.set",t);try{return t?BD(this._delegate,e,t):BD(this._delegate,e)}catch(r){throw bn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?jD(this._delegate,e):jD(this._delegate,e,t,...r)}catch(i){throw bn(i,"updateDoc()","DocumentReference.update()")}}delete(){return qV(this._delegate)}onSnapshot(...e){let t=t2(e),r=n2(e,i=>new Ca(this.firestore,new mr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Oh(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=BV(this._delegate):e?.source==="server"?t=jV(this._delegate):t=UV(this._delegate),t.then(r=>new Ca(this.firestore,new mr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Pl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function bn(n,e,t){return n.message=n.message.replace(e,t),n}function t2(n){for(let e of n)if(typeof e=="object"&&!HD(e))return e;return{}}function n2(n,e){var t,r;let i;return HD(n[0])?i=n[0]:HD(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Ca=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ii(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return UD(this._delegate,e._delegate)}},Ta=class extends Ca{data(e){let t=this._delegate.data(e);return this._delegate._converter||NF(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Da=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Nl(e)}where(e,t,r){try{return new n(this.firestore,Xi(this._delegate,RV(e,t,r)))}catch(i){throw bn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Xi(this._delegate,xV(e,t)))}catch(r){throw bn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Xi(this._delegate,NV(e)))}catch(t){throw bn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Xi(this._delegate,PV(e)))}catch(t){throw bn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Xi(this._delegate,MV(...e)))}catch(t){throw bn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Xi(this._delegate,kV(...e)))}catch(t){throw bn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Xi(this._delegate,OV(...e)))}catch(t){throw bn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Xi(this._delegate,FV(...e)))}catch(t){throw bn(t,"endAt()","Query.endAt()")}}isEqual(e){return kD(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=$V(this._delegate):e?.source==="server"?t=HV(this._delegate):t=U_(this._delegate),t.then(r=>new Fh(this.firestore,new Lr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=t2(e),r=n2(e,i=>new Fh(this.firestore,new Lr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Oh(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Pl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},zD=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ta(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Fh=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Da(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ta(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new zD(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Ta(this._firestore,r))})}isEqual(e){return UD(this._delegate,e._delegate)}},Ml=class n extends Da{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Ii(this.firestore,e):null}doc(e){try{return e===void 0?new Ii(this.firestore,kh(this._delegate)):new Ii(this.firestore,kh(this._delegate,e))}catch(t){throw bn(t,"doc()","CollectionReference.doc()")}}add(e){return zV(this._delegate,e).then(t=>new Ii(this.firestore,t))}isEqual(e){return MD(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Pl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ba(n){return De(n,Ye)}var GD=class n{constructor(...e){this._delegate=new Fr(...e)}static documentId(){return new n(bt.keyField().canonicalString())}isEqual(e){return e=q(e),e instanceof Fr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var WD=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=QV();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=KV();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=YV(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=JV(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=XV(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var DQ={Firestore:$_,GeoPoint:_a,Timestamp:lt,Blob:j_,Transaction:H_,WriteBatch:q_,DocumentReference:Ii,DocumentSnapshot:Ca,Query:Da,QueryDocumentSnapshot:Ta,QuerySnapshot:Fh,CollectionReference:Ml,FieldPath:GD,FieldValue:WD,setLogLevel:TQ,CACHE_SIZE_UNLIMITED:uV};function SQ(n,e){n.INTERNAL.registerComponent(new $e("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},DQ)))}function AQ(n){SQ(n,(e,t)=>new $_(e,t,new qD)),n.registerVersion(EQ,bQ)}AQ(G);var d2="firebasestorage.googleapis.com",h2="storageBucket",RQ=2*60*1e3,xQ=10*60*1e3,NQ=1e3;var ut=class n extends ft{constructor(e,t,r=0){super(QD(e),`Firebase Storage: ${t} (${QD(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return QD(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},it=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(it||{});function QD(n){return"storage/"+n}function rS(){let n="An unknown error occurred, please check the error payload for server response.";return new ut(it.UNKNOWN,n)}function PQ(n){return new ut(it.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function MQ(n){return new ut(it.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function kQ(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ut(it.UNAUTHENTICATED,n)}function OQ(){return new ut(it.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function FQ(n){return new ut(it.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function f2(){return new ut(it.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function p2(){return new ut(it.CANCELED,"User canceled the upload/download.")}function LQ(n){return new ut(it.INVALID_URL,"Invalid URL '"+n+"'.")}function VQ(n){return new ut(it.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function UQ(){return new ut(it.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+h2+"' property when initializing the app?")}function m2(){return new ut(it.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function BQ(){return new ut(it.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function jQ(){return new ut(it.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function $Q(n){return new ut(it.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Sa(n){return new ut(it.INVALID_ARGUMENT,n)}function g2(){return new ut(it.APP_DELETED,"The Firebase app was deleted.")}function iS(n){return new ut(it.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Vh(n,e){return new ut(it.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Lh(n){throw new ut(it.INTERNAL_ERROR,"Internal error: "+n)}var Cn=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw VQ(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(J){J.path.charAt(J.path.length-1)==="/"&&(J.path_=J.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(J){J.path_=decodeURIComponent(J.path)}let d="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",_=new RegExp(`^https?://${h}/${d}/b/${i}/o${p}`,"i"),w={bucket:1,path:3},S=t===d2?"(?:storage.googleapis.com|storage.cloud.google.com)":t,R="([^?#]*)",L=new RegExp(`^https?://${S}/${i}/${R}`,"i"),B=[{regex:a,indices:c,postModify:s},{regex:_,indices:w,postModify:l},{regex:L,indices:{bucket:1,path:2},postModify:l}];for(let J=0;J<B.length;J++){let ce=B[J],ee=ce.regex.exec(e);if(ee){let b=ee[ce.indices.bucket],v=ee[ce.indices.path];v||(v=""),r=new n(b,v),ce.postModify(r);break}}if(r==null)throw LQ(e);return r}},JD=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function HQ(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...R){l||(l=!0,e.apply(null,R))}function h(R){i=setTimeout(()=>{i=null,n(_,c())},R)}function p(){s&&clearTimeout(s)}function _(R,...L){if(l){p();return}if(R){p(),d.call(null,R,...L);return}if(c()||o){p(),d.call(null,R,...L);return}r<64&&(r*=2);let B;a===1?(a=2,B=0):B=(r+Math.random())*1e3,h(B)}let w=!1;function S(R){w||(w=!0,p(),!l&&(i!==null?(R||(a=2),clearTimeout(i),h(0)):R||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,S(!0)},t),S}function qQ(n){n(!1)}function zQ(n){return n!==void 0}function GQ(n){return typeof n=="function"}function WQ(n){return typeof n=="object"&&!Array.isArray(n)}function W_(n){return typeof n=="string"||n instanceof String}function r2(n){return sS()&&n instanceof Blob}function sS(){return typeof Blob<"u"}function XD(n,e,t,r){if(r<e)throw Sa(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Sa(`Invalid value for '${n}'. Expected ${t} or less.`)}function eo(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function _2(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Fl=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Fl||{});function y2(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var ZD=class{constructor(e,t,r,i,s,o,a,c,l,d,h,p=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,w)=>{this.resolve_=_,this.reject_=w,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Ol(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Fl.NO_ERROR,c=s.getStatus();if(!a||y2(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===Fl.ABORT;r(!1,new Ol(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new Ol(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());zQ(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=rS();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?g2():p2();o(c)}else{let c=f2();o(c)}};this.canceled_?t(!1,new Ol(!1,null,!0)):this.backoffId_=HQ(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&qQ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Ol=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function KQ(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function QQ(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function YQ(n,e){e&&(n["X-Firebase-GMPID"]=e)}function JQ(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function XQ(n,e,t,r,i,s,o=!0){let a=_2(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return YQ(l,e),KQ(l,t),QQ(l,s),JQ(l,r),new ZD(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function ZQ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function eY(...n){let e=ZQ();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(sS())return new Blob(n);throw new ut(it.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function tY(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function nY(n){if(typeof atob>"u")throw $Q("base-64");return atob(n)}var Yn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Uh=class{constructor(e,t){this.data=e,this.contentType=t||null}};function oS(n,e){switch(n){case Yn.RAW:return new Uh(v2(e));case Yn.BASE64:case Yn.BASE64URL:return new Uh(w2(n,e));case Yn.DATA_URL:return new Uh(iY(e),sY(e))}throw rS()}function v2(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function rY(n){let e;try{e=decodeURIComponent(n)}catch{throw Vh(Yn.DATA_URL,"Malformed data URL.")}return v2(e)}function w2(n,e){switch(n){case Yn.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Vh(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Yn.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Vh(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=nY(e)}catch(i){throw i.message.includes("polyfill")?i:Vh(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var G_=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw Vh(Yn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=oY(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function iY(n){let e=new G_(n);return e.base64?w2(Yn.BASE64,e.rest):rY(e.rest)}function sY(n){return new G_(n).contentType}function oY(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var Ll=class n{constructor(e,t){let r=0,i="";r2(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(r2(this.data_)){let r=this.data_,i=tY(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(sS()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(eY.apply(null,t))}else{let t=e.map(o=>W_(o)?oS(Yn.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function aS(n){let e;try{e=JSON.parse(n)}catch{return null}return WQ(e)?e:null}function aY(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function cY(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function I2(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function lY(n,e){return e}var Jt=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||lY}},z_=null;function uY(n){return!W_(n)||n.length<2?n:I2(n)}function K_(){if(z_)return z_;let n=[];n.push(new Jt("bucket")),n.push(new Jt("generation")),n.push(new Jt("metageneration")),n.push(new Jt("name","fullPath",!0));function e(s,o){return uY(o)}let t=new Jt("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new Jt("size");return i.xform=r,n.push(i),n.push(new Jt("timeCreated")),n.push(new Jt("updated")),n.push(new Jt("md5Hash",null,!0)),n.push(new Jt("cacheControl",null,!0)),n.push(new Jt("contentDisposition",null,!0)),n.push(new Jt("contentEncoding",null,!0)),n.push(new Jt("contentLanguage",null,!0)),n.push(new Jt("contentType",null,!0)),n.push(new Jt("metadata","customMetadata",!0)),z_=n,z_}function dY(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new Cn(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function hY(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return dY(r,n),r}function E2(n,e,t){let r=aS(e);return r===null?null:hY(n,r,t)}function fY(n,e,t,r){let i=aS(e);if(i===null||!W_(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=n.bucket,h=n.fullPath,p="/b/"+o(d)+"/o/"+o(h),_=eo(p,t,r),w=_2({alt:"media",token:l});return _+w})[0]}function cS(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var i2="prefixes",s2="items";function pY(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[i2])for(let i of t[i2]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new Cn(e,s));r.prefixes.push(o)}if(t[s2])for(let i of t[s2]){let s=n._makeStorageReference(new Cn(e,i.name));r.items.push(s)}return r}function mY(n,e,t){let r=aS(t);return r===null?null:pY(n,e,r)}var Vr=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function bi(n){if(!n)throw rS()}function Q_(n,e){function t(r,i){let s=E2(n,i,e);return bi(s!==null),s}return t}function gY(n,e){function t(r,i){let s=mY(n,e,i);return bi(s!==null),s}return t}function _Y(n,e){function t(r,i){let s=E2(n,i,e);return bi(s!==null),fY(s,i,n.host,n._protocol)}return t}function Bl(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=OQ():i=kQ():t.getStatus()===402?i=MQ(n.bucket):t.getStatus()===403?i=FQ(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Y_(n){let e=Bl(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=PQ(n.path)),s.serverResponse=i.serverResponse,s}return t}function b2(n,e,t){let r=e.fullServerUrl(),i=eo(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Vr(i,s,Q_(n,t),o);return a.errorHandler=Y_(e),a}function yY(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=eo(o,n.host,n._protocol),c="GET",l=n.maxOperationRetryTime,d=new Vr(a,c,gY(n,e.bucket),l);return d.urlParams=s,d.errorHandler=Bl(e),d}function vY(n,e,t){let r=e.fullServerUrl(),i=eo(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Vr(i,s,_Y(n,t),o);return a.errorHandler=Y_(e),a}function wY(n,e,t,r){let i=e.fullServerUrl(),s=eo(i,n.host,n._protocol),o="PATCH",a=cS(t,r),c={"Content-Type":"application/json; charset=utf-8"},l=n.maxOperationRetryTime,d=new Vr(s,o,Q_(n,r),l);return d.headers=c,d.body=a,d.errorHandler=Y_(e),d}function IY(n,e){let t=e.fullServerUrl(),r=eo(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,l){}let a=new Vr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=Y_(e),a}function EY(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function C2(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=EY(null,e)),r}function bY(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let B="";for(let J=0;J<2;J++)B=B+Math.random().toString().slice(2);return B}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let l=C2(e,r,i),d=cS(l,t),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,p=`\r
--`+c+"--",_=Ll.getBlob(h,r,p);if(_===null)throw m2();let w={name:l.fullPath},S=eo(s,n.host,n._protocol),R="POST",L=n.maxUploadRetryTime,K=new Vr(S,R,Q_(n,t),L);return K.urlParams=w,K.headers=o,K.body=_.uploadData(),K.errorHandler=Bl(e),K}var Vl=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function lS(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{bi(!1)}return bi(!!t&&(e||["active"]).indexOf(t)!==-1),t}function CY(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=C2(e,r,i),a={name:o.fullPath},c=eo(s,n.host,n._protocol),l="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=cS(o,t),p=n.maxUploadRetryTime;function _(S){lS(S);let R;try{R=S.getResponseHeader("X-Goog-Upload-URL")}catch{bi(!1)}return bi(W_(R)),R}let w=new Vr(c,l,_,p);return w.urlParams=a,w.headers=d,w.body=h,w.errorHandler=Bl(e),w}function TY(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(l){let d=lS(l,["active","final"]),h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{bi(!1)}h||bi(!1);let p=Number(h);return bi(!isNaN(p)),new Vl(p,r.size(),d==="final")}let o="POST",a=n.maxUploadRetryTime,c=new Vr(t,o,s,a);return c.headers=i,c.errorHandler=Bl(e),c}var o2=256*1024;function DY(n,e,t,r,i,s,o,a){let c=new Vl(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw BQ();let l=c.total-c.current,d=l;i>0&&(d=Math.min(d,i));let h=c.current,p=h+d,_="";d===0?_="finalize":l===d?_="upload, finalize":_="upload";let w={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${c.current}`},S=r.slice(h,p);if(S===null)throw m2();function R(J,ce){let ee=lS(J,["active","final"]),b=c.current+d,v=r.size(),I;return ee==="final"?I=Q_(e,s)(J,ce):I=null,new Vl(b,v,ee==="final",I)}let L="POST",K=e.maxUploadRetryTime,B=new Vr(t,L,R,K);return B.headers=w,B.body=S.uploadData(),B.progressCallback=a||null,B.errorHandler=Bl(n),B}var T2={STATE_CHANGED:"state_changed"},hn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function YD(n){switch(n){case"running":case"pausing":case"canceling":return hn.RUNNING;case"paused":return hn.PAUSED;case"success":return hn.SUCCESS;case"canceled":return hn.CANCELED;case"error":return hn.ERROR;default:return hn.ERROR}}var eS=class{constructor(e,t,r){if(GQ(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function kl(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var a2=null,tS=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Fl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Fl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Fl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw Lh("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Lh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Lh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Lh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Lh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},nS=class extends tS{initXhr(){this.xhr_.responseType="text"}};function Ei(){return a2?a2():new nS}var Bh=class{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=K_(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(it.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(y2(i.status,[]))if(s)i=f2();else{this.sleepTime=Math.max(this.sleepTime*2,NQ),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(it.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=CY(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=TY(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Ei,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=o2*this._chunkMultiplier,t=new Vl(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=DY(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,Ei,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){o2*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=b2(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=bY(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=p2(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=YD(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new eS(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(YD(this._state)){case hn.SUCCESS:kl(this._resolve.bind(null,this.snapshot))();break;case hn.CANCELED:case hn.ERROR:let t=this._reject;kl(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(YD(this._state)){case hn.RUNNING:case hn.PAUSED:e.next&&kl(e.next.bind(e,this.snapshot))();break;case hn.SUCCESS:e.complete&&kl(e.complete.bind(e))();break;case hn.CANCELED:case hn.ERROR:e.error&&kl(e.error.bind(e,this._error))();break;default:e.error&&kl(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var Ul=class n{constructor(e,t){this._service=e,t instanceof Cn?this._location=t:this._location=Cn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Cn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return I2(this._location.path)}get storage(){return this._service}get parent(){let e=aY(this._location.path);if(e===null)return null;let t=new Cn(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw iS(e)}};function SY(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new Bh(n,new Ll(e),t)}function AY(n){let e={prefixes:[],items:[]};return D2(n,e).then(()=>e)}function D2(n,e,t){return g(this,null,function*(){let i=yield S2(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield D2(n,e,i.nextPageToken))})}function S2(n,e){e!=null&&typeof e.maxResults=="number"&&XD("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=yY(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Ei)}function RY(n){n._throwIfRoot("getMetadata");let e=b2(n.storage,n._location,K_());return n.storage.makeRequestWithTokens(e,Ei)}function xY(n,e){n._throwIfRoot("updateMetadata");let t=wY(n.storage,n._location,e,K_());return n.storage.makeRequestWithTokens(t,Ei)}function NY(n){n._throwIfRoot("getDownloadURL");let e=vY(n.storage,n._location,K_());return n.storage.makeRequestWithTokens(e,Ei).then(t=>{if(t===null)throw jQ();return t})}function PY(n){n._throwIfRoot("deleteObject");let e=IY(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Ei)}function A2(n,e){let t=cY(n._location.path,e),r=new Cn(n._location.bucket,t);return new Ul(n.storage,r)}function MY(n){return/^[A-Za-z]+:\/\//.test(n)}function kY(n,e){return new Ul(n,e)}function R2(n,e){if(n instanceof jh){let t=n;if(t._bucket==null)throw UQ();let r=new Ul(t,t._bucket);return e!=null?R2(r,e):r}else return e!==void 0?A2(n,e):n}function OY(n,e){if(e&&MY(e)){if(n instanceof jh)return kY(n,e);throw Sa("To use ref(service, url), the first argument must be a Storage instance.")}else return R2(n,e)}function c2(n,e){let t=e?.[h2];return t==null?null:Cn.makeFromBucketSpec(t,n)}function FY(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:Mc(i,n.app.options.projectId))}var jh=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=d2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=RQ,this._maxUploadRetryTime=xQ,this._requests=new Set,i!=null?this._bucket=Cn.makeFromBucketSpec(i,this._host):this._bucket=c2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Cn.makeFromBucketSpec(this._url,e):this._bucket=c2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){XD("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){XD("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return g(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return g(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ul(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new JD(g2());{let o=XQ(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return g(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},l2="@firebase/storage",u2="0.12.5";var LY="storage";function J_(n,e,t){return n=q(n),SY(n,e,t)}function x2(n){return n=q(n),RY(n)}function N2(n,e){return n=q(n),xY(n,e)}function P2(n,e){return n=q(n),S2(n,e)}function M2(n){return n=q(n),AY(n)}function X_(n){return n=q(n),NY(n)}function Z_(n){return n=q(n),PY(n)}function Aa(n,e){return n=q(n),OY(n,e)}function k2(n,e){return A2(n,e)}function O2(n,e,t,r={}){FY(n,e,t,r)}function VY(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new jh(t,r,i,e,wn)}function UY(){vn(new $e(LY,VY,"PUBLIC").setMultipleInstances(!0)),wt(l2,u2,""),wt(l2,u2,"esm2017")}UY();var jl=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var ey=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new jl(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new jl(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new jl(o,this,this._ref)):s={next:t.next?o=>t.next(new jl(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},ty=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Ra(e,this._service))}get items(){return this._delegate.items.map(e=>new Ra(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var Ra=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=k2(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new ey(J_(this._delegate,e,t),this)}putString(e,t=Yn.RAW,r){this._throwIfRoot("putString");let i=oS(t,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new ey(new Bh(this._delegate,new Ll(i.data,!0),s),this)}listAll(){return M2(this._delegate).then(e=>new ty(e,this.storage))}list(e){return P2(this._delegate,e||void 0).then(t=>new ty(t,this.storage))}getMetadata(){return x2(this._delegate)}updateMetadata(e){return N2(this._delegate,e)}getDownloadURL(){return X_(this._delegate)}delete(){return this._throwIfRoot("delete"),Z_(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw iS(e)}};var ny=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(F2(e))throw Sa("ref() expected a child path but got a URL, use refFromURL instead.");return new Ra(Aa(this._delegate,e),this)}refFromURL(e){if(!F2(e))throw Sa("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Cn.makeFromUrl(e,this._delegate.host)}catch{throw Sa("refFromUrl() expected a valid full URL but got an invalid one.")}return new Ra(Aa(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){O2(this._delegate,e,t,r)}};function F2(n){return/^[A-Za-z]+:\/\//.test(n)}var BY="@firebase/storage-compat",jY="0.3.8";var $Y="storage-compat";function HY(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new ny(t,r)}function qY(n){let e={TaskState:hn,TaskEvent:T2,StringFormat:Yn,Storage:ny,Reference:Ra};n.INTERNAL.registerComponent(new $e($Y,HY,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(BY,jY)}qY(G);var L2="@firebase/database",V2="1.0.5";var IA="";function EA(n){IA=n}var _S=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Dt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Nc(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var yS=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return yn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var mU=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new _S(e)}}catch{}return new yS},Na=mU("localStorage"),vS=mU("sessionStorage");var zl=new On("@firebase/database"),gU=function(){let n=1;return function(){return n++}}(),_U=function(n){let e=Zk(n),t=new Lm;t.update(e);let r=t.digest();return Vm.encodeByteArray(r)},hf=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=hf.apply(null,r):typeof r=="object"?e+=Dt(r):e+=r,e+=" "}return e},Pa=null,U2=!0,yU=function(n,e){j(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(zl.logLevel=ye.VERBOSE,Pa=zl.log.bind(zl),e&&vS.set("logging_enabled",!0)):typeof n=="function"?Pa=n:(Pa=null,vS.remove("logging_enabled"))},zt=function(...n){if(U2===!0&&(U2=!1,Pa===null&&vS.get("logging_enabled")===!0&&yU(!0)),Pa){let e=hf.apply(null,n);Pa(e)}},ff=function(n){return function(...e){zt(n,...e)}},wS=function(...n){let e="FIREBASE INTERNAL ERROR: "+hf(...n);zl.error(e)},Di=function(...n){let e=`FIREBASE FATAL ERROR: ${hf(...n)}`;throw zl.error(e),new Error(e)},fn=function(...n){let e="FIREBASE WARNING: "+hf(...n);zl.warn(e)},zY=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&fn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},xy=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},GY=function(n){if(ni()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},io="[MIN_NAME]",Zi="[MAX_NAME]",ka=function(n,e){if(n===e)return 0;if(n===io||e===Zi)return-1;if(e===io||n===Zi)return 1;{let t=B2(n),r=B2(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},WY=function(n,e){return n===e?0:n<e?-1:1},$h=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Dt(e))},bA=function(n){if(typeof n!="object"||n===null)return Dt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Dt(e[r]),t+=":",t+=bA(n[e[r]]);return t+="}",t},vU=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Gt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var wU=function(n){j(!xy(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),h="";for(c=0;c<64;c+=8){let p=parseInt(d.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),h=h+p}return h.toLowerCase()},KY=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},QY=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function YY(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var JY=new RegExp("^-?(0*)\\d{1,10}$"),XY=-2147483648,ZY=2147483647,B2=function(n){if(JY.test(n)){let e=Number(n);if(e>=XY&&e<=ZY)return e}return null},eu=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw fn("Exception was thrown by user callback.",t),e},Math.floor(0))}},eJ=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Gh=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var IS=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){fn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var ES=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(zt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',fn(e)}},Wh=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),iy="5",IU="v",EU="s",bU="r",CU="f",TU=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,DU="ls",SU="p",bS="ac",AU="websocket",RU="long_polling";var sy=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Na.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Na.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function tJ(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function xU(n,e,t){j(typeof e=="string","typeof type must == string"),j(typeof t=="object","typeof params must == object");let r;if(e===AU)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===RU)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);tJ(n)&&(t.ns=n.namespace);let i=[];return Gt(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var CS=class{constructor(){this.counters_={}}incrementCounter(e,t=1){yn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Wk(this.counters_)}};var uS={},dS={};function CA(n){let e=n.toString();return uS[e]||(uS[e]=new CS),uS[e]}function nJ(n,e){let t=n.toString();return dS[t]||(dS[t]=e()),dS[t]}var TS=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&eu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var j2="start",rJ="close",iJ="pLPCommand",sJ="pRTLPCB",NU="id",PU="pw",MU="ser",oJ="cb",aJ="seg",cJ="ts",lJ="d",uJ="dframe",kU=1870,OU=30,dJ=kU-OU,hJ=25e3,fJ=3e4,Jh=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ff(e),this.stats_=CA(t),this.urlFn=c=>(this.appCheckToken&&(c[bS]=this.appCheckToken),xU(t,RU,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new TS(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(fJ)),GY(()=>{if(this.isClosed_)return;this.scriptTagHolder=new DS((...s)=>{let[o,a,c,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===j2)this.id=a,this.password=c;else if(o===rJ)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[j2]="t",r[MU]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[oJ]=this.scriptTagHolder.uniqueCallbackIdentifier),r[IU]=iy,this.transportSessionId&&(r[EU]=this.transportSessionId),this.lastSessionId&&(r[DU]=this.lastSessionId),this.applicationId&&(r[SU]=this.applicationId),this.appCheckToken&&(r[bS]=this.appCheckToken),typeof location<"u"&&location.hostname&&TU.test(location.hostname)&&(r[bU]=CU);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return ni()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!KY()&&!QY()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=Dt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=qE(t),i=vU(r,dJ);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(ni())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[uJ]="t",r[NU]=e,r[PU]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=Dt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},DS=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ni())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=gU(),window[iJ+this.uniqueCallbackIdentifier]=e,window[sJ+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){zt("frame writing exception"),a.stack&&zt(a.stack),zt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||zt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[NU]=this.myID,e[PU]=this.myPW,e[MU]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+OU+r.length<=kU;){let o=this.pendingSegs.shift();r=r+"&"+aJ+i+"="+o.seg+"&"+cJ+i+"="+o.ts+"&"+lJ+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(hJ)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){ni()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{zt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var pJ=16384,mJ=45e3,oy=null;typeof MozWebSocket<"u"?oy=MozWebSocket:typeof WebSocket<"u"&&(oy=WebSocket);var Hl=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ff(this.connId),this.stats_=CA(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[IU]=iy,!ni()&&typeof location<"u"&&location.hostname&&TU.test(location.hostname)&&(a[bU]=CU),r&&(a[EU]=r),i&&(a[DU]=i),s&&(a[bS]=s),o&&(a[SU]=o),xU(t,AU,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Na.set("previous_websocket_failure",!0);try{let i;if(ni()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${iy}/${IA}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new oy(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&oy!==null&&!n.forceDisallow_}static previouslyFailed(){return Na.isInMemoryStorage||Na.get("previous_websocket_failure")===!0}markConnectionHealthy(){Na.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Nc(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(j(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=Dt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=vU(r,pJ);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(mJ))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),FU=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Jh,Hl]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=Hl&&Hl.isAvailable(),i=r&&!Hl.previouslyFailed();if(t.webSocketOnly&&(r||fn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Hl];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),gJ=6e4,_J=5e3,yJ=10*1024,vJ=100*1024,hS="t",$2="d",wJ="s",H2="r",IJ="e",q2="o",z2="a",G2="n",W2="p",EJ="h",SS=class{constructor(e,t,r,i,s,o,a,c,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ff("c:"+this.id+":"),this.transportManager_=new FU(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Gh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>vJ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>yJ?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(hS in e){let t=e[hS];t===z2?this.upgradeIfSecondaryHealthy_():t===H2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===q2&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=$h("t",e),r=$h("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:W2,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:z2,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:G2,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=$h("t",e),r=$h("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=$h(hS,e);if($2 in e){let r=e[$2];if(t===EJ){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===G2){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===wJ?this.onConnectionShutdown_(r):t===H2?this.onReset_(r):t===IJ?wS("Server Error: "+r):t===q2?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):wS("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),iy!==r&&fn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Gh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(gJ))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Gh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(_J))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:W2,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Na.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var ay=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var cy=class{constructor(e){this.allowedEvents_=e,this.listeners_={},j(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){j(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var ly=class n extends cy{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!wd()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return j(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var K2=32,Q2=768,Fe=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Oe(){return new Fe("")}function ve(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function so(n){return n.pieces_.length-n.pieceNum_}function We(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Fe(n.pieces_,e)}function TA(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function bJ(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Xh(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function LU(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Fe(e,0)}function st(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Fe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Fe(t,0)}function we(n){return n.pieceNum_>=n.pieces_.length}function Tn(n,e){let t=ve(n),r=ve(e);if(t===null)return e;if(t===r)return Tn(We(n),We(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function CJ(n,e){let t=Xh(n,0),r=Xh(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=ka(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function DA(n,e){if(so(n)!==so(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function gr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(so(n)>so(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var AS=class{constructor(e,t){this.errorPrefix_=t,this.parts_=Xh(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Ed(this.parts_[r]);VU(this)}};function TJ(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Ed(e),VU(n)}function DJ(n){let e=n.parts_.pop();n.byteLength_-=Ed(e),n.parts_.length>0&&(n.byteLength_-=1)}function VU(n){if(n.byteLength_>Q2)throw new Error(n.errorPrefix_+"has a key path longer than "+Q2+" bytes ("+n.byteLength_+").");if(n.parts_.length>K2)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+K2+") or object contains a cycle "+xa(n))}function xa(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var RS=class n extends cy{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return j(e==="visible","Unknown event type: "+e),[this.visible_]}};var Hh=1e3,SJ=60*5*1e3,Y2=30*1e3,AJ=1.3,RJ=3e4,xJ="server_kill",J2=3,SA=(()=>{class n extends ay{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=ff("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Hh,this.maxReconnectDelay_=SJ,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!ni())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");RS.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&ly.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(Dt(o)),j(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new Vt,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),j(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),j(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,d=c.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&yn(t,"w")){let i=bs(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();fn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||Xk(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Y2)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=Jk(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),j(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Dt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):wS("Unrecognized action received from server: "+Dt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){j(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Hh,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Hh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>RJ&&(this.reconnectDelay_=Hh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*AJ)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},d=function(p){j(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(p)};this.realtime_={close:l,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[p,_]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?zt("getToken() completed but was canceled"):(zt("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=_&&_.token,c=new SS(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,w=>{fn(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(xJ)},o))}catch(p){this.log_("Failed to get token: "+p),a||(this.repoInfo_.nodeAdmin&&fn(p),l())}}})}interrupt(t){zt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){zt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],kc(this.interruptReasons_)&&(this.reconnectDelay_=Hh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>bA(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new Fe(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){zt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=J2&&(this.reconnectDelay_=Y2,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){zt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=J2&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";ni()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+IA.replace(/\./g,"-")]=1,wd()?t["framework.cordova"]=1:Vo()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=ly.getInstance().currentlyOnline();return kc(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),Ee=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Gl=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new Ee(io,e),i=new Ee(io,t);return this.compare(r,i)!==0}minPost(){return Ee.MIN}};var ry,uy=class extends Gl{static get __EMPTY_NODE(){return ry}static set __EMPTY_NODE(e){ry=e}compare(e,t){return ka(e.name,t.name)}isDefinedOn(e){throw Lo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ee.MIN}maxPost(){return new Ee(Zi,ry)}makePost(e,t){return j(typeof e=="string","KeyIndex indexValue must always be a string."),new Ee(e,ry)}toString(){return".key"}},Ti=new uy;var ql=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Ur=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??_r.EMPTY_NODE,this.right=o??_r.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return _r.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return _r.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),xS=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new Ur(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},_r=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ur.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ur.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ql(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new ql(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new ql(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new ql(this.root_,null,this.comparator_,!0,e)}};_r.EMPTY_NODE=new xS;function NJ(n,e){return ka(n.name,e.name)}function AA(n,e){return ka(n,e)}var NS;function PJ(n){NS=n}var UU=function(n){return typeof n=="number"?"number:"+wU(n):"string:"+n},BU=function(n){if(n.isLeafNode()){let e=n.val();j(typeof e=="string"||typeof e=="number"||typeof e=="object"&&yn(e,".sv"),"Priority must be a string or number.")}else j(n===NS||n.isEmpty(),"priority of unexpected type.");j(n===NS||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var X2,Wl=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,j(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),BU(this.priorityNode_)}static set __childrenNodeConstructor(t){X2=t}static get __childrenNodeConstructor(){return X2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return we(t)?this:ve(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=ve(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(j(i!==".priority"||so(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(We(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+UU(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=wU(this.value_):t+=this.value_,this.lazyHash_=_U(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(j(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return j(s>=0,"Unknown leaf type: "+r),j(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),jU,$U;function MJ(n){jU=n}function kJ(n){$U=n}var PS=class extends Gl{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?ka(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ee.MIN}maxPost(){return new Ee(Zi,new Wl("[PRIORITY-POST]",$U))}makePost(e,t){let r=jU(e);return new Ee(t,new Wl("[PRIORITY-POST]",r))}toString(){return".priority"}},Je=new PS;var OJ=Math.log(2),MS=class{constructor(e){let t=s=>parseInt(Math.log(s)/OJ,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},dy=function(n,e,t,r){n.sort(e);let i=function(c,l){let d=l-c,h,p;if(d===0)return null;if(d===1)return h=n[c],p=t?t(h):h,new Ur(p,h.node,Ur.BLACK,null,null);{let _=parseInt(d/2,10)+c,w=i(c,_),S=i(_+1,l);return h=n[_],p=t?t(h):h,new Ur(p,h.node,Ur.BLACK,w,S)}},s=function(c){let l=null,d=null,h=n.length,p=function(w,S){let R=h-w,L=h;h-=w;let K=i(R+1,L),B=n[R],J=t?t(B):B;_(new Ur(J,B.node,S,null,K))},_=function(w){l?(l.left=w,l=w):(d=w,l=w)};for(let w=0;w<c.count;++w){let S=c.nextBitIsOne(),R=Math.pow(2,c.count-(w+1));S?p(R,Ur.BLACK):(p(R,Ur.BLACK),p(R,Ur.RED))}return d},o=new MS(n.length),a=s(o);return new _r(r||e,a)};var fS,$l={},Kl=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return j($l&&Je,"ChildrenNode.ts has not been loaded"),fS=fS||new n({".priority":$l},{".priority":Je}),fS}get(e){let t=bs(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof _r?t:null}hasIndex(e){return yn(this.indexSet_,e.toString())}addIndex(e,t){j(e!==Ti,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(Ee.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=dy(r,e.getCompare()):a=$l;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,l)}addToIndexes(e,t){let r=Id(this.indexes_,(i,s)=>{let o=bs(this.indexSet_,s);if(j(o,"Missing index implementation for "+s),i===$l)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(Ee.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),dy(a,o.getCompare())}else return $l;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new Ee(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Id(this.indexes_,i=>{if(i===$l)return i;{let s=t.get(e.name);return s?i.remove(new Ee(e.name,s)):i}});return new n(r,this.indexSet_)}};var qh,me=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&BU(this.priorityNode_),this.children_.isEmpty()&&j(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return qh||(qh=new n(new _r(AA),null,Kl.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||qh}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?qh:r}}getChild(t){let r=ve(t);return r===null?this:this.getImmediateChild(r).getChild(We(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(j(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new Ee(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?qh:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=ve(t);if(i===null)return r;{j(ve(t)!==".priority"||so(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(We(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Je,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+UU(this.getPriority().val())+":"),this.forEachChild(Je,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":_U(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new Ee(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new Ee(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new Ee(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,Ee.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,Ee.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===pf?-1:0}withIndex(t){if(t===Ti||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Ti||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Je),s=r.getIterator(Je),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===Ti?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),kS=class extends me{constructor(){super(new _r(AA),me.EMPTY_NODE,Kl.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return me.EMPTY_NODE}isEmpty(){return!1}},pf=new kS;Object.defineProperties(Ee,{MIN:{value:new Ee(io,me.EMPTY_NODE)},MAX:{value:new Ee(Zi,pf)}});uy.__EMPTY_NODE=me.EMPTY_NODE;Wl.__childrenNodeConstructor=me;PJ(pf);kJ(pf);var FJ=!0;function dt(n,e=null){if(n===null)return me.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),j(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Wl(t,dt(e))}if(!(n instanceof Array)&&FJ){let t=[],r=!1;if(Gt(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=dt(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Ee(o,c)))}}),t.length===0)return me.EMPTY_NODE;let s=dy(t,NJ,o=>o.name,AA);if(r){let o=dy(t,Je.getCompare());return new me(s,dt(e),new Kl({".priority":o},{".priority":Je}))}else return new me(s,dt(e),Kl.Default)}else{let t=me.EMPTY_NODE;return Gt(n,(r,i)=>{if(yn(n,r)&&r.substring(0,1)!=="."){let s=dt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(dt(e))}}MJ(dt);var Zh=class extends Gl{constructor(e){super(),this.indexPath_=e,j(!we(e)&&ve(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?ka(e.name,t.name):s}makePost(e,t){let r=dt(e),i=me.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ee(t,i)}maxPost(){let e=me.EMPTY_NODE.updateChild(this.indexPath_,pf);return new Ee(Zi,e)}toString(){return Xh(this.indexPath_,0).join("/")}};var OS=class extends Gl{compare(e,t){let r=e.node.compareTo(t.node);return r===0?ka(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ee.MIN}maxPost(){return Ee.MAX}makePost(e,t){let r=dt(e);return new Ee(t,r)}toString(){return".value"}},RA=new OS;function HU(n){return{type:"value",snapshotNode:n}}function Ql(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function ef(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function tf(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function LJ(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var nf=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){j(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(ef(t,a)):j(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ql(t,r)):o.trackChildChange(tf(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Je,(i,s)=>{t.hasChild(i)||r.trackChildChange(ef(i,s))}),t.isLeafNode()||t.forEachChild(Je,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(tf(i,s,o))}else r.trackChildChange(Ql(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?me.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var hy=class n{constructor(e){this.indexedFilter_=new nf(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new Ee(t,r))||(r=me.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=me.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(me.EMPTY_NODE);let s=this;return t.forEachChild(Je,(o,a)=>{s.matches(new Ee(o,a))||(i=i.updateImmediateChild(o,me.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var FS=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new hy(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new Ee(t,r))||(r=me.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=me.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=me.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(me.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,me.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(p,_)=>h(_,p)}else o=this.index_.getCompare();let a=e;j(a.numChildren()===this.limit_,"");let c=new Ee(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(t)){let h=a.getImmediateChild(t),p=i.getChildAfterChild(this.index_,l,this.reverse_);for(;p!=null&&(p.name===t||a.hasChild(p.name));)p=i.getChildAfterChild(this.index_,p,this.reverse_);let _=p==null?1:o(p,c);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(tf(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(ef(t,h));let S=a.updateImmediateChild(t,me.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(s?.trackChildChange(Ql(p.name,p.node)),S.updateImmediateChild(p.name,p.node)):S}}else return r.isEmpty()?e:d&&o(l,c)>=0?(s!=null&&(s.trackChildChange(ef(l.name,l.node)),s.trackChildChange(Ql(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,me.EMPTY_NODE)):e}};var rf=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Je}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return j(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return j(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:io}hasEnd(){return this.endSet_}getIndexEndValue(){return j(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return j(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Zi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return j(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Je}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function VJ(n){return n.loadsAllData()?new nf(n.getIndex()):n.hasLimit()?new FS(n):new hy(n)}function UJ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function BJ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function LS(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function jJ(n,e,t){let r;return n.index_===Ti||t?r=LS(n,e,t):r=LS(n,e,Zi),r.startAfterSet_=!0,r}function VS(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function $J(n,e,t){let r;return n.index_===Ti||t?r=VS(n,e,t):r=VS(n,e,io),r.endBeforeSet_=!0,r}function Ny(n,e){let t=n.copy();return t.index_=e,t}function Z2(n){let e={};if(n.isDefault())return e;let t;if(n.index_===Je?t="$priority":n.index_===RA?t="$value":n.index_===Ti?t="$key":(j(n.index_ instanceof Zh,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Dt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=Dt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Dt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Dt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Dt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function eU(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Je&&(e.i=n.index_.toString()),e}var US=class n extends ay{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=ff("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(j(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=Z2(e._queryParams);this.restRequest_(s+".json",c,(l,d)=>{let h=d;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),bs(this.listens_,o)===a){let p;l?l===401?p="permission_denied":p="rest_error:"+l:p="ok",i(p,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=Z2(e._queryParams),r=e._path.toString(),i=new Vt;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Bi(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Nc(a.responseText)}catch{fn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&fn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var BS=class{constructor(){this.rootNode_=me.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function fy(){return{value:null,children:new Map}}function tu(n,e,t){if(we(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=ve(e);n.children.has(r)||n.children.set(r,fy());let i=n.children.get(r);e=We(e),tu(i,e,t)}}function jS(n,e){if(we(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(Je,(r,i)=>{tu(n,new Fe(r),i)}),jS(n,e)}}else if(n.children.size>0){let t=ve(e);return e=We(e),n.children.has(t)&&jS(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function $S(n,e,t){n.value!==null?t(e,n.value):HJ(n,(r,i)=>{let s=new Fe(e.toString()+"/"+r);$S(i,s,t)})}function HJ(n,e){n.children.forEach((t,r)=>{e(r,t)})}var HS=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Gt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var tU=10*1e3,qJ=30*1e3,zJ=5*60*1e3,qS=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new HS(e);let r=tU+(qJ-tU)*Math.random();Gh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Gt(e,(i,s)=>{s>0&&yn(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Gh(this.reportStats_.bind(this),Math.floor(Math.random()*2*zJ))}};var Ci=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Ci||{});function xA(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function NA(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function PA(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var zS=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ci.ACK_USER_WRITE,this.source=xA()}operationForChild(e){if(we(this.path)){if(this.affectedTree.value!=null)return j(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new Fe(e));return new n(Oe(),t,this.revert)}}else return j(ve(this.path)===e,"operationForChild called for unrelated child."),new n(We(this.path),this.affectedTree,this.revert)}};var py=class n{constructor(e,t){this.source=e,this.path=t,this.type=Ci.LISTEN_COMPLETE}operationForChild(e){return we(this.path)?new n(this.source,Oe()):new n(this.source,We(this.path))}};var Yl=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ci.OVERWRITE}operationForChild(e){return we(this.path)?new n(this.source,Oe(),this.snap.getImmediateChild(e)):new n(this.source,We(this.path),this.snap)}};var sf=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ci.MERGE}operationForChild(e){if(we(this.path)){let t=this.children.subtree(new Fe(e));return t.isEmpty()?null:t.value?new Yl(this.source,Oe(),t.value):new n(this.source,Oe(),t)}else return j(ve(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,We(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Si=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(we(e))return this.isFullyInitialized()&&!this.filtered_;let t=ve(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var GS=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function GJ(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(LJ(o.childName,o.snapshotNode))}),zh(n,i,"child_removed",e,r,t),zh(n,i,"child_added",e,r,t),zh(n,i,"child_moved",s,r,t),zh(n,i,"child_changed",e,r,t),zh(n,i,"value",e,r,t),i}function zh(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>KJ(n,a,c)),o.forEach(a=>{let c=WJ(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function WJ(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function KJ(n,e,t){if(e.childName==null||t.childName==null)throw Lo("Should only compare child_ events.");let r=new Ee(e.childName,e.snapshotNode),i=new Ee(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function Py(n,e){return{eventCache:n,serverCache:e}}function Kh(n,e,t,r){return Py(new Si(e,t,r),n.serverCache)}function qU(n,e,t,r){return Py(n.eventCache,new Si(e,t,r))}function my(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Ma(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var pS,QJ=()=>(pS||(pS=new _r(WY)),pS),Dn=class n{constructor(e,t=QJ()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Gt(e,(r,i)=>{t=t.set(new Fe(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Oe(),value:this.value};if(we(e))return null;{let r=ve(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(We(e),t);return s!=null?{path:st(new Fe(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(we(e))return this;{let t=ve(e),r=this.children.get(t);return r!==null?r.subtree(We(e)):new n(null)}}set(e,t){if(we(e))return new n(t,this.children);{let r=ve(e),s=(this.children.get(r)||new n(null)).set(We(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(we(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=ve(e),r=this.children.get(t);if(r){let i=r.remove(We(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(we(e))return this.value;{let t=ve(e),r=this.children.get(t);return r?r.get(We(e)):null}}setTree(e,t){if(we(e))return t;{let r=ve(e),s=(this.children.get(r)||new n(null)).setTree(We(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Oe(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(st(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Oe(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(we(e))return null;{let s=ve(e),o=this.children.get(s);return o?o.findOnPath_(We(e),st(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Oe(),t)}foreachOnPath_(e,t,r){if(we(e))return this;{this.value&&r(t,this.value);let i=ve(e),s=this.children.get(i);return s?s.foreachOnPath_(We(e),st(t,i),r):new n(null)}}foreach(e){this.foreach_(Oe(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(st(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Br=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new Dn(null))}};function Qh(n,e,t){if(we(e))return new Br(new Dn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Tn(i,e);return s=s.updateChild(o,t),new Br(n.writeTree_.set(i,s))}else{let i=new Dn(t),s=n.writeTree_.setTree(e,i);return new Br(s)}}}function WS(n,e,t){let r=n;return Gt(t,(i,s)=>{r=Qh(r,st(e,i),s)}),r}function nU(n,e){if(we(e))return Br.empty();{let t=n.writeTree_.setTree(e,new Dn(null));return new Br(t)}}function KS(n,e){return Oa(n,e)!=null}function Oa(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Tn(t.path,e)):null}function rU(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Je,(r,i)=>{e.push(new Ee(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Ee(r,i.value))}),e}function no(n,e){if(we(e))return n;{let t=Oa(n,e);return t!=null?new Br(new Dn(t)):new Br(n.writeTree_.subtree(e))}}function QS(n){return n.writeTree_.isEmpty()}function Jl(n,e){return zU(Oe(),n.writeTree_,e)}function zU(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(j(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=zU(st(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(st(n,".priority"),r)),t}}function My(n,e){return QU(e,n)}function YJ(n,e,t,r,i){j(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Qh(n.visibleWrites,e,t)),n.lastWriteId=r}function JJ(n,e,t,r){j(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=WS(n.visibleWrites,e,t),n.lastWriteId=r}function XJ(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function ZJ(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);j(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&eX(a,r.path)?i=!1:gr(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return tX(n),!0;if(r.snap)n.visibleWrites=nU(n.visibleWrites,r.path);else{let a=r.children;Gt(a,c=>{n.visibleWrites=nU(n.visibleWrites,st(r.path,c))})}return!0}else return!1}function eX(n,e){if(n.snap)return gr(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&gr(st(n.path,t),e))return!0;return!1}function tX(n){n.visibleWrites=GU(n.allWrites,nX,Oe()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function nX(n){return n.visible}function GU(n,e,t){let r=Br.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)gr(t,o)?(a=Tn(t,o),r=Qh(r,a,s.snap)):gr(o,t)&&(a=Tn(o,t),r=Qh(r,Oe(),s.snap.getChild(a)));else if(s.children){if(gr(t,o))a=Tn(t,o),r=WS(r,a,s.children);else if(gr(o,t))if(a=Tn(o,t),we(a))r=WS(r,Oe(),s.children);else{let c=bs(s.children,ve(a));if(c){let l=c.getChild(We(a));r=Qh(r,Oe(),l)}}}else throw Lo("WriteRecord should have .snap or .children")}}return r}function WU(n,e,t,r,i){if(!r&&!i){let s=Oa(n.visibleWrites,e);if(s!=null)return s;{let o=no(n.visibleWrites,e);if(QS(o))return t;if(t==null&&!KS(o,Oe()))return null;{let a=t||me.EMPTY_NODE;return Jl(o,a)}}}else{let s=no(n.visibleWrites,e);if(!i&&QS(s))return t;if(!i&&t==null&&!KS(s,Oe()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(gr(l.path,e)||gr(e,l.path))},a=GU(n.allWrites,o,e),c=t||me.EMPTY_NODE;return Jl(a,c)}}}function rX(n,e,t){let r=me.EMPTY_NODE,i=Oa(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Je,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=no(n.visibleWrites,e);return t.forEachChild(Je,(o,a)=>{let c=Jl(no(s,new Fe(o)),a);r=r.updateImmediateChild(o,c)}),rU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=no(n.visibleWrites,e);return rU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function iX(n,e,t,r,i){j(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=st(e,t);if(KS(n.visibleWrites,s))return null;{let o=no(n.visibleWrites,s);return QS(o)?i.getChild(t):Jl(o,i.getChild(t))}}function sX(n,e,t,r){let i=st(e,t),s=Oa(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=no(n.visibleWrites,i);return Jl(o,r.getNode().getImmediateChild(t))}else return null}function oX(n,e){return Oa(n.visibleWrites,e)}function aX(n,e,t,r,i,s,o){let a,c=no(n.visibleWrites,e),l=Oa(c,Oe());if(l!=null)a=l;else if(t!=null)a=Jl(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),p=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=p.getNext();for(;_&&d.length<i;)h(_,r)!==0&&d.push(_),_=p.getNext();return d}else return[]}function cX(){return{visibleWrites:Br.empty(),allWrites:[],lastWriteId:-1}}function gy(n,e,t,r){return WU(n.writeTree,n.treePath,e,t,r)}function MA(n,e){return rX(n.writeTree,n.treePath,e)}function iU(n,e,t,r){return iX(n.writeTree,n.treePath,e,t,r)}function _y(n,e){return oX(n.writeTree,st(n.treePath,e))}function lX(n,e,t,r,i,s){return aX(n.writeTree,n.treePath,e,t,r,i,s)}function kA(n,e,t){return sX(n.writeTree,n.treePath,e,t)}function KU(n,e){return QU(st(n.treePath,e),n.writeTree)}function QU(n,e){return{treePath:n,writeTree:e}}var YS=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;j(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),j(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,tf(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,ef(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,Ql(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,tf(r,e.snapshotNode,i.oldSnap));else throw Lo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var JS=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},YU=new JS,of=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Si(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return kA(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ma(this.viewCache_),s=lX(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function uX(n){return{filter:n}}function dX(n,e){j(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),j(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function hX(n,e,t,r,i){let s=new YS,o,a;if(t.type===Ci.OVERWRITE){let l=t;l.source.fromUser?o=XS(n,e,l.path,l.snap,r,i,s):(j(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!we(l.path),o=yy(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===Ci.MERGE){let l=t;l.source.fromUser?o=pX(n,e,l.path,l.children,r,i,s):(j(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=ZS(n,e,l.path,l.children,r,i,a,s))}else if(t.type===Ci.ACK_USER_WRITE){let l=t;l.revert?o=_X(n,e,l.path,r,i,s):o=mX(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===Ci.LISTEN_COMPLETE)o=gX(n,e,t.path,r,s);else throw Lo("Unknown operation type: "+t.type);let c=s.getChanges();return fX(e,o,c),{viewCache:o,changes:c}}function fX(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=my(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(HU(my(e)))}}function JU(n,e,t,r,i,s){let o=e.eventCache;if(_y(r,t)!=null)return e;{let a,c;if(we(t))if(j(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Ma(e),d=l instanceof me?l:me.EMPTY_NODE,h=MA(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=gy(r,Ma(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=ve(t);if(l===".priority"){j(so(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let h=iU(r,t,d,c);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=We(t),h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let p=iU(r,t,o.getNode(),c);p!=null?h=o.getNode().getImmediateChild(l).updateChild(d,p):h=o.getNode().getImmediateChild(l)}else h=kA(r,l,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),l,h,d,i,s):a=o.getNode()}}return Kh(e,a,o.isFullyInitialized()||we(t),n.filter.filtersNodes())}}function yy(n,e,t,r,i,s,o,a){let c=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(we(t))l=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);l=d.updateFullNode(c.getNode(),_,null)}else{let _=ve(t);if(!c.isCompleteForPath(t)&&so(t)>1)return e;let w=We(t),R=c.getNode().getImmediateChild(_).updateChild(w,r);_===".priority"?l=d.updatePriority(c.getNode(),R):l=d.updateChild(c.getNode(),_,R,w,YU,null)}let h=qU(e,l,c.isFullyInitialized()||we(t),d.filtersNodes()),p=new of(i,h,s);return JU(n,h,t,i,p,a)}function XS(n,e,t,r,i,s,o){let a=e.eventCache,c,l,d=new of(i,e,s);if(we(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Kh(e,l,!0,n.filter.filtersNodes());else{let h=ve(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=Kh(e,l,a.isFullyInitialized(),a.isFiltered());else{let p=We(t),_=a.getNode().getImmediateChild(h),w;if(we(p))w=r;else{let S=d.getCompleteChild(h);S!=null?TA(p)===".priority"&&S.getChild(LU(p)).isEmpty()?w=S:w=S.updateChild(p,r):w=me.EMPTY_NODE}if(_.equals(w))c=e;else{let S=n.filter.updateChild(a.getNode(),h,w,p,d,o);c=Kh(e,S,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function sU(n,e){return n.eventCache.isCompleteForChild(e)}function pX(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let d=st(t,c);sU(e,ve(d))&&(a=XS(n,a,d,l,i,s,o))}),r.foreach((c,l)=>{let d=st(t,c);sU(e,ve(d))||(a=XS(n,a,d,l,i,s,o))}),a}function oU(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function ZS(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;we(t)?l=r:l=new Dn(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((h,p)=>{if(d.hasChild(h)){let _=e.serverCache.getNode().getImmediateChild(h),w=oU(n,_,p);c=yy(n,c,new Fe(h),w,i,s,o,a)}}),l.children.inorderTraversal((h,p)=>{let _=!e.serverCache.isCompleteForChild(h)&&p.value===null;if(!d.hasChild(h)&&!_){let w=e.serverCache.getNode().getImmediateChild(h),S=oU(n,w,p);c=yy(n,c,new Fe(h),S,i,s,o,a)}}),c}function mX(n,e,t,r,i,s,o){if(_y(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(we(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return yy(n,e,t,c.getNode().getChild(t),i,s,a,o);if(we(t)){let l=new Dn(null);return c.getNode().forEachChild(Ti,(d,h)=>{l=l.set(new Fe(d),h)}),ZS(n,e,t,l,i,s,a,o)}else return e}else{let l=new Dn(null);return r.foreach((d,h)=>{let p=st(t,d);c.isCompleteForPath(p)&&(l=l.set(d,c.getNode().getChild(p)))}),ZS(n,e,t,l,i,s,a,o)}}function gX(n,e,t,r,i){let s=e.serverCache,o=qU(e,s.getNode(),s.isFullyInitialized()||we(t),s.isFiltered());return JU(n,o,t,r,YU,i)}function _X(n,e,t,r,i,s){let o;if(_y(r,t)!=null)return e;{let a=new of(r,e,i),c=e.eventCache.getNode(),l;if(we(t)||ve(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=gy(r,Ma(e));else{let h=e.serverCache.getNode();j(h instanceof me,"serverChildren would be complete if leaf node"),d=MA(r,h)}d=d,l=n.filter.updateFullNode(c,d,s)}else{let d=ve(t),h=kA(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?l=n.filter.updateChild(c,d,h,We(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(c,d,me.EMPTY_NODE,We(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=gy(r,Ma(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||_y(r,Oe())!=null,Kh(e,l,o,n.filter.filtersNodes())}}var eA=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new nf(r.getIndex()),s=VJ(r);this.processor_=uX(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(me.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(me.EMPTY_NODE,a.getNode(),null),d=new Si(c,o.isFullyInitialized(),i.filtersNodes()),h=new Si(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Py(h,d),this.eventGenerator_=new GS(this.query_)}get query(){return this.query_}};function yX(n){return n.viewCache_.serverCache.getNode()}function vX(n){return my(n.viewCache_)}function wX(n,e){let t=Ma(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!we(e)&&!t.getImmediateChild(ve(e)).isEmpty())?t.getChild(e):null}function aU(n){return n.eventRegistrations_.length===0}function IX(n,e){n.eventRegistrations_.push(e)}function cU(n,e,t){let r=[];if(t){j(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function lU(n,e,t,r){e.type===Ci.MERGE&&e.source.queryId!==null&&(j(Ma(n.viewCache_),"We should always have a full cache before handling merges"),j(my(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=hX(n.processor_,i,e,t,r);return dX(n.processor_,s.viewCache),j(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,XU(n,s.changes,s.viewCache.eventCache.getNode(),null)}function EX(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Je,(s,o)=>{r.push(Ql(s,o))}),t.isFullyInitialized()&&r.push(HU(t.getNode())),XU(n,r,t.getNode(),e)}function XU(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return GJ(n.eventGenerator_,e,t,i)}var vy,wy=class{constructor(){this.views=new Map}};function bX(n){j(!vy,"__referenceConstructor has already been defined"),vy=n}function CX(){return j(vy,"Reference.ts has not been loaded"),vy}function TX(n){return n.views.size===0}function OA(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return j(s!=null,"SyncTree gave us an op for an invalid query."),lU(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(lU(o,e,t,r));return s}}function ZU(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=gy(t,i?r:null),c=!1;a?c=!0:r instanceof me?(a=MA(t,r),c=!1):(a=me.EMPTY_NODE,c=!1);let l=Py(new Si(a,c,!1),new Si(r,i,!1));return new eA(e,l)}return o}function DX(n,e,t,r,i,s){let o=ZU(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),IX(o,t),EX(o,t)}function SX(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=oo(n);if(i==="default")for(let[c,l]of n.views.entries())o=o.concat(cU(l,t,r)),aU(l)&&(n.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=n.views.get(i);c&&(o=o.concat(cU(c,t,r)),aU(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!oo(n)&&s.push(new(CX())(e._repo,e._path)),{removed:s,events:o}}function eB(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function ro(n,e){let t=null;for(let r of n.views.values())t=t||wX(r,e);return t}function tB(n,e){if(e._queryParams.loadsAllData())return ky(n);{let r=e._queryIdentifier;return n.views.get(r)}}function nB(n,e){return tB(n,e)!=null}function oo(n){return ky(n)!=null}function ky(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Iy;function AX(n){j(!Iy,"__referenceConstructor has already been defined"),Iy=n}function RX(){return j(Iy,"Reference.ts has not been loaded"),Iy}var xX=1,Ey=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Dn(null),this.pendingWriteTree_=cX(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function FA(n,e,t,r,i){return YJ(n.pendingWriteTree_,e,t,r,i),i?nu(n,new Yl(xA(),e,t)):[]}function NX(n,e,t,r){JJ(n.pendingWriteTree_,e,t,r);let i=Dn.fromObject(t);return nu(n,new sf(xA(),e,i))}function to(n,e,t=!1){let r=XJ(n.pendingWriteTree_,e);if(ZJ(n.pendingWriteTree_,e)){let s=new Dn(null);return r.snap!=null?s=s.set(Oe(),!0):Gt(r.children,o=>{s=s.set(new Fe(o),!0)}),nu(n,new zS(r.path,s,t))}else return[]}function mf(n,e,t){return nu(n,new Yl(NA(),e,t))}function PX(n,e,t){let r=Dn.fromObject(t);return nu(n,new sf(NA(),e,r))}function MX(n,e){return nu(n,new py(NA(),e))}function kX(n,e,t){let r=LA(n,t);if(r){let i=VA(r),s=i.path,o=i.queryId,a=Tn(s,e),c=new py(PA(o),a);return UA(n,s,c)}else return[]}function by(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||nB(o,e))){let c=SX(o,e,t,r);TX(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let d=l.findIndex(p=>p._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(p,_)=>oo(_));if(d&&!h){let p=n.syncPointTree_.subtree(s);if(!p.isEmpty()){let _=LX(p);for(let w=0;w<_.length;++w){let S=_[w],R=S.query,L=oB(n,S);n.listenProvider_.startListening(Yh(R),af(n,R),L.hashFn,L.onComplete)}}}!h&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(Yh(e),null):l.forEach(p=>{let _=n.queryToTagMap.get(Fy(p));n.listenProvider_.stopListening(Yh(p),_)}))}VX(n,l)}return a}function rB(n,e,t,r){let i=LA(n,r);if(i!=null){let s=VA(i),o=s.path,a=s.queryId,c=Tn(o,e),l=new Yl(PA(a),c,t);return UA(n,o,l)}else return[]}function OX(n,e,t,r){let i=LA(n,r);if(i){let s=VA(i),o=s.path,a=s.queryId,c=Tn(o,e),l=Dn.fromObject(t),d=new sf(PA(a),c,l);return UA(n,o,d)}else return[]}function tA(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(p,_)=>{let w=Tn(p,i);s=s||ro(_,w),o=o||oo(_)});let a=n.syncPointTree_.get(i);a?(o=o||oo(a),s=s||ro(a,Oe())):(a=new wy,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=me.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,w)=>{let S=ro(w,Oe());S&&(s=s.updateImmediateChild(_,S))}));let l=nB(a,e);if(!l&&!e._queryParams.loadsAllData()){let p=Fy(e);j(!n.queryToTagMap.has(p),"View does not exist, but we have a tag");let _=UX();n.queryToTagMap.set(p,_),n.tagToQueryMap.set(_,p)}let d=My(n.pendingWriteTree_,i),h=DX(a,e,t,d,s,c);if(!l&&!o&&!r){let p=tB(a,e);h=h.concat(BX(n,e,p))}return h}function Oy(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=Tn(o,e),l=ro(a,c);if(l)return l});return WU(i,e,s,t,!0)}function FX(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let h=Tn(l,t);r=r||ro(d,h)});let i=n.syncPointTree_.get(t);i?r=r||ro(i,Oe()):(i=new wy,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new Si(r,!0,!1):null,a=My(n.pendingWriteTree_,e._path),c=ZU(i,e,a,s?o.getNode():me.EMPTY_NODE,s);return vX(c)}function nu(n,e){return iB(e,n.syncPointTree_,null,My(n.pendingWriteTree_,Oe()))}function iB(n,e,t,r){if(we(n.path))return sB(n,e,t,r);{let i=e.get(Oe());t==null&&i!=null&&(t=ro(i,Oe()));let s=[],o=ve(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,d=KU(r,o);s=s.concat(iB(a,c,l,d))}return i&&(s=s.concat(OA(i,n,r,t))),s}}function sB(n,e,t,r){let i=e.get(Oe());t==null&&i!=null&&(t=ro(i,Oe()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=KU(r,o),d=n.operationForChild(o);d&&(s=s.concat(sB(d,a,c,l)))}),i&&(s=s.concat(OA(i,n,r,t))),s}function oB(n,e){let t=e.query,r=af(n,t);return{hashFn:()=>(yX(e)||me.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?kX(n,t._path,r):MX(n,t._path);{let s=YY(i,t);return by(n,t,null,s)}}}}function af(n,e){let t=Fy(e);return n.queryToTagMap.get(t)}function Fy(n){return n._path.toString()+"$"+n._queryIdentifier}function LA(n,e){return n.tagToQueryMap.get(e)}function VA(n){let e=n.indexOf("$");return j(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Fe(n.substr(0,e))}}function UA(n,e,t){let r=n.syncPointTree_.get(e);j(r,"Missing sync point for query tag that we're tracking");let i=My(n.pendingWriteTree_,e);return OA(r,t,i,null)}function LX(n){return n.fold((e,t,r)=>{if(t&&oo(t))return[ky(t)];{let i=[];return t&&(i=eB(t)),Gt(r,(s,o)=>{i=i.concat(o)}),i}})}function Yh(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(RX())(n._repo,n._path):n}function VX(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=Fy(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function UX(){return xX++}function BX(n,e,t){let r=e._path,i=af(n,e),s=oB(n,t),o=n.listenProvider_.startListening(Yh(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)j(!oo(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,d,h)=>{if(!we(l)&&d&&oo(d))return[ky(d).query];{let p=[];return d&&(p=p.concat(eB(d).map(_=>_.query))),Gt(h,(_,w)=>{p=p.concat(w)}),p}});for(let l=0;l<c.length;++l){let d=c[l];n.listenProvider_.stopListening(Yh(d),af(n,d))}}return o}var nA=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},rA=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=st(this.path_,e);return new n(this.syncTree_,t)}node(){return Oy(this.syncTree_,this.path_)}},jX=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},uU=function(n,e,t){if(!n||typeof n!="object")return n;if(j(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return $X(n[".sv"],e,t);if(typeof n[".sv"]=="object")return HX(n[".sv"],e);j(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},$X=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:j(!1,"Unexpected server value: "+n)}},HX=function(n,e,t){n.hasOwnProperty("increment")||j(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&j(!1,"Unexpected increment value: "+r);let i=e.node();if(j(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},aB=function(n,e,t,r){return jA(e,new rA(t,n),r)},BA=function(n,e,t){return jA(n,new nA(e),t)};function jA(n,e,t){let r=n.getPriority().val(),i=uU(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=uU(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Wl(a,dt(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Wl(i))),o.forEachChild(Je,(a,c)=>{let l=jA(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var cf=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function Ly(n,e){let t=e instanceof Fe?e:new Fe(e),r=n,i=ve(t);for(;i!==null;){let s=bs(r.node.children,i)||{children:{},childCount:0};r=new cf(i,r,s),t=We(t),i=ve(t)}return r}function Fa(n){return n.node.value}function $A(n,e){n.node.value=e,iA(n)}function cB(n){return n.node.childCount>0}function qX(n){return Fa(n)===void 0&&!cB(n)}function Vy(n,e){Gt(n.node.children,(t,r)=>{e(new cf(t,n,r))})}function lB(n,e,t,r){t&&!r&&e(n),Vy(n,i=>{lB(i,e,!0,r)}),t&&r&&e(n)}function zX(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function gf(n){return new Fe(n.parent===null?n.name:gf(n.parent)+"/"+n.name)}function iA(n){n.parent!==null&&GX(n.parent,n.name,n)}function GX(n,e,t){let r=qX(t),i=yn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,iA(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,iA(n))}var WX=/[\[\].#$\/\u0000-\u001F\u007F]/,KX=/[\[\].#$\u0000-\u001F\u007F]/,mS=10*1024*1024,Uy=function(n){return typeof n=="string"&&n.length!==0&&!WX.test(n)},uB=function(n){return typeof n=="string"&&n.length!==0&&!KX.test(n)},QX=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),uB(n)},lf=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!xy(n)||n&&typeof n=="object"&&yn(n,".sv")},Ai=function(n,e,t,r){r&&e===void 0||_f(cn(n,"value"),e,t)},_f=function(n,e,t){let r=t instanceof Fe?new AS(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+xa(r));if(typeof e=="function")throw new Error(n+"contains a function "+xa(r)+" with contents = "+e.toString());if(xy(e))throw new Error(n+"contains "+e.toString()+" "+xa(r));if(typeof e=="string"&&e.length>mS/3&&Ed(e)>mS)throw new Error(n+"contains a string greater than "+mS+" utf8 bytes "+xa(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Gt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Uy(o)))throw new Error(n+" contains an invalid key ("+o+") "+xa(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);TJ(r,o),_f(n,a,r),DJ(r)}),i&&s)throw new Error(n+' contains ".value" child '+xa(r)+" in addition to actual children.")}},YX=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=Xh(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Uy(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(CJ);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&gr(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},dB=function(n,e,t,r){if(r&&e===void 0)return;let i=cn(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Gt(e,(o,a)=>{let c=new Fe(o);if(_f(i,a,st(t,c)),TA(c)===".priority"&&!lf(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),YX(i,s)},HA=function(n,e,t){if(!(t&&e===void 0)){if(xy(e))throw new Error(cn(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!lf(e))throw new Error(cn(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},yf=function(n,e,t,r){if(!(r&&t===void 0)&&!Uy(t))throw new Error(cn(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},ru=function(n,e,t,r){if(!(r&&t===void 0)&&!uB(t))throw new Error(cn(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},JX=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),ru(n,e,t,r)},Jn=function(n,e){if(ve(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},hB=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Uy(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!QX(t))throw new Error(cn(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var sA=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function By(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!DA(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function fB(n,e,t){By(n,t),pB(n,r=>DA(r,e))}function Xn(n,e,t){By(n,t),pB(n,r=>gr(r,e)||gr(e,r))}function pB(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(XX(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function XX(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Pa&&zt("event: "+t.toString()),eu(r)}}}var mB="repo_interrupt",ZX=25,oA=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new sA,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=fy(),this.transactionQueueTree_=new cf,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function eZ(n,e,t){if(n.stats_=CA(n.repoInfo_),n.forceRestClient_||eJ())n.server_=new US(n.repoInfo_,(r,i,s,o)=>{dU(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>hU(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Dt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new SA(n.repoInfo_,e,(r,i,s,o)=>{dU(n,r,i,s,o)},r=>{hU(n,r)},r=>{tZ(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=nJ(n.repoInfo_,()=>new qS(n.stats_,n.server_)),n.infoData_=new BS,n.infoSyncTree_=new Ey({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=mf(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),qA(n,"connected",!1),n.serverSyncTree_=new Ey({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);Xn(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function gB(n){let t=n.infoData_.getNode(new Fe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function vf(n){return jX({timestamp:gB(n)})}function dU(n,e,t,r,i){n.dataUpdateCount++;let s=new Fe(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=Id(t,l=>dt(l));o=OX(n.serverSyncTree_,s,c,i)}else{let c=dt(t);o=rB(n.serverSyncTree_,s,c,i)}else if(r){let c=Id(t,l=>dt(l));o=PX(n.serverSyncTree_,s,c)}else{let c=dt(t);o=mf(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Xl(n,s)),Xn(n.eventQueue_,a,o)}function hU(n,e){qA(n,"connected",e),e===!1&&iZ(n)}function tZ(n,e){Gt(e,(t,r)=>{qA(n,t,r)})}function qA(n,e,t){let r=new Fe("/.info/"+e),i=dt(t);n.infoData_.updateSnapshot(r,i);let s=mf(n.infoSyncTree_,r,i);Xn(n.eventQueue_,r,s)}function jy(n){return n.nextWriteId_++}function nZ(n,e,t){let r=FX(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=dt(i).withIndex(e._queryParams.getIndex());tA(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=mf(n.serverSyncTree_,e._path,s);else{let a=af(n.serverSyncTree_,e);o=rB(n.serverSyncTree_,e._path,s,a)}return Xn(n.eventQueue_,e._path,o),by(n.serverSyncTree_,e,t,null,!0),s},i=>(iu(n,"get for query "+Dt(e)+" failed: "+i),Promise.reject(new Error(i))))}function zA(n,e,t,r,i){iu(n,"set",{path:e.toString(),value:t,priority:r});let s=vf(n),o=dt(t,r),a=Oy(n.serverSyncTree_,e),c=BA(o,a,s),l=jy(n),d=FA(n.serverSyncTree_,e,c,l,!0);By(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(p,_)=>{let w=p==="ok";w||fn("set at "+e+" failed: "+p);let S=to(n.serverSyncTree_,l,!w);Xn(n.eventQueue_,e,S),ao(n,i,p,_)});let h=WA(n,e);Xl(n,h),Xn(n.eventQueue_,h,[])}function rZ(n,e,t,r){iu(n,"update",{path:e.toString(),value:t});let i=!0,s=vf(n),o={};if(Gt(t,(a,c)=>{i=!1,o[a]=aB(st(e,a),dt(c),n.serverSyncTree_,s)}),i)zt("update() called with empty data.  Don't do anything."),ao(n,r,"ok",void 0);else{let a=jy(n),c=NX(n.serverSyncTree_,e,o,a);By(n.eventQueue_,c),n.server_.merge(e.toString(),t,(l,d)=>{let h=l==="ok";h||fn("update at "+e+" failed: "+l);let p=to(n.serverSyncTree_,a,!h),_=p.length>0?Xl(n,e):e;Xn(n.eventQueue_,_,p),ao(n,r,l,d)}),Gt(t,l=>{let d=WA(n,st(e,l));Xl(n,d)}),Xn(n.eventQueue_,e,[])}}function iZ(n){iu(n,"onDisconnectEvents");let e=vf(n),t=fy();$S(n.onDisconnect_,Oe(),(i,s)=>{let o=aB(i,s,n.serverSyncTree_,e);tu(t,i,o)});let r=[];$S(t,Oe(),(i,s)=>{r=r.concat(mf(n.serverSyncTree_,i,s));let o=WA(n,i);Xl(n,o)}),n.onDisconnect_=fy(),Xn(n.eventQueue_,Oe(),r)}function sZ(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&jS(n.onDisconnect_,e),ao(n,t,r,i)})}function fU(n,e,t,r){let i=dt(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&tu(n.onDisconnect_,e,i),ao(n,r,s,o)})}function oZ(n,e,t,r,i){let s=dt(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&tu(n.onDisconnect_,e,s),ao(n,i,o,a)})}function aZ(n,e,t,r){if(kc(t)){zt("onDisconnect().update() called with empty data.  Don't do anything."),ao(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Gt(t,(o,a)=>{let c=dt(a);tu(n.onDisconnect_,st(e,o),c)}),ao(n,r,i,s)})}function cZ(n,e,t){let r;ve(e._path)===".info"?r=tA(n.infoSyncTree_,e,t):r=tA(n.serverSyncTree_,e,t),fB(n.eventQueue_,e._path,r)}function aA(n,e,t){let r;ve(e._path)===".info"?r=by(n.infoSyncTree_,e,t):r=by(n.serverSyncTree_,e,t),fB(n.eventQueue_,e._path,r)}function _B(n){n.persistentConnection_&&n.persistentConnection_.interrupt(mB)}function lZ(n){n.persistentConnection_&&n.persistentConnection_.resume(mB)}function iu(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),zt(t,...e)}function ao(n,e,t,r){e&&eu(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function uZ(n,e,t,r,i,s){iu(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:gU(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=GA(n,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{_f("transaction failed: Data returned ",c,o.path),o.status=0;let l=Ly(n.transactionQueueTree_,e),d=Fa(l)||[];d.push(o),$A(l,d);let h;typeof c=="object"&&c!==null&&yn(c,".priority")?(h=bs(c,".priority"),j(lf(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Oy(n.serverSyncTree_,e)||me.EMPTY_NODE).getPriority().val();let p=vf(n),_=dt(c,h),w=BA(_,a,p);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=w,o.currentWriteId=jy(n);let S=FA(n.serverSyncTree_,e,w,o.currentWriteId,o.applyLocally);Xn(n.eventQueue_,e,S),$y(n,n.transactionQueueTree_)}}function GA(n,e,t){return Oy(n.serverSyncTree_,e,t)||me.EMPTY_NODE}function $y(n,e=n.transactionQueueTree_){if(e||Hy(n,e),Fa(e)){let t=vB(n,e);j(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&dZ(n,gf(e),t)}else cB(e)&&Vy(e,t=>{$y(n,t)})}function dZ(n,e,t){let r=t.map(l=>l.currentWriteId),i=GA(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];j(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=Tn(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{iu(n,"transaction put response",{path:c.toString(),status:l});let d=[];if(l==="ok"){let h=[];for(let p=0;p<t.length;p++)t[p].status=2,d=d.concat(to(n.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&h.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();Hy(n,Ly(n.transactionQueueTree_,e)),$y(n,n.transactionQueueTree_),Xn(n.eventQueue_,e,d);for(let p=0;p<h.length;p++)eu(h[p])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{fn("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}Xl(n,e)}},o)}function Xl(n,e){let t=yB(n,e),r=gf(t),i=vB(n,t);return hZ(n,i,r),r}function hZ(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=Tn(t,c.path),d=!1,h;if(j(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,i=i.concat(to(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=ZX)d=!0,h="maxretry",i=i.concat(to(n.serverSyncTree_,c.currentWriteId,!0));else{let p=GA(n,c.path,o);c.currentInputSnapshot=p;let _=e[a].update(p.val());if(_!==void 0){_f("transaction failed: Data returned ",_,c.path);let w=dt(_);typeof _=="object"&&_!=null&&yn(_,".priority")||(w=w.updatePriority(p.getPriority()));let R=c.currentWriteId,L=vf(n),K=BA(w,p,L);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=K,c.currentWriteId=jy(n),o.splice(o.indexOf(R),1),i=i.concat(FA(n.serverSyncTree_,c.path,K,c.currentWriteId,c.applyLocally)),i=i.concat(to(n.serverSyncTree_,R,!0))}else d=!0,h="nodata",i=i.concat(to(n.serverSyncTree_,c.currentWriteId,!0))}Xn(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}Hy(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)eu(r[a]);$y(n,n.transactionQueueTree_)}function yB(n,e){let t,r=n.transactionQueueTree_;for(t=ve(e);t!==null&&Fa(r)===void 0;)r=Ly(r,t),e=We(e),t=ve(e);return r}function vB(n,e){let t=[];return wB(n,e,t),t.sort((r,i)=>r.order-i.order),t}function wB(n,e,t){let r=Fa(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Vy(e,i=>{wB(n,i,t)})}function Hy(n,e){let t=Fa(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,$A(e,t.length>0?t:void 0)}Vy(e,r=>{Hy(n,r)})}function WA(n,e){let t=gf(yB(n,e)),r=Ly(n.transactionQueueTree_,e);return zX(r,i=>{gS(n,i)}),gS(n,r),lB(r,i=>{gS(n,i)}),t}function gS(n,e){let t=Fa(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(j(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(j(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(to(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?$A(e,void 0):t.length=s+1,Xn(n.eventQueue_,gf(e),i);for(let o=0;o<r.length;o++)eu(r[o])}}function fZ(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function pZ(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):fn(`Invalid query segment '${t}' in query '${n}'`)}return e}var cA=function(n,e){let t=mZ(n),r=t.namespace;t.domain==="firebase.com"&&Di(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Di("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||zY();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new sy(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Fe(t.pathString)}},mZ=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=fZ(n.substring(d,h)));let p=pZ(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let _=e.slice(0,l);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),t=e.substring(w+1),s=r}"ns"in p&&(s=p.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var pU="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",gZ=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=pU.charAt(t%64),t=Math.floor(t/64);j(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=pU.charAt(e[i]);return j(o.length===20,"nextPushId: Length should be 20."),o}}();var Cy=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Dt(this.snapshot.exportVal())}},Ty=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var uf=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return j(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Dy=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new Vt;return sZ(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Jn("OnDisconnect.remove",this._path);let e=new Vt;return fU(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Jn("OnDisconnect.set",this._path),Ai("OnDisconnect.set",e,this._path,!1);let t=new Vt;return fU(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Jn("OnDisconnect.setWithPriority",this._path),Ai("OnDisconnect.setWithPriority",e,this._path,!1),HA("OnDisconnect.setWithPriority",t,!1);let r=new Vt;return oZ(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Jn("OnDisconnect.update",this._path),dB("OnDisconnect.update",e,this._path,!1);let t=new Vt;return aZ(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var Sn=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return we(this._path)?null:TA(this._path)}get ref(){return new Zn(this._repo,this._path)}get _queryIdentifier(){let e=eU(this._queryParams),t=bA(e);return t==="{}"?"default":t}get _queryObject(){return eU(this._queryParams)}isEqual(e){if(e=q(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=DA(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+bJ(this._path)}};function qy(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function lo(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Ti){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==io)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Zi)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===Je){if(e!=null&&!lf(e)||t!=null&&!lf(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(j(n.getIndex()instanceof Zh||n.getIndex()===RA,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function zy(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Zn=class n extends Sn{constructor(e,t){super(e,t,new rf,!1)}get parent(){let e=LU(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Zl=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new Fe(e),r=co(this.ref,e);return new n(this._node.getChild(t),r,Je)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,co(this.ref,r),Je)))}hasChild(e){let t=new Fe(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function KA(n,e){return n=q(n),n._checkNotDeleted("ref"),e!==void 0?co(n._root,e):n._root}function QA(n,e){n=q(n),n._checkNotDeleted("refFromURL");let t=cA(e,n._repo.repoInfo_.nodeAdmin);hB("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Di("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),KA(n,t.path.toString())}function co(n,e){return n=q(n),ve(n._path)===null?JX("child","path",e,!1):ru("child","path",e,!1),new Zn(n._repo,st(n._path,e))}function IB(n,e){n=q(n),Jn("push",n._path),Ai("push",e,n._path,!0);let t=gB(n._repo),r=gZ(t),i=co(n,r),s=co(n,r),o;return e!=null?o=Gy(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function EB(n){return Jn("remove",n._path),Gy(n,null)}function Gy(n,e){n=q(n),Jn("set",n._path),Ai("set",e,n._path,!1);let t=new Vt;return zA(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function bB(n,e){n=q(n),Jn("setPriority",n._path),HA("setPriority",e,!1);let t=new Vt;return zA(n._repo,st(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function CB(n,e,t){if(Jn("setWithPriority",n._path),Ai("setWithPriority",e,n._path,!1),HA("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new Vt;return zA(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function TB(n,e){dB("update",e,n._path,!1);let t=new Vt;return rZ(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function DB(n){n=q(n);let e=new uf(()=>{}),t=new df(e);return nZ(n._repo,n,t).then(r=>new Zl(r,new Zn(n._repo,n._path),n._queryParams.getIndex()))}var df=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new Cy("value",this,new Zl(e.snapshotNode,new Zn(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ty(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Sy=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ty(this,e,t):null}createEvent(e,t){j(e.childName!=null,"Child events should have a childName.");let r=co(new Zn(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new Cy(e.type,this,new Zl(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function wf(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,l=(d,h)=>{aA(n._repo,n,a),c(d,h)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new uf(t,s||void 0),a=e==="value"?new df(o):new Sy(e,o);return cZ(n._repo,n,a),()=>aA(n._repo,n,a)}function Wy(n,e,t,r){return wf(n,"value",e,t,r)}function YA(n,e,t,r){return wf(n,"child_added",e,t,r)}function JA(n,e,t,r){return wf(n,"child_changed",e,t,r)}function XA(n,e,t,r){return wf(n,"child_moved",e,t,r)}function ZA(n,e,t,r){return wf(n,"child_removed",e,t,r)}function eR(n,e,t){let r=null,i=t?new uf(t):null;e==="value"?r=new df(i):e&&(r=new Sy(e,i)),aA(n._repo,n,r)}var er=class{},Ay=class extends er{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Ai("endAt",this._value,e._path,!0);let t=VS(e._queryParams,this._value,this._key);if(zy(t),lo(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Sn(e._repo,e._path,t,e._orderByCalled)}};function SB(n,e){return yf("endAt","key",e,!0),new Ay(n,e)}var lA=class extends er{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Ai("endBefore",this._value,e._path,!1);let t=$J(e._queryParams,this._value,this._key);if(zy(t),lo(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Sn(e._repo,e._path,t,e._orderByCalled)}};function AB(n,e){return yf("endBefore","key",e,!0),new lA(n,e)}var Ry=class extends er{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Ai("startAt",this._value,e._path,!0);let t=LS(e._queryParams,this._value,this._key);if(zy(t),lo(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Sn(e._repo,e._path,t,e._orderByCalled)}};function RB(n=null,e){return yf("startAt","key",e,!0),new Ry(n,e)}var uA=class extends er{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Ai("startAfter",this._value,e._path,!1);let t=jJ(e._queryParams,this._value,this._key);if(zy(t),lo(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Sn(e._repo,e._path,t,e._orderByCalled)}};function xB(n,e){return yf("startAfter","key",e,!0),new uA(n,e)}var dA=class extends er{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Sn(e._repo,e._path,UJ(e._queryParams,this._limit),e._orderByCalled)}};function NB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new dA(n)}var hA=class extends er{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Sn(e._repo,e._path,BJ(e._queryParams,this._limit),e._orderByCalled)}};function PB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new hA(n)}var fA=class extends er{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){qy(e,"orderByChild");let t=new Fe(this._path);if(we(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Zh(t),i=Ny(e._queryParams,r);return lo(i),new Sn(e._repo,e._path,i,!0)}};function MB(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return ru("orderByChild","path",n,!1),new fA(n)}var pA=class extends er{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){qy(e,"orderByKey");let t=Ny(e._queryParams,Ti);return lo(t),new Sn(e._repo,e._path,t,!0)}};function kB(){return new pA}var mA=class extends er{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){qy(e,"orderByPriority");let t=Ny(e._queryParams,Je);return lo(t),new Sn(e._repo,e._path,t,!0)}};function OB(){return new mA}var gA=class extends er{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){qy(e,"orderByValue");let t=Ny(e._queryParams,RA);return lo(t),new Sn(e._repo,e._path,t,!0)}};function FB(){return new gA}var _A=class extends er{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Ai("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Ay(this._value,this._key)._apply(new Ry(this._value,this._key)._apply(e))}};function LB(n,e){return yf("equalTo","key",e,!0),new _A(n,e)}function yr(n,...e){let t=q(n);for(let r of e)t=r._apply(t);return t}bX(Zn);AX(Zn);var _Z="FIREBASE_DATABASE_EMULATOR_HOST",yA={},yZ=!1;function vZ(n,e,t,r){n.repoInfo_=new sy(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function tR(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Di("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),zt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=cA(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[_Z]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=cA(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new Wh(Wh.OWNER):new ES(n.name,n.options,e);hB("Invalid Firebase Database URL",o),we(o.path)||Di("Database URL must point to the root of a Firebase Database (not including a child path).");let h=IZ(a,n,d,new IS(n.name,t));return new vA(h,n)}function wZ(n,e){let t=yA[e];(!t||t[n.key]!==n)&&Di(`Database ${e}(${n.repoInfo_}) has already been deleted.`),_B(n),delete t[n.key]}function IZ(n,e,t,r){let i=yA[e.name];i||(i={},yA[e.name]=i);let s=i[n.toURLString()];return s&&Di("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new oA(n,yZ,t,r),i[n.toURLString()]=s,s}var vA=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(eZ(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Zn(this._repo,Oe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(wZ(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Di("Cannot call "+e+" on a deleted database.")}};function VB(){FU.IS_TRANSPORT_INITIALIZED&&fn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function UB(){VB(),Jh.forceDisallow()}function BB(){VB(),Hl.forceDisallow(),Jh.forceAllow()}function jB(n,e,t,r={}){n=q(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Di("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Di('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Wh(Wh.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Mc(r.mockUserToken,n.app.options.projectId);s=new Wh(o)}vZ(i,e,t,s)}function $B(n){n=q(n),n._checkNotDeleted("goOffline"),_B(n._repo)}function HB(n){n=q(n),n._checkNotDeleted("goOnline"),lZ(n._repo)}function qB(n,e){yU(n,e)}function EZ(n){EA(wn),vn(new $e("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return tR(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),wt(L2,V2,n),wt(L2,V2,"esm2017")}var bZ={".sv":"timestamp"};function zB(){return bZ}function GB(n){return{".sv":{increment:n}}}var wA=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function WB(n,e,t){var r;if(n=q(n),Jn("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new Vt,o=(c,l,d)=>{let h=null;c?s.reject(c):(h=new Zl(d,new Zn(n._repo,n._path),Je),s.resolve(new wA(l,h)))},a=Wy(n,()=>{});return uZ(n._repo,n._path,e,o,a,i),s.promise}SA.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};SA.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};EZ();var CZ="@firebase/database-compat",TZ="1.0.5";var DZ=new On("@firebase/database-compat"),KB=function(n){let e="FIREBASE WARNING: "+n;DZ.warn(e)};var SZ=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(cn(n,e)+"must be a boolean.")},AZ=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(cn(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var nR=class{constructor(e){this._delegate=e}cancel(e){ae("OnDisconnect.cancel",0,1,arguments.length),Ut("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){ae("OnDisconnect.remove",0,1,arguments.length),Ut("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){ae("OnDisconnect.set",1,2,arguments.length),Ut("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ae("OnDisconnect.setWithPriority",2,3,arguments.length),Ut("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(ae("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,KB("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ut("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var rR=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ae("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var La=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return ae("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ae("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ae("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ae("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ae("DataSnapshot.child",0,1,arguments.length),e=String(e),ru("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return ae("DataSnapshot.hasChild",1,1,arguments.length),ru("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ae("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ae("DataSnapshot.forEach",1,1,arguments.length),Ut("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return ae("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ae("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ae("DataSnapshot.ref",0,0,arguments.length),new es(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Ky=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;ae("Query.on",2,4,arguments.length),Ut("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new La(this.database,l),d)};a.userCallback=t,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Wy(this._delegate,a,c),t;case"child_added":return YA(this._delegate,a,c),t;case"child_removed":return ZA(this._delegate,a,c),t;case"child_changed":return JA(this._delegate,a,c),t;case"child_moved":return XA(this._delegate,a,c),t;default:throw new Error(cn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(ae("Query.off",0,3,arguments.length),AZ("Query.off",e,!0),Ut("Query.off","callback",t,!0),KE("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,eR(this._delegate,e,i)}else eR(this._delegate,e)}get(){return DB(this._delegate).then(e=>new La(this.database,e))}once(e,t,r,i){ae("Query.once",1,4,arguments.length),Ut("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new Vt,a=(l,d)=>{let h=new La(this.database,l);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":Wy(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":YA(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":ZA(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":JA(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":XA(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(cn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ae("Query.limitToFirst",1,1,arguments.length),new n(this.database,yr(this._delegate,NB(e)))}limitToLast(e){return ae("Query.limitToLast",1,1,arguments.length),new n(this.database,yr(this._delegate,PB(e)))}orderByChild(e){return ae("Query.orderByChild",1,1,arguments.length),new n(this.database,yr(this._delegate,MB(e)))}orderByKey(){return ae("Query.orderByKey",0,0,arguments.length),new n(this.database,yr(this._delegate,kB()))}orderByPriority(){return ae("Query.orderByPriority",0,0,arguments.length),new n(this.database,yr(this._delegate,OB()))}orderByValue(){return ae("Query.orderByValue",0,0,arguments.length),new n(this.database,yr(this._delegate,FB()))}startAt(e=null,t){return ae("Query.startAt",0,2,arguments.length),new n(this.database,yr(this._delegate,RB(e,t)))}startAfter(e=null,t){return ae("Query.startAfter",0,2,arguments.length),new n(this.database,yr(this._delegate,xB(e,t)))}endAt(e=null,t){return ae("Query.endAt",0,2,arguments.length),new n(this.database,yr(this._delegate,SB(e,t)))}endBefore(e=null,t){return ae("Query.endBefore",0,2,arguments.length),new n(this.database,yr(this._delegate,AB(e,t)))}equalTo(e,t){return ae("Query.equalTo",1,2,arguments.length),new n(this.database,yr(this._delegate,LB(e,t)))}toString(){return ae("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ae("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ae("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,Ut(e,"cancel",i.cancel,!0),i.context=r,KE(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(cn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new es(this.database,new Zn(this._delegate._repo,this._delegate._path))}},es=class n extends Ky{constructor(e,t){super(e,new Sn(t._repo,t._path,new rf,!1)),this.database=e,this._delegate=t}getKey(){return ae("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ae("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,co(this._delegate,e))}getParent(){ae("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return ae("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){ae("Reference.set",1,2,arguments.length),Ut("Reference.set","onComplete",t,!0);let r=Gy(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(ae("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,KB("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Jn("Reference.update",this._delegate._path),Ut("Reference.update","onComplete",t,!0);let r=TB(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ae("Reference.setWithPriority",2,3,arguments.length),Ut("Reference.setWithPriority","onComplete",r,!0);let i=CB(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){ae("Reference.remove",0,1,arguments.length),Ut("Reference.remove","onComplete",e,!0);let t=EB(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){ae("Reference.transaction",1,3,arguments.length),Ut("Reference.transaction","transactionUpdate",e,!1),Ut("Reference.transaction","onComplete",t,!0),SZ("Reference.transaction","applyLocally",r,!0);let i=WB(this._delegate,e,{applyLocally:r}).then(s=>new rR(s.committed,new La(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){ae("Reference.setPriority",1,2,arguments.length),Ut("Reference.setPriority","onComplete",t,!0);let r=bB(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){ae("Reference.push",0,2,arguments.length),Ut("Reference.push","onComplete",t,!0);let r=IB(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Jn("Reference.onDisconnect",this._delegate._path),new nR(new Dy(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Va=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:UB,forceLongPolling:BB}}useEmulator(e,t,r={}){jB(this._delegate,e,t,r)}ref(e){if(ae("database.ref",0,1,arguments.length),e instanceof es){let t=QA(this._delegate,e.toString());return new es(this,t)}else{let t=KA(this._delegate,e);return new es(this,t)}}refFromURL(e){ae("database.refFromURL",1,1,arguments.length);let r=QA(this._delegate,e);return new es(this,r)}goOffline(){return ae("database.goOffline",0,0,arguments.length),$B(this._delegate)}goOnline(){return ae("database.goOnline",0,0,arguments.length),HB(this._delegate)}};Va.ServerValue={TIMESTAMP:zB(),increment:n=>GB(n)};function RZ({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){EA(t);let a=new Ds("database-standalone"),c=new Bo("auth-internal",a);c.setComponent(new $e("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new Bo("app-check-internal",a),l.setComponent(new $e("app-check-internal",()=>i,"PRIVATE"))),{instance:new Va(tR(n,c,l,e,o),n),namespace:s}}var xZ=Object.freeze({__proto__:null,initStandalone:RZ});var NZ=Va.ServerValue;function PZ(n){n.INTERNAL.registerComponent(new $e("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new Va(i,r)},"PUBLIC").setServiceProps({Reference:es,Query:Ky,Database:Va,DataSnapshot:La,enableLogging:qB,INTERNAL:xZ,ServerValue:NZ}).setMultipleInstances(!0)),n.registerVersion(CZ,TZ)}PZ(G);var MZ="firebase",kZ="10.12.2";G.registerVersion(MZ,kZ,"app-compat");var QB=(()=>{let e=class e{constructor(r){this.router=r}ngOnInit(){G.auth().onAuthStateChanged(r=>{r?this.router.navigate(["/chat"]):(this.router.navigate(["/log"]),document.getElementById("sidebar-container").style.display="none",document.getElementById("sidebar").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%")})}};e.\u0275fac=function(i){return new(i||e)(te(rt))},e.\u0275cmp=Le({type:e,selectors:[["app-log"]],decls:9,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],["routerLink","/login",1,"button"],["routerLink","/register",1,"button"]],template:function(i,s){i&1&&(C(0,"div",0),Z(1,"div",1),C(2,"div",2),Z(3,"img",3),C(4,"button",4),N(5,"Accedi"),T(),C(6,"button",5),N(7,"Registrati"),T()(),Z(8,"div",1),T())},dependencies:[jk]});let n=e;return n})();var ot=(()=>{let e=class e{constructor(r){this.router=r,this.currentSectorId="",this.linkObject={},this.linkCounter=0,this.ticketToRead=!1,this.messageQueue=[]}initNormalScreen(){window.innerWidth>=899&&(document.getElementById("sidebar-container").style.display="flex",document.getElementById("sidebar").style.display="flex",document.getElementById("header").style.display="flex",document.getElementById("router-outlet-container").style.height="calc(100% - 3.5rem)",document.getElementById("router-outlet-container").style.width="calc(100% - 18rem)")}getUserData(){G.auth().onAuthStateChanged(r=>{r?G.firestore().collection("users_data").doc(r.uid).get().then(i=>{if(i.exists){var s=i.data();this.currentUser=s,document.getElementById("header-name-display").innerText=this.currentUser.name,document.getElementById("header-surname-display").innerText=this.currentUser.surname,document.getElementById("header-email-display").innerText=this.currentUser.email,document.getElementById("header-agency-display").innerText=this.currentUser.agencyName}else this.presentToast("Nessun utente trovato"),this.router.navigate(["/log"])}).catch(i=>{this.presentToast("Errore durante il recupero dell'utente:"+i.message)}):(console.log("Nessun utente loggato."),this.router.navigate(["/log"]))})}convertTimestamp(r){let i=new Date(r),s=String(i.getDate()).padStart(2,"0"),o=String(i.getMonth()+1).padStart(2,"0"),a=String(i.getFullYear()),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0"),d=String(i.getSeconds()).padStart(2,"0");return`${s}/${o}/${a} ${c}:${l}:${d}`}presentToast(r){this.animate1("toast-message"),this.messageQueue.push(r),this.messageQueue.length===1&&this.showMessageFromQueue()}showMessageFromQueue(){let r=this.messageQueue[0];document.getElementById("toast-message").style.display="flex",document.getElementById("toast-message-text").innerText=r,setTimeout(()=>{this.hideToastMessage()},3e3)}hideToastMessage(){this.animateFadeOut("toast-message"),setTimeout(()=>{document.getElementById("toast-message").style.display="none"},100),this.messageQueue.shift(),this.messageQueue.length>0&&(this.showMessageFromQueue(),this.animate1("toast-message"))}openCloseSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}animate1(r){var i=document.getElementById(r),s=[{opacity:0},{opacity:1}],o={duration:150,easing:"ease-in-out"};i.animate(s,o)}animateFadeOut(r){var i=document.getElementById(r),s=[{opacity:1},{opacity:0}],o={duration:150,easing:"ease-out"};i.animate(s,o)}};e.\u0275fac=function(i){return new(i||e)(oe(rt))},e.\u0275prov=se({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var YB=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}login(){var r=document.getElementById("email-login-input").value,i=document.getElementById("password-login-input").value;G.auth().signInWithEmailAndPassword(r,i).then(s=>{var o=s.user;this.generalService.presentToast("Login effettuato con successo"),this.router.navigate(["/chat"])}).catch(s=>{s.code=="auth/invalid-credential"&&this.generalService.presentToast("Email o password non validi")})}};e.\u0275fac=function(i){return new(i||e)(te(ot),te(rt))},e.\u0275cmp=Le({type:e,selectors:[["app-login"]],decls:15,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate",2,"color","#333"],["id","email-login-input","type","text","placeholder","Email",1,"input"],["id","password-login-input","type","text","placeholder","Password",1,"input"],[1,"button",3,"click"]],template:function(i,s){i&1&&(C(0,"div",0),Z(1,"div",1),C(2,"div",2),Z(3,"img",3),C(4,"div",4)(5,"span",5),N(6,"mail"),T(),Z(7,"input",6),T(),C(8,"div",4)(9,"span",5),N(10,"key"),T(),Z(11,"input",7),T(),C(12,"button",8),Y("click",function(){return s.login()}),N(13,"Accedi"),T()(),Z(14,"div",1),T())}});let n=e;return n})();var OZ=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(te(gs),te(Li))},e.\u0275dir=$n({type:e});let n=e;return n})(),XB=(()=>{let e=class e extends OZ{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ro(e)))(s||e)}})(),e.\u0275dir=$n({type:e,features:[qu]});let n=e;return n})(),ZB=new de("");var FZ={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},zle=nt(H({},FZ),{"[class.ng-submitted]":"isSubmitted"});var LZ=new de("CallSetDisabledState",{providedIn:"root",factory:()=>ej}),ej="always";var VZ={provide:ZB,useExisting:$u(()=>nj),multi:!0};function tj(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function UZ(n){return n.split(":")[0]}var nj=(()=>{let e=class e extends XB{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=tj(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=UZ(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ro(e)))(s||e)}})(),e.\u0275dir=$n({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&Y("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[TI([VZ]),qu]});let n=e;return n})(),su=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(tj(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(te(Li),te(gs),te(nj,9))},e.\u0275dir=$n({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let n=e;return n})(),BZ={provide:ZB,useExisting:$u(()=>rj),multi:!0};function JB(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function jZ(n){return n.split(":")[0]}var rj=(()=>{let e=class e extends XB{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let l=a[c],d=this._getOptionValue(l.value);s.push(d)}}else{let a=i.options;for(let c=0;c<a.length;c++){let l=a[c];if(l.selected){let d=this._getOptionValue(l.value);s.push(d)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=jZ(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ro(e)))(s||e)}})(),e.\u0275dir=$n({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&Y("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[TI([BZ]),qu]});let n=e;return n})(),ou=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(JB(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(JB(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(te(Li),te(gs),te(rj,9))},e.\u0275dir=$n({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let n=e;return n})();var $Z=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Mn({type:e}),e.\u0275inj=Pn({});let n=e;return n})();var ij=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:LZ,useValue:r.callSetDisabledState??ej}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Mn({type:e}),e.\u0275inj=Pn({imports:[$Z]});let n=e;return n})();var sj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}register(){var r=document.getElementById("email-register-input").value,i=document.getElementById("password-register-input").value,s=document.getElementById("confirm-password-register-input").value,o=document.getElementById("name-register-input").value,a=document.getElementById("surname-register-input").value,c=document.getElementById("agency-name-register-input").value;i==s?G.auth().createUserWithEmailAndPassword(r,i).then(l=>{let d=l.user;var h=G.firestore();h.collection("users_data").doc(d.uid).set({uid:d.uid,name:o,surname:a,agencyName:c,email:r,registration_date:G.firestore.FieldValue.serverTimestamp()}).catch(p=>{this.generalService.presentToast("Errore nel salvataggio dei dati dell'utente durante la registrazione: "+p.message)}),this.generalService.presentToast("Registrazione completata con successo"),this.router.navigate(["/chat"])}).catch(l=>{l.code=="auth/invalid-email"&&this.generalService.presentToast("Email non valida"),l.code=="auth/weak-password"&&this.generalService.presentToast("Password troppo debole")}):this.generalService.presentToast("Le password inserite non corrispondono")}};e.\u0275fac=function(i){return new(i||e)(te(ot),te(rt))},e.\u0275cmp=Le({type:e,selectors:[["app-register"]],decls:43,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate"],["id","name-register-input","type","text","placeholder","Nome",1,"input"],["id","surname-register-input","type","text","placeholder","Cognome",1,"input"],["id","agency-name-register-input",2,"width","100%","height","100%","background","transparent","border","1px solid transparent"],["value","TORINO"],["value","ALBA"],["value","GRINZANE CAVOUR"],["value","ASTI"],["value","BRA"],["value","VADO LIGURE"],["id","email-register-input","type","email","placeholder","Email",1,"input"],["id","password-register-input","type","email","placeholder","Password",1,"input"],["id","confirm-password-register-input","type","email","placeholder","Conferma password",1,"input"],[1,"button",2,"width","100%","height","2.5rem",3,"click"]],template:function(i,s){i&1&&(C(0,"div",0),Z(1,"div",1),C(2,"div",2),Z(3,"img",3),C(4,"div",4)(5,"span",5),N(6,"person"),T(),Z(7,"input",6),T(),C(8,"div",4)(9,"span",5),N(10,"person"),T(),Z(11,"input",7),T(),C(12,"div",4)(13,"span",5),N(14,"store"),T(),C(15,"select",8)(16,"option",9),N(17,"TORINO"),T(),C(18,"option",10),N(19,"ALBA"),T(),C(20,"option",11),N(21,"GRINZANE CAVOUR"),T(),C(22,"option",12),N(23,"ASTI"),T(),C(24,"option",13),N(25,"BRA"),T(),C(26,"option",14),N(27,"VADO LIGURE"),T()()(),C(28,"div",4)(29,"span",5),N(30,"mail"),T(),Z(31,"input",15),T(),C(32,"div",4)(33,"span",5),N(34,"lock"),T(),Z(35,"input",16),T(),C(36,"div",4)(37,"span",5),N(38,"lock"),T(),Z(39,"input",17),T(),C(40,"button",18),Y("click",function(){return s.register()}),N(41,"Register"),T()(),Z(42,"div",1),T())},dependencies:[su,ou]});let n=e;return n})();function HZ(n,e){if(n&1){let t=qn();C(0,"div",9)(1,"span",10)(2,"strong"),N(3),T(),C(4,"span"),N(5),T(),Z(6,"div",11),C(7,"span",12),Y("click",function(){let i=on(t).$implicit,s=yt();return an(s.deleteMessage(i))}),N(8,"delete"),T()(),C(9,"p",13),N(10),T()()}if(n&2){let t=e.$implicit;he(3),Gu("",t.creator_name," ",t.creator_surname,""),he(2),Lt(t.creator_agency_name),he(5),Lt(t.message)}}var oj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.route=i,this.messages=[],this.chatName=""}ngOnInit(){this.route.queryParams.subscribe(r=>{this.currentChatId=r.id,this.chatName=r.name,this.getChatMessages()})}sendMessage(){var r={creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,creator_email:this.generalService.currentUser.email,chat_id:this.currentChatId,createdAt:G.firestore.FieldValue.serverTimestamp(),message:document.getElementById("chat-message-input").value};G.firestore().collection("chat_messages").doc().set(r).catch(i=>{this.generalService.presentToast("Errore durante l'invio del messaggio:"+i.message)})}getChatMessages(){this.messages=[],G.firestore().collection("chat_messages").orderBy("createdAt","desc").where("chat_id","==",this.currentChatId).limit(15).onSnapshot(i=>{if(!i.empty){this.messages=[],this.lastVisible=i.docs[i.docs.length-1];let s=i.docs.map(o=>H({id:o.id},o.data()));this.messages=[...s.reverse(),...this.messages]}})}deleteMessage(r){confirm("Sei sicuro di voler eliminare questo messaggio?")&&G.firestore().collection("chat_messages").doc(r.id).delete().then(()=>{this.generalService.presentToast("Messaggio eliminato con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione del messaggio: "+i.message)})}};e.\u0275fac=function(i){return new(i||e)(te(ot),te(xr))},e.\u0275cmp=Le({type:e,selectors:[["app-chat"]],decls:13,vars:2,consts:[[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","column","gap","1rem","overflow-y","auto","height","calc(100% - 4rem)","padding-top","1rem"],[1,"button",2,"margin-right","1rem",3,"click"],["id","chat-container",2,"display","flex","flex-direction","column","gap","1rem"],["class","chat-card","style","padding-top: 0.5rem;",4,"ngFor","ngForOf"],[2,"height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem","margin-top","1rem","margin-right","1rem"],["id","chat-message-input","placeholder","Inserisci qui il tuo messaggio",2,"width","calc(100% - 3.5rem)","border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'",3,"keydown.enter"],[2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[1,"chat-card",2,"padding-top","0.5rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[2,"flex","1"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer",3,"click"],[2,"margin-top","0.2rem","margin-bottom","0.5rem"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"h2"),N(2),T(),C(3,"div",1)(4,"button",2),Y("click",function(){return s.getChatMessages()}),N(5,"Carica messaggi precedenti"),T(),C(6,"div",3),Ft(7,HZ,11,4,"div",4),T()(),C(8,"div",5)(9,"input",6),Y("keydown.enter",function(){return s.sendMessage()}),T(),C(10,"button",7),Y("click",function(){return s.sendMessage()}),C(11,"span",8),N(12,"send"),T()()()()),i&2&&(he(2),Lt(s.chatName),he(5),Qe("ngForOf",s.messages))},dependencies:[Xr]});let n=e;return n})();var aj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.generalService.initNormalScreen()}};e.\u0275fac=function(i){return new(i||e)(te(ot))},e.\u0275cmp=Le({type:e,selectors:[["app-company"]],decls:24,vars:0,consts:[[2,"height","100%","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[1,"card",2,"padding","1rem","margin-top","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"width","3rem"],[2,"max-width","80%"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","flex-wrap","wrap","gap","1rem"],["href","https://www.agenziaautoteam.it/i-nostri-servizi/","target","_blank",1,"a_button",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"width","2rem"],[2,"margin-top","0rem","margin-bottom","0rem","color","black"],["href","assets\\pdf\\Web app autoteam nuova presentazione.pdf","target","_blank",1,"a_button",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"div",1)(2,"div",2),Z(3,"img",3),C(4,"h3"),N(5,"L'azienda | Mission"),T()(),C(6,"p",4)(7,"strong"),N(8,"CI SONO MOLTE AGENZIE DI PRATICHE AUTO, INFINITE POSSIBILIT\xC0 PER AUTOMOBILISTI E ADDETTI AI LAVORI. CHE COSA RENDE AUTOTEAM DIVERSA E UNICA?"),T()(),C(9,"p"),N(10,"NON CI SONO RICETTE SEGRETE: TUTTO PARTE DALLA PRECISA VOLONT\xC0 DI COSTRUIRE SOLIDE RELAZIONI CON I CLIENTI. DIALOGO, ASSISTENZA, PRESENZA: IN OGNI FASE DEL LAVORO, IN OGNI OCCASIONE, PER QUALSIASI NECESSIT\xC0, AUTOTEAM C'\xC8. UN'AMPIA GAMMA DI SERVIZI E UNA COSTANTE FORMAZIONE DEI COLLABORATORI GARANTISCE TEMPESTIVIT\xC0 E QUALIT\xC0 DEI SERVIZI, METTENDO A DISPOSIZIONE DELLA CLIENTELA PERSONALE ALTAMENTE QUALIFICATO E, DAL PUNTO DI VISTA UMANO, PERSONE DISPOSTE AD ASCOLTARE E A TROVARE LA SOLUZIONE MIGLIORE PER OGNI TIPO DI ESIGENZA."),T(),C(11,"p"),N(12,"UN TEAM FUNZIONA SE ALLA BASE CI SONO VALORI SOLIDI ECONDIVISI. AGENZIA AUTOTEAM CREDE PROFONDAMENTE NEL PROPRIO GRUPPO: STIMA, FIDUCIA, RISPETTO PER I COLLABORATORI SONO LE FONDAMENTA SULLE QUALI SI BASA LA NOSTRA IDEA DI GRUPPO."),T(),C(13,"p"),N(14,"OGNUNO \xC8 IMPORTANTE, IL CONTRIBUTO DI TUTTI CONTRIBUISCE ALLA CRESCITA E AL SUCCESSO."),T(),C(15,"div",5)(16,"a",6),Z(17,"img",7),C(18,"p",8),N(19,"Sito Web | Servizi"),T()(),C(20,"a",9),Z(21,"img",7),C(22,"p",8),N(23,"Presentazione Web App"),T()()()()())}});let n=e;return n})();function qZ(n,e){if(n&1){let t=qn();C(0,"div",11),Y("click",function(){let i=on(t).$implicit,s=yt(2);return an(s.openSectorFolder(i))}),C(1,"span",12),N(2,"folder"),T(),N(3),T()}if(n&2){let t=e.$implicit;he(3),No(" ",t," ")}}function zZ(n,e){if(n&1&&(C(0,"div",8)(1,"h4",9),N(2,"Cartelle:"),T(),Ft(3,qZ,4,1,"div",10),T()),n&2){let t=e.ngIf;he(3),Qe("ngForOf",t)}}function GZ(n,e){n&1&&(C(0,"span",26),N(1,"link"),T())}function WZ(n,e){n&1&&(C(0,"span",26),N(1,"picture_as_pdf"),T())}function KZ(n,e){n&1&&(C(0,"span",26),N(1,"movie"),T())}function QZ(n,e){n&1&&(C(0,"span",26),N(1,"movie"),T())}function YZ(n,e){n&1&&(C(0,"span",26),N(1,"volume_up"),T())}function JZ(n,e){if(n&1&&(C(0,"a",22)(1,"div",23),Z(2,"img",24),Ft(3,GZ,2,0,"span",25)(4,WZ,2,0,"span",25)(5,KZ,2,0,"span",25)(6,QZ,2,0,"span",25)(7,YZ,2,0,"span",25),N(8),T()()),n&2){let t=e.$implicit,r=yt().$implicit;Qe("href",r.links[t].link,Yp),he(3),Qe("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes(".com")),he(),Qe("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("pdf")),he(),Qe("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp4")),he(),Qe("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mkv")),he(),Qe("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp3")),he(),No(" ",r.links[t].label," ")}}function XZ(n,e){if(n&1&&(C(0,"a",22)(1,"div",23)(2,"span",26),N(3,"draft"),T(),N(4," Allegato "),T()()),n&2){let t=yt().$implicit;EI("href",t.storage_resource_link,Yp)}}function ZZ(n,e){if(n&1){let t=qn();C(0,"div",13)(1,"h3",14),N(2),Z(3,"div",15),C(4,"span",16),Y("click",function(){let i=on(t).$implicit,s=yt();return an(s.deleteProcedura(i))}),N(5,"delete"),T()(),C(6,"h4",17),N(7),T(),C(8,"p",18),N(9),T(),C(10,"div",19),Ft(11,JZ,9,7,"a",20)(12,XZ,5,1,"a",21),T()()}if(n&2){let t=e.$implicit,r=yt();he(2),CI(" ",t.creator_name," ",t.creator_surname," | ",t.creator_agency_name," | ",r.formatTimestamp(t.timestamp)," "),he(5),Lt(t.name),he(2),Lt(t.description),he(2),Qe("ngForOf",r.getObjectKeys(t.links)),he(),Qe("ngIf",t.storage_resource_link!="")}}var cj=(()=>{let e=class e{constructor(r,i,s){this.generalService=r,this.router=i,this.route=s,this.documents=new Me([]),this.lastVisible="",this.nextPageAvailable=!0,this.matchingKeys$=new Me([])}ngOnInit(){this.route.queryParams.subscribe(r=>{var i=r.sector_id,s=r.sector_name,o=r.sector_description;i==null&&this.router.navigate(["/chat"]),this.generalService.currentSectorId=i,document.getElementById("sector-name").innerText=s,document.getElementById("sector-description").innerText=o,this.getSectorProcedures(),this.getSectorFolders()})}getSectorProcedures(){this.documents=new Me([]),G.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).orderBy("timestamp","desc").startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(H({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+r.message),this.nextPageAvailable=!1})}getSectorFolders(){this.matchingKeys$=new Me([]),G.firestore().collection("sector_folders").doc("folders").get().then(r=>{if(r.exists){let i=r.data();if(i){let s=[];for(let[o,a]of Object.entries(i))if(a===this.generalService.currentSectorId){let c=o.lastIndexOf("-"),l=c===-1?o:o.substring(0,c);s.push(l)}this.matchingKeys$.next(s),this.generalService.foldersNames}}else console.log("Documento non trovato!")}).catch(r=>{this.generalService.presentToast("Errore nel recuperare le cartelle di questo settore: "+r.message)})}showAddProcedurePopup(){this.getSectorFolders(),this.generalService.linkObject={},this.generalService.linkCounter=0,this.fillFolderNameSelection(),document.getElementById("add-new-procedure-popup").style.display="flex"}fillFolderNameSelection(){let r=document.getElementById("add-procedure-folder-input");r.innerHTML='<option value="">SELEZIONA</option>',this.matchingKeys$.subscribe(i=>{i.forEach(s=>{let o=s.lastIndexOf("-"),a=o===-1?s:s.substring(0,o),c=document.createElement("option");c.value=a,c.textContent=a,r.appendChild(c)})})}showAddProcedureFolder(){document.getElementById("add-new-procedure-folder-popup").style.display="flex"}getObjectKeys(r){return Object.keys(r)}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}openSectorFolder(r){this.documents=new Me([]),G.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).where("folder_name","==",r).orderBy("timestamp","desc").startAfter(this.lastVisible).get().then(i=>{let s=[];if(i.forEach(o=>{s.push(H({id:o.id},o.data()))}),s.length>0){let a=[...this.documents.getValue(),...s];this.documents.next(a),s.length===4?this.lastVisible=i.docs[i.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(i=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+i.message),this.nextPageAvailable=!1})}deleteProcedura(r){confirm("Sei sicuro di voler cancellare questa procedura e tutti i suoi allegati?")&&G.firestore().collection("procedure").doc(r.id).delete().then(()=>{let i=Aa(G.storage(),r.storage_resource_path);Z_(i).then(()=>{this.generalService.presentToast("La procedura e i relativi allegati sono stati eliminati con successo")}).catch(s=>{this.generalService.presentToast("Errore durante l'eliminazione della procedura: 'DELETE FILE ERROR' "+s.message)})}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione della procedura: 'DELETE DOC ERROR' "+i.message)})}};e.\u0275fac=function(i){return new(i||e)(te(ot),te(rt),te(xr))},e.\u0275cmp=Le({type:e,selectors:[["app-settori"]],decls:16,vars:6,consts:[[2,"height","100%","overflow-y","auto","overflow-x","hidden","display","flex","flex-direction","column","padding-left","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.5rem"],["id","sector-name"],[1,"material-symbols-outlined","notranslate",2,"color","black","cursor","pointer","font-size","1.8rem",3,"click"],["id","sector-description",2,"margin-top","0rem"],["style","margin-bottom: 1rem;",4,"ngIf"],["id","procedure",2,"display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["class","card","style","padding-left: 1rem; padding-right: 1rem; padding-bottom: 1rem;",4,"ngFor","ngForOf"],[2,"margin-bottom","1rem"],[2,"margin-bottom","0.5rem"],["style","display: flex; flex-direction: row; align-items: center; gap: 0.5rem; cursor: pointer;",3,"click",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","cursor","pointer",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem"],[1,"card",2,"padding-left","1rem","padding-right","1rem","padding-bottom","1rem"],[2,"margin-bottom","0.5rem","display","flex","flex-direction","row","align-items","center"],[2,"flex","1"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer",3,"click"],[2,"margin-top","0rem","margin-bottom","0rem"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngFor","ngForOf"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngIf"],["target","_blank",2,"text-decoration","none",3,"href"],[1,"card",2,"height","2.5rem","display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem","padding-left","0.5rem","padding-right","0.5rem","border-radius","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"height","2rem","width","2rem"],["style","color: #313131; font-size: 1.8rem;","class","material-symbols-outlined notranslate",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"color","#313131","font-size","1.8rem"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"h2",1),Z(2,"span",2),N(3," | "),C(4,"span",3),Y("click",function(){return s.showAddProcedurePopup()}),N(5,"add_notes"),T(),Z(6,"span",2),N(7," | "),C(8,"span",3),Y("click",function(){return s.showAddProcedureFolder()}),N(9,"create_new_folder"),T()(),Z(10,"p",4),Ft(11,zZ,4,1,"div",5),Yr(12,"async"),C(13,"div",6),Ft(14,ZZ,13,8,"div",7),Yr(15,"async"),T()()),i&2&&(he(11),Qe("ngIf",Jr(12,2,s.matchingKeys$)),he(3),Qe("ngForOf",Jr(15,4,s.documents)))},dependencies:[Xr,wc,_s]});let n=e;return n})();var lj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.generalService.initNormalScreen()}};e.\u0275fac=function(i){return new(i||e)(te(ot))},e.\u0275cmp=Le({type:e,selectors:[["app-home"]],decls:1,vars:0,consts:[[2,"height","100%","padding-left","1rem","display","flex","flex-direction","row","flex-wrap","wrap"]],template:function(i,s){i&1&&Z(0,"div",0)}});let n=e;return n})();var ts={_origin:"https://api.emailjs.com"};var uj=(n,e="https://api.emailjs.com")=>{ts._userID=n,ts._origin=e};var Qy=(n,e,t)=>{if(!n)throw"The user ID is required. Visit https://dashboard.emailjs.com/admin/integration";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};var If=class{constructor(e){this.status=e.status,this.text=e.responseText}};var Yy=(n,e,t={})=>new Promise((r,i)=>{let s=new XMLHttpRequest;s.addEventListener("load",({target:o})=>{let a=new If(o);a.status===200||a.text==="OK"?r(a):i(a)}),s.addEventListener("error",({target:o})=>{i(new If(o))}),s.open("POST",ts._origin+n,!0),Object.keys(t).forEach(o=>{s.setRequestHeader(o,t[o])}),s.send(e)});var dj=(n,e,t,r)=>{let i=r||ts._userID;return Qy(i,n,e),Yy("/api/v1.0/email/send",JSON.stringify({lib_version:"3.2.0",user_id:i,service_id:n,template_id:e,template_params:t}),{"Content-type":"application/json"})};var eee=n=>{let e;if(typeof n=="string"?e=document.querySelector(n):e=n,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},hj=(n,e,t,r)=>{let i=r||ts._userID,s=eee(t);Qy(i,n,e);let o=new FormData(s);return o.append("lib_version","3.2.0"),o.append("service_id",n),o.append("template_id",e),o.append("user_id",i),Yy("/api/v1.0/email/send-form",o)};var sR={init:uj,send:dj,sendForm:hj};function tee(n,e){n&1&&(C(0,"span"),N(1,"Aperto"),T())}function nee(n,e){n&1&&(C(0,"span"),N(1,"Chiuso"),T())}function ree(n,e){if(n&1){let t=qn();C(0,"div",12)(1,"div",13)(2,"span",14),N(3,"account_circle"),T(),C(4,"p"),N(5),T(),Z(6,"div",11),C(7,"span",15),Y("click",function(){let i=on(t).$implicit,s=yt();return an(s.openTicketMenuPopup(i))}),N(8,"more_vert"),T()(),C(9,"h3",16),N(10),Ft(11,tee,2,0,"span",17)(12,nee,2,0,"span",17),T(),C(13,"p",18),N(14),T(),C(15,"div",19)(16,"div",20)(17,"div",21)(18,"span",22),N(19,"forum"),T(),C(20,"input",23),Y("keydown.enter",function(){let i=on(t).$implicit,s=yt();return an(s.addComment(i))}),T()(),C(21,"button",24),Y("click",function(){let i=on(t).$implicit,s=yt();return an(s.addComment(i))}),C(22,"span",25),N(23,"send"),T()()(),C(24,"p",26),Y("click",function(){let i=on(t).$implicit,s=yt();return an(s.getComments(i))}),C(25,"span",25),N(26,"keyboard_arrow_down"),T(),N(27,"Commenti"),T(),Z(28,"div",27),T()()}if(n&2){let t=e.$implicit;he(5),bI("",t.name," ",t.surname," | ",t.agencyName,""),he(5),No("",t.argomento," | "),he(),Qe("ngIf",t.status=="open"),he(),Qe("ngIf",t.status=="close"),he(2),Lt(t.descrizione),he(6),zu("id","comment-input-",t.id,""),he(8),zu("id","comment-section-",t.id,"")}}function iee(n,e){if(n&1){let t=qn();C(0,"button",28),Y("click",function(){on(t);let i=yt();return an(i.getMoreTickets())}),N(1,"Recupera altri ticket"),T()}}var fj=(()=>{let e=class e{constructor(r){this.generalService=r,this.documents=new Me([]),this.nextPageAvailable=!1,this.comments=new Me([])}ngOnInit(){this.generalService.initNormalScreen(),this.getOpenTickets(),this.setAllTicketsRead(),sR.init("TUO_USER_ID")}setAllTicketsRead(){return g(this,null,function*(){let r=wi(G.firestore(),"tickets"),i=yield B_(r);localStorage.setItem("last-ticket-count",i.data().count+""),this.generalService.ticketToRead=!1})}openAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="flex"}openTicketMenuPopup(r){this.generalService.currentTicket=r,document.getElementById("edit-menu-ticket-popup").style.display="flex",r.status=="open"&&(document.getElementById("open-ticket-button").style.display="none",document.getElementById("close-ticket-button").style.display="flex"),r.status=="close"&&(document.getElementById("open-ticket-button").style.display="flex",document.getElementById("close-ticket-button").style.display="none")}showCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="flex"}hideCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="none"}addComment(r){var i=G.auth().currentUser;let s=document.getElementById("comment-input-"+r.id),o=s.value;o.trim()&&(G.database().ref("/comments/"+r.id+"/").push({text:o,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,timestamp:G.database.ServerValue.TIMESTAMP,creator_uid:i.uid}),s.value="",this.getComments(r))}getComments(r){let i=document.getElementById("comment-section-"+r.id);i.innerHTML="",i.style.display=="none"?G.database().ref(`/comments/${r.id}/`).once("value").then(s=>{s.forEach(a=>{let c=a.key,l=a.val(),d=document.getElementById("comment-section-"+r.id),h=document.createElement("div");h.className="comment";let p=document.createElement("p");p.style.marginBottom="0.5rem",p.textContent=l.name+" "+l.surname+" | "+l.agencyName+" | "+this.convertTimestamp(l.timestamp);let _=document.createElement("p");_.style.marginBottom="0.5rem",_.textContent=l.text,h.appendChild(p),h.appendChild(_),d.appendChild(h)});let o=document.getElementById("comment-section-"+r.id);o&&(o.style.display="flex")}).catch(s=>{console.error("Errore durante il recupero dei commenti:",s)}):i.style.display="none"}convertTimestamp(r){let s=new Date(r).toISOString(),[o,a]=s.split("T"),[c,l,d]=o.split("-"),[h]=a.split(".");return`${d}/${l}/${c} ${h}`}getTickets(){return G.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(H({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{console.error("Error getting documents: ",r)})}getOpenTickets(){return G.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","open").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(H({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket aperti: "+r.message)})}getClosedTickets(){return G.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","close").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(H({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket chiusi: "+r.message)})}getMyTickets(){var r=G.auth().currentUser;return G.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("creator_id","==",r.uid).onSnapshot(i=>{let s=[];i.forEach(o=>{s.push(H({id:o.id},o.data()))}),s.length===4?(this.lastVisible=i.docs[i.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(s)},i=>{this.generalService.presentToast("Errore nel recuperare i tuoi ticket: "+i.message)})}getMoreTickets(){!this.lastVisible||!this.nextPageAvailable||G.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(H({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}sendEmails(){["esempio1@gmail.com","esempio2@gmail.com"].forEach(i=>{let s={to_email:i,from_name:"Il tuo nome",message:"Il tuo messaggio"};sR.send("service_id","template_id",s).then(o=>{console.log("Email inviata a: "+i,o.status,o.text)}).catch(o=>{console.log("Errore nell'invio dell'email a: "+i,o)})})}};e.\u0275fac=function(i){return new(i||e)(te(ot))},e.\u0275cmp=Le({type:e,selectors:[["app-tickets"]],decls:24,vars:4,consts:[[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","flex-wrap","wrap"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","black","font-size","1.8rem","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","border","1px solid rgba(0, 0, 0, 0.192)","border-radius","2rem","padding-left","1rem","padding-right","1rem","height","2.5rem","overflow-y","hidden","overflow-x","auto"],[2,"cursor","pointer",3,"click"],[2,"height","100%","width","1px","background","rgba(0, 0, 0, 0.192)"],[2,"overflow-y","auto","overflow-x","hidden","padding-bottom","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","card","style","padding-left: 1rem; padding-bottom: 1rem;",4,"ngFor","ngForOf"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],[2,"flex","1"],[1,"card",2,"padding-left","1rem","padding-bottom","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","padding-right","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem",3,"click"],[2,"margin-top","0rem","margin-bottom","0rem"],[4,"ngIf"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","column","align-items","center","padding-right","1rem"],[2,"width","100%","height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem"],[1,"input-group",2,"width","calc(100% - 3.5rem)"],[1,"material-symbols-outlined","notranslate"],["type","text","placeholder","Scrivi un commento",1,"input",3,"keydown.enter","id"],[2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[2,"cursor","pointer","display","flex","flex-direction","row","align-items","center","width","100%",3,"click"],[2,"display","none","flex-direction","column","gap","1rem","width","100%",3,"id"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"div",1)(2,"h2",2),N(3,"Tickets"),C(4,"span",3),Y("click",function(){return s.openAddTicketPopup()}),N(5,"add_circle"),T()(),C(6,"div",4)(7,"h3",5),Y("click",function(){return s.getOpenTickets()}),N(8,"Aperti"),T(),Z(9,"div",6),C(10,"h3",5),Y("click",function(){return s.getClosedTickets()}),N(11,"Chiusi"),T(),Z(12,"div",6),C(13,"h3",5),Y("click",function(){return s.getTickets()}),N(14,"Tutti"),T(),Z(15,"div",6),C(16,"h3",5),Y("click",function(){return s.getMyTickets()}),N(17,"Pubblicati da me"),T()()(),C(18,"div",7)(19,"div",8),Ft(20,ree,29,11,"div",9),Yr(21,"async"),Ft(22,iee,2,0,"button",10),T()(),Z(23,"div",11),T()),i&2&&(he(20),Qe("ngForOf",Jr(21,2,s.documents)),he(2),Qe("ngIf",s.nextPageAvailable))},dependencies:[Xr,wc,_s]});let n=e;return n})();function see(n,e){if(n&1){let t=qn();C(0,"tr",6)(1,"td",8),N(2),T(),C(3,"td",8),N(4),T(),C(5,"td",8),N(6),T(),C(7,"td",8)(8,"select",11),Y("change",function(){let i=on(t).$implicit,s=yt();return an(s.changeUserPermission(i))}),Z(9,"option",12),C(10,"option",13),N(11,"Nessuno"),T(),C(12,"option",14),N(13,"Normale"),T(),C(14,"option",15),N(15,"Admin"),T()()(),C(16,"td",8),N(17),T(),C(18,"td",8),N(19),T(),C(20,"td",8)(21,"div",16)(22,"span",17),N(23,"delete"),T()()()()}if(n&2){let t=e.$implicit,r=yt();he(2),Gu("",t.name," ",t.surname,""),he(2),Lt(t.email),he(2),Lt(t.agencyName),he(11),Lt(r.formatFirebaseTimestamp(t.registration_date)),he(2),Lt(t.id)}}var pj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.getUsesList()}formatFirebaseTimestamp(r){let i=new Date(r.seconds*1e3+r.nanoseconds/1e6),s={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"};return i.toLocaleString("it-IT",s)}getUsesList(){this.users=at(U_(wi(G.firestore(),"users_data")).then(r=>(console.log(this.users),r.docs.map(i=>H({id:i.id},i.data())))))}changeUserPermission(r){let i=document.getElementById("change-permission-type-input");confirm("Sei sicuro di voler modificare i permessi attribuiti a: "+r.email+"?")?i.value!=""&&G.firestore().collection("settings").doc("users_permissions").set({[r.uid]:i.value},{merge:!0}).then(()=>{alert("I permessi dell'utente: "+r.email+" sono stati modificati con successo")}):i.value=""}};e.\u0275fac=function(i){return new(i||e)(te(ot))},e.\u0275cmp=Le({type:e,selectors:[["app-settings"]],decls:26,vars:3,consts:[["id","settings-popup",2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],[2,"margin-top","0.5rem"],[2,"width","100%","overflow-x","auto","overflow-y","auto","border-radius","0.5rem"],[1,"table"],[1,"table-header"],[1,"table-row"],[1,"table-cell",2,"min-width","12rem"],[1,"table-cell"],[1,"table-body"],["class","table-row",4,"ngFor","ngForOf"],["id","change-permission-type-input",3,"change"],["value",""],["value","none"],["value","normal"],["value","admin"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","1rem"],[1,"material-symbols-outlined","notranslate","table-button"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"h2",1),N(2,"Impostazioni"),T(),C(3,"p",2),N(4,"Utenti e permessi"),T(),C(5,"div",3)(6,"table",4)(7,"thead",5)(8,"tr",6)(9,"th",7),N(10,"Nome e Cognome"),T(),C(11,"th",8),N(12,"Email"),T(),C(13,"th",8),N(14,"Agenzia"),T(),C(15,"th",8),N(16,"Permessi"),T(),C(17,"th",7),N(18,"Data Registrazione"),T(),C(19,"th",8),N(20,"ID"),T(),C(21,"th",8),N(22,"Azioni"),T()()(),C(23,"tbody",9),Ft(24,see,24,6,"tr",10),Yr(25,"async"),T()()()()),i&2&&(he(24),Qe("ngForOf",Jr(25,1,s.users)))},dependencies:[Xr,su,ou,_s]});let n=e;return n})();var mj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Le({type:e,selectors:[["app-zoom"]],decls:26,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-y","auto","overflow-x","hidden","padding-left","1rem","padding-right","1rem"],[1,"card",2,"margin-top","1rem","padding-left","1rem","padding-bottom","1rem"],[2,"width","100%","display","flex","flex-direction","column","gap","0.5rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem"],[2,"color","#333","margin-top","0rem","margin-bottom","0rem"],["href","https://zoom.us/it/signin#/login","target","_blank",2,"color","#333","margin-top","0rem","margin-bottom","0rem"],[2,"color","#333","text-decoration","underline","margin-top","0rem","margin-bottom","0rem"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"div",1)(2,"h3"),N(3,"Chiamata Zoom"),T(),C(4,"div",2)(5,"div",3)(6,"span",4),N(7,"link"),T(),C(8,"p",5),N(9,"Link:"),T(),C(10,"a",6),N(11,"https://zoom.us/it/signin#/login"),T()(),C(12,"div",3)(13,"span",4),N(14,"person"),T(),C(15,"p",5),N(16,"Nome Utente:"),T(),C(17,"p",7),N(18,"erika.c@agenziaautoteam.it"),T()(),C(19,"div",3)(20,"span",4),N(21,"key"),T(),C(22,"p",5),N(23,"Password:"),T(),C(24,"p",7),N(25,"Autoteam2022"),T()()()()())}});let n=e;return n})();var oee=[{path:"",redirectTo:"chat",pathMatch:"full"},{path:"log",component:QB},{path:"login",component:YB},{path:"register",component:sj},{path:"company",component:aj},{path:"chat",component:oj},{path:"procedure",component:cj},{path:"home",component:lj},{path:"tickets",component:fj},{path:"settings",component:pj},{path:"zoom",component:mj}],gj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Mn({type:e}),e.\u0275inj=Pn({imports:[UE.forRoot(oee),UE]});let n=e;return n})();function aee(n,e){if(n&1&&(C(0,"div",15)(1,"span",16),N(2),T()()),n&2){let t=yt();he(2),Lt(t.ticketToReadSidebar)}}function cee(n,e){if(n&1){let t=qn();C(0,"button",8),Y("click",function(){let i=on(t).$implicit,s=yt();return an(s.openChat(i))}),C(1,"span",9),N(2,"message"),T(),N(3),T()}if(n&2){let t=e.$implicit;he(3),Lt(t.name)}}function lee(n,e){if(n&1){let t=qn();C(0,"button",8),Y("click",function(){let i=on(t).$implicit,s=yt();return an(s.showSectorProcedures(i))}),C(1,"span",9),N(2,"library_books"),T(),N(3),T()}if(n&2){let t=e.$implicit;he(3),Lt(t.name)}}var _j=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.chatDocuments=new Me([]),this.documents=new Me([]),this.chats=new Me([])}ngOnInit(){document.addEventListener("DOMContentLoaded",()=>{this.openCloseSettoriEProcedure()})}goToRoute(r,i){this.closeSidebarMobile(),this.router.navigate(["/"+r])}closeSidebarMobile(){window.innerWidth<=899&&(document.getElementById("sidebar-container").style.display="none")}openChat(r){this.router.navigate(["/chat"],{queryParams:{id:r.id,name:r.name}})}newChat(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-chat-popup").style.display="flex"}newSector(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-sector-popup").style.display="flex"}hideOrShowSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}logout(){window.confirm("Sei sicuro di volerti disconnettere?")&&G.auth().signOut().then(()=>{this.generalService.presentToast("Disconnessione effettuata con successo"),this.router.navigate(["/log"])}).catch(r=>{this.generalService.presentToast("Errore durante la disconnessione: "+r.message)})}showSectorProcedures(r){this.router.navigate(["/procedure"],{queryParams:{sector_id:r.id,sector_name:r.name,sector_description:r.description}})}openCloseSettoriEProcedure(){let r=document.getElementById("settori-menu-container"),i=document.getElementById("open-menu-icon1");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):G.firestore().collection("settori").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(H({id:a.id},a.data()))}),this.documents.next(o),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero dei settori: "+s.message)})}openCloseChats(){let r=document.getElementById("chats-menu-container"),i=document.getElementById("open-menu-icon2");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):G.firestore().collection("chats").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(H({id:a.id},a.data()))}),this.chats.next(o),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero delle chat: "+s.message)})}};e.\u0275fac=function(i){return new(i||e)(te(ot),te(rt))},e.\u0275cmp=Le({type:e,selectors:[["app-sidebar"]],decls:47,vars:7,consts:[["id","sidebar-container",2,"display","flex","height","100%"],["id","sidebar",1,"desktop-element",2,"display","flex","flex-direction","column","width","18rem","flex-shrink","0","height","calc(100% - 3.5rem)","background","white","border-right","1px solid rgba(0, 0, 0, 0.192)","overflow-y","auto","overflow-x","hidden"],["src","assets\\imgs\\logo.png",2,"width","100%","margin-top","1rem"],[1,"sidebar-button",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["style","background: red; border-radius: 1rem; padding-left: 0.5rem; padding-right: 0.5rem;",4,"ngIf"],["id","open-menu-icon2",1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","chats-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem"],[1,"sidebar-button",2,"width","100%",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.8rem"],["class","sidebar-button","style","width: 100%;",3,"click",4,"ngFor","ngForOf"],["id","open-menu-icon1",1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","settori-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem"],[2,"flex","1"],[1,"sidebar-button",2,"margin-bottom","1rem",3,"click"],[2,"background","red","border-radius","1rem","padding-left","0.5rem","padding-right","0.5rem"],["id","ticket-to-read-sidebar-display",2,"color","white"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"div",1),Z(2,"img",2),C(3,"button",3),Y("click",function(){return s.goToRoute("company","close-sidebar")}),C(4,"span",4),N(5,"apartment"),T(),N(6,"L'azienda"),T(),C(7,"button",3),Y("click",function(){return s.goToRoute("tickets","close-sidebar")}),C(8,"span",4),N(9,"style"),T(),N(10,"Tickets "),Ft(11,aee,3,1,"div",5),T(),C(12,"button",3),Y("click",function(){return s.openCloseChats()}),C(13,"span",6),N(14,"keyboard_arrow_down"),T(),N(15,"Chat"),T(),C(16,"div",7)(17,"button",8),Y("click",function(){return s.newChat()}),C(18,"span",9),N(19,"add_circle"),T(),N(20,"Nuova chat"),T(),Ft(21,cee,4,1,"button",10),Yr(22,"async"),T(),C(23,"button",3),Y("click",function(){return s.openCloseSettoriEProcedure()}),C(24,"span",11),N(25,"keyboard_arrow_down"),T(),N(26,"Settori e procedure"),T(),C(27,"div",12)(28,"button",8),Y("click",function(){return s.newSector()}),C(29,"span",9),N(30,"add_circle"),T(),N(31,"Nuovo settore"),T(),Ft(32,lee,4,1,"button",10),Yr(33,"async"),T(),C(34,"button",3),Y("click",function(){return s.goToRoute("zoom","close-sidebar")}),C(35,"span",4),N(36,"videocam"),T(),N(37,"Chiamata Zoom"),T(),Z(38,"div",13),C(39,"button",3),Y("click",function(){return s.goToRoute("settings","close-sidebar")}),C(40,"span",4),N(41,"settings"),T(),N(42,"Impostazioni"),T(),C(43,"button",14),Y("click",function(){return s.logout()}),C(44,"span",4),N(45,"logout"),T(),N(46,"Disconnetti"),T()()()),i&2&&(he(11),Qe("ngIf",s.generalService.ticketToRead==!0),he(10),Qe("ngForOf",Jr(22,3,s.chats)),he(11),Qe("ngForOf",Jr(33,5,s.documents)))},dependencies:[Xr,wc,_s]});let n=e;return n})();var yj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.documents=new Me([]),this.chatDocuments=new Me([]),this.downloadURL=""}ngOnInit(){}closeAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="none"}closeTicketMenuPopup(){document.getElementById("edit-menu-ticket-popup").style.display="none"}closeAddNewSectorPopup(){document.getElementById("add-new-sector-popup").style.display="none"}closeAddNewProcedurePopup(){document.getElementById("add-new-procedure-popup").style.display="none"}closeAddNewProcedureFolderPopup(){document.getElementById("add-new-procedure-folder-popup").style.display="none"}closeAddNewChatPopup(){document.getElementById("add-new-chat-popup").style.display="none"}addTicket(){let r=document.getElementById("add-ticket-argomento-input").value,i=document.getElementById("add-ticket-description-input").value;var s=G.auth().currentUser;G.firestore().collection("tickets").add({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:s.email,creator_id:s.uid,timestamp:G.firestore.FieldValue.serverTimestamp(),status:"open"}).then(o=>{document.getElementById("add-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del ticket: "+o.message)})}deleteTicket(){window.confirm("Sei sicuro di voler eliminare questo ticket?")&&G.firestore().collection("tickets").doc(this.generalService.currentTicket.id).delete().then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket eliminato con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'eliminazione del ticket: "+r.message)})}openTicket(){G.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"open"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aperto con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'apertura del ticket: "+r.message)})}closeTicket(){G.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"close"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket chiuso con successo")}).catch(r=>{this.generalService.presentToast("Errore durante la chiusura del ticket: "+r.message)})}addNewSector(){let r=document.getElementById("add-sector-name-input"),i=document.getElementById("add-sector-description-input");var s=G.auth().currentUser;G.firestore().collection("settori").doc().set({name:r.value,description:i.value,timestamp:G.firestore.FieldValue.serverTimestamp(),creator_id:s.uid}).then(()=>{document.getElementById("add-new-sector-popup").style.display="none",this.generalService.presentToast("Settore aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del settore: "+o.message)})}addNewProcedureLink(){let r=document.getElementById("add-procedure-label-input"),i=document.getElementById("add-procedure-link-input"),s=document.getElementById("add-procedure-links-container"),o={label:r.value,link:i.value};this.generalService.linkObject[`resource${this.generalService.linkCounter}`]=o;let a=document.createElement("div");a.className="card",a.id=`entry${this.generalService.linkCounter}`,a.style.paddingLeft="0.8rem",a.style.borderRadius="0.5rem";let c=document.createElement("div");c.className="card-body";let l=document.createElement("h5");l.className="card-title",l.innerText=r.value,l.style.marginTop="0.5rem",l.style.marginBottom="0.5rem";let d=document.createElement("a");d.className="card-link",d.href=i.value,d.innerText=i.value,d.target="_blank",d.style.marginBottom="0.5rem",c.appendChild(l),c.appendChild(d),a.appendChild(c),s.appendChild(a),this.generalService.linkCounter++,r.value="",i.value=""}addNewProcedure(){let r=document.getElementById("add-procedure-name-input"),i=document.getElementById("add-procedure-description-input"),s=document.getElementById("fileInput2"),o=document.getElementById("uploadProgress"),a=document.getElementById("uploadStatus"),c=document.getElementById("add-procedure-folder-input");if(s.files&&s.files.length>0){let d=s.files[0];var l="files/"+d.name+"-date"+Date.now();let h=Aa(G.storage(),l),p=J_(h,d);p.on("state_changed",_=>{let w=_.bytesTransferred/_.totalBytes*100;switch(o&&(o.value=w),a&&(a.textContent=`Caricamento: ${w.toFixed(2)}%`),_.state){case"paused":console.log("Caricamento in pausa");break;case"running":console.log("Caricamento in corso");break}},_=>{console.error("Errore nel caricamento:",_),a&&(a.textContent="Errore nel caricamento")},()=>{X_(p.snapshot.ref).then(_=>{this.downloadURL=_,a&&G.firestore().collection("procedure").doc().set({name:r.value,description:i.value,sector_id:this.generalService.currentSectorId,folder_name:c.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,timestamp:G.firestore.FieldValue.serverTimestamp(),links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:this.downloadURL,storage_resource_path:l}).then(()=>{document.getElementById("add-procedure-name-input").value="",document.getElementById("add-procedure-description-input").value="",document.getElementById("add-procedure-label-input").value="",document.getElementById("add-procedure-link-input").value="",document.getElementById("add-procedure-links-container").innerHTML="",document.getElementById("add-new-procedure-popup").style.display="none",this.generalService.presentToast("Procedura aggiunta con successo")}).catch(w=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+w.message)})})})}else G.firestore().collection("procedure").doc().set({name:r.value,description:i.value,sector_id:this.generalService.currentSectorId,folder_name:c.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,timestamp:G.firestore.FieldValue.serverTimestamp(),links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:"",storage_resource_path:""}).then(()=>{document.getElementById("add-procedure-name-input").value="",document.getElementById("add-procedure-description-input").value="",document.getElementById("add-procedure-label-input").value="",document.getElementById("add-procedure-link-input").value="",document.getElementById("add-procedure-links-container").innerHTML="",document.getElementById("add-new-procedure-popup").style.display="none",this.generalService.presentToast("Procedura aggiunta con successo")}).catch(d=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+d.message)})}addNewChat(){let r=document.getElementById("add-chat-name-input"),i=document.getElementById("add-chat-description-input");G.firestore().collection("chats").doc().set({name:r.value,description:i.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,timestamp:G.firestore.FieldValue.serverTimestamp()}).then(()=>{document.getElementById("add-chat-name-input").value="",document.getElementById("add-chat-description-input").value="",document.getElementById("add-new-chat-popup").style.display="none",this.generalService.presentToast("Chat creata con successo")}).catch(s=>{this.generalService.presentToast("Errore durante la creazione della chat: "+s.message)})}addNewProcedureFolder(){let r=document.getElementById("add-procedure-folder-name-input");G.firestore().collection("sector_folders").doc("folders").set({[r.value+"-"+Date.now()]:this.generalService.currentSectorId},{merge:!0}).then(()=>{document.getElementById("add-new-procedure-folder-popup").style.display="none",this.generalService.presentToast("Cartella aggiunta con successo")}).catch(i=>{this.generalService.presentToast("Errore durante la creazione della cartella: "+i.message)})}openNewTicketEmailTrigger(){return g(this,null,function*(){let r="https://api.web3forms.com/submit",i=document.createElement("div");document.body.appendChild(i);var s={access_key:"d5cd7471-0bd2-4973-b1de-86b0e38bb63f",name:"John Doe",email:"verdev.web@gmail.com",message:"Hello, this is a test message.",botcheck:""};i.innerHTML="Please wait...";let o=JSON.stringify(s);try{let a=yield fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:o}),c=yield a.json();a.status===200?i.innerHTML="Form submitted successfully":(console.log(a),i.innerHTML=c.message)}catch(a){console.log(a),i.innerHTML="Something went wrong!"}setTimeout(()=>{i.style.display="none"},3e3)})}};e.\u0275fac=function(i){return new(i||e)(te(ot),te(rt))},e.\u0275cmp=Le({type:e,selectors:[["app-popups"]],decls:100,vars:0,consts:[["id","toast-message",2,"height","100%","width","100%","display","none","flex-direction","column","pointer-events","none","background","transparent","z-index","99999999","position","absolute","align-items","center","justify-content","end"],[1,"toastMessage",2,"pointer-events","all","width","95%"],["id","toast-message-text",2,"width","100%"],["id","add-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"min-width","18rem","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","space-between"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","black","cursor","pointer",3,"click"],[2,"width","100%","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-ticket-argomento-input","type","text","placeholder","Argomento",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-ticket-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[1,"button",3,"click"],["id","edit-menu-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[2,"display","flex","flex-direction","column","gap","1rem"],["id","open-ticket-button",1,"button",3,"click"],["id","close-ticket-button",1,"button",3,"click"],["id","add-new-chat-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-chat-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-chat-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-sector-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-sector-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-sector-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-procedure-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","50rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"width","100%","display","flex","flex-direction","row","flex-wrap","wrap","gap","1rem"],[2,"flex","1","min-width","15rem","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-procedure-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[2,"margin-top","-0.5rem","margin-bottom","-0.5rem","color","#333"],["id","add-procedure-folder-input",1,"inputGroup1",2,"height","2.5rem","border-radius","0.5rem"],["value",""],["id","add-procedure-label-input","type","text","placeholder","Etichetta",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-link-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-links-container",2,"display","flex","flex-direction","column","gap","0.5rem"],["id","fileInput2","type","file",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","padding-top","1rem"],["id","uploadProgress","value","0","max","100",2,"width","100%"],["id","uploadStatus"],["id","add-new-procedure-folder-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","30rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],["id","add-procedure-folder-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"div",1),Z(2,"p",2),T()(),C(3,"div",3)(4,"div",4)(5,"h3",5),N(6,"Nuovo Ticket"),C(7,"span",6),Y("click",function(){return s.closeAddTicketPopup()}),N(8,"close"),T()(),C(9,"div",7),Z(10,"input",8)(11,"textarea",9),T(),C(12,"div",5)(13,"button",10),Y("click",function(){return s.closeAddTicketPopup()}),N(14,"Annulla"),T(),C(15,"button",10),Y("click",function(){return s.addTicket()}),N(16,"Pubblica"),T()()()(),C(17,"div",11)(18,"div",4)(19,"h3",5),N(20,"Men\xF9 ticket"),C(21,"span",6),Y("click",function(){return s.closeTicketMenuPopup()}),N(22,"close"),T()(),C(23,"div",12)(24,"button",10),Y("click",function(){return s.deleteTicket()}),N(25,"Elimina"),T(),C(26,"button",13),Y("click",function(){return s.openTicket()}),N(27,"Apri"),T(),C(28,"button",14),Y("click",function(){return s.closeTicket()}),N(29,"Chiudi"),T()()()(),C(30,"div",15)(31,"div",4)(32,"h3",5),N(33,"Nuova Chat"),C(34,"span",6),Y("click",function(){return s.closeAddNewChatPopup()}),N(35,"close"),T()(),C(36,"div",7),Z(37,"input",16)(38,"textarea",17),T(),C(39,"div",5)(40,"button",10),Y("click",function(){return s.closeAddNewChatPopup()}),N(41,"Annulla"),T(),C(42,"button",10),Y("click",function(){return s.addNewChat()}),N(43,"Aggiungi"),T()()()(),C(44,"div",18)(45,"div",4)(46,"h3",5),N(47,"Nuovo settore"),C(48,"span",6),Y("click",function(){return s.closeAddNewSectorPopup()}),N(49,"close"),T()(),C(50,"div",7),Z(51,"input",19)(52,"textarea",20),T(),C(53,"div",5)(54,"button",10),Y("click",function(){return s.closeAddNewSectorPopup()}),N(55,"Annulla"),T(),C(56,"button",10),Y("click",function(){return s.addNewSector()}),N(57,"Aggiungi"),T()()()(),C(58,"div",21)(59,"div",22)(60,"h3",5),N(61,"Nuova procedura"),C(62,"span",6),Y("click",function(){return s.closeAddNewProcedurePopup()}),N(63,"close"),T()(),C(64,"div",23)(65,"div",24),Z(66,"input",25)(67,"textarea",26),C(68,"p",27),N(69,"Cartella"),T(),C(70,"select",28),Z(71,"option",29),T()(),C(72,"div",24),Z(73,"input",30)(74,"input",31),C(75,"button",10),Y("click",function(){return s.addNewProcedureLink()}),N(76,"Aggiungi Risorsa"),T(),Z(77,"div",32)(78,"input",33)(79,"progress",34)(80,"span",35),T()(),C(81,"div",5)(82,"button",10),Y("click",function(){return s.closeAddNewProcedurePopup()}),N(83,"Annulla"),T(),C(84,"button",10),Y("click",function(){return s.addNewProcedure()}),N(85,"Conferma"),T()()()(),C(86,"div",36)(87,"div",37)(88,"h3",5),N(89,"Nuova cartella"),C(90,"span",6),Y("click",function(){return s.closeAddNewProcedureFolderPopup()}),N(91,"close"),T()(),C(92,"div",23)(93,"div",24),Z(94,"input",38),T()(),C(95,"div",5)(96,"button",10),Y("click",function(){return s.closeAddNewProcedureFolderPopup()}),N(97,"Annulla"),T(),C(98,"button",10),Y("click",function(){return s.addNewProcedureFolder()}),N(99,"Conferma"),T()()()())},dependencies:[su,ou]});let n=e;return n})();var vj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){}hideOrShowSidebar(){this.generalService.openCloseSidebar()}openCloseSidebar(){this.generalService.openCloseSidebar()}};e.\u0275fac=function(i){return new(i||e)(te(ot))},e.\u0275cmp=Le({type:e,selectors:[["app-header"]],decls:16,vars:0,consts:[["id","header",2,"height","3.5rem","border-bottom","1px solid rgba(0, 0, 0, 0.192)","display","flex","flex-direction","row","align-items","center","flex-shrink","0","justify-content","space-between","padding-left","1rem","padding-right","1rem"],[1,"desktop-element",2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2rem","color","#333","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.3rem"],["id","header-name-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-surname-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-email-display",2,"margin-top","0rem","margin-bottom","0rem"],["id","header-agency-display",2,"margin-bottom","0rem","margin-top","0rem"],[1,"mobile-element",2,"display","none","flex-direction","row","align-items","center","gap","1rem"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"div",1)(2,"span",2),Y("click",function(){return s.openCloseSidebar()}),N(3,"menu"),T(),C(4,"div")(5,"div",3),Z(6,"h3",4)(7,"h3",5),T(),Z(8,"p",6),T(),C(9,"p"),N(10," | "),T(),C(11,"div"),Z(12,"h3",7),T()(),C(13,"div",8)(14,"span",2),Y("click",function(){return s.hideOrShowSidebar()}),N(15,"menu"),T()()())}});let n=e;return n})();var wj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.initFirebase(),this.generalService.getUserData()}ngOnInit(){G.auth().onAuthStateChanged(i=>{i?(this.generalService.initNormalScreen(),this.checkForNewTickets()):this.router.navigate(["/log"])}),Oh(wi(G.firestore(),"tickets"),i=>{i.docChanges().forEach(s=>{this.checkForNewTickets()})})}checkForNewTickets(){return g(this,null,function*(){let r=wi(G.firestore(),"tickets"),i=yield B_(r);localStorage.getItem("last-ticket-count")!=null?Number(localStorage.getItem("last-ticket-count"))<i.data().count?(this.generalService.ticketToRead=!0,this.ticketToReadSidebar=i.data().count-Number(localStorage.getItem("last-ticket-count")),console.log("Hai nuovi ticket da leggere")):(this.generalService.ticketToRead=!1,console.log("Non Hai nessun ticket nuovo da leggere")):(localStorage.setItem("last-ticket-count","0"),this.checkForNewTickets())})}initFirebase(){let r={apiKey:"AIzaSyD_tP0OvuudgC3fbvxHs9SyCl5bMYnW3S4",authDomain:"ttm-db-82f02.firebaseapp.com",projectId:"ttm-db-82f02",storageBucket:"ttm-db-82f02.appspot.com",messagingSenderId:"264736388729",appId:"1:264736388729:web:4f5b8c6411d3ef47a786a8",measurementId:"G-FQYCE4Q6XN"};G.initializeApp(r)}openCloseSidebar(){this.generalService.openCloseSidebar()}};e.\u0275fac=function(i){return new(i||e)(te(ot),te(rt))},e.\u0275cmp=Le({type:e,selectors:[["app-root"]],decls:7,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","row"],[2,"height","100%"],[2,"height","100%","width","100%"],["id","router-outlet-container",2,"width","calc(100% - 18rem)","height","calc(100% - 3.5rem)"]],template:function(i,s){i&1&&(Z(0,"app-popups")(1,"app-header"),C(2,"div",0)(3,"div",1),Z(4,"app-sidebar",2),T(),C(5,"div",3),Z(6,"router-outlet"),T()())},dependencies:[PE,_j,yj,vj]});let n=e;return n})();var Ij=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Mn({type:e,bootstrap:[wj]}),e.\u0275inj=Pn({providers:[{provide:Rr,useClass:mm}],imports:[ZM,ij,gj]});let n=e;return n})();XM().bootstrapModule(Ij).catch(n=>console.error(n));
