var sR=Object.defineProperty,Jj=Object.defineProperties;var Xj=Object.getOwnPropertyDescriptors;var rR=Object.getOwnPropertySymbols,Zj=Object.getPrototypeOf,e$=Object.prototype.hasOwnProperty,t$=Object.prototype.propertyIsEnumerable,n$=Reflect.get;var iR=(n,e,t)=>e in n?sR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,q=(n,e)=>{for(var t in e||={})e$.call(e,t)&&iR(n,t,e[t]);if(rR)for(var t of rR(e))t$.call(e,t)&&iR(n,t,e[t]);return n},st=(n,e)=>Jj(n,Xj(e));var r$=(n,e)=>{for(var t in e)sR(n,t,{get:e[t],enumerable:!0})};var Gr=(n,e,t)=>n$(Zj(n),t,e);var g=(n,e,t)=>new Promise((r,i)=>{var s=c=>{try{a(t.next(c))}catch(l){i(l)}},o=c=>{try{a(t.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(n,e)).next())});var oR=null;var vv=1,aR=Symbol("SIGNAL");function Oe(n){let e=oR;return oR=n,e}var cR={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function i$(n){if(!(Ev(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===vv)){if(!n.producerMustRecompute(n)&&!wv(n)){n.dirty=!1,n.lastCleanEpoch=vv;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=vv}}function lR(n){return n&&(n.nextProducerIndex=0),Oe(n)}function uR(n,e){if(Oe(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Ev(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Iv(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function wv(n){Uf(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(i$(t),r!==t.version))return!0}return!1}function dR(n){if(Uf(n),Ev(n))for(let e=0;e<n.producerNode.length;e++)Iv(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Iv(n,e){if(s$(n),Uf(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)Iv(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Uf(i),i.producerIndexOfThis[r]=e}}function Ev(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Uf(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function s$(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function o$(){throw new Error}var a$=o$;function hR(n){a$=n}function fe(n){return typeof n=="function"}function Ga(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Bf=Ga(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Au(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Vt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(fe(r))try{r()}catch(s){e=s instanceof Bf?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{fR(s)}catch(o){e=e??[],o instanceof Bf?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Bf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)fR(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Au(t,e)}remove(e){let{_finalizers:t}=this;t&&Au(t,e),e instanceof n&&e._removeParent(this)}};Vt.EMPTY=(()=>{let n=new Vt;return n.closed=!0,n})();var bv=Vt.EMPTY;function jf(n){return n instanceof Vt||n&&"closed"in n&&fe(n.remove)&&fe(n.add)&&fe(n.unsubscribe)}function fR(n){fe(n)?n():n.unsubscribe()}var Cr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Wa={setTimeout(n,e,...t){let{delegate:r}=Wa;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Wa;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function $f(n){Wa.setTimeout(()=>{let{onUnhandledError:e}=Cr;if(e)e(n);else throw n})}function xu(){}var pR=Cv("C",void 0,void 0);function mR(n){return Cv("E",void 0,n)}function gR(n){return Cv("N",n,void 0)}function Cv(n,e,t){return{kind:n,value:e,error:t}}var _o=null;function Ka(n){if(Cr.useDeprecatedSynchronousErrorHandling){let e=!_o;if(e&&(_o={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=_o;if(_o=null,t)throw r}}else n()}function _R(n){Cr.useDeprecatedSynchronousErrorHandling&&_o&&(_o.errorThrown=!0,_o.error=n)}var yo=class extends Vt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,jf(e)&&e.add(this)):this.destination=u$}static create(e,t,r){return new Qa(e,t,r)}next(e){this.isStopped?Sv(gR(e),this):this._next(e)}error(e){this.isStopped?Sv(mR(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Sv(pR,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},c$=Function.prototype.bind;function Tv(n,e){return c$.call(n,e)}var Dv=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Hf(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Hf(r)}else Hf(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Hf(t)}}},Qa=class extends yo{constructor(e,t,r){super();let i;if(fe(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Cr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Tv(e.next,s),error:e.error&&Tv(e.error,s),complete:e.complete&&Tv(e.complete,s)}):i=e}this.destination=new Dv(i)}};function Hf(n){Cr.useDeprecatedSynchronousErrorHandling?_R(n):$f(n)}function l$(n){throw n}function Sv(n,e){let{onStoppedNotification:t}=Cr;t&&Wa.setTimeout(()=>t(n,e))}var u$={closed:!0,next:xu,error:l$,complete:xu};var Ya=typeof Symbol=="function"&&Symbol.observable||"@@observable";function $n(n){return n}function Av(...n){return xv(n)}function xv(n){return n.length===0?$n:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Ue=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=h$(t)?t:new Qa(t,r,i);return Ka(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=yR(r),new r((i,s)=>{let o=new Qa({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Ya](){return this}pipe(...t){return xv(t)(this)}toPromise(t){return t=yR(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function yR(n){var e;return(e=n??Cr.Promise)!==null&&e!==void 0?e:Promise}function d$(n){return n&&fe(n.next)&&fe(n.error)&&fe(n.complete)}function h$(n){return n&&n instanceof yo||d$(n)&&jf(n)}function Rv(n){return fe(n?.lift)}function xe(n){return e=>{if(Rv(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Re(n,e,t,r,i){return new Nv(n,e,t,r,i)}var Nv=class extends yo{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ja(){return xe((n,e)=>{let t=null;n._refCount++;let r=Re(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Xa=class extends Ue{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Rv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Vt;let t=this.getSubject();e.add(this.source.subscribe(Re(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Vt.EMPTY)}return e}refCount(){return Ja()(this)}};var vR=Ga(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var sn=(()=>{class n extends Ue{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new qf(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new vR}next(t){Ka(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Ka(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Ka(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?bv:(this.currentObservers=null,s.push(t),new Vt(()=>{this.currentObservers=null,Au(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new Ue;return t.source=this,t}}return n.create=(e,t)=>new qf(e,t),n})(),qf=class extends sn{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:bv}};var Ne=class extends sn{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Hn=new Ue(n=>n.complete());function wR(n){return n&&fe(n.schedule)}function IR(n){return n[n.length-1]}function ER(n){return fe(IR(n))?n.pop():void 0}function as(n){return wR(IR(n))?n.pop():void 0}function zf(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function CR(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{l(r.next(d))}catch(h){o(h)}}function c(d){try{l(r.throw(d))}catch(h){o(h)}}function l(d){d.done?s(d.value):i(d.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function bR(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function vo(n){return this instanceof vo?(this.v=n,this):new vo(n)}function TR(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(w){return Promise.resolve(w).then(_,h)}}function a(_,w){r[_]&&(i[_]=function(A){return new Promise(function(R,L){s.push([_,A,R,L])>1||c(_,A)})},w&&(i[_]=w(i[_])))}function c(_,w){try{l(r[_](w))}catch(A){p(s[0][3],A)}}function l(_){_.value instanceof vo?Promise.resolve(_.value.v).then(d,h):p(s[0][2],_)}function d(_){c("next",_)}function h(_){c("throw",_)}function p(_,w){_(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function SR(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof bR=="function"?bR(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Gf=n=>n&&typeof n.length=="number"&&typeof n!="function";function Wf(n){return fe(n?.then)}function Kf(n){return fe(n[Ya])}function Qf(n){return Symbol.asyncIterator&&fe(n?.[Symbol.asyncIterator])}function Yf(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function f$(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Jf=f$();function Xf(n){return fe(n?.[Jf])}function Zf(n){return TR(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield vo(t.read());if(i)return yield vo(void 0);yield yield vo(r)}}finally{t.releaseLock()}})}function ep(n){return fe(n?.getReader)}function jt(n){if(n instanceof Ue)return n;if(n!=null){if(Kf(n))return p$(n);if(Gf(n))return m$(n);if(Wf(n))return g$(n);if(Qf(n))return DR(n);if(Xf(n))return _$(n);if(ep(n))return y$(n)}throw Yf(n)}function p$(n){return new Ue(e=>{let t=n[Ya]();if(fe(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function m$(n){return new Ue(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function g$(n){return new Ue(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,$f)})}function _$(n){return new Ue(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function DR(n){return new Ue(e=>{v$(n,e).catch(t=>e.error(t))})}function y$(n){return DR(Zf(n))}function v$(n,e){var t,r,i,s;return CR(this,void 0,void 0,function*(){try{for(t=SR(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function xn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function tp(n,e=0){return xe((t,r)=>{t.subscribe(Re(r,i=>xn(r,n,()=>r.next(i),e),()=>xn(r,n,()=>r.complete(),e),i=>xn(r,n,()=>r.error(i),e)))})}function np(n,e=0){return xe((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function AR(n,e){return jt(n).pipe(np(e),tp(e))}function xR(n,e){return jt(n).pipe(np(e),tp(e))}function RR(n,e){return new Ue(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function NR(n,e){return new Ue(t=>{let r;return xn(t,e,()=>{r=n[Jf](),xn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>fe(r?.return)&&r.return()})}function rp(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ue(t=>{xn(t,e,()=>{let r=n[Symbol.asyncIterator]();xn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function PR(n,e){return rp(Zf(n),e)}function MR(n,e){if(n!=null){if(Kf(n))return AR(n,e);if(Gf(n))return RR(n,e);if(Wf(n))return xR(n,e);if(Qf(n))return rp(n,e);if(Xf(n))return NR(n,e);if(ep(n))return PR(n,e)}throw Yf(n)}function Et(n,e){return e?MR(n,e):jt(n)}function ue(...n){let e=as(n);return Et(n,e)}function Za(n,e){let t=fe(n)?n:()=>n,r=i=>i.error(t());return new Ue(e?i=>e.schedule(r,0,i):r)}function Pv(n){return!!n&&(n instanceof Ue||fe(n.lift)&&fe(n.subscribe))}var Fi=Ga(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Pe(n,e){return xe((t,r)=>{let i=0;t.subscribe(Re(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:w$}=Array;function I$(n,e){return w$(e)?n(...e):n(e)}function kR(n){return Pe(e=>I$(n,e))}var{isArray:E$}=Array,{getPrototypeOf:b$,prototype:C$,keys:T$}=Object;function OR(n){if(n.length===1){let e=n[0];if(E$(e))return{args:e,keys:null};if(S$(e)){let t=T$(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function S$(n){return n&&typeof n=="object"&&b$(n)===C$}function FR(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Ru(...n){let e=as(n),t=ER(n),{args:r,keys:i}=OR(n);if(r.length===0)return Et([],e);let s=new Ue(D$(r,e,i?o=>FR(i,o):$n));return t?s.pipe(kR(t)):s}function D$(n,e,t=$n){return r=>{LR(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)LR(e,()=>{let l=Et(n[c],e),d=!1;l.subscribe(Re(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function LR(n,e,t){n?xn(t,n,e):e()}function VR(n,e,t,r,i,s,o,a){let c=[],l=0,d=0,h=!1,p=()=>{h&&!c.length&&!l&&e.complete()},_=A=>l<r?w(A):c.push(A),w=A=>{s&&e.next(A),l++;let R=!1;jt(t(A,d++)).subscribe(Re(e,L=>{i?.(L),s?_(L):e.next(L)},()=>{R=!0},void 0,()=>{if(R)try{for(l--;c.length&&l<r;){let L=c.shift();o?xn(e,o,()=>w(L)):w(L)}p()}catch(L){e.error(L)}}))};return n.subscribe(Re(e,_,()=>{h=!0,p()})),()=>{a?.()}}function At(n,e,t=1/0){return fe(e)?At((r,i)=>Pe((s,o)=>e(r,s,i,o))(jt(n(r,i))),t):(typeof e=="number"&&(t=e),xe((r,i)=>VR(r,i,n,t)))}function ec(n=1/0){return At($n,n)}function UR(){return ec(1)}function tc(...n){return UR()(Et(n,as(n)))}function ip(n){return new Ue(e=>{jt(n()).subscribe(e)})}function nr(n,e){return xe((t,r)=>{let i=0;t.subscribe(Re(r,s=>n.call(e,s,i++)&&r.next(s)))})}function cs(n){return xe((e,t)=>{let r=null,i=!1,s;r=e.subscribe(Re(t,void 0,void 0,o=>{s=jt(n(o,cs(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function BR(n,e,t,r,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Re(o,d=>{let h=l++;c=a?n(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function wo(n,e){return fe(e)?At(n,e,1):At(n,1)}function ls(n){return xe((e,t)=>{let r=!1;e.subscribe(Re(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Li(n){return n<=0?()=>Hn:xe((e,t)=>{let r=0;e.subscribe(Re(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Mv(n){return Pe(()=>n)}function sp(n=A$){return xe((e,t)=>{let r=!1;e.subscribe(Re(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function A$(){return new Fi}function Nu(n){return xe((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Wr(n,e){let t=arguments.length>=2;return r=>r.pipe(n?nr((i,s)=>n(i,s,r)):$n,Li(1),t?ls(e):sp(()=>new Fi))}function nc(n){return n<=0?()=>Hn:xe((e,t)=>{let r=[];e.subscribe(Re(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function kv(n,e){let t=arguments.length>=2;return r=>r.pipe(n?nr((i,s)=>n(i,s,r)):$n,nc(1),t?ls(e):sp(()=>new Fi))}function Ov(n,e){return xe(BR(n,e,arguments.length>=2,!0))}function Fv(...n){let e=as(n);return xe((t,r)=>{(e?tc(n,t,e):tc(n,t)).subscribe(r)})}function rr(n,e){return xe((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(Re(r,c=>{i?.unsubscribe();let l=0,d=s++;jt(n(c,d)).subscribe(i=Re(r,h=>r.next(e?e(c,h,d,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Lv(n){return xe((e,t)=>{jt(n).subscribe(Re(t,()=>t.complete(),xu)),!t.closed&&e.subscribe(t)})}function Yt(n,e,t){let r=fe(n)||e||t?{next:n,error:e,complete:t}:n;return r?xe((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Re(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):$n}var bN="https://g.co/ng/security#xss",re=class extends Error{constructor(e,t){super(kw(e,t)),this.code=e}};function kw(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function Hu(n){return{toString:n}.toString()}var op="__parameters__";function x$(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function CN(n,e,t){return Hu(()=>{let r=x$(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let h=c.hasOwnProperty(op)?c[op]:Object.defineProperty(c,op,{value:[]})[op];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var yn=globalThis;function We(n){for(let e in n)if(n[e]===We)return e;throw Error("Could not find renamed property on target object.")}function R$(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Pn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Pn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function jR(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var N$=We({__forward_ref__:We});function qu(n){return n.__forward_ref__=qu,n.toString=function(){return Pn(this())},n}function _n(n){return TN(n)?n():n}function TN(n){return typeof n=="function"&&n.hasOwnProperty(N$)&&n.__forward_ref__===qu}function oe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function kn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Up(n){return $R(n,DN)||$R(n,AN)}function SN(n){return Up(n)!==null}function $R(n,e){return n.hasOwnProperty(e)?n[e]:null}function P$(n){let e=n&&(n[DN]||n[AN]);return e||null}function HR(n){return n&&(n.hasOwnProperty(qR)||n.hasOwnProperty(M$))?n[qR]:null}var DN=We({\u0275prov:We}),qR=We({\u0275inj:We}),AN=We({ngInjectableDef:We}),M$=We({ngInjectorDef:We}),he=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=oe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function xN(n){return n&&!!n.\u0275providers}var k$=We({\u0275cmp:We}),O$=We({\u0275dir:We}),F$=We({\u0275pipe:We}),L$=We({\u0275mod:We}),mp=We({\u0275fac:We}),Pu=We({__NG_ELEMENT_ID__:We}),zR=We({__NG_ENV_ID__:We});function Nn(n){return typeof n=="string"?n:n==null?"":String(n)}function V$(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Nn(n)}function U$(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new re(-200,n)}function Ow(n,e){throw new re(-201,!1)}var Ie=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Ie||{}),Qv;function RN(){return Qv}function Rn(n){let e=Qv;return Qv=n,e}function NN(n,e,t){let r=Up(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&Ie.Optional)return null;if(e!==void 0)return e;Ow(n,"Injector")}var B$={},ku=B$,Yv="__NG_DI_FLAG__",gp="ngTempTokenPath",j$="ngTokenPath",$$=/\n/gm,H$="\u0275",GR="__source",ac;function q$(){return ac}function us(n){let e=ac;return ac=n,e}function z$(n,e=Ie.Default){if(ac===void 0)throw new re(-203,!1);return ac===null?NN(n,void 0,e):ac.get(n,e&Ie.Optional?null:void 0,e)}function ae(n,e=Ie.Default){return(RN()||z$)(_n(n),e)}function Y(n,e=Ie.Default){return ae(n,Bp(e))}function Bp(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Jv(n){let e=[];for(let t=0;t<n.length;t++){let r=_n(n[t]);if(Array.isArray(r)){if(r.length===0)throw new re(900,!1);let i,s=Ie.Default;for(let o=0;o<r.length;o++){let a=r[o],c=G$(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(ae(i,s))}else e.push(ae(r))}return e}function PN(n,e){return n[Yv]=e,n.prototype[Yv]=e,n}function G$(n){return n[Yv]}function W$(n,e,t,r){let i=n[gp];throw e[GR]&&i.unshift(e[GR]),n.message=K$(`
`+n.message,i,t,r),n[j$]=i,n[gp]=null,n}function K$(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==H$?n.slice(2):n;let i=Pn(e);if(Array.isArray(e))i=e.map(Pn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Pn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace($$,`
  `)}`}var jp=PN(CN("Optional"),8);var Fw=PN(CN("SkipSelf"),4);function bo(n,e){let t=n.hasOwnProperty(mp);return t?n[mp]:null}function Lw(n,e){n.forEach(t=>Array.isArray(t)?Lw(t,e):e(t))}function MN(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function _p(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var lc={},Sr=[],uc=new he(""),kN=new he("",-1),ON=new he(""),yp=class{get(e,t=ku){if(t===ku){let r=new Error(`NullInjectorError: No provider for ${Pn(e)}!`);throw r.name="NullInjectorError",r}return t}},FN=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(FN||{}),Yr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Yr||{}),sr=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(sr||{});function Q$(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function Xv(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];Y$(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function LN(n){return n===3||n===4||n===6}function Y$(n){return n.charCodeAt(0)===64}function Ou(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?WR(n,t,i,null,e[++r]):WR(n,t,i,null,null))}}return n}function WR(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var VN="ng-template";function J$(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&Q$(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Vw(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Vw(n){return n.type===4&&n.value!==VN}function X$(n,e,t){let r=n.type===4&&!t?VN:n.value;return e===r}function Z$(n,e,t){let r=4,i=n.attrs,s=i!==null?nH(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Tr(r)&&!Tr(c))return!1;if(o&&Tr(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!X$(n,c,t)||c===""&&e.length===1){if(Tr(r))return!1;o=!0}}else if(r&8){if(i===null||!J$(n,i,c,t)){if(Tr(r))return!1;o=!0}}else{let l=e[++a],d=eH(c,i,Vw(n),t);if(d===-1){if(Tr(r))return!1;o=!0;continue}if(l!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(Tr(r))return!1;o=!0}}}}return Tr(r)||o}function Tr(n){return(n&1)===0}function eH(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return rH(e,n)}function tH(n,e,t=!1){for(let r=0;r<e.length;r++)if(Z$(n,e[r],t))return!0;return!1}function nH(n){for(let e=0;e<n.length;e++){let t=n[e];if(LN(t))return e}return n.length}function rH(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function KR(n,e){return n?":not("+e.trim()+")":e}function iH(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Tr(o)&&(e+=KR(s,i),i=""),r=o,s=s||!Tr(r);t++}return i!==""&&(e+=KR(s,i)),e}function sH(n){return n.map(iH).join(",")}function oH(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!Tr(i))break;i=s}r++}return{attrs:e,classes:t}}function Se(n){return Hu(()=>{let e=qN(n),t=st(q({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===FN.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Yr.Emulated,styles:n.styles||Sr,_:null,schemas:n.schemas||null,tView:null,id:""});zN(t);let r=n.dependencies;return t.directiveDefs=YR(r,!1),t.pipeDefs=YR(r,!0),t.id=lH(t),t})}function aH(n){return hs(n)||BN(n)}function cH(n){return n!==null}function On(n){return Hu(()=>({type:n.type,bootstrap:n.bootstrap||Sr,declarations:n.declarations||Sr,imports:n.imports||Sr,exports:n.exports||Sr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function QR(n,e){if(n==null)return lc;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=sr.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==sr.None?[r,a]:r,e[s]=o):t[s]=r}return t}function qn(n){return Hu(()=>{let e=qN(n);return zN(e),e})}function UN(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function hs(n){return n[k$]||null}function BN(n){return n[O$]||null}function jN(n){return n[F$]||null}function $N(n){let e=hs(n)||BN(n)||jN(n);return e!==null?e.standalone:!1}function HN(n,e){let t=n[L$]||null;if(!t&&e===!0)throw new Error(`Type ${Pn(n)} does not have '\u0275mod' property.`);return t}function qN(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||lc,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||Sr,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:QR(n.inputs,e),outputs:QR(n.outputs),debugInfo:null}}function zN(n){n.features?.forEach(e=>e(n))}function YR(n,e){if(!n)return null;let t=e?jN:aH;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(cH)}function lH(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function uH(...n){return{\u0275providers:GN(!0,n),\u0275fromNgModule:!0}}function GN(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return Lw(e,o=>{let a=o;Zv(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&WN(i,s),t}function WN(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Uw(i,s=>{e(s,r)})}}function Zv(n,e,t,r){if(n=_n(n),!n)return!1;let i=null,s=HR(n),o=!s&&hs(n);if(!s&&!o){let c=n.ngModule;if(s=HR(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)Zv(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Lw(s.imports,d=>{Zv(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&WN(l,e)}if(!a){let l=bo(i)||(()=>new i);e({provide:i,useFactory:l,deps:Sr},i),e({provide:ON,useValue:i,multi:!0},i),e({provide:uc,useValue:()=>ae(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;Uw(c,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function Uw(n,e){for(let t of n)xN(t)&&(t=t.\u0275providers),Array.isArray(t)?Uw(t,e):e(t)}var dH=We({provide:String,useValue:We});function KN(n){return n!==null&&typeof n=="object"&&dH in n}function hH(n){return!!(n&&n.useExisting)}function fH(n){return!!(n&&n.useFactory)}function dc(n){return typeof n=="function"}function pH(n){return!!n.useClass}var $p=new he(""),up={},mH={},Vv;function Bw(){return Vv===void 0&&(Vv=new yp),Vv}var Mn=class{},Fu=class extends Mn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,tw(e,o=>this.processProvider(o)),this.records.set(kN,rc(void 0,this)),i.has("environment")&&this.records.set(Mn,rc(void 0,this));let s=this.records.get($p);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(ON,Sr,Ie.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Oe(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Oe(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=us(this),r=Rn(void 0),i;try{return e()}finally{us(t),Rn(r)}}get(e,t=ku,r=Ie.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(zR))return e[zR](this);r=Bp(r);let i,s=us(this),o=Rn(void 0);try{if(!(r&Ie.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=wH(e)&&Up(e);l&&this.injectableDefInScope(l)?c=rc(ew(e),up):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&Ie.Self?Bw():this.parent;return t=r&Ie.Optional&&t===ku?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[gp]=a[gp]||[]).unshift(Pn(e)),s)throw a;return W$(a,e,"R3InjectorError",this.source)}else throw a}finally{Rn(o),us(s)}}resolveInjectorInitializers(){let e=Oe(null),t=us(this),r=Rn(void 0),i;try{let s=this.get(uc,Sr,Ie.Self);for(let o of s)o()}finally{us(t),Rn(r),Oe(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Pn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new re(205,!1)}processProvider(e){e=_n(e);let t=dc(e)?e:_n(e&&e.provide),r=_H(e);if(!dc(e)&&e.multi===!0){let i=this.records.get(t);i||(i=rc(void 0,up,!0),i.factory=()=>Jv(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Oe(null);try{return t.value===up&&(t.value=mH,t.value=t.factory()),typeof t.value=="object"&&t.value&&vH(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Oe(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=_n(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function ew(n){let e=Up(n),t=e!==null?e.factory:bo(n);if(t!==null)return t;if(n instanceof he)throw new re(204,!1);if(n instanceof Function)return gH(n);throw new re(204,!1)}function gH(n){if(n.length>0)throw new re(204,!1);let t=P$(n);return t!==null?()=>t.factory(n):()=>new n}function _H(n){if(KN(n))return rc(void 0,n.useValue);{let e=QN(n);return rc(e,up)}}function QN(n,e,t){let r;if(dc(n)){let i=_n(n);return bo(i)||ew(i)}else if(KN(n))r=()=>_n(n.useValue);else if(fH(n))r=()=>n.useFactory(...Jv(n.deps||[]));else if(hH(n))r=()=>ae(_n(n.useExisting));else{let i=_n(n&&(n.useClass||n.provide));if(yH(n))r=()=>new i(...Jv(n.deps));else return bo(i)||ew(i)}return r}function rc(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function yH(n){return!!n.deps}function vH(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function wH(n){return typeof n=="function"||typeof n=="object"&&n instanceof he}function tw(n,e){for(let t of n)Array.isArray(t)?tw(t,e):t&&xN(t)?tw(t.\u0275providers,e):e(t)}function Vi(n,e){n instanceof Fu&&n.assertNotDestroyed();let t,r=us(n),i=Rn(void 0);try{return e()}finally{us(r),Rn(i)}}function YN(){return RN()!==void 0||q$()!=null}function IH(n){if(!YN())throw new re(-203,!1)}function EH(n){let e=yn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function bH(n){return typeof n=="function"}var Ui=0,Te=1,de=2,an=3,Dr=4,Rr=5,vp=6,Lu=7,Ar=8,hc=9,xr=10,Jt=11,Vu=12,JR=13,gc=14,Jr=15,Hp=16,ic=17,fc=18,qp=19,JN=20,ds=21,Uv=22,Co=23,Xr=25,XN=1;var To=7,wp=8,Ip=9,ir=10,jw=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(jw||{});function Io(n){return Array.isArray(n)&&typeof n[XN]=="object"}function Bi(n){return Array.isArray(n)&&n[XN]===!0}function ZN(n){return(n.flags&4)!==0}function zp(n){return n.componentOffset>-1}function $w(n){return(n.flags&1)===1}function fs(n){return!!n.template}function CH(n){return(n[de]&512)!==0}var nw=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function eP(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function _c(){return tP}function tP(n){return n.type.prototype.ngOnChanges&&(n.setInput=SH),TH}_c.ngInherit=!0;function TH(){let n=rP(this),e=n?.current;if(e){let t=n.previous;if(t===lc)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function SH(n,e,t,r,i){let s=this.declaredInputs[r],o=rP(n)||DH(n,{previous:lc,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new nw(l&&l.currentValue,t,c===lc),eP(n,e,i,t)}var nP="__ngSimpleChanges__";function rP(n){return n[nP]||null}function DH(n,e){return n[nP]=e}var XR=null;var Kr=function(n,e,t){XR?.(n,e,t)},AH="svg",xH="math",RH=!1;function NH(){return RH}function Zr(n){for(;Array.isArray(n);)n=n[Ui];return n}function PH(n,e){return Zr(e[n])}function or(n,e){return Zr(e[n.index])}function iP(n,e){return n.data[e]}function MH(n,e){return n[e]}function gs(n,e){let t=e[n];return Io(t)?t:t[Ui]}function Hw(n){return(n[de]&128)===128}function kH(n){return Bi(n[an])}function Ep(n,e){return e==null?null:n[e]}function sP(n){n[ic]=0}function OH(n){n[de]&1024||(n[de]|=1024,Hw(n)&&Uu(n))}function FH(n,e){for(;n>0;)e=e[gc],n--;return e}function qw(n){return!!(n[de]&9216||n[Co]?.dirty)}function rw(n){n[xr].changeDetectionScheduler?.notify(1),qw(n)?Uu(n):n[de]&64&&(NH()?(n[de]|=1024,Uu(n)):n[xr].changeDetectionScheduler?.notify())}function Uu(n){n[xr].changeDetectionScheduler?.notify();let e=Bu(n);for(;e!==null&&!(e[de]&8192||(e[de]|=8192,!Hw(e)));)e=Bu(e)}function oP(n,e){if((n[de]&256)===256)throw new re(911,!1);n[ds]===null&&(n[ds]=[]),n[ds].push(e)}function LH(n,e){if(n[ds]===null)return;let t=n[ds].indexOf(e);t!==-1&&n[ds].splice(t,1)}function Bu(n){let e=n[an];return Bi(e)?e[an]:e}var be={lFrame:fP(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function VH(){return be.lFrame.elementDepthCount}function UH(){be.lFrame.elementDepthCount++}function BH(){be.lFrame.elementDepthCount--}function aP(){return be.bindingsEnabled}function jH(){return be.skipHydrationRootTNode!==null}function $H(n){return be.skipHydrationRootTNode===n}function HH(){be.skipHydrationRootTNode=null}function He(){return be.lFrame.lView}function ar(){return be.lFrame.tView}function ut(n){return be.lFrame.contextLView=n,n[Ar]}function dt(n){return be.lFrame.contextLView=null,n}function zn(){let n=cP();for(;n!==null&&n.type===64;)n=n.parent;return n}function cP(){return be.lFrame.currentTNode}function qH(){let n=be.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function zu(n,e){let t=be.lFrame;t.currentTNode=n,t.isParent=e}function lP(){return be.lFrame.isParent}function zH(){be.lFrame.isParent=!1}function GH(){let n=be.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function zw(){return be.lFrame.bindingIndex}function WH(n){return be.lFrame.bindingIndex=n}function Gw(){return be.lFrame.bindingIndex++}function Ww(n){let e=be.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function KH(){return be.lFrame.inI18n}function QH(n,e){let t=be.lFrame;t.bindingIndex=t.bindingRootIndex=n,iw(e)}function YH(){return be.lFrame.currentDirectiveIndex}function iw(n){be.lFrame.currentDirectiveIndex=n}function uP(n){be.lFrame.currentQueryIndex=n}function JH(n){let e=n[Te];return e.type===2?e.declTNode:e.type===1?n[Rr]:null}function dP(n,e,t){if(t&Ie.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&Ie.Host);)if(i=JH(s),i===null||(s=s[gc],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=be.lFrame=hP();return r.currentTNode=e,r.lView=n,!0}function Kw(n){let e=hP(),t=n[Te];be.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function hP(){let n=be.lFrame,e=n===null?null:n.child;return e===null?fP(n):e}function fP(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function pP(){let n=be.lFrame;return be.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var mP=pP;function Qw(){let n=pP();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function XH(n){return(be.lFrame.contextLView=FH(n,be.lFrame.contextLView))[Ar]}function yc(){return be.lFrame.selectedIndex}function So(n){be.lFrame.selectedIndex=n}function Yw(){let n=be.lFrame;return iP(n.tView,n.selectedIndex)}function ZH(){return be.lFrame.currentNamespace}var gP=!0;function Jw(){return gP}function Xw(n){gP=n}function eq(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=tP(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function Zw(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function dp(n,e,t){_P(n,e,3,t)}function hp(n,e,t,r){(n[de]&3)===t&&_P(n,e,t,r)}function Bv(n,e){let t=n[de];(t&3)===e&&(t&=16383,t+=1,n[de]=t)}function _P(n,e,t,r){let i=r!==void 0?n[ic]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[ic]+=65536),(a<s||s==-1)&&(tq(n,t,e,c),n[ic]=(n[ic]&4294901760)+c+2),c++}function ZR(n,e){Kr(4,n,e);let t=Oe(null);try{e.call(n)}finally{Oe(t),Kr(5,n,e)}}function tq(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[de]>>14<n[ic]>>16&&(n[de]&3)===e&&(n[de]+=16384,ZR(a,s)):ZR(a,s)}var cc=-1,Do=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function nq(n){return n instanceof Do}function rq(n){return(n.flags&8)!==0}function iq(n){return(n.flags&16)!==0}function yP(n){return n!==cc}function bp(n){return n&32767}function sq(n){return n>>16}function Cp(n,e){let t=sq(n),r=e;for(;t>0;)r=r[gc],t--;return r}var sw=!0;function Tp(n){let e=sw;return sw=n,e}var oq=256,vP=oq-1,wP=5,aq=0,Qr={};function cq(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Pu)&&(r=t[Pu]),r==null&&(r=t[Pu]=aq++);let i=r&vP,s=1<<i;e.data[n+(i>>wP)]|=s}function Sp(n,e){let t=IP(n,e);if(t!==-1)return t;let r=e[Te];r.firstCreatePass&&(n.injectorIndex=e.length,jv(r.data,n),jv(e,null),jv(r.blueprint,null));let i=eI(n,e),s=n.injectorIndex;if(yP(i)){let o=bp(i),a=Cp(i,e),c=a[Te].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function jv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function IP(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function eI(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=SP(i),r===null)return cc;if(t++,i=i[gc],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return cc}function ow(n,e,t){cq(n,e,t)}function lq(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(LN(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function EP(n,e,t){if(t&Ie.Optional||n!==void 0)return n;Ow(e,"NodeInjector")}function bP(n,e,t,r){if(t&Ie.Optional&&r===void 0&&(r=null),!(t&(Ie.Self|Ie.Host))){let i=n[hc],s=Rn(void 0);try{return i?i.get(e,r,t&Ie.Optional):NN(e,r,t&Ie.Optional)}finally{Rn(s)}}return EP(r,e,t)}function CP(n,e,t,r=Ie.Default,i){if(n!==null){if(e[de]&2048&&!(r&Ie.Self)){let o=pq(n,e,t,r,Qr);if(o!==Qr)return o}let s=TP(n,e,t,r,Qr);if(s!==Qr)return s}return bP(e,t,r,i)}function TP(n,e,t,r,i){let s=hq(t);if(typeof s=="function"){if(!dP(e,n,r))return r&Ie.Host?EP(i,t,r):bP(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&Ie.Optional))Ow(t);else return o}finally{mP()}}else if(typeof s=="number"){let o=null,a=IP(n,e),c=cc,l=r&Ie.Host?e[Jr][Rr]:null;for((a===-1||r&Ie.SkipSelf)&&(c=a===-1?eI(n,e):e[a+8],c===cc||!tN(r,!1)?a=-1:(o=e[Te],a=bp(c),e=Cp(c,e)));a!==-1;){let d=e[Te];if(eN(s,a,d.data)){let h=uq(a,e,t,o,r,l);if(h!==Qr)return h}c=e[a+8],c!==cc&&tN(r,e[Te].data[a+8]===l)&&eN(s,a,e)?(o=d,a=bp(c),e=Cp(c,e)):a=-1}}return i}function uq(n,e,t,r,i,s){let o=e[Te],a=o.data[n+8],c=r==null?zp(a)&&sw:r!=o&&(a.type&3)!==0,l=i&Ie.Host&&s===a,d=dq(a,o,t,c,l);return d!==null?pc(e,o,d,a):Qr}function dq(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,d=s>>20,h=r?a:a+d,p=i?a+d:l;for(let _=h;_<p;_++){let w=o[_];if(_<c&&t===w||_>=c&&w.type===t)return _}if(i){let _=o[c];if(_&&fs(_)&&_.type===t)return c}return null}function pc(n,e,t,r){let i=n[t],s=e.data;if(nq(i)){let o=i;o.resolving&&U$(V$(s[t]));let a=Tp(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?Rn(o.injectImpl):null,d=dP(n,r,Ie.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&eq(t,s[t],e)}finally{l!==null&&Rn(l),Tp(a),o.resolving=!1,mP()}}return i}function hq(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Pu)?n[Pu]:void 0;return typeof e=="number"?e>=0?e&vP:fq:e}function eN(n,e,t){let r=1<<n;return!!(t[e+(n>>wP)]&r)}function tN(n,e){return!(n&Ie.Self)&&!(n&Ie.Host&&e)}var Eo=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return CP(this._tNode,this._lView,e,Bp(r),t)}};function fq(){return new Eo(zn(),He())}function Ro(n){return Hu(()=>{let e=n.prototype.constructor,t=e[mp]||aw(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[mp]||aw(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function aw(n){return TN(n)?()=>{let e=aw(_n(n));return e&&e()}:bo(n)}function pq(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[de]&2048&&!(o[de]&512);){let a=TP(s,o,t,r|Ie.Self,Qr);if(a!==Qr)return a;let c=s.parent;if(!c){let l=o[JN];if(l){let d=l.get(t,Qr,r);if(d!==Qr)return d}c=SP(o),o=o[gc]}s=c}return i}function SP(n){let e=n[Te],t=e.type;return t===2?e.declTNode:t===1?n[Rr]:null}function tI(n){return lq(zn(),n)}function nN(n,e=null,t=null,r){let i=DP(n,e,t,r);return i.resolveInjectorInitializers(),i}function DP(n,e=null,t=null,r,i=new Set){let s=[t||Sr,uH(n)];return r=r||(typeof n=="object"?void 0:Pn(n)),new Fu(s,e||Bw(),r||null,i)}var Nr=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return nN({name:""},i,r,"");{let s=r.name??"";return nN({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=ku,e.NULL=new yp,e.\u0275prov=oe({token:e,providedIn:"any",factory:()=>ae(kN)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var mq="ngOriginalError";function $v(n){return n[mq]}var ei=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&$v(e);for(;t&&$v(t);)t=$v(t);return t||null}},AP=new he("",{providedIn:"root",factory:()=>Y(ei).handleError.bind(void 0)}),nI=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=gq,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),cw=class extends nI{constructor(e){super(),this._lView=e}onDestroy(e){return oP(this._lView,e),()=>LH(this._lView,e)}};function gq(){return new cw(He())}function _q(){return Gp(zn(),He())}function Gp(n,e){return new ji(or(n,e))}var ji=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=_q;let n=e;return n})();var lw=class extends sn{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,YN()&&(this.destroyRef=Y(nI,{optional:!0})??void 0)}emit(e){let t=Oe(null);try{super.next(e)}finally{Oe(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Hv(s),i&&(i=Hv(i)),o&&(o=Hv(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Vt&&e.add(a),a}};function Hv(n){return e=>{setTimeout(n,void 0,e)}}var on=lw;function xP(n){return(n.flags&128)===128}var RP=new Map,yq=0;function vq(){return yq++}function wq(n){RP.set(n[qp],n)}function Iq(n){RP.delete(n[qp])}var rN="__ngContext__";function Ao(n,e){Io(e)?(n[rN]=e[qp],wq(e)):n[rN]=e}function NP(n){return MP(n[Vu])}function PP(n){return MP(n[Dr])}function MP(n){for(;n!==null&&!Bi(n);)n=n[Dr];return n}var uw;function kP(n){uw=n}function Eq(){if(uw!==void 0)return uw;if(typeof document<"u")return document;throw new re(210,!1)}var Wp=new he("",{providedIn:"root",factory:()=>bq}),bq="ng",rI=new he(""),_s=new he("",{providedIn:"platform",factory:()=>"unknown"});var iI=new he("",{providedIn:"root",factory:()=>Eq().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Cq="h",Tq="b";var Sq=()=>null;function sI(n,e,t=!1){return Sq(n,e,t)}var OP=!1,Dq=new he("",{providedIn:"root",factory:()=>OP});var ap;function Aq(){if(ap===void 0&&(ap=null,yn.trustedTypes))try{ap=yn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return ap}function iN(n){return Aq()?.createScriptURL(n)||n}var Dp=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${bN})`}};function Kp(n){return n instanceof Dp?n.changingThisBreaksApplicationSecurity:n}function oI(n,e){let t=xq(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${bN})`)}return t===e}function xq(n){return n instanceof Dp&&n.getTypeName()||null}var Rq=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function FP(n){return n=String(n),n.match(Rq)?n:"unsafe:"+n}var Qp=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Qp||{});function Yp(n){let e=VP();return e?e.sanitize(Qp.URL,n)||"":oI(n,"URL")?Kp(n):FP(Nn(n))}function Nq(n){let e=VP();if(e)return iN(e.sanitize(Qp.RESOURCE_URL,n)||"");if(oI(n,"ResourceURL"))return iN(Kp(n));throw new re(904,!1)}function Pq(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?Nq:Yp}function LP(n,e,t){return Pq(e,t)(n)}function VP(){let n=He();return n&&n[xr].sanitizer}function UP(n){return n instanceof Function?n():n}function Mq(n){return(n??Y(Nr)).get(_s)==="browser"}var No=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(No||{}),kq;function aI(n,e){return kq(n,e)}function sc(n,e,t,r,i){if(r!=null){let s,o=!1;Bi(r)?s=r:Io(r)&&(o=!0,r=r[Ui]);let a=Zr(r);n===0&&t!==null?i==null?qP(e,t,a):Ap(e,t,a,i||null,!0):n===1&&t!==null?Ap(e,t,a,i||null,!0):n===2?Jq(e,a,o):n===3&&e.destroyNode(a),s!=null&&Zq(e,n,s,t,i)}}function Oq(n,e){return n.createText(e)}function Fq(n,e,t){n.setValue(e,t)}function BP(n,e,t){return n.createElement(e,t)}function Lq(n,e){jP(n,e),e[Ui]=null,e[Rr]=null}function Vq(n,e,t,r,i,s){r[Ui]=i,r[Rr]=e,Jp(n,r,t,1,i,s)}function jP(n,e){e[xr].changeDetectionScheduler?.notify(1),Jp(n,e,e[Jt],2,null,null)}function Uq(n){let e=n[Vu];if(!e)return qv(n[Te],n);for(;e;){let t=null;if(Io(e))t=e[Vu];else{let r=e[ir];r&&(t=r)}if(!t){for(;e&&!e[Dr]&&e!==n;)Io(e)&&qv(e[Te],e),e=e[an];e===null&&(e=n),Io(e)&&qv(e[Te],e),t=e&&e[Dr]}e=t}}function Bq(n,e,t,r){let i=ir+r,s=t.length;r>0&&(t[i-1][Dr]=e),r<s-ir?(e[Dr]=t[i],MN(t,ir+r,e)):(t.push(e),e[Dr]=null),e[an]=t;let o=e[Hp];o!==null&&t!==o&&jq(o,e);let a=e[fc];a!==null&&a.insertView(n),rw(e),e[de]|=128}function jq(n,e){let t=n[Ip],i=e[an][an][Jr];e[Jr]!==i&&(n[de]|=jw.HasTransplantedViews),t===null?n[Ip]=[e]:t.push(e)}function $P(n,e){let t=n[Ip],r=t.indexOf(e);t.splice(r,1)}function dw(n,e){if(n.length<=ir)return;let t=ir+e,r=n[t];if(r){let i=r[Hp];i!==null&&i!==n&&$P(i,r),e>0&&(n[t-1][Dr]=r[Dr]);let s=_p(n,ir+e);Lq(r[Te],r);let o=s[fc];o!==null&&o.detachView(s[Te]),r[an]=null,r[Dr]=null,r[de]&=-129}return r}function HP(n,e){if(!(e[de]&256)){let t=e[Jt];t.destroyNode&&Jp(n,e,t,3,null,null),Uq(e)}}function qv(n,e){if(e[de]&256)return;let t=Oe(null);try{e[de]&=-129,e[de]|=256,e[Co]&&dR(e[Co]),Hq(n,e),$q(n,e),e[Te].type===1&&e[Jt].destroy();let r=e[Hp];if(r!==null&&Bi(e[an])){r!==e[an]&&$P(r,e);let i=e[fc];i!==null&&i.detachView(n)}Iq(e)}finally{Oe(t)}}function $q(n,e){let t=n.cleanup,r=e[Lu];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[Lu]=null);let i=e[ds];if(i!==null){e[ds]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function Hq(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Do)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Kr(4,a,c);try{c.call(a)}finally{Kr(5,a,c)}}else{Kr(4,i,s);try{s.call(i)}finally{Kr(5,i,s)}}}}}function qq(n,e,t){return zq(n,e.parent,t)}function zq(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[Ui];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===Yr.None||s===Yr.Emulated)return null}return or(r,t)}}function Ap(n,e,t,r,i){n.insertBefore(e,t,r,i)}function qP(n,e,t){n.appendChild(e,t)}function sN(n,e,t,r,i){r!==null?Ap(n,e,t,r,i):qP(n,e,t)}function Gq(n,e,t,r){n.removeChild(e,t,r)}function cI(n,e){return n.parentNode(e)}function Wq(n,e){return n.nextSibling(e)}function Kq(n,e,t){return Yq(n,e,t)}function Qq(n,e,t){return n.type&40?or(n,t):null}var Yq=Qq,oN;function lI(n,e,t,r){let i=qq(n,r,e),s=e[Jt],o=r.parent||e[Rr],a=Kq(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)sN(s,i,t[c],a,!1);else sN(s,i,t,a,!1);oN!==void 0&&oN(s,r,e,t,i)}function fp(n,e){if(e!==null){let t=e.type;if(t&3)return or(e,n);if(t&4)return hw(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return fp(n,r);{let i=n[e.index];return Bi(i)?hw(-1,i):Zr(i)}}else{if(t&32)return aI(e,n)()||Zr(n[e.index]);{let r=zP(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Bu(n[Jr]);return fp(i,r)}else return fp(n,e.next)}}}return null}function zP(n,e){if(e!==null){let r=n[Jr][Rr],i=e.projection;return r.projection[i]}return null}function hw(n,e){let t=ir+n+1;if(t<e.length){let r=e[t],i=r[Te].firstChild;if(i!==null)return fp(r,i)}return e[To]}function Jq(n,e,t){let r=cI(n,e);r&&Gq(n,r,e,t)}function uI(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&e===0&&(a&&Ao(Zr(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)uI(n,e,t.child,r,i,s,!1),sc(e,n,i,a,s);else if(c&32){let l=aI(t,r),d;for(;d=l();)sc(e,n,i,d,s);sc(e,n,i,a,s)}else c&16?Xq(n,e,r,t,i,s):sc(e,n,i,a,s);t=o?t.projectionNext:t.next}}function Jp(n,e,t,r,i,s){uI(t,r,n.firstChild,e,i,s,!1)}function Xq(n,e,t,r,i,s){let o=t[Jr],c=o[Rr].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];sc(e,n,i,d,s)}else{let l=c,d=o[an];xP(r)&&(l.flags|=128),uI(n,e,l,d,i,s,!0)}}function Zq(n,e,t,r,i){let s=t[To],o=Zr(t);s!==o&&sc(e,n,r,s,i);for(let a=ir;a<t.length;a++){let c=t[a];Jp(c[Te],c,n,e,r,s)}}function e4(n,e,t){n.setAttribute(e,"style",t)}function GP(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function WP(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&Xv(n,e,r),i!==null&&GP(n,e,i),s!==null&&e4(n,e,s)}var cr={};function ie(n=1){KP(ar(),He(),yc()+n,!1)}function KP(n,e,t,r){if(!r)if((e[de]&3)===3){let s=n.preOrderCheckHooks;s!==null&&dp(e,s,t)}else{let s=n.preOrderHooks;s!==null&&hp(e,s,0,t)}So(t)}function ee(n,e=Ie.Default){let t=He();if(t===null)return ae(n,e);let r=zn();return CP(r,t,_n(n),e)}function QP(){let n="invalid";throw new Error(n)}function YP(n,e,t,r,i,s){let o=Oe(null);try{let a=null;i&sr.SignalBased&&(a=e[r][aR]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&sr.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):eP(e,a,r,s)}finally{Oe(o)}}function t4(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)So(~i);else{let s=i,o=t[++r],a=t[++r];QH(o,s);let c=e[s];a(2,c)}}}finally{So(-1)}}function Xp(n,e,t,r,i,s,o,a,c,l,d){let h=e.blueprint.slice();return h[Ui]=i,h[de]=r|4|128|8|64,(l!==null||n&&n[de]&2048)&&(h[de]|=2048),sP(h),h[an]=h[gc]=n,h[Ar]=t,h[xr]=o||n&&n[xr],h[Jt]=a||n&&n[Jt],h[hc]=c||n&&n[hc]||null,h[Rr]=s,h[qp]=vq(),h[vp]=d,h[JN]=l,h[Jr]=e.type==2?n[Jr]:h,h}function Zp(n,e,t,r,i){let s=n.data[e];if(s===null)s=n4(n,e,t,r,i),KH()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=qH();s.injectorIndex=o===null?-1:o.injectorIndex}return zu(s,!0),s}function n4(n,e,t,r,i){let s=cP(),o=lP(),a=o?s:s&&s.parent,c=n.data[e]=a4(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function JP(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function XP(n,e,t,r,i){let s=yc(),o=r&2;try{So(-1),o&&e.length>Xr&&KP(n,e,Xr,!1),Kr(o?2:0,i),t(r,i)}finally{So(s),Kr(o?3:1,i)}}function ZP(n,e,t){if(ZN(e)){let r=Oe(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Oe(r)}}}function eM(n,e,t){aP()&&(f4(n,e,t,or(t,e)),(t.flags&64)===64&&oM(n,e,t))}function tM(n,e,t=or){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function nM(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=dI(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function dI(n,e,t,r,i,s,o,a,c,l,d){let h=Xr+r,p=h+i,_=r4(h,p),w=typeof l=="function"?l():l;return _[Te]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:d}}function r4(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:cr);return t}function i4(n,e,t,r){let s=r.get(Dq,OP)||t===Yr.ShadowDom,o=n.selectRootElement(e,s);return s4(o),o}function s4(n){o4(n)}var o4=()=>null;function a4(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return jH()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function aN(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=sr.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?cN(r,t,l,a,c):cN(r,t,l,a)}return r}function cN(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function c4(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,l=null;for(let d=r;d<i;d++){let h=s[d],p=t?t.get(h):null,_=p?p.inputs:null,w=p?p.outputs:null;c=aN(0,h.inputs,d,c,_),l=aN(1,h.outputs,d,l,w);let A=c!==null&&o!==null&&!Vw(e)?C4(c,d,o):null;a.push(A)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function l4(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function rM(n,e,t,r,i,s,o,a){let c=or(e,t),l=e.inputs,d;!a&&l!=null&&(d=l[r])?(hI(n,t,d,r,i),zp(e)&&u4(t,e.index)):e.type&3?(r=l4(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function u4(n,e){let t=gs(e,n);t[de]&16||(t[de]|=64)}function iM(n,e,t,r){if(aP()){let i=r===null?null:{"":-1},s=m4(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&sM(n,e,t,o,i,a),i&&g4(t,r,i)}t.mergedAttrs=Ou(t.mergedAttrs,t.attrs)}function sM(n,e,t,r,i,s){for(let l=0;l<r.length;l++)ow(Sp(t,e),n,r[l].type);y4(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=JP(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=Ou(t.mergedAttrs,d.hostAttrs),v4(n,t,e,c,d),_4(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}c4(n,t,s)}function d4(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;h4(o)!=a&&o.push(a),o.push(t,r,s)}}function h4(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function f4(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;zp(t)&&w4(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Sp(t,e),Ao(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],l=pc(e,n,a,t);if(Ao(l,e),o!==null&&b4(e,a-i,l,c,t,o),fs(c)){let d=gs(t.index,e);d[Ar]=pc(e,n,a,t)}}}function oM(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=YH();try{So(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];iw(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&p4(c,l)}}finally{So(-1),iw(o)}}function p4(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function m4(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(tH(e,o.selectors,!1))if(r||(r=[]),fs(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;fw(n,e,c)}else r.unshift(o),fw(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function fw(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function g4(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new re(-301,!1);r.push(e[i],s)}}}function _4(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;fs(e)&&(t[""]=n)}}function y4(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function v4(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=bo(i.type,!0)),o=new Do(s,fs(i),ee);n.blueprint[r]=o,t[r]=o,d4(n,e,r,JP(n,t,i.hostVars,cr),i)}function w4(n,e,t){let r=or(e,n),i=nM(t),s=n[xr].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=em(n,Xp(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function I4(n,e,t,r,i,s){let o=or(n,e);E4(e[Jt],o,s,n.value,t,r,i)}function E4(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?Nn(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function b4(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],d=o[a++],h=o[a++];YP(r,t,c,l,d,h)}}function C4(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function aM(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function cM(n,e){let t=n.contentQueries;if(t!==null){let r=Oe(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];uP(s),a.contentQueries(2,e[o],o)}}}finally{Oe(r)}}}function em(n,e){return n[Vu]?n[JR][Dr]=e:n[Vu]=e,n[JR]=e,e}function pw(n,e,t){uP(0);let r=Oe(null);try{e(n,t)}finally{Oe(r)}}function T4(n){return n[Lu]||(n[Lu]=[])}function S4(n){return n.cleanup||(n.cleanup=[])}function lM(n,e){let t=n[hc],r=t?t.get(ei,null):null;r&&r.handleError(e)}function hI(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],d=n.data[o];YP(d,l,r,a,c,i)}}function tm(n,e,t){let r=PH(e,n);Fq(n[Jt],r,t)}function D4(n,e){let t=gs(e,n),r=t[Te];A4(r,t);let i=t[Ui];i!==null&&t[vp]===null&&(t[vp]=sI(i,t[hc])),fI(r,t,t[Ar])}function A4(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function fI(n,e,t){Kw(e);try{let r=n.viewQuery;r!==null&&pw(1,r,t);let i=n.template;i!==null&&XP(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[fc]?.finishViewCreation(n),n.staticContentQueries&&cM(n,e),n.staticViewQueries&&pw(2,n.viewQuery,t);let s=n.components;s!==null&&x4(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[de]&=-5,Qw()}}function x4(n,e){for(let t=0;t<e.length;t++)D4(n,e[t])}function R4(n,e,t,r){let i=Oe(null);try{let s=e.tView,a=n[de]&4096?4096:16,c=Xp(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[Hp]=l;let d=n[fc];return d!==null&&(c[fc]=d.createEmbeddedView(s)),fI(s,c,t),c}finally{Oe(i)}}function lN(n,e){return!e||e.firstChild===null||xP(n)}function N4(n,e,t,r=!0){let i=e[Te];if(Bq(i,e,n,t),r){let o=hw(t,n),a=e[Jt],c=cI(a,n[To]);c!==null&&Vq(i,n[Rr],a,e,c,o)}let s=e[vp];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function xp(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(Zr(s)),Bi(s)&&P4(s,r);let o=t.type;if(o&8)xp(n,e,t.child,r);else if(o&32){let a=aI(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=zP(e,t);if(Array.isArray(a))r.push(...a);else{let c=Bu(e[Jr]);xp(c[Te],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function P4(n,e){for(let t=ir;t<n.length;t++){let r=n[t],i=r[Te].firstChild;i!==null&&xp(r[Te],r,i,e)}n[To]!==n[Ui]&&e.push(n[To])}var uM=[];function M4(n){return n[Co]??k4(n)}function k4(n){let e=uM.pop()??Object.create(F4);return e.lView=n,e}function O4(n){n.lView[Co]!==n&&(n.lView=null,uM.push(n))}var F4=st(q({},cR),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Uu(n.lView)},consumerOnSignalRead(){this.lView[Co]=this}}),dM=100;function hM(n,e=!0,t=0){let r=n[xr],i=r.rendererFactory,s=!1;s||i.begin?.();try{L4(n,t)}catch(o){throw e&&lM(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function L4(n,e){mw(n,e);let t=0;for(;qw(n);){if(t===dM)throw new re(103,!1);t++,mw(n,1)}}function V4(n,e,t,r){let i=e[de];if((i&256)===256)return;let s=!1;!s&&e[xr].inlineEffectRunner?.flush(),Kw(e);let o=null,a=null;!s&&U4(n)&&(a=M4(e),o=lR(a));try{sP(e),WH(n.bindingStartIndex),t!==null&&XP(n,e,t,2,r);let c=(i&3)===3;if(!s)if(c){let h=n.preOrderCheckHooks;h!==null&&dp(e,h,null)}else{let h=n.preOrderHooks;h!==null&&hp(e,h,0,null),Bv(e,0)}if(B4(e),fM(e,0),n.contentQueries!==null&&cM(n,e),!s)if(c){let h=n.contentCheckHooks;h!==null&&dp(e,h)}else{let h=n.contentHooks;h!==null&&hp(e,h,1),Bv(e,1)}t4(n,e);let l=n.components;l!==null&&mM(e,l,0);let d=n.viewQuery;if(d!==null&&pw(2,d,r),!s)if(c){let h=n.viewCheckHooks;h!==null&&dp(e,h)}else{let h=n.viewHooks;h!==null&&hp(e,h,2),Bv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Uv]){for(let h of e[Uv])h();e[Uv]=null}s||(e[de]&=-73)}catch(c){throw Uu(e),c}finally{a!==null&&(uR(a,o),O4(a)),Qw()}}function U4(n){return n.type!==2}function fM(n,e){for(let t=NP(n);t!==null;t=PP(t))for(let r=ir;r<t.length;r++){let i=t[r];pM(i,e)}}function B4(n){for(let e=NP(n);e!==null;e=PP(e)){if(!(e[de]&jw.HasTransplantedViews))continue;let t=e[Ip];for(let r=0;r<t.length;r++){let i=t[r],s=i[an];OH(i)}}}function j4(n,e,t){let r=gs(e,n);pM(r,t)}function pM(n,e){Hw(n)&&mw(n,e)}function mw(n,e){let r=n[Te],i=n[de],s=n[Co],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&wv(s)),s&&(s.dirty=!1),n[de]&=-9217,o)V4(r,n,r.template,n[Ar]);else if(i&8192){fM(n,1);let a=r.components;a!==null&&mM(n,a,1)}}function mM(n,e,t){for(let r=0;r<e.length;r++)j4(n,e[r],t)}function pI(n){for(n[xr].changeDetectionScheduler?.notify();n;){n[de]|=64;let e=Bu(n);if(CH(n)&&!e)return n;n=e}return null}var xo=class{get rootNodes(){let e=this._lView,t=e[Te];return xp(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ar]}set context(e){this._lView[Ar]=e}get destroyed(){return(this._lView[de]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[an];if(Bi(e)){let t=e[wp],r=t?t.indexOf(this):-1;r>-1&&(dw(e,r),_p(t,r))}this._attachedToViewContainer=!1}HP(this._lView[Te],this._lView)}onDestroy(e){oP(this._lView,e)}markForCheck(){pI(this._cdRefInjectingView||this._lView)}detach(){this._lView[de]&=-129}reattach(){rw(this._lView),this._lView[de]|=128}detectChanges(){this._lView[de]|=1024,hM(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new re(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,jP(this._lView[Te],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new re(902,!1);this._appRef=e,rw(this._lView)}},nm=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=q4;let n=e;return n})(),$4=nm,H4=class extends $4{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=R4(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new xo(i)}};function q4(){return z4(zn(),He())}function z4(n,e){return n.type&4?new H4(e,n,Gp(n,e)):null}var soe=new RegExp(`^(\\d+)*(${Tq}|${Cq})*(.*)`);var G4=()=>null;function uN(n,e){return G4(n,e)}var Rp=class{},gw=class{},Np=class{};function W4(n){let e=Error(`No component factory found for ${Pn(n)}.`);return e[K4]=n,e}var K4="ngComponent";var _w=class{resolveComponentFactory(e){throw W4(e)}},rm=(()=>{let e=class e{};e.NULL=new _w;let n=e;return n})(),ju=class{},ys=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>Q4();let n=e;return n})();function Q4(){let n=He(),e=zn(),t=gs(e.index,n);return(Io(t)?t:n)[Jt]}var Y4=(()=>{let e=class e{};e.\u0275prov=oe({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),zv={};var dN=new Set;function mI(n){dN.has(n)||(dN.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function hN(...n){}function J4(){let n=typeof yn.requestAnimationFrame=="function",e=yn[n?"requestAnimationFrame":"setTimeout"],t=yn[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var Je=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new on(!1),this.onMicrotaskEmpty=new on(!1),this.onStable=new on(!1),this.onError=new on(!1),typeof Zone>"u")throw new re(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=J4().nativeRequestAnimationFrame,e3(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new re(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new re(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,X4,hN,hN);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},X4={};function gI(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Z4(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(yn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,yw(n),n.isCheckStableRunning=!0,gI(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),yw(n))}function e3(n){let e=()=>{Z4(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(t3(a))return t.invokeTask(i,s,o,a);try{return fN(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),pN(n)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return fN(n),t.invoke(i,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),pN(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,yw(n),gI(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function yw(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function fN(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function pN(n){n._nesting--,gI(n)}var vw=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new on,this.onMicrotaskEmpty=new on,this.onStable=new on,this.onError=new on}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function t3(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}function n3(n="zone.js",e){return n==="noop"?new vw:n==="zone.js"?new Je(e):n}var oc=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(oc||{}),r3={destroy(){}};function im(n,e){!e&&IH(im);let t=e?.injector??Y(Nr);if(!Mq(t))return r3;mI("NgAfterNextRender");let r=t.get(_I),i=r.handler??=new Iw,s=e?.phase??oc.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(nI).onDestroy(o),c=Vi(t,()=>new ww(s,()=>{o(),n()}));return i.register(c),{destroy:o}}var ww=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=Y(Je),this.errorHandler=Y(ei,{optional:!0}),Y(Rp,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Iw=class{constructor(){this.executingCallbacks=!1,this.buckets={[oc.EarlyRead]:new Set,[oc.Write]:new Set,[oc.MixedReadWrite]:new Set,[oc.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},_I=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=oe({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function Ew(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=jR(i,a);else if(s==2){let c=a,l=e[++o];r=jR(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Pp=class extends rm{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=hs(e);return new mc(t,this.ngModule)}};function mN(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function i3(n){let e=n.toLowerCase();return e==="svg"?AH:e==="math"?xH:null}var bw=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Bp(r);let i=this.injector.get(e,zv,r);return i!==zv||t===zv?i:this.parentInjector.get(e,t,r)}},mc=class extends Np{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=mN(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return mN(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=sH(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Oe(null);try{i=i||this.ngModule;let o=i instanceof Mn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new bw(e,o):e,c=a.get(ju,null);if(c===null)throw new re(407,!1);let l=a.get(Y4,null),d=a.get(_I,null),h=a.get(Rp,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},_=c.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",A=r?i4(_,r,this.componentDef.encapsulation,a):BP(_,w,i3(w)),R=512;this.componentDef.signals?R|=4096:this.componentDef.onPush||(R|=16);let L=null;A!==null&&(L=sI(A,a,!0));let Q=dI(0,null,null,1,0,null,null,null,null,null,null),B=Xp(null,Q,null,R,null,null,p,_,a,null,L);Kw(B);let X,le;try{let te=this.componentDef,T,v=null;te.findHostDirectiveDefs?(T=[],v=new Map,te.findHostDirectiveDefs(te,T,v),T.push(te)):T=[te];let E=s3(B,A),D=o3(E,A,te,T,B,p,_);le=iP(Q,Xr),A&&l3(_,te,A,r),t!==void 0&&u3(le,this.ngContentSelectors,t),X=c3(D,te,T,v,B,[d3]),fI(Q,B,null)}finally{Qw()}return new Cw(this.componentType,X,Gp(le,B),B,le)}finally{Oe(s)}}},Cw=class extends gw{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new xo(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;hI(s[Te],s,i,e,t),this.previousInputValues.set(e,t);let o=gs(this._tNode.index,s);pI(o)}}get injector(){return new Eo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function s3(n,e){let t=n[Te],r=Xr;return n[r]=e,Zp(t,r,2,"#host",null)}function o3(n,e,t,r,i,s,o){let a=i[Te];a3(r,n,e,o);let c=null;e!==null&&(c=sI(e,i[hc]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=Xp(i,nM(t),null,d,i[n.index],n,s,l,null,null,c);return a.firstCreatePass&&fw(a,n,r.length-1),em(i,h),i[n.index]=h}function a3(n,e,t,r){for(let i of n)e.mergedAttrs=Ou(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Ew(e,e.mergedAttrs,!0),t!==null&&WP(r,t,e))}function c3(n,e,t,r,i,s){let o=zn(),a=i[Te],c=or(o,i);sM(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,p=pc(i,a,h,o);Ao(p,i)}oM(a,i,o),c&&Ao(c,i);let l=pc(i,a,o.directiveStart+o.componentOffset,o);if(n[Ar]=i[Ar]=l,s!==null)for(let d of s)d(l,e);return ZP(a,o,i),l}function l3(n,e,t,r){if(r)Xv(n,t,["ng-version","17.3.11"]);else{let{attrs:i,classes:s}=oH(e.selectors[0]);i&&Xv(n,t,i),s&&s.length>0&&GP(n,t,s.join(" "))}}function u3(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function d3(){let n=zn();Zw(He()[Te],n)}var vc=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=h3;let n=e;return n})();function h3(){let n=zn();return p3(n,He())}var f3=vc,gM=class extends f3{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Gp(this._hostTNode,this._hostLView)}get injector(){return new Eo(this._hostTNode,this._hostLView)}get parentInjector(){let e=eI(this._hostTNode,this._hostLView);if(yP(e)){let t=Cp(e,this._hostLView),r=bp(e),i=t[Te].data[r+8];return new Eo(i,t)}else return new Eo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=gN(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ir}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=uN(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,lN(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!bH(e),a;if(o)a=t;else{let w=t||{};a=w.index,r=w.injector,i=w.projectableNodes,s=w.environmentInjector||w.ngModuleRef}let c=o?e:new mc(hs(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let A=(o?l:this.parentInjector).get(Mn,null);A&&(s=A)}let d=hs(c.componentType??{}),h=uN(this._lContainer,d?.id??null),p=h?.firstChild??null,_=c.create(l,i,p,s);return this.insertImpl(_.hostView,a,lN(this._hostTNode,h)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(kH(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[an],l=new gM(c,c[Rr],c[an]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return N4(o,i,s,r),e.attachToViewContainerRef(),MN(Gv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=gN(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=dw(this._lContainer,t);r&&(_p(Gv(this._lContainer),t),HP(r[Te],r))}detach(e){let t=this._adjustIndex(e,-1),r=dw(this._lContainer,t);return r&&_p(Gv(this._lContainer),t)!=null?new xo(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function gN(n){return n[wp]}function Gv(n){return n[wp]||(n[wp]=[])}function p3(n,e){let t,r=e[n.index];return Bi(r)?t=r:(t=aM(r,e,null,n),e[n.index]=t,em(e,t)),g3(t,e,n,r),new gM(t,n,e)}function m3(n,e){let t=n[Jt],r=t.createComment(""),i=or(e,n),s=cI(t,i);return Ap(t,s,r,Wq(t,i),!1),r}var g3=v3,_3=()=>!1;function y3(n,e,t){return _3(n,e,t)}function v3(n,e,t,r){if(n[To])return;let i;t.type&8?i=Zr(r):i=m3(e,t),n[To]=i}function w3(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(C3))}return s}return Mp.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,d=i.styleUrls;i.styleUrls.forEach((h,p)=>{a.push(""),o.push(r(h).then(_=>{a[l+p]=_,d.splice(d.indexOf(h),1),d.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>T3(s));e.push(c)}),E3(),Promise.all(e).then(()=>{})}var Mp=new Map,I3=new Set;function E3(){let n=Mp;return Mp=new Map,n}function b3(){return Mp.size===0}function C3(n){return typeof n=="string"?n:n.text()}function T3(n){I3.delete(n)}function S3(n){return Object.getPrototypeOf(n.prototype).constructor}function Gu(n){let e=S3(n.type),t=!0,r=[n];for(;e;){let i;if(fs(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new re(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let o=n;o.inputs=cp(n.inputs),o.inputTransforms=cp(n.inputTransforms),o.declaredInputs=cp(n.declaredInputs),o.outputs=cp(n.outputs);let a=i.hostBindings;a&&N3(n,a);let c=i.viewQuery,l=i.contentQueries;if(c&&x3(n,c),l&&R3(n,l),D3(n,i),R$(n.outputs,i.outputs),fs(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===Gu&&(t=!1)}}e=Object.getPrototypeOf(e)}A3(r)}function D3(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function A3(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Ou(i.hostAttrs,t=Ou(t,i.hostAttrs))}}function cp(n){return n===lc?{}:n===Sr?[]:n}function x3(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function R3(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function N3(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function yI(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var ps=class{},$u=class{};var kp=class extends ps{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Pp(this);let i=HN(e);this._bootstrapComponents=UP(i.bootstrap),this._r3Injector=DP(e,t,[{provide:ps,useValue:this},{provide:rm,useValue:this.componentFactoryResolver},...r],Pn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Op=class extends $u{constructor(e){super(),this.moduleType=e}create(e){return new kp(this.moduleType,e,[])}};function P3(n,e,t){return new kp(n,e,t)}var Tw=class extends ps{constructor(e){super(),this.componentFactoryResolver=new Pp(this),this.instance=null;let t=new Fu([...e.providers,{provide:ps,useValue:this},{provide:rm,useValue:this.componentFactoryResolver}],e.parent||Bw(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function sm(n,e,t=null){return new Tw({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var om=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Ne(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function _M(n){return k3(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function M3(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function k3(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function O3(n,e,t){return n[e]=t}function ms(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function Fp(n,e,t,r){let i=ms(n,e,t);return ms(n,e+1,r)||i}function F3(n,e,t,r,i){let s=Fp(n,e,t,r);return ms(n,e+2,i)||s}function L3(n,e,t,r,i,s){let o=Fp(n,e,t,r);return Fp(n,e+2,i,s)||o}function V3(n){return(n.flags&32)===32}function U3(n,e,t,r,i,s,o,a,c){let l=e.consts,d=Zp(e,n,4,o||null,Ep(l,a));iM(e,t,d,Ep(l,c)),Zw(e,d);let h=d.tView=dI(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}function ot(n,e,t,r,i,s,o,a){let c=He(),l=ar(),d=n+Xr,h=l.firstCreatePass?U3(d,l,c,e,t,r,i,s,o):l.data[d];zu(h,!1);let p=B3(l,c,h,n);Jw()&&lI(l,c,p,h),Ao(p,c);let _=aM(p,c,p,h);return c[d]=_,em(c,_),y3(_,h,c),$w(h)&&eM(l,c,h),o!=null&&tM(c,h,a),ot}var B3=j3;function j3(n,e,t,r){return Xw(!0),e[Jt].createComment("")}function am(n,e,t,r){let i=He(),s=Gw();if(ms(i,s,e)){let o=ar(),a=Yw();I4(a,i,n,e,t,r)}return am}function yM(n,e,t,r){return ms(n,Gw(),t)?e+Nn(t)+r:cr}function $3(n,e,t,r,i,s){let o=zw(),a=Fp(n,o,t,i);return Ww(2),a?e+Nn(t)+r+Nn(i)+s:cr}function H3(n,e,t,r,i,s,o,a){let c=zw(),l=F3(n,c,t,i,o);return Ww(3),l?e+Nn(t)+r+Nn(i)+s+Nn(o)+a:cr}function q3(n,e,t,r,i,s,o,a,c,l,d,h){let p=zw(),_=L3(n,p,t,i,o,c);return _=ms(n,p+4,d)||_,Ww(5),_?e+Nn(t)+r+Nn(i)+s+Nn(o)+a+Nn(c)+l+Nn(d)+h:cr}function Ce(n,e,t){let r=He(),i=Gw();if(ms(r,i,e)){let s=ar(),o=Yw();rM(s,o,r,n,e,r[Jt],t,!1)}return Ce}function _N(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";hI(n,t,s[o],o,r)}function z3(n,e,t,r,i,s){let o=e.consts,a=Ep(o,i),c=Zp(e,n,2,r,a);return iM(e,t,c,Ep(o,s)),c.attrs!==null&&Ew(c,c.attrs,!1),c.mergedAttrs!==null&&Ew(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function I(n,e,t,r){let i=He(),s=ar(),o=Xr+n,a=i[Jt],c=s.firstCreatePass?z3(o,s,i,e,t,r):s.data[o],l=G3(s,i,c,a,e,n);i[o]=l;let d=$w(c);return zu(c,!0),WP(a,l,c),!V3(c)&&Jw()&&lI(s,i,l,c),VH()===0&&Ao(l,i),UH(),d&&(eM(s,i,c),ZP(s,c,i)),r!==null&&tM(i,c),I}function b(){let n=zn();lP()?zH():(n=n.parent,zu(n,!1));let e=n;$H(e)&&HH(),BH();let t=ar();return t.firstCreatePass&&(Zw(t,n),ZN(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&rq(e)&&_N(t,e,He(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&iq(e)&&_N(t,e,He(),e.stylesWithoutHost,!1),b}function J(n,e,t,r){return I(n,e,t,r),b(),J}var G3=(n,e,t,r,i,s)=>(Xw(!0),BP(r,i,ZH()));function cn(){return He()}var Lp="en-US";var W3=Lp;function K3(n){typeof n=="string"&&(W3=n.toLowerCase().replace(/_/g,"-"))}function z(n,e,t,r){let i=He(),s=ar(),o=zn();return Y3(s,i,i[Jt],o,n,e,r),z}function Q3(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Lu],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function Y3(n,e,t,r,i,s,o){let a=$w(r),l=n.firstCreatePass&&S4(n),d=e[Ar],h=T4(e),p=!0;if(r.type&3||o){let A=or(r,e),R=o?o(A):A,L=h.length,Q=o?X=>o(Zr(X[r.index])):r.index,B=null;if(!o&&a&&(B=Q3(n,e,i,r.index)),B!==null){let X=B.__ngLastListenerFn__||B;X.__ngNextListenerFn__=s,B.__ngLastListenerFn__=s,p=!1}else{s=vN(r,e,d,s,!1);let X=t.listen(R,i,s);h.push(s,X),l&&l.push(i,Q,L,L+1)}}else s=vN(r,e,d,s,!1);let _=r.outputs,w;if(p&&_!==null&&(w=_[i])){let A=w.length;if(A)for(let R=0;R<A;R+=2){let L=w[R],Q=w[R+1],le=e[L][Q].subscribe(s),te=h.length;h.push(s,le),l&&l.push(i,r.index,te,-(te+1))}}}function yN(n,e,t,r){let i=Oe(null);try{return Kr(6,e,t),t(r)!==!1}catch(s){return lM(n,s),!1}finally{Kr(7,e,t),Oe(i)}}function vN(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?gs(n.index,e):e;pI(a);let c=yN(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)c=yN(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function je(n=1){return XH(n)}function vI(n,e,t){return lr(n,"",e,"",t),vI}function lr(n,e,t,r,i){let s=He(),o=yM(s,e,t,r);if(o!==cr){let a=ar(),c=Yw();rM(a,c,s,n,o,s[Jt],i,!1)}return lr}function J3(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function S(n,e=""){let t=He(),r=ar(),i=n+Xr,s=r.firstCreatePass?Zp(r,i,1,e,null):r.data[i],o=X3(r,t,s,e,n);t[i]=o,Jw()&&lI(r,t,o,s),zu(s,!1)}var X3=(n,e,t,r,i)=>(Xw(!0),Oq(e[Jt],r));function $t(n){return Po("",n,""),$t}function Po(n,e,t){let r=He(),i=yM(r,n,e,t);return i!==cr&&tm(r,yc(),i),Po}function wI(n,e,t,r,i){let s=He(),o=$3(s,n,e,t,r,i);return o!==cr&&tm(s,yc(),o),wI}function Wu(n,e,t,r,i,s,o){let a=He(),c=H3(a,n,e,t,r,i,s,o);return c!==cr&&tm(a,yc(),c),Wu}function II(n,e,t,r,i,s,o,a,c,l,d){let h=He(),p=q3(h,n,e,t,r,i,s,o,a,c,l,d);return p!==cr&&tm(h,yc(),p),II}function Z3(n,e,t){let r=ar();if(r.firstCreatePass){let i=fs(n);Sw(t,r.data,r.blueprint,i,!0),Sw(e,r.data,r.blueprint,i,!1)}}function Sw(n,e,t,r,i){if(n=_n(n),Array.isArray(n))for(let s=0;s<n.length;s++)Sw(n[s],e,t,r,i);else{let s=ar(),o=He(),a=zn(),c=dc(n)?n:_n(n.provide),l=QN(n),d=a.providerIndexes&1048575,h=a.directiveStart,p=a.providerIndexes>>20;if(dc(n)||!n.multi){let _=new Do(l,i,ee),w=Kv(c,e,i?d:d+p,h);w===-1?(ow(Sp(a,o),s,c),Wv(s,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(_),o.push(_)):(t[w]=_,o[w]=_)}else{let _=Kv(c,e,d+p,h),w=Kv(c,e,d,d+p),A=_>=0&&t[_],R=w>=0&&t[w];if(i&&!R||!i&&!A){ow(Sp(a,o),s,c);let L=nz(i?tz:ez,t.length,i,r,l);!i&&R&&(t[w].providerFactory=L),Wv(s,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(L),o.push(L)}else{let L=vM(t[i?w:_],l,!i&&r);Wv(s,n,_>-1?_:w,L)}!i&&r&&R&&t[w].componentProviders++}}}function Wv(n,e,t,r){let i=dc(e),s=pH(e);if(i||s){let c=(s?_n(e.useClass):e).prototype.ngOnDestroy;if(c){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=l.indexOf(t);d===-1?l.push(t,[r,c]):l[d+1].push(r,c)}else l.push(t,c)}}}function vM(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Kv(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function ez(n,e,t,r){return Dw(this.multi,[])}function tz(n,e,t,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=pc(t,t[Te],this.providerFactory.index,r);s=a.slice(0,o),Dw(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],Dw(i,s);return s}function Dw(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function nz(n,e,t,r,i){let s=new Do(n,t,ee);return s.multi=[],s.index=e,s.componentProviders=0,vM(s,i,r&&!t),s}function EI(n,e=[]){return t=>{t.providersResolver=(r,i)=>Z3(r,i?i(n):n,e)}}var rz=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=GN(!1,r.type),s=i.length>0?sm([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=oe({token:e,providedIn:"environment",factory:()=>new e(ae(Mn))});let n=e;return n})();function wM(n){mI("NgStandalone"),n.getStandaloneInjector=e=>e.get(rz).getOrCreateStandaloneInjector(n)}function iz(n,e){let t=n[e];return t===cr?void 0:t}function sz(n,e,t,r,i,s){let o=e+t;return ms(n,o,i)?O3(n,o+1,s?r.call(s,i):r(i)):iz(n,o+1)}function ur(n,e){let t=ar(),r,i=n+Xr;t.firstCreatePass?(r=oz(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=bo(r.type,!0)),o,a=Rn(ee);try{let c=Tp(!1),l=s();return Tp(c),J3(t,He(),i,l),l}finally{Rn(a)}}function oz(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function dr(n,e,t){let r=n+Xr,i=He(),s=MH(i,r);return az(i,r)?sz(i,GH(),e,s.transform,t,s):s.transform(t)}function az(n,e){return n[Te].data[e].pure}var lp=null;function cz(n){lp!==null&&(n.defaultEncapsulation!==lp.defaultEncapsulation||n.preserveWhitespaces!==lp.preserveWhitespaces)||(lp=n)}var cm=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var bI=new he(""),Ku=new he(""),lm=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,CI||(lz(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Je.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(ae(Je),ae(um),ae(Ku))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),um=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return CI?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function lz(n){CI=n}var CI;function Mo(n){return!!n&&typeof n.then=="function"}function TI(n){return!!n&&typeof n.subscribe=="function"}var dm=new he(""),IM=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=Y(dm,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Mo(o))r.push(o);else if(TI(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),SI=new he("");function uz(){hR(()=>{throw new re(600,!1)})}function dz(n){return n.isBoundToModule}function hz(n,e,t){try{let r=t();return Mo(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function EM(n,e){return Array.isArray(e)?e.reduce(EM,n):q(q({},n),e)}var wc=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Y(AP),this.afterRenderEffectManager=Y(_I),this.externalTestViews=new Set,this.beforeRender=new sn,this.afterTick=new sn,this.componentTypes=[],this.components=[],this.isStable=Y(om).hasPendingTasks.pipe(Pe(r=>!r)),this._injector=Y(Mn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Np;if(!this._injector.get(IM).done){let _=!s&&$N(r),w=!1;throw new re(405,w)}let a;s?a=r:a=this._injector.get(rm).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=dz(a)?void 0:this._injector.get(ps),l=i||a.selector,d=a.create(Nr.NULL,[],l,c),h=d.location.nativeElement,p=d.injector.get(bI,null);return p?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),pp(this.components,d),p?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new re(101,!1);let i=Oe(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Oe(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===dM)throw new re(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)fz(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Aw(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Aw(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;pp(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(SI,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>pp(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new re(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function pp(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function fz(n,e,t){!e&&!Aw(n)||pz(n,t,e)}function Aw(n){return qw(n)}function pz(n,e,t){let r;t?(r=0,n[de]|=1024):n[de]&64?r=0:r=1,hM(n,e,r)}var xw=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},hm=(()=>{let e=class e{compileModuleSync(r){return new Op(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=HN(r),o=UP(s.declarations).reduce((a,c)=>{let l=hs(c);return l&&a.push(new mc(l)),a},[]);return new xw(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),mz=new he("");function gz(n,e,t){let r=new Op(t);return Promise.resolve(r)}function wN(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var _z=(()=>{let e=class e{constructor(){this.zone=Y(Je),this.applicationRef=Y(wc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function yz(n){return[{provide:Je,useFactory:n},{provide:uc,multi:!0,useFactory:()=>{let e=Y(_z,{optional:!0});return()=>e.initialize()}},{provide:uc,multi:!0,useFactory:()=>{let e=Y(Iz);return()=>{e.initialize()}}},{provide:AP,useFactory:vz}]}function vz(){let n=Y(Je),e=Y(ei);return t=>n.runOutsideAngular(()=>e.handleError(t))}function wz(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var Iz=(()=>{let e=class e{constructor(){this.subscription=new Vt,this.initialized=!1,this.zone=Y(Je),this.pendingTasks=Y(om)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Je.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Je.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Ez(){return typeof $localize<"u"&&$localize.locale||Lp}var DI=new he("",{providedIn:"root",factory:()=>Y(DI,Ie.Optional|Ie.SkipSelf)||Ez()});var bM=new he(""),CM=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=n3(i?.ngZone,wz({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=P3(r.moduleType,this.injector,yz(()=>s)),a=o.injector.get(ei,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{pp(this._modules,o),c.unsubscribe()})}),hz(a,s,()=>{let c=o.injector.get(IM);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(DI,Lp);return K3(l||Lp),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=EM({},i);return gz(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(wc);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new re(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new re(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(bM,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(ae(Nr))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),Mu=null,TM=new he("");function bz(n){if(Mu&&!Mu.get(TM,!1))throw new re(400,!1);uz(),Mu=n;let e=n.get(CM);return Sz(n),e}function AI(n,e,t=[]){let r=`Platform: ${e}`,i=new he(r);return(s=[])=>{let o=SM();if(!o||o.injector.get(TM,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):bz(Cz(a,r))}return Tz(i)}}function Cz(n=[],e){return Nr.create({name:e,providers:[{provide:$p,useValue:"platform"},{provide:bM,useValue:new Set([()=>Mu=null])},...n]})}function Tz(n){let e=SM();if(!e)throw new re(401,!1);return e}function SM(){return Mu?.get(CM)??null}function Sz(n){n.get(rI,null)?.forEach(t=>t())}var ko=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Dz;let n=e;return n})();function Dz(n){return Az(zn(),He(),(n&16)===16)}function Az(n,e,t){if(zp(n)&&!t){let r=gs(n.index,e);return new xo(r,r)}else if(n.type&47){let r=e[Jr];return new xo(r,e)}return null}var Rw=class{constructor(){}supports(e){return _M(e)}create(e){return new Nw(e)}},xz=(n,e)=>e,Nw=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||xz}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<IN(r,i,s)?t:r,a=IN(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,d=c-i;if(l!=d){for(let p=0;p<l;p++){let _=p<s.length?s[p]:s[p]=0,w=_+p;d<=w&&w<l&&(s[p]=_+1)}let h=o.previousIndex;s[h]=d-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!_M(e))throw new re(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,M3(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new Pw(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Vp),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Vp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Pw=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Mw=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Vp=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Mw,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function IN(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function EN(){return new xI([new Rw])}var xI=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||EN()),deps:[[e,new Fw,new jp]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new re(901,!1)}};e.\u0275prov=oe({token:e,providedIn:"root",factory:EN});let n=e;return n})();var DM=AI(null,"core",[]),AM=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(ae(wc))},e.\u0275mod=On({type:e}),e.\u0275inj=kn({});let n=e;return n})();function Ic(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function RI(n){let e=Oe(null);try{return n()}finally{Oe(e)}}function xM(n){let e=hs(n);if(!e)return null;let t=new mc(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var kM=null;function Oo(){return kM}function OM(n){kM??=n}var fm=class{};var Fn=new he(""),VI=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>Y(Rz),providedIn:"platform"});let n=e;return n})(),FM=new he(""),Rz=(()=>{let e=class e extends VI{constructor(){super(),this._doc=Y(Fn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Oo().getBaseHref(this._doc)}onPopState(r){let i=Oo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=Oo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function UI(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function RM(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function $i(n){return n&&n[0]!=="?"?"?"+n:n}var Pr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>Y(BI),providedIn:"root"});let n=e;return n})(),LM=new he(""),BI=(()=>{let e=class e extends Pr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Y(Fn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return UI(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+$i(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+$i(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+$i(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(ae(VI),ae(LM,8))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),mm=(()=>{let e=class e extends Pr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=UI(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+$i(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+$i(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(ae(VI),ae(LM,8))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),Ec=(()=>{let e=class e{constructor(r){this._subject=new on,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=Mz(RM(NM(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+$i(i))}normalize(r){return e.stripTrailingSlash(Pz(this._basePath,NM(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+$i(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+$i(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=$i,e.joinWithSlash=UI,e.stripTrailingSlash=RM,e.\u0275fac=function(i){return new(i||e)(ae(Pr))},e.\u0275prov=oe({token:e,factory:()=>Nz(),providedIn:"root"});let n=e;return n})();function Nz(){return new Ec(ae(Pr))}function Pz(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function NM(n){return n.replace(/\/index.html$/,"")}function Mz(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function VM(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var NI=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},ti=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new NI(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),PM(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);PM(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(ee(vc),ee(nm),ee(xI))},e.\u0275dir=qn({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let n=e;return n})();function PM(n,e){n.context.$implicit=e.item}var vs=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new PI,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){MM("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){MM("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(ee(vc),ee(nm))},e.\u0275dir=qn({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let n=e;return n})(),PI=class{constructor(){this.$implicit=null,this.ngIf=null}};function MM(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${Pn(e)}'.`)}function kz(n,e){return new re(2100,!1)}var MI=class{createSubscription(e,t){return RI(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){RI(()=>e.unsubscribe())}},kI=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},Oz=new kI,Fz=new MI,ni=(()=>{let e=class e{constructor(r){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=r}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(r){if(!this._obj){if(r)try{this.markForCheckOnValueUpdate=!1,this._subscribe(r)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return r!==this._obj?(this._dispose(),this.transform(r)):this._latestValue}_subscribe(r){this._obj=r,this._strategy=this._selectStrategy(r),this._subscription=this._strategy.createSubscription(r,i=>this._updateLatestValue(r,i))}_selectStrategy(r){if(Mo(r))return Oz;if(TI(r))return Fz;throw kz(e,r)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(r,i){r===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}};e.\u0275fac=function(i){return new(i||e)(ee(ko,16))},e.\u0275pipe=UN({name:"async",type:e,pure:!1,standalone:!0});let n=e;return n})();var UM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=On({type:e}),e.\u0275inj=kn({});let n=e;return n})(),jI="browser",Lz="server";function Vz(n){return n===jI}function $I(n){return n===Lz}var BM=(()=>{let e=class e{};e.\u0275prov=oe({token:e,providedIn:"root",factory:()=>Vz(Y(_s))?new OI(Y(Fn),window):new FI});let n=e;return n})(),OI=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=Uz(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function Uz(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var FI=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},pm=class{};var zI=class extends fm{constructor(){super(...arguments),this.supportsDOMEvents=!0}},GI=class n extends zI{static makeCurrent(){OM(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=jz();return t==null?null:$z(t)}resetBaseElement(){Qu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return VM(document.cookie,e)}},Qu=null;function jz(){return Qu=Qu||document.querySelector("base"),Qu?Qu.getAttribute("href"):null}function $z(n){return new URL(n,document.baseURI).pathname}var WI=class{addToWindow(e){yn.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new re(5103,!1);return s},yn.getAllAngularTestabilities=()=>e.getAllTestabilities(),yn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=yn.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};yn.frameworkStabilizers||(yn.frameworkStabilizers=[]),yn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?Oo().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},Hz=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),KI=new he(""),qM=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new re(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(ae(KI),ae(Je))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),gm=class{constructor(e){this._doc=e}},HI="ng-app-id",zM=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=$I(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${HI}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(HI),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(HI,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(ae(Fn),ae(Wp),ae(iI,8),ae(_s))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),qI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},YI=/%COMP%/g,GM="%COMP%",qz=`_nghost-${GM}`,zz=`_ngcontent-${GM}`,Gz=!0,Wz=new he("",{providedIn:"root",factory:()=>Gz});function Kz(n){return zz.replace(YI,n)}function Qz(n){return qz.replace(YI,n)}function WM(n,e){return e.map(t=>t.replace(YI,n))}var jM=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=$I(c),this.defaultRenderer=new Yu(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Yr.ShadowDom&&(i=st(q({},i),{encapsulation:Yr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof _m?s.applyToHost(r):s instanceof Ju&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(i.encapsulation){case Yr.Emulated:o=new _m(l,d,i,this.appId,h,a,c,p);break;case Yr.ShadowDom:return new QI(l,d,r,i,a,c,this.nonce,p);default:o=new Ju(l,d,i,h,a,c,p);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(ae(qM),ae(zM),ae(Wp),ae(Wz),ae(Fn),ae(_s),ae(Je),ae(iI))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),Yu=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(qI[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){($M(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&($M(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new re(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=qI[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=qI[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(No.DashCase|No.Important)?e.style.setProperty(t,r,i&No.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&No.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=Oo().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function $M(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var QI=class extends Yu{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=WM(i.id,i.styles);for(let d of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ju=class extends Yu{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?WM(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},_m=class extends Ju{constructor(e,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,l),this.contentAttr=Kz(l),this.hostAttr=Qz(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},Yz=(()=>{let e=class e extends gm{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(ae(Fn))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})(),HM=["alt","control","meta","shift"],Jz={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Xz={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Zz=(()=>{let e=class e extends gm{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Oo().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),HM.forEach(d=>{let h=i.indexOf(d);h>-1&&(i.splice(h,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=Jz[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),HM.forEach(a=>{if(a!==s){let c=Xz[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(ae(Fn))},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})();function eG(){GI.makeCurrent()}function tG(){return new ei}function nG(){return kP(document),document}var rG=[{provide:_s,useValue:jI},{provide:rI,useValue:eG,multi:!0},{provide:Fn,useFactory:nG,deps:[]}],KM=AI(DM,"browser",rG),iG=new he(""),sG=[{provide:Ku,useClass:WI,deps:[]},{provide:bI,useClass:lm,deps:[Je,um,Ku]},{provide:lm,useClass:lm,deps:[Je,um,Ku]}],oG=[{provide:$p,useValue:"root"},{provide:ei,useFactory:tG,deps:[]},{provide:KI,useClass:Yz,multi:!0,deps:[Fn,Je,_s]},{provide:KI,useClass:Zz,multi:!0,deps:[Fn]},jM,zM,qM,{provide:ju,useExisting:jM},{provide:pm,useClass:Hz,deps:[]},[]],QM=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Wp,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(ae(iG,12))},e.\u0275mod=On({type:e}),e.\u0275inj=kn({providers:[...oG,...sG],imports:[UM,AM]});let n=e;return n})();var YM=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(ae(Fn))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var _e="primary",hd=Symbol("RouteTitle"),tE=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Dc(n){return new tE(n)}function aG(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function cG(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ri(n[t],e[t]))return!1;return!0}function ri(n,e){let t=n?nE(n):void 0,r=e?nE(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!ok(n[i],e[i]))return!1;return!0}function nE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function ok(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function ak(n){return n.length>0?n[n.length-1]:null}function bs(n){return Pv(n)?n:Mo(n)?Et(Promise.resolve(n)):ue(n)}var lG={exact:lk,subset:uk},ck={exact:uG,subset:dG,ignored:()=>!0};function XM(n,e,t){return lG[t.paths](n.root,e.root,t.matrixParams)&&ck[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function uG(n,e){return ri(n,e)}function lk(n,e,t){if(!Vo(n.segments,e.segments)||!wm(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!lk(n.children[r],e.children[r],t))return!1;return!0}function dG(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>ok(n[t],e[t]))}function uk(n,e,t){return dk(n,e,e.segments,t)}function dk(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Vo(i,t)||e.hasChildren()||!wm(i,t,r))}else if(n.segments.length===t.length){if(!Vo(n.segments,t)||!wm(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!uk(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Vo(n.segments,i)||!wm(n.segments,i,r)||!n.children[_e]?!1:dk(n.children[_e],e,s,r)}}function wm(n,e,t){return e.every((r,i)=>ck[t](n[i].parameters,r.parameters))}var ws=class{constructor(e=new Be([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Dc(this.queryParams),this._queryParamMap}toString(){return pG.serialize(this)}},Be=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Im(this)}},Lo=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Dc(this.parameters),this._parameterMap}toString(){return fk(this)}};function hG(n,e){return Vo(n,e)&&n.every((t,r)=>ri(t.parameters,e[r].parameters))}function Vo(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function fG(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===_e&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==_e&&(t=t.concat(e(i,r)))}),t}var fd=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>new id,providedIn:"root"});let n=e;return n})(),id=class{parse(e){let t=new iE(e);return new ws(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Xu(e.root,!0)}`,r=_G(e.queryParams),i=typeof e.fragment=="string"?`#${mG(e.fragment)}`:"";return`${t}${r}${i}`}},pG=new id;function Im(n){return n.segments.map(e=>fk(e)).join("/")}function Xu(n,e){if(!n.hasChildren())return Im(n);if(e){let t=n.children[_e]?Xu(n.children[_e],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==_e&&r.push(`${i}:${Xu(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=fG(n,(r,i)=>i===_e?[Xu(n.children[_e],!1)]:[`${i}:${Xu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[_e]!=null?`${Im(n)}/${t[0]}`:`${Im(n)}/(${t.join("//")})`}}function hk(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ym(n){return hk(n).replace(/%3B/gi,";")}function mG(n){return encodeURI(n)}function rE(n){return hk(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Em(n){return decodeURIComponent(n)}function ZM(n){return Em(n.replace(/\+/g,"%20"))}function fk(n){return`${rE(n.path)}${gG(n.parameters)}`}function gG(n){return Object.entries(n).map(([e,t])=>`;${rE(e)}=${rE(t)}`).join("")}function _G(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${ym(t)}=${ym(i)}`).join("&"):`${ym(t)}=${ym(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var yG=/^[^\/()?;#]+/;function JI(n){let e=n.match(yG);return e?e[0]:""}var vG=/^[^\/()?;=#]+/;function wG(n){let e=n.match(vG);return e?e[0]:""}var IG=/^[^=?&#]+/;function EG(n){let e=n.match(IG);return e?e[0]:""}var bG=/^[^&#]+/;function CG(n){let e=n.match(bG);return e?e[0]:""}var iE=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Be([],{}):new Be([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[_e]=new Be(e,t)),r}parseSegment(){let e=JI(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new re(4009,!1);return this.capture(e),new Lo(Em(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=wG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=JI(this.remaining);i&&(r=i,this.capture(r))}e[Em(t)]=Em(r)}parseQueryParam(e){let t=EG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=CG(this.remaining);o&&(r=o,this.capture(r))}let i=ZM(t),s=ZM(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=JI(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new re(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=_e);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[_e]:new Be([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new re(4011,!1)}};function pk(n){return n.segments.length>0?new Be([],{[_e]:n}):n}function mk(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=mk(i);if(r===_e&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Be(n.segments,e);return TG(t)}function TG(n){if(n.numberOfChildren===1&&n.children[_e]){let e=n.children[_e];return new Be(n.segments.concat(e.segments),e.children)}return n}function Ac(n){return n instanceof ws}function SG(n,e,t=null,r=null){let i=gk(n);return _k(i,e,t,r)}function gk(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new Be(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=pk(r);return e??i}function _k(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return XI(i,i,i,t,r);let s=DG(e);if(s.toRoot())return XI(i,i,new Be([],{}),t,r);let o=AG(s,i,n),a=o.processChildren?td(o.segmentGroup,o.index,s.commands):vk(o.segmentGroup,o.index,s.commands);return XI(i,o.segmentGroup,a,t,r)}function bm(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function sd(n){return typeof n=="object"&&n!=null&&n.outlets}function XI(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=yk(n,e,t);let a=pk(mk(o));return new ws(a,s,i)}function yk(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=yk(s,e,t)}),new Be(n.segments,r)}var Cm=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&bm(r[0]))throw new re(4003,!1);let i=r.find(sd);if(i&&i!==ak(r))throw new re(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function DG(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Cm(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Cm(t,e,r)}var Tc=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function AG(n,e,t){if(n.isAbsolute)return new Tc(e,!0,0);if(!t)return new Tc(e,!1,NaN);if(t.parent===null)return new Tc(t,!0,0);let r=bm(n.commands[0])?0:1,i=t.segments.length-1+r;return xG(t,i,n.numberOfDoubleDots)}function xG(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new re(4005,!1);i=r.segments.length}return new Tc(r,!1,i-s)}function RG(n){return sd(n[0])?n[0].outlets:{[_e]:n}}function vk(n,e,t){if(n??=new Be([],{}),n.segments.length===0&&n.hasChildren())return td(n,e,t);let r=NG(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Be(n.segments.slice(0,r.pathIndex),{});return s.children[_e]=new Be(n.segments.slice(r.pathIndex),n.children),td(s,0,i)}else return r.match&&i.length===0?new Be(n.segments,{}):r.match&&!n.hasChildren()?sE(n,e,t):r.match?td(n,0,i):sE(n,e,t)}function td(n,e,t){if(t.length===0)return new Be(n.segments,{});{let r=RG(t),i={};if(Object.keys(r).some(s=>s!==_e)&&n.children[_e]&&n.numberOfChildren===1&&n.children[_e].segments.length===0){let s=td(n.children[_e],e,t);return new Be(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=vk(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Be(n.segments,i)}}function NG(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(sd(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!tk(c,l,o))return s;r+=2}else{if(!tk(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function sE(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(sd(s)){let c=PG(s.outlets);return new Be(r,c)}if(i===0&&bm(t[0])){let c=n.segments[e];r.push(new Lo(c.path,ek(t[0]))),i++;continue}let o=sd(s)?s.outlets[_e]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&bm(a)?(r.push(new Lo(o,ek(a))),i+=2):(r.push(new Lo(o,{})),i++)}return new Be(r,{})}function PG(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=sE(new Be([],{}),0,r))}),e}function ek(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function tk(n,e,t){return n==t.path&&ri(e,t.parameters)}var nd="imperative",Ht=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Ht||{}),hr=class{constructor(e,t){this.id=e,this.url=t}},xc=class extends hr{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Ht.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ii=class extends hr{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Ht.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Wn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Wn||{}),Tm=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Tm||{}),Is=class extends hr{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Ht.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Es=class extends hr{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Ht.NavigationSkipped}},od=class extends hr{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Ht.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Sm=class extends hr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ht.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},oE=class extends hr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ht.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},aE=class extends hr{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Ht.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},cE=class extends hr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ht.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},lE=class extends hr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ht.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},uE=class{constructor(e){this.route=e,this.type=Ht.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},dE=class{constructor(e){this.route=e,this.type=Ht.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},hE=class{constructor(e){this.snapshot=e,this.type=Ht.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},fE=class{constructor(e){this.snapshot=e,this.type=Ht.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},pE=class{constructor(e){this.snapshot=e,this.type=Ht.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mE=class{constructor(e){this.snapshot=e,this.type=Ht.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Dm=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=Ht.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},ad=class{},cd=class{constructor(e){this.url=e}};var gE=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new pd,this.attachRef=null}},pd=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new gE,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Am=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=_E(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=_E(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=yE(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return yE(e,this._root).map(t=>t.value)}};function _E(n,e){if(n===e.value)return e;for(let t of e.children){let r=_E(n,t);if(r)return r}return null}function yE(n,e){if(n===e.value)return[e];for(let t of e.children){let r=yE(n,t);if(r.length)return r.unshift(e),r}return[]}var Gn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Cc(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var xm=class extends Am{constructor(e,t){super(e),this.snapshot=t,AE(this,e)}toString(){return this.snapshot.toString()}};function wk(n){let e=MG(n),t=new Ne([new Lo("",{})]),r=new Ne({}),i=new Ne({}),s=new Ne({}),o=new Ne(""),a=new Mr(t,r,s,o,i,_e,n,e.root);return a.snapshot=e.root,new xm(new Gn(a,[]),e)}function MG(n){let e={},t={},r={},i="",s=new ld([],e,r,i,t,_e,n,null,{});return new Rm("",new Gn(s,[]))}var Mr=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Pe(l=>l[hd]))??ue(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Pe(e=>Dc(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Pe(e=>Dc(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function DE(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:q(q({},e.params),n.params),data:q(q({},e.data),n.data),resolve:q(q(q(q({},n.data),e.data),i?.data),n._resolvedData)}:r={params:q({},n.params),data:q({},n.data),resolve:q(q({},n.data),n._resolvedData??{})},i&&Ek(i)&&(r.resolve[hd]=i.title),r}var ld=class{get title(){return this.data?.[hd]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Dc(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Dc(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Rm=class extends Am{constructor(e,t){super(t),this.url=e,AE(this,t)}toString(){return Ik(this._root)}};function AE(n,e){e.value._routerState=n,e.children.forEach(t=>AE(n,t))}function Ik(n){let e=n.children.length>0?` { ${n.children.map(Ik).join(", ")} } `:"";return`${n.value}${e}`}function ZI(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ri(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),ri(e.params,t.params)||n.paramsSubject.next(t.params),cG(e.url,t.url)||n.urlSubject.next(t.url),ri(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function vE(n,e){let t=ri(n.params,e.params)&&hG(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||vE(n.parent,e.parent))}function Ek(n){return typeof n.title=="string"||n.title===null}var xE=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=_e,this.activateEvents=new on,this.deactivateEvents=new on,this.attachEvents=new on,this.detachEvents=new on,this.parentContexts=Y(pd),this.location=Y(vc),this.changeDetector=Y(ko),this.environmentInjector=Y(Mn),this.inputBinder=Y(Om,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new re(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new re(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new re(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new re(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new wE(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=qn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[_c]});let n=e;return n})(),wE=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Mr?this.route:e===pd?this.childContexts:this.parent.get(e,t)}},Om=new he(""),nk=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Ru([i.queryParams,i.params,i.data]).pipe(rr(([o,a,c],l)=>(c=q(q(q({},o),a),c),l===0?ue(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=xM(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})();function kG(n,e,t){let r=ud(n,e._root,t?t._root:void 0);return new xm(r,e)}function ud(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=OG(n,e,t);return new Gn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>ud(n,a)),o}}let r=FG(e.value),i=e.children.map(s=>ud(n,s));return new Gn(r,i)}}function OG(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return ud(n,r,i);return ud(n,r)})}function FG(n){return new Mr(new Ne(n.url),new Ne(n.params),new Ne(n.queryParams),new Ne(n.fragment),new Ne(n.data),n.outlet,n.component,n)}var bk="ngNavigationCancelingError";function Ck(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Ac(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Tk(!1,Wn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function Tk(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[bk]=!0,t.cancellationCode=e,t}function LG(n){return Sk(n)&&Ac(n.url)}function Sk(n){return!!n&&n[bk]}var VG=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Se({type:e,selectors:[["ng-component"]],standalone:!0,features:[wM],decls:1,vars:0,template:function(i,s){i&1&&J(0,"router-outlet")},dependencies:[xE],encapsulation:2});let n=e;return n})();function UG(n,e){return n.providers&&!n._injector&&(n._injector=sm(n.providers,e,`Route: ${n.path}`)),n._injector??e}function RE(n){let e=n.children&&n.children.map(RE),t=e?st(q({},n),{children:e}):q({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==_e&&(t.component=VG),t}function si(n){return n.outlet||_e}function BG(n,e){let t=n.filter(r=>si(r)===e);return t.push(...n.filter(r=>si(r)!==e)),t}function md(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var jG=(n,e,t,r)=>Pe(i=>(new IE(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),IE=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),ZI(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Cc(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Cc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Cc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Cc(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new mE(s.value.snapshot))}),e.children.length&&this.forwardEvent(new fE(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(ZI(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),ZI(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=md(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Nm=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Sc=class{constructor(e,t){this.component=e,this.route=t}};function $G(n,e,t){let r=n._root,i=e?e._root:null;return Zu(r,i,t,[r.value])}function HG(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Nc(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!SN(n)?n:e.get(n):r}function Zu(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Cc(e);return n.children.forEach(o=>{qG(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>rd(a,t.getContext(o),i)),i}function qG(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=zG(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Nm(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Zu(n,e,a?a.children:null,r,i):Zu(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Sc(a.outlet.component,o))}else o&&rd(e,a,i),i.canActivateChecks.push(new Nm(r)),s.component?Zu(n,null,a?a.children:null,r,i):Zu(n,null,t,r,i);return i}function zG(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Vo(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Vo(n.url,e.url)||!ri(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!vE(n,e)||!ri(n.queryParams,e.queryParams);case"paramsChange":default:return!vE(n,e)}}function rd(n,e,t){let r=Cc(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?rd(o,e.children.getContext(s),t):rd(o,null,t):rd(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Sc(e.outlet.component,i)):t.canDeactivateChecks.push(new Sc(null,i)):t.canDeactivateChecks.push(new Sc(null,i))}function gd(n){return typeof n=="function"}function GG(n){return typeof n=="boolean"}function WG(n){return n&&gd(n.canLoad)}function KG(n){return n&&gd(n.canActivate)}function QG(n){return n&&gd(n.canActivateChild)}function YG(n){return n&&gd(n.canDeactivate)}function JG(n){return n&&gd(n.canMatch)}function Dk(n){return n instanceof Fi||n?.name==="EmptyError"}var vm=Symbol("INITIAL_VALUE");function Rc(){return rr(n=>Ru(n.map(e=>e.pipe(Li(1),Fv(vm)))).pipe(Pe(e=>{for(let t of e)if(t!==!0){if(t===vm)return vm;if(t===!1||t instanceof ws)return t}return!0}),nr(e=>e!==vm),Li(1)))}function XG(n,e){return At(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?ue(st(q({},t),{guardsResult:!0})):ZG(o,r,i,n).pipe(At(a=>a&&GG(a)?eW(r,s,n,e):ue(a)),Pe(a=>st(q({},t),{guardsResult:a})))})}function ZG(n,e,t,r){return Et(n).pipe(At(i=>sW(i.component,i.route,t,e,r)),Wr(i=>i!==!0,!0))}function eW(n,e,t,r){return Et(e).pipe(wo(i=>tc(nW(i.route.parent,r),tW(i.route,r),iW(n,i.path,t),rW(n,i.route,t))),Wr(i=>i!==!0,!0))}function tW(n,e){return n!==null&&e&&e(new pE(n)),ue(!0)}function nW(n,e){return n!==null&&e&&e(new hE(n)),ue(!0)}function rW(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return ue(!0);let i=r.map(s=>ip(()=>{let o=md(e)??t,a=Nc(s,o),c=KG(a)?a.canActivate(e,n):Vi(o,()=>a(e,n));return bs(c).pipe(Wr())}));return ue(i).pipe(Rc())}function iW(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>HG(o)).filter(o=>o!==null).map(o=>ip(()=>{let a=o.guards.map(c=>{let l=md(o.node)??t,d=Nc(c,l),h=QG(d)?d.canActivateChild(r,n):Vi(l,()=>d(r,n));return bs(h).pipe(Wr())});return ue(a).pipe(Rc())}));return ue(s).pipe(Rc())}function sW(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return ue(!0);let o=s.map(a=>{let c=md(e)??i,l=Nc(a,c),d=YG(l)?l.canDeactivate(n,e,t,r):Vi(c,()=>l(n,e,t,r));return bs(d).pipe(Wr())});return ue(o).pipe(Rc())}function oW(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return ue(!0);let s=i.map(o=>{let a=Nc(o,n),c=WG(a)?a.canLoad(e,t):Vi(n,()=>a(e,t));return bs(c)});return ue(s).pipe(Rc(),Ak(r))}function Ak(n){return Av(Yt(e=>{if(Ac(e))throw Ck(n,e)}),Pe(e=>e===!0))}function aW(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return ue(!0);let s=i.map(o=>{let a=Nc(o,n),c=JG(a)?a.canMatch(e,t):Vi(n,()=>a(e,t));return bs(c)});return ue(s).pipe(Rc(),Ak(r))}var dd=class{constructor(e){this.segmentGroup=e||null}},Pm=class extends Error{constructor(e){super(),this.urlTree=e}};function bc(n){return Za(new dd(n))}function cW(n){return Za(new re(4e3,!1))}function lW(n){return Za(Tk(!1,Wn.GuardRejected))}var EE=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return ue(r);if(i.numberOfChildren>1||!i.children[_e])return cW(e.redirectTo);i=i.children[_e]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new Pm(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new ws(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Be(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new re(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},bE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function uW(n,e,t,r,i){let s=NE(n,e,t);return s.matched?(r=UG(e,r),aW(r,e,t,i).pipe(Pe(o=>o===!0?s:q({},bE)))):ue(s)}function NE(n,e,t){if(e.path==="**")return dW(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?q({},bE):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||aG)(t,n,e);if(!i)return q({},bE);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?q(q({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function dW(n){return{matched:!0,parameters:n.length>0?ak(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function rk(n,e,t,r){return t.length>0&&pW(n,t,r)?{segmentGroup:new Be(e,fW(r,new Be(t,n.children))),slicedSegments:[]}:t.length===0&&mW(n,t,r)?{segmentGroup:new Be(n.segments,hW(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Be(n.segments,n.children),slicedSegments:t}}function hW(n,e,t,r){let i={};for(let s of t)if(Fm(n,e,s)&&!r[si(s)]){let o=new Be([],{});i[si(s)]=o}return q(q({},r),i)}function fW(n,e){let t={};t[_e]=e;for(let r of n)if(r.path===""&&si(r)!==_e){let i=new Be([],{});t[si(r)]=i}return t}function pW(n,e,t){return t.some(r=>Fm(n,e,r)&&si(r)!==_e)}function mW(n,e,t){return t.some(r=>Fm(n,e,r))}function Fm(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function gW(n,e,t,r){return si(n)!==r&&(r===_e||!Fm(e,t,n))?!1:NE(e,n,t).matched}function _W(n,e,t){return e.length===0&&!n.children[t]}var CE=class{};function yW(n,e,t,r,i,s,o="emptyOnly"){return new TE(n,e,t,r,i,o,s).recognize()}var vW=31,TE=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new EE(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new re(4002,`'${e.segmentGroup}'`)}recognize(){let e=rk(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Pe(t=>{let r=new ld([],Object.freeze({}),Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,{},_e,this.rootComponentType,null,{}),i=new Gn(r,t),s=new Rm("",i),o=SG(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,_e).pipe(cs(r=>{if(r instanceof Pm)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof dd?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=DE(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Pe(s=>s instanceof Gn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return Et(i).pipe(wo(s=>{let o=r.children[s],a=BG(t,s);return this.processSegmentGroup(e,a,o,s)}),Ov((s,o)=>(s.push(...o),s)),ls(null),kv(),At(s=>{if(s===null)return bc(r);let o=xk(s);return wW(o),ue(o)}))}processSegment(e,t,r,i,s,o){return Et(t).pipe(wo(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(cs(c=>{if(c instanceof dd)return ue(null);throw c}))),Wr(a=>!!a),cs(a=>{if(Dk(a))return _W(r,i,s)?ue(new CE):bc(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return gW(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):bc(i):bc(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:d}=NE(t,i,s);if(!a)return bc(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>vW&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,h).pipe(At(p=>this.processSegment(e,r,t,p.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=uW(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(rr(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(rr(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:p}=a,_=new ld(d,p,Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,EW(r),si(r),r.component??r._loadedComponent??null,r,bW(r)),{segmentGroup:w,slicedSegments:A}=rk(t,d,h,c);if(A.length===0&&w.hasChildren())return this.processChildren(l,c,w).pipe(Pe(L=>L===null?null:new Gn(_,L)));if(c.length===0&&A.length===0)return ue(new Gn(_,[]));let R=si(r)===s;return this.processSegment(l,c,w,A,R?_e:s,!0).pipe(Pe(L=>new Gn(_,L instanceof Gn?[L]:[])))}))):bc(t)))}getChildConfig(e,t,r){return t.children?ue({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ue({routes:t._loadedRoutes,injector:t._loadedInjector}):oW(e,t,r,this.urlSerializer).pipe(At(i=>i?this.configLoader.loadChildren(e,t).pipe(Yt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):lW(t))):ue({routes:[],injector:e})}};function wW(n){n.sort((e,t)=>e.value.outlet===_e?-1:t.value.outlet===_e?1:e.value.outlet.localeCompare(t.value.outlet))}function IW(n){let e=n.value.routeConfig;return e&&e.path===""}function xk(n){let e=[],t=new Set;for(let r of n){if(!IW(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=xk(r.children);e.push(new Gn(r.value,i))}return e.filter(r=>!t.has(r))}function EW(n){return n.data||{}}function bW(n){return n.resolve||{}}function CW(n,e,t,r,i,s){return At(o=>yW(n,e,t,r,o.extractedUrl,i,s).pipe(Pe(({state:a,tree:c})=>st(q({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function TW(n,e){return At(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return ue(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of Rk(c))o.add(l);let a=0;return Et(o).pipe(wo(c=>s.has(c)?SW(c,r,n,e):(c.data=DE(c,c.parent,n).resolve,ue(void 0))),Yt(()=>a++),nc(1),At(c=>a===o.size?ue(t):Hn))})}function Rk(n){let e=n.children.map(t=>Rk(t)).flat();return[n,...e]}function SW(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!Ek(i)&&(s[hd]=i.title),DW(s,n,e,r).pipe(Pe(o=>(n._resolvedData=o,n.data=DE(n,n.parent,t).resolve,null)))}function DW(n,e,t,r){let i=nE(n);if(i.length===0)return ue({});let s={};return Et(i).pipe(At(o=>AW(n[o],e,t,r).pipe(Wr(),Yt(a=>{s[o]=a}))),nc(1),Mv(s),cs(o=>Dk(o)?Hn:Za(o)))}function AW(n,e,t,r){let i=md(e)??r,s=Nc(n,i),o=s.resolve?s.resolve(e,t):Vi(i,()=>s(e,t));return bs(o)}function eE(n){return rr(e=>{let t=n(e);return t?Et(t).pipe(Pe(()=>e)):ue(e)})}var Nk=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===_e);return i}getResolvedTitleForRoute(r){return r.data[hd]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>Y(xW),providedIn:"root"});let n=e;return n})(),xW=(()=>{let e=class e extends Nk{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(ae(YM))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),_d=new he("",{providedIn:"root",factory:()=>({})}),Mm=new he(""),PE=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Y(hm)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return ue(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=bs(r.loadComponent()).pipe(Pe(Pk),Yt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Nu(()=>{this.componentLoaders.delete(r)})),s=new Xa(i,()=>new sn).pipe(Ja());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ue({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=RW(i,this.compiler,r,this.onLoadEndListener).pipe(Nu(()=>{this.childrenLoaders.delete(i)})),a=new Xa(o,()=>new sn).pipe(Ja());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function RW(n,e,t,r){return bs(n.loadChildren()).pipe(Pe(Pk),At(i=>i instanceof $u||Array.isArray(i)?ue(i):Et(e.compileModuleAsync(i))),Pe(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(Mm,[],{optional:!0,self:!0}).flat()),{routes:o.map(RE),injector:s}}))}function NW(n){return n&&typeof n=="object"&&"default"in n}function Pk(n){return NW(n)?n.default:n}var ME=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>Y(PW),providedIn:"root"});let n=e;return n})(),PW=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Mk=new he(""),kk=new he("");function MW(n,e,t){let r=n.get(kk),i=n.get(Fn);return n.get(Je).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),kW(n))),{onViewTransitionCreated:c}=r;return c&&Vi(n,()=>c({transition:a,from:e,to:t})),o})}function kW(n){return new Promise(e=>{im(e,{injector:n})})}var kE=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new sn,this.transitionAbortSubject=new sn,this.configLoader=Y(PE),this.environmentInjector=Y(Mn),this.urlSerializer=Y(fd),this.rootContexts=Y(pd),this.location=Y(Ec),this.inputBindingEnabled=Y(Om,{optional:!0})!==null,this.titleStrategy=Y(Nk),this.options=Y(_d,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Y(ME),this.createViewTransition=Y(Mk,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ue(void 0),this.rootComponentType=null;let r=s=>this.events.next(new uE(s)),i=s=>this.events.next(new dE(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(st(q(q({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Ne({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:nd,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(nr(o=>o.id!==0),Pe(o=>st(q({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),rr(o=>{let a=!1,c=!1;return ue(o).pipe(rr(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Wn.SupersededByNewNavigation),Hn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?st(q({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&h!=="reload"){let p="";return this.events.next(new Es(l.id,this.urlSerializer.serialize(l.rawUrl),p,Tm.IgnoredSameUrlNavigation)),l.resolve(null),Hn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return ue(l).pipe(rr(p=>{let _=this.transitions?.getValue();return this.events.next(new xc(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),_!==this.transitions?.getValue()?Hn:Promise.resolve(p)}),CW(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Yt(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=st(q({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let _=new Sm(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(_)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:_,source:w,restoredState:A,extras:R}=l,L=new xc(p,this.urlSerializer.serialize(_),w,A);this.events.next(L);let Q=wk(this.rootComponentType).snapshot;return this.currentTransition=o=st(q({},l),{targetSnapshot:Q,urlAfterRedirects:_,extras:st(q({},R),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=_,ue(o)}else{let p="";return this.events.next(new Es(l.id,this.urlSerializer.serialize(l.extractedUrl),p,Tm.IgnoredByUrlHandlingStrategy)),l.resolve(null),Hn}}),Yt(l=>{let d=new oE(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Pe(l=>(this.currentTransition=o=st(q({},l),{guards:$G(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),XG(this.environmentInjector,l=>this.events.next(l)),Yt(l=>{if(o.guardsResult=l.guardsResult,Ac(l.guardsResult))throw Ck(this.urlSerializer,l.guardsResult);let d=new aE(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),nr(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Wn.GuardRejected),!1)),eE(l=>{if(l.guards.canActivateChecks.length)return ue(l).pipe(Yt(d=>{let h=new cE(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),rr(d=>{let h=!1;return ue(d).pipe(TW(this.paramsInheritanceStrategy,this.environmentInjector),Yt({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",Wn.NoDataFromResolver)}}))}),Yt(d=>{let h=new lE(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),eE(l=>{let d=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(Yt(_=>{h.component=_}),Pe(()=>{})));for(let _ of h.children)p.push(...d(_));return p};return Ru(d(l.targetSnapshot.root)).pipe(ls(null),Li(1))}),eE(()=>this.afterPreactivation()),rr(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return h?Et(h).pipe(Pe(()=>o)):ue(o)}),Pe(l=>{let d=kG(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=st(q({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),Yt(()=>{this.events.next(new ad)}),jG(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Li(1),Yt({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ii(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Lv(this.transitionAbortSubject.pipe(Yt(l=>{throw l}))),Nu(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Wn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),cs(l=>{if(c=!0,Sk(l))this.events.next(new Is(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),LG(l)?this.events.next(new cd(l.url)):o.resolve(!1);else{this.events.next(new od(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Hn}))}))}cancelNavigationTransition(r,i,s){let o=new Is(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function OW(n){return n!==nd}var FW=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>Y(LW),providedIn:"root"});let n=e;return n})(),SE=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},LW=(()=>{let e=class e extends SE{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ro(e)))(s||e)}})(),e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ok=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>Y(VW),providedIn:"root"});let n=e;return n})(),VW=(()=>{let e=class e extends Ok{constructor(){super(...arguments),this.location=Y(Ec),this.urlSerializer=Y(fd),this.options=Y(_d,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Y(ME),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ws,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=wk(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof xc)this.stateMemento=this.createStateMemento();else if(r instanceof Es)this.rawUrlTree=i.initialUrl;else if(r instanceof Sm){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof ad?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Is&&(r.code===Wn.GuardRejected||r.code===Wn.NoDataFromResolver)?this.restoreHistory(i):r instanceof od?this.restoreHistory(i,!0):r instanceof ii&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=q(q({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=q(q({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ro(e)))(s||e)}})(),e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),ed=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(ed||{});function Fk(n,e){n.events.pipe(nr(t=>t instanceof ii||t instanceof Is||t instanceof od||t instanceof Es),Pe(t=>t instanceof ii||t instanceof Es?ed.COMPLETE:(t instanceof Is?t.code===Wn.Redirect||t.code===Wn.SupersededByNewNavigation:!1)?ed.REDIRECTING:ed.FAILED),nr(t=>t!==ed.REDIRECTING),Li(1)).subscribe(()=>{e()})}function UW(n){throw n}var BW={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},jW={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Xe=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=Y(cm),this.stateManager=Y(Ok),this.options=Y(_d,{optional:!0})||{},this.pendingTasks=Y(om),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Y(kE),this.urlSerializer=Y(fd),this.location=Y(Ec),this.urlHandlingStrategy=Y(ME),this._events=new sn,this.errorHandler=this.options.errorHandler||UW,this.navigated=!1,this.routeReuseStrategy=Y(FW),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Y(Mm,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Y(Om,{optional:!0}),this.eventsSubscription=new Vt,this.isNgZoneEnabled=Y(Je)instanceof Je&&Je.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Is&&i.code!==Wn.Redirect&&i.code!==Wn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof ii)this.navigated=!0;else if(i instanceof cd){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||OW(s.source)};this.scheduleNavigation(a,nd,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}HW(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),nd,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=q({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(RE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=q(q({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let _=s?s.snapshot:this.routerState.snapshot.root;p=gk(_)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),p=this.currentUrlTree.root}return _k(p,r,h,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Ac(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,nd,null,i)}navigate(r,i={skipLocationChange:!1}){return $W(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=q({},BW):i===!1?s=q({},jW):s=i,Ac(r))return XM(this.currentUrlTree,r,s);let o=this.parseUrl(r);return XM(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,d;a?(c=a.resolve,l=a.reject,d=a.promise):d=new Promise((p,_)=>{c=p,l=_});let h=this.pendingTasks.add();return Fk(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function $W(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new re(4008,!1)}function HW(n){return!(n instanceof ad)&&!(n instanceof cd)}var Pc=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new sn,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof ii&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:LP(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(ee(Xe),ee(Mr),tI("tabindex"),ee(ys),ee(ji),ee(Pr))},e.\u0275dir=qn({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&z("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&am("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[sr.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Ic],skipLocationChange:[sr.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Ic],replaceUrl:[sr.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Ic],routerLink:"routerLink"},standalone:!0,features:[yI,_c]});let n=e;return n})();var km=class{};var qW=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(nr(r=>r instanceof ii),wo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=sm(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return Et(s).pipe(ec())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=ue(null);let o=s.pipe(At(a=>a===null?ue(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return Et([o,a]).pipe(ec())}else return o})}};e.\u0275fac=function(i){return new(i||e)(ae(Xe),ae(hm),ae(Mn),ae(km),ae(PE))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Lk=new he(""),zW=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=Y(Mn),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof xc?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof ii?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Es&&r.code===Tm.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Dm&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>g(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),im(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Dm(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){QP()},e.\u0275prov=oe({token:e,factory:e.\u0275fac});let n=e;return n})();function GW(n){return n.routerState.root}function yd(n,e){return{\u0275kind:n,\u0275providers:e}}function WW(){let n=Y(Nr);return e=>{let t=n.get(wc);if(e!==t.components[0])return;let r=n.get(Xe),i=n.get(Vk);n.get(OE)===1&&r.initialNavigation(),n.get(Uk,null,Ie.Optional)?.setUpPreloading(),n.get(Lk,null,Ie.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Vk=new he("",{factory:()=>new sn}),OE=new he("",{providedIn:"root",factory:()=>1});function KW(){return yd(2,[{provide:OE,useValue:0},{provide:dm,multi:!0,deps:[Nr],useFactory:e=>{let t=e.get(FM,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(Xe),s=e.get(Vk);Fk(i,()=>{r(!0)}),e.get(kE).afterPreactivation=()=>(r(!0),s.closed?ue(void 0):s),i.initialNavigation()}))}}])}function QW(){return yd(3,[{provide:dm,multi:!0,useFactory:()=>{let e=Y(Xe);return()=>{e.setUpLocationChangeListener()}}},{provide:OE,useValue:2}])}var Uk=new he("");function YW(n){return yd(0,[{provide:Uk,useExisting:qW},{provide:km,useExisting:n}])}function JW(){return yd(8,[nk,{provide:Om,useExisting:nk}])}function XW(n){let e=[{provide:Mk,useValue:MW},{provide:kk,useValue:q({skipNextTransition:!!n?.skipInitialTransition},n)}];return yd(9,e)}var ik=new he("ROUTER_FORROOT_GUARD"),ZW=[Ec,{provide:fd,useClass:id},Xe,pd,{provide:Mr,useFactory:GW,deps:[Xe]},PE,[]],FE=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[ZW,[],{provide:Mm,multi:!0,useValue:r},{provide:ik,useFactory:r5,deps:[[Xe,new jp,new Fw]]},{provide:_d,useValue:i||{}},i?.useHash?t5():n5(),e5(),i?.preloadingStrategy?YW(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?i5(i):[],i?.bindToComponentInputs?JW().\u0275providers:[],i?.enableViewTransitions?XW().\u0275providers:[],s5()]}}static forChild(r){return{ngModule:e,providers:[{provide:Mm,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(ae(ik,8))},e.\u0275mod=On({type:e}),e.\u0275inj=kn({});let n=e;return n})();function e5(){return{provide:Lk,useFactory:()=>{let n=Y(BM),e=Y(Je),t=Y(_d),r=Y(kE),i=Y(fd);return t.scrollOffset&&n.setOffset(t.scrollOffset),new zW(i,r,n,e,t)}}}function t5(){return{provide:Pr,useClass:mm}}function n5(){return{provide:Pr,useClass:BI}}function r5(n){return"guarded"}function i5(n){return[n.initialNavigation==="disabled"?QW().\u0275providers:[],n.initialNavigation==="enabledBlocking"?KW().\u0275providers:[]]}var sk=new he("");function s5(){return[{provide:sk,useFactory:WW},{provide:SI,multi:!0,useExisting:sk}]}var VE={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var j=function(n,e){if(!n)throw Uo(e)},Uo=function(n){return new Error("Firebase Database ("+VE.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var jk=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},o5=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Vm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4,p=(a&15)<<2|l>>6,_=l&63;c||(_=64,o||(p=64)),r.push(t[d],t[h],t[p],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(jk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):o5(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new UE;let p=s<<2|a>>4;if(r.push(p),l!==64){let _=a<<4&240|l>>2;if(r.push(_),h!==64){let w=l<<6&192|h;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},UE=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},jE=function(n){let e=jk(n);return Vm.encodeByteArray(e,!0)},vd=function(n){return jE(n).replace(/\./g,"")},wd=function(n){try{return Vm.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function $k(n){return kc(void 0,n)}function kc(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!a5(t)||(n[t]=kc(n[t],e[t]));return n}function a5(n){return n!=="__proto__"}function c5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var l5=()=>c5().__FIREBASE_DEFAULTS__,u5=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},d5=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&wd(n[1]);return e&&JSON.parse(e)},$E=()=>{try{return l5()||u5()||d5()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var HE=()=>{var n;return(n=$E())===null||n===void 0?void 0:n.config},Hk=n=>{var e;return(e=$E())===null||e===void 0?void 0:e[`_${n}`]};var Ut=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Oc(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[vd(JSON.stringify(t)),vd(JSON.stringify(o)),""].join(".")}function Ke(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Id(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ke())}function Um(){var n;let e=(n=$E())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Bm(){return typeof self=="object"&&self.self===self}function jm(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Bo(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $m(){let n=Ke();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ai(){return VE.NODE_CLIENT===!0||VE.NODE_ADMIN===!0}function qE(){return!Um()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Cs(){try{return typeof indexedDB=="object"}catch{return!1}}function qk(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var h5="FirebaseError",_t=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=h5,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fr.prototype.create)}},fr=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?f5(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new _t(i,a,r)}};function f5(n,e){return n.replace(p5,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var p5=/\{\$([^}]+)}/g;function Mc(n){return JSON.parse(n)}function xt(n){return JSON.stringify(n)}var zk=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=Mc(wd(s[0])||""),t=Mc(wd(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var Gk=function(n){let e=zk(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Wk=function(n){let e=zk(n).claims;return typeof e=="object"&&e.admin===!0};function vn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ts(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Fc(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ed(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Ss(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(Bk(s)&&Bk(o)){if(!Ss(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Bk(n){return n!==null&&typeof n=="object"}function Hi(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ds(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Lc(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var Lm=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){let p=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(p<<1|p>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,d;for(let h=0;h<80;h++){h<40?h<20?(l=a^s&(o^a),d=1518500249):(l=s^o^a,d=1859775393):h<60?(l=s&o|a&(s|o),d=2400959708):(l=s^o^a,d=3395469782);let p=(i<<5|i>>>27)+l+c+d+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=p}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function Hm(n,e){let t=new BE(n,e);return t.subscribe.bind(t)}var BE=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");m5(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=LE),i.error===void 0&&(i.error=LE),i.complete===void 0&&(i.complete=LE);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function m5(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function LE(){}var ce=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){let s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function ln(n,e){return`${n} failed: ${e} argument `}function Bt(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(ln(n,e)+"must be a valid function.")}function zE(n,e,t,r){if(!(r&&!t)&&(typeof t!="object"||t===null))throw new Error(ln(n,e)+"must be a valid context object.")}var Kk=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,j(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},bd=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var gae=4*60*60*1e3;function G(n){return n&&n._delegate?n._delegate:n}var qe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var jo="[DEFAULT]";var $o=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Ut;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_5(e))try{this.getOrInitializeService({instanceIdentifier:jo})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=jo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=jo){return this.instances.has(e)}getOptions(e=jo){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:g5(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=jo){return this.component?this.component.multipleInstances?e:jo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function g5(n){return n===jo?void 0:n}function _5(n){return n.instantiationMode==="EAGER"}var As=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new $o(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var a0={};r$(a0,{FirebaseError:()=>_t,SDK_VERSION:()=>In,_DEFAULT_ENTRY_NAME:()=>li,_addComponent:()=>Bc,_addOrOverwriteComponent:()=>i0,_apps:()=>xs,_clearComponents:()=>i9,_components:()=>Uc,_getProvider:()=>jc,_isFirebaseApp:()=>lO,_isFirebaseServerApp:()=>ht,_registerComponent:()=>wn,_removeServiceInstance:()=>cO,_serverApps:()=>Vc,deleteApp:()=>Km,getApp:()=>Td,getApps:()=>a9,initializeApp:()=>Wm,initializeServerApp:()=>o9,onLog:()=>s0,registerVersion:()=>bt,setLogLevel:()=>o0});var GE=[],ye=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(ye||{}),Qk={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},y5=ye.INFO,v5={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},w5=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=v5[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Ln=class{constructor(e){this.name=e,this._logLevel=y5,this._logHandler=w5,this._userLogHandler=null,GE.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Qk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}};function Yk(n){GE.forEach(e=>{e.setLogLevel(n)})}function Jk(n,e){for(let t of GE){let r=null;e&&e.level&&(r=Qk[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:ye[s].toLowerCase(),message:a,args:o,type:i.name})}}}var I5=(n,e)=>e.some(t=>n instanceof t),Xk,Zk;function E5(){return Xk||(Xk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function b5(){return Zk||(Zk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var eO=new WeakMap,KE=new WeakMap,tO=new WeakMap,WE=new WeakMap,YE=new WeakMap;function C5(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(ci(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&eO.set(t,n)}).catch(()=>{}),YE.set(e,n),e}function T5(n){if(KE.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});KE.set(n,e)}var QE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return KE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||tO.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ci(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function nO(n){QE=n(QE)}function S5(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(qm(this),e,...t);return tO.set(r,e.sort?e.sort():[e]),ci(r)}:b5().includes(n)?function(...e){return n.apply(qm(this),e),ci(eO.get(this))}:function(...e){return ci(n.apply(qm(this),e))}}function D5(n){return typeof n=="function"?S5(n):(n instanceof IDBTransaction&&T5(n),I5(n,E5())?new Proxy(n,QE):n)}function ci(n){if(n instanceof IDBRequest)return C5(n);if(WE.has(n))return WE.get(n);let e=D5(n);return e!==n&&(WE.set(n,e),YE.set(e,n)),e}var qm=n=>YE.get(n);function iO(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=ci(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ci(o.result),c.oldVersion,c.newVersion,ci(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var A5=["get","getKey","getAll","getAllKeys","count"],x5=["put","add","delete","clear"],JE=new Map;function rO(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(JE.get(e))return JE.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=x5.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||A5.includes(t)))return;let s=function(o,...a){return g(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return JE.set(e,s),s}nO(n=>st(q({},n),{get:(e,t,r)=>rO(e,t)||n.get(e,t,r),has:(e,t)=>!!rO(e,t)||n.has(e,t)}));var ZE=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(R5(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function R5(n){let e=n.getComponent();return e?.type==="VERSION"}var zm="@firebase/app",e0="0.10.5";var Ho=new Ln("@firebase/app"),N5="@firebase/app-compat",P5="@firebase/analytics-compat",M5="@firebase/analytics",k5="@firebase/app-check-compat",O5="@firebase/app-check",F5="@firebase/auth",L5="@firebase/auth-compat",V5="@firebase/database",U5="@firebase/database-compat",B5="@firebase/functions",j5="@firebase/functions-compat",$5="@firebase/installations",H5="@firebase/installations-compat",q5="@firebase/messaging",z5="@firebase/messaging-compat",G5="@firebase/performance",W5="@firebase/performance-compat",K5="@firebase/remote-config",Q5="@firebase/remote-config-compat",Y5="@firebase/storage",J5="@firebase/storage-compat",X5="@firebase/firestore",Z5="@firebase/vertexai-preview",e9="@firebase/firestore-compat",t9="firebase",n9="10.12.2";var li="[DEFAULT]",r9={[zm]:"fire-core",[N5]:"fire-core-compat",[M5]:"fire-analytics",[P5]:"fire-analytics-compat",[O5]:"fire-app-check",[k5]:"fire-app-check-compat",[F5]:"fire-auth",[L5]:"fire-auth-compat",[V5]:"fire-rtdb",[U5]:"fire-rtdb-compat",[B5]:"fire-fn",[j5]:"fire-fn-compat",[$5]:"fire-iid",[H5]:"fire-iid-compat",[q5]:"fire-fcm",[z5]:"fire-fcm-compat",[G5]:"fire-perf",[W5]:"fire-perf-compat",[K5]:"fire-rc",[Q5]:"fire-rc-compat",[Y5]:"fire-gcs",[J5]:"fire-gcs-compat",[X5]:"fire-fst",[e9]:"fire-fst-compat",[Z5]:"fire-vertex","fire-js":"fire-js",[t9]:"fire-js-all"};var xs=new Map,Vc=new Map,Uc=new Map;function Bc(n,e){try{n.container.addComponent(e)}catch(t){Ho.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function i0(n,e){n.container.addOrOverwriteComponent(e)}function wn(n){let e=n.name;if(Uc.has(e))return Ho.debug(`There were multiple attempts to register component ${e}.`),!1;Uc.set(e,n);for(let t of xs.values())Bc(t,n);for(let t of Vc.values())Bc(t,n);return!0}function jc(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function cO(n,e,t=li){jc(n,e).clearInstance(t)}function lO(n){return n.options!==void 0}function ht(n){return n.settings!==void 0}function i9(){Uc.clear()}var s9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pr=new fr("app","Firebase",s9);var Gm=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new qe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pr.create("app-deleted",{appName:this._name})}};var t0=class extends Gm{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,bt(zm,e0,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Km(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw pr.create("server-app-deleted")}};var In=n9;function Wm(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:li,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw pr.create("bad-app-name",{appName:String(i)});if(t||(t=HE()),!t)throw pr.create("no-options");let s=xs.get(i);if(s){if(Ss(t,s.options)&&Ss(r,s.config))return s;throw pr.create("duplicate-app",{appName:i})}let o=new As(i);for(let c of Uc.values())o.addComponent(c);let a=new Gm(t,r,o);return xs.set(i,a),a}function o9(n,e){if(Bm())throw pr.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;lO(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=l=>[...l].reduce((d,h)=>Math.imul(31,d)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw pr.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=Vc.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new As(s);for(let l of Uc.values())a.addComponent(l);let c=new t0(t,e,s,a);return Vc.set(s,c),c}function Td(n=li){let e=xs.get(n);if(!e&&n===li&&HE())return Wm();if(!e)throw pr.create("no-app",{appName:n});return e}function a9(){return Array.from(xs.values())}function Km(n){return g(this,null,function*(){let e=!1,t=n.name;xs.has(t)?(e=!0,xs.delete(t)):Vc.has(t)&&n.decRefCount()<=0&&(Vc.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function bt(n,e,t){var r;let i=(r=r9[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ho.warn(a.join(" "));return}wn(new qe(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function s0(n,e){if(n!==null&&typeof n!="function")throw pr.create("invalid-log-argument");Jk(n,e)}function o0(n){Yk(n)}var c9="firebase-heartbeat-database",l9=1,Cd="firebase-heartbeat-store",XE=null;function uO(){return XE||(XE=iO(c9,l9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Cd)}catch(t){console.warn(t)}}}}).catch(n=>{throw pr.create("idb-open",{originalErrorMessage:n.message})})),XE}function u9(n){return g(this,null,function*(){try{let t=(yield uO()).transaction(Cd),r=yield t.objectStore(Cd).get(dO(n));return yield t.done,r}catch(e){if(e instanceof _t)Ho.warn(e.message);else{let t=pr.create("idb-get",{originalErrorMessage:e?.message});Ho.warn(t.message)}}})}function sO(n,e){return g(this,null,function*(){try{let r=(yield uO()).transaction(Cd,"readwrite");yield r.objectStore(Cd).put(e,dO(n)),yield r.done}catch(t){if(t instanceof _t)Ho.warn(t.message);else{let r=pr.create("idb-set",{originalErrorMessage:t?.message});Ho.warn(r.message)}}})}function dO(n){return`${n.name}!${n.options.appId}`}var d9=1024,h9=30*24*60*60*1e3,n0=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new r0(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return g(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=oO();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=h9}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return g(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=oO(),{heartbeatsToSend:r,unsentEntries:i}=f9(this._heartbeatsCache.heartbeats),s=vd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function oO(){return new Date().toISOString().substring(0,10)}function f9(n,e=d9){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),aO(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),aO(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var r0=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return Cs()?qk().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield u9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return sO(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return sO(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function aO(n){return vd(JSON.stringify({version:2,heartbeats:n})).length}function p9(n){wn(new qe("platform-logger",e=>new ZE(e),"PRIVATE")),wn(new qe("heartbeat",e=>new n0(e),"PRIVATE")),bt(zm,e0,n),bt(zm,e0,"esm2017"),bt("fire-js","")}p9("");var c0=class{constructor(e,t){this._delegate=e,this.firebase=t,Bc(e,new qe("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Km(this._delegate)))}_getService(e,t=li){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=li){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Bc(this._delegate,e)}_addOrOverwriteComponent(e){i0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var m9={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},hO=new fr("app-compat","Firebase",m9);function g9(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:bt,setLogLevel:o0,onLog:s0,apps:null,SDK_VERSION:In,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:a0}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||li,!vn(e,l))throw hO.create("no-app",{appName:l});return e[l]}i.App=n;function s(l,d={}){let h=Wm(l,d);if(vn(e,h.name))return e[h.name];let p=new n(h,t);return e[h.name]=p,p}function o(){return Object.keys(e).map(l=>e[l])}function a(l){let d=l.name,h=d.replace("-compat","");if(wn(l)&&l.type==="PUBLIC"){let p=(_=i())=>{if(typeof _[h]!="function")throw hO.create("invalid-app-argument",{appName:d});return _[h]()};l.serviceProps!==void 0&&kc(p,l.serviceProps),t[h]=p,n.prototype[h]=function(..._){return this._getService.bind(this,d).apply(this,l.multipleInstances?_:[])}}return l.type==="PUBLIC"?t[h]:null}function c(l,d){return d==="serverAuth"?null:d}return t}function pO(){let n=g9(c0);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:pO,extendNamespace:e,createSubscribe:Hm,ErrorFactory:fr,deepExtend:kc});function e(t){kc(n,t)}return n}var _9=pO();var fO=new Ln("@firebase/app-compat"),y9="@firebase/app-compat",v9="0.2.35";function w9(n){bt(y9,v9,n)}if(Bm()&&self.firebase!==void 0){fO.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);let n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&fO.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var $=_9;w9();var Qo={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var ks={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function I9(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function RO(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var U0=I9,NO=RO,PO=new fr("auth","Firebase",RO());var Xm=new Ln("@firebase/auth");function E9(n,...e){Xm.logLevel<=ye.WARN&&Xm.warn(`Auth (${In}): ${n}`,...e)}function Ym(n,...e){Xm.logLevel<=ye.ERROR&&Xm.error(`Auth (${In}): ${n}`,...e)}function Pt(n,...e){throw j0(n,...e)}function Nt(n,...e){return j0(n,...e)}function B0(n,e,t){let r=Object.assign(Object.assign({},NO()),{[e]:t});return new fr("auth","Firebase",r).create(e,{appName:n.name})}function qt(n){return B0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qc(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Pt(n,"argument-error"),B0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function j0(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return PO.create(n,...e)}function U(n,e,...t){if(!n)throw j0(e,...t)}function ui(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ym(e),new Error(e)}function mr(n,e){n||ui(e)}function Rd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function $0(){return mO()==="http:"||mO()==="https:"}function mO(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function b9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&($0()||jm()||"connection"in navigator)?navigator.onLine:!0}function C9(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var qo=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,mr(t>e,"Short delay should be less than long delay!"),this.isMobile=Id()||Bo()}get(){return b9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function H0(n,e){mr(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Nd=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ui("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ui("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ui("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var T9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var S9=new qo(3e4,6e4);function yt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function vt(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){return MO(n,i,()=>g(this,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let h=Hi(Object.assign({key:n.config.apiKey},d)).slice(1),p=yield n._getAdditionalHeaders();return p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode),Nd.fetch()(kO(n,n.config.apiHost,t,h),Object.assign({method:e,headers:p,referrerPolicy:"no-referrer"},l))}))})}function MO(n,e,t){return g(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},T9),e);try{let i=new f0(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Sd(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Sd(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Sd(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Sd(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw B0(n,d,l);Pt(n,d)}}catch(i){if(i instanceof _t)throw i;Pt(n,"network-request-failed",{message:String(i)})}})}function Gi(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){let l=yield vt(n,e,t,r,i);return"mfaPendingCredential"in l&&Pt(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function kO(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?H0(n.config,i):`${n.config.apiScheme}://${i}`}function D9(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var f0=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Nt(this.auth,"network-request-failed")),S9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Sd(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Nt(n,e,r);return i.customData._tokenResponse=t,i}function gO(n){return n!==void 0&&n.getResponse!==void 0}function _O(n){return n!==void 0&&n.enterprise!==void 0}var p0=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return D9(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function A9(n){return g(this,null,function*(){return(yield vt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})}function x9(n,e){return g(this,null,function*(){return vt(n,"GET","/v2/recaptchaConfig",yt(n,e))})}function R9(n,e){return g(this,null,function*(){return vt(n,"POST","/v1/accounts:delete",e)})}function N9(n,e){return g(this,null,function*(){return vt(n,"POST","/v1/accounts:update",e)})}function OO(n,e){return g(this,null,function*(){return vt(n,"POST","/v1/accounts:lookup",e)})}function Dd(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function FO(n,e=!1){return g(this,null,function*(){let t=G(n),r=yield t.getIdToken(e),i=lg(r);U(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Dd(l0(i.auth_time)),issuedAtTime:Dd(l0(i.iat)),expirationTime:Dd(l0(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function l0(n){return Number(n)*1e3}function lg(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ym("JWT malformed, contained fewer than 3 sections"),null;try{let i=wd(t);return i?JSON.parse(i):(Ym("Failed to decode base64 JWT payload"),null)}catch(i){return Ym("Caught error parsing JWT payload as JSON",i?.toString()),null}}function yO(n){let e=lg(n);return U(e,"internal-error"),U(typeof e.exp<"u","internal-error"),U(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function zi(n,e,t=!1){return g(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof _t&&P9(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function P9({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var m0=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Pd=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Dd(this.lastLoginAt),this.creationTime=Dd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Md(n){return g(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield zi(n,OO(t,{idToken:r}));U(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?VO(s.providerUserInfo):[],a=M9(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,d=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Pd(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,h)})}function LO(n){return g(this,null,function*(){let e=G(n);yield Md(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function M9(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function VO(n){return n.map(e=>{var{providerId:t}=e,r=zf(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function k9(n,e){return g(this,null,function*(){let t=yield MO(n,{},()=>g(this,null,function*(){let r=Hi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=kO(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Nd.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function O9(n,e){return g(this,null,function*(){return vt(n,"POST","/v2/accounts:revokeToken",yt(n,e))})}var Ad=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){U(e.idToken,"internal-error"),U(typeof e.idToken<"u","internal-error"),U(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):yO(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){U(e.length!==0,"internal-error");let t=yO(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return g(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(U(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield k9(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(U(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(U(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(U(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return ui("not implemented")}};function Rs(n,e){U(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var zo=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=zf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new m0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Pd(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let t=yield zi(this,this.stsTokenManager.getToken(this.auth,e));return U(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return FO(this,e)}reload(){return LO(this)}_assign(e){this!==e&&(U(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Md(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(ht(this.auth.app))return Promise.reject(qt(this.auth));let e=yield this.getIdToken();return yield zi(this,R9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,d;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,w=(o=t.photoURL)!==null&&o!==void 0?o:void 0,A=(a=t.tenantId)!==null&&a!==void 0?a:void 0,R=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,L=(l=t.createdAt)!==null&&l!==void 0?l:void 0,Q=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:B,emailVerified:X,isAnonymous:le,providerData:te,stsTokenManager:T}=t;U(B&&T,e,"internal-error");let v=Ad.fromJSON(this.name,T);U(typeof B=="string",e,"internal-error"),Rs(h,e.name),Rs(p,e.name),U(typeof X=="boolean",e,"internal-error"),U(typeof le=="boolean",e,"internal-error"),Rs(_,e.name),Rs(w,e.name),Rs(A,e.name),Rs(R,e.name),Rs(L,e.name),Rs(Q,e.name);let E=new n({uid:B,auth:e,email:p,emailVerified:X,displayName:h,isAnonymous:le,photoURL:w,phoneNumber:_,tenantId:A,stsTokenManager:v,createdAt:L,lastLoginAt:Q});return te&&Array.isArray(te)&&(E.providerData=te.map(D=>Object.assign({},D))),R&&(E._redirectEventId=R),E}static _fromIdTokenResponse(e,t,r=!1){return g(this,null,function*(){let i=new Ad;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Md(s),s})}static _fromGetAccountInfoResponse(e,t,r){return g(this,null,function*(){let i=t.users[0];U(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?VO(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new Ad;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Pd(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var vO=new Map;function un(n){mr(n instanceof Function,"Expected a class definition");let e=vO.get(n);return e?(mr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,vO.set(n,e),e)}var F9=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(t,r){return g(this,null,function*(){this.storage[t]=r})}_get(t){return g(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return g(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Ps=F9;function di(n,e,t){return`firebase:${n}:${e}:${t}`}var Zm=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=di(this.userKey,i.apiKey,s),this.fullPersistenceKey=di("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?zo._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return g(this,null,function*(){if(!t.length)return new n(un(Ps),e,r);let i=(yield Promise.all(t.map(l=>g(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||un(Ps),o=di(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let d=yield l._get(o);if(d){let h=zo._fromJSON(e,d);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>g(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,r))})}};function wO(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(jO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(UO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($O(e))return"Blackberry";if(HO(e))return"Webos";if(q0(e))return"Safari";if((e.includes("chrome/")||BO(e))&&!e.includes("edge/"))return"Chrome";if(zc(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function UO(n=Ke()){return/firefox\//i.test(n)}function q0(n=Ke()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function BO(n=Ke()){return/crios\//i.test(n)}function jO(n=Ke()){return/iemobile/i.test(n)}function zc(n=Ke()){return/android/i.test(n)}function $O(n=Ke()){return/blackberry/i.test(n)}function HO(n=Ke()){return/webos/i.test(n)}function Yo(n=Ke()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function qO(n=Ke()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function L9(n=Ke()){var e;return Yo(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function V9(){return $m()&&document.documentMode===10}function zO(n=Ke()){return Yo(n)||zc(n)||HO(n)||$O(n)||/windows phone/i.test(n)||jO(n)}function U9(){try{return!!(window&&window!==window.top)}catch{return!1}}function z0(n,e=[]){let t;switch(n){case"Browser":t=wO(Ke());break;case"Worker":t=`${wO(Ke())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${In}/${r}`}var g0=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function B9(t){return g(this,arguments,function*(n,e={}){return vt(n,"GET","/v2/passwordPolicy",yt(n,e))})}var j9=6,_0=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:j9,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var eg=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tg(this),this.idTokenSubscription=new tg(this),this.beforeStateQueue=new g0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PO,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=un(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Zm.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let t=yield OO(this,{idToken:e}),r=yield zo._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var t;if(ht(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return U(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield Md(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=C9()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(ht(this.app))return Promise.reject(qt(this));let t=e?G(e):null;return t&&U(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&U(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return ht(this.app)?Promise.reject(qt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return ht(this.app)?Promise.reject(qt(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(un(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield B9(this),t=new _0(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new fr("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield O9(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&un(e)||this._popupRedirectResolver;U(t,this,"argument-error"),this.redirectPersistenceManager=yield Zm.create(this,[un(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(U(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=z0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return g(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&E9(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function nt(n){return G(n)}var tg=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Hm(t=>this.observer=t)}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Hd={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $9(n){Hd=n}function G0(n){return Hd.loadJS(n)}function H9(){return Hd.recaptchaV2Script}function q9(){return Hd.recaptchaEnterpriseScript}function z9(){return Hd.gapiScript}function GO(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var G9="recaptcha-enterprise",W9="NO_RECAPTCHA",y0=class{constructor(e){this.type=G9,this.auth=nt(e)}verify(e="verify",t=!1){return g(this,null,function*(){function r(s){return g(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>g(this,null,function*(){x9(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let l=new p0(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;_O(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(W9)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&_O(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=q9();c.length!==0&&(c+=a),G0(c).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})})}};function IO(n,e,t,r=!1){return g(this,null,function*(){let i=new y0(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function kd(n,e,t,r){return g(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield IO(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>g(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield IO(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function K9(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(un);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function W0(n,e,t){let r=nt(n);U(r._canInitEmulator,r,"emulator-config-failed"),U(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=WO(e),{host:o,port:a}=Q9(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||Y9()}function WO(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Q9(n){let e=WO(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:EO(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:EO(o)}}}function EO(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function Y9(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var hi=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ui("not implemented")}_getIdTokenResponse(e){return ui("not implemented")}_linkToIdToken(e,t){return ui("not implemented")}_getReauthenticationResolver(e){return ui("not implemented")}};function KO(n,e){return g(this,null,function*(){return vt(n,"POST","/v1/accounts:resetPassword",yt(n,e))})}function J9(n,e){return g(this,null,function*(){return vt(n,"POST","/v1/accounts:update",e)})}function X9(n,e){return g(this,null,function*(){return vt(n,"POST","/v1/accounts:signUp",e)})}function Z9(n,e){return g(this,null,function*(){return vt(n,"POST","/v1/accounts:update",yt(n,e))})}function e6(n,e){return g(this,null,function*(){return Gi(n,"POST","/v1/accounts:signInWithPassword",yt(n,e))})}function ug(n,e){return g(this,null,function*(){return vt(n,"POST","/v1/accounts:sendOobCode",yt(n,e))})}function t6(n,e){return g(this,null,function*(){return ug(n,e)})}function n6(n,e){return g(this,null,function*(){return ug(n,e)})}function r6(n,e){return g(this,null,function*(){return ug(n,e)})}function i6(n,e){return g(this,null,function*(){return ug(n,e)})}function s6(n,e){return g(this,null,function*(){return Gi(n,"POST","/v1/accounts:signInWithEmailLink",yt(n,e))})}function o6(n,e){return g(this,null,function*(){return Gi(n,"POST","/v1/accounts:signInWithEmailLink",yt(n,e))})}var Od=class n extends hi{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return g(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return kd(e,t,"signInWithPassword",e6);case"emailLink":return s6(e,{email:this._email,oobCode:this._password});default:Pt(e,"internal-error")}})}_linkToIdToken(e,t){return g(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return kd(e,r,"signUpPassword",X9);case"emailLink":return o6(e,{idToken:t,email:this._email,oobCode:this._password});default:Pt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function qi(n,e){return g(this,null,function*(){return Gi(n,"POST","/v1/accounts:signInWithIdp",yt(n,e))})}var a6="http://localhost",kr=class n extends hi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Pt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=zf(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return qi(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,qi(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,qi(e,t)}buildRequest(){let e={requestUri:a6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Hi(t)}return e}};function c6(n,e){return g(this,null,function*(){return vt(n,"POST","/v1/accounts:sendVerificationCode",yt(n,e))})}function l6(n,e){return g(this,null,function*(){return Gi(n,"POST","/v1/accounts:signInWithPhoneNumber",yt(n,e))})}function u6(n,e){return g(this,null,function*(){let t=yield Gi(n,"POST","/v1/accounts:signInWithPhoneNumber",yt(n,e));if(t.temporaryProof)throw Sd(n,"account-exists-with-different-credential",t);return t})}var d6={USER_NOT_FOUND:"user-not-found"};function h6(n,e){return g(this,null,function*(){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Gi(n,"POST","/v1/accounts:signInWithPhoneNumber",yt(n,t),d6)})}var $c=class n extends hi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return l6(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return u6(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return h6(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function f6(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function p6(n){let e=Ds(Lc(n)).link,t=e?Ds(Lc(e)).deep_link_id:null,r=Ds(Lc(n)).deep_link_id;return(r?Ds(Lc(r)).link:null)||r||t||e||n}var Fd=class n{constructor(e){var t,r,i,s,o,a;let c=Ds(Lc(e)),l=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=f6((i=c.mode)!==null&&i!==void 0?i:null);U(l&&d&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=p6(e);try{return new n(t)}catch{return null}}};var qd=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Od._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Fd.parseLink(r);return U(i,"argument-error"),Od._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Or=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Ms=class extends Or{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},Hc=class n extends Ms{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return U("providerId"in t&&"signInMethod"in t,"argument-error"),kr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return U(e.idToken||e.accessToken,"argument-error"),kr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var dg=(()=>{class n extends Ms{constructor(){super("facebook.com")}static credential(t){return kr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.FACEBOOK_SIGN_IN_METHOD="facebook.com",n.PROVIDER_ID="facebook.com";return n})(),hg=(()=>{class n extends Ms{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return kr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})(),fg=(()=>{class n extends Ms{constructor(){super("github.com")}static credential(t){return kr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.GITHUB_SIGN_IN_METHOD="github.com",n.PROVIDER_ID="github.com";return n})(),m6="http://localhost",Go=class n extends hi{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return qi(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,qi(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,qi(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:m6,returnSecureToken:!0,pendingToken:this.pendingToken}}};var g6="saml.",Ld=class n extends Or{constructor(e){U(e.startsWith(g6),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=Go.fromJSON(e);return U(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Go._create(r,t)}catch{return null}}};var pg=(()=>{class n extends Ms{constructor(){super("twitter.com")}static credential(t,r){return kr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return n.credential(r,i)}catch{return null}}}n.TWITTER_SIGN_IN_METHOD="twitter.com",n.PROVIDER_ID="twitter.com";return n})();function QO(n,e){return g(this,null,function*(){return Gi(n,"POST","/v1/accounts:signUp",yt(n,e))})}var Fr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return g(this,null,function*(){let s=yield zo._fromIdTokenResponse(e,r,i),o=bO(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return g(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=bO(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function bO(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function K0(n){return g(this,null,function*(){var e;if(ht(n.app))return Promise.reject(qt(n));let t=nt(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Fr({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield QO(t,{returnSecureToken:!0}),i=yield Fr._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var v0=class n extends _t{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function YO(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?v0._fromErrorAndOperation(n,s,e,r):s})}function JO(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}function Q0(n,e){return g(this,null,function*(){let t=G(n);yield mg(!0,t,e);let{providerUserInfo:r}=yield N9(t.auth,{idToken:yield t.getIdToken(),deleteProvider:[e]}),i=JO(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),yield t.auth._persistUserIfCurrent(t),t})}function Y0(n,e,t=!1){return g(this,null,function*(){let r=yield zi(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Fr._forOperation(n,"link",r)})}function mg(n,e,t){return g(this,null,function*(){yield Md(e);let r=JO(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";U(r.has(t)===n,e.auth,i)})}function XO(n,e,t=!1){return g(this,null,function*(){let{auth:r}=n;if(ht(r.app))return Promise.reject(qt(r));let i="reauthenticate";try{let s=yield zi(n,YO(r,i,e,n),t);U(s.idToken,r,"internal-error");let o=lg(s.idToken);U(o,r,"internal-error");let{sub:a}=o;return U(n.uid===a,r,"user-mismatch"),Fr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Pt(r,"user-mismatch"),s}})}function ZO(n,e,t=!1){return g(this,null,function*(){if(ht(n.app))return Promise.reject(qt(n));let r="signIn",i=yield YO(n,r,e),s=yield Fr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Gc(n,e){return g(this,null,function*(){return ZO(nt(n),e)})}function gg(n,e){return g(this,null,function*(){let t=G(n);return yield mg(!1,t,e.providerId),Y0(t,e)})}function _g(n,e){return g(this,null,function*(){return XO(G(n),e)})}function _6(n,e){return g(this,null,function*(){return Gi(n,"POST","/v1/accounts:signInWithCustomToken",yt(n,e))})}function J0(n,e){return g(this,null,function*(){if(ht(n.app))return Promise.reject(qt(n));let t=nt(n),r=yield _6(t,{token:e,returnSecureToken:!0}),i=yield Fr._fromIdTokenResponse(t,"signIn",r);return yield t._updateCurrentUser(i.user),i})}var Wo=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?w0._fromServerResponse(e,t):"totpInfo"in t?I0._fromServerResponse(e,t):Pt(e,"internal-error")}},w0=class n extends Wo{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},I0=class n extends Wo{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function yg(n,e,t){var r;U(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),U(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(U(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(U(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function X0(n){return g(this,null,function*(){let e=nt(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function Z0(n,e,t){return g(this,null,function*(){let r=nt(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&yg(r,i,t),yield kd(r,i,"getOobCode",n6)})}function eb(n,e,t){return g(this,null,function*(){yield KO(G(n),{oobCode:e,newPassword:t}).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&X0(n),r}))})}function tb(n,e){return g(this,null,function*(){yield Z9(G(n),{oobCode:e})})}function vg(n,e){return g(this,null,function*(){let t=G(n),r=yield KO(t,{oobCode:e}),i=r.requestType;switch(U(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":U(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":U(r.mfaInfo,t,"internal-error");default:U(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=Wo._fromServerResponse(nt(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}})}function nb(n,e){return g(this,null,function*(){let{data:t}=yield vg(G(n),e);return t.email})}function rb(n,e,t){return g(this,null,function*(){if(ht(n.app))return Promise.reject(qt(n));let r=nt(n),o=yield kd(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",QO).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&X0(n),c}),a=yield Fr._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function ib(n,e,t){return ht(n.app)?Promise.reject(qt(n)):Gc(G(n),qd.credential(e,t)).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&X0(n),r}))}function sb(n,e,t){return g(this,null,function*(){let r=nt(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){U(a.handleCodeInApp,r,"argument-error"),a&&yg(r,o,a)}s(i,t),yield kd(r,i,"getOobCode",r6)})}function ob(n,e){let t=Fd.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}function ab(n,e,t){return g(this,null,function*(){if(ht(n.app))return Promise.reject(qt(n));let r=G(n),i=qd.credentialWithLink(e,t||Rd());return U(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Gc(r,i)})}function y6(n,e){return g(this,null,function*(){return vt(n,"POST","/v1/accounts:createAuthUri",yt(n,e))})}function cb(n,e){return g(this,null,function*(){let t=$0()?Rd():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=yield y6(G(n),r);return i||[]})}function lb(n,e){return g(this,null,function*(){let t=G(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&yg(t.auth,i,e);let{email:s}=yield t6(t.auth,i);s!==n.email&&(yield n.reload())})}function ub(n,e,t){return g(this,null,function*(){let r=G(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield n.getIdToken(),newEmail:e};t&&yg(r.auth,s,t);let{email:o}=yield i6(r.auth,s);o!==n.email&&(yield n.reload())})}function v6(n,e){return g(this,null,function*(){return vt(n,"POST","/v1/accounts:update",e)})}function db(r,i){return g(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=G(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield zi(s,v6(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let l=s.providerData.find(({providerId:d})=>d==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function hb(n,e){let t=G(n);return ht(t.auth.app)?Promise.reject(qt(t.auth)):e1(t,e,null)}function fb(n,e){return e1(G(n),null,e)}function e1(n,e,t){return g(this,null,function*(){let{auth:r}=n,s={idToken:yield n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=yield zi(n,J9(r,s));yield n._updateTokensIfNecessary(o,!0)})}function w6(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=lg(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new Ns(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new E0(s,i);case"github.com":return new b0(s,i);case"google.com":return new C0(s,i);case"twitter.com":return new T0(s,i,n.screenName||null);case"custom":case"anonymous":return new Ns(s,null);default:return new Ns(s,r,i)}}var Ns=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},ng=class extends Ns{constructor(e,t,r,i){super(e,t,r),this.username=i}},E0=class extends Ns{constructor(e,t){super(e,"facebook.com",t)}},b0=class extends ng{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},C0=class extends Ns{constructor(e,t){super(e,"google.com",t)}},T0=class extends ng{constructor(e,t,r){super(e,"twitter.com",t,r)}};function pb(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:w6(t)}var rg=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var S0=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=nt(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>Wo._fromServerResponse(r,a));U(i.mfaPendingCredential,r,"internal-error");let o=rg._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,a=>g(this,null,function*(){let c=yield a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let l=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let d=yield Fr._fromIdTokenResponse(r,t.operationType,l);return yield r._updateCurrentUser(d.user),d;case"reauthenticate":return U(t.user,r,"internal-error"),Fr._forOperation(t.user,t.operationType,l);default:Pt(r,"internal-error")}}))}resolveSignIn(e){return g(this,null,function*(){let t=e;return this.signInResolver(t)})}};function mb(n,e){var t;let r=G(n),i=e;return U(e.customData.operationType,r,"argument-error"),U((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),S0._fromError(r,i)}function I6(n,e){return vt(n,"POST","/v2/accounts/mfaEnrollment:start",yt(n,e))}function E6(n,e){return vt(n,"POST","/v2/accounts/mfaEnrollment:finalize",yt(n,e))}function b6(n,e){return vt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",yt(n,e))}var D0=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Wo._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}getSession(){return g(this,null,function*(){return rg._fromIdtoken(yield this.user.getIdToken(),this.user)})}enroll(e,t){return g(this,null,function*(){let r=e,i=yield this.getSession(),s=yield zi(this.user,r._process(this.user.auth,i,t));return yield this.user._updateTokensIfNecessary(s),this.user.reload()})}unenroll(e){return g(this,null,function*(){let t=typeof e=="string"?e:e.uid,r=yield this.user.getIdToken();try{let i=yield zi(this.user,b6(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),yield this.user._updateTokensIfNecessary(i),yield this.user.reload()}catch(i){throw i}})}},u0=new WeakMap;function gb(n){let e=G(n);return u0.has(e)||u0.set(e,D0._fromUser(e)),u0.get(e)}var ig="__sak";var sg=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ig,"1"),this.storage.removeItem(ig),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function C6(){let n=Ke();return q0(n)||Yo(n)}var T6=1e3,S6=10,D6=(()=>{class n extends sg{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=C6()&&U9(),this.fallbackToPolling=zO(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(i);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);V9()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,S6):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},T6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return g(this,null,function*(){yield Gr(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return g(this,null,function*(){let r=yield Gr(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return g(this,null,function*(){yield Gr(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Wc=D6;var A6=(()=>{class n extends sg{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),fi=A6;function x6(n){return Promise.all(n.map(e=>g(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var R6=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return g(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>g(this,null,function*(){return d(r.origin,o)})),l=yield x6(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Jo(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var A0=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return g(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=Jo("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let p=h;if(p.data.eventId===l)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function Rt(){return window}function N6(n){Rt().location.href=n}function _b(){return typeof Rt().WorkerGlobalScope<"u"&&typeof Rt().importScripts=="function"}function P6(){return g(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function M6(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function k6(){return _b()?self:null}var t1="firebaseLocalStorageDb",O6=1,og="firebaseLocalStorage",n1="fbase_key",Ko=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function wg(n,e){return n.transaction([og],e?"readwrite":"readonly").objectStore(og)}function F6(){let n=indexedDB.deleteDatabase(t1);return new Ko(n).toPromise()}function x0(){let n=indexedDB.open(t1,O6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(og,{keyPath:n1})}catch(i){t(i)}}),n.addEventListener("success",()=>g(this,null,function*(){let r=n.result;r.objectStoreNames.contains(og)?e(r):(r.close(),yield F6(),e(yield x0()))}))})}function CO(n,e,t){return g(this,null,function*(){let r=wg(n,!0).put({[n1]:e,value:t});return new Ko(r).toPromise()})}function L6(n,e){return g(this,null,function*(){let t=wg(n,!1).get(e),r=yield new Ko(t).toPromise();return r===void 0?null:r.value})}function TO(n,e){let t=wg(n,!0).delete(e);return new Ko(t).toPromise()}var V6=800,U6=3,B6=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db?this.db:(this.db=yield x0(),this.db)})}_withRetries(t){return g(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>U6)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return _b()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=R6._getInstance(k6()),this.receiver._subscribe("keyChanged",(t,r)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var t,r;if(this.activeServiceWorker=yield P6(),!this.activeServiceWorker)return;this.sender=new A0(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return g(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||M6()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;let t=yield x0();return yield CO(t,ig,"1"),yield TO(t,ig),!0}catch{}return!1})}_withPendingWrite(t){return g(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(i=>CO(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return g(this,null,function*(){let r=yield this._withRetries(i=>L6(i,t));return this.localCache[t]=r,r})}_remove(t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(r=>TO(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return g(this,null,function*(){let t=yield this._withRetries(s=>{let o=wg(s,!1).getAll();return new Ko(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),V6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Xo=B6;function j6(n,e){return vt(n,"POST","/v2/accounts/mfaSignIn:start",yt(n,e))}function $6(n,e){return vt(n,"POST","/v2/accounts/mfaSignIn:finalize",yt(n,e))}var H6=500,q6=6e4,Qm=1e12,R0=class{constructor(e){this.auth=e,this.counter=Qm,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new N0(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||Qm;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||Qm;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}execute(e){return g(this,null,function*(){var t;let r=e||Qm;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""})}},N0=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;U(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=z6(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},q6)},H6))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function z6(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var d0=GO("rcb"),G6=new qo(3e4,6e4),P0=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Rt().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return U(W6(t),e,"argument-error"),this.shouldResolveImmediately(t)&&gO(Rt().grecaptcha)?Promise.resolve(Rt().grecaptcha):new Promise((r,i)=>{let s=Rt().setTimeout(()=>{i(Nt(e,"network-request-failed"))},G6.get());Rt()[d0]=()=>{Rt().clearTimeout(s),delete Rt()[d0];let a=Rt().grecaptcha;if(!a||!gO(a)){i(Nt(e,"internal-error"));return}let c=a.render;a.render=(l,d)=>{let h=c(l,d);return this.counter++,h},this.hostLanguage=t,r(a)};let o=`${H9()}?${Hi({onload:d0,render:"explicit",hl:t})}`;G0(o).catch(()=>{clearTimeout(s),i(Nt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=Rt().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function W6(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var M0=class{load(e){return g(this,null,function*(){return new R0(e)})}clearedOneInstance(){}};var r1="recaptcha",K6={theme:"light",type:"image"},Vd=class{constructor(e,t,r=Object.assign({},K6)){this.parameters=r,this.type=r1,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=nt(e),this.isInvisible=this.parameters.size==="invisible",U(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;U(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new M0:new P0,this.validateStartingState()}verify(){return g(this,null,function*(){this.assertNotDestroyed();let e=yield this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){U(!this.parameters.sitekey,this.auth,"argument-error"),U(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),U(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=Rt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){U(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){return g(this,null,function*(){if(yield this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId})}init(){return g(this,null,function*(){U($0()&&!_b(),this.auth,"internal-error"),yield Q6(),this.recaptcha=yield this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=yield A9(this.auth);U(e,this.auth,"internal-error"),this.parameters.sitekey=e})}getAssertedRecaptcha(){return U(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function Q6(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var Ud=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=$c._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};function yb(n,e,t){return g(this,null,function*(){if(ht(n.app))return Promise.reject(qt(n));let r=nt(n),i=yield Ig(r,e,G(t));return new Ud(i,s=>Gc(r,s))})}function vb(n,e,t){return g(this,null,function*(){let r=G(n);yield mg(!1,r,"phone");let i=yield Ig(r.auth,e,G(t));return new Ud(i,s=>gg(r,s))})}function wb(n,e,t){return g(this,null,function*(){let r=G(n);if(ht(r.auth.app))return Promise.reject(qt(r.auth));let i=yield Ig(r.auth,e,G(t));return new Ud(i,s=>_g(r,s))})}function Ig(n,e,t){return g(this,null,function*(){var r;let i=yield t.verify();try{U(typeof i=="string",n,"argument-error"),U(t.type===r1,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return U(o.type==="enroll",n,"internal-error"),(yield I6(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{U(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return U(a,n,"missing-multi-factor-info"),(yield j6(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=yield c6(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}})}function Ib(n,e){return g(this,null,function*(){let t=G(n);if(ht(t.auth.app))return Promise.reject(qt(t.auth));yield Y0(t,e)})}var Zo=(()=>{class n{constructor(t){this.providerId=n.PROVIDER_ID,this.auth=nt(t)}verifyPhoneNumber(t,r){return Ig(this.auth,t,G(r))}static credential(t,r){return $c._fromVerification(t,r)}static credentialFromResult(t){let r=t;return n.credentialFromTaggedObject(r)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{phoneNumber:r,temporaryProof:i}=t;return r&&i?$c._fromTokenResponse(r,i):null}}n.PROVIDER_ID="phone",n.PHONE_SIGN_IN_METHOD="phone";return n})();function ea(n,e){return e?un(e):(U(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Bd=class extends hi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return qi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return qi(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Y6(n){return ZO(n.auth,new Bd(n),n.bypassAuthState)}function J6(n){let{auth:e,user:t}=n;return U(t,e,"internal-error"),XO(t,new Bd(n),n.bypassAuthState)}function X6(n){return g(this,null,function*(){let{auth:e,user:t}=n;return U(t,e,"internal-error"),Y0(t,new Bd(n),n.bypassAuthState)})}var ag=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return g(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Y6;case"linkViaPopup":case"linkViaRedirect":return X6;case"reauthViaPopup":case"reauthViaRedirect":return J6;default:Pt(this.auth,"internal-error")}}resolve(e){mr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){mr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Z6=new qo(2e3,1e4);function Eb(n,e,t){return g(this,null,function*(){if(ht(n.app))return Promise.reject(Nt(n,"operation-not-supported-in-this-environment"));let r=nt(n);qc(n,e,Or);let i=ea(r,t);return new Tb(r,"signInViaPopup",e,i).executeNotNull()})}function bb(n,e,t){return g(this,null,function*(){let r=G(n);if(ht(r.auth.app))return Promise.reject(Nt(r.auth,"operation-not-supported-in-this-environment"));qc(r.auth,e,Or);let i=ea(r.auth,t);return new Tb(r.auth,"reauthViaPopup",e,i,r).executeNotNull()})}function Cb(n,e,t){return g(this,null,function*(){let r=G(n);qc(r.auth,e,Or);let i=ea(r.auth,t);return new Tb(r.auth,"linkViaPopup",e,i,r).executeNotNull()})}var Tb=(()=>{class n extends ag{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return g(this,null,function*(){let t=yield this.execute();return U(t,this.auth,"internal-error"),t})}onExecution(){return g(this,null,function*(){mr(this.filter.length===1,"Popup operations only handle one event");let t=Jo();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Nt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Nt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Nt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,Z6.get())};t()}}n.currentPopupAction=null;return n})(),e8="pendingRedirect",xd=new Map,k0=class n extends ag{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return g(this,null,function*(){let e=xd.get(this.auth._key());if(!e){try{let r=(yield t8(this.resolver,this.auth))?yield Gr(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}xd.set(this.auth._key(),e)}return this.bypassAuthState||xd.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if(e.type==="signInViaRedirect")return Gr(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Gr(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return g(this,null,function*(){})}cleanUp(){}};function t8(n,e){return g(this,null,function*(){let t=o1(e),r=s1(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Sb(n,e){return g(this,null,function*(){return s1(n)._set(o1(e),"true")})}function i1(){xd.clear()}function Kc(n,e){xd.set(n._key(),e)}function s1(n){return un(n._redirectPersistence)}function o1(n){return di(e8,n.config.apiKey,n.name)}function Db(n,e,t){return n8(n,e,t)}function n8(n,e,t){return g(this,null,function*(){if(ht(n.app))return Promise.reject(qt(n));let r=nt(n);qc(n,e,Or),yield r._initializationPromise;let i=ea(r,t);return yield Sb(i,r),i._openRedirect(r,e,"signInViaRedirect")})}function Ab(n,e,t){return r8(n,e,t)}function r8(n,e,t){return g(this,null,function*(){let r=G(n);if(qc(r.auth,e,Or),ht(r.auth.app))return Promise.reject(qt(r.auth));yield r.auth._initializationPromise;let i=ea(r.auth,t);yield Sb(i,r.auth);let s=yield a1(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)})}function xb(n,e,t){return i8(n,e,t)}function i8(n,e,t){return g(this,null,function*(){let r=G(n);qc(r.auth,e,Or),yield r.auth._initializationPromise;let i=ea(r.auth,t);yield mg(!1,r,e.providerId),yield Sb(i,r.auth);let s=yield a1(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)})}function Rb(n,e){return g(this,null,function*(){return yield nt(n)._initializationPromise,ta(n,e,!1)})}function ta(n,e,t=!1){return g(this,null,function*(){if(ht(n.app))return Promise.reject(qt(n));let r=nt(n),i=ea(r,e),o=yield new k0(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}function a1(n){return g(this,null,function*(){let e=Jo(`${n.uid}:::`);return n._redirectEventId=e,yield n.auth._setRedirectUser(n),yield n.auth._persistUserIfCurrent(n),e})}var s8=10*60*1e3,jd=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!o8(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!c1(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Nt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=s8&&this.cachedEventUids.clear(),this.cachedEventUids.has(SO(e))}saveEventToCache(e){this.cachedEventUids.add(SO(e)),this.lastProcessedEventTime=Date.now()}};function SO(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function c1({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function o8(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return c1(n);default:return!1}}function Nb(t){return g(this,arguments,function*(n,e={}){return vt(n,"GET","/v1/projects",e)})}var a8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,c8=/^https?/;function l8(n){return g(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield Nb(n);for(let t of e)try{if(u8(t))return}catch{}Pt(n,"unauthorized-domain")})}function u8(n){let e=Rd(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!c8.test(t))return!1;if(a8.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var d8=new qo(3e4,6e4);function DO(){let n=Rt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function h8(n){return new Promise((e,t)=>{var r,i,s;function o(){DO(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{DO(),t(Nt(n,"network-request-failed"))},timeout:d8.get()})}if(!((i=(r=Rt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Rt().gapi)===null||s===void 0)&&s.load)o();else{let a=GO("iframefcb");return Rt()[a]=()=>{gapi.load?o():t(Nt(n,"network-request-failed"))},G0(`${z9()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Jm=null,e})}var Jm=null;function f8(n){return Jm=Jm||h8(n),Jm}var p8=new qo(5e3,15e3),m8="__/auth/iframe",g8="emulator/auth/iframe",_8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},y8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function v8(n){let e=n.config;U(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?H0(e,g8):`https://${n.config.authDomain}/${m8}`,r={apiKey:e.apiKey,appName:n.name,v:In},i=y8.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Hi(r).slice(1)}`}function w8(n){return g(this,null,function*(){let e=yield f8(n),t=Rt().gapi;return U(t,n,"internal-error"),e.open({where:document.body,url:v8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_8,dontclear:!0},r=>new Promise((i,s)=>g(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=Nt(n,"network-request-failed"),a=Rt().setTimeout(()=>{s(o)},p8.get());function c(){Rt().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var I8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},E8=500,b8=600,C8="_blank",T8="http://localhost",$d=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function S8(n,e,t,r=E8,i=b8){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},I8),{width:r.toString(),height:i.toString(),top:s,left:o}),l=Ke().toLowerCase();t&&(a=BO(l)?C8:t),UO(l)&&(e=e||T8,c.scrollbars="yes");let d=Object.entries(c).reduce((p,[_,w])=>`${p}${_}=${w},`,"");if(L9(l)&&a!=="_self")return D8(e||"",a),new $d(null);let h=window.open(e||"",a,d);U(h,n,"popup-blocked");try{h.focus()}catch{}return new $d(h)}function D8(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var A8="__/auth/handler",x8="emulator/auth/handler",R8=encodeURIComponent("fac");function cg(n,e,t,r,i,s){return g(this,null,function*(){U(n.config.authDomain,n,"auth-domain-config-required"),U(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:In,eventId:i};if(e instanceof Or){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Fc(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(s||{}))o[d]=h}if(e instanceof Ms){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),l=c?`#${R8}=${encodeURIComponent(c)}`:"";return`${N8(n)}?${Hi(a).slice(1)}${l}`})}function N8({config:n}){return n.emulator?H0(n,x8):`https://${n.authDomain}/${A8}`}var h0="webStorageSupport",O0=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fi,this._completeRedirectFn=ta,this._overrideRedirectResult=Kc}_openPopup(e,t,r,i){return g(this,null,function*(){var s;mr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield cg(e,t,r,Rd(),i);return S8(e,o,Jo())})}_openRedirect(e,t,r,i){return g(this,null,function*(){yield this._originValidation(e);let s=yield cg(e,t,r,Rd(),i);return N6(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(mr(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return g(this,null,function*(){let t=yield w8(e),r=new jd(e);return t.register("authEvent",i=>(U(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(h0,{type:h0},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[h0];o!==void 0&&t(!!o),Pt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=l8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return zO()||q0()||Yo()}},Pb=O0,F0=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return ui("unexpected MultiFactorSessionType")}}},L0=class n extends F0{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return E6(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return $6(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},Mb=(()=>{class n{constructor(){}static assertion(t){return L0._fromCredential(t)}}return n.FACTOR_ID="phone",n})();var AO="@firebase/auth",xO="1.7.4";var V0=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function P8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function M8(n){wn(new qe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;U(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:z0(n)},l=new eg(r,i,s,c);return K9(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),wn(new qe("auth-internal",e=>{let t=nt(e.getProvider("auth").getImmediate());return(r=>new V0(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),bt(AO,xO,P8(n)),bt(AO,xO,"esm2017")}var k8=5*60,qae=Hk("authIdTokenMaxAge")||k8;function O8(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}$9({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Nt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",O8().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});M8("Browser");function na(){return window}var F8=2e3;function L8(n,e,t){return g(this,null,function*(){var r;let{BuildInfo:i}=na();mr(e.sessionId,"AuthEvent did not contain a session ID");let s=yield $8(e.sessionId),o={};return Yo()?o.ibi=i.packageName:zc()?o.apn=i.packageName:Pt(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,cg(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)})}function V8(n){return g(this,null,function*(){let{BuildInfo:e}=na(),t={};Yo()?t.iosBundleId=e.packageName:zc()?t.androidPackageName=e.packageName:Pt(n,"operation-not-supported-in-this-environment"),yield Nb(n,t)})}function U8(n){let{cordova:e}=na();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,qO()?"_blank":"_system","location=yes"),t(i)})})}function B8(n,e,t){return g(this,null,function*(){let{cordova:r}=na(),i=()=>{};try{yield new Promise((s,o)=>{let a=null;function c(){var h;s();let p=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof p=="function"&&p(),typeof t?.close=="function"&&t.close()}function l(){a||(a=window.setTimeout(()=>{o(Nt(n,"redirect-cancelled-by-user"))},F8))}function d(){document?.visibilityState==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),zc()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}})}function j8(n){var e,t,r,i,s,o,a,c,l,d;let h=na();U(typeof((e=h?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),U(typeof((t=h?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),U(typeof((s=(i=(r=h?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U(typeof((c=(a=(o=h?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U(typeof((d=(l=h?.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function $8(n){return g(this,null,function*(){let e=H8(n),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")})}function H8(n){if(mr(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var q8=20,kb=class extends jd{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}initialized(){return g(this,null,function*(){yield this.initPromise})}};function z8(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:K8(),postBody:null,tenantId:n.tenantId,error:Nt(n,"no-auth-event")}}function G8(n,e){return Ob()._set(Fb(n),e)}function l1(n){return g(this,null,function*(){let e=yield Ob()._get(Fb(n));return e&&(yield Ob()._remove(Fb(n))),e})}function W8(n,e){var t,r;let i=Y8(e);if(i.includes("/__/auth/callback")){let s=Eg(i),o=s.firebaseError?Q8(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?Nt(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function K8(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<q8;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function Ob(){return un(Wc)}function Fb(n){return di("authEvent",n.config.apiKey,n.name)}function Q8(n){try{return JSON.parse(n)}catch{return null}}function Y8(n){let e=Eg(n),t=e.link?decodeURIComponent(e.link):void 0,r=Eg(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Eg(i).link||i||r||t||n}function Eg(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return Ds(t.join("?"))}var J8=500,Lb=class{constructor(){this._redirectPersistence=fi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ta,this._overrideRedirectResult=Kc}_initialize(e){return g(this,null,function*(){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new kb(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r})}_openPopup(e){Pt(e,"operation-not-supported-in-this-environment")}_openRedirect(e,t,r,i){return g(this,null,function*(){j8(e);let s=yield this._initialize(e);yield s.initialized(),s.resetRedirect(),i1(),yield this._originValidation(e);let o=z8(e,r,i);yield G8(e,o);let a=yield L8(e,o,t),c=yield U8(a);return B8(e,s,c)})}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=V8(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=na(),o=setTimeout(()=>g(this,null,function*(){yield l1(e),t.onEvent(u1())}),J8),a=d=>g(this,null,function*(){clearTimeout(o);let h=yield l1(e),p=null;h&&d?.url&&(p=W8(h,d.url)),t.onEvent(p||u1())});typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,l=`${s.packageName.toLowerCase()}://`;na().handleOpenURL=d=>g(this,null,function*(){if(d.toLowerCase().startsWith(l)&&a({url:d}),typeof c=="function")try{c(d)}catch(h){console.error(h)}})}},d1=Lb;function u1(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Nt("no-auth-event")}}function h1(n,e){nt(n)._logFramework(e)}var Z8="@firebase/auth-compat",eK="0.5.9";var tK=1e3;function Wd(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function nK(){return Wd()==="http:"||Wd()==="https:"}function m1(n=Ke()){return!!((Wd()==="file:"||Wd()==="ionic:"||Wd()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function rK(){return Bo()||Um()}function iK(){return $m()&&document?.documentMode===11}function sK(n=Ke()){return/Edge\/\d+/.test(n)}function oK(n=Ke()){return iK()||sK(n)}function g1(){try{let n=self.localStorage,e=Jo();if(n)return n.setItem(e,"1"),n.removeItem(e),oK()?Cs():!0}catch{return Hb()&&Cs()}return!1}function Hb(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Vb(){return(nK()||jm()||m1())&&!rK()&&g1()&&!Hb()}function _1(){return m1()&&typeof document<"u"}function aK(){return g(this,null,function*(){return _1()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},tK);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1})}function cK(){return typeof window<"u"?window:null}var Kn={LOCAL:"local",NONE:"none",SESSION:"session"},zd=U,y1="persistence";function lK(n,e){if(zd(Object.values(Kn).includes(e),n,"invalid-persistence-type"),Bo()){zd(e!==Kn.SESSION,n,"unsupported-persistence-type");return}if(Um()){zd(e===Kn.NONE,n,"unsupported-persistence-type");return}if(Hb()){zd(e===Kn.NONE||e===Kn.LOCAL&&Cs(),n,"unsupported-persistence-type");return}zd(e===Kn.NONE||g1(),n,"unsupported-persistence-type")}function Ub(n){return g(this,null,function*(){yield n._initializationPromise;let e=v1(),t=di(y1,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())})}function uK(n,e){let t=v1();if(!t)return[];let r=di(y1,n,e);switch(t.getItem(r)){case Kn.NONE:return[Ps];case Kn.LOCAL:return[Xo,fi];case Kn.SESSION:return[fi];default:return[]}}function v1(){var n;try{return((n=cK())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var dK=U,pi=class{constructor(){this.browserResolver=un(Pb),this.cordovaResolver=un(d1),this.underlyingResolver=null,this._redirectPersistence=fi,this._completeRedirectFn=ta,this._overrideRedirectResult=Kc}_initialize(e){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)})}_openPopup(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)})}_openRedirect(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)})}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return _1()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return dK(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){return g(this,null,function*(){if(this.underlyingResolver)return;let e=yield aK();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver})}};function w1(n){return n.unwrap()}function hK(n){return n.wrapped()}function fK(n){return I1(n)}function pK(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new jb(n,mb(n,e))}else if(r){let i=I1(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function I1(n){let{_tokenResponse:e}=n instanceof _t?n.customData:n;if(!e)return null;if(!(n instanceof _t)&&"temporaryProof"in e&&"phoneNumber"in e)return Zo.credentialFromResult(n);let t=e.providerId;if(!t||t===Qo.PASSWORD)return null;let r;switch(t){case Qo.GOOGLE:r=hg;break;case Qo.FACEBOOK:r=dg;break;case Qo.GITHUB:r=fg;break;case Qo.TWITTER:r=pg;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?Go._create(t,a):kr._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new Hc(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof _t?r.credentialFromError(n):r.credentialFromResult(n)}function Vn(n,e){return e.catch(t=>{throw t instanceof _t&&pK(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:fK(t),additionalUserInfo:pb(t),user:Qc.getOrCreate(i)}})}function Bb(n,e){return g(this,null,function*(){let t=yield e;return{verificationId:t.verificationId,confirm:r=>Vn(n,t.confirm(r))}})}var jb=class{constructor(e,t){this.resolver=t,this.auth=hK(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Vn(w1(this.auth),this.resolver.resolveSignIn(e))}};var Qc=class n{constructor(e){this._delegate=e,this.multiFactor=gb(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}linkWithCredential(e){return g(this,null,function*(){return Vn(this.auth,gg(this._delegate,e))})}linkWithPhoneNumber(e,t){return g(this,null,function*(){return Bb(this.auth,vb(this._delegate,e,t))})}linkWithPopup(e){return g(this,null,function*(){return Vn(this.auth,Cb(this._delegate,e,pi))})}linkWithRedirect(e){return g(this,null,function*(){return yield Ub(nt(this.auth)),xb(this._delegate,e,pi)})}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}reauthenticateWithCredential(e){return g(this,null,function*(){return Vn(this.auth,_g(this._delegate,e))})}reauthenticateWithPhoneNumber(e,t){return Bb(this.auth,wb(this._delegate,e,t))}reauthenticateWithPopup(e){return Vn(this.auth,bb(this._delegate,e,pi))}reauthenticateWithRedirect(e){return g(this,null,function*(){return yield Ub(nt(this.auth)),Ab(this._delegate,e,pi)})}sendEmailVerification(e){return lb(this._delegate,e)}unlink(e){return g(this,null,function*(){return yield Q0(this._delegate,e),this})}updateEmail(e){return hb(this._delegate,e)}updatePassword(e){return fb(this._delegate,e)}updatePhoneNumber(e){return Ib(this._delegate,e)}updateProfile(e){return db(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return ub(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Qc.USER_MAP=new WeakMap;var Gd=U,f1=(()=>{class n{constructor(t,r){if(this.app=t,r.isInitialized()){this._delegate=r.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:i}=t.options;Gd(i,"invalid-api-key",{appName:t.name}),Gd(i,"invalid-api-key",{appName:t.name});let s=typeof window<"u"?pi:void 0;this._delegate=r.initialize({options:{persistence:mK(i,t.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(U0),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Qc.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,r){W0(this._delegate,t,r)}applyActionCode(t){return tb(this._delegate,t)}checkActionCode(t){return vg(this._delegate,t)}confirmPasswordReset(t,r){return eb(this._delegate,t,r)}createUserWithEmailAndPassword(t,r){return g(this,null,function*(){return Vn(this._delegate,rb(this._delegate,t,r))})}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return cb(this._delegate,t)}isSignInWithEmailLink(t){return ob(this._delegate,t)}getRedirectResult(){return g(this,null,function*(){Gd(Vb(),this._delegate,"operation-not-supported-in-this-environment");let t=yield Rb(this._delegate,pi);return t?Vn(this._delegate,Promise.resolve(t)):{credential:null,user:null}})}addFrameworkForLogging(t){h1(this._delegate,t)}onAuthStateChanged(t,r,i){let{next:s,error:o,complete:a}=p1(t,r,i);return this._delegate.onAuthStateChanged(s,o,a)}onIdTokenChanged(t,r,i){let{next:s,error:o,complete:a}=p1(t,r,i);return this._delegate.onIdTokenChanged(s,o,a)}sendSignInLinkToEmail(t,r){return sb(this._delegate,t,r)}sendPasswordResetEmail(t,r){return Z0(this._delegate,t,r||void 0)}setPersistence(t){return g(this,null,function*(){lK(this._delegate,t);let r;switch(t){case Kn.SESSION:r=fi;break;case Kn.LOCAL:r=(yield un(Xo)._isAvailable())?Xo:Wc;break;case Kn.NONE:r=Ps;break;default:return Pt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)})}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return Vn(this._delegate,K0(this._delegate))}signInWithCredential(t){return Vn(this._delegate,Gc(this._delegate,t))}signInWithCustomToken(t){return Vn(this._delegate,J0(this._delegate,t))}signInWithEmailAndPassword(t,r){return Vn(this._delegate,ib(this._delegate,t,r))}signInWithEmailLink(t,r){return Vn(this._delegate,ab(this._delegate,t,r))}signInWithPhoneNumber(t,r){return Bb(this._delegate,yb(this._delegate,t,r))}signInWithPopup(t){return g(this,null,function*(){return Gd(Vb(),this._delegate,"operation-not-supported-in-this-environment"),Vn(this._delegate,Eb(this._delegate,t,pi))})}signInWithRedirect(t){return g(this,null,function*(){return Gd(Vb(),this._delegate,"operation-not-supported-in-this-environment"),yield Ub(this._delegate),Db(this._delegate,t,pi)})}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return nb(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=Kn,n})();function p1(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&Qc.getOrCreate(o)),error:e,complete:t}}function mK(n,e){let t=uK(n,e);if(typeof self<"u"&&!t.includes(Xo)&&t.push(Xo),typeof window<"u")for(let r of[Wc,fi])t.includes(r)||t.push(r);return t.includes(Ps)||t.push(Ps),t}var Kd=class{constructor(){this.providerId="phone",this._delegate=new Zo(w1($.auth()))}static credential(e,t){return Zo.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};Kd.PHONE_SIGN_IN_METHOD=Zo.PHONE_SIGN_IN_METHOD;Kd.PROVIDER_ID=Zo.PROVIDER_ID;var gK=U,$b=class{constructor(e,t,r=$.app()){var i;gK((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new Vd(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var _K="auth-compat";function yK(n){n.INTERNAL.registerComponent(new qe(_K,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new f1(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ks.EMAIL_SIGNIN,PASSWORD_RESET:ks.PASSWORD_RESET,RECOVER_EMAIL:ks.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:ks.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:ks.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:ks.VERIFY_EMAIL}},EmailAuthProvider:qd,FacebookAuthProvider:dg,GithubAuthProvider:fg,GoogleAuthProvider:hg,OAuthProvider:Hc,SAMLAuthProvider:Ld,PhoneAuthProvider:Kd,PhoneMultiFactorGenerator:Mb,RecaptchaVerifier:$b,TwitterAuthProvider:pg,Auth:f1,AuthCredential:hi,Error:_t}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(Z8,eK)}yK($);var E1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},b1={};var Os,qb;(function(){var n;function e(T,v){function E(){}E.prototype=v.prototype,T.D=v.prototype,T.prototype=new E,T.prototype.constructor=T,T.C=function(D,x,P){for(var C=Array(arguments.length-2),Mi=2;Mi<arguments.length;Mi++)C[Mi-2]=arguments[Mi];return v.prototype[x].apply(D,C)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,v,E){E||(E=0);var D=Array(16);if(typeof v=="string")for(var x=0;16>x;++x)D[x]=v.charCodeAt(E++)|v.charCodeAt(E++)<<8|v.charCodeAt(E++)<<16|v.charCodeAt(E++)<<24;else for(x=0;16>x;++x)D[x]=v[E++]|v[E++]<<8|v[E++]<<16|v[E++]<<24;v=T.g[0],E=T.g[1],x=T.g[2];var P=T.g[3],C=v+(P^E&(x^P))+D[0]+3614090360&4294967295;v=E+(C<<7&4294967295|C>>>25),C=P+(x^v&(E^x))+D[1]+3905402710&4294967295,P=v+(C<<12&4294967295|C>>>20),C=x+(E^P&(v^E))+D[2]+606105819&4294967295,x=P+(C<<17&4294967295|C>>>15),C=E+(v^x&(P^v))+D[3]+3250441966&4294967295,E=x+(C<<22&4294967295|C>>>10),C=v+(P^E&(x^P))+D[4]+4118548399&4294967295,v=E+(C<<7&4294967295|C>>>25),C=P+(x^v&(E^x))+D[5]+1200080426&4294967295,P=v+(C<<12&4294967295|C>>>20),C=x+(E^P&(v^E))+D[6]+2821735955&4294967295,x=P+(C<<17&4294967295|C>>>15),C=E+(v^x&(P^v))+D[7]+4249261313&4294967295,E=x+(C<<22&4294967295|C>>>10),C=v+(P^E&(x^P))+D[8]+1770035416&4294967295,v=E+(C<<7&4294967295|C>>>25),C=P+(x^v&(E^x))+D[9]+2336552879&4294967295,P=v+(C<<12&4294967295|C>>>20),C=x+(E^P&(v^E))+D[10]+4294925233&4294967295,x=P+(C<<17&4294967295|C>>>15),C=E+(v^x&(P^v))+D[11]+2304563134&4294967295,E=x+(C<<22&4294967295|C>>>10),C=v+(P^E&(x^P))+D[12]+1804603682&4294967295,v=E+(C<<7&4294967295|C>>>25),C=P+(x^v&(E^x))+D[13]+4254626195&4294967295,P=v+(C<<12&4294967295|C>>>20),C=x+(E^P&(v^E))+D[14]+2792965006&4294967295,x=P+(C<<17&4294967295|C>>>15),C=E+(v^x&(P^v))+D[15]+1236535329&4294967295,E=x+(C<<22&4294967295|C>>>10),C=v+(x^P&(E^x))+D[1]+4129170786&4294967295,v=E+(C<<5&4294967295|C>>>27),C=P+(E^x&(v^E))+D[6]+3225465664&4294967295,P=v+(C<<9&4294967295|C>>>23),C=x+(v^E&(P^v))+D[11]+643717713&4294967295,x=P+(C<<14&4294967295|C>>>18),C=E+(P^v&(x^P))+D[0]+3921069994&4294967295,E=x+(C<<20&4294967295|C>>>12),C=v+(x^P&(E^x))+D[5]+3593408605&4294967295,v=E+(C<<5&4294967295|C>>>27),C=P+(E^x&(v^E))+D[10]+38016083&4294967295,P=v+(C<<9&4294967295|C>>>23),C=x+(v^E&(P^v))+D[15]+3634488961&4294967295,x=P+(C<<14&4294967295|C>>>18),C=E+(P^v&(x^P))+D[4]+3889429448&4294967295,E=x+(C<<20&4294967295|C>>>12),C=v+(x^P&(E^x))+D[9]+568446438&4294967295,v=E+(C<<5&4294967295|C>>>27),C=P+(E^x&(v^E))+D[14]+3275163606&4294967295,P=v+(C<<9&4294967295|C>>>23),C=x+(v^E&(P^v))+D[3]+4107603335&4294967295,x=P+(C<<14&4294967295|C>>>18),C=E+(P^v&(x^P))+D[8]+1163531501&4294967295,E=x+(C<<20&4294967295|C>>>12),C=v+(x^P&(E^x))+D[13]+2850285829&4294967295,v=E+(C<<5&4294967295|C>>>27),C=P+(E^x&(v^E))+D[2]+4243563512&4294967295,P=v+(C<<9&4294967295|C>>>23),C=x+(v^E&(P^v))+D[7]+1735328473&4294967295,x=P+(C<<14&4294967295|C>>>18),C=E+(P^v&(x^P))+D[12]+2368359562&4294967295,E=x+(C<<20&4294967295|C>>>12),C=v+(E^x^P)+D[5]+4294588738&4294967295,v=E+(C<<4&4294967295|C>>>28),C=P+(v^E^x)+D[8]+2272392833&4294967295,P=v+(C<<11&4294967295|C>>>21),C=x+(P^v^E)+D[11]+1839030562&4294967295,x=P+(C<<16&4294967295|C>>>16),C=E+(x^P^v)+D[14]+4259657740&4294967295,E=x+(C<<23&4294967295|C>>>9),C=v+(E^x^P)+D[1]+2763975236&4294967295,v=E+(C<<4&4294967295|C>>>28),C=P+(v^E^x)+D[4]+1272893353&4294967295,P=v+(C<<11&4294967295|C>>>21),C=x+(P^v^E)+D[7]+4139469664&4294967295,x=P+(C<<16&4294967295|C>>>16),C=E+(x^P^v)+D[10]+3200236656&4294967295,E=x+(C<<23&4294967295|C>>>9),C=v+(E^x^P)+D[13]+681279174&4294967295,v=E+(C<<4&4294967295|C>>>28),C=P+(v^E^x)+D[0]+3936430074&4294967295,P=v+(C<<11&4294967295|C>>>21),C=x+(P^v^E)+D[3]+3572445317&4294967295,x=P+(C<<16&4294967295|C>>>16),C=E+(x^P^v)+D[6]+76029189&4294967295,E=x+(C<<23&4294967295|C>>>9),C=v+(E^x^P)+D[9]+3654602809&4294967295,v=E+(C<<4&4294967295|C>>>28),C=P+(v^E^x)+D[12]+3873151461&4294967295,P=v+(C<<11&4294967295|C>>>21),C=x+(P^v^E)+D[15]+530742520&4294967295,x=P+(C<<16&4294967295|C>>>16),C=E+(x^P^v)+D[2]+3299628645&4294967295,E=x+(C<<23&4294967295|C>>>9),C=v+(x^(E|~P))+D[0]+4096336452&4294967295,v=E+(C<<6&4294967295|C>>>26),C=P+(E^(v|~x))+D[7]+1126891415&4294967295,P=v+(C<<10&4294967295|C>>>22),C=x+(v^(P|~E))+D[14]+2878612391&4294967295,x=P+(C<<15&4294967295|C>>>17),C=E+(P^(x|~v))+D[5]+4237533241&4294967295,E=x+(C<<21&4294967295|C>>>11),C=v+(x^(E|~P))+D[12]+1700485571&4294967295,v=E+(C<<6&4294967295|C>>>26),C=P+(E^(v|~x))+D[3]+2399980690&4294967295,P=v+(C<<10&4294967295|C>>>22),C=x+(v^(P|~E))+D[10]+4293915773&4294967295,x=P+(C<<15&4294967295|C>>>17),C=E+(P^(x|~v))+D[1]+2240044497&4294967295,E=x+(C<<21&4294967295|C>>>11),C=v+(x^(E|~P))+D[8]+1873313359&4294967295,v=E+(C<<6&4294967295|C>>>26),C=P+(E^(v|~x))+D[15]+4264355552&4294967295,P=v+(C<<10&4294967295|C>>>22),C=x+(v^(P|~E))+D[6]+2734768916&4294967295,x=P+(C<<15&4294967295|C>>>17),C=E+(P^(x|~v))+D[13]+1309151649&4294967295,E=x+(C<<21&4294967295|C>>>11),C=v+(x^(E|~P))+D[4]+4149444226&4294967295,v=E+(C<<6&4294967295|C>>>26),C=P+(E^(v|~x))+D[11]+3174756917&4294967295,P=v+(C<<10&4294967295|C>>>22),C=x+(v^(P|~E))+D[2]+718787259&4294967295,x=P+(C<<15&4294967295|C>>>17),C=E+(P^(x|~v))+D[9]+3951481745&4294967295,T.g[0]=T.g[0]+v&4294967295,T.g[1]=T.g[1]+(x+(C<<21&4294967295|C>>>11))&4294967295,T.g[2]=T.g[2]+x&4294967295,T.g[3]=T.g[3]+P&4294967295}r.prototype.u=function(T,v){v===void 0&&(v=T.length);for(var E=v-this.blockSize,D=this.B,x=this.h,P=0;P<v;){if(x==0)for(;P<=E;)i(this,T,P),P+=this.blockSize;if(typeof T=="string"){for(;P<v;)if(D[x++]=T.charCodeAt(P++),x==this.blockSize){i(this,D),x=0;break}}else for(;P<v;)if(D[x++]=T[P++],x==this.blockSize){i(this,D),x=0;break}}this.h=x,this.o+=v},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var v=1;v<T.length-8;++v)T[v]=0;var E=8*this.o;for(v=T.length-8;v<T.length;++v)T[v]=E&255,E/=256;for(this.u(T),T=Array(16),v=E=0;4>v;++v)for(var D=0;32>D;D+=8)T[E++]=this.g[v]>>>D&255;return T};function s(T,v){var E=a;return Object.prototype.hasOwnProperty.call(E,T)?E[T]:E[T]=v(T)}function o(T,v){this.h=v;for(var E=[],D=!0,x=T.length-1;0<=x;x--){var P=T[x]|0;D&&P==v||(E[x]=P,D=!1)}this.g=E}var a={};function c(T){return-128<=T&&128>T?s(T,function(v){return new o([v|0],0>v?-1:0)}):new o([T|0],0>T?-1:0)}function l(T){if(isNaN(T)||!isFinite(T))return h;if(0>T)return R(l(-T));for(var v=[],E=1,D=0;T>=E;D++)v[D]=T/E|0,E*=4294967296;return new o(v,0)}function d(T,v){if(T.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(T.charAt(0)=="-")return R(d(T.substring(1),v));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=l(Math.pow(v,8)),D=h,x=0;x<T.length;x+=8){var P=Math.min(8,T.length-x),C=parseInt(T.substring(x,x+P),v);8>P?(P=l(Math.pow(v,P)),D=D.j(P).add(l(C))):(D=D.j(E),D=D.add(l(C)))}return D}var h=c(0),p=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(A(this))return-R(this).m();for(var T=0,v=1,E=0;E<this.g.length;E++){var D=this.i(E);T+=(0<=D?D:4294967296+D)*v,v*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(w(this))return"0";if(A(this))return"-"+R(this).toString(T);for(var v=l(Math.pow(T,6)),E=this,D="";;){var x=X(E,v).g;E=L(E,x.j(v));var P=((0<E.g.length?E.g[0]:E.h)>>>0).toString(T);if(E=x,w(E))return P+D;for(;6>P.length;)P="0"+P;D=P+D}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function w(T){if(T.h!=0)return!1;for(var v=0;v<T.g.length;v++)if(T.g[v]!=0)return!1;return!0}function A(T){return T.h==-1}n.l=function(T){return T=L(this,T),A(T)?-1:w(T)?0:1};function R(T){for(var v=T.g.length,E=[],D=0;D<v;D++)E[D]=~T.g[D];return new o(E,~T.h).add(p)}n.abs=function(){return A(this)?R(this):this},n.add=function(T){for(var v=Math.max(this.g.length,T.g.length),E=[],D=0,x=0;x<=v;x++){var P=D+(this.i(x)&65535)+(T.i(x)&65535),C=(P>>>16)+(this.i(x)>>>16)+(T.i(x)>>>16);D=C>>>16,P&=65535,C&=65535,E[x]=C<<16|P}return new o(E,E[E.length-1]&-2147483648?-1:0)};function L(T,v){return T.add(R(v))}n.j=function(T){if(w(this)||w(T))return h;if(A(this))return A(T)?R(this).j(R(T)):R(R(this).j(T));if(A(T))return R(this.j(R(T)));if(0>this.l(_)&&0>T.l(_))return l(this.m()*T.m());for(var v=this.g.length+T.g.length,E=[],D=0;D<2*v;D++)E[D]=0;for(D=0;D<this.g.length;D++)for(var x=0;x<T.g.length;x++){var P=this.i(D)>>>16,C=this.i(D)&65535,Mi=T.i(x)>>>16,lu=T.i(x)&65535;E[2*D+2*x]+=C*lu,Q(E,2*D+2*x),E[2*D+2*x+1]+=P*lu,Q(E,2*D+2*x+1),E[2*D+2*x+1]+=C*Mi,Q(E,2*D+2*x+1),E[2*D+2*x+2]+=P*Mi,Q(E,2*D+2*x+2)}for(D=0;D<v;D++)E[D]=E[2*D+1]<<16|E[2*D];for(D=v;D<2*v;D++)E[D]=0;return new o(E,0)};function Q(T,v){for(;(T[v]&65535)!=T[v];)T[v+1]+=T[v]>>>16,T[v]&=65535,v++}function B(T,v){this.g=T,this.h=v}function X(T,v){if(w(v))throw Error("division by zero");if(w(T))return new B(h,h);if(A(T))return v=X(R(T),v),new B(R(v.g),R(v.h));if(A(v))return v=X(T,R(v)),new B(R(v.g),v.h);if(30<T.g.length){if(A(T)||A(v))throw Error("slowDivide_ only works with positive integers.");for(var E=p,D=v;0>=D.l(T);)E=le(E),D=le(D);var x=te(E,1),P=te(D,1);for(D=te(D,2),E=te(E,2);!w(D);){var C=P.add(D);0>=C.l(T)&&(x=x.add(E),P=C),D=te(D,1),E=te(E,1)}return v=L(T,x.j(v)),new B(x,v)}for(x=h;0<=T.l(v);){for(E=Math.max(1,Math.floor(T.m()/v.m())),D=Math.ceil(Math.log(E)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),P=l(E),C=P.j(v);A(C)||0<C.l(T);)E-=D,P=l(E),C=P.j(v);w(P)&&(P=p),x=x.add(P),T=L(T,C)}return new B(x,T)}n.A=function(T){return X(this,T).h},n.and=function(T){for(var v=Math.max(this.g.length,T.g.length),E=[],D=0;D<v;D++)E[D]=this.i(D)&T.i(D);return new o(E,this.h&T.h)},n.or=function(T){for(var v=Math.max(this.g.length,T.g.length),E=[],D=0;D<v;D++)E[D]=this.i(D)|T.i(D);return new o(E,this.h|T.h)},n.xor=function(T){for(var v=Math.max(this.g.length,T.g.length),E=[],D=0;D<v;D++)E[D]=this.i(D)^T.i(D);return new o(E,this.h^T.h)};function le(T){for(var v=T.g.length+1,E=[],D=0;D<v;D++)E[D]=T.i(D)<<1|T.i(D-1)>>>31;return new o(E,T.h)}function te(T,v){var E=v>>5;v%=32;for(var D=T.g.length-E,x=[],P=0;P<D;P++)x[P]=0<v?T.i(P+E)>>>v|T.i(P+E+1)<<32-v:T.i(P+E);return new o(x,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,qb=b1.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,Os=b1.Integer=o}).apply(typeof E1<"u"?E1:typeof self<"u"?self:typeof window<"u"?window:{});var bg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Wi={};var zb,Gb,Yc,Wb,Qd,Cg,Kb,Qb,Yb;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,m){return u==Array.prototype||u==Object.prototype||(u[f]=m.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof bg=="object"&&bg];for(var f=0;f<u.length;++f){var m=u[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=t(this);function i(u,f){if(f)e:{var m=r;u=u.split(".");for(var y=0;y<u.length-1;y++){var N=u[y];if(!(N in m))break e;m=m[N]}u=u[u.length-1],y=m[u],f=f(y),f!=y&&f!=null&&e(m,u,{configurable:!0,writable:!0,value:f})}}function s(u,f){u instanceof String&&(u+="");var m=0,y=!1,N={next:function(){if(!y&&m<u.length){var k=m++;return{value:f(k,u[k]),done:!1}}return y=!0,{done:!0,value:void 0}}};return N[Symbol.iterator]=function(){return N},N}i("Array.prototype.values",function(u){return u||function(){return s(this,function(f,m){return m})}});var o=o||{},a=this||self;function c(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function l(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function d(u,f,m){return u.call.apply(u.bind,arguments)}function h(u,f,m){if(!u)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var N=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(N,y),u.apply(f,N)}}return function(){return u.apply(f,arguments)}}function p(u,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function _(u,f){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),u.apply(this,y)}}function w(u,f){function m(){}m.prototype=f.prototype,u.aa=f.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(y,N,k){for(var H=Array(arguments.length-2),Ge=2;Ge<arguments.length;Ge++)H[Ge-2]=arguments[Ge];return f.prototype[N].apply(y,H)}}function A(u){let f=u.length;if(0<f){let m=Array(f);for(let y=0;y<f;y++)m[y]=u[y];return m}return[]}function R(u,f){for(let m=1;m<arguments.length;m++){let y=arguments[m];if(c(y)){let N=u.length||0,k=y.length||0;u.length=N+k;for(let H=0;H<k;H++)u[N+H]=y[H]}else u.push(y)}}class L{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function Q(u){return/^[\s\xa0]*$/.test(u)}function B(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function X(u){return X[" "](u),u}X[" "]=function(){};var le=B().indexOf("Gecko")!=-1&&!(B().toLowerCase().indexOf("webkit")!=-1&&B().indexOf("Edge")==-1)&&!(B().indexOf("Trident")!=-1||B().indexOf("MSIE")!=-1)&&B().indexOf("Edge")==-1;function te(u,f,m){for(let y in u)f.call(m,u[y],y,u)}function T(u,f){for(let m in u)f.call(void 0,u[m],m,u)}function v(u){let f={};for(let m in u)f[m]=u[m];return f}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(u,f){let m,y;for(let N=1;N<arguments.length;N++){y=arguments[N];for(m in y)u[m]=y[m];for(let k=0;k<E.length;k++)m=E[k],Object.prototype.hasOwnProperty.call(y,m)&&(u[m]=y[m])}}function x(u){var f=1;u=u.split(":");let m=[];for(;0<f&&u.length;)m.push(u.shift()),f--;return u.length&&m.push(u.join(":")),m}function P(u){a.setTimeout(()=>{throw u},0)}function C(){var u=Ky;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class Mi{constructor(){this.h=this.g=null}add(f,m){let y=lu.get();y.set(f,m),this.h?this.h.next=y:this.g=y,this.h=y}}var lu=new L(()=>new _j,u=>u.reset());class _j{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let uu,du=!1,Ky=new Mi,nx=()=>{let u=a.Promise.resolve(void 0);uu=()=>{u.then(yj)}};var yj=()=>{for(var u;u=C();){try{u.h.call(u.g)}catch(m){P(m)}var f=lu;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}du=!1};function rs(){this.s=this.s,this.C=this.C}rs.prototype.s=!1,rs.prototype.ma=function(){this.s||(this.s=!0,this.N())},rs.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function en(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}en.prototype.h=function(){this.defaultPrevented=!0};var vj=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return u}();function hu(u,f){if(en.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,y=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(le){e:{try{X(f.nodeName);var N=!0;break e}catch{}N=!1}N||(f=null)}}else m=="mouseover"?f=u.fromElement:m=="mouseout"&&(f=u.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:wj[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&hu.aa.h.call(this)}}w(hu,en);var wj={2:"touch",3:"pen",4:"mouse"};hu.prototype.h=function(){hu.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var fu="closure_listenable_"+(1e6*Math.random()|0),Ij=0;function Ej(u,f,m,y,N){this.listener=u,this.proxy=null,this.src=f,this.type=m,this.capture=!!y,this.ha=N,this.key=++Ij,this.da=this.fa=!1}function Ef(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function bf(u){this.src=u,this.g={},this.h=0}bf.prototype.add=function(u,f,m,y,N){var k=u.toString();u=this.g[k],u||(u=this.g[k]=[],this.h++);var H=Yy(u,f,y,N);return-1<H?(f=u[H],m||(f.fa=!1)):(f=new Ej(f,this.src,k,!!y,N),f.fa=m,u.push(f)),f};function Qy(u,f){var m=f.type;if(m in u.g){var y=u.g[m],N=Array.prototype.indexOf.call(y,f,void 0),k;(k=0<=N)&&Array.prototype.splice.call(y,N,1),k&&(Ef(f),u.g[m].length==0&&(delete u.g[m],u.h--))}}function Yy(u,f,m,y){for(var N=0;N<u.length;++N){var k=u[N];if(!k.da&&k.listener==f&&k.capture==!!m&&k.ha==y)return N}return-1}var Jy="closure_lm_"+(1e6*Math.random()|0),Xy={};function rx(u,f,m,y,N){if(y&&y.once)return sx(u,f,m,y,N);if(Array.isArray(f)){for(var k=0;k<f.length;k++)rx(u,f[k],m,y,N);return null}return m=nv(m),u&&u[fu]?u.K(f,m,l(y)?!!y.capture:!!y,N):ix(u,f,m,!1,y,N)}function ix(u,f,m,y,N,k){if(!f)throw Error("Invalid event type");var H=l(N)?!!N.capture:!!N,Ge=ev(u);if(Ge||(u[Jy]=Ge=new bf(u)),m=Ge.add(f,m,y,H,k),m.proxy)return m;if(y=bj(),m.proxy=y,y.src=u,y.listener=m,u.addEventListener)vj||(N=H),N===void 0&&(N=!1),u.addEventListener(f.toString(),y,N);else if(u.attachEvent)u.attachEvent(ax(f.toString()),y);else if(u.addListener&&u.removeListener)u.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function bj(){function u(m){return f.call(u.src,u.listener,m)}let f=Cj;return u}function sx(u,f,m,y,N){if(Array.isArray(f)){for(var k=0;k<f.length;k++)sx(u,f[k],m,y,N);return null}return m=nv(m),u&&u[fu]?u.L(f,m,l(y)?!!y.capture:!!y,N):ix(u,f,m,!0,y,N)}function ox(u,f,m,y,N){if(Array.isArray(f))for(var k=0;k<f.length;k++)ox(u,f[k],m,y,N);else y=l(y)?!!y.capture:!!y,m=nv(m),u&&u[fu]?(u=u.i,f=String(f).toString(),f in u.g&&(k=u.g[f],m=Yy(k,m,y,N),-1<m&&(Ef(k[m]),Array.prototype.splice.call(k,m,1),k.length==0&&(delete u.g[f],u.h--)))):u&&(u=ev(u))&&(f=u.g[f.toString()],u=-1,f&&(u=Yy(f,m,y,N)),(m=-1<u?f[u]:null)&&Zy(m))}function Zy(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[fu])Qy(f.i,u);else{var m=u.type,y=u.proxy;f.removeEventListener?f.removeEventListener(m,y,u.capture):f.detachEvent?f.detachEvent(ax(m),y):f.addListener&&f.removeListener&&f.removeListener(y),(m=ev(f))?(Qy(m,u),m.h==0&&(m.src=null,f[Jy]=null)):Ef(u)}}}function ax(u){return u in Xy?Xy[u]:Xy[u]="on"+u}function Cj(u,f){if(u.da)u=!0;else{f=new hu(f,this);var m=u.listener,y=u.ha||u.src;u.fa&&Zy(u),u=m.call(y,f)}return u}function ev(u){return u=u[Jy],u instanceof bf?u:null}var tv="__closure_events_fn_"+(1e9*Math.random()>>>0);function nv(u){return typeof u=="function"?u:(u[tv]||(u[tv]=function(f){return u.handleEvent(f)}),u[tv])}function tn(){rs.call(this),this.i=new bf(this),this.M=this,this.F=null}w(tn,rs),tn.prototype[fu]=!0,tn.prototype.removeEventListener=function(u,f,m,y){ox(this,u,f,m,y)};function mn(u,f){var m,y=u.F;if(y)for(m=[];y;y=y.F)m.push(y);if(u=u.M,y=f.type||f,typeof f=="string")f=new en(f,u);else if(f instanceof en)f.target=f.target||u;else{var N=f;f=new en(y,u),D(f,N)}if(N=!0,m)for(var k=m.length-1;0<=k;k--){var H=f.g=m[k];N=Cf(H,y,!0,f)&&N}if(H=f.g=u,N=Cf(H,y,!0,f)&&N,N=Cf(H,y,!1,f)&&N,m)for(k=0;k<m.length;k++)H=f.g=m[k],N=Cf(H,y,!1,f)&&N}tn.prototype.N=function(){if(tn.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var m=u.g[f],y=0;y<m.length;y++)Ef(m[y]);delete u.g[f],u.h--}}this.F=null},tn.prototype.K=function(u,f,m,y){return this.i.add(String(u),f,!1,m,y)},tn.prototype.L=function(u,f,m,y){return this.i.add(String(u),f,!0,m,y)};function Cf(u,f,m,y){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var N=!0,k=0;k<f.length;++k){var H=f[k];if(H&&!H.da&&H.capture==m){var Ge=H.listener,Qt=H.ha||H.src;H.fa&&Qy(u.i,H),N=Ge.call(Qt,y)!==!1&&N}}return N&&!y.defaultPrevented}function cx(u,f,m){if(typeof u=="function")m&&(u=p(u,m));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function lx(u){u.g=cx(()=>{u.g=null,u.i&&(u.i=!1,lx(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class Tj extends rs{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:lx(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pu(u){rs.call(this),this.h=u,this.g={}}w(pu,rs);var ux=[];function dx(u){te(u.g,function(f,m){this.g.hasOwnProperty(m)&&Zy(f)},u),u.g={}}pu.prototype.N=function(){pu.aa.N.call(this),dx(this)},pu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rv=a.JSON.stringify,Sj=a.JSON.parse,Dj=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function iv(){}iv.prototype.h=null;function hx(u){return u.h||(u.h=u.i())}function fx(){}var mu={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function sv(){en.call(this,"d")}w(sv,en);function ov(){en.call(this,"c")}w(ov,en);var fo={},px=null;function Tf(){return px=px||new tn}fo.La="serverreachability";function mx(u){en.call(this,fo.La,u)}w(mx,en);function gu(u){let f=Tf();mn(f,new mx(f))}fo.STAT_EVENT="statevent";function gx(u,f){en.call(this,fo.STAT_EVENT,u),this.stat=f}w(gx,en);function gn(u){let f=Tf();mn(f,new gx(f,u))}fo.Ma="timingevent";function _x(u,f){en.call(this,fo.Ma,u),this.size=f}w(_x,en);function _u(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function yu(){this.g=!0}yu.prototype.xa=function(){this.g=!1};function Aj(u,f,m,y,N,k){u.info(function(){if(u.g)if(k)for(var H="",Ge=k.split("&"),Qt=0;Qt<Ge.length;Qt++){var Fe=Ge[Qt].split("=");if(1<Fe.length){var nn=Fe[0];Fe=Fe[1];var rn=nn.split("_");H=2<=rn.length&&rn[1]=="type"?H+(nn+"="+Fe+"&"):H+(nn+"=redacted&")}}else H=null;else H=k;return"XMLHTTP REQ ("+y+") [attempt "+N+"]: "+f+`
`+m+`
`+H})}function xj(u,f,m,y,N,k,H){u.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+N+"]: "+f+`
`+m+`
`+k+" "+H})}function $a(u,f,m,y){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+Nj(u,m)+(y?" "+y:"")})}function Rj(u,f){u.info(function(){return"TIMEOUT: "+f})}yu.prototype.info=function(){};function Nj(u,f){if(!u.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var y=m[u];if(!(2>y.length)){var N=y[1];if(Array.isArray(N)&&!(1>N.length)){var k=N[0];if(k!="noop"&&k!="stop"&&k!="close")for(var H=1;H<N.length;H++)N[H]=""}}}}return rv(m)}catch{return f}}var Sf={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},yx={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},av;function Df(){}w(Df,iv),Df.prototype.g=function(){return new XMLHttpRequest},Df.prototype.i=function(){return{}},av=new Df;function is(u,f,m,y){this.j=u,this.i=f,this.l=m,this.R=y||1,this.U=new pu(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new vx}function vx(){this.i=null,this.g="",this.h=!1}var wx={},cv={};function lv(u,f,m){u.L=1,u.v=Nf(ki(f)),u.m=m,u.P=!0,Ix(u,null)}function Ix(u,f){u.F=Date.now(),Af(u),u.A=ki(u.v);var m=u.A,y=u.R;Array.isArray(y)||(y=[String(y)]),Ox(m.i,"t",y),u.C=0,m=u.j.J,u.h=new vx,u.g=Zx(u.j,m?f:null,!u.m),0<u.O&&(u.M=new Tj(p(u.Y,u,u.g),u.O)),f=u.U,m=u.g,y=u.ca;var N="readystatechange";Array.isArray(N)||(N&&(ux[0]=N.toString()),N=ux);for(var k=0;k<N.length;k++){var H=rx(m,N[k],y||f.handleEvent,!1,f.h||f);if(!H)break;f.g[H.key]=H}f=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),gu(),Aj(u.i,u.u,u.A,u.l,u.R,u.m)}is.prototype.ca=function(u){u=u.target;let f=this.M;f&&Oi(u)==3?f.j():this.Y(u)},is.prototype.Y=function(u){try{if(u==this.g)e:{let rn=Oi(this.g);var f=this.g.Ba();let za=this.g.Z();if(!(3>rn)&&(rn!=3||this.g&&(this.h.h||this.g.oa()||$x(this.g)))){this.J||rn!=4||f==7||(f==8||0>=za?gu(3):gu(2)),uv(this);var m=this.g.Z();this.X=m;t:if(Ex(this)){var y=$x(this.g);u="";var N=y.length,k=Oi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){po(this),vu(this);var H="";break t}this.h.i=new a.TextDecoder}for(f=0;f<N;f++)this.h.h=!0,u+=this.h.i.decode(y[f],{stream:!(k&&f==N-1)});y.length=0,this.h.g+=u,this.C=0,H=this.h.g}else H=this.g.oa();if(this.o=m==200,xj(this.i,this.u,this.A,this.l,this.R,rn,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Ge,Qt=this.g;if((Ge=Qt.g?Qt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(Ge)){var Fe=Ge;break t}}Fe=null}if(m=Fe)$a(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,dv(this,m);else{this.o=!1,this.s=3,gn(12),po(this),vu(this);break e}}if(this.P){m=!0;let br;for(;!this.J&&this.C<H.length;)if(br=Pj(this,H),br==cv){rn==4&&(this.s=4,gn(14),m=!1),$a(this.i,this.l,null,"[Incomplete Response]");break}else if(br==wx){this.s=4,gn(15),$a(this.i,this.l,H,"[Invalid Chunk]"),m=!1;break}else $a(this.i,this.l,br,null),dv(this,br);if(Ex(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),rn!=4||H.length!=0||this.h.h||(this.s=1,gn(16),m=!1),this.o=this.o&&m,!m)$a(this.i,this.l,H,"[Invalid Chunked Response]"),po(this),vu(this);else if(0<H.length&&!this.W){this.W=!0;var nn=this.j;nn.g==this&&nn.ba&&!nn.M&&(nn.j.info("Great, no buffering proxy detected. Bytes received: "+H.length),_v(nn),nn.M=!0,gn(11))}}else $a(this.i,this.l,H,null),dv(this,H);rn==4&&po(this),this.o&&!this.J&&(rn==4?Qx(this.j,this):(this.o=!1,Af(this)))}else Qj(this.g),m==400&&0<H.indexOf("Unknown SID")?(this.s=3,gn(12)):(this.s=0,gn(13)),po(this),vu(this)}}}catch{}finally{}};function Ex(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Pj(u,f){var m=u.C,y=f.indexOf(`
`,m);return y==-1?cv:(m=Number(f.substring(m,y)),isNaN(m)?wx:(y+=1,y+m>f.length?cv:(f=f.slice(y,y+m),u.C=y+m,f)))}is.prototype.cancel=function(){this.J=!0,po(this)};function Af(u){u.S=Date.now()+u.I,bx(u,u.I)}function bx(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=_u(p(u.ba,u),f)}function uv(u){u.B&&(a.clearTimeout(u.B),u.B=null)}is.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(Rj(this.i,this.A),this.L!=2&&(gu(),gn(17)),po(this),this.s=2,vu(this)):bx(this,this.S-u)};function vu(u){u.j.G==0||u.J||Qx(u.j,u)}function po(u){uv(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,dx(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function dv(u,f){try{var m=u.j;if(m.G!=0&&(m.g==u||hv(m.h,u))){if(!u.K&&hv(m.h,u)&&m.G==3){try{var y=m.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var N=y;if(N[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)Ff(m),kf(m);else break e;gv(m),gn(18)}}else m.za=N[1],0<m.za-m.T&&37500>N[2]&&m.F&&m.v==0&&!m.C&&(m.C=_u(p(m.Za,m),6e3));if(1>=Sx(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else go(m,11)}else if((u.K||m.g==u)&&Ff(m),!Q(f))for(N=m.Da.g.parse(f),f=0;f<N.length;f++){let Fe=N[f];if(m.T=Fe[0],Fe=Fe[1],m.G==2)if(Fe[0]=="c"){m.K=Fe[1],m.ia=Fe[2];let nn=Fe[3];nn!=null&&(m.la=nn,m.j.info("VER="+m.la));let rn=Fe[4];rn!=null&&(m.Aa=rn,m.j.info("SVER="+m.Aa));let za=Fe[5];za!=null&&typeof za=="number"&&0<za&&(y=1.5*za,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;let br=u.g;if(br){let Vf=br.g?br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vf){var k=y.h;k.g||Vf.indexOf("spdy")==-1&&Vf.indexOf("quic")==-1&&Vf.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(fv(k,k.h),k.h=null))}if(y.D){let yv=br.g?br.g.getResponseHeader("X-HTTP-Session-Id"):null;yv&&(y.ya=yv,tt(y.I,y.D,yv))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var H=u;if(y.qa=Xx(y,y.J?y.ia:null,y.W),H.K){Dx(y.h,H);var Ge=H,Qt=y.L;Qt&&(Ge.I=Qt),Ge.B&&(uv(Ge),Af(Ge)),y.g=H}else Wx(y);0<m.i.length&&Of(m)}else Fe[0]!="stop"&&Fe[0]!="close"||go(m,7);else m.G==3&&(Fe[0]=="stop"||Fe[0]=="close"?Fe[0]=="stop"?go(m,7):mv(m):Fe[0]!="noop"&&m.l&&m.l.ta(Fe),m.v=0)}}gu(4)}catch{}}var Mj=class{constructor(u,f){this.g=u,this.map=f}};function Cx(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tx(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Sx(u){return u.h?1:u.g?u.g.size:0}function hv(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function fv(u,f){u.g?u.g.add(f):u.h=f}function Dx(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}Cx.prototype.cancel=function(){if(this.i=Ax(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function Ax(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let m of u.g.values())f=f.concat(m.D);return f}return A(u.i)}function kj(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var f=[],m=u.length,y=0;y<m;y++)f.push(u[y]);return f}f=[],m=0;for(y in u)f[m++]=u[y];return f}function Oj(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var f=[];u=u.length;for(var m=0;m<u;m++)f.push(m);return f}f=[],m=0;for(let y in u)f[m++]=y;return f}}}function xx(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var m=Oj(u),y=kj(u),N=y.length,k=0;k<N;k++)f.call(void 0,y[k],m&&m[k],u)}var Rx=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fj(u,f){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var y=u[m].indexOf("="),N=null;if(0<=y){var k=u[m].substring(0,y);N=u[m].substring(y+1)}else k=u[m];f(k,N?decodeURIComponent(N.replace(/\+/g," ")):"")}}}function mo(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof mo){this.h=u.h,xf(this,u.j),this.o=u.o,this.g=u.g,Rf(this,u.s),this.l=u.l;var f=u.i,m=new Eu;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),Nx(this,m),this.m=u.m}else u&&(f=String(u).match(Rx))?(this.h=!1,xf(this,f[1]||"",!0),this.o=wu(f[2]||""),this.g=wu(f[3]||"",!0),Rf(this,f[4]),this.l=wu(f[5]||"",!0),Nx(this,f[6]||"",!0),this.m=wu(f[7]||"")):(this.h=!1,this.i=new Eu(null,this.h))}mo.prototype.toString=function(){var u=[],f=this.j;f&&u.push(Iu(f,Px,!0),":");var m=this.g;return(m||f=="file")&&(u.push("//"),(f=this.o)&&u.push(Iu(f,Px,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(Iu(m,m.charAt(0)=="/"?Uj:Vj,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",Iu(m,jj)),u.join("")};function ki(u){return new mo(u)}function xf(u,f,m){u.j=m?wu(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function Rf(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function Nx(u,f,m){f instanceof Eu?(u.i=f,$j(u.i,u.h)):(m||(f=Iu(f,Bj)),u.i=new Eu(f,u.h))}function tt(u,f,m){u.i.set(f,m)}function Nf(u){return tt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function wu(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Iu(u,f,m){return typeof u=="string"?(u=encodeURI(u).replace(f,Lj),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Lj(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Px=/[#\/\?@]/g,Vj=/[#\?:]/g,Uj=/[#\?]/g,Bj=/[#\?@]/g,jj=/#/g;function Eu(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function ss(u){u.g||(u.g=new Map,u.h=0,u.i&&Fj(u.i,function(f,m){u.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=Eu.prototype,n.add=function(u,f){ss(this),this.i=null,u=Ha(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(f),this.h+=1,this};function Mx(u,f){ss(u),f=Ha(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function kx(u,f){return ss(u),f=Ha(u,f),u.g.has(f)}n.forEach=function(u,f){ss(this),this.g.forEach(function(m,y){m.forEach(function(N){u.call(f,N,y,this)},this)},this)},n.na=function(){ss(this);let u=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let y=0;y<f.length;y++){let N=u[y];for(let k=0;k<N.length;k++)m.push(f[y])}return m},n.V=function(u){ss(this);let f=[];if(typeof u=="string")kx(this,u)&&(f=f.concat(this.g.get(Ha(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)f=f.concat(u[m])}return f},n.set=function(u,f){return ss(this),this.i=null,u=Ha(this,u),kx(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function Ox(u,f,m){Mx(u,f),0<m.length&&(u.i=null,u.g.set(Ha(u,f),A(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var y=f[m];let k=encodeURIComponent(String(y)),H=this.V(y);for(y=0;y<H.length;y++){var N=k;H[y]!==""&&(N+="="+encodeURIComponent(String(H[y]))),u.push(N)}}return this.i=u.join("&")};function Ha(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function $j(u,f){f&&!u.j&&(ss(u),u.i=null,u.g.forEach(function(m,y){var N=y.toLowerCase();y!=N&&(Mx(this,y),Ox(this,N,m))},u)),u.j=f}function Hj(u,f){let m=new yu;if(a.Image){let y=new Image;y.onload=_(os,m,"TestLoadImage: loaded",!0,f,y),y.onerror=_(os,m,"TestLoadImage: error",!1,f,y),y.onabort=_(os,m,"TestLoadImage: abort",!1,f,y),y.ontimeout=_(os,m,"TestLoadImage: timeout",!1,f,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=u}else f(!1)}function qj(u,f){let m=new yu,y=new AbortController,N=setTimeout(()=>{y.abort(),os(m,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:y.signal}).then(k=>{clearTimeout(N),k.ok?os(m,"TestPingServer: ok",!0,f):os(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(N),os(m,"TestPingServer: error",!1,f)})}function os(u,f,m,y,N){try{N&&(N.onload=null,N.onerror=null,N.onabort=null,N.ontimeout=null),y(m)}catch{}}function zj(){this.g=new Dj}function Gj(u,f,m){let y=m||"";try{xx(u,function(N,k){let H=N;l(N)&&(H=rv(N)),f.push(y+k+"="+encodeURIComponent(H))})}catch(N){throw f.push(y+"type="+encodeURIComponent("_badmap")),N}}function bu(u){this.l=u.Ub||null,this.j=u.eb||!1}w(bu,iv),bu.prototype.g=function(){return new Pf(this.l,this.j)},bu.prototype.i=function(u){return function(){return u}}({});function Pf(u,f){tn.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Pf,tn),n=Pf.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,Tu(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Cu(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Tu(this)),this.g&&(this.readyState=3,Tu(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Fx(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Fx(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?Cu(this):Tu(this),this.readyState==3&&Fx(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Cu(this))},n.Qa=function(u){this.g&&(this.response=u,Cu(this))},n.ga=function(){this.g&&Cu(this)};function Cu(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Tu(u)}n.setRequestHeader=function(u,f){this.u.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=f.next();return u.join(`\r
`)};function Tu(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Pf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Lx(u){let f="";return te(u,function(m,y){f+=y,f+=":",f+=m,f+=`\r
`}),f}function pv(u,f,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=Lx(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):tt(u,f,m))}function gt(u){tn.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(gt,tn);var Wj=/^https?$/i,Kj=["POST","PUT"];n=gt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,f,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():av.g(),this.v=this.o?hx(this.o):hx(av),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(k){Vx(this,k);return}if(u=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var N in y)m.set(N,y[N]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let k of y.keys())m.set(k,y.get(k));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(k=>k.toLowerCase()=="content-type"),N=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Kj,f,void 0))||y||N||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[k,H]of m)this.g.setRequestHeader(k,H);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{jx(this),this.u=!0,this.g.send(u),this.u=!1}catch(k){Vx(this,k)}};function Vx(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,Ux(u),Mf(u)}function Ux(u){u.A||(u.A=!0,mn(u,"complete"),mn(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,mn(this,"complete"),mn(this,"abort"),Mf(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mf(this,!0)),gt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Bx(this):this.bb())},n.bb=function(){Bx(this)};function Bx(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Oi(u)!=4||u.Z()!=2)){if(u.u&&Oi(u)==4)cx(u.Ea,0,u);else if(mn(u,"readystatechange"),Oi(u)==4){u.h=!1;try{let H=u.Z();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var y;if(y=H===0){var N=String(u.D).match(Rx)[1]||null;!N&&a.self&&a.self.location&&(N=a.self.location.protocol.slice(0,-1)),y=!Wj.test(N?N.toLowerCase():"")}m=y}if(m)mn(u,"complete"),mn(u,"success");else{u.m=6;try{var k=2<Oi(u)?u.g.statusText:""}catch{k=""}u.l=k+" ["+u.Z()+"]",Ux(u)}}finally{Mf(u)}}}}function Mf(u,f){if(u.g){jx(u);let m=u.g,y=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||mn(u,"ready");try{m.onreadystatechange=y}catch{}}}function jx(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Oi(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Oi(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),Sj(f)}};function $x(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Qj(u){let f={};u=(u.g&&2<=Oi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<u.length;y++){if(Q(u[y]))continue;var m=x(u[y]);let N=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let k=f[N]||[];f[N]=k,k.push(m)}T(f,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Su(u,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||f}function Hx(u){this.Aa=0,this.i=[],this.j=new yu,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Su("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Su("baseRetryDelayMs",5e3,u),this.cb=Su("retryDelaySeedMs",1e4,u),this.Wa=Su("forwardChannelMaxRetries",2,u),this.wa=Su("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Cx(u&&u.concurrentRequestLimit),this.Da=new zj,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Hx.prototype,n.la=8,n.G=1,n.connect=function(u,f,m,y){gn(0),this.W=u,this.H=f||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=Xx(this,null,this.W),Of(this)};function mv(u){if(qx(u),u.G==3){var f=u.U++,m=ki(u.I);if(tt(m,"SID",u.K),tt(m,"RID",f),tt(m,"TYPE","terminate"),Du(u,m),f=new is(u,u.j,f),f.L=2,f.v=Nf(ki(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=Zx(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Af(f)}Jx(u)}function kf(u){u.g&&(_v(u),u.g.cancel(),u.g=null)}function qx(u){kf(u),u.u&&(a.clearTimeout(u.u),u.u=null),Ff(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Of(u){if(!Tx(u.h)&&!u.s){u.s=!0;var f=u.Ga;uu||nx(),du||(uu(),du=!0),Ky.add(f,u),u.B=0}}function Yj(u,f){return Sx(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=_u(p(u.Ga,u,f),Yx(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let N=new is(this,this.j,u),k=this.o;if(this.S&&(k?(k=v(k),D(k,this.S)):k=this.S),this.m!==null||this.O||(N.H=k,k=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=Gx(this,N,f),m=ki(this.I),tt(m,"RID",u),tt(m,"CVER",22),this.D&&tt(m,"X-HTTP-Session-Id",this.D),Du(this,m),k&&(this.O?f="headers="+encodeURIComponent(String(Lx(k)))+"&"+f:this.m&&pv(m,this.m,k)),fv(this.h,N),this.Ua&&tt(m,"TYPE","init"),this.P?(tt(m,"$req",f),tt(m,"SID","null"),N.T=!0,lv(N,m,null)):lv(N,m,f),this.G=2}}else this.G==3&&(u?zx(this,u):this.i.length==0||Tx(this.h)||zx(this))};function zx(u,f){var m;f?m=f.l:m=u.U++;let y=ki(u.I);tt(y,"SID",u.K),tt(y,"RID",m),tt(y,"AID",u.T),Du(u,y),u.m&&u.o&&pv(y,u.m,u.o),m=new is(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),f&&(u.i=f.D.concat(u.i)),f=Gx(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),fv(u.h,m),lv(m,y,f)}function Du(u,f){u.H&&te(u.H,function(m,y){tt(f,y,m)}),u.l&&xx({},function(m,y){tt(f,y,m)})}function Gx(u,f,m){m=Math.min(u.i.length,m);var y=u.l?p(u.l.Na,u.l,u):null;e:{var N=u.i;let k=-1;for(;;){let H=["count="+m];k==-1?0<m?(k=N[0].g,H.push("ofs="+k)):k=0:H.push("ofs="+k);let Ge=!0;for(let Qt=0;Qt<m;Qt++){let Fe=N[Qt].g,nn=N[Qt].map;if(Fe-=k,0>Fe)k=Math.max(0,N[Qt].g-100),Ge=!1;else try{Gj(nn,H,"req"+Fe+"_")}catch{y&&y(nn)}}if(Ge){y=H.join("&");break e}}}return u=u.i.splice(0,m),f.D=u,y}function Wx(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;uu||nx(),du||(uu(),du=!0),Ky.add(f,u),u.v=0}}function gv(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=_u(p(u.Fa,u),Yx(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Kx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=_u(p(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gn(10),kf(this),Kx(this))};function _v(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Kx(u){u.g=new is(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=ki(u.qa);tt(f,"RID","rpc"),tt(f,"SID",u.K),tt(f,"AID",u.T),tt(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&tt(f,"TO",u.ja),tt(f,"TYPE","xmlhttp"),Du(u,f),u.m&&u.o&&pv(f,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=Nf(ki(f)),m.m=null,m.P=!0,Ix(m,u)}n.Za=function(){this.C!=null&&(this.C=null,kf(this),gv(this),gn(19))};function Ff(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Qx(u,f){var m=null;if(u.g==f){Ff(u),_v(u),u.g=null;var y=2}else if(hv(u.h,f))m=f.D,Dx(u.h,f),y=1;else return;if(u.G!=0){if(f.o)if(y==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var N=u.B;y=Tf(),mn(y,new _x(y,m)),Of(u)}else Wx(u);else if(N=f.s,N==3||N==0&&0<f.X||!(y==1&&Yj(u,f)||y==2&&gv(u)))switch(m&&0<m.length&&(f=u.h,f.i=f.i.concat(m)),N){case 1:go(u,5);break;case 4:go(u,10);break;case 3:go(u,6);break;default:go(u,2)}}}function Yx(u,f){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*f}function go(u,f){if(u.j.info("Error code "+f),f==2){var m=p(u.fb,u),y=u.Xa;let N=!y;y=new mo(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||xf(y,"https"),Nf(y),N?Hj(y.toString(),m):qj(y.toString(),m)}else gn(2);u.G=0,u.l&&u.l.sa(f),Jx(u),qx(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),gn(2)):(this.j.info("Failed to ping google.com"),gn(1))};function Jx(u){if(u.G=0,u.ka=[],u.l){let f=Ax(u.h);(f.length!=0||u.i.length!=0)&&(R(u.ka,f),R(u.ka,u.i),u.h.i.length=0,A(u.i),u.i.length=0),u.l.ra()}}function Xx(u,f,m){var y=m instanceof mo?ki(m):new mo(m);if(y.g!="")f&&(y.g=f+"."+y.g),Rf(y,y.s);else{var N=a.location;y=N.protocol,f=f?f+"."+N.hostname:N.hostname,N=+N.port;var k=new mo(null);y&&xf(k,y),f&&(k.g=f),N&&Rf(k,N),m&&(k.l=m),y=k}return m=u.D,f=u.ya,m&&f&&tt(y,m,f),tt(y,"VER",u.la),Du(u,y),y}function Zx(u,f,m){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new gt(new bu({eb:m})):new gt(u.pa),f.Ha(u.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function eR(){}n=eR.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Lf(){}Lf.prototype.g=function(u,f){return new jn(u,f)};function jn(u,f){tn.call(this),this.g=new Hx(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!Q(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!Q(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new qa(this)}w(jn,tn),jn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},jn.prototype.close=function(){mv(this.g)},jn.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=rv(u),u=m);f.i.push(new Mj(f.Ya++,u)),f.G==3&&Of(f)},jn.prototype.N=function(){this.g.l=null,delete this.j,mv(this.g),delete this.g,jn.aa.N.call(this)};function tR(u){sv.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(let m in f){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}w(tR,sv);function nR(){ov.call(this),this.status=1}w(nR,ov);function qa(u){this.g=u}w(qa,eR),qa.prototype.ua=function(){mn(this.g,"a")},qa.prototype.ta=function(u){mn(this.g,new tR(u))},qa.prototype.sa=function(u){mn(this.g,new nR)},qa.prototype.ra=function(){mn(this.g,"b")},Lf.prototype.createWebChannel=Lf.prototype.g,jn.prototype.send=jn.prototype.o,jn.prototype.open=jn.prototype.m,jn.prototype.close=jn.prototype.close,Yb=Wi.createWebChannelTransport=function(){return new Lf},Qb=Wi.getStatEventTarget=function(){return Tf()},Kb=Wi.Event=fo,Cg=Wi.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Sf.NO_ERROR=0,Sf.TIMEOUT=8,Sf.HTTP_ERROR=6,Qd=Wi.ErrorCode=Sf,yx.COMPLETE="complete",Wb=Wi.EventType=yx,fx.EventType=mu,mu.OPEN="a",mu.CLOSE="b",mu.ERROR="c",mu.MESSAGE="d",tn.prototype.listen=tn.prototype.K,Yc=Wi.WebChannel=fx,Gb=Wi.FetchXmlHttpFactory=bu,gt.prototype.listenOnce=gt.prototype.L,gt.prototype.getLastError=gt.prototype.Ka,gt.prototype.getLastErrorCode=gt.prototype.Ba,gt.prototype.getStatus=gt.prototype.Z,gt.prototype.getResponseJson=gt.prototype.Oa,gt.prototype.getResponseText=gt.prototype.oa,gt.prototype.send=gt.prototype.ea,gt.prototype.setWithCredentials=gt.prototype.Ha,zb=Wi.XhrIo=gt}).apply(typeof bg<"u"?bg:typeof self<"u"?self:typeof window<"u"?window:{});var C1="@firebase/firestore";var Ot=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ot.UNAUTHENTICATED=new Ot(null),Ot.GOOGLE_CREDENTIALS=new Ot("google-credentials-uid"),Ot.FIRST_PARTY=new Ot("first-party-uid"),Ot.MOCK_USER=new Ot("mock-user");var Sl="10.12.1";var Hs=new Ln("@firebase/firestore");function tl(){return Hs.logLevel}function TF(n){Hs.setLogLevel(n)}function V(n,...e){if(Hs.logLevel<=ye.DEBUG){let t=e.map(nS);Hs.debug(`Firestore (${Sl}): ${n}`,...t)}}function Ct(n,...e){if(Hs.logLevel<=ye.ERROR){let t=e.map(nS);Hs.error(`Firestore (${Sl}): ${n}`,...t)}}function _r(n,...e){if(Hs.logLevel<=ye.WARN){let t=e.map(nS);Hs.warn(`Firestore (${Sl}): ${n}`,...t)}}function nS(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function Z(n="Unexpected state"){let e=`FIRESTORE (${Sl}) INTERNAL ASSERTION FAILED: `+n;throw Ct(e),new Error(e)}function ne(n,e){n||Z()}function SF(n,e){n||Z()}function W(n,e){return n}var O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},F=class extends _t{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Tt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Og=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},tC=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ot.UNAUTHENTICATED))}shutdown(){}},nC=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},rC=class{constructor(e){this.t=e,this.currentUser=Ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Tt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Tt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Tt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ne(typeof r.accessToken=="string"),new Og(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return ne(e===null||typeof e=="string"),new Ot(e)}},iC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Ot.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},sC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new iC(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}},oC=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},aC=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,V("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ne(typeof t.token=="string"),this.R=t.token,new oC(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function vK(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Fg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=vK(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function pe(n,e){return n<e?-1:n>e?1:0}function ll(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function DF(n){return n+"\0"}var ft=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new F(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?pe(this.nanoseconds,e.nanoseconds):pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var se=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new ft(0,0))}static max(){return new n(new ft(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Lg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&Z(),r===void 0?r=e.length-t:r>e.length-t&&Z(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ke=class n extends Lg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new F(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},wK=/^[_a-zA-Z][_a-zA-Z0-9]*$/,St=class n extends Lg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return wK.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new F(O.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new F(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new F(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new F(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var K=class n{constructor(e){this.path=e}static fromPath(e){return new n(ke.fromString(e))}static fromName(e){return new n(ke.fromString(e).popFirst(5))}static empty(){return new n(ke.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ke.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ke.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ke(e.slice()))}};var ul=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function cC(n){return n.fields.find(e=>e.kind===2)}function ia(n){return n.fields.filter(e=>e.kind!==2)}ul.UNKNOWN_ID=-1;var ol=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var ah=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,yr.min())}};function AF(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=se.fromTimestamp(r===1e9?new ft(t+1,0):new ft(t,r));return new yr(i,K.empty(),e)}function xF(n){return new yr(n.readTime,n.key,-1)}var yr=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(se.min(),K.empty(),-1)}static max(){return new n(se.max(),K.empty(),-1)}};function rS(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=K.comparator(n.documentKey,e.documentKey),t!==0?t:pe(n.largestBatchId,e.largestBatchId))}var RF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Vg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Zs(n){return g(this,null,function*(){if(n.code!==O.FAILED_PRECONDITION||n.message!==RF)throw n;V("LocalStore","Unexpectedly lost primary lease")})}var M=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Z(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var Ug=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Tt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ua(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=iS(r.target.error);this.V.reject(new ua(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new ua(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(V("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new uC(t)}},qs=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(Ke())===12.2&&Ct("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return V("SimpleDb","Removing database:",e),sa(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Cs())return!1;if(n.C())return!0;let e=Ke(),t=n.S(e),r=0<t&&t<10,i=NF(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return g(this,null,function*(){return this.db||(V("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new ua(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new F(O.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new F(O.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ua(e,o))},i.onupgradeneeded=s=>{V("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{V("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return g(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=Ug.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),M.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(V("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function NF(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var lC=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return sa(this.B.delete())}},ua=class extends F{constructor(e,t){super(O.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function eo(n){return n.name==="IndexedDbTransactionError"}var uC=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(V("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(V("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),sa(r)}add(e){return V("SimpleDb","ADD",this.store.name,e,e),sa(this.store.add(e))}get(e){return sa(this.store.get(e)).next(t=>(t===void 0&&(t=null),V("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return V("SimpleDb","DELETE",this.store.name,e),sa(this.store.delete(e))}count(){return V("SimpleDb","COUNT",this.store.name),sa(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new M((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new M((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){V("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new M((r,i)=>{t.onerror=s=>{let o=iS(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new M((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new lC(a),l=t(a.primaryKey,a.value,c);if(l instanceof M){let d=l.catch(h=>(c.done(),M.reject(h)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>M.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function sa(n){return new M((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=iS(r.target.error);t(i)}})}var T1=!1;function iS(n){let e=qs.S(Ke());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new F("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return T1||(T1=!0,setTimeout(()=>{throw r},0)),r}}return n}var dC=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){V("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{V("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){eo(t)?V("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield Zs(t)}yield this.X(6e4)}))}},hC=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return M.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return V("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(V("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=xF(s);rS(o,r)>0&&(r=o)}),new yr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Qn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function xh(n){return n==null}function ch(n){return n===0&&1/n==-1/0}function PF(n){return typeof n=="number"&&Number.isInteger(n)&&!ch(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function En(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=S1(e)),e=IK(n.get(t),e);return S1(e)}function IK(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function S1(n){return n+""}function mi(n){let e=n.length;if(ne(e>=2),e===2)return ne(n.charAt(0)===""&&n.charAt(1)===""),ke.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&Z(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:Z()}s=o+2}return new ke(r)}var D1=["userId","batchId"];function xg(n,e){return[n,En(e)]}function MF(n,e,t){return[n,En(e),t]}var EK={},bK=["prefixPath","collectionGroup","readTime","documentId"],CK=["prefixPath","collectionGroup","documentId"],TK=["collectionGroup","readTime","prefixPath","documentId"],SK=["canonicalId","targetId"],DK=["targetId","path"],AK=["path","targetId"],xK=["collectionId","parent"],RK=["indexId","uid"],NK=["uid","sequenceNumber"],PK=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],MK=["indexId","uid","orderedDocumentKey"],kK=["userId","collectionPath","documentId"],OK=["userId","collectionPath","largestBatchId"],FK=["userId","collectionGroup","largestBatchId"],kF=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],LK=[...kF,"documentOverlays"],OF=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],FF=OF,LF=[...FF,"indexConfiguration","indexState","indexEntries"],VK=LF;var lh=class extends Vg{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Gt(n,e){let t=W(n);return qs.F(t._e,e)}function A1(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ea(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function UK(n,e){let t=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function VF(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var rt=class n{constructor(e,t){this.comparator=e,this.root=t||_i.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_i.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_i.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sl(this.root,e,this.comparator,!1)}getReverseIterator(){return new sl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sl(this.root,e,this.comparator,!0)}},sl=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},_i=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Z();let e=this.left.check();if(e!==this.right.check())throw Z();return e+(this.isRed()?0:1)}};_i.EMPTY=null,_i.RED=!0,_i.BLACK=!1;_i.EMPTY=new class{constructor(){this.size=0}get key(){throw Z()}get value(){throw Z()}get color(){throw Z()}get left(){throw Z()}get right(){throw Z()}copy(e,t,r,i,s){return this}insert(e,t,r){return new _i(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Qe=class n{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Bg(this.data.getIterator())}getIteratorFrom(e){return new Bg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Bg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Jc(n){return n.hasNext()?n.getNext():void 0}var Yn=class n{constructor(e){this.fields=e,e.sort(St.comparator)}static empty(){return new n([])}unionWith(e){let t=new Qe(St.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ll(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var jg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function UF(){return typeof atob<"u"}var zt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new jg("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};zt.EMPTY_BYTE_STRING=new zt("");var BK=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yi(n){if(ne(!!n),typeof n=="string"){let e=0,t=BK.exec(n);if(ne(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:wt(n.seconds),nanos:wt(n.nanos)}}function wt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function zs(n){return typeof n=="string"?zt.fromBase64String(n):zt.fromUint8Array(n)}function N_(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function sS(n){let e=n.mapValue.fields.__previous_value__;return N_(e)?sS(e):e}function uh(n){let e=Yi(n.mapValue.fields.__local_write_time__.timestampValue);return new ft(e.seconds,e.nanos)}var fC=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Gs=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var js={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Rg={nullValue:"NULL_VALUE"};function da(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?N_(n)?4:BF(n)?9007199254740991:10:Z()}function wi(n,e){if(n===e)return!0;let t=da(n);if(t!==da(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return uh(n).isEqual(uh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Yi(i.timestampValue),a=Yi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return zs(i.bytesValue).isEqual(zs(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return wt(i.geoPointValue.latitude)===wt(s.geoPointValue.latitude)&&wt(i.geoPointValue.longitude)===wt(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return wt(i.integerValue)===wt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=wt(i.doubleValue),a=wt(s.doubleValue);return o===a?ch(o)===ch(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return ll(n.arrayValue.values||[],e.arrayValue.values||[],wi);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(A1(o)!==A1(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!wi(o[c],a[c])))return!1;return!0}(n,e);default:return Z()}}function dh(n,e){return(n.values||[]).find(t=>wi(t,e))!==void 0}function Ws(n,e){if(n===e)return 0;let t=da(n),r=da(e);if(t!==r)return pe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return pe(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=wt(s.integerValue||s.doubleValue),c=wt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return x1(n.timestampValue,e.timestampValue);case 4:return x1(uh(n),uh(e));case 5:return pe(n.stringValue,e.stringValue);case 6:return function(s,o){let a=zs(s),c=zs(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=pe(a[l],c[l]);if(d!==0)return d}return pe(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=pe(wt(s.latitude),wt(o.latitude));return a!==0?a:pe(wt(s.longitude),wt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){let d=Ws(a[l],c[l]);if(d)return d}return pe(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===js.mapValue&&o===js.mapValue)return 0;if(s===js.mapValue)return 1;if(o===js.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let p=pe(c[h],d[h]);if(p!==0)return p;let _=Ws(a[c[h]],l[d[h]]);if(_!==0)return _}return pe(c.length,d.length)}(n.mapValue,e.mapValue);default:throw Z()}}function x1(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return pe(n,e);let t=Yi(n),r=Yi(e),i=pe(t.seconds,r.seconds);return i!==0?i:pe(t.nanos,r.nanos)}function dl(n){return pC(n)}function pC(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Yi(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return zs(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return K.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=pC(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${pC(t.fields[o])}`;return i+"}"}(n.mapValue):Z()}function ha(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function mC(n){return!!n&&"integerValue"in n}function hh(n){return!!n&&"arrayValue"in n}function R1(n){return!!n&&"nullValue"in n}function N1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ng(n){return!!n&&"mapValue"in n}function nh(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Ea(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=nh(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=nh(n.arrayValue.values[t]);return e}return Object.assign({},n)}function BF(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function jK(n){return"nullValue"in n?Rg:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ha(Gs.empty(),K.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Z()}function $K(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ha(Gs.empty(),K.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?js:Z()}function P1(n,e){let t=Ws(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function M1(n,e){let t=Ws(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var hn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ng(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=nh(t)}setAll(e){let t=St.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=nh(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Ng(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return wi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ng(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ea(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(nh(this.value))}};function jF(n){let e=[];return Ea(n.fields,(t,r)=>{let i=new St([t]);if(Ng(r)){let s=jF(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Yn(e)}var Ft=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,se.min(),se.min(),se.min(),hn.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,se.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,se.min(),se.min(),hn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,se.min(),se.min(),hn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=hn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=hn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ii=class{constructor(e,t){this.position=e,this.inclusive=t}};function k1(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=K.comparator(K.fromName(o.referenceValue),t.key):r=Ws(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function O1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!wi(n.position[t],e.position[t]))return!1;return!0}var fa=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function HK(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var $g=class{},De=class n extends $g{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new yC(e,t,r):t==="array-contains"?new IC(e,r):t==="in"?new Hg(e,r):t==="not-in"?new EC(e,r):t==="array-contains-any"?new bC(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new vC(e,r):new wC(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ws(t,this.value)):t!==null&&da(this.value)===da(t)&&this.matchesComparison(Ws(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Z()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},$e=class n extends $g{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return hl(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function hl(n){return n.op==="and"}function gC(n){return n.op==="or"}function oS(n){return $F(n)&&hl(n)}function $F(n){for(let e of n.filters)if(e instanceof $e)return!1;return!0}function _C(n){if(n instanceof De)return n.field.canonicalString()+n.op.toString()+dl(n.value);if(oS(n))return n.filters.map(e=>_C(e)).join(",");{let e=n.filters.map(t=>_C(t)).join(",");return`${n.op}(${e})`}}function HF(n,e){return n instanceof De?function(r,i){return i instanceof De&&r.op===i.op&&r.field.isEqual(i.field)&&wi(r.value,i.value)}(n,e):n instanceof $e?function(r,i){return i instanceof $e&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&HF(o,i.filters[a]),!0):!1}(n,e):void Z()}function qF(n,e){let t=n.filters.concat(e);return $e.create(t,n.op)}function zF(n){return n instanceof De?function(t){return`${t.field.canonicalString()} ${t.op} ${dl(t.value)}`}(n):n instanceof $e?function(t){return t.op.toString()+" {"+t.getFilters().map(zF).join(" ,")+"}"}(n):"Filter"}var yC=class extends De{constructor(e,t,r){super(e,t,r),this.key=K.fromName(r.referenceValue)}matches(e){let t=K.comparator(e.key,this.key);return this.matchesComparison(t)}},vC=class extends De{constructor(e,t){super(e,"in",t),this.keys=GF("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},wC=class extends De{constructor(e,t){super(e,"not-in",t),this.keys=GF("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function GF(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>K.fromName(r.referenceValue))}var IC=class extends De{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return hh(t)&&dh(t.arrayValue,this.value)}},Hg=class extends De{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&dh(this.value.arrayValue,t)}},EC=class extends De{constructor(e,t){super(e,"not-in",t)}matches(e){if(dh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!dh(this.value.arrayValue,t)}},bC=class extends De{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!hh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>dh(this.value.arrayValue,r))}};var CC=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function TC(n,e=null,t=[],r=[],i=null,s=null,o=null){return new CC(n,e,t,r,i,s,o)}function pa(n){let e=W(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>_C(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),xh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>dl(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>dl(r)).join(",")),e.ue=t}return e.ue}function Rh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!HK(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!HF(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!O1(n.startAt,e.startAt)&&O1(n.endAt,e.endAt)}function qg(n){return K.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function zg(n,e){return n.filters.filter(t=>t instanceof De&&t.field.isEqual(e))}function F1(n,e,t){let r=Rg,i=!0;for(let s of zg(n,e)){let o=Rg,a=!0;switch(s.op){case"<":case"<=":o=jK(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Rg}P1({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];P1({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function L1(n,e,t){let r=js,i=!0;for(let s of zg(n,e)){let o=js,a=!0;switch(s.op){case">=":case">":o=$K(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=js}M1({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];M1({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var Lr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function WF(n,e,t,r,i,s,o,a){return new Lr(n,e,t,r,i,s,o,a)}function Dl(n){return new Lr(n)}function V1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function aS(n){return n.collectionGroup!==null}function al(n){let e=W(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Qe(St.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new fa(s,r))}),t.has(St.keyField().canonicalString())||e.ce.push(new fa(St.keyField(),r))}return e.ce}function bn(n){let e=W(n);return e.le||(e.le=KF(e,al(n))),e.le}function qK(n){let e=W(n);return e.he||(e.he=KF(e,n.explicitOrderBy)),e.he}function KF(n,e){if(n.limitType==="F")return TC(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new fa(i.field,s)});let t=n.endAt?new Ii(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ii(n.startAt.position,n.startAt.inclusive):null;return TC(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function SC(n,e){let t=n.filters.concat([e]);return new Lr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Gg(n,e,t){return new Lr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Nh(n,e){return Rh(bn(n),bn(e))&&n.limitType===e.limitType}function QF(n){return`${pa(bn(n))}|lt:${n.limitType}`}function nl(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>zF(i)).join(", ")}]`),xh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>dl(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>dl(i)).join(",")),`Target(${r})`}(bn(n))}; limitType=${n.limitType})`}function Ph(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):K.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of al(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=k1(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,al(r),i)||r.endAt&&!function(o,a,c){let l=k1(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,al(r),i))}(n,e)}function YF(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function JF(n){return(e,t)=>{let r=!1;for(let i of al(n)){let s=zK(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function zK(n,e,t){let r=n.field.isKeyField()?K.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?Ws(c,l):Z()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Z()}}var Ei=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ea(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return VF(this.inner)}size(){return this.innerSize}};var GK=new rt(K.comparator);function Un(){return GK}var XF=new rt(K.comparator);function eh(...n){let e=XF;for(let t of n)e=e.insert(t.key,t);return e}function ZF(n){let e=XF;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function gi(){return rh()}function eL(){return rh()}function rh(){return new Ei(n=>n.toString(),(n,e)=>n.isEqual(e))}var WK=new rt(K.comparator),KK=new Qe(K.comparator);function ge(...n){let e=KK;for(let t of n)e=e.add(t);return e}var QK=new Qe(pe);function cS(){return QK}function tL(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ch(e)?"-0":e}}function nL(n){return{integerValue:""+n}}function rL(n,e){return PF(e)?nL(e):tL(n,e)}var fl=class{constructor(){this._=void 0}};function YK(n,e,t){return n instanceof Ks?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&N_(s)&&(s=sS(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Ji?sL(n,e):n instanceof Xi?oL(n,e):function(i,s){let o=iL(i,s),a=U1(o)+U1(i.Pe);return mC(o)&&mC(i.Pe)?nL(a):tL(i.serializer,a)}(n,e)}function JK(n,e,t){return n instanceof Ji?sL(n,e):n instanceof Xi?oL(n,e):t}function iL(n,e){return n instanceof Qs?function(r){return mC(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Ks=class extends fl{},Ji=class extends fl{constructor(e){super(),this.elements=e}};function sL(n,e){let t=aL(e);for(let r of n.elements)t.some(i=>wi(i,r))||t.push(r);return{arrayValue:{values:t}}}var Xi=class extends fl{constructor(e){super(),this.elements=e}};function oL(n,e){let t=aL(e);for(let r of n.elements)t=t.filter(i=>!wi(i,r));return{arrayValue:{values:t}}}var Qs=class extends fl{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function U1(n){return wt(n.integerValue||n.doubleValue)}function aL(n){return hh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var ma=class{constructor(e,t){this.field=e,this.transform=t}};function XK(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Ji&&i instanceof Ji||r instanceof Xi&&i instanceof Xi?ll(r.elements,i.elements,wi):r instanceof Qs&&i instanceof Qs?wi(r.Pe,i.Pe):r instanceof Ks&&i instanceof Ks}(n.transform,e.transform)}var DC=class{constructor(e,t){this.version=e,this.transformResults=t}},It=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Pg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var pl=class{};function cL(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Js(n.key,It.none()):new Ys(n.key,n.data,It.none());{let t=n.data,r=hn.empty(),i=new Qe(St.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Vr(n.key,r,new Yn(i.toArray()),It.none())}}function ZK(n,e,t){n instanceof Ys?function(i,s,o){let a=i.value.clone(),c=j1(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Vr?function(i,s,o){if(!Pg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=j1(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(lL(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function ih(n,e,t,r){return n instanceof Ys?function(s,o,a,c){if(!Pg(s.precondition,o))return a;let l=s.value.clone(),d=$1(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof Vr?function(s,o,a,c){if(!Pg(s.precondition,o))return a;let l=$1(s.fieldTransforms,c,o),d=o.data;return d.setAll(lL(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return Pg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function e7(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=iL(r.transform,i||null);s!=null&&(t===null&&(t=hn.empty()),t.set(r.field,s))}return t||null}function B1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ll(r,i,(s,o)=>XK(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Ys=class extends pl{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Vr=class extends pl{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function lL(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function j1(n,e,t){let r=new Map;ne(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,JK(o,a,t[i]))}return r}function $1(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,YK(s,o,e))}return r}var Js=class extends pl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},fh=class extends pl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var ph=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&ZK(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ih(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ih(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=eL();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=cL(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(se.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ge())}isEqual(e){return this.batchId===e.batchId&&ll(this.mutations,e.mutations,(t,r)=>B1(t,r))&&ll(this.baseMutations,e.baseMutations,(t,r)=>B1(t,r))}},AC=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ne(e.mutations.length===r.length);let i=function(){return WK}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var mh=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var xC=class{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}};var RC=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Mt,Me;function uL(n){switch(n){default:return Z();case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0}}function dL(n){if(n===void 0)return Ct("GRPC error has no .code"),O.UNKNOWN;switch(n){case Mt.OK:return O.OK;case Mt.CANCELLED:return O.CANCELLED;case Mt.UNKNOWN:return O.UNKNOWN;case Mt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case Mt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case Mt.INTERNAL:return O.INTERNAL;case Mt.UNAVAILABLE:return O.UNAVAILABLE;case Mt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case Mt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case Mt.NOT_FOUND:return O.NOT_FOUND;case Mt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case Mt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case Mt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case Mt.ABORTED:return O.ABORTED;case Mt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case Mt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case Mt.DATA_LOSS:return O.DATA_LOSS;default:return Z()}}(Me=Mt||(Mt={}))[Me.OK=0]="OK",Me[Me.CANCELLED=1]="CANCELLED",Me[Me.UNKNOWN=2]="UNKNOWN",Me[Me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Me[Me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Me[Me.NOT_FOUND=5]="NOT_FOUND",Me[Me.ALREADY_EXISTS=6]="ALREADY_EXISTS",Me[Me.PERMISSION_DENIED=7]="PERMISSION_DENIED",Me[Me.UNAUTHENTICATED=16]="UNAUTHENTICATED",Me[Me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Me[Me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Me[Me.ABORTED=10]="ABORTED",Me[Me.OUT_OF_RANGE=11]="OUT_OF_RANGE",Me[Me.UNIMPLEMENTED=12]="UNIMPLEMENTED",Me[Me.INTERNAL=13]="INTERNAL",Me[Me.UNAVAILABLE=14]="UNAVAILABLE",Me[Me.DATA_LOSS=15]="DATA_LOSS";var H1=null;function hL(){return new TextEncoder}var t7=new Os([4294967295,4294967295],0);function q1(n){let e=hL().encode(n),t=new qb;return t.update(e),new Uint8Array(t.digest())}function z1(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Os([t,r],0),new Os([i,s],0)]}var NC=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new la(`Invalid padding: ${t}`);if(r<0)throw new la(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new la(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new la(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Os.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Os.fromNumber(r)));return i.compare(t7)===1&&(i=new Os([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=q1(e),[r,i]=z1(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=q1(e),[r,i]=z1(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},la=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var gh=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,_h.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(se.min(),i,new rt(pe),Un(),ge())}},_h=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ge(),ge(),ge())}};var cl=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Wg=class{constructor(e,t){this.targetId=e,this.me=t}},Kg=class{constructor(e,t,r=zt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Qg=class{constructor(){this.fe=0,this.ge=W1(),this.pe=zt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=ge(),t=ge(),r=ge();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Z()}}),new _h(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=W1()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ne(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},PC=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Un(),this.qe=G1(),this.Qe=new rt(pe)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Z()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(qg(s))if(r===0){let o=new K(s.path);this.Ue(t,o,Ft.newNoDocument(o,se.min()))}else ne(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}H1?.et(function(d,h,p,_,w){var A,R,L,Q,B,X;let le={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},te=h.unchangedNames;return te&&(le.bloomFilter={applied:w===0,hashCount:(A=te?.hashCount)!==null&&A!==void 0?A:0,bitmapLength:(Q=(L=(R=te?.bits)===null||R===void 0?void 0:R.bitmap)===null||L===void 0?void 0:L.length)!==null&&Q!==void 0?Q:0,padding:(X=(B=te?.bits)===null||B===void 0?void 0:B.padding)!==null&&X!==void 0?X:0,mightContain:T=>{var v;return(v=_?.mightContain(T))!==null&&v!==void 0&&v}}),le}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=zs(r).toUint8Array()}catch(c){if(c instanceof jg)return _r("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new NC(o,i,s)}catch(c){return _r(c instanceof la?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&qg(a.target)){let c=new K(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Ft.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let r=ge();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new gh(e,t,this.Qe,this.ke,r);return this.ke=Un(),this.qe=G1(),this.Qe=new rt(pe),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Qg,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Qe(pe),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Qg),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function G1(){return new rt(K.comparator)}function W1(){return new rt(K.comparator)}var n7={asc:"ASCENDING",desc:"DESCENDING"},r7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},i7={and:"AND",or:"OR"},MC=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function kC(n,e){return n.useProto3Json||xh(e)?e:{value:e}}function ml(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function s7(n,e){return ml(n,e.toTimestamp())}function Dt(n){return ne(!!n),se.fromTimestamp(function(t){let r=Yi(t);return new ft(r.seconds,r.nanos)}(n))}function lS(n,e){return OC(n,e).canonicalString()}function OC(n,e){let t=function(i){return new ke(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function pL(n){let e=ke.fromString(n);return ne(bL(e)),e}function yh(n,e){return lS(n.databaseId,e.path)}function yi(n,e){let t=pL(e);if(t.get(1)!==n.databaseId.projectId)throw new F(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new F(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new K(_L(t))}function mL(n,e){return lS(n.databaseId,e)}function gL(n){let e=pL(n);return e.length===4?ke.emptyPath():_L(e)}function FC(n){return new ke(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function _L(n){return ne(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function K1(n,e,t){return{name:yh(n,e),fields:t.value.mapValue.fields}}function yL(n,e,t){let r=yi(n,e.name),i=Dt(e.updateTime),s=e.createTime?Dt(e.createTime):se.min(),o=new hn({mapValue:{fields:e.fields}}),a=Ft.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function o7(n,e){return"found"in e?function(r,i){ne(!!i.found),i.found.name,i.found.updateTime;let s=yi(r,i.found.name),o=Dt(i.found.updateTime),a=i.found.createTime?Dt(i.found.createTime):se.min(),c=new hn({mapValue:{fields:i.found.fields}});return Ft.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){ne(!!i.missing),ne(!!i.readTime);let s=yi(r,i.missing),o=Dt(i.readTime);return Ft.newNoDocument(s,o)}(n,e):Z()}function a7(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Z()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(ne(d===void 0||typeof d=="string"),zt.fromBase64String(d||"")):(ne(d===void 0||d instanceof Buffer||d instanceof Uint8Array),zt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?O.UNKNOWN:dL(l.code);return new F(d,l.message||"")}(o);t=new Kg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=yi(n,r.document.name),s=Dt(r.document.updateTime),o=r.document.createTime?Dt(r.document.createTime):se.min(),a=new hn({mapValue:{fields:r.document.fields}}),c=Ft.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new cl(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=yi(n,r.document),s=r.readTime?Dt(r.readTime):se.min(),o=Ft.newNoDocument(i,s),a=r.removedTargetIds||[];t=new cl([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=yi(n,r.document),s=r.removedTargetIds||[];t=new cl([],s,i,null)}else{if(!("filter"in e))return Z();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new RC(i,s),a=r.targetId;t=new Wg(a,o)}}return t}function vh(n,e){let t;if(e instanceof Ys)t={update:K1(n,e.key,e.value)};else if(e instanceof Js)t={delete:yh(n,e.key)};else if(e instanceof Vr)t={update:K1(n,e.key,e.data),updateMask:p7(e.fieldMask)};else{if(!(e instanceof fh))return Z();t={verify:yh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Ks)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ji)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Xi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Qs)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Z()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:s7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Z()}(n,e.precondition)),t}function LC(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?It.updateTime(Dt(s.updateTime)):s.exists!==void 0?It.exists(s.exists):It.none()}(e.currentDocument):It.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)ne(a.setToServerValue==="REQUEST_TIME"),c=new Ks;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new Ji(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new Xi(d)}else"increment"in a?c=new Qs(o,a.increment):Z();let l=St.fromServerFormat(a.fieldPath);return new ma(l,c)}(n,i)):[];if(e.update){e.update.name;let i=yi(n,e.update.name),s=new hn({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new Yn(l.map(d=>St.fromServerFormat(d)))}(e.updateMask);return new Vr(i,s,o,t,r)}return new Ys(i,s,t,r)}if(e.delete){let i=yi(n,e.delete);return new Js(i,t)}if(e.verify){let i=yi(n,e.verify);return new fh(i,t)}return Z()}function c7(n,e){return n&&n.length>0?(ne(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?Dt(i.updateTime):Dt(s);return o.isEqual(se.min())&&(o=Dt(s)),new DC(o,i.transformResults||[])}(t,e))):[]}function vL(n,e){return{documents:[mL(n,e.path)]}}function uS(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=mL(n,i);let s=function(l){if(l.length!==0)return EL($e.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(p){return{field:Vs(p.field),direction:d7(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=kC(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function l7(n,e,t,r){let{_t:i,parent:s}=uS(n,e),o={},a=[],c=0;return t.forEach(l=>{let d=r?l.alias:"aggregate_"+c++;o[d]=l.alias,l.aggregateType==="count"?a.push({alias:d,count:{}}):l.aggregateType==="avg"?a.push({alias:d,avg:{field:Vs(l.fieldPath)}}):l.aggregateType==="sum"&&a.push({alias:d,sum:{field:Vs(l.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},ut:o,parent:s}}function wL(n){let e=gL(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ne(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let p=IL(h);return p instanceof $e&&oS(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(p=>function(w){return new fa(rl(w.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,xh(p)?null:p}(t.limit));let c=null;t.startAt&&(c=function(h){let p=!!h.before,_=h.values||[];return new Ii(_,p)}(t.startAt));let l=null;return t.endAt&&(l=function(h){let p=!h.before,_=h.values||[];return new Ii(_,p)}(t.endAt)),WF(e,i,o,s,a,"F",c,l)}function u7(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Z()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function IL(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=rl(t.unaryFilter.field);return De.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=rl(t.unaryFilter.field);return De.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=rl(t.unaryFilter.field);return De.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=rl(t.unaryFilter.field);return De.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Z()}}(n):n.fieldFilter!==void 0?function(t){return De.create(rl(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Z()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return $e.create(t.compositeFilter.filters.map(r=>IL(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Z()}}(t.compositeFilter.op))}(n):Z()}function d7(n){return n7[n]}function h7(n){return r7[n]}function f7(n){return i7[n]}function Vs(n){return{fieldPath:n.canonicalString()}}function rl(n){return St.fromServerFormat(n.fieldPath)}function EL(n){return n instanceof De?function(t){if(t.op==="=="){if(N1(t.value))return{unaryFilter:{field:Vs(t.field),op:"IS_NAN"}};if(R1(t.value))return{unaryFilter:{field:Vs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(N1(t.value))return{unaryFilter:{field:Vs(t.field),op:"IS_NOT_NAN"}};if(R1(t.value))return{unaryFilter:{field:Vs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vs(t.field),op:h7(t.op),value:t.value}}}(n):n instanceof $e?function(t){let r=t.getFilters().map(i=>EL(i));return r.length===1?r[0]:{compositeFilter:{op:f7(t.op),filters:r}}}(n):Z()}function p7(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function bL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var gl=class n{constructor(e,t,r,i,s=se.min(),o=se.min(),a=zt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Yg=class{constructor(e){this.ct=e}};function m7(n,e){let t;if(e.document)t=yL(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=K.fromSegments(e.noDocument.path),i=_a(e.noDocument.readTime);t=Ft.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Z();{let r=K.fromSegments(e.unknownDocument.path),i=_a(e.unknownDocument.version);t=Ft.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new ft(i[0],i[1]);return se.fromTimestamp(s)}(e.readTime)),t}function Q1(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Jg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:yh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:ml(s,o.version.toTimestamp()),createTime:ml(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ga(e.version)};else{if(!e.isUnknownDocument())return Z();r.unknownDocument={path:t.path.toArray(),version:ga(e.version)}}return r}function Jg(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ga(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function _a(n){let e=new ft(n.seconds,n.nanoseconds);return se.fromTimestamp(e)}function oa(n,e){let t=(e.baseMutations||[]).map(s=>LC(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>LC(n.ct,s)),i=ft.fromMillis(e.localWriteTimeMs);return new ph(e.batchId,i,t,r)}function th(n){let e=_a(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?_a(n.lastLimboFreeSnapshotVersion):se.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return ne(s.documents.length===1),bn(Dl(gL(s.documents[0])))}(n.query):function(s){return bn(wL(s))}(n.query),new gl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,zt.fromBase64String(n.resumeToken))}function CL(n,e){let t=ga(e.snapshotVersion),r=ga(e.lastLimboFreeSnapshotVersion),i;i=qg(e.target)?vL(n.ct,e.target):uS(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:pa(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function dS(n){let e=wL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Gg(e,e.limit,"L"):e}function Jb(n,e){return new mh(e.largestBatchId,LC(n.ct,e.overlayMutation))}function Y1(n,e){let t=e.path.lastSegment();return[n,En(e.path.popLast()),t]}function J1(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:ga(r.readTime),documentKey:En(r.documentKey.path),largestBatchId:r.largestBatchId}}var VC=class{getBundleMetadata(e,t){return X1(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:_a(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return X1(e).put(function(i){return{bundleId:i.id,createTime:ga(Dt(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return Z1(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:dS(s.bundledQuery),readTime:_a(s.readTime)}}(r)})}saveNamedQuery(e,t){return Z1(e).put(function(i){return{name:i.name,readTime:ga(Dt(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function X1(n){return Gt(n,"bundles")}function Z1(n){return Gt(n,"namedQueries")}var Xg=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Yd(e).get(Y1(this.userId,t)).next(r=>r?Jb(this.serializer,r):null)}getOverlays(e,t){let r=gi();return M.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new mh(t,o);i.push(this.ht(e,a))}),M.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(En(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Yd(e).j("collectionPathOverlayIndex",a))}),M.waitFor(s)}getOverlaysForCollection(e,t,r){let i=gi(),s=En(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Yd(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=Jb(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=gi(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Yd(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,d)=>{let h=Jb(this.serializer,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return Yd(e).put(function(i,s,o){let[a,c,l]=Y1(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:vh(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function Yd(n){return Gt(n,"documentOverlays")}var Ki=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(wt(e.integerValue));else if("doubleValue"in e){let r=wt(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),ch(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=Yi(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(zs(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?BF(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):Z()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),K.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};Ki.bt=new Ki;function g7(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function eF(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=g7(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var UC=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ct(r.value),r=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Mt(r.value),r=t.next();this.xt()}Ot(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let t=this.Bt(e),r=eF(t);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){let t=this.Bt(e),r=eF(t);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},BC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},jC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},aa=class{constructor(){this.Gt=new UC,this.zt=new BC(this.Gt),this.jt=new jC(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var ca=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function Fs(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=tF(n.arrayValue,e.arrayValue),t!==0?t:(t=tF(n.directionalValue,e.directionalValue),t!==0?t:K.comparator(n.documentKey,e.documentKey)))}function tF(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Zg=class{constructor(e){this.Yt=new Qe((t,r)=>St.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let r=t;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(ne(e.collectionGroup===this.collectionId),this.en)return!1;let t=cC(e);if(t!==void 0&&!this.nn(t))return!1;let r=ia(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Qe(St.comparator),t=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new ol(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new ol(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new ol(r.field,r.dir==="asc"?0:1)));return new ul(ul.UNKNOWN_ID,this.collectionId,t,ah.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function TL(n){var e,t;if(ne(n instanceof De||n instanceof $e),n instanceof De){if(n instanceof Hg){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>De.create(n.field,"==",s)))||[];return $e.create(i,"or")}return n}let r=n.filters.map(i=>TL(i));return $e.create(r,n.op)}function _7(n){if(n.getFilters().length===0)return[];let e=qC(TL(n));return ne(SL(e)),$C(e)||HC(e)?[e]:e.getFilters()}function $C(n){return n instanceof De}function HC(n){return n instanceof $e&&oS(n)}function SL(n){return $C(n)||HC(n)||function(t){if(t instanceof $e&&gC(t)){for(let r of t.getFilters())if(!$C(r)&&!HC(r))return!1;return!0}return!1}(n)}function qC(n){if(ne(n instanceof De||n instanceof $e),n instanceof De)return n;if(n.filters.length===1)return qC(n.filters[0]);let e=n.filters.map(r=>qC(r)),t=$e.create(e,n.op);return t=e_(t),SL(t)?t:(ne(t instanceof $e),ne(hl(t)),ne(t.filters.length>1),t.filters.reduce((r,i)=>hS(r,i)))}function hS(n,e){let t;return ne(n instanceof De||n instanceof $e),ne(e instanceof De||e instanceof $e),t=n instanceof De?e instanceof De?function(i,s){return $e.create([i,s],"and")}(n,e):nF(n,e):e instanceof De?nF(e,n):function(i,s){if(ne(i.filters.length>0&&s.filters.length>0),hl(i)&&hl(s))return qF(i,s.getFilters());let o=gC(i)?i:s,a=gC(i)?s:i,c=o.filters.map(l=>hS(l,a));return $e.create(c,"or")}(n,e),e_(t)}function nF(n,e){if(hl(e))return qF(e,n.getFilters());{let t=e.filters.map(r=>hS(n,r));return $e.create(t,"or")}}function e_(n){if(ne(n instanceof De||n instanceof $e),n instanceof De)return n;let e=n.getFilters();if(e.length===1)return e_(e[0]);if($F(n))return n;let t=e.map(i=>e_(i)),r=[];return t.forEach(i=>{i instanceof De?r.push(i):i instanceof $e&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:$e.create(r,n.op)}var zC=class{constructor(){this._n=new wh}addToCollectionParentIndex(e,t){return this._n.add(t),M.resolve()}getCollectionParents(e,t){return M.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return M.resolve()}deleteFieldIndex(e,t){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,t){return M.resolve()}getDocumentsMatchingTarget(e,t){return M.resolve(null)}getIndexType(e,t){return M.resolve(0)}getFieldIndexes(e,t){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,t){return M.resolve(yr.min())}getMinOffsetFromCollectionGroup(e,t){return M.resolve(yr.min())}updateCollectionGroup(e,t,r){return M.resolve()}updateIndexEntries(e,t){return M.resolve()}},wh=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Qe(ke.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qe(ke.comparator)).toArray()}};var Tg=new Uint8Array(0),GC=class{constructor(e,t){this.databaseId=t,this.an=new wh,this.un=new Ei(r=>pa(r),(r,i)=>Rh(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:r,parent:En(i)};return rF(e).put(s)}return M.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[DF(t),""],!1,!0);return rF(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(mi(o.parent))}return r})}addFieldIndex(e,t){let r=Jd(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=Zc(e);return s.next(a=>{o.put(J1(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=Jd(e),i=Zc(e),s=Xc(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Jd(e),r=Xc(e),i=Zc(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return M.forEach(this.cn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Zg(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=Xc(e),i=!0,s=new Map;return M.forEach(this.cn(t),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ge(),a=[];return M.forEach(s,(c,l)=>{V("IndexedDbIndexManager",`Using index ${function(B){return`id=${B.indexId}|cg=${B.collectionGroup}|f=${B.fields.map(X=>`${X.fieldPath}:${X.kind}`).join(",")}`}(c)} to execute ${pa(t)}`);let d=function(B,X){let le=cC(X);if(le===void 0)return null;for(let te of zg(B,le.fieldPath))switch(te.op){case"array-contains-any":return te.value.arrayValue.values||[];case"array-contains":return[te.value]}return null}(l,c),h=function(B,X){let le=new Map;for(let te of ia(X))for(let T of zg(B,te.fieldPath))switch(T.op){case"==":case"in":le.set(te.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return le.set(te.fieldPath.canonicalString(),T.value),Array.from(le.values())}return null}(l,c),p=function(B,X){let le=[],te=!0;for(let T of ia(X)){let v=T.kind===0?F1(B,T.fieldPath,B.startAt):L1(B,T.fieldPath,B.startAt);le.push(v.value),te&&(te=v.inclusive)}return new Ii(le,te)}(l,c),_=function(B,X){let le=[],te=!0;for(let T of ia(X)){let v=T.kind===0?L1(B,T.fieldPath,B.endAt):F1(B,T.fieldPath,B.endAt);le.push(v.value),te&&(te=v.inclusive)}return new Ii(le,te)}(l,c),w=this.hn(c,l,p),A=this.hn(c,l,_),R=this.Pn(c,l,h),L=this.In(c.indexId,d,w,p.inclusive,A,_.inclusive,R);return M.forEach(L,Q=>r.G(Q,t.limit).next(B=>{B.forEach(X=>{let le=K.fromSegments(X.documentKey);o.has(le)||(o=o.add(le),a.push(le))})}))}).next(()=>a)}return M.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=_7($e.create(e.filters,"and")).map(r=>TC(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),l=c/(t!=null?t.length:1),d=[];for(let h=0;h<c;++h){let p=t?this.Tn(t[h/l]):Tg,_=this.En(e,p,r[h%l],i),w=this.dn(e,p,s[h%l],o),A=a.map(R=>this.En(e,p,R,!0));d.push(...this.createRange(_,w,A))}return d}En(e,t,r,i){let s=new ca(e,K.empty(),t,r);return i?s:s.Jt()}dn(e,t,r,i){let s=new ca(e,K.empty(),t,r);return i?s.Jt():s}ln(e,t){let r=new Zg(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.cn(t);return M.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new Qe(St.comparator),d=!1;for(let h of c.filters)for(let p of h.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?d=!0:l=l.add(p.field));for(let h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}An(e,t){let r=new aa;for(let i of ia(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Ki.bt.Pt(s,o)}return r.Wt()}Tn(e){let t=new aa;return Ki.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let r=new aa;return Ki.bt.Pt(ha(this.databaseId,t),r.Ht(function(s){let o=ia(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,t,r){if(r===null)return[];let i=[];i.push(new aa);let s=0;for(let o of ia(e)){let a=r[s++];for(let c of i)if(this.Vn(t,o.fieldPath)&&hh(a))i=this.mn(i,o,a);else{let l=c.Ht(o.kind);Ki.bt.Pt(a,l)}}return this.fn(i)}hn(e,t,r){return this.Pn(e,t,r.position)}fn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Wt();return t}mn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new aa;c.seed(a.Wt()),Ki.bt.Pt(o,c.Ht(t.kind)),s.push(c)}return s}Vn(e,t){return!!e.filters.find(r=>r instanceof De&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Jd(e),i=Zc(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return M.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,h){let p=h?new ah(h.sequenceNumber,new yr(_a(h.readTime),new K(mi(h.documentKey)),h.largestBatchId)):ah.empty(),_=d.fields.map(([w,A])=>new ol(St.fromServerFormat(w),A));return new ul(d.indexId,d.collectionGroup,_,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:pe(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Jd(e),s=Zc(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>M.forEach(a,c=>s.put(J1(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return M.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?M.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),M.forEach(a,c=>this.pn(e,i,c).next(l=>{let d=this.yn(s,c);return l.isEqual(d)?M.resolve():this.wn(e,s,c,l,d)}))))})}Sn(e,t,r,i){return Xc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,t.key),documentKey:t.key.path.toArray()})}bn(e,t,r,i){return Xc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,t.key),t.key.path.toArray()])}pn(e,t,r){let i=Xc(e),s=new Qe(Fs);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,t)])},(o,a)=>{s=s.add(new ca(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,t){let r=new Qe(Fs),i=this.An(t,e);if(i==null)return r;let s=cC(t);if(s!=null){let o=e.data.field(s.fieldPath);if(hh(o))for(let a of o.arrayValue.values||[])r=r.add(new ca(t.indexId,e.key,this.Tn(a),i))}else r=r.add(new ca(t.indexId,e.key,Tg,i));return r}wn(e,t,r,i,s){V("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,d,h,p){let _=c.getIterator(),w=l.getIterator(),A=Jc(_),R=Jc(w);for(;A||R;){let L=!1,Q=!1;if(A&&R){let B=d(A,R);B<0?Q=!0:B>0&&(L=!0)}else A!=null?Q=!0:L=!0;L?(h(R),R=Jc(w)):Q?(p(A),A=Jc(_)):(A=Jc(_),R=Jc(w))}}(i,s,Fs,a=>{o.push(this.Sn(e,t,r,a))},a=>{o.push(this.bn(e,t,r,a))}),M.waitFor(o)}gn(e){let t=1;return Zc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Fs(o,a)).filter((o,a,c)=>!a||Fs(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Fs(o,e),c=Fs(o,t);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Tg,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Tg,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,t){return Fs(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(iF)}getMinOffset(e,t){return M.mapArray(this.cn(t),r=>this.ln(e,r).next(i=>i||Z())).next(iF)}};function rF(n){return Gt(n,"collectionParents")}function Xc(n){return Gt(n,"indexEntries")}function Jd(n){return Gt(n,"indexConfiguration")}function Zc(n){return Gt(n,"indexState")}function iF(n){ne(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;rS(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new yr(e.readTime,e.documentKey,t)}var sF={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},gr=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function DL(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,h,p)=>(a++,p.delete()));s.push(c.next(()=>{ne(a===1)}));let l=[];for(let d of t.mutations){let h=MF(e,d.key.path,t.batchId);s.push(i.delete(h)),l.push(d.key)}return M.waitFor(s).next(()=>l)}function t_(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Z();e=n.noDocument}return JSON.stringify(e).length}gr.DEFAULT_COLLECTION_PERCENTILE=10,gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gr.DEFAULT=new gr(41943040,gr.DEFAULT_COLLECTION_PERCENTILE,gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gr.DISABLED=new gr(-1,0,0);var n_=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,t,r,i){ne(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ls(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=il(e),o=Ls(e);return o.add({}).next(a=>{ne(typeof a=="number");let c=new ph(a,t,r,i),l=function(_,w,A){let R=A.baseMutations.map(Q=>vh(_.ct,Q)),L=A.mutations.map(Q=>vh(_.ct,Q));return{userId:w,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:R,mutations:L}}(this.serializer,this.userId,c),d=[],h=new Qe((p,_)=>pe(p.canonicalString(),_.canonicalString()));for(let p of i){let _=MF(this.userId,p.key.path,a);h=h.add(p.key.path.popLast()),d.push(o.put(l)),d.push(s.put(_,EK))}return h.forEach(p=>{d.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),M.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return Ls(e).get(t).next(r=>r?(ne(r.userId===this.userId),oa(this.serializer,r)):null)}vn(e,t){return this.Cn[t]?M.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Ls(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(ne(a.batchId>=r),s=oa(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Ls(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ls(e).U("userMutationsIndex",t).next(r=>r.map(i=>oa(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=xg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return il(e).J({range:i},(o,a,c)=>{let[l,d,h]=o,p=mi(d);if(l===this.userId&&t.path.isEqual(p))return Ls(e).get(h).next(_=>{if(!_)throw Z();ne(_.userId===this.userId),s.push(oa(this.serializer,_))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Qe(pe),i=[];return t.forEach(s=>{let o=xg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=il(e).J({range:a},(l,d,h)=>{let[p,_,w]=l,A=mi(_);p===this.userId&&s.path.isEqual(A)?r=r.add(w):h.done()});i.push(c)}),M.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=xg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Qe(pe);return il(e).J({range:o},(c,l,d)=>{let[h,p,_]=c,w=mi(p);h===this.userId&&r.isPrefixOf(w)?w.length===i&&(a=a.add(_)):d.done()}).next(()=>this.Fn(e,a))}Fn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(Ls(e).get(s).next(o=>{if(o===null)throw Z();ne(o.userId===this.userId),r.push(oa(this.serializer,o))}))}),M.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return DL(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),M.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return M.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return il(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=mi(s[1]);i.push(c)}else a.done()}).next(()=>{ne(i.length===0)})})}containsKey(e,t){return AL(e,this.userId,t)}xn(e){return xL(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function AL(n,e,t){let r=xg(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return il(n).J({range:s,H:!0},(a,c,l)=>{let[d,h,p]=a;d===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function Ls(n){return Gt(n,"mutations")}function il(n){return Gt(n,"documentMutations")}function xL(n){return Gt(n,"mutationQueues")}var _l=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var WC=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let r=new _l(t.highestTargetId);return t.highestTargetId=r.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>se.fromTimestamp(new ft(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(t,r),this.kn(e,r))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>el(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(ne(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return el(e).J((o,a)=>{let c=th(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>M.waitFor(s)).next(()=>i)}forEachTarget(e,t){return el(e).J((r,i)=>{let s=th(i);t(s)})}Bn(e){return oF(e).get("targetGlobalKey").next(t=>(ne(t!==null),t))}kn(e,t){return oF(e).put("targetGlobalKey",t)}qn(e,t){return el(e).put(CL(this.serializer,t))}Qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=pa(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return el(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=th(a);Rh(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=Us(e);return t.forEach(o=>{let a=En(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),M.waitFor(i)}removeMatchingKeys(e,t,r){let i=Us(e);return M.forEach(t,s=>{let o=En(s.path);return M.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=Us(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Us(e),s=ge();return i.J({range:r,H:!0},(o,a,c)=>{let l=mi(o[1]),d=new K(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=En(t.path),i=IDBKeyRange.bound([r],[DF(r)],!1,!0),s=0;return Us(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return el(e).get(t).next(r=>r?th(r):null)}};function el(n){return Gt(n,"targets")}function oF(n){return Gt(n,"targetGlobal")}function Us(n){return Gt(n,"targetDocuments")}function aF([n,e],[t,r]){let i=pe(n,t);return i===0?pe(e,r):i}var KC=class{constructor(e){this.Kn=e,this.buffer=new Qe(aF),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();aF(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},QC=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){V("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){eo(t)?V("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Zs(t)}yield this.zn(3e5)}))}},YC=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return M.resolve(Qn.oe);let r=new KC(t);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(sF)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sF):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let r,i,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),tl()<=ye.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function y7(n,e){return new YC(n,e)}var JC=class{constructor(e,t){this.db=e,this.garbageCollector=y7(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Zn(e){let t=0;return this.Jn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(r,i)=>t(i))}addReference(e,t,r){return Sg(e,r)}removeReference(e,t,r){return Sg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Sg(e,t)}er(e,t){return function(i,s){let o=!1;return xL(i).Y(a=>AL(i,a,s).next(c=>(c&&(o=!0),M.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=t){let c=this.er(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,se.min()),Us(e).delete(function(h){return[0,En(h.path)]}(o))))});i.push(c)}}).next(()=>M.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Sg(e,t)}Xn(e,t){let r=Us(e),i,s=Qn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==Qn.oe&&t(new K(mi(i)),s),s=l,i=c):s=Qn.oe}).next(()=>{s!==Qn.oe&&t(new K(mi(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Sg(n,e){return Us(n).put(function(r,i){return{targetId:0,path:En(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var r_=class{constructor(){this.changes=new Ei(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ft.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?M.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var XC=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ra(e).put(r)}removeEntry(e,t,r){return ra(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Jg(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.tr(e,r)))}getEntry(e,t){let r=Ft.newInvalidDocument(t);return ra(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Xd(t))},(i,s)=>{r=this.nr(t,s)}).next(()=>r)}rr(e,t){let r={size:0,document:Ft.newInvalidDocument(t)};return ra(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Xd(t))},(i,s)=>{r={document:this.nr(t,s),size:t_(s)}}).next(()=>r)}getEntries(e,t){let r=Un();return this.ir(e,t,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,t){let r=Un(),i=new rt(K.comparator);return this.ir(e,t,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,t_(o))}).next(()=>({documents:r,_r:i}))}ir(e,t,r){if(t.isEmpty())return M.resolve();let i=new Qe(uF);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(Xd(i.first()),Xd(i.last())),o=i.getIterator(),a=o.getNext();return ra(e).J({index:"documentKeyIndex",range:s},(c,l,d)=>{let h=K.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&uF(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(Xd(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Jg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ra(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=Un();for(let h of l){let p=this.nr(K.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);p.isFoundDocument()&&(Ph(t,p)||i.has(p.key))&&(d=d.insert(p.key,p))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=Un(),o=lF(t,r),a=lF(t,yr.max());return ra(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,d)=>{let h=this.nr(K.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new ZC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return cF(e).get("remoteDocumentGlobalKey").next(t=>(ne(!!t),t))}tr(e,t){return cF(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let r=m7(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(se.min())))return r}return Ft.newInvalidDocument(e)}};function RL(n){return new XC(n)}var ZC=class extends r_{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new Ei(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Qe((s,o)=>pe(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=Q1(this.ar.serializer,o);i=i.add(s.path.popLast());let l=t_(c);r+=l-a.size,t.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=Q1(this.ar.serializer,o.convertToNoDocument(se.min()));t.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,r)),M.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(r=>(this.ur.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function cF(n){return Gt(n,"remoteDocumentGlobal")}function ra(n){return Gt(n,"remoteDocumentsV14")}function Xd(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function lF(n,e){let t=e.documentKey.path.toArray();return[n,Jg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function uF(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=pe(t[s],r[s]),i)return i;return i=pe(t.length,r.length),i||(i=pe(t[t.length-2],r[r.length-2]),i||pe(t[t.length-1],r[r.length-1]))}var eT=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var i_=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ih(r.mutation,i,Yn.empty(),ft.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ge()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ge()){let i=gi();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=eh();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=gi();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ge()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Un(),o=rh(),a=function(){return rh()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof Vr)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),ih(d.mutation,l,d.mutation.getFieldMask(),ft.now())):o.set(l.key,Yn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var h;return a.set(l,new eT(d,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=rh(),i=new rt((o,a)=>o-a),s=ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||Yn.empty();d=a.applyToLocalView(l,d),r.set(c,d);let h=(i.get(a.batchId)||ge()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,h=eL();d.forEach(p=>{if(!s.has(p)){let _=cL(t.get(p),r.get(p));_!==null&&h.set(p,_),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return M.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return K.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):aS(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):M.resolve(gi()),a=-1,c=s;return o.next(l=>M.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?M.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,ge())).next(d=>({batchId:a,changes:ZF(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new K(t)).next(r=>{let i=eh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=eh();return this.indexManager.getCollectionParents(e,s).next(a=>M.forEach(a,c=>{let l=function(h,p){return new Lr(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,p)=>{o=o.insert(h,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,Ft.newInvalidDocument(d)))});let a=eh();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&ih(d.mutation,l,Yn.empty(),ft.now()),Ph(t,l)&&(a=a.insert(c,l))}),a})}};var tT=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return M.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Dt(i.createTime)}}(t)),M.resolve()}getNamedQuery(e,t){return M.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:dS(i.bundledQuery),readTime:Dt(i.readTime)}}(t)),M.resolve()}};var nT=class{constructor(){this.overlays=new rt(K.comparator),this.hr=new Map}getOverlay(e,t){return M.resolve(this.overlays.get(t))}getOverlays(e,t){let r=gi();return M.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),M.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),M.resolve()}getOverlaysForCollection(e,t,r){let i=gi(),s=t.length+1,o=new K(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return M.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new rt((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=gi(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=gi(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return M.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new mh(t,r));let s=this.hr.get(t);s===void 0&&(s=ge(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var Ih=class{constructor(){this.Pr=new Qe(kt.Ir),this.Tr=new Qe(kt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new kt(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new kt(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new K(new ke([])),r=new kt(t,e),i=new kt(t,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new K(new ke([])),r=new kt(t,e),i=new kt(t,e+1),s=ge();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new kt(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},kt=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return K.comparator(e.key,t.key)||pe(e.pr,t.pr)}static Er(e,t){return pe(e.pr,t.pr)||K.comparator(e.key,t.key)}};var rT=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new Qe(kt.Ir)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new ph(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new kt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return M.resolve(o)}lookupMutationBatch(e,t){return M.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return M.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new kt(t,0),i=new kt(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),M.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Qe(pe);return t.forEach(i=>{let s=new kt(i,0),o=new kt(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),M.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;K.isDocumentKey(s)||(s=s.child(""));let o=new kt(new K(s),0),a=new Qe(pe);return this.wr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.pr)),!0)},o),M.resolve(this.Dr(a))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ne(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return M.forEach(t.mutations,i=>{let s=new kt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new kt(t,0),i=this.wr.firstAfterOrEqual(r);return M.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var iT=class{constructor(e){this.vr=e,this.docs=function(){return new rt(K.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return M.resolve(r?r.document.mutableCopy():Ft.newInvalidDocument(t))}getEntries(e,t){let r=Un();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ft.newInvalidDocument(i))}),M.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Un(),o=t.path,a=new K(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||rS(xF(d),r)<=0||(i.has(d.key)||Ph(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return M.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Z()}Fr(e,t){return M.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new sT(this)}getSize(e){return M.resolve(this.size)}},sT=class extends r_{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),M.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var oT=class{constructor(e){this.persistence=e,this.Mr=new Ei(t=>pa(t),Rh),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Ih,this.targetCount=0,this.Lr=_l.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),M.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new _l(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,M.resolve()}updateTargetData(e,t){return this.qn(t),M.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),M.waitFor(s).next(()=>i)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return M.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),M.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),M.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),M.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return M.resolve(r)}containsKey(e,t){return M.resolve(this.Nr.containsKey(t))}};var s_=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new Qn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new oT(this),this.indexManager=new zC,this.remoteDocumentCache=function(i){return new iT(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Yg(t),this.$r=new tT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new nT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new rT(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);let i=new aT(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return M.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},aT=class extends Vg{constructor(e){super(),this.currentSequenceNumber=e}},o_=class n{constructor(e){this.persistence=e,this.zr=new Ih,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw Z()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),M.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),M.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),M.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.Jr,r=>{let i=K.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,se.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return M.or([()=>M.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var cT=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new Ug("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",D1,{unique:!0}),c.createObjectStore("documentMutations")}(e),dF(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=M.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),dF(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:se.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",D1,{unique:!0});let h=l.store("mutations"),p=d.map(_=>h.put(_));return M.waitFor(p)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:kK});l.createIndex("collectionPathOverlayIndex",OK,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",FK,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:bK});l.createIndex("documentKeyIndex",CK),l.createIndex("collectionGroupIndex",TK)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:RK}).createIndex("sequenceNumberIndex",NK,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:PK}).createIndex("documentKeyIndex",MK,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=t_(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>M.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>M.forEach(a,c=>{ne(c.userId===s.userId);let l=oa(this.serializer,c);return DL(e,s.userId,l).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new ke(o),l=function(h){return[0,En(h)]}(c);s.push(t.get(l).next(d=>d?M.resolve():(h=>t.put({targetId:0,path:En(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>M.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:xK});let r=t.store("collectionParents"),i=new wh,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:En(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new ke(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],l)=>{let d=mi(a);return s(d.popLast())}))}ri(e){let t=e.store("targets");return t.J((r,i)=>{let s=th(i),o=CL(this.serializer,s);return t.put(o)})}ii(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(h){return h.document?new K(ke.fromString(h.document.name).popFirst(5)):h.noDocument?K.fromSegments(h.noDocument.path):h.unknownDocument?K.fromSegments(h.unknownDocument.path):Z()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>M.waitFor(i))}si(e,t){let r=t.store("mutations"),i=RL(this.serializer),s=new s_(o_.Hr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:ge();oa(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),M.forEach(a,(c,l)=>{let d=new Ot(l),h=Xg.lt(this.serializer,d),p=s.getIndexManager(d),_=n_.lt(d,this.serializer,p,s.referenceDelegate);return new i_(i,_,h,p).recalculateAndSaveOverlaysForDocumentKeys(new lh(t,Qn.oe),c).next()})})}};function dF(n){n.createObjectStore("targetDocuments",{keyPath:DK}).createIndex("documentTargetsIndex",AK,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",SK,{unique:!0}),n.createObjectStore("targetGlobal")}var Xb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",lT=class n{constructor(e,t,r,i,s,o,a,c,l,d,h=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=l,this.ai=d,this.ui=h,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=p=>Promise.resolve(),!n.D())throw new F(O.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new JC(this,i),this.Ti=t+"main",this.serializer=new Yg(c),this.Ei=new qs(this.Ti,this.ui,new cT(this.serializer)),this.Qr=new WC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=RL(this.serializer),this.$r=new VC,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,d===!1&&Ct("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new F(O.FAILED_PRECONDITION,Xb);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new Qn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>g(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>g(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Dg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(eo(e))return V("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return V("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return Zd(e).get("owner").next(t=>M.resolve(this.Si(t)))}bi(e){return Dg(e).delete(this.clientId)}Di(){return g(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Gt(t,"clientMetadata");return r.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return M.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?M.resolve(!0):Zd(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new F(O.FAILED_PRECONDITION,Xb);return!1}}return!(!this.networkEnabled||!this.inForeground)||Dg(e).U().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&V("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return g(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new lh(e,Qn.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(r=>this.Ci(r.updateTimeMs,t)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Dg(e).U().next(t=>this.vi(t,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return n_.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new GC(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Xg.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,r){V("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===16?VK:c===15?LF:c===14?FF:c===13?OF:c===12?LK:c===11?kF:void Z()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new lh(a,this.kr?this.kr.next():Qn.oe),t==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw Ct(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new F(O.FAILED_PRECONDITION,RF);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return Zd(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new F(O.FAILED_PRECONDITION,Xb)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Zd(e).put("owner",t)}static D(){return qs.D()}yi(e){let t=Zd(e);return t.get("owner").next(r=>this.Si(r)?(V("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):M.resolve())}Ci(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(Ct(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;qE()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let r=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return V("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ct("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Ct("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Zd(n){return Gt(n,"owner")}function Dg(n){return Gt(n,"clientMetadata")}function fS(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var uT=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=ge(),i=ge();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var dT=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var a_=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return qE()?8:NF(Ke())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new dT;return this.Ji(e,t,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(tl()<=ye.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",nl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),M.resolve()):(tl()<=ye.DEBUG&&V("QueryEngine","Query:",nl(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(tl()<=ye.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",nl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,bn(t))):M.resolve())}ji(e,t){if(V1(t))return M.resolve(null);let r=bn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Gg(t,null,"F"),r=bn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ge(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.Zi(t,a);return this.Xi(t,l,o,c.readTime)?this.ji(e,Gg(t,null,"F")):this.es(e,l,t,c)}))})))}Hi(e,t,r,i){return V1(t)||i.isEqual(se.min())?M.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,r,i)?M.resolve(null):(tl()<=ye.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),nl(t)),this.es(e,o,t,AF(i,-1)).next(a=>a))})}Zi(e,t){let r=new Qe(JF(e));return t.forEach((i,s)=>{Ph(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return tl()<=ye.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",nl(t)),this.zi.getDocumentsMatchingQuery(e,t,yr.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var hT=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new rt(pe),this.rs=new Ei(s=>pa(s),Rh),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new i_(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function NL(n,e,t,r){return new hT(n,e,t,r)}function PL(n,e){return g(this,null,function*(){let t=W(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=ge();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})})}function v7(n,e){let t=W(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let h=l.batch,p=h.keys(),_=M.resolve();return p.forEach(w=>{_=_.next(()=>d.getEntry(c,w)).next(A=>{let R=l.docVersions.get(w);ne(R!==null),A.version.compareTo(R)<0&&(h.applyToRemoteDocument(A,l),A.isValidDocument()&&(A.setReadTime(l.commitVersion),d.addEntry(A)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ge();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function ML(n){let e=W(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function w7(n,e){let t=W(n),r=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let a=[];e.targetChanges.forEach((d,h)=>{let p=i.get(h);if(!p)return;a.push(t.Qr.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Qr.addMatchingKeys(s,d.addedDocuments,h)));let _=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?_=_.withResumeToken(zt.EMPTY_BYTE_STRING,se.min()).withLastLimboFreeSnapshotVersion(se.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(h,_),function(A,R,L){return A.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(p,_,d)&&a.push(t.Qr.updateTargetData(s,_))});let c=Un(),l=ge();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(kL(s,o,e.documentUpdates).next(d=>{c=d.cs,l=d.ls})),!r.isEqual(se.min())){let d=t.Qr.getLastRemoteSnapshotVersion(s).next(h=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return M.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.ns=i,s))}function kL(n,e,t){let r=ge(),i=ge();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Un();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(se.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):V("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:i}})}function I7(n,e){let t=W(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function yl(n,e){let t=W(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,M.resolve(i)):t.Qr.allocateTargetId(r).next(o=>(i=new gl(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}function vl(n,e,t){return g(this,null,function*(){let r=W(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!eo(o))throw o;V("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function c_(n,e,t){let r=W(n),i=se.min(),s=ge();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let h=W(c),p=h.rs.get(d);return p!==void 0?M.resolve(h.ns.get(p)):h.Qr.getTargetData(l,d)}(r,o,bn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?i:se.min(),t?s:ge())).next(a=>(LL(r,YF(e),a),{documents:a,hs:s})))}function OL(n,e){let t=W(n),r=W(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function FL(n,e){let t=W(n),r=t.ss.get(e)||se.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,AF(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(LL(t,e,i),i))}function LL(n,e,t){let r=n.ss.get(e)||se.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}function E7(n,e,t,r){return g(this,null,function*(){let i=W(n),s=ge(),o=Un();for(let l of t){let d=e.Ps(l.metadata.name);l.document&&(s=s.add(d));let h=e.Is(l);h.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(d,h)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield yl(i,function(d){return bn(Dl(ke.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>kL(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Qr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.cs,d.ls)).next(()=>d.cs)))})}function b7(r,i){return g(this,arguments,function*(n,e,t=ge()){let s=yield yl(n,bn(dS(e.bundledQuery))),o=W(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Dt(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let l=s.withResumeToken(zt.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(a,l).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,t,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function hF(n,e){return`firestore_clients_${n}_${e}`}function fF(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Zb(n,e){return`firestore_targets_${n}_${e}`}var l_=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Es(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new F(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(Ct("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},sh=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Es(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new F(r.error.code,r.error.message))),s?new n(e,r.state,i):(Ct("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},u_=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=cS();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=PF(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(Ct("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},fT=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(Ct("SharedClientState",`Failed to parse online state: ${e}`),null)}},Eh=class{constructor(){this.activeTargetIds=cS()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},oh=class{constructor(e,t,r,i,s){this.window=e,this.oi=t,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new rt(pe),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=hF(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Eh),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(hF(this.persistenceKey,r));if(i){let s=u_.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let r=this.xs(t);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,r){this.Ls(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(Zb(this.persistenceKey,e));if(r){let i=sh.Es(e,r);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Zb(this.persistenceKey,e))}updateQueryState(e,t,r){this.qs(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return V("SharedClientState","READ",e,t),t}setItem(e,t){V("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){V("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(V("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void Ct("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let r=this.$s(t.key);return this.Us(r,null)}{let r=this.Ws(t.key,t.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let r=this.Gs(t.key,t.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let r=this.js(t.key,t.newValue);if(r)return this.Hs(r)}}else if(t.key===this.vs){if(t.newValue!==null){let r=this.xs(t.newValue);if(r)return this.Os(r)}}else if(t.key===this.Ss){let r=function(s){let o=Qn.oe;if(s!=null)try{let a=JSON.parse(s);ne(typeof a=="number"),o=a}catch(a){Ct("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Qn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Fs){let r=this.Js(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,r){let i=new l_(this.currentUser,e,t,r),s=fF(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let t=fF(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,r){let i=Zb(this.persistenceKey,e),s=new sh(e,t,r);this.setItem(i,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let r=this.$s(e);return u_.Es(r,t)}Gs(e,t){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return l_.Es(new Ot(s),i,t)}js(e,t){let r=this.Cs.exec(e),i=Number(r[1]);return sh.Es(i,t)}xs(e){return fT.Es(e)}Js(e){return JSON.parse(e)}zs(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);V("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let r=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=cS();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},d_=class{constructor(){this.no=new Eh,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Eh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var pT=class{io(e){}shutdown(){}};var h_=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){V("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){V("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ag=null;function eC(){return Ag===null?Ag=function(){return 268435456+Math.round(2147483648*Math.random())}():Ag++,"0x"+Ag.toString(16)}var C7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var mT=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var dn="WebChannelConnection",gT=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,o){let a=eC(),c=this.vo(t,r.toUriEncodedString());V("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(l,s,o),this.Mo(t,c,l,i).then(d=>(V("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw _r("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}xo(t,r,i,s,o,a){return this.Co(t,r,i,s,o)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Sl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,r){let i=C7[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=eC();return new Promise((o,a)=>{let c=new zb;c.setWithCredentials(!0),c.listenOnce(Wb.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Qd.NO_ERROR:let d=c.getResponseJson();V(dn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Qd.TIMEOUT:V(dn,`RPC '${e}' ${s} timed out`),a(new F(O.DEADLINE_EXCEEDED,"Request time out"));break;case Qd.HTTP_ERROR:let h=c.getStatus();if(V(dn,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);let _=p?.error;if(_&&_.status&&_.message){let w=function(R){let L=R.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(L)>=0?L:O.UNKNOWN}(_.status);a(new F(w,_.message))}else a(new F(O.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new F(O.UNAVAILABLE,"Connection failed."));break;default:Z()}}finally{V(dn,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);V(dn,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Oo(e,t,r){let i=eC(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Yb(),a=Qb(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Gb({})),this.Fo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");V(dn,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c),p=!1,_=!1,w=new mT({lo:R=>{_?V(dn,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(p||(V(dn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),V(dn,`RPC '${e}' stream ${i} sending:`,R),h.send(R))},ho:()=>h.close()}),A=(R,L,Q)=>{R.listen(L,B=>{try{Q(B)}catch(X){setTimeout(()=>{throw X},0)}})};return A(h,Yc.EventType.OPEN,()=>{_||(V(dn,`RPC '${e}' stream ${i} transport opened.`),w.mo())}),A(h,Yc.EventType.CLOSE,()=>{_||(_=!0,V(dn,`RPC '${e}' stream ${i} transport closed`),w.po())}),A(h,Yc.EventType.ERROR,R=>{_||(_=!0,_r(dn,`RPC '${e}' stream ${i} transport errored:`,R),w.po(new F(O.UNAVAILABLE,"The operation could not be completed")))}),A(h,Yc.EventType.MESSAGE,R=>{var L;if(!_){let Q=R.data[0];ne(!!Q);let B=Q,X=B.error||((L=B[0])===null||L===void 0?void 0:L.error);if(X){V(dn,`RPC '${e}' stream ${i} received error:`,X);let le=X.status,te=function(E){let D=Mt[E];if(D!==void 0)return dL(D)}(le),T=X.message;te===void 0&&(te=O.INTERNAL,T="Unknown error status: "+le+" with message "+X.message),_=!0,w.po(new F(te,T)),h.close()}else V(dn,`RPC '${e}' stream ${i} received:`,Q),w.yo(Q)}}),A(a,Kb.STAT_EVENT,R=>{R.stat===Cg.PROXY?V(dn,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Cg.NOPROXY&&V(dn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}};function VL(){return typeof window<"u"?window:null}function Mg(){return typeof document<"u"?document:null}function Mh(n){return new MC(n,!0)}var bh=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var f_=class{constructor(e,t,r,i,s,o,a,c){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new bh(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return g(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return g(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return g(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(Ct(t.toString()),Ct("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new F(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>g(this,null,function*(){this.state=0,this.start()}))}c_(e){return V("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(V("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},_T=class extends f_{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=a7(this.serializer,e),r=function(s){if(!("targetChange"in s))return se.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?se.min():o.readTime?Dt(o.readTime):se.min()}(e);return this.listener.h_(t,r)}P_(e){let t={};t.database=FC(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=qg(c)?{documents:vL(s,c)}:{query:uS(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=fL(s,o.resumeToken);let l=kC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(se.min())>0){a.readTime=ml(s,o.snapshotVersion.toTimestamp());let l=kC(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=u7(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){let t={};t.database=FC(this.serializer),t.removeTarget=e,this.i_(t)}},yT=class extends f_{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(ne(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=c7(e.writeResults,e.commitTime),r=Dt(e.commitTime);return this.listener.A_(r,t)}return ne(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=FC(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>vh(this.serializer,r))};this.i_(t)}};var vT=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new F(O.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,OC(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new F(O.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,OC(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new F(O.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},wT=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(Ct(t),this.y_=!1):V("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var IT=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>g(this,null,function*(){to(this)&&(V("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let l=W(c);l.M_.add(4),yield Al(l),l.N_.set("Unknown"),l.M_.delete(4),yield kh(l)})}(this))}))}),this.N_=new wT(r,i)}};function kh(n){return g(this,null,function*(){if(to(n))for(let e of n.x_)yield e(!0)})}function Al(n){return g(this,null,function*(){for(let e of n.x_)yield e(!1)})}function P_(n,e){let t=W(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),gS(t)?mS(t):Rl(t).Xo()&&pS(t,e))}function wl(n,e){let t=W(n),r=Rl(t);t.F_.delete(e),r.Xo()&&UL(t,e),t.F_.size===0&&(r.Xo()?r.n_():to(t)&&t.N_.set("Unknown"))}function pS(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(se.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Rl(n).P_(e)}function UL(n,e){n.L_.xe(e),Rl(n).I_(e)}function mS(n){n.L_=new PC({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Rl(n).start(),n.N_.w_()}function gS(n){return to(n)&&!Rl(n).Zo()&&n.F_.size>0}function to(n){return W(n).M_.size===0}function BL(n){n.L_=void 0}function T7(n){return g(this,null,function*(){n.N_.set("Online")})}function S7(n){return g(this,null,function*(){n.F_.forEach((e,t)=>{pS(n,e)})})}function D7(n,e){return g(this,null,function*(){BL(n),gS(n)?(n.N_.D_(e),mS(n)):n.N_.set("Unknown")})}function A7(n,e,t){return g(this,null,function*(){if(n.N_.set("Online"),e instanceof Kg&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(n,e)}catch(r){V("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield p_(n,r)}else if(e instanceof cl?n.L_.Ke(e):e instanceof Wg?n.L_.He(e):n.L_.We(e),!t.isEqual(se.min()))try{let r=yield ML(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.F_.get(l);d&&s.F_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.F_.get(c);if(!d)return;s.F_.set(c,d.withResumeToken(zt.EMPTY_BYTE_STRING,d.snapshotVersion)),UL(s,c);let h=new gl(d.target,c,l,d.sequenceNumber);pS(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){V("RemoteStore","Failed to raise snapshot:",r),yield p_(n,r)}})}function p_(n,e,t){return g(this,null,function*(){if(!eo(e))throw e;n.M_.add(1),yield Al(n),n.N_.set("Offline"),t||(t=()=>ML(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){V("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield kh(n)}))})}function jL(n,e){return e().catch(t=>p_(n,t,e))}function xl(n){return g(this,null,function*(){let e=W(n),t=Xs(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;x7(e);)try{let i=yield I7(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,R7(e,i)}catch(i){yield p_(e,i)}$L(e)&&HL(e)})}function x7(n){return to(n)&&n.v_.length<10}function R7(n,e){n.v_.push(e);let t=Xs(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function $L(n){return to(n)&&!Xs(n).Zo()&&n.v_.length>0}function HL(n){Xs(n).start()}function N7(n){return g(this,null,function*(){Xs(n).V_()})}function P7(n){return g(this,null,function*(){let e=Xs(n);for(let t of n.v_)e.d_(t.mutations)})}function M7(n,e,t){return g(this,null,function*(){let r=n.v_.shift(),i=AC.from(r,e,t);yield jL(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield xl(n)})}function k7(n,e){return g(this,null,function*(){e&&Xs(n).E_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return uL(o)&&o!==O.ABORTED}(i.code)){let s=r.v_.shift();Xs(r).t_(),yield jL(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield xl(r)}})}(n,e)),$L(n)&&HL(n)})}function pF(n,e){return g(this,null,function*(){let t=W(n);t.asyncQueue.verifyOperationInProgress(),V("RemoteStore","RemoteStore received new credentials");let r=to(t);t.M_.add(3),yield Al(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield kh(t)})}function ET(n,e){return g(this,null,function*(){let t=W(n);e?(t.M_.delete(2),yield kh(t)):e||(t.M_.add(2),yield Al(t),t.N_.set("Unknown"))})}function Rl(n){return n.B_||(n.B_=function(t,r,i){let s=W(t);return s.f_(),new _T(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:T7.bind(null,n),To:S7.bind(null,n),Ao:D7.bind(null,n),h_:A7.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.B_.t_(),gS(n)?mS(n):n.N_.set("Unknown")):(yield n.B_.stop(),BL(n))}))),n.B_}function Xs(n){return n.k_||(n.k_=function(t,r,i){let s=W(t);return s.f_(),new yT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:N7.bind(null,n),Ao:k7.bind(null,n),R_:P7.bind(null,n),A_:M7.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.k_.t_(),yield xl(n)):(yield n.k_.stop(),n.v_.length>0&&(V("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var bT=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Tt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Nl(n,e){if(Ct("AsyncQueue",`${e}: ${n}`),eo(n))return new F(O.UNAVAILABLE,`${e}: ${n}`);throw n}var m_=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||K.comparator(t.key,r.key):(t,r)=>K.comparator(t.key,r.key),this.keyedMap=eh(),this.sortedSet=new rt(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var g_=class{constructor(){this.q_=new rt(K.comparator)}track(e){let t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):Z():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}},Il=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,m_.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Nh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var CT=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},TT=class{constructor(){this.queries=new Ei(e=>QF(e),Nh),this.onlineState="Unknown",this.z_=new Set}};function _S(n,e){return g(this,null,function*(){let t=W(n),r=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new CT,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=Nl(o,`Initialization of query '${nl(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&vS(t)})}function yS(n,e){return g(this,null,function*(){let t=W(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function O7(n,e){let t=W(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&vS(t)}function F7(n,e,t){let r=W(n),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(t);r.queries.delete(e)}function vS(n){n.z_.forEach(e=>{e.next()})}var ST,mF;(mF=ST||(ST={})).J_="default",mF.Cache="cache";var Ch=class{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Il(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Il.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==ST.Cache}};var DT=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var __=class{constructor(e){this.serializer=e}Ps(e){return yi(this.serializer,e)}Is(e){return e.metadata.exists?yL(this.serializer,e.document,!1):Ft.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Dt(e)}},AT=class{constructor(e,t,r){this.oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=qL(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let r=ke.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,r=new __(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||ge()).add(s);t.set(o,a)}}return t}complete(){return g(this,null,function*(){let e=yield E7(this.localStore,new __(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let r of this.queries)yield b7(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function qL(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var y_=class{constructor(e){this.key=e}},v_=class{constructor(e){this.key=e}},w_=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=ge(),this.mutatedKeys=ge(),this.Ia=JF(e),this.Ta=new m_(this.Ia)}get Ea(){return this.la}da(e,t){let r=t?t.Aa:new g_,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let p=i.get(d),_=Ph(this.query,h)?h:null,w=!!p&&this.mutatedKeys.has(p.key),A=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),R=!1;p&&_?p.data.isEqual(_.data)?w!==A&&(r.track({type:3,doc:_}),R=!0):this.Ra(p,_)||(r.track({type:2,doc:_}),R=!0,(c&&this.Ia(_,c)>0||l&&this.Ia(_,l)<0)&&(a=!0)):!p&&_?(r.track({type:0,doc:_}),R=!0):p&&!_&&(r.track({type:1,doc:p}),R=!0,(c||l)&&(a=!0)),R&&(_?(o=o.add(_),s=A?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((d,h)=>function(_,w){let A=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Z()}};return A(_)-A(w)}(d.type,h.type)||this.Ia(d.doc,h.doc)),this.Va(r),i=i!=null&&i;let a=t&&!i?this.ma():[],c=this.Pa.size===0&&this.current&&!i?1:0,l=c!==this.ha;return this.ha=c,o.length!==0||l?{snapshot:new Il(this.query,e.Ta,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new g_,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=ge(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new v_(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new y_(r))}),t}pa(e){this.la=e.hs,this.Pa=ge();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Il.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},xT=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},RT=class{constructor(e){this.key=e,this.wa=!1}},NT=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new Ei(a=>QF(a),Nh),this.Da=new Map,this.Ca=new Set,this.va=new rt(K.comparator),this.Fa=new Map,this.Ma=new Ih,this.xa={},this.Oa=new Map,this.Na=_l.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function L7(n,e,t=!0){return g(this,null,function*(){let r=M_(n),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield zL(r,e,t,!0),i})}function V7(n,e){return g(this,null,function*(){let t=M_(n);yield zL(t,e,!0,!1)})}function zL(n,e,t,r){return g(this,null,function*(){let i=yield yl(n.localStore,bn(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield wS(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&P_(n.remoteStore,i),a})}function wS(n,e,t,r,i){return g(this,null,function*(){n.Ba=(h,p,_)=>function(A,R,L,Q){return g(this,null,function*(){let B=R.view.da(L);B.Xi&&(B=yield c_(A.localStore,R.query,!1).then(({documents:T})=>R.view.da(T,B)));let X=Q&&Q.targetChanges.get(R.targetId),le=Q&&Q.targetMismatches.get(R.targetId)!=null,te=R.view.applyChanges(B,A.isPrimaryClient,X,le);return PT(A,R.targetId,te.fa),te.snapshot})}(n,h,p,_);let s=yield c_(n.localStore,e,!0),o=new w_(e,s.hs),a=o.da(s.documents),c=_h.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);PT(n,t,l.fa);let d=new xT(e,t,o);return n.ba.set(e,d),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),l.snapshot})}function U7(n,e,t){return g(this,null,function*(){let r=W(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!Nh(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield vl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&wl(r.remoteStore,i.targetId),El(r,i.targetId)}).catch(Zs))):(El(r,i.targetId),yield vl(r.localStore,i.targetId,!0))})}function B7(n,e){return g(this,null,function*(){let t=W(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),wl(t.remoteStore,r.targetId))})}function j7(n,e,t){return g(this,null,function*(){let r=CS(n);try{let i=yield function(o,a){let c=W(o),l=ft.now(),d=a.reduce((_,w)=>_.add(w.key),ge()),h,p;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let w=Un(),A=ge();return c.os.getEntries(_,d).next(R=>{w=R,w.forEach((L,Q)=>{Q.isValidDocument()||(A=A.add(L))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,w)).next(R=>{h=R;let L=[];for(let Q of a){let B=e7(Q,h.get(Q.key).overlayedDocument);B!=null&&L.push(new Vr(Q.key,B,jF(B.value.mapValue),It.exists(!0)))}return c.mutationQueue.addMutationBatch(_,l,L,a)}).next(R=>{p=R;let L=R.applyToLocalDocumentSet(h,A);return c.documentOverlayCache.saveOverlays(_,R.batchId,L)})}).then(()=>({batchId:p.batchId,changes:ZF(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.xa[o.currentUser.toKey()];l||(l=new rt(pe)),l=l.insert(a,c),o.xa[o.currentUser.toKey()]=l}(r,i.batchId,t),yield es(r,i.changes),yield xl(r.remoteStore)}catch(i){let s=Nl(i,"Failed to persist write");t.reject(s)}})}function GL(n,e){return g(this,null,function*(){let t=W(n);try{let r=yield w7(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(ne(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?ne(o.wa):i.removedDocuments.size>0&&(ne(o.wa),o.wa=!1))}),yield es(t,r,e)}catch(r){yield Zs(r)}})}function gF(n,e,t){let r=W(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=W(o);c.onlineState=a;let l=!1;c.queries.forEach((d,h)=>{for(let p of h.U_)p.j_(a)&&(l=!0)}),l&&vS(c)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function $7(n,e,t){return g(this,null,function*(){let r=W(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new rt(K.comparator);o=o.insert(s,Ft.newNoDocument(s,se.min()));let a=ge().add(s),c=new gh(se.min(),new Map,new rt(pe),o,a);yield GL(r,c),r.va=r.va.remove(s),r.Fa.delete(e),bS(r)}else yield vl(r.localStore,e,!1).then(()=>El(r,e,t)).catch(Zs)})}function H7(n,e){return g(this,null,function*(){let t=W(n),r=e.batch.batchId;try{let i=yield v7(t.localStore,e);ES(t,r,null),IS(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield es(t,i)}catch(i){yield Zs(i)}})}function q7(n,e,t){return g(this,null,function*(){let r=W(n);try{let i=yield function(o,a){let c=W(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(ne(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);ES(r,e,t),IS(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield es(r,i)}catch(i){yield Zs(i)}})}function z7(n,e){return g(this,null,function*(){let t=W(n);to(t.remoteStore)||V("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=W(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Oa.get(r)||[];i.push(e),t.Oa.set(r,i)}catch(r){let i=Nl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function IS(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function ES(n,e,t){let r=W(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function El(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||WL(n,r)})}function WL(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(wl(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),bS(n))}function PT(n,e,t){for(let r of t)r instanceof y_?(n.Ma.addReference(r.key,e),G7(n,r)):r instanceof v_?(V("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||WL(n,r.key)):Z()}function G7(n,e){let t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(V("SyncEngine","New document in limbo: "+t),n.Ca.add(r),bS(n))}function bS(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new K(ke.fromString(e)),r=n.Na.next();n.Fa.set(r,new RT(t)),n.va=n.va.insert(t,r),P_(n.remoteStore,new gl(bn(Dl(t.path)),r,"TargetPurposeLimboResolution",Qn.oe))}}function es(n,e,t){return g(this,null,function*(){let r=W(n),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,c)=>{o.push(r.Ba(c,e,t).then(l=>{if((l||t)&&r.isPrimaryClient){let d=l&&!l.fromCache;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);let d=uT.Ki(c.targetId,l);s.push(d)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(c,l){return g(this,null,function*(){let d=W(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>M.forEach(l,p=>M.forEach(p.qi,_=>d.persistence.referenceDelegate.addReference(h,p.targetId,_)).next(()=>M.forEach(p.Qi,_=>d.persistence.referenceDelegate.removeReference(h,p.targetId,_)))))}catch(h){if(!eo(h))throw h;V("LocalStore","Failed to update sequence numbers: "+h)}for(let h of l){let p=h.targetId;if(!h.fromCache){let _=d.ns.get(p),w=_.snapshotVersion,A=_.withLastLimboFreeSnapshotVersion(w);d.ns=d.ns.insert(p,A)}}})}(r.localStore,s))})}function W7(n,e){return g(this,null,function*(){let t=W(n);if(!t.currentUser.isEqual(e)){V("SyncEngine","User change. New user:",e.toKey());let r=yield PL(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(c=>{c.reject(new F(O.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield es(t,r.us)}})}function K7(n,e){let t=W(n),r=t.Fa.get(e);if(r&&r.wa)return ge().add(r.key);{let i=ge(),s=t.Da.get(e);if(!s)return i;for(let o of s){let a=t.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function Q7(n,e){return g(this,null,function*(){let t=W(n),r=yield c_(t.localStore,e.query,!0),i=e.view.pa(r);return t.isPrimaryClient&&PT(t,e.targetId,i.fa),i})}function Y7(n,e){return g(this,null,function*(){let t=W(n);return FL(t.localStore,e).then(r=>es(t,r))})}function J7(n,e,t,r){return g(this,null,function*(){let i=W(n),s=yield function(a,c){let l=W(a),d=W(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.vn(h,c).next(p=>p?l.localDocuments.getDocuments(h,p):M.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield xl(i.remoteStore):t==="acknowledged"||t==="rejected"?(ES(i,e,r||null),IS(i,e),function(a,c){W(W(a).mutationQueue).Mn(c)}(i.localStore,e)):Z(),yield es(i,s)):V("SyncEngine","Cannot apply mutation batch with id: "+e)})}function X7(n,e){return g(this,null,function*(){let t=W(n);if(M_(t),CS(t),e===!0&&t.La!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield _F(t,r.toArray());t.La=!0,yield ET(t.remoteStore,!0);for(let s of i)P_(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let r=[],i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(El(t,o),vl(t.localStore,o,!0))),wl(t.remoteStore,o)}),yield i,yield _F(t,r),function(o){let a=W(o);a.Fa.forEach((c,l)=>{wl(a.remoteStore,l)}),a.Ma.mr(),a.Fa=new Map,a.va=new rt(K.comparator)}(t),t.La=!1,yield ET(t.remoteStore,!1)}})}function _F(n,e,t){return g(this,null,function*(){let r=W(n),i=[],s=[];for(let o of e){let a,c=r.Da.get(o);if(c&&c.length!==0){a=yield yl(r.localStore,bn(c[0]));for(let l of c){let d=r.ba.get(l),h=yield Q7(r,d);h.snapshot&&s.push(h.snapshot)}}else{let l=yield OL(r.localStore,o);a=yield yl(r.localStore,l),yield wS(r,KL(l),o,!1,a.resumeToken)}i.push(a)}return r.Sa.h_(s),i})}function KL(n){return WF(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Z7(n){return function(t){return W(W(t).persistence).Bi()}(W(n).localStore)}function eQ(n,e,t,r){return g(this,null,function*(){let i=W(n);if(i.La)return void V("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield FL(i.localStore,YF(s[0])),a=gh.createSynthesizedRemoteEventForCurrentChange(e,t==="current",zt.EMPTY_BYTE_STRING);yield es(i,o,a);break}case"rejected":yield vl(i.localStore,e,!0),El(i,e,r);break;default:Z()}})}function tQ(n,e,t){return g(this,null,function*(){let r=M_(n);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){V("SyncEngine","Adding an already active target "+i);continue}let s=yield OL(r.localStore,i),o=yield yl(r.localStore,s);yield wS(r,KL(s),o.targetId,!1,o.resumeToken),P_(r.remoteStore,o)}for(let i of t)r.Da.has(i)&&(yield vl(r.localStore,i,!1).then(()=>{wl(r.remoteStore,i),El(r,i)}).catch(Zs))}})}function M_(n){let e=W(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=GL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=K7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$7.bind(null,e),e.Sa.h_=O7.bind(null,e.eventManager),e.Sa.ka=F7.bind(null,e.eventManager),e}function CS(n){let e=W(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=H7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=q7.bind(null,e),e}function nQ(n,e,t){let r=W(n);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(_,w){let A=W(_),R=Dt(w.createTime);return A.persistence.runTransaction("hasNewerBundle","readonly",L=>A.$r.getBundleMetadata(L,w.id)).then(L=>!!L&&L.createTime.compareTo(R)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(qL(c));let l=new AT(c,s.localStore,o.serializer),d=yield o.qa();for(;d;){let p=yield l._a(d);p&&a._updateProgress(p),d=yield o.qa()}let h=yield l.complete();return yield es(s,h.ca,void 0),yield function(_,w){let A=W(_);return A.persistence.runTransaction("Save bundle","readwrite",R=>A.$r.saveBundleMetadata(R,w))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.ua)}catch(c){return _r("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Th=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=Mh(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return NL(this.persistence,new a_,e.initialUser,this.serializer)}createPersistence(e){return new s_(o_.Hr,this.serializer)}createSharedClientState(e){return new d_}terminate(){return g(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var I_=class n extends Th{constructor(e,t,r){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield Gr(n.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield CS(this.Qa.syncEngine),yield xl(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return NL(this.persistence,new a_,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new QC(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new hC(t,this.persistence);return new dC(e.asyncQueue,r)}createPersistence(e){let t=fS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?gr.withCacheSize(this.cacheSizeBytes):gr.DEFAULT;return new lT(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,VL(),Mg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new d_}},MT=class n extends I_{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield Gr(n.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof oh&&(this.sharedClientState.syncEngine={Zs:J7.bind(null,t),Xs:eQ.bind(null,t),eo:tQ.bind(null,t),Bi:Z7.bind(null,t),Ys:Y7.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>g(this,null,function*(){yield X7(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=VL();if(!oh.D(t))throw new F(O.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=fS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new oh(t,e.asyncQueue,r,e.clientId,e.initialUser)}},Sh=class{initialize(e,t){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>gF(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=W7.bind(null,this.syncEngine),yield ET(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new TT}()}createDatastore(e){let t=Mh(e.databaseInfo.databaseId),r=function(s){return new gT(s)}(e.databaseInfo);return function(s,o,a,c){return new vT(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new IT(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>gF(this.syncEngine,t,0),function(){return h_.D()?new h_:new pT}())}createSyncEngine(e,t){return function(i,s,o,a,c,l,d){let h=new NT(i,s,o,a,c,l);return d&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return g(this,null,function*(){var e;yield function(r){return g(this,null,function*(){let i=W(r);V("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Al(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function yF(n,e=10240){let t=0;return{read(){return g(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var bl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):Ct("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var kT=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new Tt,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}qa(){return g(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return g(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),r=Number(t);isNaN(r)&&this.ja(`length string (${t}) is not valid number`);let i=yield this.Ha(r);return new DT(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return g(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return g(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var OT=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new F(O.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return g(this,null,function*(){let o=W(i),a={documents:s.map(h=>yh(o.serializer,h))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,ke.emptyPath(),a,s.length),l=new Map;c.forEach(h=>{let p=o7(o.serializer,h);l.set(p.key.toString(),p)});let d=[];return s.forEach(h=>{let p=l.get(h.toString());ne(!!p),d.push(p)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Js(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=K.fromPath(r);this.mutations.push(new fh(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=W(r),o={writes:i.map(a=>vh(s.serializer,a))};yield s.Co("Commit",s.serializer.databaseId,ke.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Z();t=se.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new F(O.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(se.min())?It.exists(!1):It.updateTime(t):It.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(se.min()))throw new F(O.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return It.updateTime(t)}return It.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var FT=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Yo=new bh(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>g(this,null,function*(){let e=new OT(this.datastore),t=this.tu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let t=this.updateFunction(e);return!xh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!uL(t)}return!1}};var LT=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ot.UNAUTHENTICATED,this.clientId=Fg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){V("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(V("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new F(O.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Tt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Nl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function kg(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),V("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield PL(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function VT(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield TS(n);V("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>pF(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>pF(e.remoteStore,i)),n._onlineComponents=e})}function QL(n){return n.name==="FirebaseError"?n.code===O.FAILED_PRECONDITION||n.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function TS(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V("FirestoreClient","Using user provided OfflineComponentProvider");try{yield kg(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!QL(t))throw t;_r("Error using user provided cache. Falling back to memory cache: "+t),yield kg(n,new Th)}}else V("FirestoreClient","Using default OfflineComponentProvider"),yield kg(n,new Th);return n._offlineComponents})}function k_(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(V("FirestoreClient","Using user provided OnlineComponentProvider"),yield VT(n,n._uninitializedComponentsProvider._online)):(V("FirestoreClient","Using default OnlineComponentProvider"),yield VT(n,new Sh))),n._onlineComponents})}function YL(n){return TS(n).then(e=>e.persistence)}function SS(n){return TS(n).then(e=>e.localStore)}function JL(n){return k_(n).then(e=>e.remoteStore)}function DS(n){return k_(n).then(e=>e.syncEngine)}function XL(n){return k_(n).then(e=>e.datastore)}function Cl(n){return g(this,null,function*(){let e=yield k_(n),t=e.eventManager;return t.onListen=L7.bind(null,e.syncEngine),t.onUnlisten=U7.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=V7.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=B7.bind(null,e.syncEngine),t})}function rQ(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield YL(n),t=yield JL(n);return e.setNetworkEnabled(!0),function(i){let s=W(i);return s.M_.delete(0),kh(s)}(t)}))}function iQ(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield YL(n),t=yield JL(n);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=W(i);s.M_.add(0),yield Al(s),s.N_.set("Offline")})}(t)}))}function sQ(n,e){let t=new Tt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(l,d){let h=W(l);return h.persistence.runTransaction("read document","readonly",p=>h.localDocuments.getDocument(p,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new F(O.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Nl(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield SS(n),e,t)})),t.promise}function ZL(n,e,t={}){let r=new Tt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new bl({next:p=>{o.enqueueAndForget(()=>yS(s,h));let _=p.docs.has(a);!_&&p.fromCache?l.reject(new F(O.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&c&&c.source==="server"?l.reject(new F(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new Ch(Dl(a.path),d,{includeMetadataChanges:!0,ra:!0});return _S(s,h)}(yield Cl(n),n.asyncQueue,e,t,r)})),r.promise}function oQ(n,e){let t=new Tt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield c_(i,s,!0),c=new w_(s,a.hs),l=c.da(a.documents),d=c.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let c=Nl(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield SS(n),e,t)})),t.promise}function eV(n,e,t={}){let r=new Tt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new bl({next:p=>{o.enqueueAndForget(()=>yS(s,h)),p.fromCache&&c.source==="server"?l.reject(new F(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new Ch(a,d,{includeMetadataChanges:!0,ra:!0});return _S(s,h)}(yield Cl(n),n.asyncQueue,e,t,r)})),r.promise}function aQ(n,e,t){let r=new Tt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){try{let i=yield XL(n);r.resolve(function(o,a,c){return g(this,null,function*(){var l;let d=W(o),{request:h,ut:p,parent:_}=l7(d.serializer,qK(a),c);d.connection.Do||delete h.parent;let w=(yield d.xo("RunAggregationQuery",d.serializer.databaseId,_,h,1)).filter(R=>!!R.result);ne(w.length===1);let A=(l=w[0].result)===null||l===void 0?void 0:l.aggregateFields;return Object.keys(A).reduce((R,L)=>(R[p[L]]=A[L],R),{})})}(i,e,t))}catch(i){r.reject(i)}})),r.promise}function cQ(n,e){let t=new bl(e);return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){W(i).z_.add(s),s.next()}(yield Cl(n),t)})),()=>{t.$a(),n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){W(i).z_.delete(s)}(yield Cl(n),t)}))}}function lQ(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?hL().encode(o):o,function(d,h){return new kT(d,h)}(function(d,h){if(d instanceof Uint8Array)return yF(d,h);if(d instanceof ArrayBuffer)return yF(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,Mh(e));n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){nQ(yield DS(n),i,r)}))}function uQ(n,e){return n.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=W(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield SS(n),e)}))}function tV(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var vF=new Map;function AS(n,e,t){if(!t)throw new F(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function xS(n,e,t,r){if(e===!0&&r===!0)throw new F(O.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function wF(n){if(!K.isDocumentKey(n))throw new F(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function IF(n){if(K.isDocumentKey(n))throw new F(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function O_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Z()}function Ae(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new F(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=O_(n);throw new F(O.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function nV(n,e){if(e<=0)throw new F(O.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var E_=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new F(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new F(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tV((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new F(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ya=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new E_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new F(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new F(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new E_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new tC;switch(r.type){case"firstParty":return new sC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new F(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=vF.get(t);r&&(V("ComponentProvider","Removing Datastore"),vF.delete(t),r.terminate())}(this),Promise.resolve()}};function rV(n,e,t,r={}){var i;let s=(n=Ae(n,ya))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&_r("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Ot.MOCK_USER;else{a=Oc(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new F(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ot(l)}n._authCredentials=new nC(new Og(a,c))}}var Xt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ze=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},vi=class n extends Xt{constructor(e,t,r){super(e,t,Dl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ze(this.firestore,null,new K(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function jr(n,e,...t){if(n=G(n),AS("collection","path",e),n instanceof ya){let r=ke.fromString(e,...t);return IF(r),new vi(n,null,r)}{if(!(n instanceof Ze||n instanceof vi))throw new F(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ke.fromString(e,...t));return IF(r),new vi(n.firestore,null,r)}}function iV(n,e){if(n=Ae(n,ya),AS("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new F(O.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Xt(n,null,function(r){return new Lr(ke.emptyPath(),r)}(e))}function Oh(n,e,...t){if(n=G(n),arguments.length===1&&(e=Fg.newId()),AS("doc","path",e),n instanceof ya){let r=ke.fromString(e,...t);return wF(r),new Ze(n,null,new K(r))}{if(!(n instanceof Ze||n instanceof vi))throw new F(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ke.fromString(e,...t));return wF(r),new Ze(n.firestore,n instanceof vi?n.converter:null,new K(r))}}function RS(n,e){return n=G(n),e=G(e),(n instanceof Ze||n instanceof vi)&&(e instanceof Ze||e instanceof vi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function NS(n,e){return n=G(n),e=G(e),n instanceof Xt&&e instanceof Xt&&n.firestore===e.firestore&&Nh(n._query,e._query)&&n.converter===e.converter}var UT=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new bh(this,"async_queue_retry"),this.hu=()=>{let t=Mg();t&&V("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=Mg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=Mg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new Tt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return g(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!eo(e))throw e;V("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Ct("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=bT.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&Z()}verifyOperationInProgress(){}du(){return g(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function BT(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var jT=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Tt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var sV=-1,it=class extends ya{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new UT}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||oV(this),this._firestoreClient.terminate()}};function Lt(n){return n._firestoreClient||oV(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function oV(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,d){return new fC(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,tV(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new LT(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function aV(n,e){gV(n=Ae(n,it));let t=Lt(n);if(t._uninitializedComponentsProvider)throw new F(O.FAILED_PRECONDITION,"SDK cache is already specified.");_r("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new Sh;return lV(t,i,new I_(i,r.cacheSizeBytes,e?.forceOwnership))}function cV(n){gV(n=Ae(n,it));let e=Lt(n);if(e._uninitializedComponentsProvider)throw new F(O.FAILED_PRECONDITION,"SDK cache is already specified.");_r("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new Sh;return lV(e,r,new MT(r,t.cacheSizeBytes))}function lV(n,e,t){let r=new Tt;return n.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield kg(n,t),yield VT(n,e),r.resolve()}catch(i){let s=i;if(!QL(s))throw s;_r("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function uV(n){if(n._initialized&&!n._terminated)throw new F(O.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Tt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!qs.D())return Promise.resolve();let i=r+"main";yield qs.delete(i)})}(fS(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function dV(n){return function(t){let r=new Tt;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return z7(yield DS(t),r)})),r.promise}(Lt(n=Ae(n,it)))}function hV(n){return rQ(Lt(n=Ae(n,it)))}function fV(n){return iQ(Lt(n=Ae(n,it)))}function pV(n,e){let t=Lt(n=Ae(n,it)),r=new jT;return lQ(t,n._databaseId,e,r),r}function mV(n,e){return uQ(Lt(n=Ae(n,it)),e).then(t=>t?new Xt(n,null,t.query):null)}function gV(n){if(n._initialized||n._terminated)throw new F(O.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var $T=class{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}},HT=class{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}};var bi=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(zt.fromBase64String(e))}catch(t){throw new F(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Ur=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new St(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Zi=class{constructor(e){this._methodName=e}};var va=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return pe(this._lat,e._lat)||pe(this._long,e._long)}};var dQ=/^__.*__$/,qT=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Vr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ys(e,this.data,t,this.fieldTransforms)}},b_=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Vr(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function _V(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Z()}}var C_=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return T_(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(_V(this.fu)&&dQ.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},zT=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Mh(e)}Fu(e,t,r,i=!1){return new C_({fu:e,methodName:t,vu:r,path:St.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ba(n){let e=n._freezeSettings(),t=Mh(n._databaseId);return new zT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function F_(n,e,t,r,i,s={}){let o=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);kS("Data must be an object, but it was:",o,r);let a=wV(r,o),c,l;if(s.merge)c=new Yn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let p=YT(e,h,t);if(!o.contains(p))throw new F(O.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);EV(d,p)||d.push(p)}c=new Yn(d),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new qT(new hn(a),c,l)}var Dh=class n extends Zi{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function yV(n,e,t){return new C_({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var GT=class n extends Zi{_toFieldTransform(e){return new ma(e.path,new Ks)}isEqual(e){return e instanceof n}},WT=class n extends Zi{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=yV(this,e,!0),r=this.Mu.map(s=>Ca(s,t)),i=new Ji(r);return new ma(e.path,i)}isEqual(e){return e instanceof n&&Ss(this.Mu,e.Mu)}},KT=class n extends Zi{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=yV(this,e,!0),r=this.Mu.map(s=>Ca(s,t)),i=new Xi(r);return new ma(e.path,i)}isEqual(e){return e instanceof n&&Ss(this.Mu,e.Mu)}},QT=class n extends Zi{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new Qs(e.serializer,rL(e.serializer,this.xu));return new ma(e.path,t)}isEqual(e){return e instanceof n&&this.xu===e.xu}};function PS(n,e,t,r){let i=n.Fu(1,e,t);kS("Data must be an object, but it was:",i,r);let s=[],o=hn.empty();Ea(r,(c,l)=>{let d=OS(e,c,t);l=G(l);let h=i.Su(d);if(l instanceof Dh)s.push(d);else{let p=Ca(l,h);p!=null&&(s.push(d),o.set(d,p))}});let a=new Yn(s);return new b_(o,a,i.fieldTransforms)}function MS(n,e,t,r,i,s){let o=n.Fu(1,e,t),a=[YT(e,r,t)],c=[i];if(s.length%2!=0)throw new F(O.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(YT(e,s[p])),c.push(s[p+1]);let l=[],d=hn.empty();for(let p=a.length-1;p>=0;--p)if(!EV(l,a[p])){let _=a[p],w=c[p];w=G(w);let A=o.Su(_);if(w instanceof Dh)l.push(_);else{let R=Ca(w,A);R!=null&&(l.push(_),d.set(_,R))}}let h=new Yn(l);return new b_(d,h,o.fieldTransforms)}function vV(n,e,t,r=!1){return Ca(t,n.Fu(r?4:3,e))}function Ca(n,e){if(IV(n=G(n)))return kS("Unsupported field value:",e,n),wV(n,e);if(n instanceof Zi)return function(r,i){if(!_V(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Ca(a,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=G(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return rL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=ft.fromDate(r);return{timestampValue:ml(i.serializer,s)}}if(r instanceof ft){let s=new ft(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ml(i.serializer,s)}}if(r instanceof va)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof bi)return{bytesValue:fL(i.serializer,r._byteString)};if(r instanceof Ze){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:lS(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${O_(r)}`)}(n,e)}function wV(n,e){let t={};return VF(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ea(n,(r,i)=>{let s=Ca(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function IV(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ft||n instanceof va||n instanceof bi||n instanceof Ze||n instanceof Zi)}function kS(n,e,t){if(!IV(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=O_(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function YT(n,e,t){if((e=G(e))instanceof Ur)return e._internalPath;if(typeof e=="string")return OS(n,e);throw T_("Field path arguments must be of type string or ",n,!1,void 0,t)}var hQ=new RegExp("[~\\*/\\[\\]]");function OS(n,e,t){if(e.search(hQ)>=0)throw T_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ur(...e.split("."))._internalPath}catch{throw T_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function T_(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new F(O.INVALID_ARGUMENT,a+n+c)}function EV(n,e){return n.some(t=>t.isEqual(e))}var wa=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new JT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(L_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},JT=class extends wa{data(){return super.data()}};function L_(n,e){return typeof e=="string"?OS(n,e):e instanceof Ur?e._internalPath:e._delegate._internalPath}function bV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new F(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ah=class{},Ia=class extends Ah{};function $r(n,e,...t){let r=[];e instanceof Ah&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof XT).length,a=s.filter(c=>c instanceof S_).length;if(o>1||o>0&&a>0)throw new F(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var S_=class n extends Ia{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return PV(e._query,t),new Xt(e.firestore,e.converter,SC(e._query,t))}_parse(e){let t=ba(e.firestore);return function(s,o,a,c,l,d,h){let p;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new F(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){bF(h,d);let _=[];for(let w of h)_.push(EF(c,s,w));p={arrayValue:{values:_}}}else p=EF(c,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||bF(h,d),p=vV(a,o,h,d==="in"||d==="not-in");return De.create(l,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function V_(n,e,t){let r=e,i=L_("where",n);return S_._create(i,r,t)}var XT=class n extends Ah{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:$e.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)PV(o,c),o=SC(o,c)}(e._query,t),new Xt(e.firestore,e.converter,SC(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var ZT=class n extends Ia{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new F(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new F(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fa(s,o)}(e._query,this._field,this._direction);return new Xt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Lr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function CV(n,e="asc"){let t=e,r=L_("orderBy",n);return ZT._create(r,t)}var D_=class n extends Ia{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Xt(e.firestore,e.converter,Gg(e._query,this._limit,this._limitType))}};function TV(n){return nV("limit",n),D_._create("limit",n,"F")}function SV(n){return nV("limitToLast",n),D_._create("limitToLast",n,"L")}var A_=class n extends Ia{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=NV(e,this.type,this._docOrFields,this._inclusive);return new Xt(e.firestore,e.converter,function(i,s){return new Lr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function DV(...n){return A_._create("startAt",n,!0)}function AV(...n){return A_._create("startAfter",n,!1)}var x_=class n extends Ia{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=NV(e,this.type,this._docOrFields,this._inclusive);return new Xt(e.firestore,e.converter,function(i,s){return new Lr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function xV(...n){return x_._create("endBefore",n,!1)}function RV(...n){return x_._create("endAt",n,!0)}function NV(n,e,t,r){if(t[0]=G(t[0]),t[0]instanceof wa)return function(s,o,a,c,l){if(!c)throw new F(O.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of al(s))if(h.field.isKeyField())d.push(ha(o,c.key));else{let p=c.data.field(h.field);if(N_(p))throw new F(O.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let _=h.field.canonicalString();throw new F(O.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(p)}return new Ii(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=ba(n.firestore);return function(o,a,c,l,d,h){let p=o.explicitOrderBy;if(d.length>p.length)throw new F(O.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let _=[];for(let w=0;w<d.length;w++){let A=d[w];if(p[w].field.isKeyField()){if(typeof A!="string")throw new F(O.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof A}`);if(!aS(o)&&A.indexOf("/")!==-1)throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${A}' contains a slash.`);let R=o.path.child(ke.fromString(A));if(!K.isDocumentKey(R))throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let L=new K(R);_.push(ha(a,L))}else{let R=vV(c,l,A);_.push(R)}}return new Ii(_,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function EF(n,e,t){if(typeof(t=G(t))=="string"){if(t==="")throw new F(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!aS(e)&&t.indexOf("/")!==-1)throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ke.fromString(t));if(!K.isDocumentKey(r))throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ha(n,new K(r))}if(t instanceof Ze)return ha(n,t._key);throw new F(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${O_(t)}.`)}function bF(n,e){if(!Array.isArray(n)||n.length===0)throw new F(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function PV(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new F(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new F(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Tl=class{convertValue(e,t="none"){switch(da(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Z()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Ea(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new va(wt(e.latitude),wt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=sS(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(uh(e));default:return null}}convertTimestamp(e){let t=Yi(e);return new ft(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ke.fromString(e);ne(bL(r));let i=new Gs(r.get(1),r.get(3)),s=new K(r.popFirst(5));return i.isEqual(t)||Ct(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function U_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var eS=class extends Tl{constructor(e){super(),this.firestore=e}convertBytes(e){return new bi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ze(this.firestore,null,t)}};function fQ(){return new $T("count")}var Qi=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},vr=class extends wa{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new $s(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(L_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},$s=class extends vr{data(e={}){return super.data(e)}},Br=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Qi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new $s(this._firestore,this._userDataWriter,r.key,r,new Qi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new $s(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Qi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new $s(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Qi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:pQ(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function pQ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Z()}}function FS(n,e){return n instanceof vr&&e instanceof vr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Br&&e instanceof Br&&n._firestore===e._firestore&&NS(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function MV(n){n=Ae(n,Ze);let e=Ae(n.firestore,it);return ZL(Lt(e),n._key).then(t=>US(e,n,t))}var Ci=class extends Tl{constructor(e){super(),this.firestore=e}convertBytes(e){return new bi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ze(this.firestore,null,t)}};function kV(n){n=Ae(n,Ze);let e=Ae(n.firestore,it),t=Lt(e),r=new Ci(e);return sQ(t,n._key).then(i=>new vr(e,r,n._key,i,new Qi(i!==null&&i.hasLocalMutations,!0),n.converter))}function OV(n){n=Ae(n,Ze);let e=Ae(n.firestore,it);return ZL(Lt(e),n._key,{source:"server"}).then(t=>US(e,n,t))}function FV(n){n=Ae(n,Xt);let e=Ae(n.firestore,it),t=Lt(e),r=new Ci(e);return bV(n._query),eV(t,n._query).then(i=>new Br(e,r,n,i))}function LV(n){n=Ae(n,Xt);let e=Ae(n.firestore,it),t=Lt(e),r=new Ci(e);return oQ(t,n._query).then(i=>new Br(e,r,n,i))}function VV(n){n=Ae(n,Xt);let e=Ae(n.firestore,it),t=Lt(e),r=new Ci(e);return eV(t,n._query,{source:"server"}).then(i=>new Br(e,r,n,i))}function LS(n,e,t){n=Ae(n,Ze);let r=Ae(n.firestore,it),i=U_(n.converter,e,t);return Pl(r,[F_(ba(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,It.none())])}function VS(n,e,t,...r){n=Ae(n,Ze);let i=Ae(n.firestore,it),s=ba(i),o;return o=typeof(e=G(e))=="string"||e instanceof Ur?MS(s,"updateDoc",n._key,e,t,r):PS(s,"updateDoc",n._key,e),Pl(i,[o.toMutation(n._key,It.exists(!0))])}function UV(n){return Pl(Ae(n.firestore,it),[new Js(n._key,It.none())])}function BV(n,e){let t=Ae(n.firestore,it),r=Oh(n),i=U_(n.converter,e);return Pl(t,[F_(ba(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,It.exists(!1))]).then(()=>r)}function Ta(n,...e){var t,r,i;n=G(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||BT(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(BT(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,d;if(n instanceof Ze)l=Ae(n.firestore,it),d=Dl(n._key.path),c={next:h=>{e[o]&&e[o](US(l,n,h))},error:e[o+1],complete:e[o+2]};else{let h=Ae(n,Xt);l=Ae(h.firestore,it),d=h._query;let p=new Ci(l);c={next:_=>{e[o]&&e[o](new Br(l,p,h,_))},error:e[o+1],complete:e[o+2]},bV(n._query)}return function(p,_,w,A){let R=new bl(A),L=new Ch(_,R,w);return p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return _S(yield Cl(p),L)})),()=>{R.$a(),p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return yS(yield Cl(p),L)}))}}(Lt(l),d,a,c)}function jV(n,e){return cQ(Lt(n=Ae(n,it)),BT(e)?e:{next:e})}function Pl(n,e){return function(r,i){let s=new Tt;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return j7(yield DS(r),i,s)})),s.promise}(Lt(n),e)}function US(n,e,t){let r=t.docs.get(e._key),i=new Ci(n);return new vr(n,i,e._key,r,new Qi(t.hasPendingWrites,t.fromCache),e.converter)}function Fh(n){return mQ(n,{count:fQ()})}function mQ(n,e){let t=Ae(n.firestore,it),r=Lt(t),i=UK(e,(s,o)=>new xC(o,s.aggregateType,s._internalFieldPath));return aQ(r,n._query,i).then(s=>function(a,c,l){let d=new Ci(a);return new HT(c,d,l)}(t,n,s))}var gQ={maxAttempts:5};var R_=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ba(e)}set(e,t,r){this._verifyNotCommitted();let i=Bs(e,this._firestore),s=U_(i.converter,t,r),o=F_(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,It.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=Bs(e,this._firestore),o;return o=typeof(t=G(t))=="string"||t instanceof Ur?MS(this._dataReader,"WriteBatch.update",s._key,t,r,i):PS(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,It.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Bs(e,this._firestore);return this._mutations=this._mutations.concat(new Js(t._key,It.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new F(O.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Bs(n,e){if((n=G(n)).firestore!==e)throw new F(O.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var tS=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=ba(t)}get(t){let r=Bs(t,this._firestore),i=new eS(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Z();let o=s[0];if(o.isFoundDocument())return new wa(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new wa(this._firestore,i,r._key,null,r.converter);throw Z()})}set(t,r,i){let s=Bs(t,this._firestore),o=U_(s.converter,r,i),a=F_(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=Bs(t,this._firestore),a;return a=typeof(r=G(r))=="string"||r instanceof Ur?MS(this._dataReader,"Transaction.update",o._key,r,i,s):PS(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=Bs(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Bs(e,this._firestore),r=new Ci(this._firestore);return super.get(e).then(i=>new vr(this._firestore,r,t._key,i._document,new Qi(!1,!1),t.converter))}};function $V(n,e,t){n=Ae(n,it);let r=Object.assign(Object.assign({},gQ),t);return function(s){if(s.maxAttempts<1)throw new F(O.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new Tt;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let l=yield XL(s);new FT(s.asyncQueue,l,a,o,c).Xa()})),c.promise}(Lt(n),i=>e(new tS(n,i)),r)}function HV(){return new Dh("deleteField")}function qV(){return new GT("serverTimestamp")}function zV(...n){return new WT("arrayUnion",n)}function GV(...n){return new KT("arrayRemove",n)}function WV(n){return new QT("increment",n)}(function(e,t=!0){(function(i){Sl=i})(In),wn(new qe("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new it(new rC(r.getProvider("auth-internal")),new aC(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new F(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gs(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),bt(C1,"4.6.3",e),bt(C1,"4.6.3","esm2017")})();var _Q="@firebase/firestore-compat",yQ="0.3.32";function zS(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new F("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function KV(){if(typeof Uint8Array>"u")throw new F("unimplemented","Uint8Arrays are not available in this environment.")}function QV(){if(!UF())throw new F("unimplemented","Blobs are unavailable in Firestore in this environment.")}var B_=class n{constructor(e){this._delegate=e}static fromBase64String(e){return QV(),new n(bi.fromBase64String(e))}static fromUint8Array(e){return KV(),new n(bi.fromUint8Array(e))}toBase64(){return QV(),this._delegate.toBase64()}toUint8Array(){return KV(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function BS(n){return vQ(n,["next","error","complete"])}function vQ(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var jS=class{enableIndexedDbPersistence(e,t){return aV(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return cV(e._delegate)}clearIndexedDbPersistence(e){return uV(e._delegate)}},j_=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Gs||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&_r("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){rV(this._delegate,e,t,r)}enableNetwork(){return hV(this._delegate)}disableNetwork(){return fV(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,xS("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return dV(this._delegate)}onSnapshotsInSync(e){return jV(this._delegate,e)}get app(){if(!this._appCompat)throw new F("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ol(this,jr(this._delegate,e))}catch(t){throw Cn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ti(this,Oh(this._delegate,e))}catch(t){throw Cn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new xa(this,iV(this._delegate,e))}catch(t){throw Cn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return $V(this._delegate,t=>e(new $_(this,t)))}batch(){return Lt(this._delegate),new H_(new R_(this._delegate,e=>Pl(this._delegate,e)))}loadBundle(e){return pV(this._delegate,e)}namedQuery(e){return mV(this._delegate,e).then(t=>t?new xa(this,t):null)}},Ml=class extends Tl{constructor(e){super(),this.firestore=e}convertBytes(e){return new B_(new bi(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Ti.forKey(t,this.firestore,null)}};function wQ(n){TF(n)}var $_=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Ml(e)}get(e){let t=Sa(e);return this._delegate.get(t).then(r=>new Da(this._firestore,new vr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Sa(e);return r?(zS("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Sa(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Sa(e);return this._delegate.delete(t),this}},H_=class{constructor(e){this._delegate=e}set(e,t,r){let i=Sa(e);return r?(zS("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Sa(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Sa(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},kl=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new $s(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Aa(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new Ml(e),t),i.set(t,s)),s}};kl.INSTANCES=new WeakMap;var Ti=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ml(e)}static forPath(e,t,r){if(e.length%2!==0)throw new F("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Ze(t._delegate,r,new K(e)))}static forKey(e,t,r){return new n(t,new Ze(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ol(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ol(this.firestore,jr(this._delegate,e))}catch(t){throw Cn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=G(e),e instanceof Ze?RS(this._delegate,e):!1}set(e,t){t=zS("DocumentReference.set",t);try{return t?LS(this._delegate,e,t):LS(this._delegate,e)}catch(r){throw Cn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?VS(this._delegate,e):VS(this._delegate,e,t,...r)}catch(i){throw Cn(i,"updateDoc()","DocumentReference.update()")}}delete(){return UV(this._delegate)}onSnapshot(...e){let t=YV(e),r=JV(e,i=>new Da(this.firestore,new vr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Ta(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=kV(this._delegate):e?.source==="server"?t=OV(this._delegate):t=MV(this._delegate),t.then(r=>new Da(this.firestore,new vr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(kl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Cn(n,e,t){return n.message=n.message.replace(e,t),n}function YV(n){for(let e of n)if(typeof e=="object"&&!BS(e))return e;return{}}function JV(n,e){var t,r;let i;return BS(n[0])?i=n[0]:BS(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Da=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ti(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return FS(this._delegate,e._delegate)}},Aa=class extends Da{data(e){let t=this._delegate.data(e);return this._delegate._converter||SF(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},xa=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ml(e)}where(e,t,r){try{return new n(this.firestore,$r(this._delegate,V_(e,t,r)))}catch(i){throw Cn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,$r(this._delegate,CV(e,t)))}catch(r){throw Cn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,$r(this._delegate,TV(e)))}catch(t){throw Cn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,$r(this._delegate,SV(e)))}catch(t){throw Cn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,$r(this._delegate,DV(...e)))}catch(t){throw Cn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,$r(this._delegate,AV(...e)))}catch(t){throw Cn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,$r(this._delegate,xV(...e)))}catch(t){throw Cn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,$r(this._delegate,RV(...e)))}catch(t){throw Cn(t,"endAt()","Query.endAt()")}}isEqual(e){return NS(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=LV(this._delegate):e?.source==="server"?t=VV(this._delegate):t=FV(this._delegate),t.then(r=>new Lh(this.firestore,new Br(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=YV(e),r=JV(e,i=>new Lh(this.firestore,new Br(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Ta(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(kl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},$S=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Aa(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Lh=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new xa(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Aa(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new $S(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Aa(this._firestore,r))})}isEqual(e){return FS(this._delegate,e._delegate)}},Ol=class n extends xa{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Ti(this.firestore,e):null}doc(e){try{return e===void 0?new Ti(this.firestore,Oh(this._delegate)):new Ti(this.firestore,Oh(this._delegate,e))}catch(t){throw Cn(t,"doc()","CollectionReference.doc()")}}add(e){return BV(this._delegate,e).then(t=>new Ti(this.firestore,t))}isEqual(e){return RS(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(kl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Sa(n){return Ae(n,Ze)}var HS=class n{constructor(...e){this._delegate=new Ur(...e)}static documentId(){return new n(St.keyField().canonicalString())}isEqual(e){return e=G(e),e instanceof Ur?this._delegate._internalPath.isEqual(e._internalPath):!1}};var qS=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=qV();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=HV();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=zV(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=GV(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=WV(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var IQ={Firestore:j_,GeoPoint:va,Timestamp:ft,Blob:B_,Transaction:$_,WriteBatch:H_,DocumentReference:Ti,DocumentSnapshot:Da,Query:xa,QueryDocumentSnapshot:Aa,QuerySnapshot:Lh,CollectionReference:Ol,FieldPath:HS,FieldValue:qS,setLogLevel:wQ,CACHE_SIZE_UNLIMITED:sV};function EQ(n,e){n.INTERNAL.registerComponent(new qe("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},IQ)))}function bQ(n){EQ(n,(e,t)=>new j_(e,t,new jS)),n.registerVersion(_Q,yQ)}bQ($);var o2="firebasestorage.googleapis.com",a2="storageBucket",CQ=2*60*1e3,TQ=10*60*1e3,SQ=1e3;var pt=class n extends _t{constructor(e,t,r=0){super(GS(e),`Firebase Storage: ${t} (${GS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return GS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},ct=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(ct||{});function GS(n){return"storage/"+n}function eD(){let n="An unknown error occurred, please check the error payload for server response.";return new pt(ct.UNKNOWN,n)}function DQ(n){return new pt(ct.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function AQ(n){return new pt(ct.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function xQ(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new pt(ct.UNAUTHENTICATED,n)}function RQ(){return new pt(ct.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function NQ(n){return new pt(ct.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function c2(){return new pt(ct.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function l2(){return new pt(ct.CANCELED,"User canceled the upload/download.")}function PQ(n){return new pt(ct.INVALID_URL,"Invalid URL '"+n+"'.")}function MQ(n){return new pt(ct.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function kQ(){return new pt(ct.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+a2+"' property when initializing the app?")}function u2(){return new pt(ct.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function OQ(){return new pt(ct.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function FQ(){return new pt(ct.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function LQ(n){return new pt(ct.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ra(n){return new pt(ct.INVALID_ARGUMENT,n)}function d2(){return new pt(ct.APP_DELETED,"The Firebase app was deleted.")}function tD(n){return new pt(ct.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Uh(n,e){return new pt(ct.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Vh(n){throw new pt(ct.INTERNAL_ERROR,"Internal error: "+n)}var Tn=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw MQ(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(X){X.path.charAt(X.path.length-1)==="/"&&(X.path_=X.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(X){X.path_=decodeURIComponent(X.path)}let d="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",_=new RegExp(`^https?://${h}/${d}/b/${i}/o${p}`,"i"),w={bucket:1,path:3},A=t===o2?"(?:storage.googleapis.com|storage.cloud.google.com)":t,R="([^?#]*)",L=new RegExp(`^https?://${A}/${i}/${R}`,"i"),B=[{regex:a,indices:c,postModify:s},{regex:_,indices:w,postModify:l},{regex:L,indices:{bucket:1,path:2},postModify:l}];for(let X=0;X<B.length;X++){let le=B[X],te=le.regex.exec(e);if(te){let T=te[le.indices.bucket],v=te[le.indices.path];v||(v=""),r=new n(T,v),le.postModify(r);break}}if(r==null)throw PQ(e);return r}},KS=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function VQ(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...R){l||(l=!0,e.apply(null,R))}function h(R){i=setTimeout(()=>{i=null,n(_,c())},R)}function p(){s&&clearTimeout(s)}function _(R,...L){if(l){p();return}if(R){p(),d.call(null,R,...L);return}if(c()||o){p(),d.call(null,R,...L);return}r<64&&(r*=2);let B;a===1?(a=2,B=0):B=(r+Math.random())*1e3,h(B)}let w=!1;function A(R){w||(w=!0,p(),!l&&(i!==null?(R||(a=2),clearTimeout(i),h(0)):R||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,A(!0)},t),A}function UQ(n){n(!1)}function BQ(n){return n!==void 0}function jQ(n){return typeof n=="function"}function $Q(n){return typeof n=="object"&&!Array.isArray(n)}function G_(n){return typeof n=="string"||n instanceof String}function XV(n){return nD()&&n instanceof Blob}function nD(){return typeof Blob<"u"}function QS(n,e,t,r){if(r<e)throw Ra(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Ra(`Invalid value for '${n}'. Expected ${t} or less.`)}function no(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function h2(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Vl=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Vl||{});function f2(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var YS=class{constructor(e,t,r,i,s,o,a,c,l,d,h,p=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,w)=>{this.resolve_=_,this.reject_=w,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Ll(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Vl.NO_ERROR,c=s.getStatus();if(!a||f2(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===Vl.ABORT;r(!1,new Ll(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new Ll(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());BQ(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=eD();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?d2():l2();o(c)}else{let c=c2();o(c)}};this.canceled_?t(!1,new Ll(!1,null,!0)):this.backoffId_=VQ(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&UQ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Ll=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function HQ(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function qQ(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function zQ(n,e){e&&(n["X-Firebase-GMPID"]=e)}function GQ(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function WQ(n,e,t,r,i,s,o=!0){let a=h2(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return zQ(l,e),HQ(l,t),qQ(l,s),GQ(l,r),new YS(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function KQ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function QQ(...n){let e=KQ();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(nD())return new Blob(n);throw new pt(ct.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function YQ(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function JQ(n){if(typeof atob>"u")throw LQ("base-64");return atob(n)}var Jn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Bh=class{constructor(e,t){this.data=e,this.contentType=t||null}};function rD(n,e){switch(n){case Jn.RAW:return new Bh(p2(e));case Jn.BASE64:case Jn.BASE64URL:return new Bh(m2(n,e));case Jn.DATA_URL:return new Bh(ZQ(e),eY(e))}throw eD()}function p2(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function XQ(n){let e;try{e=decodeURIComponent(n)}catch{throw Uh(Jn.DATA_URL,"Malformed data URL.")}return p2(e)}function m2(n,e){switch(n){case Jn.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Uh(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Jn.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Uh(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=JQ(e)}catch(i){throw i.message.includes("polyfill")?i:Uh(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var z_=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw Uh(Jn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=tY(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function ZQ(n){let e=new z_(n);return e.base64?m2(Jn.BASE64,e.rest):XQ(e.rest)}function eY(n){return new z_(n).contentType}function tY(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var Ul=class n{constructor(e,t){let r=0,i="";XV(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(XV(this.data_)){let r=this.data_,i=YQ(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(nD()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(QQ.apply(null,t))}else{let t=e.map(o=>G_(o)?rD(Jn.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function iD(n){let e;try{e=JSON.parse(n)}catch{return null}return $Q(e)?e:null}function nY(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function rY(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function g2(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function iY(n,e){return e}var Zt=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||iY}},q_=null;function sY(n){return!G_(n)||n.length<2?n:g2(n)}function W_(){if(q_)return q_;let n=[];n.push(new Zt("bucket")),n.push(new Zt("generation")),n.push(new Zt("metageneration")),n.push(new Zt("name","fullPath",!0));function e(s,o){return sY(o)}let t=new Zt("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new Zt("size");return i.xform=r,n.push(i),n.push(new Zt("timeCreated")),n.push(new Zt("updated")),n.push(new Zt("md5Hash",null,!0)),n.push(new Zt("cacheControl",null,!0)),n.push(new Zt("contentDisposition",null,!0)),n.push(new Zt("contentEncoding",null,!0)),n.push(new Zt("contentLanguage",null,!0)),n.push(new Zt("contentType",null,!0)),n.push(new Zt("metadata","customMetadata",!0)),q_=n,q_}function oY(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new Tn(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function aY(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return oY(r,n),r}function _2(n,e,t){let r=iD(e);return r===null?null:aY(n,r,t)}function cY(n,e,t,r){let i=iD(e);if(i===null||!G_(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=n.bucket,h=n.fullPath,p="/b/"+o(d)+"/o/"+o(h),_=no(p,t,r),w=h2({alt:"media",token:l});return _+w})[0]}function sD(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var ZV="prefixes",e2="items";function lY(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[ZV])for(let i of t[ZV]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new Tn(e,s));r.prefixes.push(o)}if(t[e2])for(let i of t[e2]){let s=n._makeStorageReference(new Tn(e,i.name));r.items.push(s)}return r}function uY(n,e,t){let r=iD(t);return r===null?null:lY(n,e,r)}var Hr=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Di(n){if(!n)throw eD()}function K_(n,e){function t(r,i){let s=_2(n,i,e);return Di(s!==null),s}return t}function dY(n,e){function t(r,i){let s=uY(n,e,i);return Di(s!==null),s}return t}function hY(n,e){function t(r,i){let s=_2(n,i,e);return Di(s!==null),cY(s,i,n.host,n._protocol)}return t}function $l(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=RQ():i=xQ():t.getStatus()===402?i=AQ(n.bucket):t.getStatus()===403?i=NQ(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Q_(n){let e=$l(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=DQ(n.path)),s.serverResponse=i.serverResponse,s}return t}function y2(n,e,t){let r=e.fullServerUrl(),i=no(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Hr(i,s,K_(n,t),o);return a.errorHandler=Q_(e),a}function fY(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=no(o,n.host,n._protocol),c="GET",l=n.maxOperationRetryTime,d=new Hr(a,c,dY(n,e.bucket),l);return d.urlParams=s,d.errorHandler=$l(e),d}function pY(n,e,t){let r=e.fullServerUrl(),i=no(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Hr(i,s,hY(n,t),o);return a.errorHandler=Q_(e),a}function mY(n,e,t,r){let i=e.fullServerUrl(),s=no(i,n.host,n._protocol),o="PATCH",a=sD(t,r),c={"Content-Type":"application/json; charset=utf-8"},l=n.maxOperationRetryTime,d=new Hr(s,o,K_(n,r),l);return d.headers=c,d.body=a,d.errorHandler=Q_(e),d}function gY(n,e){let t=e.fullServerUrl(),r=no(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,l){}let a=new Hr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=Q_(e),a}function _Y(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function v2(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=_Y(null,e)),r}function yY(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let B="";for(let X=0;X<2;X++)B=B+Math.random().toString().slice(2);return B}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let l=v2(e,r,i),d=sD(l,t),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,p=`\r
--`+c+"--",_=Ul.getBlob(h,r,p);if(_===null)throw u2();let w={name:l.fullPath},A=no(s,n.host,n._protocol),R="POST",L=n.maxUploadRetryTime,Q=new Hr(A,R,K_(n,t),L);return Q.urlParams=w,Q.headers=o,Q.body=_.uploadData(),Q.errorHandler=$l(e),Q}var Bl=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function oD(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{Di(!1)}return Di(!!t&&(e||["active"]).indexOf(t)!==-1),t}function vY(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=v2(e,r,i),a={name:o.fullPath},c=no(s,n.host,n._protocol),l="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=sD(o,t),p=n.maxUploadRetryTime;function _(A){oD(A);let R;try{R=A.getResponseHeader("X-Goog-Upload-URL")}catch{Di(!1)}return Di(G_(R)),R}let w=new Hr(c,l,_,p);return w.urlParams=a,w.headers=d,w.body=h,w.errorHandler=$l(e),w}function wY(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(l){let d=oD(l,["active","final"]),h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Di(!1)}h||Di(!1);let p=Number(h);return Di(!isNaN(p)),new Bl(p,r.size(),d==="final")}let o="POST",a=n.maxUploadRetryTime,c=new Hr(t,o,s,a);return c.headers=i,c.errorHandler=$l(e),c}var t2=256*1024;function IY(n,e,t,r,i,s,o,a){let c=new Bl(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw OQ();let l=c.total-c.current,d=l;i>0&&(d=Math.min(d,i));let h=c.current,p=h+d,_="";d===0?_="finalize":l===d?_="upload, finalize":_="upload";let w={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${c.current}`},A=r.slice(h,p);if(A===null)throw u2();function R(X,le){let te=oD(X,["active","final"]),T=c.current+d,v=r.size(),E;return te==="final"?E=K_(e,s)(X,le):E=null,new Bl(T,v,te==="final",E)}let L="POST",Q=e.maxUploadRetryTime,B=new Hr(t,L,R,Q);return B.headers=w,B.body=A.uploadData(),B.progressCallback=a||null,B.errorHandler=$l(n),B}var w2={STATE_CHANGED:"state_changed"},fn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function WS(n){switch(n){case"running":case"pausing":case"canceling":return fn.RUNNING;case"paused":return fn.PAUSED;case"success":return fn.SUCCESS;case"canceled":return fn.CANCELED;case"error":return fn.ERROR;default:return fn.ERROR}}var JS=class{constructor(e,t,r){if(jQ(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Fl(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var n2=null,XS=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Vl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Vl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Vl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw Vh("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Vh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Vh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Vh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Vh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},ZS=class extends XS{initXhr(){this.xhr_.responseType="text"}};function Si(){return n2?n2():new ZS}var jh=class{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=W_(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(ct.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(f2(i.status,[]))if(s)i=c2();else{this.sleepTime=Math.max(this.sleepTime*2,SQ),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(ct.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=vY(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Si,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=wY(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Si,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=t2*this._chunkMultiplier,t=new Bl(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=IY(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,Si,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){t2*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=y2(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Si,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=yY(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Si,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=l2(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=WS(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new JS(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(WS(this._state)){case fn.SUCCESS:Fl(this._resolve.bind(null,this.snapshot))();break;case fn.CANCELED:case fn.ERROR:let t=this._reject;Fl(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(WS(this._state)){case fn.RUNNING:case fn.PAUSED:e.next&&Fl(e.next.bind(e,this.snapshot))();break;case fn.SUCCESS:e.complete&&Fl(e.complete.bind(e))();break;case fn.CANCELED:case fn.ERROR:e.error&&Fl(e.error.bind(e,this._error))();break;default:e.error&&Fl(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var jl=class n{constructor(e,t){this._service=e,t instanceof Tn?this._location=t:this._location=Tn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Tn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return g2(this._location.path)}get storage(){return this._service}get parent(){let e=nY(this._location.path);if(e===null)return null;let t=new Tn(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw tD(e)}};function EY(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new jh(n,new Ul(e),t)}function bY(n){let e={prefixes:[],items:[]};return I2(n,e).then(()=>e)}function I2(n,e,t){return g(this,null,function*(){let i=yield E2(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield I2(n,e,i.nextPageToken))})}function E2(n,e){e!=null&&typeof e.maxResults=="number"&&QS("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=fY(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Si)}function CY(n){n._throwIfRoot("getMetadata");let e=y2(n.storage,n._location,W_());return n.storage.makeRequestWithTokens(e,Si)}function TY(n,e){n._throwIfRoot("updateMetadata");let t=mY(n.storage,n._location,e,W_());return n.storage.makeRequestWithTokens(t,Si)}function SY(n){n._throwIfRoot("getDownloadURL");let e=pY(n.storage,n._location,W_());return n.storage.makeRequestWithTokens(e,Si).then(t=>{if(t===null)throw FQ();return t})}function DY(n){n._throwIfRoot("deleteObject");let e=gY(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Si)}function b2(n,e){let t=rY(n._location.path,e),r=new Tn(n._location.bucket,t);return new jl(n.storage,r)}function AY(n){return/^[A-Za-z]+:\/\//.test(n)}function xY(n,e){return new jl(n,e)}function C2(n,e){if(n instanceof $h){let t=n;if(t._bucket==null)throw kQ();let r=new jl(t,t._bucket);return e!=null?C2(r,e):r}else return e!==void 0?b2(n,e):n}function RY(n,e){if(e&&AY(e)){if(n instanceof $h)return xY(n,e);throw Ra("To use ref(service, url), the first argument must be a Storage instance.")}else return C2(n,e)}function r2(n,e){let t=e?.[a2];return t==null?null:Tn.makeFromBucketSpec(t,n)}function NY(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:Oc(i,n.app.options.projectId))}var $h=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=o2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=CQ,this._maxUploadRetryTime=TQ,this._requests=new Set,i!=null?this._bucket=Tn.makeFromBucketSpec(i,this._host):this._bucket=r2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Tn.makeFromBucketSpec(this._url,e):this._bucket=r2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){QS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){QS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return g(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return g(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new jl(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new KS(d2());{let o=WQ(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return g(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},i2="@firebase/storage",s2="0.12.5";var PY="storage";function Y_(n,e,t){return n=G(n),EY(n,e,t)}function T2(n){return n=G(n),CY(n)}function S2(n,e){return n=G(n),TY(n,e)}function D2(n,e){return n=G(n),E2(n,e)}function A2(n){return n=G(n),bY(n)}function J_(n){return n=G(n),SY(n)}function X_(n){return n=G(n),DY(n)}function Na(n,e){return n=G(n),RY(n,e)}function x2(n,e){return b2(n,e)}function R2(n,e,t,r={}){NY(n,e,t,r)}function MY(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new $h(t,r,i,e,In)}function kY(){wn(new qe(PY,MY,"PUBLIC").setMultipleInstances(!0)),bt(i2,s2,""),bt(i2,s2,"esm2017")}kY();var Hl=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var Z_=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Hl(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new Hl(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new Hl(o,this,this._ref)):s={next:t.next?o=>t.next(new Hl(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},ey=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Pa(e,this._service))}get items(){return this._delegate.items.map(e=>new Pa(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var Pa=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=x2(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new Z_(Y_(this._delegate,e,t),this)}putString(e,t=Jn.RAW,r){this._throwIfRoot("putString");let i=rD(t,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new Z_(new jh(this._delegate,new Ul(i.data,!0),s),this)}listAll(){return A2(this._delegate).then(e=>new ey(e,this.storage))}list(e){return D2(this._delegate,e||void 0).then(t=>new ey(t,this.storage))}getMetadata(){return T2(this._delegate)}updateMetadata(e){return S2(this._delegate,e)}getDownloadURL(){return J_(this._delegate)}delete(){return this._throwIfRoot("delete"),X_(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw tD(e)}};var ty=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(N2(e))throw Ra("ref() expected a child path but got a URL, use refFromURL instead.");return new Pa(Na(this._delegate,e),this)}refFromURL(e){if(!N2(e))throw Ra("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Tn.makeFromUrl(e,this._delegate.host)}catch{throw Ra("refFromUrl() expected a valid full URL but got an invalid one.")}return new Pa(Na(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){R2(this._delegate,e,t,r)}};function N2(n){return/^[A-Za-z]+:\/\//.test(n)}var OY="@firebase/storage-compat",FY="0.3.8";var LY="storage-compat";function VY(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new ty(t,r)}function UY(n){let e={TaskState:fn,TaskEvent:w2,StringFormat:Jn,Storage:ty,Reference:Pa};n.INTERNAL.registerComponent(new qe(LY,VY,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(OY,FY)}UY($);var P2="@firebase/database",M2="1.0.5";var yA="";function vA(n){yA=n}var pD=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),xt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Mc(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var mD=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return vn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var uU=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new pD(e)}}catch{}return new mD},ka=uU("localStorage"),gD=uU("sessionStorage");var Wl=new Ln("@firebase/database"),dU=function(){let n=1;return function(){return n++}}(),hU=function(n){let e=Kk(n),t=new Lm;t.update(e);let r=t.digest();return Vm.encodeByteArray(r)},ff=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=ff.apply(null,r):typeof r=="object"?e+=xt(r):e+=r,e+=" "}return e},Oa=null,k2=!0,fU=function(n,e){j(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Wl.logLevel=ye.VERBOSE,Oa=Wl.log.bind(Wl),e&&gD.set("logging_enabled",!0)):typeof n=="function"?Oa=n:(Oa=null,gD.remove("logging_enabled"))},Wt=function(...n){if(k2===!0&&(k2=!1,Oa===null&&gD.get("logging_enabled")===!0&&fU(!0)),Oa){let e=ff.apply(null,n);Oa(e)}},pf=function(n){return function(...e){Wt(n,...e)}},_D=function(...n){let e="FIREBASE INTERNAL ERROR: "+ff(...n);Wl.error(e)},Ri=function(...n){let e=`FIREBASE FATAL ERROR: ${ff(...n)}`;throw Wl.error(e),new Error(e)},pn=function(...n){let e="FIREBASE WARNING: "+ff(...n);Wl.warn(e)},BY=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&pn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},xy=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},jY=function(n){if(ai()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},oo="[MIN_NAME]",ts="[MAX_NAME]",La=function(n,e){if(n===e)return 0;if(n===oo||e===ts)return-1;if(e===oo||n===ts)return 1;{let t=O2(n),r=O2(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},$Y=function(n,e){return n===e?0:n<e?-1:1},Hh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+xt(e))},wA=function(n){if(typeof n!="object"||n===null)return xt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=xt(e[r]),t+=":",t+=wA(n[e[r]]);return t+="}",t},pU=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Kt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var mU=function(n){j(!xy(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),h="";for(c=0;c<64;c+=8){let p=parseInt(d.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),h=h+p}return h.toLowerCase()},HY=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},qY=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function zY(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var GY=new RegExp("^-?(0*)\\d{1,10}$"),WY=-2147483648,KY=2147483647,O2=function(n){if(GY.test(n)){let e=Number(n);if(e>=WY&&e<=KY)return e}return null},nu=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw pn("Exception was thrown by user callback.",t),e},Math.floor(0))}},QY=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Wh=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var yD=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){pn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var vD=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Wt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',pn(e)}},Kh=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),ry="5",gU="v",_U="s",yU="r",vU="f",wU=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,IU="ls",EU="p",wD="ac",bU="websocket",CU="long_polling";var iy=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ka.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ka.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function YY(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function TU(n,e,t){j(typeof e=="string","typeof type must == string"),j(typeof t=="object","typeof params must == object");let r;if(e===bU)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===CU)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);YY(n)&&(t.ns=n.namespace);let i=[];return Kt(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var ID=class{constructor(){this.counters_={}}incrementCounter(e,t=1){vn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return $k(this.counters_)}};var aD={},cD={};function IA(n){let e=n.toString();return aD[e]||(aD[e]=new ID),aD[e]}function JY(n,e){let t=n.toString();return cD[t]||(cD[t]=e()),cD[t]}var ED=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&nu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var F2="start",XY="close",ZY="pLPCommand",eJ="pRTLPCB",SU="id",DU="pw",AU="ser",tJ="cb",nJ="seg",rJ="ts",iJ="d",sJ="dframe",xU=1870,RU=30,oJ=xU-RU,aJ=25e3,cJ=3e4,Xh=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=pf(e),this.stats_=IA(t),this.urlFn=c=>(this.appCheckToken&&(c[wD]=this.appCheckToken),TU(t,CU,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ED(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(cJ)),jY(()=>{if(this.isClosed_)return;this.scriptTagHolder=new bD((...s)=>{let[o,a,c,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===F2)this.id=a,this.password=c;else if(o===XY)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[F2]="t",r[AU]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[tJ]=this.scriptTagHolder.uniqueCallbackIdentifier),r[gU]=ry,this.transportSessionId&&(r[_U]=this.transportSessionId),this.lastSessionId&&(r[IU]=this.lastSessionId),this.applicationId&&(r[EU]=this.applicationId),this.appCheckToken&&(r[wD]=this.appCheckToken),typeof location<"u"&&location.hostname&&wU.test(location.hostname)&&(r[yU]=vU);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return ai()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!HY()&&!qY()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=xt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=jE(t),i=pU(r,oJ);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(ai())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[sJ]="t",r[SU]=e,r[DU]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=xt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},bD=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ai())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=dU(),window[ZY+this.uniqueCallbackIdentifier]=e,window[eJ+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Wt("frame writing exception"),a.stack&&Wt(a.stack),Wt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Wt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[SU]=this.myID,e[DU]=this.myPW,e[AU]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+RU+r.length<=xU;){let o=this.pendingSegs.shift();r=r+"&"+nJ+i+"="+o.seg+"&"+rJ+i+"="+o.ts+"&"+iJ+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(aJ)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){ai()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Wt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var lJ=16384,uJ=45e3,sy=null;typeof MozWebSocket<"u"?sy=MozWebSocket:typeof WebSocket<"u"&&(sy=WebSocket);var zl=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=pf(this.connId),this.stats_=IA(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[gU]=ry,!ai()&&typeof location<"u"&&location.hostname&&wU.test(location.hostname)&&(a[yU]=vU),r&&(a[_U]=r),i&&(a[IU]=i),s&&(a[wD]=s),o&&(a[EU]=o),TU(t,bU,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ka.set("previous_websocket_failure",!0);try{let i;if(ai()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${ry}/${yA}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new sy(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&sy!==null&&!n.forceDisallow_}static previouslyFailed(){return ka.isInMemoryStorage||ka.get("previous_websocket_failure")===!0}markConnectionHealthy(){ka.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Mc(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(j(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=xt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=pU(r,lJ);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(uJ))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),NU=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Xh,zl]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=zl&&zl.isAvailable(),i=r&&!zl.previouslyFailed();if(t.webSocketOnly&&(r||pn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[zl];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),dJ=6e4,hJ=5e3,fJ=10*1024,pJ=100*1024,lD="t",L2="d",mJ="s",V2="r",gJ="e",U2="o",B2="a",j2="n",$2="p",_J="h",CD=class{constructor(e,t,r,i,s,o,a,c,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=pf("c:"+this.id+":"),this.transportManager_=new NU(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Wh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>pJ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>fJ?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(lD in e){let t=e[lD];t===B2?this.upgradeIfSecondaryHealthy_():t===V2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===U2&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=Hh("t",e),r=Hh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:$2,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:B2,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:j2,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=Hh("t",e),r=Hh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=Hh(lD,e);if(L2 in e){let r=e[L2];if(t===_J){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===j2){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===mJ?this.onConnectionShutdown_(r):t===V2?this.onReset_(r):t===gJ?_D("Server Error: "+r):t===U2?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):_D("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),ry!==r&&pn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Wh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(dJ))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Wh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(hJ))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:$2,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ka.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var oy=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var ay=class{constructor(e){this.allowedEvents_=e,this.listeners_={},j(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){j(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var cy=class n extends ay{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Id()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return j(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var H2=32,q2=768,Ve=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Le(){return new Ve("")}function ve(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ao(n){return n.pieces_.length-n.pieceNum_}function Ye(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Ve(n.pieces_,e)}function EA(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function yJ(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Zh(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function PU(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Ve(e,0)}function lt(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Ve)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Ve(t,0)}function we(n){return n.pieceNum_>=n.pieces_.length}function Sn(n,e){let t=ve(n),r=ve(e);if(t===null)return e;if(t===r)return Sn(Ye(n),Ye(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function vJ(n,e){let t=Zh(n,0),r=Zh(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=La(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function bA(n,e){if(ao(n)!==ao(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function wr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(ao(n)>ao(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var TD=class{constructor(e,t){this.errorPrefix_=t,this.parts_=Zh(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=bd(this.parts_[r]);MU(this)}};function wJ(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=bd(e),MU(n)}function IJ(n){let e=n.parts_.pop();n.byteLength_-=bd(e),n.parts_.length>0&&(n.byteLength_-=1)}function MU(n){if(n.byteLength_>q2)throw new Error(n.errorPrefix_+"has a key path longer than "+q2+" bytes ("+n.byteLength_+").");if(n.parts_.length>H2)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+H2+") or object contains a cycle "+Ma(n))}function Ma(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var SD=class n extends ay{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return j(e==="visible","Unknown event type: "+e),[this.visible_]}};var qh=1e3,EJ=60*5*1e3,z2=30*1e3,bJ=1.3,CJ=3e4,TJ="server_kill",G2=3,CA=(()=>{class n extends oy{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=pf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=qh,this.maxReconnectDelay_=EJ,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!ai())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");SD.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&cy.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(xt(o)),j(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new Ut,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),j(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),j(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,d=c.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&vn(t,"w")){let i=Ts(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();pn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||Wk(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=z2)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=Gk(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),j(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+xt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):_D("Unrecognized action received from server: "+xt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){j(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=qh,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=qh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>CJ&&(this.reconnectDelay_=qh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*bJ)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},d=function(p){j(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(p)};this.realtime_={close:l,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[p,_]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?Wt("getToken() completed but was canceled"):(Wt("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=_&&_.token,c=new CD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,w=>{pn(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(TJ)},o))}catch(p){this.log_("Failed to get token: "+p),a||(this.repoInfo_.nodeAdmin&&pn(p),l())}}})}interrupt(t){Wt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Wt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Fc(this.interruptReasons_)&&(this.reconnectDelay_=qh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>wA(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new Ve(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Wt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=G2&&(this.reconnectDelay_=z2,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Wt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=G2&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";ai()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+yA.replace(/\./g,"-")]=1,Id()?t["framework.cordova"]=1:Bo()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=cy.getInstance().currentlyOnline();return Fc(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),Ee=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Kl=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new Ee(oo,e),i=new Ee(oo,t);return this.compare(r,i)!==0}minPost(){return Ee.MIN}};var ny,ly=class extends Kl{static get __EMPTY_NODE(){return ny}static set __EMPTY_NODE(e){ny=e}compare(e,t){return La(e.name,t.name)}isDefinedOn(e){throw Uo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ee.MIN}maxPost(){return new Ee(ts,ny)}makePost(e,t){return j(typeof e=="string","KeyIndex indexValue must always be a string."),new Ee(e,ny)}toString(){return".key"}},xi=new ly;var Gl=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},qr=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Ir.EMPTY_NODE,this.right=o??Ir.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ir.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Ir.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),DD=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new qr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Ir=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,qr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,qr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Gl(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Gl(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Gl(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Gl(this.root_,null,this.comparator_,!0,e)}};Ir.EMPTY_NODE=new DD;function SJ(n,e){return La(n.name,e.name)}function TA(n,e){return La(n,e)}var AD;function DJ(n){AD=n}var kU=function(n){return typeof n=="number"?"number:"+mU(n):"string:"+n},OU=function(n){if(n.isLeafNode()){let e=n.val();j(typeof e=="string"||typeof e=="number"||typeof e=="object"&&vn(e,".sv"),"Priority must be a string or number.")}else j(n===AD||n.isEmpty(),"priority of unexpected type.");j(n===AD||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var W2,Ql=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,j(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),OU(this.priorityNode_)}static set __childrenNodeConstructor(t){W2=t}static get __childrenNodeConstructor(){return W2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return we(t)?this:ve(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=ve(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(j(i!==".priority"||ao(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ye(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+kU(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=mU(this.value_):t+=this.value_,this.lazyHash_=hU(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(j(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return j(s>=0,"Unknown leaf type: "+r),j(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),FU,LU;function AJ(n){FU=n}function xJ(n){LU=n}var xD=class extends Kl{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?La(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ee.MIN}maxPost(){return new Ee(ts,new Ql("[PRIORITY-POST]",LU))}makePost(e,t){let r=FU(e);return new Ee(t,new Ql("[PRIORITY-POST]",r))}toString(){return".priority"}},et=new xD;var RJ=Math.log(2),RD=class{constructor(e){let t=s=>parseInt(Math.log(s)/RJ,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},uy=function(n,e,t,r){n.sort(e);let i=function(c,l){let d=l-c,h,p;if(d===0)return null;if(d===1)return h=n[c],p=t?t(h):h,new qr(p,h.node,qr.BLACK,null,null);{let _=parseInt(d/2,10)+c,w=i(c,_),A=i(_+1,l);return h=n[_],p=t?t(h):h,new qr(p,h.node,qr.BLACK,w,A)}},s=function(c){let l=null,d=null,h=n.length,p=function(w,A){let R=h-w,L=h;h-=w;let Q=i(R+1,L),B=n[R],X=t?t(B):B;_(new qr(X,B.node,A,null,Q))},_=function(w){l?(l.left=w,l=w):(d=w,l=w)};for(let w=0;w<c.count;++w){let A=c.nextBitIsOne(),R=Math.pow(2,c.count-(w+1));A?p(R,qr.BLACK):(p(R,qr.BLACK),p(R,qr.RED))}return d},o=new RD(n.length),a=s(o);return new Ir(r||e,a)};var uD,ql={},Yl=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return j(ql&&et,"ChildrenNode.ts has not been loaded"),uD=uD||new n({".priority":ql},{".priority":et}),uD}get(e){let t=Ts(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Ir?t:null}hasIndex(e){return vn(this.indexSet_,e.toString())}addIndex(e,t){j(e!==xi,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(Ee.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=uy(r,e.getCompare()):a=ql;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,l)}addToIndexes(e,t){let r=Ed(this.indexes_,(i,s)=>{let o=Ts(this.indexSet_,s);if(j(o,"Missing index implementation for "+s),i===ql)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(Ee.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),uy(a,o.getCompare())}else return ql;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new Ee(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Ed(this.indexes_,i=>{if(i===ql)return i;{let s=t.get(e.name);return s?i.remove(new Ee(e.name,s)):i}});return new n(r,this.indexSet_)}};var zh,me=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&OU(this.priorityNode_),this.children_.isEmpty()&&j(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return zh||(zh=new n(new Ir(TA),null,Yl.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||zh}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?zh:r}}getChild(t){let r=ve(t);return r===null?this:this.getImmediateChild(r).getChild(Ye(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(j(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new Ee(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?zh:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=ve(t);if(i===null)return r;{j(ve(t)!==".priority"||ao(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ye(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(et,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+kU(this.getPriority().val())+":"),this.forEachChild(et,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":hU(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new Ee(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new Ee(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new Ee(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,Ee.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,Ee.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===mf?-1:0}withIndex(t){if(t===xi||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===xi||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(et),s=r.getIterator(et),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===xi?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),ND=class extends me{constructor(){super(new Ir(TA),me.EMPTY_NODE,Yl.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return me.EMPTY_NODE}isEmpty(){return!1}},mf=new ND;Object.defineProperties(Ee,{MIN:{value:new Ee(oo,me.EMPTY_NODE)},MAX:{value:new Ee(ts,mf)}});ly.__EMPTY_NODE=me.EMPTY_NODE;Ql.__childrenNodeConstructor=me;DJ(mf);xJ(mf);var NJ=!0;function mt(n,e=null){if(n===null)return me.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),j(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Ql(t,mt(e))}if(!(n instanceof Array)&&NJ){let t=[],r=!1;if(Kt(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=mt(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Ee(o,c)))}}),t.length===0)return me.EMPTY_NODE;let s=uy(t,SJ,o=>o.name,TA);if(r){let o=uy(t,et.getCompare());return new me(s,mt(e),new Yl({".priority":o},{".priority":et}))}else return new me(s,mt(e),Yl.Default)}else{let t=me.EMPTY_NODE;return Kt(n,(r,i)=>{if(vn(n,r)&&r.substring(0,1)!=="."){let s=mt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(mt(e))}}AJ(mt);var ef=class extends Kl{constructor(e){super(),this.indexPath_=e,j(!we(e)&&ve(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?La(e.name,t.name):s}makePost(e,t){let r=mt(e),i=me.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ee(t,i)}maxPost(){let e=me.EMPTY_NODE.updateChild(this.indexPath_,mf);return new Ee(ts,e)}toString(){return Zh(this.indexPath_,0).join("/")}};var PD=class extends Kl{compare(e,t){let r=e.node.compareTo(t.node);return r===0?La(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ee.MIN}maxPost(){return Ee.MAX}makePost(e,t){let r=mt(e);return new Ee(t,r)}toString(){return".value"}},SA=new PD;function VU(n){return{type:"value",snapshotNode:n}}function Jl(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function tf(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function nf(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function PJ(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var rf=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){j(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(tf(t,a)):j(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Jl(t,r)):o.trackChildChange(nf(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(et,(i,s)=>{t.hasChild(i)||r.trackChildChange(tf(i,s))}),t.isLeafNode()||t.forEachChild(et,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(nf(i,s,o))}else r.trackChildChange(Jl(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?me.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var dy=class n{constructor(e){this.indexedFilter_=new rf(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new Ee(t,r))||(r=me.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=me.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(me.EMPTY_NODE);let s=this;return t.forEachChild(et,(o,a)=>{s.matches(new Ee(o,a))||(i=i.updateImmediateChild(o,me.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var MD=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new dy(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new Ee(t,r))||(r=me.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=me.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=me.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(me.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,me.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(p,_)=>h(_,p)}else o=this.index_.getCompare();let a=e;j(a.numChildren()===this.limit_,"");let c=new Ee(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(t)){let h=a.getImmediateChild(t),p=i.getChildAfterChild(this.index_,l,this.reverse_);for(;p!=null&&(p.name===t||a.hasChild(p.name));)p=i.getChildAfterChild(this.index_,p,this.reverse_);let _=p==null?1:o(p,c);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(nf(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(tf(t,h));let A=a.updateImmediateChild(t,me.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(s?.trackChildChange(Jl(p.name,p.node)),A.updateImmediateChild(p.name,p.node)):A}}else return r.isEmpty()?e:d&&o(l,c)>=0?(s!=null&&(s.trackChildChange(tf(l.name,l.node)),s.trackChildChange(Jl(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,me.EMPTY_NODE)):e}};var sf=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=et}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return j(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return j(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:oo}hasEnd(){return this.endSet_}getIndexEndValue(){return j(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return j(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ts}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return j(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===et}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function MJ(n){return n.loadsAllData()?new rf(n.getIndex()):n.hasLimit()?new MD(n):new dy(n)}function kJ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function OJ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function kD(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function FJ(n,e,t){let r;return n.index_===xi||t?r=kD(n,e,t):r=kD(n,e,ts),r.startAfterSet_=!0,r}function OD(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function LJ(n,e,t){let r;return n.index_===xi||t?r=OD(n,e,t):r=OD(n,e,oo),r.endBeforeSet_=!0,r}function Ry(n,e){let t=n.copy();return t.index_=e,t}function K2(n){let e={};if(n.isDefault())return e;let t;if(n.index_===et?t="$priority":n.index_===SA?t="$value":n.index_===xi?t="$key":(j(n.index_ instanceof ef,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=xt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=xt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+xt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=xt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+xt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Q2(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==et&&(e.i=n.index_.toString()),e}var FD=class n extends oy{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=pf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(j(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=K2(e._queryParams);this.restRequest_(s+".json",c,(l,d)=>{let h=d;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),Ts(this.listens_,o)===a){let p;l?l===401?p="permission_denied":p="rest_error:"+l:p="ok",i(p,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=K2(e._queryParams),r=e._path.toString(),i=new Ut;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Hi(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Mc(a.responseText)}catch{pn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&pn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var LD=class{constructor(){this.rootNode_=me.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function hy(){return{value:null,children:new Map}}function ru(n,e,t){if(we(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=ve(e);n.children.has(r)||n.children.set(r,hy());let i=n.children.get(r);e=Ye(e),ru(i,e,t)}}function VD(n,e){if(we(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(et,(r,i)=>{ru(n,new Ve(r),i)}),VD(n,e)}}else if(n.children.size>0){let t=ve(e);return e=Ye(e),n.children.has(t)&&VD(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function UD(n,e,t){n.value!==null?t(e,n.value):VJ(n,(r,i)=>{let s=new Ve(e.toString()+"/"+r);UD(i,s,t)})}function VJ(n,e){n.children.forEach((t,r)=>{e(r,t)})}var BD=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Kt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var Y2=10*1e3,UJ=30*1e3,BJ=5*60*1e3,jD=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new BD(e);let r=Y2+(UJ-Y2)*Math.random();Wh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Kt(e,(i,s)=>{s>0&&vn(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Wh(this.reportStats_.bind(this),Math.floor(Math.random()*2*BJ))}};var Ai=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Ai||{});function DA(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function AA(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function xA(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var $D=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ai.ACK_USER_WRITE,this.source=DA()}operationForChild(e){if(we(this.path)){if(this.affectedTree.value!=null)return j(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new Ve(e));return new n(Le(),t,this.revert)}}else return j(ve(this.path)===e,"operationForChild called for unrelated child."),new n(Ye(this.path),this.affectedTree,this.revert)}};var fy=class n{constructor(e,t){this.source=e,this.path=t,this.type=Ai.LISTEN_COMPLETE}operationForChild(e){return we(this.path)?new n(this.source,Le()):new n(this.source,Ye(this.path))}};var Xl=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ai.OVERWRITE}operationForChild(e){return we(this.path)?new n(this.source,Le(),this.snap.getImmediateChild(e)):new n(this.source,Ye(this.path),this.snap)}};var of=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ai.MERGE}operationForChild(e){if(we(this.path)){let t=this.children.subtree(new Ve(e));return t.isEmpty()?null:t.value?new Xl(this.source,Le(),t.value):new n(this.source,Le(),t)}else return j(ve(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Ye(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Ni=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(we(e))return this.isFullyInitialized()&&!this.filtered_;let t=ve(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var HD=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function jJ(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(PJ(o.childName,o.snapshotNode))}),Gh(n,i,"child_removed",e,r,t),Gh(n,i,"child_added",e,r,t),Gh(n,i,"child_moved",s,r,t),Gh(n,i,"child_changed",e,r,t),Gh(n,i,"value",e,r,t),i}function Gh(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>HJ(n,a,c)),o.forEach(a=>{let c=$J(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function $J(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function HJ(n,e,t){if(e.childName==null||t.childName==null)throw Uo("Should only compare child_ events.");let r=new Ee(e.childName,e.snapshotNode),i=new Ee(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function Ny(n,e){return{eventCache:n,serverCache:e}}function Qh(n,e,t,r){return Ny(new Ni(e,t,r),n.serverCache)}function UU(n,e,t,r){return Ny(n.eventCache,new Ni(e,t,r))}function py(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Fa(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var dD,qJ=()=>(dD||(dD=new Ir($Y)),dD),Dn=class n{constructor(e,t=qJ()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Kt(e,(r,i)=>{t=t.set(new Ve(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Le(),value:this.value};if(we(e))return null;{let r=ve(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ye(e),t);return s!=null?{path:lt(new Ve(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(we(e))return this;{let t=ve(e),r=this.children.get(t);return r!==null?r.subtree(Ye(e)):new n(null)}}set(e,t){if(we(e))return new n(t,this.children);{let r=ve(e),s=(this.children.get(r)||new n(null)).set(Ye(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(we(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=ve(e),r=this.children.get(t);if(r){let i=r.remove(Ye(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(we(e))return this.value;{let t=ve(e),r=this.children.get(t);return r?r.get(Ye(e)):null}}setTree(e,t){if(we(e))return t;{let r=ve(e),s=(this.children.get(r)||new n(null)).setTree(Ye(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Le(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(lt(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Le(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(we(e))return null;{let s=ve(e),o=this.children.get(s);return o?o.findOnPath_(Ye(e),lt(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Le(),t)}foreachOnPath_(e,t,r){if(we(e))return this;{this.value&&r(t,this.value);let i=ve(e),s=this.children.get(i);return s?s.foreachOnPath_(Ye(e),lt(t,i),r):new n(null)}}foreach(e){this.foreach_(Le(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(lt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var zr=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new Dn(null))}};function Yh(n,e,t){if(we(e))return new zr(new Dn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Sn(i,e);return s=s.updateChild(o,t),new zr(n.writeTree_.set(i,s))}else{let i=new Dn(t),s=n.writeTree_.setTree(e,i);return new zr(s)}}}function qD(n,e,t){let r=n;return Kt(t,(i,s)=>{r=Yh(r,lt(e,i),s)}),r}function J2(n,e){if(we(e))return zr.empty();{let t=n.writeTree_.setTree(e,new Dn(null));return new zr(t)}}function zD(n,e){return Va(n,e)!=null}function Va(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Sn(t.path,e)):null}function X2(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(et,(r,i)=>{e.push(new Ee(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Ee(r,i.value))}),e}function io(n,e){if(we(e))return n;{let t=Va(n,e);return t!=null?new zr(new Dn(t)):new zr(n.writeTree_.subtree(e))}}function GD(n){return n.writeTree_.isEmpty()}function Zl(n,e){return BU(Le(),n.writeTree_,e)}function BU(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(j(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=BU(lt(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(lt(n,".priority"),r)),t}}function Py(n,e){return qU(e,n)}function zJ(n,e,t,r,i){j(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Yh(n.visibleWrites,e,t)),n.lastWriteId=r}function GJ(n,e,t,r){j(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=qD(n.visibleWrites,e,t),n.lastWriteId=r}function WJ(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function KJ(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);j(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&QJ(a,r.path)?i=!1:wr(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return YJ(n),!0;if(r.snap)n.visibleWrites=J2(n.visibleWrites,r.path);else{let a=r.children;Kt(a,c=>{n.visibleWrites=J2(n.visibleWrites,lt(r.path,c))})}return!0}else return!1}function QJ(n,e){if(n.snap)return wr(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&wr(lt(n.path,t),e))return!0;return!1}function YJ(n){n.visibleWrites=jU(n.allWrites,JJ,Le()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function JJ(n){return n.visible}function jU(n,e,t){let r=zr.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)wr(t,o)?(a=Sn(t,o),r=Yh(r,a,s.snap)):wr(o,t)&&(a=Sn(o,t),r=Yh(r,Le(),s.snap.getChild(a)));else if(s.children){if(wr(t,o))a=Sn(t,o),r=qD(r,a,s.children);else if(wr(o,t))if(a=Sn(o,t),we(a))r=qD(r,Le(),s.children);else{let c=Ts(s.children,ve(a));if(c){let l=c.getChild(Ye(a));r=Yh(r,Le(),l)}}}else throw Uo("WriteRecord should have .snap or .children")}}return r}function $U(n,e,t,r,i){if(!r&&!i){let s=Va(n.visibleWrites,e);if(s!=null)return s;{let o=io(n.visibleWrites,e);if(GD(o))return t;if(t==null&&!zD(o,Le()))return null;{let a=t||me.EMPTY_NODE;return Zl(o,a)}}}else{let s=io(n.visibleWrites,e);if(!i&&GD(s))return t;if(!i&&t==null&&!zD(s,Le()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(wr(l.path,e)||wr(e,l.path))},a=jU(n.allWrites,o,e),c=t||me.EMPTY_NODE;return Zl(a,c)}}}function XJ(n,e,t){let r=me.EMPTY_NODE,i=Va(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(et,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=io(n.visibleWrites,e);return t.forEachChild(et,(o,a)=>{let c=Zl(io(s,new Ve(o)),a);r=r.updateImmediateChild(o,c)}),X2(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=io(n.visibleWrites,e);return X2(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function ZJ(n,e,t,r,i){j(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=lt(e,t);if(zD(n.visibleWrites,s))return null;{let o=io(n.visibleWrites,s);return GD(o)?i.getChild(t):Zl(o,i.getChild(t))}}function eX(n,e,t,r){let i=lt(e,t),s=Va(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=io(n.visibleWrites,i);return Zl(o,r.getNode().getImmediateChild(t))}else return null}function tX(n,e){return Va(n.visibleWrites,e)}function nX(n,e,t,r,i,s,o){let a,c=io(n.visibleWrites,e),l=Va(c,Le());if(l!=null)a=l;else if(t!=null)a=Zl(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),p=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=p.getNext();for(;_&&d.length<i;)h(_,r)!==0&&d.push(_),_=p.getNext();return d}else return[]}function rX(){return{visibleWrites:zr.empty(),allWrites:[],lastWriteId:-1}}function my(n,e,t,r){return $U(n.writeTree,n.treePath,e,t,r)}function RA(n,e){return XJ(n.writeTree,n.treePath,e)}function Z2(n,e,t,r){return ZJ(n.writeTree,n.treePath,e,t,r)}function gy(n,e){return tX(n.writeTree,lt(n.treePath,e))}function iX(n,e,t,r,i,s){return nX(n.writeTree,n.treePath,e,t,r,i,s)}function NA(n,e,t){return eX(n.writeTree,n.treePath,e,t)}function HU(n,e){return qU(lt(n.treePath,e),n.writeTree)}function qU(n,e){return{treePath:n,writeTree:e}}var WD=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;j(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),j(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,nf(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,tf(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,Jl(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,nf(r,e.snapshotNode,i.oldSnap));else throw Uo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var KD=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},zU=new KD,af=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Ni(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return NA(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Fa(this.viewCache_),s=iX(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function sX(n){return{filter:n}}function oX(n,e){j(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),j(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function aX(n,e,t,r,i){let s=new WD,o,a;if(t.type===Ai.OVERWRITE){let l=t;l.source.fromUser?o=QD(n,e,l.path,l.snap,r,i,s):(j(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!we(l.path),o=_y(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===Ai.MERGE){let l=t;l.source.fromUser?o=lX(n,e,l.path,l.children,r,i,s):(j(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=YD(n,e,l.path,l.children,r,i,a,s))}else if(t.type===Ai.ACK_USER_WRITE){let l=t;l.revert?o=hX(n,e,l.path,r,i,s):o=uX(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===Ai.LISTEN_COMPLETE)o=dX(n,e,t.path,r,s);else throw Uo("Unknown operation type: "+t.type);let c=s.getChanges();return cX(e,o,c),{viewCache:o,changes:c}}function cX(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=py(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(VU(py(e)))}}function GU(n,e,t,r,i,s){let o=e.eventCache;if(gy(r,t)!=null)return e;{let a,c;if(we(t))if(j(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Fa(e),d=l instanceof me?l:me.EMPTY_NODE,h=RA(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=my(r,Fa(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=ve(t);if(l===".priority"){j(ao(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let h=Z2(r,t,d,c);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=Ye(t),h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let p=Z2(r,t,o.getNode(),c);p!=null?h=o.getNode().getImmediateChild(l).updateChild(d,p):h=o.getNode().getImmediateChild(l)}else h=NA(r,l,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),l,h,d,i,s):a=o.getNode()}}return Qh(e,a,o.isFullyInitialized()||we(t),n.filter.filtersNodes())}}function _y(n,e,t,r,i,s,o,a){let c=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(we(t))l=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);l=d.updateFullNode(c.getNode(),_,null)}else{let _=ve(t);if(!c.isCompleteForPath(t)&&ao(t)>1)return e;let w=Ye(t),R=c.getNode().getImmediateChild(_).updateChild(w,r);_===".priority"?l=d.updatePriority(c.getNode(),R):l=d.updateChild(c.getNode(),_,R,w,zU,null)}let h=UU(e,l,c.isFullyInitialized()||we(t),d.filtersNodes()),p=new af(i,h,s);return GU(n,h,t,i,p,a)}function QD(n,e,t,r,i,s,o){let a=e.eventCache,c,l,d=new af(i,e,s);if(we(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Qh(e,l,!0,n.filter.filtersNodes());else{let h=ve(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=Qh(e,l,a.isFullyInitialized(),a.isFiltered());else{let p=Ye(t),_=a.getNode().getImmediateChild(h),w;if(we(p))w=r;else{let A=d.getCompleteChild(h);A!=null?EA(p)===".priority"&&A.getChild(PU(p)).isEmpty()?w=A:w=A.updateChild(p,r):w=me.EMPTY_NODE}if(_.equals(w))c=e;else{let A=n.filter.updateChild(a.getNode(),h,w,p,d,o);c=Qh(e,A,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function eU(n,e){return n.eventCache.isCompleteForChild(e)}function lX(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let d=lt(t,c);eU(e,ve(d))&&(a=QD(n,a,d,l,i,s,o))}),r.foreach((c,l)=>{let d=lt(t,c);eU(e,ve(d))||(a=QD(n,a,d,l,i,s,o))}),a}function tU(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function YD(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;we(t)?l=r:l=new Dn(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((h,p)=>{if(d.hasChild(h)){let _=e.serverCache.getNode().getImmediateChild(h),w=tU(n,_,p);c=_y(n,c,new Ve(h),w,i,s,o,a)}}),l.children.inorderTraversal((h,p)=>{let _=!e.serverCache.isCompleteForChild(h)&&p.value===null;if(!d.hasChild(h)&&!_){let w=e.serverCache.getNode().getImmediateChild(h),A=tU(n,w,p);c=_y(n,c,new Ve(h),A,i,s,o,a)}}),c}function uX(n,e,t,r,i,s,o){if(gy(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(we(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return _y(n,e,t,c.getNode().getChild(t),i,s,a,o);if(we(t)){let l=new Dn(null);return c.getNode().forEachChild(xi,(d,h)=>{l=l.set(new Ve(d),h)}),YD(n,e,t,l,i,s,a,o)}else return e}else{let l=new Dn(null);return r.foreach((d,h)=>{let p=lt(t,d);c.isCompleteForPath(p)&&(l=l.set(d,c.getNode().getChild(p)))}),YD(n,e,t,l,i,s,a,o)}}function dX(n,e,t,r,i){let s=e.serverCache,o=UU(e,s.getNode(),s.isFullyInitialized()||we(t),s.isFiltered());return GU(n,o,t,r,zU,i)}function hX(n,e,t,r,i,s){let o;if(gy(r,t)!=null)return e;{let a=new af(r,e,i),c=e.eventCache.getNode(),l;if(we(t)||ve(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=my(r,Fa(e));else{let h=e.serverCache.getNode();j(h instanceof me,"serverChildren would be complete if leaf node"),d=RA(r,h)}d=d,l=n.filter.updateFullNode(c,d,s)}else{let d=ve(t),h=NA(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?l=n.filter.updateChild(c,d,h,Ye(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(c,d,me.EMPTY_NODE,Ye(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=my(r,Fa(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||gy(r,Le())!=null,Qh(e,l,o,n.filter.filtersNodes())}}var JD=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new rf(r.getIndex()),s=MJ(r);this.processor_=sX(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(me.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(me.EMPTY_NODE,a.getNode(),null),d=new Ni(c,o.isFullyInitialized(),i.filtersNodes()),h=new Ni(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Ny(h,d),this.eventGenerator_=new HD(this.query_)}get query(){return this.query_}};function fX(n){return n.viewCache_.serverCache.getNode()}function pX(n){return py(n.viewCache_)}function mX(n,e){let t=Fa(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!we(e)&&!t.getImmediateChild(ve(e)).isEmpty())?t.getChild(e):null}function nU(n){return n.eventRegistrations_.length===0}function gX(n,e){n.eventRegistrations_.push(e)}function rU(n,e,t){let r=[];if(t){j(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function iU(n,e,t,r){e.type===Ai.MERGE&&e.source.queryId!==null&&(j(Fa(n.viewCache_),"We should always have a full cache before handling merges"),j(py(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=aX(n.processor_,i,e,t,r);return oX(n.processor_,s.viewCache),j(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,WU(n,s.changes,s.viewCache.eventCache.getNode(),null)}function _X(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(et,(s,o)=>{r.push(Jl(s,o))}),t.isFullyInitialized()&&r.push(VU(t.getNode())),WU(n,r,t.getNode(),e)}function WU(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return jJ(n.eventGenerator_,e,t,i)}var yy,vy=class{constructor(){this.views=new Map}};function yX(n){j(!yy,"__referenceConstructor has already been defined"),yy=n}function vX(){return j(yy,"Reference.ts has not been loaded"),yy}function wX(n){return n.views.size===0}function PA(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return j(s!=null,"SyncTree gave us an op for an invalid query."),iU(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(iU(o,e,t,r));return s}}function KU(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=my(t,i?r:null),c=!1;a?c=!0:r instanceof me?(a=RA(t,r),c=!1):(a=me.EMPTY_NODE,c=!1);let l=Ny(new Ni(a,c,!1),new Ni(r,i,!1));return new JD(e,l)}return o}function IX(n,e,t,r,i,s){let o=KU(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),gX(o,t),_X(o,t)}function EX(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=co(n);if(i==="default")for(let[c,l]of n.views.entries())o=o.concat(rU(l,t,r)),nU(l)&&(n.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=n.views.get(i);c&&(o=o.concat(rU(c,t,r)),nU(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!co(n)&&s.push(new(vX())(e._repo,e._path)),{removed:s,events:o}}function QU(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function so(n,e){let t=null;for(let r of n.views.values())t=t||mX(r,e);return t}function YU(n,e){if(e._queryParams.loadsAllData())return My(n);{let r=e._queryIdentifier;return n.views.get(r)}}function JU(n,e){return YU(n,e)!=null}function co(n){return My(n)!=null}function My(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var wy;function bX(n){j(!wy,"__referenceConstructor has already been defined"),wy=n}function CX(){return j(wy,"Reference.ts has not been loaded"),wy}var TX=1,Iy=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Dn(null),this.pendingWriteTree_=rX(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function MA(n,e,t,r,i){return zJ(n.pendingWriteTree_,e,t,r,i),i?iu(n,new Xl(DA(),e,t)):[]}function SX(n,e,t,r){GJ(n.pendingWriteTree_,e,t,r);let i=Dn.fromObject(t);return iu(n,new of(DA(),e,i))}function ro(n,e,t=!1){let r=WJ(n.pendingWriteTree_,e);if(KJ(n.pendingWriteTree_,e)){let s=new Dn(null);return r.snap!=null?s=s.set(Le(),!0):Kt(r.children,o=>{s=s.set(new Ve(o),!0)}),iu(n,new $D(r.path,s,t))}else return[]}function gf(n,e,t){return iu(n,new Xl(AA(),e,t))}function DX(n,e,t){let r=Dn.fromObject(t);return iu(n,new of(AA(),e,r))}function AX(n,e){return iu(n,new fy(AA(),e))}function xX(n,e,t){let r=kA(n,t);if(r){let i=OA(r),s=i.path,o=i.queryId,a=Sn(s,e),c=new fy(xA(o),a);return FA(n,s,c)}else return[]}function Ey(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||JU(o,e))){let c=EX(o,e,t,r);wX(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let d=l.findIndex(p=>p._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(p,_)=>co(_));if(d&&!h){let p=n.syncPointTree_.subtree(s);if(!p.isEmpty()){let _=PX(p);for(let w=0;w<_.length;++w){let A=_[w],R=A.query,L=tB(n,A);n.listenProvider_.startListening(Jh(R),cf(n,R),L.hashFn,L.onComplete)}}}!h&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(Jh(e),null):l.forEach(p=>{let _=n.queryToTagMap.get(Oy(p));n.listenProvider_.stopListening(Jh(p),_)}))}MX(n,l)}return a}function XU(n,e,t,r){let i=kA(n,r);if(i!=null){let s=OA(i),o=s.path,a=s.queryId,c=Sn(o,e),l=new Xl(xA(a),c,t);return FA(n,o,l)}else return[]}function RX(n,e,t,r){let i=kA(n,r);if(i){let s=OA(i),o=s.path,a=s.queryId,c=Sn(o,e),l=Dn.fromObject(t),d=new of(xA(a),c,l);return FA(n,o,d)}else return[]}function XD(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(p,_)=>{let w=Sn(p,i);s=s||so(_,w),o=o||co(_)});let a=n.syncPointTree_.get(i);a?(o=o||co(a),s=s||so(a,Le())):(a=new vy,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=me.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,w)=>{let A=so(w,Le());A&&(s=s.updateImmediateChild(_,A))}));let l=JU(a,e);if(!l&&!e._queryParams.loadsAllData()){let p=Oy(e);j(!n.queryToTagMap.has(p),"View does not exist, but we have a tag");let _=kX();n.queryToTagMap.set(p,_),n.tagToQueryMap.set(_,p)}let d=Py(n.pendingWriteTree_,i),h=IX(a,e,t,d,s,c);if(!l&&!o&&!r){let p=YU(a,e);h=h.concat(OX(n,e,p))}return h}function ky(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=Sn(o,e),l=so(a,c);if(l)return l});return $U(i,e,s,t,!0)}function NX(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let h=Sn(l,t);r=r||so(d,h)});let i=n.syncPointTree_.get(t);i?r=r||so(i,Le()):(i=new vy,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new Ni(r,!0,!1):null,a=Py(n.pendingWriteTree_,e._path),c=KU(i,e,a,s?o.getNode():me.EMPTY_NODE,s);return pX(c)}function iu(n,e){return ZU(e,n.syncPointTree_,null,Py(n.pendingWriteTree_,Le()))}function ZU(n,e,t,r){if(we(n.path))return eB(n,e,t,r);{let i=e.get(Le());t==null&&i!=null&&(t=so(i,Le()));let s=[],o=ve(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,d=HU(r,o);s=s.concat(ZU(a,c,l,d))}return i&&(s=s.concat(PA(i,n,r,t))),s}}function eB(n,e,t,r){let i=e.get(Le());t==null&&i!=null&&(t=so(i,Le()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=HU(r,o),d=n.operationForChild(o);d&&(s=s.concat(eB(d,a,c,l)))}),i&&(s=s.concat(PA(i,n,r,t))),s}function tB(n,e){let t=e.query,r=cf(n,t);return{hashFn:()=>(fX(e)||me.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?xX(n,t._path,r):AX(n,t._path);{let s=zY(i,t);return Ey(n,t,null,s)}}}}function cf(n,e){let t=Oy(e);return n.queryToTagMap.get(t)}function Oy(n){return n._path.toString()+"$"+n._queryIdentifier}function kA(n,e){return n.tagToQueryMap.get(e)}function OA(n){let e=n.indexOf("$");return j(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Ve(n.substr(0,e))}}function FA(n,e,t){let r=n.syncPointTree_.get(e);j(r,"Missing sync point for query tag that we're tracking");let i=Py(n.pendingWriteTree_,e);return PA(r,t,i,null)}function PX(n){return n.fold((e,t,r)=>{if(t&&co(t))return[My(t)];{let i=[];return t&&(i=QU(t)),Kt(r,(s,o)=>{i=i.concat(o)}),i}})}function Jh(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(CX())(n._repo,n._path):n}function MX(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=Oy(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function kX(){return TX++}function OX(n,e,t){let r=e._path,i=cf(n,e),s=tB(n,t),o=n.listenProvider_.startListening(Jh(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)j(!co(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,d,h)=>{if(!we(l)&&d&&co(d))return[My(d).query];{let p=[];return d&&(p=p.concat(QU(d).map(_=>_.query))),Kt(h,(_,w)=>{p=p.concat(w)}),p}});for(let l=0;l<c.length;++l){let d=c[l];n.listenProvider_.stopListening(Jh(d),cf(n,d))}}return o}var ZD=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},eA=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=lt(this.path_,e);return new n(this.syncTree_,t)}node(){return ky(this.syncTree_,this.path_)}},FX=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},sU=function(n,e,t){if(!n||typeof n!="object")return n;if(j(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return LX(n[".sv"],e,t);if(typeof n[".sv"]=="object")return VX(n[".sv"],e);j(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},LX=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:j(!1,"Unexpected server value: "+n)}},VX=function(n,e,t){n.hasOwnProperty("increment")||j(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&j(!1,"Unexpected increment value: "+r);let i=e.node();if(j(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},nB=function(n,e,t,r){return VA(e,new eA(t,n),r)},LA=function(n,e,t){return VA(n,new ZD(e),t)};function VA(n,e,t){let r=n.getPriority().val(),i=sU(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=sU(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Ql(a,mt(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Ql(i))),o.forEachChild(et,(a,c)=>{let l=VA(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var lf=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function Fy(n,e){let t=e instanceof Ve?e:new Ve(e),r=n,i=ve(t);for(;i!==null;){let s=Ts(r.node.children,i)||{children:{},childCount:0};r=new lf(i,r,s),t=Ye(t),i=ve(t)}return r}function Ua(n){return n.node.value}function UA(n,e){n.node.value=e,tA(n)}function rB(n){return n.node.childCount>0}function UX(n){return Ua(n)===void 0&&!rB(n)}function Ly(n,e){Kt(n.node.children,(t,r)=>{e(new lf(t,n,r))})}function iB(n,e,t,r){t&&!r&&e(n),Ly(n,i=>{iB(i,e,!0,r)}),t&&r&&e(n)}function BX(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function _f(n){return new Ve(n.parent===null?n.name:_f(n.parent)+"/"+n.name)}function tA(n){n.parent!==null&&jX(n.parent,n.name,n)}function jX(n,e,t){let r=UX(t),i=vn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,tA(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,tA(n))}var $X=/[\[\].#$\/\u0000-\u001F\u007F]/,HX=/[\[\].#$\u0000-\u001F\u007F]/,hD=10*1024*1024,Vy=function(n){return typeof n=="string"&&n.length!==0&&!$X.test(n)},sB=function(n){return typeof n=="string"&&n.length!==0&&!HX.test(n)},qX=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),sB(n)},uf=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!xy(n)||n&&typeof n=="object"&&vn(n,".sv")},Pi=function(n,e,t,r){r&&e===void 0||yf(ln(n,"value"),e,t)},yf=function(n,e,t){let r=t instanceof Ve?new TD(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Ma(r));if(typeof e=="function")throw new Error(n+"contains a function "+Ma(r)+" with contents = "+e.toString());if(xy(e))throw new Error(n+"contains "+e.toString()+" "+Ma(r));if(typeof e=="string"&&e.length>hD/3&&bd(e)>hD)throw new Error(n+"contains a string greater than "+hD+" utf8 bytes "+Ma(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Kt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Vy(o)))throw new Error(n+" contains an invalid key ("+o+") "+Ma(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);wJ(r,o),yf(n,a,r),IJ(r)}),i&&s)throw new Error(n+' contains ".value" child '+Ma(r)+" in addition to actual children.")}},zX=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=Zh(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Vy(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(vJ);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&wr(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},oB=function(n,e,t,r){if(r&&e===void 0)return;let i=ln(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Kt(e,(o,a)=>{let c=new Ve(o);if(yf(i,a,lt(t,c)),EA(c)===".priority"&&!uf(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),zX(i,s)},BA=function(n,e,t){if(!(t&&e===void 0)){if(xy(e))throw new Error(ln(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!uf(e))throw new Error(ln(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},vf=function(n,e,t,r){if(!(r&&t===void 0)&&!Vy(t))throw new Error(ln(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},su=function(n,e,t,r){if(!(r&&t===void 0)&&!sB(t))throw new Error(ln(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},GX=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),su(n,e,t,r)},Xn=function(n,e){if(ve(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},aB=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Vy(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!qX(t))throw new Error(ln(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var nA=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Uy(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!bA(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function cB(n,e,t){Uy(n,t),lB(n,r=>bA(r,e))}function Zn(n,e,t){Uy(n,t),lB(n,r=>wr(r,e)||wr(e,r))}function lB(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(WX(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function WX(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Oa&&Wt("event: "+t.toString()),nu(r)}}}var uB="repo_interrupt",KX=25,rA=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new nA,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=hy(),this.transactionQueueTree_=new lf,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function QX(n,e,t){if(n.stats_=IA(n.repoInfo_),n.forceRestClient_||QY())n.server_=new FD(n.repoInfo_,(r,i,s,o)=>{oU(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>aU(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{xt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new CA(n.repoInfo_,e,(r,i,s,o)=>{oU(n,r,i,s,o)},r=>{aU(n,r)},r=>{YX(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=JY(n.repoInfo_,()=>new jD(n.stats_,n.server_)),n.infoData_=new LD,n.infoSyncTree_=new Iy({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=gf(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),jA(n,"connected",!1),n.serverSyncTree_=new Iy({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);Zn(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function dB(n){let t=n.infoData_.getNode(new Ve(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function wf(n){return FX({timestamp:dB(n)})}function oU(n,e,t,r,i){n.dataUpdateCount++;let s=new Ve(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=Ed(t,l=>mt(l));o=RX(n.serverSyncTree_,s,c,i)}else{let c=mt(t);o=XU(n.serverSyncTree_,s,c,i)}else if(r){let c=Ed(t,l=>mt(l));o=DX(n.serverSyncTree_,s,c)}else{let c=mt(t);o=gf(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=eu(n,s)),Zn(n.eventQueue_,a,o)}function aU(n,e){jA(n,"connected",e),e===!1&&ZX(n)}function YX(n,e){Kt(e,(t,r)=>{jA(n,t,r)})}function jA(n,e,t){let r=new Ve("/.info/"+e),i=mt(t);n.infoData_.updateSnapshot(r,i);let s=gf(n.infoSyncTree_,r,i);Zn(n.eventQueue_,r,s)}function By(n){return n.nextWriteId_++}function JX(n,e,t){let r=NX(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=mt(i).withIndex(e._queryParams.getIndex());XD(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=gf(n.serverSyncTree_,e._path,s);else{let a=cf(n.serverSyncTree_,e);o=XU(n.serverSyncTree_,e._path,s,a)}return Zn(n.eventQueue_,e._path,o),Ey(n.serverSyncTree_,e,t,null,!0),s},i=>(ou(n,"get for query "+xt(e)+" failed: "+i),Promise.reject(new Error(i))))}function $A(n,e,t,r,i){ou(n,"set",{path:e.toString(),value:t,priority:r});let s=wf(n),o=mt(t,r),a=ky(n.serverSyncTree_,e),c=LA(o,a,s),l=By(n),d=MA(n.serverSyncTree_,e,c,l,!0);Uy(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(p,_)=>{let w=p==="ok";w||pn("set at "+e+" failed: "+p);let A=ro(n.serverSyncTree_,l,!w);Zn(n.eventQueue_,e,A),lo(n,i,p,_)});let h=qA(n,e);eu(n,h),Zn(n.eventQueue_,h,[])}function XX(n,e,t,r){ou(n,"update",{path:e.toString(),value:t});let i=!0,s=wf(n),o={};if(Kt(t,(a,c)=>{i=!1,o[a]=nB(lt(e,a),mt(c),n.serverSyncTree_,s)}),i)Wt("update() called with empty data.  Don't do anything."),lo(n,r,"ok",void 0);else{let a=By(n),c=SX(n.serverSyncTree_,e,o,a);Uy(n.eventQueue_,c),n.server_.merge(e.toString(),t,(l,d)=>{let h=l==="ok";h||pn("update at "+e+" failed: "+l);let p=ro(n.serverSyncTree_,a,!h),_=p.length>0?eu(n,e):e;Zn(n.eventQueue_,_,p),lo(n,r,l,d)}),Kt(t,l=>{let d=qA(n,lt(e,l));eu(n,d)}),Zn(n.eventQueue_,e,[])}}function ZX(n){ou(n,"onDisconnectEvents");let e=wf(n),t=hy();UD(n.onDisconnect_,Le(),(i,s)=>{let o=nB(i,s,n.serverSyncTree_,e);ru(t,i,o)});let r=[];UD(t,Le(),(i,s)=>{r=r.concat(gf(n.serverSyncTree_,i,s));let o=qA(n,i);eu(n,o)}),n.onDisconnect_=hy(),Zn(n.eventQueue_,Le(),r)}function eZ(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&VD(n.onDisconnect_,e),lo(n,t,r,i)})}function cU(n,e,t,r){let i=mt(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&ru(n.onDisconnect_,e,i),lo(n,r,s,o)})}function tZ(n,e,t,r,i){let s=mt(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&ru(n.onDisconnect_,e,s),lo(n,i,o,a)})}function nZ(n,e,t,r){if(Fc(t)){Wt("onDisconnect().update() called with empty data.  Don't do anything."),lo(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Kt(t,(o,a)=>{let c=mt(a);ru(n.onDisconnect_,lt(e,o),c)}),lo(n,r,i,s)})}function rZ(n,e,t){let r;ve(e._path)===".info"?r=XD(n.infoSyncTree_,e,t):r=XD(n.serverSyncTree_,e,t),cB(n.eventQueue_,e._path,r)}function iA(n,e,t){let r;ve(e._path)===".info"?r=Ey(n.infoSyncTree_,e,t):r=Ey(n.serverSyncTree_,e,t),cB(n.eventQueue_,e._path,r)}function hB(n){n.persistentConnection_&&n.persistentConnection_.interrupt(uB)}function iZ(n){n.persistentConnection_&&n.persistentConnection_.resume(uB)}function ou(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Wt(t,...e)}function lo(n,e,t,r){e&&nu(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function sZ(n,e,t,r,i,s){ou(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:dU(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=HA(n,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{yf("transaction failed: Data returned ",c,o.path),o.status=0;let l=Fy(n.transactionQueueTree_,e),d=Ua(l)||[];d.push(o),UA(l,d);let h;typeof c=="object"&&c!==null&&vn(c,".priority")?(h=Ts(c,".priority"),j(uf(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(ky(n.serverSyncTree_,e)||me.EMPTY_NODE).getPriority().val();let p=wf(n),_=mt(c,h),w=LA(_,a,p);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=w,o.currentWriteId=By(n);let A=MA(n.serverSyncTree_,e,w,o.currentWriteId,o.applyLocally);Zn(n.eventQueue_,e,A),jy(n,n.transactionQueueTree_)}}function HA(n,e,t){return ky(n.serverSyncTree_,e,t)||me.EMPTY_NODE}function jy(n,e=n.transactionQueueTree_){if(e||$y(n,e),Ua(e)){let t=pB(n,e);j(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&oZ(n,_f(e),t)}else rB(e)&&Ly(e,t=>{jy(n,t)})}function oZ(n,e,t){let r=t.map(l=>l.currentWriteId),i=HA(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];j(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=Sn(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{ou(n,"transaction put response",{path:c.toString(),status:l});let d=[];if(l==="ok"){let h=[];for(let p=0;p<t.length;p++)t[p].status=2,d=d.concat(ro(n.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&h.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();$y(n,Fy(n.transactionQueueTree_,e)),jy(n,n.transactionQueueTree_),Zn(n.eventQueue_,e,d);for(let p=0;p<h.length;p++)nu(h[p])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{pn("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}eu(n,e)}},o)}function eu(n,e){let t=fB(n,e),r=_f(t),i=pB(n,t);return aZ(n,i,r),r}function aZ(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=Sn(t,c.path),d=!1,h;if(j(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,i=i.concat(ro(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=KX)d=!0,h="maxretry",i=i.concat(ro(n.serverSyncTree_,c.currentWriteId,!0));else{let p=HA(n,c.path,o);c.currentInputSnapshot=p;let _=e[a].update(p.val());if(_!==void 0){yf("transaction failed: Data returned ",_,c.path);let w=mt(_);typeof _=="object"&&_!=null&&vn(_,".priority")||(w=w.updatePriority(p.getPriority()));let R=c.currentWriteId,L=wf(n),Q=LA(w,p,L);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=Q,c.currentWriteId=By(n),o.splice(o.indexOf(R),1),i=i.concat(MA(n.serverSyncTree_,c.path,Q,c.currentWriteId,c.applyLocally)),i=i.concat(ro(n.serverSyncTree_,R,!0))}else d=!0,h="nodata",i=i.concat(ro(n.serverSyncTree_,c.currentWriteId,!0))}Zn(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}$y(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)nu(r[a]);jy(n,n.transactionQueueTree_)}function fB(n,e){let t,r=n.transactionQueueTree_;for(t=ve(e);t!==null&&Ua(r)===void 0;)r=Fy(r,t),e=Ye(e),t=ve(e);return r}function pB(n,e){let t=[];return mB(n,e,t),t.sort((r,i)=>r.order-i.order),t}function mB(n,e,t){let r=Ua(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Ly(e,i=>{mB(n,i,t)})}function $y(n,e){let t=Ua(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,UA(e,t.length>0?t:void 0)}Ly(e,r=>{$y(n,r)})}function qA(n,e){let t=_f(fB(n,e)),r=Fy(n.transactionQueueTree_,e);return BX(r,i=>{fD(n,i)}),fD(n,r),iB(r,i=>{fD(n,i)}),t}function fD(n,e){let t=Ua(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(j(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(j(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(ro(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?UA(e,void 0):t.length=s+1,Zn(n.eventQueue_,_f(e),i);for(let o=0;o<r.length;o++)nu(r[o])}}function cZ(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function lZ(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):pn(`Invalid query segment '${t}' in query '${n}'`)}return e}var sA=function(n,e){let t=uZ(n),r=t.namespace;t.domain==="firebase.com"&&Ri(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Ri("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||BY();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new iy(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Ve(t.pathString)}},uZ=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=cZ(n.substring(d,h)));let p=lZ(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let _=e.slice(0,l);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),t=e.substring(w+1),s=r}"ns"in p&&(s=p.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var lU="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",dZ=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=lU.charAt(t%64),t=Math.floor(t/64);j(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=lU.charAt(e[i]);return j(o.length===20,"nextPushId: Length should be 20."),o}}();var by=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+xt(this.snapshot.exportVal())}},Cy=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var df=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return j(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Ty=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new Ut;return eZ(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Xn("OnDisconnect.remove",this._path);let e=new Ut;return cU(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Xn("OnDisconnect.set",this._path),Pi("OnDisconnect.set",e,this._path,!1);let t=new Ut;return cU(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Xn("OnDisconnect.setWithPriority",this._path),Pi("OnDisconnect.setWithPriority",e,this._path,!1),BA("OnDisconnect.setWithPriority",t,!1);let r=new Ut;return tZ(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Xn("OnDisconnect.update",this._path),oB("OnDisconnect.update",e,this._path,!1);let t=new Ut;return nZ(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var An=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return we(this._path)?null:EA(this._path)}get ref(){return new er(this._repo,this._path)}get _queryIdentifier(){let e=Q2(this._queryParams),t=wA(e);return t==="{}"?"default":t}get _queryObject(){return Q2(this._queryParams)}isEqual(e){if(e=G(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=bA(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+yJ(this._path)}};function Hy(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ho(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===xi){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==oo)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==ts)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===et){if(e!=null&&!uf(e)||t!=null&&!uf(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(j(n.getIndex()instanceof ef||n.getIndex()===SA,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function qy(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var er=class n extends An{constructor(e,t){super(e,t,new sf,!1)}get parent(){let e=PU(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},tu=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new Ve(e),r=uo(this.ref,e);return new n(this._node.getChild(t),r,et)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,uo(this.ref,r),et)))}hasChild(e){let t=new Ve(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function zA(n,e){return n=G(n),n._checkNotDeleted("ref"),e!==void 0?uo(n._root,e):n._root}function GA(n,e){n=G(n),n._checkNotDeleted("refFromURL");let t=sA(e,n._repo.repoInfo_.nodeAdmin);aB("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Ri("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),zA(n,t.path.toString())}function uo(n,e){return n=G(n),ve(n._path)===null?GX("child","path",e,!1):su("child","path",e,!1),new er(n._repo,lt(n._path,e))}function gB(n,e){n=G(n),Xn("push",n._path),Pi("push",e,n._path,!0);let t=dB(n._repo),r=dZ(t),i=uo(n,r),s=uo(n,r),o;return e!=null?o=zy(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function _B(n){return Xn("remove",n._path),zy(n,null)}function zy(n,e){n=G(n),Xn("set",n._path),Pi("set",e,n._path,!1);let t=new Ut;return $A(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function yB(n,e){n=G(n),Xn("setPriority",n._path),BA("setPriority",e,!1);let t=new Ut;return $A(n._repo,lt(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function vB(n,e,t){if(Xn("setWithPriority",n._path),Pi("setWithPriority",e,n._path,!1),BA("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new Ut;return $A(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function wB(n,e){oB("update",e,n._path,!1);let t=new Ut;return XX(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function IB(n){n=G(n);let e=new df(()=>{}),t=new hf(e);return JX(n._repo,n,t).then(r=>new tu(r,new er(n._repo,n._path),n._queryParams.getIndex()))}var hf=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new by("value",this,new tu(e.snapshotNode,new er(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Cy(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Sy=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Cy(this,e,t):null}createEvent(e,t){j(e.childName!=null,"Child events should have a childName.");let r=uo(new er(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new by(e.type,this,new tu(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function If(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,l=(d,h)=>{iA(n._repo,n,a),c(d,h)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new df(t,s||void 0),a=e==="value"?new hf(o):new Sy(e,o);return rZ(n._repo,n,a),()=>iA(n._repo,n,a)}function Gy(n,e,t,r){return If(n,"value",e,t,r)}function WA(n,e,t,r){return If(n,"child_added",e,t,r)}function KA(n,e,t,r){return If(n,"child_changed",e,t,r)}function QA(n,e,t,r){return If(n,"child_moved",e,t,r)}function YA(n,e,t,r){return If(n,"child_removed",e,t,r)}function JA(n,e,t){let r=null,i=t?new df(t):null;e==="value"?r=new hf(i):e&&(r=new Sy(e,i)),iA(n._repo,n,r)}var tr=class{},Dy=class extends tr{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Pi("endAt",this._value,e._path,!0);let t=OD(e._queryParams,this._value,this._key);if(qy(t),ho(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new An(e._repo,e._path,t,e._orderByCalled)}};function EB(n,e){return vf("endAt","key",e,!0),new Dy(n,e)}var oA=class extends tr{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Pi("endBefore",this._value,e._path,!1);let t=LJ(e._queryParams,this._value,this._key);if(qy(t),ho(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new An(e._repo,e._path,t,e._orderByCalled)}};function bB(n,e){return vf("endBefore","key",e,!0),new oA(n,e)}var Ay=class extends tr{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Pi("startAt",this._value,e._path,!0);let t=kD(e._queryParams,this._value,this._key);if(qy(t),ho(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new An(e._repo,e._path,t,e._orderByCalled)}};function CB(n=null,e){return vf("startAt","key",e,!0),new Ay(n,e)}var aA=class extends tr{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Pi("startAfter",this._value,e._path,!1);let t=FJ(e._queryParams,this._value,this._key);if(qy(t),ho(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new An(e._repo,e._path,t,e._orderByCalled)}};function TB(n,e){return vf("startAfter","key",e,!0),new aA(n,e)}var cA=class extends tr{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new An(e._repo,e._path,kJ(e._queryParams,this._limit),e._orderByCalled)}};function SB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new cA(n)}var lA=class extends tr{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new An(e._repo,e._path,OJ(e._queryParams,this._limit),e._orderByCalled)}};function DB(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new lA(n)}var uA=class extends tr{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Hy(e,"orderByChild");let t=new Ve(this._path);if(we(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new ef(t),i=Ry(e._queryParams,r);return ho(i),new An(e._repo,e._path,i,!0)}};function AB(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return su("orderByChild","path",n,!1),new uA(n)}var dA=class extends tr{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Hy(e,"orderByKey");let t=Ry(e._queryParams,xi);return ho(t),new An(e._repo,e._path,t,!0)}};function xB(){return new dA}var hA=class extends tr{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Hy(e,"orderByPriority");let t=Ry(e._queryParams,et);return ho(t),new An(e._repo,e._path,t,!0)}};function RB(){return new hA}var fA=class extends tr{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Hy(e,"orderByValue");let t=Ry(e._queryParams,SA);return ho(t),new An(e._repo,e._path,t,!0)}};function NB(){return new fA}var pA=class extends tr{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Pi("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Dy(this._value,this._key)._apply(new Ay(this._value,this._key)._apply(e))}};function PB(n,e){return vf("equalTo","key",e,!0),new pA(n,e)}function Er(n,...e){let t=G(n);for(let r of e)t=r._apply(t);return t}yX(er);bX(er);var hZ="FIREBASE_DATABASE_EMULATOR_HOST",mA={},fZ=!1;function pZ(n,e,t,r){n.repoInfo_=new iy(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function XA(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Ri("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Wt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=sA(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[hZ]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=sA(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new Kh(Kh.OWNER):new vD(n.name,n.options,e);aB("Invalid Firebase Database URL",o),we(o.path)||Ri("Database URL must point to the root of a Firebase Database (not including a child path).");let h=gZ(a,n,d,new yD(n.name,t));return new gA(h,n)}function mZ(n,e){let t=mA[e];(!t||t[n.key]!==n)&&Ri(`Database ${e}(${n.repoInfo_}) has already been deleted.`),hB(n),delete t[n.key]}function gZ(n,e,t,r){let i=mA[e.name];i||(i={},mA[e.name]=i);let s=i[n.toURLString()];return s&&Ri("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new rA(n,fZ,t,r),i[n.toURLString()]=s,s}var gA=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(QX(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new er(this._repo,Le())),this._rootInternal}_delete(){return this._rootInternal!==null&&(mZ(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ri("Cannot call "+e+" on a deleted database.")}};function MB(){NU.IS_TRANSPORT_INITIALIZED&&pn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function kB(){MB(),Xh.forceDisallow()}function OB(){MB(),zl.forceDisallow(),Xh.forceAllow()}function FB(n,e,t,r={}){n=G(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Ri("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Ri('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Kh(Kh.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Oc(r.mockUserToken,n.app.options.projectId);s=new Kh(o)}pZ(i,e,t,s)}function LB(n){n=G(n),n._checkNotDeleted("goOffline"),hB(n._repo)}function VB(n){n=G(n),n._checkNotDeleted("goOnline"),iZ(n._repo)}function UB(n,e){fU(n,e)}function _Z(n){vA(In),wn(new qe("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return XA(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),bt(P2,M2,n),bt(P2,M2,"esm2017")}var yZ={".sv":"timestamp"};function BB(){return yZ}function jB(n){return{".sv":{increment:n}}}var _A=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function $B(n,e,t){var r;if(n=G(n),Xn("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new Ut,o=(c,l,d)=>{let h=null;c?s.reject(c):(h=new tu(d,new er(n._repo,n._path),et),s.resolve(new _A(l,h)))},a=Gy(n,()=>{});return sZ(n._repo,n._path,e,o,a,i),s.promise}CA.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};CA.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};_Z();var vZ="@firebase/database-compat",wZ="1.0.5";var IZ=new Ln("@firebase/database-compat"),HB=function(n){let e="FIREBASE WARNING: "+n;IZ.warn(e)};var EZ=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(ln(n,e)+"must be a boolean.")},bZ=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(ln(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var ZA=class{constructor(e){this._delegate=e}cancel(e){ce("OnDisconnect.cancel",0,1,arguments.length),Bt("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){ce("OnDisconnect.remove",0,1,arguments.length),Bt("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){ce("OnDisconnect.set",1,2,arguments.length),Bt("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ce("OnDisconnect.setWithPriority",2,3,arguments.length),Bt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(ce("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,HB("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Bt("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var ex=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ce("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Ba=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return ce("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ce("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ce("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ce("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ce("DataSnapshot.child",0,1,arguments.length),e=String(e),su("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return ce("DataSnapshot.hasChild",1,1,arguments.length),su("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ce("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ce("DataSnapshot.forEach",1,1,arguments.length),Bt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return ce("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ce("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ce("DataSnapshot.ref",0,0,arguments.length),new ns(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Wy=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;ce("Query.on",2,4,arguments.length),Bt("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new Ba(this.database,l),d)};a.userCallback=t,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Gy(this._delegate,a,c),t;case"child_added":return WA(this._delegate,a,c),t;case"child_removed":return YA(this._delegate,a,c),t;case"child_changed":return KA(this._delegate,a,c),t;case"child_moved":return QA(this._delegate,a,c),t;default:throw new Error(ln("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(ce("Query.off",0,3,arguments.length),bZ("Query.off",e,!0),Bt("Query.off","callback",t,!0),zE("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,JA(this._delegate,e,i)}else JA(this._delegate,e)}get(){return IB(this._delegate).then(e=>new Ba(this.database,e))}once(e,t,r,i){ce("Query.once",1,4,arguments.length),Bt("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new Ut,a=(l,d)=>{let h=new Ba(this.database,l);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":Gy(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":WA(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":YA(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":KA(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":QA(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(ln("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ce("Query.limitToFirst",1,1,arguments.length),new n(this.database,Er(this._delegate,SB(e)))}limitToLast(e){return ce("Query.limitToLast",1,1,arguments.length),new n(this.database,Er(this._delegate,DB(e)))}orderByChild(e){return ce("Query.orderByChild",1,1,arguments.length),new n(this.database,Er(this._delegate,AB(e)))}orderByKey(){return ce("Query.orderByKey",0,0,arguments.length),new n(this.database,Er(this._delegate,xB()))}orderByPriority(){return ce("Query.orderByPriority",0,0,arguments.length),new n(this.database,Er(this._delegate,RB()))}orderByValue(){return ce("Query.orderByValue",0,0,arguments.length),new n(this.database,Er(this._delegate,NB()))}startAt(e=null,t){return ce("Query.startAt",0,2,arguments.length),new n(this.database,Er(this._delegate,CB(e,t)))}startAfter(e=null,t){return ce("Query.startAfter",0,2,arguments.length),new n(this.database,Er(this._delegate,TB(e,t)))}endAt(e=null,t){return ce("Query.endAt",0,2,arguments.length),new n(this.database,Er(this._delegate,EB(e,t)))}endBefore(e=null,t){return ce("Query.endBefore",0,2,arguments.length),new n(this.database,Er(this._delegate,bB(e,t)))}equalTo(e,t){return ce("Query.equalTo",1,2,arguments.length),new n(this.database,Er(this._delegate,PB(e,t)))}toString(){return ce("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ce("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ce("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,Bt(e,"cancel",i.cancel,!0),i.context=r,zE(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(ln(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new ns(this.database,new er(this._delegate._repo,this._delegate._path))}},ns=class n extends Wy{constructor(e,t){super(e,new An(t._repo,t._path,new sf,!1)),this.database=e,this._delegate=t}getKey(){return ce("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ce("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,uo(this._delegate,e))}getParent(){ce("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return ce("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){ce("Reference.set",1,2,arguments.length),Bt("Reference.set","onComplete",t,!0);let r=zy(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(ce("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,HB("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Xn("Reference.update",this._delegate._path),Bt("Reference.update","onComplete",t,!0);let r=wB(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ce("Reference.setWithPriority",2,3,arguments.length),Bt("Reference.setWithPriority","onComplete",r,!0);let i=vB(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){ce("Reference.remove",0,1,arguments.length),Bt("Reference.remove","onComplete",e,!0);let t=_B(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){ce("Reference.transaction",1,3,arguments.length),Bt("Reference.transaction","transactionUpdate",e,!1),Bt("Reference.transaction","onComplete",t,!0),EZ("Reference.transaction","applyLocally",r,!0);let i=$B(this._delegate,e,{applyLocally:r}).then(s=>new ex(s.committed,new Ba(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){ce("Reference.setPriority",1,2,arguments.length),Bt("Reference.setPriority","onComplete",t,!0);let r=yB(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){ce("Reference.push",0,2,arguments.length),Bt("Reference.push","onComplete",t,!0);let r=gB(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Xn("Reference.onDisconnect",this._delegate._path),new ZA(new Ty(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var ja=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:kB,forceLongPolling:OB}}useEmulator(e,t,r={}){FB(this._delegate,e,t,r)}ref(e){if(ce("database.ref",0,1,arguments.length),e instanceof ns){let t=GA(this._delegate,e.toString());return new ns(this,t)}else{let t=zA(this._delegate,e);return new ns(this,t)}}refFromURL(e){ce("database.refFromURL",1,1,arguments.length);let r=GA(this._delegate,e);return new ns(this,r)}goOffline(){return ce("database.goOffline",0,0,arguments.length),LB(this._delegate)}goOnline(){return ce("database.goOnline",0,0,arguments.length),VB(this._delegate)}};ja.ServerValue={TIMESTAMP:BB(),increment:n=>jB(n)};function CZ({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){vA(t);let a=new As("database-standalone"),c=new $o("auth-internal",a);c.setComponent(new qe("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new $o("app-check-internal",a),l.setComponent(new qe("app-check-internal",()=>i,"PRIVATE"))),{instance:new ja(XA(n,c,l,e,o),n),namespace:s}}var TZ=Object.freeze({__proto__:null,initStandalone:CZ});var SZ=ja.ServerValue;function DZ(n){n.INTERNAL.registerComponent(new qe("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new ja(i,r)},"PUBLIC").setServiceProps({Reference:ns,Query:Wy,Database:ja,DataSnapshot:Ba,enableLogging:UB,INTERNAL:TZ,ServerValue:SZ}).setMultipleInstances(!0)),n.registerVersion(vZ,wZ)}DZ($);var AZ="firebase",xZ="10.12.2";$.registerVersion(AZ,xZ,"app-compat");var qB=(()=>{let e=class e{constructor(r){this.router=r}ngOnInit(){$.auth().onAuthStateChanged(r=>{r?this.router.navigate(["/chat"]):(this.router.navigate(["/log"]),document.getElementById("sidebar-container").style.display="none",document.getElementById("sidebar").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%")})}};e.\u0275fac=function(i){return new(i||e)(ee(Xe))},e.\u0275cmp=Se({type:e,selectors:[["app-log"]],decls:9,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],["routerLink","/login",1,"button"],["routerLink","/register",1,"button"]],template:function(i,s){i&1&&(I(0,"div",0),J(1,"div",1),I(2,"div",2),J(3,"img",3),I(4,"button",4),S(5,"Accedi"),b(),I(6,"button",5),S(7,"Registrati"),b()(),J(8,"div",1),b())},dependencies:[Pc]});let n=e;return n})();var ze=(()=>{let e=class e{constructor(r){this.router=r,this.currentSectorId="",this.linkObject={},this.linkCounter=0,this.ticketToRead=!1,this.isAdmin=!1,this.messageQueue=[]}initNormalScreen(){window.innerWidth>=899&&(document.getElementById("sidebar-container").style.display="flex",document.getElementById("sidebar").style.display="flex",document.getElementById("header").style.display="flex",document.getElementById("router-outlet-container").style.height="calc(100% - 3.5rem)",document.getElementById("router-outlet-container").style.width="calc(100% - 18rem)")}getUserData(){$.auth().onAuthStateChanged(r=>{r?$.firestore().collection("users_data").doc(r.uid).get().then(i=>{if(i.exists){var s=i.data();this.currentUser=s,document.getElementById("header-name-display").innerText=this.currentUser.name,document.getElementById("header-surname-display").innerText=this.currentUser.surname,document.getElementById("header-email-display").innerText=this.currentUser.email,document.getElementById("header-agency-display").innerText=this.currentUser.agencyName}else this.presentToast("Nessun utente trovato"),this.router.navigate(["/log"])}).catch(i=>{this.presentToast("Errore durante il recupero dell'utente:"+i.message)}):(console.log("Nessun utente loggato."),this.router.navigate(["/log"]))})}convertTimestamp(r){let i=new Date(r),s=String(i.getDate()).padStart(2,"0"),o=String(i.getMonth()+1).padStart(2,"0"),a=String(i.getFullYear()),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0"),d=String(i.getSeconds()).padStart(2,"0");return`${s}/${o}/${a} ${c}:${l}:${d}`}presentToast(r){this.animate1("toast-message"),this.messageQueue.push(r),this.messageQueue.length===1&&this.showMessageFromQueue()}showMessageFromQueue(){let r=this.messageQueue[0];document.getElementById("toast-message").style.display="flex",document.getElementById("toast-message-text").innerText=r,setTimeout(()=>{this.hideToastMessage()},3e3)}hideToastMessage(){this.animateFadeOut("toast-message"),setTimeout(()=>{document.getElementById("toast-message").style.display="none"},100),this.messageQueue.shift(),this.messageQueue.length>0&&(this.showMessageFromQueue(),this.animate1("toast-message"))}openCloseSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}animate1(r){var i=document.getElementById(r),s=[{opacity:0},{opacity:1}],o={duration:150,easing:"ease-in-out"};i.animate(s,o)}animateFadeOut(r){var i=document.getElementById(r),s=[{opacity:1},{opacity:0}],o={duration:150,easing:"ease-out"};i.animate(s,o)}};e.\u0275fac=function(i){return new(i||e)(ae(Xe))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var zB=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}login(){var r=document.getElementById("email-login-input").value,i=document.getElementById("password-login-input").value;$.auth().signInWithEmailAndPassword(r,i).then(s=>{var o=s.user;this.generalService.presentToast("Login effettuato con successo"),this.router.navigate(["/chat"])}).catch(s=>{s.code=="auth/invalid-credential"&&this.generalService.presentToast("Email o password non validi")})}};e.\u0275fac=function(i){return new(i||e)(ee(ze),ee(Xe))},e.\u0275cmp=Se({type:e,selectors:[["app-login"]],decls:17,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate",2,"color","#333"],["id","email-login-input","type","text","placeholder","Email",1,"input"],["id","password-login-input","type","text","placeholder","Password",1,"input"],[1,"button",3,"click"],["routerLink","/change-password",1,"a1"]],template:function(i,s){i&1&&(I(0,"div",0),J(1,"div",1),I(2,"div",2),J(3,"img",3),I(4,"div",4)(5,"span",5),S(6,"mail"),b(),J(7,"input",6),b(),I(8,"div",4)(9,"span",5),S(10,"key"),b(),J(11,"input",7),b(),I(12,"button",8),z("click",function(){return s.login()}),S(13,"Accedi"),b(),I(14,"a",9),S(15,"Password dimenticata?"),b()(),J(16,"div",1),b())},dependencies:[Pc]});let n=e;return n})();var RZ=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(ee(ys),ee(ji))},e.\u0275dir=qn({type:e});let n=e;return n})(),WB=(()=>{let e=class e extends RZ{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ro(e)))(s||e)}})(),e.\u0275dir=qn({type:e,features:[Gu]});let n=e;return n})(),KB=new he("");var NZ={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Yle=st(q({},NZ),{"[class.ng-submitted]":"isSubmitted"});var PZ=new he("CallSetDisabledState",{providedIn:"root",factory:()=>QB}),QB="always";var MZ={provide:KB,useExisting:qu(()=>JB),multi:!0};function YB(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function kZ(n){return n.split(":")[0]}var JB=(()=>{let e=class e extends WB{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=YB(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=kZ(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ro(e)))(s||e)}})(),e.\u0275dir=qn({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&z("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[EI([MZ]),Gu]});let n=e;return n})(),au=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(YB(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(ee(ji),ee(ys),ee(JB,9))},e.\u0275dir=qn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let n=e;return n})(),OZ={provide:KB,useExisting:qu(()=>XB),multi:!0};function GB(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function FZ(n){return n.split(":")[0]}var XB=(()=>{let e=class e extends WB{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let l=a[c],d=this._getOptionValue(l.value);s.push(d)}}else{let a=i.options;for(let c=0;c<a.length;c++){let l=a[c];if(l.selected){let d=this._getOptionValue(l.value);s.push(d)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=FZ(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ro(e)))(s||e)}})(),e.\u0275dir=qn({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&z("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[EI([OZ]),Gu]});let n=e;return n})(),cu=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(GB(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(GB(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(ee(ji),ee(ys),ee(XB,9))},e.\u0275dir=qn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let n=e;return n})();var LZ=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=On({type:e}),e.\u0275inj=kn({});let n=e;return n})();var ZB=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:PZ,useValue:r.callSetDisabledState??QB}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=On({type:e}),e.\u0275inj=kn({imports:[LZ]});let n=e;return n})();var ej=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("sidebar-container").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}register(){var r=document.getElementById("email-register-input").value,i=document.getElementById("password-register-input").value,s=document.getElementById("confirm-password-register-input").value,o=document.getElementById("name-register-input").value,a=document.getElementById("surname-register-input").value,c=document.getElementById("agency-name-register-input").value;i==s?$.auth().createUserWithEmailAndPassword(r,i).then(l=>{let d=l.user;var h=$.firestore();h.collection("users_data").doc(d.uid).set({uid:d.uid,name:o,surname:a,agencyName:c,email:r,registration_date:$.firestore.FieldValue.serverTimestamp()}).catch(p=>{this.generalService.presentToast("Errore nel salvataggio dei dati dell'utente durante la registrazione: "+p.message)}),this.generalService.presentToast("Registrazione completata con successo"),this.router.navigate(["/chat"])}).catch(l=>{l.code=="auth/invalid-email"&&this.generalService.presentToast("Email non valida"),l.code=="auth/weak-password"&&this.generalService.presentToast("Password troppo debole")}):this.generalService.presentToast("Le password inserite non corrispondono")}};e.\u0275fac=function(i){return new(i||e)(ee(ze),ee(Xe))},e.\u0275cmp=Se({type:e,selectors:[["app-register"]],decls:43,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate"],["id","name-register-input","type","text","placeholder","Nome",1,"input"],["id","surname-register-input","type","text","placeholder","Cognome",1,"input"],["id","agency-name-register-input",2,"width","100%","height","100%","background","transparent","border","1px solid transparent"],["value","TORINO"],["value","ALBA"],["value","GRINZANE CAVOUR"],["value","ASTI"],["value","BRA"],["value","VADO LIGURE"],["id","email-register-input","type","email","placeholder","Email",1,"input"],["id","password-register-input","type","email","placeholder","Password",1,"input"],["id","confirm-password-register-input","type","email","placeholder","Conferma password",1,"input"],[1,"button",2,"width","100%","height","2.5rem",3,"click"]],template:function(i,s){i&1&&(I(0,"div",0),J(1,"div",1),I(2,"div",2),J(3,"img",3),I(4,"div",4)(5,"span",5),S(6,"person"),b(),J(7,"input",6),b(),I(8,"div",4)(9,"span",5),S(10,"person"),b(),J(11,"input",7),b(),I(12,"div",4)(13,"span",5),S(14,"store"),b(),I(15,"select",8)(16,"option",9),S(17,"TORINO"),b(),I(18,"option",10),S(19,"ALBA"),b(),I(20,"option",11),S(21,"GRINZANE CAVOUR"),b(),I(22,"option",12),S(23,"ASTI"),b(),I(24,"option",13),S(25,"BRA"),b(),I(26,"option",14),S(27,"VADO LIGURE"),b()()(),I(28,"div",4)(29,"span",5),S(30,"mail"),b(),J(31,"input",15),b(),I(32,"div",4)(33,"span",5),S(34,"lock"),b(),J(35,"input",16),b(),I(36,"div",4)(37,"span",5),S(38,"lock"),b(),J(39,"input",17),b(),I(40,"button",18),z("click",function(){return s.register()}),S(41,"Register"),b()(),J(42,"div",1),b())},dependencies:[au,cu]});let n=e;return n})();function VZ(n,e){n&1&&(I(0,"div",2)(1,"p"),S(2,"Seleziona una chat"),b()())}function UZ(n,e){if(n&1){let t=cn();I(0,"button",14),z("click",function(){ut(t);let i=je(2);return dt(i.getMoreChatMessages())}),S(1,"Carica altri messaggi"),b()}}function BZ(n,e){if(n&1){let t=cn();I(0,"div",15)(1,"span",16)(2,"strong"),S(3),b(),I(4,"span"),S(5),b(),J(6,"div",17),I(7,"span",18),z("click",function(){let i=ut(t).$implicit,s=je(2);return dt(s.deleteMessage(i))}),S(8,"delete"),b()(),I(9,"p",19),S(10),b()()}if(n&2){let t=e.$implicit,r=je(2);lr("id","chat-message-id-",t.id,""),ie(3),Wu("",t.creator_name," ",t.creator_surname," ",r.formatTimestamp(t.createdAt),""),ie(2),$t(t.creator_agency_name),ie(5),$t(t.message)}}function jZ(n,e){if(n&1){let t=cn();I(0,"div",3)(1,"div",4)(2,"h2"),S(3),b(),I(4,"span",5),z("click",function(){ut(t);let i=je();return dt(i.deleteChat())}),S(5,"delete"),b()(),I(6,"div",6),ot(7,UZ,2,0,"button",7),I(8,"div",8),ot(9,BZ,11,7,"div",9),ur(10,"async"),b()(),I(11,"div",10)(12,"input",11),z("keydown.enter",function(){ut(t);let i=je();return dt(i.sendMessage())}),b(),I(13,"button",12),z("click",function(){ut(t);let i=je();return dt(i.sendMessage())}),I(14,"span",13),S(15,"send"),b()()()()}if(n&2){let t=je();ie(3),$t(t.chatName),ie(4),Ce("ngIf",t.nextPageAvailable),ie(2),Ce("ngForOf",dr(10,3,t.documents))}}var tj=(()=>{let e=class e{constructor(r,i,s){this.generalService=r,this.route=i,this.router=s,this.chatName="",this.showChatPlaceholder=!0,this.documents=new Ne([]),this.nextPageAvailable=!1}ngOnInit(){this.route.queryParams.subscribe(r=>{this.currentChatId=r.id,this.chatName=r.name,this.currentChatId?(this.showChatPlaceholder=!1,this.getChatMessages()):this.showChatPlaceholder=!0})}sendMessage(){var r={creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,creator_email:this.generalService.currentUser.email,chat_id:this.currentChatId,createdAt:$.firestore.FieldValue.serverTimestamp(),message:document.getElementById("chat-message-input").value};$.firestore().collection("chat_messages").doc().set(r).then(()=>{document.getElementById("chat-message-input").value=""}).catch(i=>{this.generalService.presentToast("Errore durante l'invio del messaggio:"+i.message)})}deleteChat(){confirm("Sei sicuro di voler cancellare questa chat?")&&$.firestore().collection("chats").doc(this.currentChatId).delete().then(()=>{this.showChatPlaceholder=!0,this.generalService.presentToast("Chat eliminata con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'eliminazione della chat: "+r.message)})}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}getChatMessages(){return $.firestore().collection("chat_messages").orderBy("createdAt","desc").where("chat_id","==",this.currentChatId).limit(40).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i tuoi ticket: "+r.message)})}getMoreChatMessages(){!this.lastVisible||!this.nextPageAvailable||$.firestore().collection("chat_messages").orderBy("createdAt","desc").where("chat_id","==",this.currentChatId).startAfter(this.lastVisible).limit(40).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}deleteMessage(r){confirm("Sei sicuro di voler eliminare questo messaggio?")&&(document.getElementById("chat-message-id-"+r.id).innerHTML="Messaggio eliminato",$.firestore().collection("chat_messages").doc(r.id).delete().then(()=>{this.generalService.presentToast("Messaggio eliminato con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione del messaggio: "+i.message)}))}};e.\u0275fac=function(i){return new(i||e)(ee(ze),ee(Mr),ee(Xe))},e.\u0275cmp=Se({type:e,selectors:[["app-chat"]],decls:2,vars:2,consts:[["style","height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; padding-left: 1rem; overflow-x: hidden; overflow-y: hidden;",4,"ngIf"],["style","height: 100%; display: flex; flex-direction: column; padding-left: 1rem; overflow-x: hidden; overflow-y: hidden;",4,"ngIf"],[2,"height","100%","display","flex","flex-direction","column","align-items","center","justify-content","center","padding-left","1rem","overflow-x","hidden","overflow-y","hidden"],[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","column","gap","1rem","overflow-y","auto","height","calc(100% - 4rem)","padding-top","1rem"],["class","button",3,"click",4,"ngIf"],["id","chat-container",2,"display","flex","flex-direction","column","gap","1rem"],["class","chat-card","style","padding-top: 0.5rem;",3,"id",4,"ngFor","ngForOf"],[2,"height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem","margin-top","1rem","margin-right","1rem"],["id","chat-message-input","placeholder","Inserisci qui il tuo messaggio",2,"width","calc(100% - 3.5rem)","border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'",3,"keydown.enter"],[2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[1,"button",3,"click"],[1,"chat-card",2,"padding-top","0.5rem",3,"id"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[2,"flex","1"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer","display","none",3,"click"],[2,"margin-top","0.2rem","margin-bottom","0.5rem"]],template:function(i,s){i&1&&ot(0,VZ,3,0,"div",0)(1,jZ,16,5,"div",1),i&2&&(Ce("ngIf",s.showChatPlaceholder==!0),ie(),Ce("ngIf",s.showChatPlaceholder==!1))},dependencies:[ti,vs,ni]});let n=e;return n})();var nj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.generalService.initNormalScreen()}};e.\u0275fac=function(i){return new(i||e)(ee(ze))},e.\u0275cmp=Se({type:e,selectors:[["app-company"]],decls:24,vars:0,consts:[[2,"height","100%","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[1,"card",2,"padding","1rem","margin-top","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"width","3rem"],[2,"max-width","80%"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","flex-wrap","wrap","gap","1rem"],["href","https://www.agenziaautoteam.it/i-nostri-servizi/","target","_blank",1,"a_button",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"width","2rem"],[2,"margin-top","0rem","margin-bottom","0rem","color","black"],["href","assets\\pdf\\Web app autoteam nuova presentazione.pdf","target","_blank",1,"a_button",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"]],template:function(i,s){i&1&&(I(0,"div",0)(1,"div",1)(2,"div",2),J(3,"img",3),I(4,"h3"),S(5,"L'azienda | Mission"),b()(),I(6,"p",4)(7,"strong"),S(8,"CI SONO MOLTE AGENZIE DI PRATICHE AUTO, INFINITE POSSIBILIT\xC0 PER AUTOMOBILISTI E ADDETTI AI LAVORI. CHE COSA RENDE AUTOTEAM DIVERSA E UNICA?"),b()(),I(9,"p"),S(10,"NON CI SONO RICETTE SEGRETE: TUTTO PARTE DALLA PRECISA VOLONT\xC0 DI COSTRUIRE SOLIDE RELAZIONI CON I CLIENTI. DIALOGO, ASSISTENZA, PRESENZA: IN OGNI FASE DEL LAVORO, IN OGNI OCCASIONE, PER QUALSIASI NECESSIT\xC0, AUTOTEAM C'\xC8. UN'AMPIA GAMMA DI SERVIZI E UNA COSTANTE FORMAZIONE DEI COLLABORATORI GARANTISCE TEMPESTIVIT\xC0 E QUALIT\xC0 DEI SERVIZI, METTENDO A DISPOSIZIONE DELLA CLIENTELA PERSONALE ALTAMENTE QUALIFICATO E, DAL PUNTO DI VISTA UMANO, PERSONE DISPOSTE AD ASCOLTARE E A TROVARE LA SOLUZIONE MIGLIORE PER OGNI TIPO DI ESIGENZA."),b(),I(11,"p"),S(12,"UN TEAM FUNZIONA SE ALLA BASE CI SONO VALORI SOLIDI ECONDIVISI. AGENZIA AUTOTEAM CREDE PROFONDAMENTE NEL PROPRIO GRUPPO: STIMA, FIDUCIA, RISPETTO PER I COLLABORATORI SONO LE FONDAMENTA SULLE QUALI SI BASA LA NOSTRA IDEA DI GRUPPO."),b(),I(13,"p"),S(14,"OGNUNO \xC8 IMPORTANTE, IL CONTRIBUTO DI TUTTI CONTRIBUISCE ALLA CRESCITA E AL SUCCESSO."),b(),I(15,"div",5)(16,"a",6),J(17,"img",7),I(18,"p",8),S(19,"Sito Web | Servizi"),b()(),I(20,"a",9),J(21,"img",7),I(22,"p",8),S(23,"Presentazione Web App"),b()()()()())}});let n=e;return n})();function $Z(n,e){if(n&1){let t=cn();I(0,"div",12),z("click",function(){let i=ut(t).$implicit,s=je(2);return dt(s.openSectorFolder(i))}),I(1,"span",13),S(2,"folder"),b(),S(3),I(4,"span",14),z("click",function(){let i=ut(t).$implicit,s=je(2);return dt(s.deleteSectorFolder(i))}),S(5,"delete"),b()()}if(n&2){let t=e.$implicit;ie(3),Po(" ",t," ")}}function HZ(n,e){if(n&1&&(I(0,"div",9)(1,"h4",10),S(2,"Cartelle:"),b(),ot(3,$Z,6,1,"div",11),b()),n&2){let t=e.ngIf;ie(3),Ce("ngForOf",t)}}function qZ(n,e){n&1&&(I(0,"span",28),S(1,"link"),b())}function zZ(n,e){n&1&&(I(0,"span",28),S(1,"picture_as_pdf"),b())}function GZ(n,e){n&1&&(I(0,"span",28),S(1,"movie"),b())}function WZ(n,e){n&1&&(I(0,"span",28),S(1,"movie"),b())}function KZ(n,e){n&1&&(I(0,"span",28),S(1,"movie"),b())}function QZ(n,e){n&1&&(I(0,"span",28),S(1,"volume_up"),b())}function YZ(n,e){if(n&1&&(I(0,"a",24)(1,"div",25),J(2,"img",26),ot(3,qZ,2,0,"span",27)(4,zZ,2,0,"span",27)(5,GZ,2,0,"span",27)(6,WZ,2,0,"span",27)(7,KZ,2,0,"span",27)(8,QZ,2,0,"span",27),S(9),b()()),n&2){let t=e.$implicit,r=je().$implicit;Ce("href",r.links[t].link,Yp),ie(3),Ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes(".com")),ie(),Ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("pdf")),ie(),Ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp4")),ie(),Ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mkv")),ie(),Ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("wmv")),ie(),Ce("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp3")),ie(),Po(" ",r.links[t].label," ")}}function JZ(n,e){n&1&&(I(0,"span",28),S(1,"picture_as_pdf"),b())}function XZ(n,e){n&1&&(I(0,"span",28),S(1,"movie"),b())}function ZZ(n,e){n&1&&(I(0,"span",28),S(1,"movie"),b())}function eee(n,e){n&1&&(I(0,"span",28),S(1,"movie"),b())}function tee(n,e){n&1&&(I(0,"span",28),S(1,"volume_up"),b())}function nee(n,e){if(n&1&&(I(0,"a",24)(1,"div",25)(2,"span",28),S(3,"draft"),b(),S(4," Download "),ot(5,JZ,2,0,"span",27)(6,XZ,2,0,"span",27)(7,ZZ,2,0,"span",27)(8,eee,2,0,"span",27)(9,tee,2,0,"span",27),b()()),n&2){let t=je().$implicit;vI("href",t.storage_resource_link,Yp),ie(5),Ce("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("pdf")),ie(),Ce("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp4")),ie(),Ce("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mkv")),ie(),Ce("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("wmv")),ie(),Ce("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp3"))}}function ree(n,e){if(n&1){let t=cn();I(0,"div",15)(1,"h3",16),S(2),J(3,"div",17),I(4,"span",18),z("click",function(){let i=ut(t).$implicit,s=je();return dt(s.deleteProcedura(i))}),S(5,"delete"),b()(),I(6,"h4",19),S(7),b(),I(8,"p",20),S(9),b(),I(10,"div",21),ot(11,YZ,10,8,"a",22)(12,nee,10,6,"a",23),b()()}if(n&2){let t=e.$implicit,r=je();lr("id","procedure-id-",t.id,""),ie(2),II(" ",t.creator_name," ",t.creator_surname," | ",t.creator_agency_name," | ",r.formatTimestamp(t.timestamp)," /",t.folder_name," "),ie(5),$t(t.name),ie(2),$t(t.description),ie(2),Ce("ngForOf",r.getObjectKeys(t.links)),ie(),Ce("ngIf",t.storage_resource_link!="")}}function iee(n,e){if(n&1){let t=cn();I(0,"button",29),z("click",function(){ut(t);let i=je();return dt(i.getMoreSectorProcedures())}),S(1,"Recupera altre procedure"),b()}}var rj=(()=>{let e=class e{constructor(r,i,s){this.generalService=r,this.router=i,this.route=s,this.documents=new Ne([]),this.lastVisible="",this.nextPageAvailable=!0,this.matchingKeys$=new Ne([])}ngOnInit(){this.route.queryParams.subscribe(r=>{var i=r.sector_id,s=r.sector_name,o=r.sector_description;i==null&&this.router.navigate(["/chat"]),this.generalService.currentSectorId=i,document.getElementById("sector-name").innerText=s,document.getElementById("sector-description").innerText=o,this.getSectorProcedures(),this.getSectorFolders()})}getSectorProcedures(){return $.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).orderBy("timestamp","desc").where("folder_name","==","").limit(4).startAfter(this.lastVisible).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+r.message)})}getMoreSectorProcedures(){!this.lastVisible||!this.nextPageAvailable||$.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).orderBy("timestamp","desc").where("folder_name","==","").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}getSectorFolders(){this.matchingKeys$=new Ne([]),$.firestore().collection("sector_folders").doc("folders").get().then(r=>{if(r.exists){let i=r.data();if(this.matchingKeysUnfiltered=i,i){let s=[];for(let[o,a]of Object.entries(i))if(a===this.generalService.currentSectorId){let c=o.lastIndexOf("-"),l=c===-1?o:o.substring(0,c);s.push(l)}s.sort((o,a)=>o.localeCompare(a)),this.matchingKeys$.next(s),this.generalService.foldersNames}}else console.log("Documento non trovato!")}).catch(r=>{this.generalService.presentToast("Errore nel recuperare le cartelle di questo settore: "+r.message)})}showAddProcedurePopup(){this.getSectorFolders(),this.generalService.linkObject={},this.generalService.linkCounter=0,this.fillFolderNameSelection(),document.getElementById("add-new-procedure-popup").style.display="flex"}fillFolderNameSelection(){let r=document.getElementById("add-procedure-folder-input");r.innerHTML='<option value="">SELEZIONA</option>',this.matchingKeys$.subscribe(i=>{i.forEach(s=>{let o=s.lastIndexOf("-"),a=o===-1?s:s.substring(0,o),c=document.createElement("option");c.value=a,c.textContent=a,r.appendChild(c)})})}showAddProcedureFolder(){document.getElementById("add-new-procedure-folder-popup").style.display="flex"}getObjectKeys(r){return Object.keys(r)}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}openSectorFolder(r){this.documents=new Ne([]),$.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).where("folder_name","==",r).orderBy("timestamp","desc").startAfter(this.lastVisible).get().then(i=>{let s=[];if(i.forEach(o=>{s.push(q({id:o.id},o.data()))}),s.length>0){let a=[...this.documents.getValue(),...s];this.documents.next(a),s.length===4?this.lastVisible=i.docs[i.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(i=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+i.message),this.nextPageAvailable=!1})}deleteProcedura(r){confirm("Sei sicuro di voler cancellare questa procedura e tutti i suoi allegati?")&&(document.getElementById("procedure-id-"+r.id).innerHTML="Procedura eliminata",$.firestore().collection("procedure").doc(r.id).delete().then(()=>{if(r.storage_resource_path!=""){let i=Na($.storage(),r.storage_resource_path);X_(i).then(()=>{this.generalService.presentToast("La procedura e i relativi allegati sono stati eliminati con successo")}).catch(s=>{this.generalService.presentToast("Errore durante l'eliminazione della procedura: 'DELETE FILE ERROR' "+s.message)}).catch(s=>{this.generalService.presentToast("Errore durante l'eliminazione della procedura: 'DELETE DOC ERROR' "+s.message)})}else this.generalService.presentToast("La procedura e i relativi allegati sono stati eliminati con successo")}))}deleteSector(){confirm("Sei sicuro di voler cancellare questo settore?")&&$.firestore().collection("settori").doc(this.generalService.currentSectorId).delete().then(()=>{this.generalService.presentToast("Settore cancellato con successo")}).catch(r=>{this.generalService.presentToast("Errore durante la cancellazione del settore: "+r.message)})}deleteSectorFolder(r){if(confirm("Sei sicuro di voler cancellare questa cartella?")){let s=Object.keys(this.matchingKeysUnfiltered).find(o=>o.includes(r));if(!s){this.generalService.presentToast("Nessuna cartella corrispondente trovata");return}console.log(`Chiave da eliminare: ${s}`),$.firestore().collection("sector_folders").doc("folders").update({[s]:$.firestore.FieldValue.delete()}).then(()=>{this.getSectorFolders(),this.generalService.presentToast("Cartella eliminata con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'eliminazione della cartella: "+o.message)})}}};e.\u0275fac=function(i){return new(i||e)(ee(ze),ee(Xe),ee(Mr))},e.\u0275cmp=Se({type:e,selectors:[["app-settori"]],decls:21,vars:7,consts:[[2,"height","100%","overflow-y","auto","overflow-x","hidden","display","flex","flex-direction","column","padding-left","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.5rem","cursor","pointer","flex-wrap","wrap",3,"click"],["id","sector-name"],[1,"material-symbols-outlined","notranslate",2,"color","black","cursor","pointer","font-size","1.8rem",3,"click"],["id","sector-description",2,"margin-top","0rem"],["style","margin-bottom: 1rem;",4,"ngIf"],["id","procedure",2,"display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["class","card","style","padding-left: 1rem; padding-right: 1rem; padding-bottom: 1rem;",3,"id",4,"ngFor","ngForOf"],["class","button",3,"click",4,"ngIf"],[2,"margin-bottom","1rem"],[2,"margin-bottom","0.5rem"],["style","display: flex; flex-direction: row; align-items: center; gap: 0.5rem; cursor: pointer;",3,"click",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","cursor","pointer",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem",3,"click"],[1,"card",2,"padding-left","1rem","padding-right","1rem","padding-bottom","1rem",3,"id"],[2,"margin-bottom","0.5rem","display","flex","flex-direction","row","align-items","center"],[2,"flex","1"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer",3,"click"],[2,"margin-top","0rem","margin-bottom","0rem"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngFor","ngForOf"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngIf"],["target","_blank",2,"text-decoration","none",3,"href"],[1,"card",2,"height","2.5rem","display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem","padding-left","0.5rem","padding-right","0.5rem","border-radius","0.5rem"],["src","assets\\imgs\\a-autoteam-logo.png",2,"height","2rem","width","2rem"],["style","color: #313131; font-size: 1.8rem;","class","material-symbols-outlined notranslate",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"color","#313131","font-size","1.8rem"],[1,"button",3,"click"]],template:function(i,s){i&1&&(I(0,"div",0)(1,"h2",1),z("click",function(){return s.getSectorProcedures()}),J(2,"span",2),S(3," | "),I(4,"span",3),z("click",function(){return s.showAddProcedurePopup()}),S(5,"add_notes"),b(),J(6,"span",2),S(7," | "),I(8,"span",3),z("click",function(){return s.showAddProcedureFolder()}),S(9,"create_new_folder"),b(),J(10,"span",2),S(11," | "),I(12,"span",3),z("click",function(){return s.deleteSector()}),S(13,"delete"),b()(),J(14,"p",4),ot(15,HZ,4,1,"div",5),ur(16,"async"),I(17,"div",6),ot(18,ree,13,11,"div",7),ur(19,"async"),ot(20,iee,2,0,"button",8),b()()),i&2&&(ie(15),Ce("ngIf",dr(16,3,s.matchingKeys$)),ie(3),Ce("ngForOf",dr(19,5,s.documents)),ie(2),Ce("ngIf",s.nextPageAvailable))},dependencies:[ti,vs,ni]});let n=e;return n})();var ij=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.generalService.initNormalScreen()}};e.\u0275fac=function(i){return new(i||e)(ee(ze))},e.\u0275cmp=Se({type:e,selectors:[["app-home"]],decls:1,vars:0,consts:[[2,"height","100%","padding-left","1rem","display","flex","flex-direction","row","flex-wrap","wrap"]],template:function(i,s){i&1&&J(0,"div",0)}});let n=e;return n})();function see(n,e){n&1&&(I(0,"span"),S(1,"Aperto"),b())}function oee(n,e){n&1&&(I(0,"span"),S(1,"Chiuso"),b())}function aee(n,e){if(n&1){let t=cn();I(0,"div",12)(1,"div",13)(2,"span",14),S(3,"account_circle"),b(),I(4,"p"),S(5),b(),J(6,"div",11),I(7,"span",15),z("click",function(){let i=ut(t).$implicit,s=je();return dt(s.openTicketMenuPopup(i))}),S(8,"more_vert"),b()(),I(9,"h3",16),S(10),ot(11,see,2,0,"span",17)(12,oee,2,0,"span",17),b(),I(13,"p",18),S(14),b(),I(15,"div",19)(16,"div",20)(17,"div",21)(18,"span",22),S(19,"forum"),b(),I(20,"input",23),z("keydown.enter",function(){let i=ut(t).$implicit,s=je();return dt(s.addComment(i))}),b()(),I(21,"button",24),z("click",function(){let i=ut(t).$implicit,s=je();return dt(s.addComment(i))}),I(22,"span",25),S(23,"send"),b()()(),I(24,"p",26),z("click",function(){let i=ut(t).$implicit,s=je();return dt(s.getComments(i))}),I(25,"span",25),S(26,"keyboard_arrow_down"),b(),S(27,"Commenti"),b(),J(28,"div",27),b()()}if(n&2){let t=e.$implicit;lr("id","ticket-id-",t.id,""),ie(5),Wu("",t.name," ",t.surname," | ",t.agencyName,""),ie(5),Po("",t.argomento," | "),ie(),Ce("ngIf",t.status=="open"),ie(),Ce("ngIf",t.status=="close"),ie(2),$t(t.descrizione),ie(6),lr("id","comment-input-",t.id,""),ie(8),lr("id","comment-section-",t.id,"")}}function cee(n,e){if(n&1){let t=cn();I(0,"button",28),z("click",function(){ut(t);let i=je();return dt(i.getMoreTickets())}),S(1,"Recupera altri ticket"),b()}}var sj=(()=>{let e=class e{constructor(r){this.generalService=r,this.documents=new Ne([]),this.nextPageAvailable=!1,this.comments=new Ne([])}ngOnInit(){this.generalService.initNormalScreen(),this.getOpenTickets(),this.setAllTicketsRead()}setAllTicketsRead(){return g(this,null,function*(){let r=jr($.firestore(),"tickets"),i=yield Fh(r);localStorage.setItem("last-ticket-count",i.data().count+""),this.generalService.ticketToRead=!1,document.getElementById("ticket-to-see-counter-container").style.display="none"})}openAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="flex"}openTicketMenuPopup(r){this.generalService.currentTicket=r,document.getElementById("edit-menu-ticket-popup").style.display="flex",r.status=="open"&&(document.getElementById("open-ticket-button").style.display="none",document.getElementById("close-ticket-button").style.display="flex"),r.status=="close"&&(document.getElementById("open-ticket-button").style.display="flex",document.getElementById("close-ticket-button").style.display="none")}showCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="flex"}hideCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="none"}addComment(r){var i=$.auth().currentUser;let s=document.getElementById("comment-input-"+r.id),o=s.value;o.trim()&&($.database().ref("/comments/"+r.id+"/").push({text:o,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,timestamp:$.database.ServerValue.TIMESTAMP,creator_uid:i.uid}),s.value="",this.getComments(r))}getComments(r){let i=document.getElementById("comment-section-"+r.id);i.innerHTML="",i.style.display=="none"?$.database().ref(`/comments/${r.id}/`).once("value").then(s=>{s.forEach(a=>{let c=a.key,l=a.val(),d=document.getElementById("comment-section-"+r.id),h=document.createElement("div");h.className="comment";let p=document.createElement("p");p.style.marginBottom="0.5rem",p.textContent=l.name+" "+l.surname+" | "+l.agencyName+" | "+this.convertTimestamp(l.timestamp);let _=document.createElement("p");_.style.marginBottom="0.5rem",_.textContent=l.text,h.appendChild(p),h.appendChild(_),d.appendChild(h)});let o=document.getElementById("comment-section-"+r.id);o&&(o.style.display="flex")}).catch(s=>{console.error("Errore durante il recupero dei commenti:",s)}):i.style.display="none"}convertTimestamp(r){let s=new Date(r).toISOString(),[o,a]=s.split("T"),[c,l,d]=o.split("-"),[h]=a.split(".");return`${d}/${l}/${c} ${h}`}getTickets(){return $.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{console.error("Error getting documents: ",r)})}getOpenTickets(){return $.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","open").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket aperti: "+r.message)})}getClosedTickets(){return $.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","close").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket chiusi: "+r.message)})}getMyTickets(){var r=$.auth().currentUser;return $.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("creator_id","==",r.uid).onSnapshot(i=>{let s=[];i.forEach(o=>{s.push(q({id:o.id},o.data()))}),s.length===4?(this.lastVisible=i.docs[i.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(s)},i=>{this.generalService.presentToast("Errore nel recuperare i tuoi ticket: "+i.message)})}getMoreTickets(){!this.lastVisible||!this.nextPageAvailable||$.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}};e.\u0275fac=function(i){return new(i||e)(ee(ze))},e.\u0275cmp=Se({type:e,selectors:[["app-tickets"]],decls:24,vars:4,consts:[[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","flex-wrap","wrap"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","black","font-size","1.8rem","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","border","1px solid rgba(0, 0, 0, 0.192)","border-radius","2rem","padding-left","1rem","padding-right","1rem","height","2.5rem","overflow-y","hidden","overflow-x","auto"],[2,"cursor","pointer",3,"click"],[2,"height","100%","width","1px","background","rgba(0, 0, 0, 0.192)"],[2,"overflow-y","auto","overflow-x","hidden","padding-bottom","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","card","style","padding-left: 1rem; padding-bottom: 1rem;",3,"id",4,"ngFor","ngForOf"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],[2,"flex","1"],[1,"card",2,"padding-left","1rem","padding-bottom","1rem",3,"id"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","padding-right","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem",3,"click"],[2,"margin-top","0rem","margin-bottom","0rem"],[4,"ngIf"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","column","align-items","center","padding-right","1rem"],[2,"width","100%","height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem"],[1,"input-group",2,"width","calc(100% - 3.5rem)"],[1,"material-symbols-outlined","notranslate"],["type","text","placeholder","Scrivi un commento",1,"input",3,"keydown.enter","id"],[2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[2,"cursor","pointer","display","flex","flex-direction","row","align-items","center","width","100%",3,"click"],[2,"display","none","flex-direction","column","gap","1rem","width","100%",3,"id"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(I(0,"div",0)(1,"div",1)(2,"h2",2),S(3,"Tickets"),I(4,"span",3),z("click",function(){return s.openAddTicketPopup()}),S(5,"add_circle"),b()(),I(6,"div",4)(7,"h3",5),z("click",function(){return s.getOpenTickets()}),S(8,"Aperti"),b(),J(9,"div",6),I(10,"h3",5),z("click",function(){return s.getClosedTickets()}),S(11,"Chiusi"),b(),J(12,"div",6),I(13,"h3",5),z("click",function(){return s.getTickets()}),S(14,"Tutti"),b(),J(15,"div",6),I(16,"h3",5),z("click",function(){return s.getMyTickets()}),S(17,"Pubblicati da me"),b()()(),I(18,"div",7)(19,"div",8),ot(20,aee,29,13,"div",9),ur(21,"async"),ot(22,cee,2,0,"button",10),b()(),J(23,"div",11),b()),i&2&&(ie(20),Ce("ngForOf",dr(21,2,s.documents)),ie(2),Ce("ngIf",s.nextPageAvailable))},dependencies:[ti,vs,ni]});let n=e;return n})();var oj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Se({type:e,selectors:[["app-zoom"]],decls:26,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-y","auto","overflow-x","hidden","padding-left","1rem","padding-right","1rem"],[1,"card",2,"margin-top","1rem","padding-left","1rem","padding-bottom","1rem"],[2,"width","100%","display","flex","flex-direction","column","gap","0.5rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem"],[2,"color","#333","margin-top","0rem","margin-bottom","0rem"],["href","https://zoom.us/it/signin#/login","target","_blank",2,"color","#333","margin-top","0rem","margin-bottom","0rem"],[2,"color","#333","text-decoration","underline","margin-top","0rem","margin-bottom","0rem"]],template:function(i,s){i&1&&(I(0,"div",0)(1,"div",1)(2,"h3"),S(3,"Chiamata Zoom"),b(),I(4,"div",2)(5,"div",3)(6,"span",4),S(7,"link"),b(),I(8,"p",5),S(9,"Link:"),b(),I(10,"a",6),S(11,"https://zoom.us/it/signin#/login"),b()(),I(12,"div",3)(13,"span",4),S(14,"person"),b(),I(15,"p",5),S(16,"Nome Utente:"),b(),I(17,"p",7),S(18,"erika.c@agenziaautoteam.it"),b()(),I(19,"div",3)(20,"span",4),S(21,"key"),b(),I(22,"p",5),S(23,"Password:"),b(),I(24,"p",7),S(25,"Autoteam2022"),b()()()()())}});let n=e;return n})();var aj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Se({type:e,selectors:[["app-links"]],decls:5,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","overflow-y","auto","overflow-x","hidden","padding-left","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","black","font-size","1.8rem","cursor","pointer"]],template:function(i,s){i&1&&(I(0,"div",0)(1,"h2",1),S(2,"Link utili "),I(3,"span",2),S(4,"add_circle"),b()()())}});let n=e;return n})();var cj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){}changePassword(){let r=document.getElementById("change-password-email-input").value;$.auth().sendPasswordResetEmail(r).then(()=>{document.getElementById("change-password-email-input").value="",this.generalService.presentToast("Link per il cambio password inviato con successo, controlla la tua casella di posta ("+r+")")}).catch(i=>{this.generalService.presentToast("Errore nell'inviare l'email per il cambio password: "+i.message)})}};e.\u0275fac=function(i){return new(i||e)(ee(ze))},e.\u0275cmp=Se({type:e,selectors:[["app-change-password"]],decls:12,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],[2,"width","100%","margin-top","0.5rem"],[2,"margin-top","0rem"],[1,"input-group"],[1,"material-symbols-outlined","notranslate",2,"color","#333"],["id","change-password-email-input","type","text","placeholder","Email",1,"input"],[1,"button",2,"margin-top","1rem",3,"click"]],template:function(i,s){i&1&&(I(0,"div",0)(1,"h2",1),S(2,"Cambio password"),b(),I(3,"div",2)(4,"p",3),S(5,"Inserisci qui il tuo indirizzo email per ricevere un link per cambiare la tua password"),b(),I(6,"div",4)(7,"span",5),S(8,"mail"),b(),J(9,"input",6),b(),I(10,"button",7),z("click",function(){return s.changePassword()}),S(11,"Conferma"),b()()())}});let n=e;return n})();function lee(n,e){n&1&&(I(0,"div",4)(1,"h4",5),S(2,"Admin"),b(),I(3,"a",6),S(4,"Vai a utenti e permessi"),b()())}var lj=(()=>{let e=class e{ngOnInit(){}constructor(r){this.generalService=r}};e.\u0275fac=function(i){return new(i||e)(ee(ze))},e.\u0275cmp=Se({type:e,selectors:[["app-settings"]],decls:8,vars:1,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],["class","admin-elements",4,"ngIf"],["routerLink","/change-password",1,"a1",2,"margin-top","0.5rem"],[1,"admin-elements"],[2,"margin-bottom","0.5rem"],["href","assets\\settings\\permission-manager.html",1,"a1",2,"margin-top","0rem"]],template:function(i,s){i&1&&(I(0,"div",0)(1,"h2",1),S(2,"Impostazioni"),b(),ot(3,lee,5,0,"div",2),I(4,"h4",1),S(5,"Il mio account"),b(),I(6,"a",3),S(7,"Cambio password"),b()()),i&2&&(ie(3),Ce("ngIf",s.generalService.isAdmin))},dependencies:[vs,Pc]});let n=e;return n})();function uee(n,e){if(n&1){let t=cn();I(0,"tr",6)(1,"td",8),S(2),b(),I(3,"td",8),S(4),b(),I(5,"td",8),S(6),b(),I(7,"td",8)(8,"select",11),z("change",function(){let i=ut(t).$implicit,s=je();return dt(s.changeUserPermission(i))}),J(9,"option",12),I(10,"option",13),S(11,"Nessuno"),b(),I(12,"option",14),S(13,"Normale"),b(),I(14,"option",15),S(15,"Admin"),b()()(),I(16,"td",8),S(17),b(),I(18,"td",8),S(19),b(),I(20,"td",8)(21,"div",16)(22,"span",17),z("click",function(){let i=ut(t).$implicit,s=je();return dt(s.deleteUser(i))}),S(23,"delete"),b()()()()}if(n&2){let t=e.$implicit,r=je();ie(2),wI("",t.name," ",t.surname,""),ie(2),$t(t.email),ie(2),$t(t.agencyName),ie(2),lr("id","change-permission-type-input-",t.uid,""),ie(9),$t(r.formatFirebaseTimestamp(t.registration_date)),ie(2),$t(t.id)}}var uj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.getUsersList(),setTimeout(()=>{this.getUserPermission()},2e3)}formatFirebaseTimestamp(r){let i=new Date(r.seconds*1e3+r.nanoseconds/1e6),s={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"};return i.toLocaleString("it-IT",s)}getUsersList(){this.users=new Ue(r=>Ta(jr($.firestore(),"users_data"),s=>{let o=s.docs.map(a=>q({id:a.id},a.data()));r.next(o)},s=>{r.error(s)}))}getUserPermission(){$.firestore().collection("settings").doc("users_permissions").get().then(r=>{if(r.exists){let i=r.data();Object.entries(i).forEach(([s,o])=>{console.log(`Tag: ${s}, Valore: ${o}`),document.getElementById("change-permission-type-input-"+s).value=o})}else console.log("Documento non trovato.")}).catch(r=>{console.log("Errore nel recupero delle autorizzazioni:",r)})}changeUserPermission(r){let i=document.getElementById("change-permission-type-input-"+r.uid);confirm("Sei sicuro di voler modificare i permessi attribuiti a: "+r.email+"?")?i.value!=""&&$.firestore().collection("settings").doc("users_permissions").set({[r.uid]:i.value},{merge:!0}).then(()=>{alert("I permessi dell'utente: "+r.email+" sono stati modificati con successo")}).catch(s=>{alert("Errore durante la modifica dei permessi per questo utente: "+s.message)}):i.value=""}deleteUser(r){confirm("Sei sicuro di voler eliminare e di azzerare tutti i permessi per questo utente?")&&$.firestore().collection("users_data").doc(r.id).delete().then(()=>{$.firestore().collection("settings").doc("users_permissions").set({[r.uid]:"none"},{merge:!0}).catch(i=>{this.generalService.presentToast("Errore durante la modifica dei permessi per questo utente: "+i.message)}),this.generalService.presentToast("Utente e relativi permessi eliminati con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione dell'utente: "+i.message)})}};e.\u0275fac=function(i){return new(i||e)(ee(ze))},e.\u0275cmp=Se({type:e,selectors:[["app-admin"]],decls:26,vars:3,consts:[["id","settings-popup",2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],[2,"margin-top","0.5rem"],[2,"width","100%","overflow-x","auto","overflow-y","auto","border-radius","0.5rem"],[1,"table"],[1,"table-header"],[1,"table-row"],[1,"table-cell",2,"min-width","12rem"],[1,"table-cell"],[1,"table-body"],["class","table-row",4,"ngFor","ngForOf"],[3,"change","id"],["value",""],["value","none"],["value","normal"],["value","admin"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","1rem"],[1,"material-symbols-outlined","notranslate","table-button",3,"click"]],template:function(i,s){i&1&&(I(0,"div",0)(1,"h2",1),S(2,"Impostazioni"),b(),I(3,"p",2),S(4,"Utenti e permessi"),b(),I(5,"div",3)(6,"table",4)(7,"thead",5)(8,"tr",6)(9,"th",7),S(10,"Nome e Cognome"),b(),I(11,"th",8),S(12,"Email"),b(),I(13,"th",8),S(14,"Agenzia"),b(),I(15,"th",8),S(16,"Permessi"),b(),I(17,"th",7),S(18,"Data Registrazione"),b(),I(19,"th",8),S(20,"ID"),b(),I(21,"th",8),S(22,"Azioni"),b()()(),I(23,"tbody",9),ot(24,uee,24,8,"tr",10),ur(25,"async"),b()()()()),i&2&&(ie(24),Ce("ngForOf",dr(25,1,s.users)))},dependencies:[ti,au,cu,ni]});let n=e;return n})();var dee=[{path:"",redirectTo:"chat",pathMatch:"full"},{path:"log",component:qB},{path:"login",component:zB},{path:"register",component:ej},{path:"company",component:nj},{path:"chat",component:tj},{path:"procedure",component:rj},{path:"home",component:ij},{path:"tickets",component:sj},{path:"zoom",component:oj},{path:"links",component:aj},{path:"change-password",component:cj},{path:"settings",component:lj},{path:"settings/admin",component:uj}],dj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=On({type:e}),e.\u0275inj=kn({imports:[FE.forRoot(dee),FE]});let n=e;return n})();function hee(n,e){if(n&1){let t=cn();I(0,"button",11),z("click",function(){let i=ut(t).$implicit,s=je();return s.goToRoute("chat","close-sidebar"),dt(s.openChat(i))}),I(1,"span",12),S(2,"message"),b(),S(3),b()}if(n&2){let t=e.$implicit;ie(3),$t(t.name)}}function fee(n,e){if(n&1){let t=cn();I(0,"button",11),z("click",function(){let i=ut(t).$implicit,s=je();return s.goToRoute("settori","close-sidebar"),dt(s.showSectorProcedures(i))}),I(1,"span",12),S(2,"library_books"),b(),S(3),b()}if(n&2){let t=e.$implicit;ie(3),$t(t.name)}}var hj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.chatDocuments=new Ne([]),this.documents=new Ne([]),this.chats=new Ne([])}ngOnInit(){document.addEventListener("DOMContentLoaded",()=>{this.openCloseSettoriEProcedure()})}goToRoute(r,i){this.closeSidebarMobile(),this.router.navigate(["/"+r])}closeSidebarMobile(){window.innerWidth<=899&&(document.getElementById("sidebar-container").style.display="none")}openChat(r){this.router.navigate(["/chat"],{queryParams:{id:r.id,name:r.name}})}newChat(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-chat-popup").style.display="flex"}newSector(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-sector-popup").style.display="flex"}hideOrShowSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}logout(){window.confirm("Sei sicuro di volerti disconnettere?")&&$.auth().signOut().then(()=>{this.generalService.presentToast("Disconnessione effettuata con successo"),this.router.navigate(["/log"])}).catch(r=>{this.generalService.presentToast("Errore durante la disconnessione: "+r.message)})}showSectorProcedures(r){this.router.navigate(["/procedure"],{queryParams:{sector_id:r.id,sector_name:r.name,sector_description:r.description}})}openCloseSettoriEProcedure(){let r=document.getElementById("settori-menu-container"),i=document.getElementById("open-menu-icon1");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):$.firestore().collection("settori").orderBy("name_query").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(q({id:a.id},a.data()))}),this.documents.next(o),console.log(this.documents),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero dei settori: "+s.message)})}openCloseChats(){let r=document.getElementById("chats-menu-container"),i=document.getElementById("open-menu-icon2");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):$.firestore().collection("chats").orderBy("name_query").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(q({id:a.id},a.data()))}),this.chats.next(o),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero delle chat: "+s.message)})}};e.\u0275fac=function(i){return new(i||e)(ee(ze),ee(Xe))},e.\u0275cmp=Se({type:e,selectors:[["app-sidebar"]],decls:54,vars:6,consts:[["id","sidebar-container",2,"display","flex","height","100%"],["id","sidebar",1,"desktop-element",2,"display","flex","flex-direction","column","width","18rem","flex-shrink","0","height","calc(100% - 3.5rem)","background","white","border-right","1px solid rgba(0, 0, 0, 0.192)","overflow-y","auto","overflow-x","hidden"],["src","assets\\imgs\\logo.png",2,"width","100%","margin-top","1rem"],[1,"sidebar-button",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","ticket-to-see-counter-container",2,"background","red","border-radius","1rem","padding-left","0.5rem","padding-right","0.5rem"],["id","ticket-to-read-sidebar-display",2,"color","white"],["id","open-tickets-counter-container",2,"background","rgb(247, 150, 32)","border-radius","1rem","padding-left","0.5rem","padding-right","0.5rem"],["id","open-tickets-sidebar-display",2,"color","white"],["id","open-menu-icon2",1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","chats-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem"],[1,"sidebar-button",2,"width","100%",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.8rem"],["class","sidebar-button","style","width: 100%;",3,"click",4,"ngFor","ngForOf"],["id","open-menu-icon1",1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["id","settori-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem"],[2,"flex","1"],[1,"sidebar-button",2,"margin-bottom","1rem",3,"click"]],template:function(i,s){i&1&&(I(0,"div",0)(1,"div",1),J(2,"img",2),I(3,"button",3),z("click",function(){return s.goToRoute("company","close-sidebar")}),I(4,"span",4),S(5,"apartment"),b(),S(6,"L'azienda"),b(),I(7,"button",3),z("click",function(){return s.goToRoute("tickets","close-sidebar")}),I(8,"span",4),S(9,"style"),b(),S(10,"Tickets "),I(11,"div",5),J(12,"span",6),b(),I(13,"div",7),J(14,"span",8),b()(),I(15,"button",3),z("click",function(){return s.openCloseChats()}),I(16,"span",9),S(17,"keyboard_arrow_down"),b(),S(18,"Chat"),b(),I(19,"div",10)(20,"button",11),z("click",function(){return s.newChat()}),I(21,"span",12),S(22,"add_circle"),b(),S(23,"Nuova chat"),b(),ot(24,hee,4,1,"button",13),ur(25,"async"),b(),I(26,"button",3),z("click",function(){return s.openCloseSettoriEProcedure()}),I(27,"span",14),S(28,"keyboard_arrow_down"),b(),S(29,"Settori e procedure"),b(),I(30,"div",15)(31,"button",11),z("click",function(){return s.newSector()}),I(32,"span",12),S(33,"add_circle"),b(),S(34,"Nuovo settore"),b(),ot(35,fee,4,1,"button",13),ur(36,"async"),b(),I(37,"button",3),z("click",function(){return s.goToRoute("zoom","close-sidebar")}),I(38,"span",4),S(39,"videocam"),b(),S(40,"Chiamata Zoom"),b(),I(41,"button",3),z("click",function(){return s.goToRoute("links","close-sidebar")}),I(42,"span",4),S(43,"link"),b(),S(44,"Link utili"),b(),J(45,"div",16),I(46,"button",3),z("click",function(){return s.goToRoute("settings","close-sidebar")}),I(47,"span",4),S(48,"settings"),b(),S(49,"Impostazioni"),b(),I(50,"button",17),z("click",function(){return s.logout()}),I(51,"span",4),S(52,"logout"),b(),S(53,"Disconnetti"),b()()()),i&2&&(ie(24),Ce("ngForOf",dr(25,2,s.chats)),ie(11),Ce("ngForOf",dr(36,4,s.documents)))},dependencies:[ti,ni]});let n=e;return n})();var fj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.documents=new Ne([]),this.chatDocuments=new Ne([]),this.downloadURL=""}ngOnInit(){}closeAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="none"}closeTicketMenuPopup(){document.getElementById("edit-menu-ticket-popup").style.display="none"}closeAddNewSectorPopup(){document.getElementById("add-new-sector-popup").style.display="none"}closeAddNewProcedurePopup(){document.getElementById("add-new-procedure-popup").style.display="none"}closeAddNewProcedureFolderPopup(){document.getElementById("add-new-procedure-folder-popup").style.display="none"}closeAddNewChatPopup(){document.getElementById("add-new-chat-popup").style.display="none"}addTicket(){let r=document.getElementById("add-ticket-argomento-input").value,i=document.getElementById("add-ticket-description-input").value;var s=$.auth().currentUser;$.firestore().collection("tickets").add({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:s.email,creator_id:s.uid,timestamp:$.firestore.FieldValue.serverTimestamp(),status:"open"}).then(o=>{document.getElementById("add-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del ticket: "+o.message)})}deleteTicket(){window.confirm("Sei sicuro di voler eliminare questo ticket?")&&(document.getElementById("ticket-id-"+this.generalService.currentTicket.id).innerHTML="Ticket eliminato",$.firestore().collection("tickets").doc(this.generalService.currentTicket.id).delete().then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket eliminato con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'eliminazione del ticket: "+r.message)}))}openTicket(){$.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"open"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aperto con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'apertura del ticket: "+r.message)})}closeTicket(){$.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"close"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket chiuso con successo")}).catch(r=>{this.generalService.presentToast("Errore durante la chiusura del ticket: "+r.message)})}addNewSector(){let r=document.getElementById("add-sector-name-input"),i=document.getElementById("add-sector-description-input");var s=$.auth().currentUser;$.firestore().collection("settori").doc().set({name:r.value,name_query:r.value.toLowerCase(),description:i.value,timestamp:$.firestore.FieldValue.serverTimestamp(),creator_id:s.uid}).then(()=>{document.getElementById("add-new-sector-popup").style.display="none",this.generalService.presentToast("Settore aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del settore: "+o.message)})}addNewProcedureLink(){let r=document.getElementById("add-procedure-label-input"),i=document.getElementById("add-procedure-link-input"),s=document.getElementById("add-procedure-links-container"),o={label:r.value,link:i.value};this.generalService.linkObject[`resource${this.generalService.linkCounter}`]=o;let a=document.createElement("div");a.className="card",a.id=`entry${this.generalService.linkCounter}`,a.style.paddingLeft="0.8rem",a.style.borderRadius="0.5rem";let c=document.createElement("div");c.className="card-body";let l=document.createElement("h5");l.className="card-title",l.innerText=r.value,l.style.marginTop="0.5rem",l.style.marginBottom="0.5rem";let d=document.createElement("a");d.className="card-link",d.href=i.value,d.innerText=i.value,d.target="_blank",d.style.marginBottom="0.5rem",c.appendChild(l),c.appendChild(d),a.appendChild(c),s.appendChild(a),this.generalService.linkCounter++,r.value="",i.value=""}addNewProcedure(){let r=document.getElementById("add-procedure-name-input"),i=document.getElementById("add-procedure-description-input"),s=document.getElementById("fileInput2"),o=document.getElementById("uploadProgress"),a=document.getElementById("uploadStatus"),c=document.getElementById("add-procedure-folder-input");if(s.files&&s.files.length>0){let d=s.files[0];var l="files/"+d.name+"-date"+Date.now();let h=Na($.storage(),l),p=Y_(h,d);p.on("state_changed",_=>{let w=_.bytesTransferred/_.totalBytes*100;switch(o&&(o.value=w),a&&(a.textContent=`Caricamento: ${w.toFixed(2)}%`),_.state){case"paused":console.log("Caricamento in pausa");break;case"running":console.log("Caricamento in corso");break}},_=>{console.error("Errore nel caricamento:",_),a&&(a.textContent="Errore nel caricamento")},()=>{J_(p.snapshot.ref).then(_=>{this.downloadURL=_,a&&$.firestore().collection("procedure").doc().set({name:r.value,description:i.value,sector_id:this.generalService.currentSectorId,folder_name:c.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,timestamp:$.firestore.FieldValue.serverTimestamp(),links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:this.downloadURL,storage_resource_path:l}).then(()=>{document.getElementById("add-procedure-name-input").value="",document.getElementById("add-procedure-description-input").value="",document.getElementById("add-procedure-label-input").value="",document.getElementById("add-procedure-link-input").value="",document.getElementById("add-procedure-links-container").innerHTML="",document.getElementById("add-new-procedure-popup").style.display="none",this.generalService.presentToast("Procedura aggiunta con successo")}).catch(w=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+w.message)})})})}else $.firestore().collection("procedure").doc().set({name:r.value,description:i.value,sector_id:this.generalService.currentSectorId,folder_name:c.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,timestamp:$.firestore.FieldValue.serverTimestamp(),links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:"",storage_resource_path:""}).then(()=>{document.getElementById("add-procedure-name-input").value="",document.getElementById("add-procedure-description-input").value="",document.getElementById("add-procedure-label-input").value="",document.getElementById("add-procedure-link-input").value="",document.getElementById("add-procedure-links-container").innerHTML="",document.getElementById("add-new-procedure-popup").style.display="none",this.generalService.presentToast("Procedura aggiunta con successo")}).catch(d=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+d.message)})}addNewChat(){let r=document.getElementById("add-chat-name-input"),i=document.getElementById("add-chat-description-input");$.firestore().collection("chats").doc().set({name:r.value,name_query:r.value.toLowerCase(),description:i.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,timestamp:$.firestore.FieldValue.serverTimestamp()}).then(()=>{document.getElementById("add-chat-name-input").value="",document.getElementById("add-chat-description-input").value="",document.getElementById("add-new-chat-popup").style.display="none",this.generalService.presentToast("Chat creata con successo")}).catch(s=>{this.generalService.presentToast("Errore durante la creazione della chat: "+s.message)})}addNewProcedureFolder(){let r=document.getElementById("add-procedure-folder-name-input");$.firestore().collection("sector_folders").doc("folders").set({[r.value+"-"+Date.now()]:this.generalService.currentSectorId},{merge:!0}).then(()=>{document.getElementById("add-new-procedure-folder-popup").style.display="none",this.generalService.presentToast("Cartella aggiunta con successo")}).catch(i=>{this.generalService.presentToast("Errore durante la creazione della cartella: "+i.message)})}openNewTicketEmailTrigger(){return g(this,null,function*(){let r="https://api.web3forms.com/submit",i=document.createElement("div");document.body.appendChild(i);var s={access_key:"d5cd7471-0bd2-4973-b1de-86b0e38bb63f",name:"John Doe",email:"verdev.web@gmail.com",message:"Hello, this is a test message.",botcheck:""};i.innerHTML="Please wait...";let o=JSON.stringify(s);try{let a=yield fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:o}),c=yield a.json();a.status===200?i.innerHTML="Form submitted successfully":(console.log(a),i.innerHTML=c.message)}catch(a){console.log(a),i.innerHTML="Something went wrong!"}setTimeout(()=>{i.style.display="none"},3e3)})}};e.\u0275fac=function(i){return new(i||e)(ee(ze),ee(Xe))},e.\u0275cmp=Se({type:e,selectors:[["app-popups"]],decls:100,vars:0,consts:[["id","toast-message",2,"height","100%","width","100%","display","none","flex-direction","column","pointer-events","none","background","transparent","z-index","99999999","position","absolute","align-items","center","justify-content","end"],[1,"toastMessage",2,"pointer-events","all","width","95%"],["id","toast-message-text",2,"width","100%"],["id","add-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"min-width","18rem","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","space-between"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","black","cursor","pointer",3,"click"],[2,"width","100%","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-ticket-argomento-input","type","text","placeholder","Argomento",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-ticket-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[1,"button",3,"click"],["id","edit-menu-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[2,"display","flex","flex-direction","column","gap","1rem"],["id","open-ticket-button",1,"button",3,"click"],["id","close-ticket-button",1,"button",3,"click"],["id","add-new-chat-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-chat-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-chat-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-sector-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-sector-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-sector-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-procedure-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","50rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"width","100%","display","flex","flex-direction","row","flex-wrap","wrap","gap","1rem"],[2,"flex","1","min-width","15rem","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-procedure-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[2,"margin-top","-0.5rem","margin-bottom","-0.5rem","color","#333"],["id","add-procedure-folder-input",1,"inputGroup1",2,"height","2.5rem","border-radius","0.5rem"],["value",""],["id","add-procedure-label-input","type","text","placeholder","Etichetta",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-link-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-links-container",2,"display","flex","flex-direction","column","gap","0.5rem"],["id","fileInput2","type","file",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem","padding-top","1rem"],["id","uploadProgress","value","0","max","100",2,"width","100%"],["id","uploadStatus"],["id","add-new-procedure-folder-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","30rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],["id","add-procedure-folder-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'","height","2.5rem","border-radius","0.5rem"]],template:function(i,s){i&1&&(I(0,"div",0)(1,"div",1),J(2,"p",2),b()(),I(3,"div",3)(4,"div",4)(5,"h3",5),S(6,"Nuovo Ticket"),I(7,"span",6),z("click",function(){return s.closeAddTicketPopup()}),S(8,"close"),b()(),I(9,"div",7),J(10,"input",8)(11,"textarea",9),b(),I(12,"div",5)(13,"button",10),z("click",function(){return s.closeAddTicketPopup()}),S(14,"Annulla"),b(),I(15,"button",10),z("click",function(){return s.addTicket()}),S(16,"Pubblica"),b()()()(),I(17,"div",11)(18,"div",4)(19,"h3",5),S(20,"Men\xF9 ticket"),I(21,"span",6),z("click",function(){return s.closeTicketMenuPopup()}),S(22,"close"),b()(),I(23,"div",12)(24,"button",10),z("click",function(){return s.deleteTicket()}),S(25,"Elimina"),b(),I(26,"button",13),z("click",function(){return s.openTicket()}),S(27,"Apri"),b(),I(28,"button",14),z("click",function(){return s.closeTicket()}),S(29,"Chiudi"),b()()()(),I(30,"div",15)(31,"div",4)(32,"h3",5),S(33,"Nuova Chat"),I(34,"span",6),z("click",function(){return s.closeAddNewChatPopup()}),S(35,"close"),b()(),I(36,"div",7),J(37,"input",16)(38,"textarea",17),b(),I(39,"div",5)(40,"button",10),z("click",function(){return s.closeAddNewChatPopup()}),S(41,"Annulla"),b(),I(42,"button",10),z("click",function(){return s.addNewChat()}),S(43,"Aggiungi"),b()()()(),I(44,"div",18)(45,"div",4)(46,"h3",5),S(47,"Nuovo settore"),I(48,"span",6),z("click",function(){return s.closeAddNewSectorPopup()}),S(49,"close"),b()(),I(50,"div",7),J(51,"input",19)(52,"textarea",20),b(),I(53,"div",5)(54,"button",10),z("click",function(){return s.closeAddNewSectorPopup()}),S(55,"Annulla"),b(),I(56,"button",10),z("click",function(){return s.addNewSector()}),S(57,"Aggiungi"),b()()()(),I(58,"div",21)(59,"div",22)(60,"h3",5),S(61,"Nuova procedura"),I(62,"span",6),z("click",function(){return s.closeAddNewProcedurePopup()}),S(63,"close"),b()(),I(64,"div",23)(65,"div",24),J(66,"input",25)(67,"textarea",26),I(68,"p",27),S(69,"Cartella"),b(),I(70,"select",28),J(71,"option",29),b()(),I(72,"div",24),J(73,"input",30)(74,"input",31),I(75,"button",10),z("click",function(){return s.addNewProcedureLink()}),S(76,"Aggiungi Risorsa"),b(),J(77,"div",32)(78,"input",33)(79,"progress",34)(80,"span",35),b()(),I(81,"div",5)(82,"button",10),z("click",function(){return s.closeAddNewProcedurePopup()}),S(83,"Annulla"),b(),I(84,"button",10),z("click",function(){return s.addNewProcedure()}),S(85,"Conferma"),b()()()(),I(86,"div",36)(87,"div",37)(88,"h3",5),S(89,"Nuova cartella"),I(90,"span",6),z("click",function(){return s.closeAddNewProcedureFolderPopup()}),S(91,"close"),b()(),I(92,"div",23)(93,"div",24),J(94,"input",38),b()(),I(95,"div",5)(96,"button",10),z("click",function(){return s.closeAddNewProcedureFolderPopup()}),S(97,"Annulla"),b(),I(98,"button",10),z("click",function(){return s.addNewProcedureFolder()}),S(99,"Conferma"),b()()()())},dependencies:[au,cu]});let n=e;return n})();var pj=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){}hideOrShowSidebar(){this.generalService.openCloseSidebar()}openCloseSidebar(){this.generalService.openCloseSidebar()}};e.\u0275fac=function(i){return new(i||e)(ee(ze))},e.\u0275cmp=Se({type:e,selectors:[["app-header"]],decls:16,vars:0,consts:[["id","header",2,"height","3.5rem","border-bottom","1px solid rgba(0, 0, 0, 0.192)","display","flex","flex-direction","row","align-items","center","flex-shrink","0","justify-content","space-between","padding-left","1rem","padding-right","1rem"],[1,"desktop-element",2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2rem","color","#333","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.3rem"],["id","header-name-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-surname-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-email-display",2,"margin-top","0rem","margin-bottom","0rem"],["id","header-agency-display",2,"margin-bottom","0rem","margin-top","0rem"],[1,"mobile-element",2,"display","none","flex-direction","row","align-items","center","gap","1rem"]],template:function(i,s){i&1&&(I(0,"div",0)(1,"div",1)(2,"span",2),z("click",function(){return s.openCloseSidebar()}),S(3,"menu"),b(),I(4,"div")(5,"div",3),J(6,"h3",4)(7,"h3",5),b(),J(8,"p",6),b(),I(9,"p"),S(10," | "),b(),I(11,"div"),J(12,"h3",7),b()(),I(13,"div",8)(14,"span",2),z("click",function(){return s.hideOrShowSidebar()}),S(15,"menu"),b()()())}});let n=e;return n})();var mj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.initFirebase(),this.generalService.getUserData()}ngOnInit(){$.auth().onAuthStateChanged(i=>{i?(this.generalService.initNormalScreen(),this.checkForNewTickets()):this.router.navigate(["/log"])}),Ta(jr($.firestore(),"tickets"),i=>{i.docChanges().forEach(s=>{this.checkForNewTickets()})}),$.auth().onAuthStateChanged(i=>{i?$.firestore().collection("settings").doc("users_permissions").get().then(s=>{s.exists?s.get(i.uid)=="admin"&&(this.generalService.isAdmin=!0):console.log("Documento non trovato!")}).catch(s=>{console.error("Errore nel recupero del documento:",s)}):(this.router.navigate(["/log"]),this.generalService.presentToast("Utente non loggato"))})}checkForNewTickets(){return g(this,null,function*(){let r=jr($.firestore(),"tickets"),i=yield Fh(r),s=jr($.firestore(),"tickets"),o=$r(s,V_("status","==","open")),a=yield Fh(o);console.log("count: ",a.data().count),a.data().count!=0&&(document.getElementById("open-tickets-counter-container").style.display="flex",document.getElementById("open-tickets-sidebar-display").innerText=a.data().count+""),localStorage.getItem("last-ticket-count")!=null?Number(localStorage.getItem("last-ticket-count"))<i.data().count?(this.generalService.ticketToRead=!0,document.getElementById("ticket-to-see-counter-container").style.display="flex",this.ticketToReadSidebar=i.data().count-Number(localStorage.getItem("last-ticket-count")),document.getElementById("ticket-to-read-sidebar-display").innerText=this.ticketToReadSidebar,console.log("Hai nuovi ticket da leggere")):(this.generalService.ticketToRead=!1,document.getElementById("ticket-to-see-counter-container").style.display="none",console.log("Non Hai nessun ticket nuovo da leggere")):(localStorage.setItem("last-ticket-count","0"),this.checkForNewTickets())})}initFirebase(){let r={apiKey:"AIzaSyD_tP0OvuudgC3fbvxHs9SyCl5bMYnW3S4",authDomain:"ttm-db-82f02.firebaseapp.com",databaseURL:"https://ttm-db-82f02-default-rtdb.europe-west1.firebasedatabase.app",projectId:"ttm-db-82f02",storageBucket:"ttm-db-82f02.appspot.com",messagingSenderId:"264736388729",appId:"1:264736388729:web:4f5b8c6411d3ef47a786a8",measurementId:"G-FQYCE4Q6XN"};$.initializeApp(r)}openCloseSidebar(){this.generalService.openCloseSidebar()}};e.\u0275fac=function(i){return new(i||e)(ee(ze),ee(Xe))},e.\u0275cmp=Se({type:e,selectors:[["app-root"]],decls:7,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","row"],[2,"height","100%"],[2,"height","100%","width","100%"],["id","router-outlet-container",2,"width","calc(100% - 18rem)","height","calc(100% - 3.5rem)"]],template:function(i,s){i&1&&(J(0,"app-popups")(1,"app-header"),I(2,"div",0)(3,"div",1),J(4,"app-sidebar",2),b(),I(5,"div",3),J(6,"router-outlet"),b()())},dependencies:[xE,hj,fj,pj]});let n=e;return n})();var gj=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=On({type:e,bootstrap:[mj]}),e.\u0275inj=kn({providers:[{provide:Pr,useClass:mm}],imports:[QM,ZB,dj]});let n=e;return n})();KM().bootstrapModule(gj).catch(n=>console.error(n));
