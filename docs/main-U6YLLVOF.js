var FA=Object.defineProperty,gB=Object.defineProperties;var mB=Object.getOwnPropertyDescriptors;var OA=Object.getOwnPropertySymbols,_B=Object.getPrototypeOf,yB=Object.prototype.hasOwnProperty,vB=Object.prototype.propertyIsEnumerable,wB=Reflect.get;var LA=(n,e,t)=>e in n?FA(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,K=(n,e)=>{for(var t in e||={})yB.call(e,t)&&LA(n,t,e[t]);if(OA)for(var t of OA(e))vB.call(e,t)&&LA(n,t,e[t]);return n},nt=(n,e)=>gB(n,mB(e));var IB=(n,e)=>{for(var t in e)FA(n,t,{get:e[t],enumerable:!0})};var Tr=(n,e,t)=>wB(_B(n),t,e);var m=(n,e,t)=>new Promise((r,i)=>{var s=c=>{try{a(t.next(c))}catch(u){i(u)}},o=c=>{try{a(t.throw(c))}catch(u){i(u)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(n,e)).next())});var VA=null;var Ty=1,UA=Symbol("SIGNAL");function Me(n){let e=VA;return VA=n,e}var BA={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function EB(n){if(!(Dy(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Ty)){if(!n.producerMustRecompute(n)&&!by(n)){n.dirty=!1,n.lastCleanEpoch=Ty;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Ty}}function jA(n){return n&&(n.nextProducerIndex=0),Me(n)}function $A(n,e){if(Me(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Dy(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Cy(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function by(n){tf(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(EB(t),r!==t.version))return!0}return!1}function HA(n){if(tf(n),Dy(n))for(let e=0;e<n.producerNode.length;e++)Cy(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Cy(n,e){if(TB(n),tf(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)Cy(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];tf(i),i.producerIndexOfThis[r]=e}}function Dy(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function tf(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function TB(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function bB(){throw new Error}var CB=bB;function qA(n){CB=n}function oe(n){return typeof n=="function"}function ua(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var nf=ua(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Vu(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var bt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(oe(r))try{r()}catch(s){e=s instanceof nf?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{zA(s)}catch(o){e=e??[],o instanceof nf?e=[...e,...o.errors]:e.push(o)}}if(e)throw new nf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)zA(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Vu(t,e)}remove(e){let{_finalizers:t}=this;t&&Vu(t,e),e instanceof n&&e._removeParent(this)}};bt.EMPTY=(()=>{let n=new bt;return n.closed=!0,n})();var Sy=bt.EMPTY;function rf(n){return n instanceof bt||n&&"closed"in n&&oe(n.remove)&&oe(n.add)&&oe(n.unsubscribe)}function zA(n){oe(n)?n():n.unsubscribe()}var nr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var la={setTimeout(n,e,...t){let{delegate:r}=la;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=la;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function sf(n){la.setTimeout(()=>{let{onUnhandledError:e}=nr;if(e)e(n);else throw n})}function Uu(){}var GA=Ay("C",void 0,void 0);function WA(n){return Ay("E",void 0,n)}function KA(n){return Ay("N",n,void 0)}function Ay(n,e,t){return{kind:n,value:e,error:t}}var js=null;function da(n){if(nr.useDeprecatedSynchronousErrorHandling){let e=!js;if(e&&(js={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=js;if(js=null,t)throw r}}else n()}function QA(n){nr.useDeprecatedSynchronousErrorHandling&&js&&(js.errorThrown=!0,js.error=n)}var $s=class extends bt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,rf(e)&&e.add(this)):this.destination=AB}static create(e,t,r){return new ha(e,t,r)}next(e){this.isStopped?Ny(KA(e),this):this._next(e)}error(e){this.isStopped?Ny(WA(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Ny(GA,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},DB=Function.prototype.bind;function Ry(n,e){return DB.call(n,e)}var xy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){of(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){of(r)}else of(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){of(t)}}},ha=class extends $s{constructor(e,t,r){super();let i;if(oe(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&nr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Ry(e.next,s),error:e.error&&Ry(e.error,s),complete:e.complete&&Ry(e.complete,s)}):i=e}this.destination=new xy(i)}};function of(n){nr.useDeprecatedSynchronousErrorHandling?QA(n):sf(n)}function SB(n){throw n}function Ny(n,e){let{onStoppedNotification:t}=nr;t&&la.setTimeout(()=>t(n,e))}var AB={closed:!0,next:Uu,error:SB,complete:Uu};var fa=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Cn(n){return n}function Py(...n){return My(n)}function My(n){return n.length===0?Cn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Oe=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=NB(t)?t:new ha(t,r,i);return da(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=YA(r),new r((i,s)=>{let o=new ha({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[fa](){return this}pipe(...t){return My(t)(this)}toPromise(t){return t=YA(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function YA(n){var e;return(e=n??nr.Promise)!==null&&e!==void 0?e:Promise}function RB(n){return n&&oe(n.next)&&oe(n.error)&&oe(n.complete)}function NB(n){return n&&n instanceof $s||RB(n)&&rf(n)}function ky(n){return oe(n?.lift)}function ve(n){return e=>{if(ky(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function we(n,e,t,r,i){return new Oy(n,e,t,r,i)}var Oy=class extends $s{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function pa(){return ve((n,e)=>{let t=null;n._refCount++;let r=we(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var ga=class extends Oe{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,ky(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new bt;let t=this.getSubject();e.add(this.source.subscribe(we(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=bt.EMPTY)}return e}refCount(){return pa()(this)}};var JA=ua(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Gt=(()=>{class n extends Oe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new af(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new JA}next(t){da(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){da(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){da(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Sy:(this.currentObservers=null,s.push(t),new bt(()=>{this.currentObservers=null,Vu(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new Oe;return t.source=this,t}}return n.create=(e,t)=>new af(e,t),n})(),af=class extends Gt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Sy}};var Vt=class extends Gt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Dn=new Oe(n=>n.complete());function XA(n){return n&&oe(n.schedule)}function ZA(n){return n[n.length-1]}function eR(n){return oe(ZA(n))?n.pop():void 0}function Fi(n){return XA(ZA(n))?n.pop():void 0}function cf(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function nR(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?s(d.value):i(d.value).then(a,c)}u((r=r.apply(n,e||[])).next())})}function tR(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Hs(n){return this instanceof Hs?(this.v=n,this):new Hs(n)}function rR(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(w){return Promise.resolve(w).then(_,h)}}function a(_,w){r[_]&&(i[_]=function(C){return new Promise(function(A,O){s.push([_,C,A,O])>1||c(_,C)})},w&&(i[_]=w(i[_])))}function c(_,w){try{u(r[_](w))}catch(C){g(s[0][3],C)}}function u(_){_.value instanceof Hs?Promise.resolve(_.value.v).then(d,h):g(s[0][2],_)}function d(_){c("next",_)}function h(_){c("throw",_)}function g(_,w){_(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function iR(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof tR=="function"?tR(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}var uf=n=>n&&typeof n.length=="number"&&typeof n!="function";function lf(n){return oe(n?.then)}function df(n){return oe(n[fa])}function hf(n){return Symbol.asyncIterator&&oe(n?.[Symbol.asyncIterator])}function ff(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function xB(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var pf=xB();function gf(n){return oe(n?.[pf])}function mf(n){return rR(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Hs(t.read());if(i)return yield Hs(void 0);yield yield Hs(r)}}finally{t.releaseLock()}})}function _f(n){return oe(n?.getReader)}function At(n){if(n instanceof Oe)return n;if(n!=null){if(df(n))return PB(n);if(uf(n))return MB(n);if(lf(n))return kB(n);if(hf(n))return sR(n);if(gf(n))return OB(n);if(_f(n))return LB(n)}throw ff(n)}function PB(n){return new Oe(e=>{let t=n[fa]();if(oe(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function MB(n){return new Oe(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function kB(n){return new Oe(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,sf)})}function OB(n){return new Oe(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function sR(n){return new Oe(e=>{FB(n,e).catch(t=>e.error(t))})}function LB(n){return sR(mf(n))}function FB(n,e){var t,r,i,s;return nR(this,void 0,void 0,function*(){try{for(t=iR(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function _n(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function yf(n,e=0){return ve((t,r)=>{t.subscribe(we(r,i=>_n(r,n,()=>r.next(i),e),()=>_n(r,n,()=>r.complete(),e),i=>_n(r,n,()=>r.error(i),e)))})}function vf(n,e=0){return ve((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function oR(n,e){return At(n).pipe(vf(e),yf(e))}function aR(n,e){return At(n).pipe(vf(e),yf(e))}function cR(n,e){return new Oe(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function uR(n,e){return new Oe(t=>{let r;return _n(t,e,()=>{r=n[pf](),_n(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>oe(r?.return)&&r.return()})}function wf(n,e){if(!n)throw new Error("Iterable cannot be null");return new Oe(t=>{_n(t,e,()=>{let r=n[Symbol.asyncIterator]();_n(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function lR(n,e){return wf(mf(n),e)}function dR(n,e){if(n!=null){if(df(n))return oR(n,e);if(uf(n))return cR(n,e);if(lf(n))return aR(n,e);if(hf(n))return wf(n,e);if(gf(n))return uR(n,e);if(_f(n))return lR(n,e)}throw ff(n)}function ct(n,e){return e?dR(n,e):At(n)}function se(...n){let e=Fi(n);return ct(n,e)}function ma(n,e){let t=oe(n)?n:()=>n,r=i=>i.error(t());return new Oe(e?i=>e.schedule(r,0,i):r)}function Ly(n){return!!n&&(n instanceof Oe||oe(n.lift)&&oe(n.subscribe))}var ui=ua(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Ie(n,e){return ve((t,r)=>{let i=0;t.subscribe(we(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:VB}=Array;function UB(n,e){return VB(e)?n(...e):n(e)}function hR(n){return Ie(e=>UB(n,e))}var{isArray:BB}=Array,{getPrototypeOf:jB,prototype:$B,keys:HB}=Object;function fR(n){if(n.length===1){let e=n[0];if(BB(e))return{args:e,keys:null};if(qB(e)){let t=HB(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function qB(n){return n&&typeof n=="object"&&jB(n)===$B}function pR(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Bu(...n){let e=Fi(n),t=eR(n),{args:r,keys:i}=fR(n);if(r.length===0)return ct([],e);let s=new Oe(zB(r,e,i?o=>pR(i,o):Cn));return t?s.pipe(hR(t)):s}function zB(n,e,t=Cn){return r=>{gR(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)gR(e,()=>{let u=ct(n[c],e),d=!1;u.subscribe(we(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function gR(n,e,t){n?_n(t,n,e):e()}function mR(n,e,t,r,i,s,o,a){let c=[],u=0,d=0,h=!1,g=()=>{h&&!c.length&&!u&&e.complete()},_=C=>u<r?w(C):c.push(C),w=C=>{s&&e.next(C),u++;let A=!1;At(t(C,d++)).subscribe(we(e,O=>{i?.(O),s?_(O):e.next(O)},()=>{A=!0},void 0,()=>{if(A)try{for(u--;c.length&&u<r;){let O=c.shift();o?_n(e,o,()=>w(O)):w(O)}g()}catch(O){e.error(O)}}))};return n.subscribe(we(e,_,()=>{h=!0,g()})),()=>{a?.()}}function pt(n,e,t=1/0){return oe(e)?pt((r,i)=>Ie((s,o)=>e(r,s,i,o))(At(n(r,i))),t):(typeof e=="number"&&(t=e),ve((r,i)=>mR(r,i,n,t)))}function _a(n=1/0){return pt(Cn,n)}function _R(){return _a(1)}function ya(...n){return _R()(ct(n,Fi(n)))}function If(n){return new Oe(e=>{At(n()).subscribe(e)})}function Un(n,e){return ve((t,r)=>{let i=0;t.subscribe(we(r,s=>n.call(e,s,i++)&&r.next(s)))})}function Vi(n){return ve((e,t)=>{let r=null,i=!1,s;r=e.subscribe(we(t,void 0,void 0,o=>{s=At(n(o,Vi(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function yR(n,e,t,r,i){return(s,o)=>{let a=t,c=e,u=0;s.subscribe(we(o,d=>{let h=u++;c=a?n(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function qs(n,e){return oe(e)?pt(n,e,1):pt(n,1)}function Ui(n){return ve((e,t)=>{let r=!1;e.subscribe(we(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function li(n){return n<=0?()=>Dn:ve((e,t)=>{let r=0;e.subscribe(we(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Fy(n){return Ie(()=>n)}function Ef(n=GB){return ve((e,t)=>{let r=!1;e.subscribe(we(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function GB(){return new ui}function ju(n){return ve((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function br(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Un((i,s)=>n(i,s,r)):Cn,li(1),t?Ui(e):Ef(()=>new ui))}function va(n){return n<=0?()=>Dn:ve((e,t)=>{let r=[];e.subscribe(we(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Vy(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Un((i,s)=>n(i,s,r)):Cn,va(1),t?Ui(e):Ef(()=>new ui))}function Uy(n,e){return ve(yR(n,e,arguments.length>=2,!0))}function By(...n){let e=Fi(n);return ve((t,r)=>{(e?ya(n,t,e):ya(n,t)).subscribe(r)})}function Bn(n,e){return ve((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(we(r,c=>{i?.unsubscribe();let u=0,d=s++;At(n(c,d)).subscribe(i=we(r,h=>r.next(e?e(c,h,d,u++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function jy(n){return ve((e,t)=>{At(n).subscribe(we(t,()=>t.complete(),Uu)),!t.closed&&e.subscribe(t)})}function Ut(n,e,t){let r=oe(n)||e||t?{next:n,error:e,complete:t}:n;return r?ve((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(we(s,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),s.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):Cn}var tN="https://g.co/ng/security#xss",Z=class extends Error{constructor(e,t){super(Nv(e,t)),this.code=e}};function Nv(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function tl(n){return{toString:n}.toString()}var Tf="__parameters__";function WB(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function nN(n,e,t){return tl(()=>{let r=WB(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,u,d){let h=c.hasOwnProperty(Tf)?c[Tf]:Object.defineProperty(c,Tf,{value:[]})[Tf];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var sn=globalThis;function Ve(n){for(let e in n)if(n[e]===Ve)return e;throw Error("Could not find renamed property on target object.")}function Sn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Sn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function vR(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var KB=Ve({__forward_ref__:Ve});function rN(n){return n.__forward_ref__=rN,n.toString=function(){return Sn(this())},n}function $n(n){return iN(n)?n():n}function iN(n){return typeof n=="function"&&n.hasOwnProperty(KB)&&n.__forward_ref__===rN}function ee(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ar(n){return{providers:n.providers||[],imports:n.imports||[]}}function Yf(n){return wR(n,oN)||wR(n,aN)}function sN(n){return Yf(n)!==null}function wR(n,e){return n.hasOwnProperty(e)?n[e]:null}function QB(n){let e=n&&(n[oN]||n[aN]);return e||null}function IR(n){return n&&(n.hasOwnProperty(ER)||n.hasOwnProperty(YB))?n[ER]:null}var oN=Ve({\u0275prov:Ve}),ER=Ve({\u0275inj:Ve}),aN=Ve({ngInjectableDef:Ve}),YB=Ve({ngInjectorDef:Ve}),ce=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ee({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function cN(n){return n&&!!n.\u0275providers}var JB=Ve({\u0275cmp:Ve}),XB=Ve({\u0275dir:Ve}),ZB=Ve({\u0275pipe:Ve}),ej=Ve({\u0275mod:Ve}),xf=Ve({\u0275fac:Ve}),$u=Ve({__NG_ELEMENT_ID__:Ve}),TR=Ve({__NG_ENV_ID__:Ve});function xv(n){return typeof n=="string"?n:n==null?"":String(n)}function tj(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():xv(n)}function nj(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new Z(-200,n)}function Pv(n,e){throw new Z(-201,!1)}var me=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(me||{}),Jy;function uN(){return Jy}function jn(n){let e=Jy;return Jy=n,e}function lN(n,e,t){let r=Yf(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&me.Optional)return null;if(e!==void 0)return e;Pv(n,"Injector")}var rj={},qu=rj,Xy="__NG_DI_FLAG__",Pf="ngTempTokenPath",ij="ngTokenPath",sj=/\n/gm,oj="\u0275",bR="__source",ba;function aj(){return ba}function Bi(n){let e=ba;return ba=n,e}function cj(n,e=me.Default){if(ba===void 0)throw new Z(-203,!1);return ba===null?lN(n,void 0,e):ba.get(n,e&me.Optional?null:void 0,e)}function te(n,e=me.Default){return(uN()||cj)($n(n),e)}function q(n,e=me.Default){return te(n,Jf(e))}function Jf(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Zy(n){let e=[];for(let t=0;t<n.length;t++){let r=$n(n[t]);if(Array.isArray(r)){if(r.length===0)throw new Z(900,!1);let i,s=me.Default;for(let o=0;o<r.length;o++){let a=r[o],c=uj(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(te(i,s))}else e.push(te(r))}return e}function dN(n,e){return n[Xy]=e,n.prototype[Xy]=e,n}function uj(n){return n[Xy]}function lj(n,e,t,r){let i=n[Pf];throw e[bR]&&i.unshift(e[bR]),n.message=dj(`
`+n.message,i,t,r),n[ij]=i,n[Pf]=null,n}function dj(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==oj?n.slice(2):n;let i=Sn(e);if(Array.isArray(e))i=e.map(Sn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Sn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(sj,`
  `)}`}var Mv=dN(nN("Optional"),8);var hN=dN(nN("SkipSelf"),4);function Da(n,e){let t=n.hasOwnProperty(xf);return t?n[xf]:null}function kv(n,e){n.forEach(t=>Array.isArray(t)?kv(t,e):e(t))}function fN(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Mf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var zu={},Cr=[],Sa=new ce(""),pN=new ce("",-1),gN=new ce(""),kf=class{get(e,t=qu){if(t===qu){let r=new Error(`NullInjectorError: No provider for ${Sn(e)}!`);throw r.name="NullInjectorError",r}return t}},mN=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(mN||{}),Ar=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Ar||{}),sr=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(sr||{});function hj(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function ev(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];fj(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function _N(n){return n===3||n===4||n===6}function fj(n){return n.charCodeAt(0)===64}function Ov(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?CR(n,t,i,null,e[++r]):CR(n,t,i,null,null))}}return n}function CR(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var yN="ng-template";function pj(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&hj(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Lv(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Lv(n){return n.type===4&&n.value!==yN}function gj(n,e,t){let r=n.type===4&&!t?yN:n.value;return e===r}function mj(n,e,t){let r=4,i=n.attrs,s=i!==null?vj(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!rr(r)&&!rr(c))return!1;if(o&&rr(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!gj(n,c,t)||c===""&&e.length===1){if(rr(r))return!1;o=!0}}else if(r&8){if(i===null||!pj(n,i,c,t)){if(rr(r))return!1;o=!0}}else{let u=e[++a],d=_j(c,i,Lv(n),t);if(d===-1){if(rr(r))return!1;o=!0;continue}if(u!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&u!==h){if(rr(r))return!1;o=!0}}}}return rr(r)||o}function rr(n){return(n&1)===0}function _j(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return wj(e,n)}function yj(n,e,t=!1){for(let r=0;r<e.length;r++)if(mj(n,e[r],t))return!0;return!1}function vj(n){for(let e=0;e<n.length;e++){let t=n[e];if(_N(t))return e}return n.length}function wj(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function DR(n,e){return n?":not("+e.trim()+")":e}function Ij(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!rr(o)&&(e+=DR(s,i),i=""),r=o,s=s||!rr(r);t++}return i!==""&&(e+=DR(s,i)),e}function Ej(n){return n.map(Ij).join(",")}function Tj(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!rr(i))break;i=s}r++}return{attrs:e,classes:t}}function Rt(n){return tl(()=>{let e=TN(n),t=nt(K({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===mN.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Ar.Emulated,styles:n.styles||Cr,_:null,schemas:n.schemas||null,tView:null,id:""});bN(t);let r=n.dependencies;return t.directiveDefs=AR(r,!1),t.pipeDefs=AR(r,!0),t.id=Dj(t),t})}function bj(n){return $i(n)||vN(n)}function Cj(n){return n!==null}function cr(n){return tl(()=>({type:n.type,bootstrap:n.bootstrap||Cr,declarations:n.declarations||Cr,imports:n.imports||Cr,exports:n.exports||Cr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function SR(n,e){if(n==null)return zu;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=sr.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==sr.None?[r,a]:r,e[s]=o):t[s]=r}return t}function Xf(n){return tl(()=>{let e=TN(n);return bN(e),e})}function $i(n){return n[JB]||null}function vN(n){return n[XB]||null}function wN(n){return n[ZB]||null}function IN(n){let e=$i(n)||vN(n)||wN(n);return e!==null?e.standalone:!1}function EN(n,e){let t=n[ej]||null;if(!t&&e===!0)throw new Error(`Type ${Sn(n)} does not have '\u0275mod' property.`);return t}function TN(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||zu,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||Cr,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:SR(n.inputs,e),outputs:SR(n.outputs),debugInfo:null}}function bN(n){n.features?.forEach(e=>e(n))}function AR(n,e){if(!n)return null;let t=e?wN:bj;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(Cj)}function Dj(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Sj(...n){return{\u0275providers:CN(!0,n),\u0275fromNgModule:!0}}function CN(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return kv(e,o=>{let a=o;tv(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&DN(i,s),t}function DN(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Fv(i,s=>{e(s,r)})}}function tv(n,e,t,r){if(n=$n(n),!n)return!1;let i=null,s=IR(n),o=!s&&$i(n);if(!s&&!o){let c=n.ngModule;if(s=IR(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let u of c)tv(u,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let u;try{kv(s.imports,d=>{tv(d,e,t,r)&&(u||=[],u.push(d))})}finally{}u!==void 0&&DN(u,e)}if(!a){let u=Da(i)||(()=>new i);e({provide:i,useFactory:u,deps:Cr},i),e({provide:gN,useValue:i,multi:!0},i),e({provide:Sa,useValue:()=>te(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let u=n;Fv(c,d=>{e(d,u)})}}else return!1;return i!==n&&n.providers!==void 0}function Fv(n,e){for(let t of n)cN(t)&&(t=t.\u0275providers),Array.isArray(t)?Fv(t,e):e(t)}var Aj=Ve({provide:String,useValue:Ve});function SN(n){return n!==null&&typeof n=="object"&&Aj in n}function Rj(n){return!!(n&&n.useExisting)}function Nj(n){return!!(n&&n.useFactory)}function nv(n){return typeof n=="function"}var Zf=new ce(""),Df={},xj={},$y;function Vv(){return $y===void 0&&($y=new kf),$y}var yn=class{},Gu=class extends yn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,iv(e,o=>this.processProvider(o)),this.records.set(pN,wa(void 0,this)),i.has("environment")&&this.records.set(yn,wa(void 0,this));let s=this.records.get(Zf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(gN,Cr,me.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Me(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Me(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Bi(this),r=jn(void 0),i;try{return e()}finally{Bi(t),jn(r)}}get(e,t=qu,r=me.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(TR))return e[TR](this);r=Jf(r);let i,s=Bi(this),o=jn(void 0);try{if(!(r&me.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=Fj(e)&&Yf(e);u&&this.injectableDefInScope(u)?c=wa(rv(e),Df):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&me.Self?Vv():this.parent;return t=r&me.Optional&&t===qu?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Pf]=a[Pf]||[]).unshift(Sn(e)),s)throw a;return lj(a,e,"R3InjectorError",this.source)}else throw a}finally{jn(o),Bi(s)}}resolveInjectorInitializers(){let e=Me(null),t=Bi(this),r=jn(void 0),i;try{let s=this.get(Sa,Cr,me.Self);for(let o of s)o()}finally{Bi(t),jn(r),Me(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Sn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Z(205,!1)}processProvider(e){e=$n(e);let t=nv(e)?e:$n(e&&e.provide),r=Mj(e);if(!nv(e)&&e.multi===!0){let i=this.records.get(t);i||(i=wa(void 0,Df,!0),i.factory=()=>Zy(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Me(null);try{return t.value===Df&&(t.value=xj,t.value=t.factory()),typeof t.value=="object"&&t.value&&Lj(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Me(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=$n(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function rv(n){let e=Yf(n),t=e!==null?e.factory:Da(n);if(t!==null)return t;if(n instanceof ce)throw new Z(204,!1);if(n instanceof Function)return Pj(n);throw new Z(204,!1)}function Pj(n){if(n.length>0)throw new Z(204,!1);let t=QB(n);return t!==null?()=>t.factory(n):()=>new n}function Mj(n){if(SN(n))return wa(void 0,n.useValue);{let e=kj(n);return wa(e,Df)}}function kj(n,e,t){let r;if(nv(n)){let i=$n(n);return Da(i)||rv(i)}else if(SN(n))r=()=>$n(n.useValue);else if(Nj(n))r=()=>n.useFactory(...Zy(n.deps||[]));else if(Rj(n))r=()=>te($n(n.useExisting));else{let i=$n(n&&(n.useClass||n.provide));if(Oj(n))r=()=>new i(...Zy(n.deps));else return Da(i)||rv(i)}return r}function wa(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Oj(n){return!!n.deps}function Lj(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function Fj(n){return typeof n=="function"||typeof n=="object"&&n instanceof ce}function iv(n,e){for(let t of n)Array.isArray(t)?iv(t,e):t&&cN(t)?iv(t.\u0275providers,e):e(t)}function fi(n,e){n instanceof Gu&&n.assertNotDestroyed();let t,r=Bi(n),i=jn(void 0);try{return e()}finally{Bi(r),jn(i)}}function AN(){return uN()!==void 0||aj()!=null}function Vj(n){if(!AN())throw new Z(-203,!1)}function Uj(n){let e=sn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function Bj(n){return typeof n=="function"}var pi=0,Ee=1,ae=2,Wt=3,ir=4,ur=5,Of=6,Wu=7,di=8,Aa=9,or=10,An=11,Ku=12,RR=13,nl=14,Rr=15,Uv=16,Ia=17,ep=18,tp=19,RN=20,ji=21,Hy=22,Ws=23,Ks=25,NN=1;var Qs=7,Lf=8,Ff=9,Hn=10,Bv=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Bv||{});function zs(n){return Array.isArray(n)&&typeof n[NN]=="object"}function gi(n){return Array.isArray(n)&&n[NN]===!0}function xN(n){return(n.flags&4)!==0}function jv(n){return n.componentOffset>-1}function PN(n){return(n.flags&1)===1}function rl(n){return!!n.template}function jj(n){return(n[ae]&512)!==0}var sv=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function MN(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function il(){return kN}function kN(n){return n.type.prototype.ngOnChanges&&(n.setInput=Hj),$j}il.ngInherit=!0;function $j(){let n=LN(this),e=n?.current;if(e){let t=n.previous;if(t===zu)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Hj(n,e,t,r,i){let s=this.declaredInputs[r],o=LN(n)||qj(n,{previous:zu,current:null}),a=o.current||(o.current={}),c=o.previous,u=c[s];a[s]=new sv(u&&u.currentValue,t,c===zu),MN(n,e,i,t)}var ON="__ngSimpleChanges__";function LN(n){return n[ON]||null}function qj(n,e){return n[ON]=e}var NR=null;var Dr=function(n,e,t){NR?.(n,e,t)},zj="svg",Gj="math",Wj=!1;function Kj(){return Wj}function hi(n){for(;Array.isArray(n);)n=n[pi];return n}function lr(n,e){return hi(e[n.index])}function FN(n,e){return n.data[e]}function Js(n,e){let t=e[n];return zs(t)?t:t[pi]}function $v(n){return(n[ae]&128)===128}function Qj(n){return gi(n[Wt])}function xR(n,e){return e==null?null:n[e]}function VN(n){n[Ia]=0}function Yj(n){n[ae]&1024||(n[ae]|=1024,$v(n)&&Qu(n))}function Hv(n){return!!(n[ae]&9216||n[Ws]?.dirty)}function ov(n){n[or].changeDetectionScheduler?.notify(1),Hv(n)?Qu(n):n[ae]&64&&(Kj()?(n[ae]|=1024,Qu(n)):n[or].changeDetectionScheduler?.notify())}function Qu(n){n[or].changeDetectionScheduler?.notify();let e=Yu(n);for(;e!==null&&!(e[ae]&8192||(e[ae]|=8192,!$v(e)));)e=Yu(e)}function UN(n,e){if((n[ae]&256)===256)throw new Z(911,!1);n[ji]===null&&(n[ji]=[]),n[ji].push(e)}function Jj(n,e){if(n[ji]===null)return;let t=n[ji].indexOf(e);t!==-1&&n[ji].splice(t,1)}function Yu(n){let e=n[Wt];return gi(e)?e[Wt]:e}var xe={lFrame:GN(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Xj(){return xe.lFrame.elementDepthCount}function Zj(){xe.lFrame.elementDepthCount++}function e$(){xe.lFrame.elementDepthCount--}function BN(){return xe.bindingsEnabled}function t$(){return xe.skipHydrationRootTNode!==null}function n$(n){return xe.skipHydrationRootTNode===n}function r$(){xe.skipHydrationRootTNode=null}function on(){return xe.lFrame.lView}function sl(){return xe.lFrame.tView}function dr(){let n=jN();for(;n!==null&&n.type===64;)n=n.parent;return n}function jN(){return xe.lFrame.currentTNode}function i$(){let n=xe.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function np(n,e){let t=xe.lFrame;t.currentTNode=n,t.isParent=e}function $N(){return xe.lFrame.isParent}function s$(){xe.lFrame.isParent=!1}function o$(n){return xe.lFrame.bindingIndex=n}function a$(){return xe.lFrame.bindingIndex++}function c$(){return xe.lFrame.inI18n}function u$(n,e){let t=xe.lFrame;t.bindingIndex=t.bindingRootIndex=n,av(e)}function l$(){return xe.lFrame.currentDirectiveIndex}function av(n){xe.lFrame.currentDirectiveIndex=n}function HN(n){xe.lFrame.currentQueryIndex=n}function d$(n){let e=n[Ee];return e.type===2?e.declTNode:e.type===1?n[ur]:null}function qN(n,e,t){if(t&me.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&me.Host);)if(i=d$(s),i===null||(s=s[nl],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=xe.lFrame=zN();return r.currentTNode=e,r.lView=n,!0}function qv(n){let e=zN(),t=n[Ee];xe.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function zN(){let n=xe.lFrame,e=n===null?null:n.child;return e===null?GN(n):e}function GN(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function WN(){let n=xe.lFrame;return xe.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var KN=WN;function zv(){let n=WN();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function h$(){return xe.lFrame.selectedIndex}function Ys(n){xe.lFrame.selectedIndex=n}function f$(){let n=xe.lFrame;return FN(n.tView,n.selectedIndex)}function p$(){return xe.lFrame.currentNamespace}var QN=!0;function YN(){return QN}function JN(n){QN=n}function g$(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=kN(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function XN(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Sf(n,e,t){ZN(n,e,3,t)}function Af(n,e,t,r){(n[ae]&3)===t&&ZN(n,e,t,r)}function qy(n,e){let t=n[ae];(t&3)===e&&(t&=16383,t+=1,n[ae]=t)}function ZN(n,e,t,r){let i=r!==void 0?n[Ia]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Ia]+=65536),(a<s||s==-1)&&(m$(n,t,e,c),n[Ia]=(n[Ia]&4294901760)+c+2),c++}function PR(n,e){Dr(4,n,e);let t=Me(null);try{e.call(n)}finally{Me(t),Dr(5,n,e)}}function m$(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[ae]>>14<n[Ia]>>16&&(n[ae]&3)===e&&(n[ae]+=16384,PR(a,s)):PR(a,s)}var Ca=-1,Ju=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function _$(n){return n instanceof Ju}function y$(n){return(n.flags&8)!==0}function v$(n){return(n.flags&16)!==0}function ex(n){return n!==Ca}function Vf(n){return n&32767}function w$(n){return n>>16}function Uf(n,e){let t=w$(n),r=e;for(;t>0;)r=r[nl],t--;return r}var cv=!0;function MR(n){let e=cv;return cv=n,e}var I$=256,tx=I$-1,nx=5,E$=0,Sr={};function T$(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty($u)&&(r=t[$u]),r==null&&(r=t[$u]=E$++);let i=r&tx,s=1<<i;e.data[n+(i>>nx)]|=s}function rx(n,e){let t=ix(n,e);if(t!==-1)return t;let r=e[Ee];r.firstCreatePass&&(n.injectorIndex=e.length,zy(r.data,n),zy(e,null),zy(r.blueprint,null));let i=Gv(n,e),s=n.injectorIndex;if(ex(i)){let o=Vf(i),a=Uf(i,e),c=a[Ee].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|c[o+u]}return e[s+8]=i,s}function zy(n,e){n.push(0,0,0,0,0,0,0,0,e)}function ix(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Gv(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=ux(i),r===null)return Ca;if(t++,i=i[nl],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Ca}function b$(n,e,t){T$(n,e,t)}function C$(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(_N(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function sx(n,e,t){if(t&me.Optional||n!==void 0)return n;Pv(e,"NodeInjector")}function ox(n,e,t,r){if(t&me.Optional&&r===void 0&&(r=null),!(t&(me.Self|me.Host))){let i=n[Aa],s=jn(void 0);try{return i?i.get(e,r,t&me.Optional):lN(e,r,t&me.Optional)}finally{jn(s)}}return sx(r,e,t)}function ax(n,e,t,r=me.Default,i){if(n!==null){if(e[ae]&2048&&!(r&me.Self)){let o=N$(n,e,t,r,Sr);if(o!==Sr)return o}let s=cx(n,e,t,r,Sr);if(s!==Sr)return s}return ox(e,t,r,i)}function cx(n,e,t,r,i){let s=A$(t);if(typeof s=="function"){if(!qN(e,n,r))return r&me.Host?sx(i,t,r):ox(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&me.Optional))Pv(t);else return o}finally{KN()}}else if(typeof s=="number"){let o=null,a=ix(n,e),c=Ca,u=r&me.Host?e[Rr][ur]:null;for((a===-1||r&me.SkipSelf)&&(c=a===-1?Gv(n,e):e[a+8],c===Ca||!OR(r,!1)?a=-1:(o=e[Ee],a=Vf(c),e=Uf(c,e)));a!==-1;){let d=e[Ee];if(kR(s,a,d.data)){let h=D$(a,e,t,o,r,u);if(h!==Sr)return h}c=e[a+8],c!==Ca&&OR(r,e[Ee].data[a+8]===u)&&kR(s,a,e)?(o=d,a=Vf(c),e=Uf(c,e)):a=-1}}return i}function D$(n,e,t,r,i,s){let o=e[Ee],a=o.data[n+8],c=r==null?jv(a)&&cv:r!=o&&(a.type&3)!==0,u=i&me.Host&&s===a,d=S$(a,o,t,c,u);return d!==null?Xu(e,o,d,a):Sr}function S$(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,u=n.directiveEnd,d=s>>20,h=r?a:a+d,g=i?a+d:u;for(let _=h;_<g;_++){let w=o[_];if(_<c&&t===w||_>=c&&w.type===t)return _}if(i){let _=o[c];if(_&&rl(_)&&_.type===t)return c}return null}function Xu(n,e,t,r){let i=n[t],s=e.data;if(_$(i)){let o=i;o.resolving&&nj(tj(s[t]));let a=MR(o.canSeeViewProviders);o.resolving=!0;let c,u=o.injectImpl?jn(o.injectImpl):null,d=qN(n,r,me.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&g$(t,s[t],e)}finally{u!==null&&jn(u),MR(a),o.resolving=!1,KN()}}return i}function A$(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty($u)?n[$u]:void 0;return typeof e=="number"?e>=0?e&tx:R$:e}function kR(n,e,t){let r=1<<n;return!!(t[e+(n>>nx)]&r)}function OR(n,e){return!(n&me.Self)&&!(n&me.Host&&e)}var Gs=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return ax(this._tNode,this._lView,e,Jf(r),t)}};function R$(){return new Gs(dr(),on())}function Wv(n){return tl(()=>{let e=n.prototype.constructor,t=e[xf]||uv(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[xf]||uv(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function uv(n){return iN(n)?()=>{let e=uv($n(n));return e&&e()}:Da(n)}function N$(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[ae]&2048&&!(o[ae]&512);){let a=cx(s,o,t,r|me.Self,Sr);if(a!==Sr)return a;let c=s.parent;if(!c){let u=o[RN];if(u){let d=u.get(t,Sr,r);if(d!==Sr)return d}c=ux(o),o=o[nl]}s=c}return i}function ux(n){let e=n[Ee],t=e.type;return t===2?e.declTNode:t===1?n[ur]:null}function Kv(n){return C$(dr(),n)}function LR(n,e=null,t=null,r){let i=lx(n,e,t,r);return i.resolveInjectorInitializers(),i}function lx(n,e=null,t=null,r,i=new Set){let s=[t||Cr,Sj(n)];return r=r||(typeof n=="object"?void 0:Sn(n)),new Gu(s,e||Vv(),r||null,i)}var xr=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return LR({name:""},i,r,"");{let s=r.name??"";return LR({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=qu,e.NULL=new kf,e.\u0275prov=ee({token:e,providedIn:"any",factory:()=>te(pN)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var x$="ngOriginalError";function Gy(n){return n[x$]}var Nr=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Gy(e);for(;t&&Gy(t);)t=Gy(t);return t||null}},dx=new ce("",{providedIn:"root",factory:()=>q(Nr).handleError.bind(void 0)}),Qv=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=P$,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),lv=class extends Qv{constructor(e){super(),this._lView=e}onDestroy(e){return UN(this._lView,e),()=>Jj(this._lView,e)}};function P$(){return new lv(on())}function M$(){return Yv(dr(),on())}function Yv(n,e){return new ol(lr(n,e))}var ol=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=M$;let n=e;return n})();var dv=class extends Gt{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,AN()&&(this.destroyRef=q(Qv,{optional:!0})??void 0)}emit(e){let t=Me(null);try{super.next(e)}finally{Me(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Wy(s),i&&(i=Wy(i)),o&&(o=Wy(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof bt&&e.add(a),a}};function Wy(n){return e=>{setTimeout(n,void 0,e)}}var rn=dv;function hx(n){return(n.flags&128)===128}var fx=new Map,k$=0;function O$(){return k$++}function L$(n){fx.set(n[tp],n)}function F$(n){fx.delete(n[tp])}var FR="__ngContext__";function Ra(n,e){zs(e)?(n[FR]=e[tp],L$(e)):n[FR]=e}function px(n){return mx(n[Ku])}function gx(n){return mx(n[ir])}function mx(n){for(;n!==null&&!gi(n);)n=n[ir];return n}var hv;function _x(n){hv=n}function V$(){if(hv!==void 0)return hv;if(typeof document<"u")return document;throw new Z(210,!1)}var rp=new ce("",{providedIn:"root",factory:()=>U$}),U$="ng",Jv=new ce(""),qi=new ce("",{providedIn:"platform",factory:()=>"unknown"});var Xv=new ce("",{providedIn:"root",factory:()=>V$().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var B$="h",j$="b";var $$=()=>null;function Zv(n,e,t=!1){return $$(n,e,t)}var yx=!1,H$=new ce("",{providedIn:"root",factory:()=>yx});var bf;function q$(){if(bf===void 0&&(bf=null,sn.trustedTypes))try{bf=sn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return bf}function VR(n){return q$()?.createScriptURL(n)||n}var Bf=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${tN})`}};function ip(n){return n instanceof Bf?n.changingThisBreaksApplicationSecurity:n}function ew(n,e){let t=z$(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${tN})`)}return t===e}function z$(n){return n instanceof Bf&&n.getTypeName()||null}var G$=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function vx(n){return n=String(n),n.match(G$)?n:"unsafe:"+n}var sp=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(sp||{});function W$(n){let e=Ix();return e?e.sanitize(sp.URL,n)||"":ew(n,"URL")?ip(n):vx(xv(n))}function K$(n){let e=Ix();if(e)return VR(e.sanitize(sp.RESOURCE_URL,n)||"");if(ew(n,"ResourceURL"))return VR(ip(n));throw new Z(904,!1)}function Q$(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?K$:W$}function wx(n,e,t){return Q$(e,t)(n)}function Ix(){let n=on();return n&&n[or].sanitizer}function Ex(n){return n instanceof Function?n():n}function Y$(n){return(n??q(xr)).get(qi)==="browser"}var Xs=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Xs||{}),J$;function tw(n,e){return J$(n,e)}function Ea(n,e,t,r,i){if(r!=null){let s,o=!1;gi(r)?s=r:zs(r)&&(o=!0,r=r[pi]);let a=hi(r);n===0&&t!==null?i==null?Sx(e,t,a):jf(e,t,a,i||null,!0):n===1&&t!==null?jf(e,t,a,i||null,!0):n===2?fH(e,a,o):n===3&&e.destroyNode(a),s!=null&&gH(e,n,s,t,i)}}function X$(n,e){return n.createText(e)}function Tx(n,e,t){return n.createElement(e,t)}function Z$(n,e){bx(n,e),e[pi]=null,e[ur]=null}function eH(n,e,t,r,i,s){r[pi]=i,r[ur]=e,op(n,r,t,1,i,s)}function bx(n,e){e[or].changeDetectionScheduler?.notify(1),op(n,e,e[An],2,null,null)}function tH(n){let e=n[Ku];if(!e)return Ky(n[Ee],n);for(;e;){let t=null;if(zs(e))t=e[Ku];else{let r=e[Hn];r&&(t=r)}if(!t){for(;e&&!e[ir]&&e!==n;)zs(e)&&Ky(e[Ee],e),e=e[Wt];e===null&&(e=n),zs(e)&&Ky(e[Ee],e),t=e&&e[ir]}e=t}}function nH(n,e,t,r){let i=Hn+r,s=t.length;r>0&&(t[i-1][ir]=e),r<s-Hn?(e[ir]=t[i],fN(t,Hn+r,e)):(t.push(e),e[ir]=null),e[Wt]=t;let o=e[Uv];o!==null&&t!==o&&rH(o,e);let a=e[ep];a!==null&&a.insertView(n),ov(e),e[ae]|=128}function rH(n,e){let t=n[Ff],i=e[Wt][Wt][Rr];e[Rr]!==i&&(n[ae]|=Bv.HasTransplantedViews),t===null?n[Ff]=[e]:t.push(e)}function Cx(n,e){let t=n[Ff],r=t.indexOf(e);t.splice(r,1)}function fv(n,e){if(n.length<=Hn)return;let t=Hn+e,r=n[t];if(r){let i=r[Uv];i!==null&&i!==n&&Cx(i,r),e>0&&(n[t-1][ir]=r[ir]);let s=Mf(n,Hn+e);Z$(r[Ee],r);let o=s[ep];o!==null&&o.detachView(s[Ee]),r[Wt]=null,r[ir]=null,r[ae]&=-129}return r}function Dx(n,e){if(!(e[ae]&256)){let t=e[An];t.destroyNode&&op(n,e,t,3,null,null),tH(e)}}function Ky(n,e){if(e[ae]&256)return;let t=Me(null);try{e[ae]&=-129,e[ae]|=256,e[Ws]&&HA(e[Ws]),sH(n,e),iH(n,e),e[Ee].type===1&&e[An].destroy();let r=e[Uv];if(r!==null&&gi(e[Wt])){r!==e[Wt]&&Cx(r,e);let i=e[ep];i!==null&&i.detachView(n)}F$(e)}finally{Me(t)}}function iH(n,e){let t=n.cleanup,r=e[Wu];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[Wu]=null);let i=e[ji];if(i!==null){e[ji]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function sH(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Ju)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Dr(4,a,c);try{c.call(a)}finally{Dr(5,a,c)}}else{Dr(4,i,s);try{s.call(i)}finally{Dr(5,i,s)}}}}}function oH(n,e,t){return aH(n,e.parent,t)}function aH(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[pi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===Ar.None||s===Ar.Emulated)return null}return lr(r,t)}}function jf(n,e,t,r,i){n.insertBefore(e,t,r,i)}function Sx(n,e,t){n.appendChild(e,t)}function UR(n,e,t,r,i){r!==null?jf(n,e,t,r,i):Sx(n,e,t)}function cH(n,e,t,r){n.removeChild(e,t,r)}function nw(n,e){return n.parentNode(e)}function uH(n,e){return n.nextSibling(e)}function lH(n,e,t){return hH(n,e,t)}function dH(n,e,t){return n.type&40?lr(n,t):null}var hH=dH,BR;function Ax(n,e,t,r){let i=oH(n,r,e),s=e[An],o=r.parent||e[ur],a=lH(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)UR(s,i,t[c],a,!1);else UR(s,i,t,a,!1);BR!==void 0&&BR(s,r,e,t,i)}function Rf(n,e){if(e!==null){let t=e.type;if(t&3)return lr(e,n);if(t&4)return pv(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Rf(n,r);{let i=n[e.index];return gi(i)?pv(-1,i):hi(i)}}else{if(t&32)return tw(e,n)()||hi(n[e.index]);{let r=Rx(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Yu(n[Rr]);return Rf(i,r)}else return Rf(n,e.next)}}}return null}function Rx(n,e){if(e!==null){let r=n[Rr][ur],i=e.projection;return r.projection[i]}return null}function pv(n,e){let t=Hn+n+1;if(t<e.length){let r=e[t],i=r[Ee].firstChild;if(i!==null)return Rf(r,i)}return e[Qs]}function fH(n,e,t){let r=nw(n,e);r&&cH(n,r,e,t)}function rw(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&e===0&&(a&&Ra(hi(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)rw(n,e,t.child,r,i,s,!1),Ea(e,n,i,a,s);else if(c&32){let u=tw(t,r),d;for(;d=u();)Ea(e,n,i,d,s);Ea(e,n,i,a,s)}else c&16?pH(n,e,r,t,i,s):Ea(e,n,i,a,s);t=o?t.projectionNext:t.next}}function op(n,e,t,r,i,s){rw(t,r,n.firstChild,e,i,s,!1)}function pH(n,e,t,r,i,s){let o=t[Rr],c=o[ur].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let d=c[u];Ea(e,n,i,d,s)}else{let u=c,d=o[Wt];hx(r)&&(u.flags|=128),rw(n,e,u,d,i,s,!0)}}function gH(n,e,t,r,i){let s=t[Qs],o=hi(t);s!==o&&Ea(e,n,r,s,i);for(let a=Hn;a<t.length;a++){let c=t[a];op(c[Ee],c,n,e,r,s)}}function mH(n,e,t){n.setAttribute(e,"style",t)}function Nx(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function xx(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&ev(n,e,r),i!==null&&Nx(n,e,i),s!==null&&mH(n,e,s)}var Px={};function _H(n,e,t,r){if(!r)if((e[ae]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Sf(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Af(e,s,0,t)}Ys(t)}function ut(n,e=me.Default){let t=on();if(t===null)return te(n,e);let r=dr();return ax(r,t,$n(n),e)}function Mx(){let n="invalid";throw new Error(n)}function kx(n,e,t,r,i,s){let o=Me(null);try{let a=null;i&sr.SignalBased&&(a=e[r][UA]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&sr.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):MN(e,a,r,s)}finally{Me(o)}}function yH(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Ys(~i);else{let s=i,o=t[++r],a=t[++r];u$(o,s);let c=e[s];a(2,c)}}}finally{Ys(-1)}}function iw(n,e,t,r,i,s,o,a,c,u,d){let h=e.blueprint.slice();return h[pi]=i,h[ae]=r|4|128|8|64,(u!==null||n&&n[ae]&2048)&&(h[ae]|=2048),VN(h),h[Wt]=h[nl]=n,h[di]=t,h[or]=o||n&&n[or],h[An]=a||n&&n[An],h[Aa]=c||n&&n[Aa]||null,h[ur]=s,h[tp]=O$(),h[Of]=d,h[RN]=u,h[Rr]=e.type==2?n[Rr]:h,h}function sw(n,e,t,r,i){let s=n.data[e];if(s===null)s=vH(n,e,t,r,i),c$()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=i$();s.injectorIndex=o===null?-1:o.injectorIndex}return np(s,!0),s}function vH(n,e,t,r,i){let s=jN(),o=$N(),a=o?s:s&&s.parent,c=n.data[e]=DH(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function Ox(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function Lx(n,e,t,r,i){let s=h$(),o=r&2;try{Ys(-1),o&&e.length>Ks&&_H(n,e,Ks,!1),Dr(o?2:0,i),t(r,i)}finally{Ys(s),Dr(o?3:1,i)}}function Fx(n,e,t){if(xN(e)){let r=Me(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Me(r)}}}function wH(n,e,t){BN()&&(xH(n,e,t,lr(t,e)),(t.flags&64)===64&&jx(n,e,t))}function IH(n,e,t=lr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function Vx(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Ux(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Ux(n,e,t,r,i,s,o,a,c,u,d){let h=Ks+r,g=h+i,_=EH(h,g),w=typeof u=="function"?u():u;return _[Ee]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:d}}function EH(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Px);return t}function TH(n,e,t,r){let s=r.get(H$,yx)||t===Ar.ShadowDom,o=n.selectRootElement(e,s);return bH(o),o}function bH(n){CH(n)}var CH=()=>null;function DH(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return t$()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function jR(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=sr.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let u=s;if(i!==null){if(!i.hasOwnProperty(s))continue;u=i[s]}n===0?$R(r,t,u,a,c):$R(r,t,u,a)}return r}function $R(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function SH(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,u=null;for(let d=r;d<i;d++){let h=s[d],g=t?t.get(h):null,_=g?g.inputs:null,w=g?g.outputs:null;c=jR(0,h.inputs,d,c,_),u=jR(1,h.outputs,d,u,w);let C=c!==null&&o!==null&&!Lv(e)?$H(c,d,o):null;a.push(C)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function AH(n,e,t,r){if(BN()){let i=r===null?null:{"":-1},s=MH(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&Bx(n,e,t,o,i,a),i&&kH(t,r,i)}t.mergedAttrs=Ov(t.mergedAttrs,t.attrs)}function Bx(n,e,t,r,i,s){for(let u=0;u<r.length;u++)b$(rx(t,e),n,r[u].type);LH(t,n.data.length,r.length);for(let u=0;u<r.length;u++){let d=r[u];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=Ox(n,e,r.length,null);for(let u=0;u<r.length;u++){let d=r[u];t.mergedAttrs=Ov(t.mergedAttrs,d.hostAttrs),FH(n,t,e,c,d),OH(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}SH(n,t,s)}function RH(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;NH(o)!=a&&o.push(a),o.push(t,r,s)}}function NH(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function xH(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;jv(t)&&VH(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||rx(t,e),Ra(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],u=Xu(e,n,a,t);if(Ra(u,e),o!==null&&jH(e,a-i,u,c,t,o),rl(c)){let d=Js(t.index,e);d[di]=Xu(e,n,a,t)}}}function jx(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=l$();try{Ys(s);for(let a=r;a<i;a++){let c=n.data[a],u=e[a];av(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&PH(c,u)}}finally{Ys(-1),av(o)}}function PH(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function MH(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(yj(e,o.selectors,!1))if(r||(r=[]),rl(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;gv(n,e,c)}else r.unshift(o),gv(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function gv(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function kH(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new Z(-301,!1);r.push(e[i],s)}}}function OH(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;rl(e)&&(t[""]=n)}}function LH(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function FH(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Da(i.type,!0)),o=new Ju(s,rl(i),ut);n.blueprint[r]=o,t[r]=o,RH(n,e,r,Ox(n,t,i.hostVars,Px),i)}function VH(n,e,t){let r=lr(e,n),i=Vx(t),s=n[or].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=ow(n,iw(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function UH(n,e,t,r,i,s){let o=lr(n,e);BH(e[An],o,s,n.value,t,r,i)}function BH(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?xv(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function jH(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],u=o[a++],d=o[a++],h=o[a++];kx(r,t,c,u,d,h)}}function $H(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function HH(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function $x(n,e){let t=n.contentQueries;if(t!==null){let r=Me(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];HN(s),a.contentQueries(2,e[o],o)}}}finally{Me(r)}}}function ow(n,e){return n[Ku]?n[RR][ir]=e:n[Ku]=e,n[RR]=e,e}function mv(n,e,t){HN(0);let r=Me(null);try{e(n,t)}finally{Me(r)}}function qH(n){return n[Wu]||(n[Wu]=[])}function zH(n){return n.cleanup||(n.cleanup=[])}function Hx(n,e){let t=n[Aa],r=t?t.get(Nr,null):null;r&&r.handleError(e)}function qx(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],u=e[o],d=n.data[o];kx(d,u,r,a,c,i)}}function GH(n,e){let t=Js(e,n),r=t[Ee];WH(r,t);let i=t[pi];i!==null&&t[Of]===null&&(t[Of]=Zv(i,t[Aa])),zx(r,t,t[di])}function WH(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function zx(n,e,t){qv(e);try{let r=n.viewQuery;r!==null&&mv(1,r,t);let i=n.template;i!==null&&Lx(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[ep]?.finishViewCreation(n),n.staticContentQueries&&$x(n,e),n.staticViewQueries&&mv(2,n.viewQuery,t);let s=n.components;s!==null&&KH(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ae]&=-5,zv()}}function KH(n,e){for(let t=0;t<e.length;t++)GH(n,e[t])}function HR(n,e){return!e||e.firstChild===null||hx(n)}function QH(n,e,t,r=!0){let i=e[Ee];if(nH(i,e,n,t),r){let o=pv(t,n),a=e[An],c=nw(a,n[Qs]);c!==null&&eH(i,n[ur],a,e,c,o)}let s=e[Of];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function $f(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(hi(s)),gi(s)&&YH(s,r);let o=t.type;if(o&8)$f(n,e,t.child,r);else if(o&32){let a=tw(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=Rx(e,t);if(Array.isArray(a))r.push(...a);else{let c=Yu(e[Rr]);$f(c[Ee],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function YH(n,e){for(let t=Hn;t<n.length;t++){let r=n[t],i=r[Ee].firstChild;i!==null&&$f(r[Ee],r,i,e)}n[Qs]!==n[pi]&&e.push(n[Qs])}var Gx=[];function JH(n){return n[Ws]??XH(n)}function XH(n){let e=Gx.pop()??Object.create(eq);return e.lView=n,e}function ZH(n){n.lView[Ws]!==n&&(n.lView=null,Gx.push(n))}var eq=nt(K({},BA),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Qu(n.lView)},consumerOnSignalRead(){this.lView[Ws]=this}}),Wx=100;function Kx(n,e=!0,t=0){let r=n[or],i=r.rendererFactory,s=!1;s||i.begin?.();try{tq(n,t)}catch(o){throw e&&Hx(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function tq(n,e){_v(n,e);let t=0;for(;Hv(n);){if(t===Wx)throw new Z(103,!1);t++,_v(n,1)}}function nq(n,e,t,r){let i=e[ae];if((i&256)===256)return;let s=!1;!s&&e[or].inlineEffectRunner?.flush(),qv(e);let o=null,a=null;!s&&rq(n)&&(a=JH(e),o=jA(a));try{VN(e),o$(n.bindingStartIndex),t!==null&&Lx(n,e,t,2,r);let c=(i&3)===3;if(!s)if(c){let h=n.preOrderCheckHooks;h!==null&&Sf(e,h,null)}else{let h=n.preOrderHooks;h!==null&&Af(e,h,0,null),qy(e,0)}if(iq(e),Qx(e,0),n.contentQueries!==null&&$x(n,e),!s)if(c){let h=n.contentCheckHooks;h!==null&&Sf(e,h)}else{let h=n.contentHooks;h!==null&&Af(e,h,1),qy(e,1)}yH(n,e);let u=n.components;u!==null&&Jx(e,u,0);let d=n.viewQuery;if(d!==null&&mv(2,d,r),!s)if(c){let h=n.viewCheckHooks;h!==null&&Sf(e,h)}else{let h=n.viewHooks;h!==null&&Af(e,h,2),qy(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Hy]){for(let h of e[Hy])h();e[Hy]=null}s||(e[ae]&=-73)}catch(c){throw Qu(e),c}finally{a!==null&&($A(a,o),ZH(a)),zv()}}function rq(n){return n.type!==2}function Qx(n,e){for(let t=px(n);t!==null;t=gx(t))for(let r=Hn;r<t.length;r++){let i=t[r];Yx(i,e)}}function iq(n){for(let e=px(n);e!==null;e=gx(e)){if(!(e[ae]&Bv.HasTransplantedViews))continue;let t=e[Ff];for(let r=0;r<t.length;r++){let i=t[r],s=i[Wt];Yj(i)}}}function sq(n,e,t){let r=Js(e,n);Yx(r,t)}function Yx(n,e){$v(n)&&_v(n,e)}function _v(n,e){let r=n[Ee],i=n[ae],s=n[Ws],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&by(s)),s&&(s.dirty=!1),n[ae]&=-9217,o)nq(r,n,r.template,n[di]);else if(i&8192){Qx(n,1);let a=r.components;a!==null&&Jx(n,a,1)}}function Jx(n,e,t){for(let r=0;r<e.length;r++)sq(n,e[r],t)}function aw(n){for(n[or].changeDetectionScheduler?.notify();n;){n[ae]|=64;let e=Yu(n);if(jj(n)&&!e)return n;n=e}return null}var Na=class{get rootNodes(){let e=this._lView,t=e[Ee];return $f(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[di]}set context(e){this._lView[di]=e}get destroyed(){return(this._lView[ae]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Wt];if(gi(e)){let t=e[Lf],r=t?t.indexOf(this):-1;r>-1&&(fv(e,r),Mf(t,r))}this._attachedToViewContainer=!1}Dx(this._lView[Ee],this._lView)}onDestroy(e){UN(this._lView,e)}markForCheck(){aw(this._cdRefInjectingView||this._lView)}detach(){this._lView[ae]&=-129}reattach(){ov(this._lView),this._lView[ae]|=128}detectChanges(){this._lView[ae]|=1024,Kx(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Z(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,bx(this._lView[Ee],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Z(902,!1);this._appRef=e,ov(this._lView)}};var Jne=new RegExp(`^(\\d+)*(${j$}|${B$})*(.*)`);var oq=()=>null;function qR(n,e){return oq(n,e)}var Hf=class{},yv=class{},qf=class{};function aq(n){let e=Error(`No component factory found for ${Sn(n)}.`);return e[cq]=n,e}var cq="ngComponent";var vv=class{resolveComponentFactory(e){throw aq(e)}},ap=(()=>{let e=class e{};e.NULL=new vv;let n=e;return n})(),Zu=class{},cp=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>uq();let n=e;return n})();function uq(){let n=on(),e=dr(),t=Js(e.index,n);return(zs(t)?t:n)[An]}var lq=(()=>{let e=class e{};e.\u0275prov=ee({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),Qy={};var zR=new Set;function cw(n){zR.has(n)||(zR.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function GR(...n){}function dq(){let n=typeof sn.requestAnimationFrame=="function",e=sn[n?"requestAnimationFrame":"setTimeout"],t=sn[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var $e=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new rn(!1),this.onMicrotaskEmpty=new rn(!1),this.onStable=new rn(!1),this.onError=new rn(!1),typeof Zone>"u")throw new Z(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=dq().nativeRequestAnimationFrame,pq(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Z(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Z(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,hq,GR,GR);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},hq={};function uw(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function fq(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(sn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,wv(n),n.isCheckStableRunning=!0,uw(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),wv(n))}function pq(n){let e=()=>{fq(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(gq(a))return t.invokeTask(i,s,o,a);try{return WR(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),KR(n)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return WR(n),t.invoke(i,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),KR(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,wv(n),uw(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function wv(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function WR(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function KR(n){n._nesting--,uw(n)}var Iv=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new rn,this.onMicrotaskEmpty=new rn,this.onStable=new rn,this.onError=new rn}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function gq(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}function mq(n="zone.js",e){return n==="noop"?new Iv:n==="zone.js"?new $e(e):n}var Ta=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Ta||{}),_q={destroy(){}};function up(n,e){!e&&Vj(up);let t=e?.injector??q(xr);if(!Y$(t))return _q;cw("NgAfterNextRender");let r=t.get(lw),i=r.handler??=new Tv,s=e?.phase??Ta.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(Qv).onDestroy(o),c=fi(t,()=>new Ev(s,()=>{o(),n()}));return i.register(c),{destroy:o}}var Ev=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=q($e),this.errorHandler=q(Nr,{optional:!0}),q(Hf,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Tv=class{constructor(){this.executingCallbacks=!1,this.buckets={[Ta.EarlyRead]:new Set,[Ta.Write]:new Set,[Ta.MixedReadWrite]:new Set,[Ta.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},lw=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=ee({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function bv(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=vR(i,a);else if(s==2){let c=a,u=e[++o];r=vR(r,c+": "+u+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var zf=class extends ap{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=$i(e);return new xa(t,this.ngModule)}};function QR(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function yq(n){let e=n.toLowerCase();return e==="svg"?zj:e==="math"?Gj:null}var Cv=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Jf(r);let i=this.injector.get(e,Qy,r);return i!==Qy||t===Qy?i:this.parentInjector.get(e,t,r)}},xa=class extends qf{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=QR(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return QR(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Ej(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Me(null);try{i=i||this.ngModule;let o=i instanceof yn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Cv(e,o):e,c=a.get(Zu,null);if(c===null)throw new Z(407,!1);let u=a.get(lq,null),d=a.get(lw,null),h=a.get(Hf,null),g={rendererFactory:c,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},_=c.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",C=r?TH(_,r,this.componentDef.encapsulation,a):Tx(_,w,yq(w)),A=512;this.componentDef.signals?A|=4096:this.componentDef.onPush||(A|=16);let O=null;C!==null&&(O=Zv(C,a,!0));let H=Ux(0,null,null,1,0,null,null,null,null,null,null),F=iw(null,H,null,A,null,null,g,_,a,null,O);qv(F);let z,ie;try{let W=this.componentDef,T,v=null;W.findHostDirectiveDefs?(T=[],v=new Map,W.findHostDirectiveDefs(W,T,v),T.push(W)):T=[W];let I=vq(F,C),b=wq(I,C,W,T,F,g,_);ie=FN(H,Ks),C&&Tq(_,W,C,r),t!==void 0&&bq(ie,this.ngContentSelectors,t),z=Eq(b,W,T,v,F,[Cq]),zx(H,F,null)}finally{zv()}return new Dv(this.componentType,z,Yv(ie,F),F,ie)}finally{Me(s)}}},Dv=class extends yv{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Na(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;qx(s[Ee],s,i,e,t),this.previousInputValues.set(e,t);let o=Js(this._tNode.index,s);aw(o)}}get injector(){return new Gs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function vq(n,e){let t=n[Ee],r=Ks;return n[r]=e,sw(t,r,2,"#host",null)}function wq(n,e,t,r,i,s,o){let a=i[Ee];Iq(r,n,e,o);let c=null;e!==null&&(c=Zv(e,i[Aa]));let u=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=iw(i,Vx(t),null,d,i[n.index],n,s,u,null,null,c);return a.firstCreatePass&&gv(a,n,r.length-1),ow(i,h),i[n.index]=h}function Iq(n,e,t,r){for(let i of n)e.mergedAttrs=Ov(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(bv(e,e.mergedAttrs,!0),t!==null&&xx(r,t,e))}function Eq(n,e,t,r,i,s){let o=dr(),a=i[Ee],c=lr(o,i);Bx(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,g=Xu(i,a,h,o);Ra(g,i)}jx(a,i,o),c&&Ra(c,i);let u=Xu(i,a,o.directiveStart+o.componentOffset,o);if(n[di]=i[di]=u,s!==null)for(let d of s)d(u,e);return Fx(a,o,i),u}function Tq(n,e,t,r){if(r)ev(n,t,["ng-version","17.3.11"]);else{let{attrs:i,classes:s}=Tj(e.selectors[0]);i&&ev(n,t,i),s&&s.length>0&&Nx(n,t,s.join(" "))}}function bq(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function Cq(){let n=dr();XN(on()[Ee],n)}var lp=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Dq;let n=e;return n})();function Dq(){let n=dr();return Aq(n,on())}var Sq=lp,Xx=class extends Sq{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Yv(this._hostTNode,this._hostLView)}get injector(){return new Gs(this._hostTNode,this._hostLView)}get parentInjector(){let e=Gv(this._hostTNode,this._hostLView);if(ex(e)){let t=Uf(e,this._hostLView),r=Vf(e),i=t[Ee].data[r+8];return new Gs(i,t)}else return new Gs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=YR(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Hn}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=qR(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,HR(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!Bj(e),a;if(o)a=t;else{let w=t||{};a=w.index,r=w.injector,i=w.projectableNodes,s=w.environmentInjector||w.ngModuleRef}let c=o?e:new xa($i(e)),u=r||this.parentInjector;if(!s&&c.ngModule==null){let C=(o?u:this.parentInjector).get(yn,null);C&&(s=C)}let d=$i(c.componentType??{}),h=qR(this._lContainer,d?.id??null),g=h?.firstChild??null,_=c.create(u,i,g,s);return this.insertImpl(_.hostView,a,HR(this._hostTNode,h)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(Qj(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Wt],u=new Xx(c,c[ur],c[Wt]);u.detach(u.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return QH(o,i,s,r),e.attachToViewContainerRef(),fN(Yy(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=YR(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=fv(this._lContainer,t);r&&(Mf(Yy(this._lContainer),t),Dx(r[Ee],r))}detach(e){let t=this._adjustIndex(e,-1),r=fv(this._lContainer,t);return r&&Mf(Yy(this._lContainer),t)!=null?new Na(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function YR(n){return n[Lf]}function Yy(n){return n[Lf]||(n[Lf]=[])}function Aq(n,e){let t,r=e[n.index];return gi(r)?t=r:(t=HH(r,e,null,n),e[n.index]=t,ow(e,t)),Nq(t,e,n,r),new Xx(t,n,e)}function Rq(n,e){let t=n[An],r=t.createComment(""),i=lr(e,n),s=nw(t,i);return jf(t,s,r,uH(t,i),!1),r}var Nq=xq;function xq(n,e,t,r){if(n[Qs])return;let i;t.type&8?i=hi(r):i=Rq(e,t),n[Qs]=i}function Pq(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(Lq))}return s}return Gf.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(u=>{i.template=u}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let u=i.styles.length,d=i.styleUrls;i.styleUrls.forEach((h,g)=>{a.push(""),o.push(r(h).then(_=>{a[u+g]=_,d.splice(d.indexOf(h),1),d.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(u=>{a.push(u),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>Fq(s));e.push(c)}),kq(),Promise.all(e).then(()=>{})}var Gf=new Map,Mq=new Set;function kq(){let n=Gf;return Gf=new Map,n}function Oq(){return Gf.size===0}function Lq(n){return typeof n=="string"?n:n.text()}function Fq(n){Mq.delete(n)}function dw(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var Hi=class{},el=class{};var Wf=class extends Hi{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new zf(this);let i=EN(e);this._bootstrapComponents=Ex(i.bootstrap),this._r3Injector=lx(e,t,[{provide:Hi,useValue:this},{provide:ap,useValue:this.componentFactoryResolver},...r],Sn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Kf=class extends el{constructor(e){super(),this.moduleType=e}create(e){return new Wf(this.moduleType,e,[])}};function Vq(n,e,t){return new Wf(n,e,t)}var Sv=class extends Hi{constructor(e){super(),this.componentFactoryResolver=new zf(this),this.instance=null;let t=new Gu([...e.providers,{provide:Hi,useValue:this},{provide:ap,useValue:this.componentFactoryResolver}],e.parent||Vv(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function dp(n,e,t=null){return new Sv({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var hp=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Vt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Uq(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function Bq(n){return(n.flags&32)===32}function hw(n,e,t,r){let i=on(),s=a$();if(Uq(i,s,e)){let o=sl(),a=f$();UH(a,i,n,e,t,r)}return hw}function JR(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";qx(n,t,s[o],o,r)}function jq(n,e,t,r,i,s){let o=e.consts,a=xR(o,i),c=sw(e,n,2,r,a);return AH(e,t,c,xR(o,s)),c.attrs!==null&&bv(c,c.attrs,!1),c.mergedAttrs!==null&&bv(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function J(n,e,t,r){let i=on(),s=sl(),o=Ks+n,a=i[An],c=s.firstCreatePass?jq(o,s,i,e,t,r):s.data[o],u=$q(s,i,c,a,e,n);i[o]=u;let d=PN(c);return np(c,!0),xx(a,u,c),!Bq(c)&&YN()&&Ax(s,i,u,c),Xj()===0&&Ra(u,i),Zj(),d&&(wH(s,i,c),Fx(s,c,i)),r!==null&&IH(i,c),J}function Q(){let n=dr();$N()?s$():(n=n.parent,np(n,!1));let e=n;n$(e)&&r$(),e$();let t=sl();return t.firstCreatePass&&(XN(t,n),xN(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&y$(e)&&JR(t,e,on(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&v$(e)&&JR(t,e,on(),e.stylesWithoutHost,!1),Q}function De(n,e,t,r){return J(n,e,t,r),Q(),De}var $q=(n,e,t,r,i,s)=>(JN(!0),Tx(r,i,p$()));var Qf="en-US";var Hq=Qf;function qq(n){typeof n=="string"&&(Hq=n.toLowerCase().replace(/_/g,"-"))}function Kt(n,e,t,r){let i=on(),s=sl(),o=dr();return Gq(s,i,i[An],o,n,e,r),Kt}function zq(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Wu],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function Gq(n,e,t,r,i,s,o){let a=PN(r),u=n.firstCreatePass&&zH(n),d=e[di],h=qH(e),g=!0;if(r.type&3||o){let C=lr(r,e),A=o?o(C):C,O=h.length,H=o?z=>o(hi(z[r.index])):r.index,F=null;if(!o&&a&&(F=zq(n,e,i,r.index)),F!==null){let z=F.__ngLastListenerFn__||F;z.__ngNextListenerFn__=s,F.__ngLastListenerFn__=s,g=!1}else{s=ZR(r,e,d,s,!1);let z=t.listen(A,i,s);h.push(s,z),u&&u.push(i,H,O,O+1)}}else s=ZR(r,e,d,s,!1);let _=r.outputs,w;if(g&&_!==null&&(w=_[i])){let C=w.length;if(C)for(let A=0;A<C;A+=2){let O=w[A],H=w[A+1],ie=e[O][H].subscribe(s),W=h.length;h.push(s,ie),u&&u.push(i,r.index,W,-(W+1))}}}function XR(n,e,t,r){let i=Me(null);try{return Dr(6,e,t),t(r)!==!1}catch(s){return Hx(n,s),!1}finally{Dr(7,e,t),Me(i)}}function ZR(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?Js(n.index,e):e;aw(a);let c=XR(e,t,r,o),u=s.__ngNextListenerFn__;for(;u;)c=XR(e,t,u,o)&&c,u=u.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function re(n,e=""){let t=on(),r=sl(),i=n+Ks,s=r.firstCreatePass?sw(r,i,1,e,null):r.data[i],o=Wq(r,t,s,e,n);t[i]=o,YN()&&Ax(r,t,o,s),np(s,!1)}var Wq=(n,e,t,r,i)=>(JN(!0),X$(e[An],r));var Kq=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=CN(!1,r.type),s=i.length>0?dp([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=ee({token:e,providedIn:"environment",factory:()=>new e(te(yn))});let n=e;return n})();function Zx(n){cw("NgStandalone"),n.getStandaloneInjector=e=>e.get(Kq).getOrCreateStandaloneInjector(n)}var Cf=null;function Qq(n){Cf!==null&&(n.defaultEncapsulation!==Cf.defaultEncapsulation||n.preserveWhitespaces!==Cf.preserveWhitespaces)||(Cf=n)}var fp=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var fw=new ce(""),al=new ce(""),pp=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,pw||(Yq(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{$e.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(te($e),te(gp),te(al))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let n=e;return n})(),gp=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return pw?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function Yq(n){pw=n}var pw;function cl(n){return!!n&&typeof n.then=="function"}function eP(n){return!!n&&typeof n.subscribe=="function"}var mp=new ce(""),tP=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=q(mp,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(cl(o))r.push(o);else if(eP(o)){let a=new Promise((c,u)=>{o.subscribe({complete:c,error:u})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),gw=new ce("");function Jq(){qA(()=>{throw new Z(600,!1)})}function Xq(n){return n.isBoundToModule}function Zq(n,e,t){try{let r=t();return cl(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function nP(n,e){return Array.isArray(e)?e.reduce(nP,n):K(K({},n),e)}var Pa=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=q(dx),this.afterRenderEffectManager=q(lw),this.externalTestViews=new Set,this.beforeRender=new Gt,this.afterTick=new Gt,this.componentTypes=[],this.components=[],this.isStable=q(hp).hasPendingTasks.pipe(Ie(r=>!r)),this._injector=q(yn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof qf;if(!this._injector.get(tP).done){let _=!s&&IN(r),w=!1;throw new Z(405,w)}let a;s?a=r:a=this._injector.get(ap).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=Xq(a)?void 0:this._injector.get(Hi),u=i||a.selector,d=a.create(xr.NULL,[],u,c),h=d.location.nativeElement,g=d.injector.get(fw,null);return g?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),Nf(this.components,d),g?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new Z(101,!1);let i=Me(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Me(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===Wx)throw new Z(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)ez(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Av(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Av(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Nf(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(gw,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Nf(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new Z(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Nf(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function ez(n,e,t){!e&&!Av(n)||tz(n,t,e)}function Av(n){return Hv(n)}function tz(n,e,t){let r;t?(r=0,n[ae]|=1024):n[ae]&64?r=0:r=1,Kx(n,e,r)}var Rv=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},_p=(()=>{let e=class e{compileModuleSync(r){return new Kf(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=EN(r),o=Ex(s.declarations).reduce((a,c)=>{let u=$i(c);return u&&a.push(new xa(u)),a},[]);return new Rv(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),nz=new ce("");function rz(n,e,t){let r=new Kf(t);return Promise.resolve(r)}function eN(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var iz=(()=>{let e=class e{constructor(){this.zone=q($e),this.applicationRef=q(Pa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function sz(n){return[{provide:$e,useFactory:n},{provide:Sa,multi:!0,useFactory:()=>{let e=q(iz,{optional:!0});return()=>e.initialize()}},{provide:Sa,multi:!0,useFactory:()=>{let e=q(cz);return()=>{e.initialize()}}},{provide:dx,useFactory:oz}]}function oz(){let n=q($e),e=q(Nr);return t=>n.runOutsideAngular(()=>e.handleError(t))}function az(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var cz=(()=>{let e=class e{constructor(){this.subscription=new bt,this.initialized=!1,this.zone=q($e),this.pendingTasks=q(hp)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{$e.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{$e.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function uz(){return typeof $localize<"u"&&$localize.locale||Qf}var mw=new ce("",{providedIn:"root",factory:()=>q(mw,me.Optional|me.SkipSelf)||uz()});var rP=new ce(""),iP=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=mq(i?.ngZone,az({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=Vq(r.moduleType,this.injector,sz(()=>s)),a=o.injector.get(Nr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:u=>{a.handleError(u)}});o.onDestroy(()=>{Nf(this._modules,o),c.unsubscribe()})}),Zq(a,s,()=>{let c=o.injector.get(tP);return c.runInitializers(),c.donePromise.then(()=>{let u=o.injector.get(mw,Qf);return qq(u||Qf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=nP({},i);return rz(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(Pa);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new Z(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Z(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(rP,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(te(xr))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),Hu=null,sP=new ce("");function lz(n){if(Hu&&!Hu.get(sP,!1))throw new Z(400,!1);Jq(),Hu=n;let e=n.get(iP);return fz(n),e}function _w(n,e,t=[]){let r=`Platform: ${e}`,i=new ce(r);return(s=[])=>{let o=oP();if(!o||o.injector.get(sP,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):lz(dz(a,r))}return hz(i)}}function dz(n=[],e){return xr.create({name:e,providers:[{provide:Zf,useValue:"platform"},{provide:rP,useValue:new Set([()=>Hu=null])},...n]})}function hz(n){let e=oP();if(!e)throw new Z(401,!1);return e}function oP(){return Hu?.get(iP)??null}function fz(n){n.get(Jv,null)?.forEach(t=>t())}var ul=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=pz;let n=e;return n})();function pz(n){return gz(dr(),on(),(n&16)===16)}function gz(n,e,t){if(jv(n)&&!t){let r=Js(n.index,e);return new Na(r,r)}else if(n.type&47){let r=e[Rr];return new Na(r,e)}return null}var aP=_w(null,"core",[]),cP=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(te(Pa))},e.\u0275mod=cr({type:e}),e.\u0275inj=ar({});let n=e;return n})();function ll(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function uP(n){let e=$i(n);if(!e)return null;let t=new xa(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var fP=null;function Zs(){return fP}function pP(n){fP??=n}var yp=class{};var wn=new ce(""),ww=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>q(mz),providedIn:"platform"});let n=e;return n})(),gP=new ce(""),mz=(()=>{let e=class e extends ww{constructor(){super(),this._doc=q(wn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Zs().getBaseHref(this._doc)}onPopState(r){let i=Zs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=Zs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function Iw(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function lP(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function mi(n){return n&&n[0]!=="?"?"?"+n:n}var hr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>q(Ew),providedIn:"root"});let n=e;return n})(),mP=new ce(""),Ew=(()=>{let e=class e extends hr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??q(wn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Iw(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+mi(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+mi(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+mi(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(te(ww),te(mP,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),wp=(()=>{let e=class e extends hr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=Iw(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+mi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+mi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(te(ww),te(mP,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let n=e;return n})(),Ma=(()=>{let e=class e{constructor(r){this._subject=new rn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=vz(lP(dP(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+mi(i))}normalize(r){return e.stripTrailingSlash(yz(this._basePath,dP(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+mi(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+mi(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=mi,e.joinWithSlash=Iw,e.stripTrailingSlash=lP,e.\u0275fac=function(i){return new(i||e)(te(hr))},e.\u0275prov=ee({token:e,factory:()=>_z(),providedIn:"root"});let n=e;return n})();function _z(){return new Ma(te(hr))}function yz(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function dP(n){return n.replace(/\/index.html$/,"")}function vz(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function _P(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var yP=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=cr({type:e}),e.\u0275inj=ar({});let n=e;return n})(),Tw="browser",wz="server";function Iz(n){return n===Tw}function bw(n){return n===wz}var vP=(()=>{let e=class e{};e.\u0275prov=ee({token:e,providedIn:"root",factory:()=>Iz(q(qi))?new yw(q(wn),window):new vw});let n=e;return n})(),yw=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=Ez(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function Ez(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var vw=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},vp=class{};var Sw=class extends yp{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Aw=class n extends Sw{static makeCurrent(){pP(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Cz();return t==null?null:Dz(t)}resetBaseElement(){dl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return _P(document.cookie,e)}},dl=null;function Cz(){return dl=dl||document.querySelector("base"),dl?dl.getAttribute("href"):null}function Dz(n){return new URL(n,document.baseURI).pathname}var Rw=class{addToWindow(e){sn.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new Z(5103,!1);return s},sn.getAllAngularTestabilities=()=>e.getAllTestabilities(),sn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=sn.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};sn.frameworkStabilizers||(sn.frameworkStabilizers=[]),sn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?Zs().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},Sz=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let n=e;return n})(),Nw=new ce(""),TP=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new Z(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(te(Nw),te($e))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let n=e;return n})(),Ip=class{constructor(e){this._doc=e}},Cw="ng-app-id",bP=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=bw(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Cw}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Cw),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Cw,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(te(wn),te(rp),te(Xv,8),te(qi))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let n=e;return n})(),Dw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Pw=/%COMP%/g,CP="%COMP%",Az=`_nghost-${CP}`,Rz=`_ngcontent-${CP}`,Nz=!0,xz=new ce("",{providedIn:"root",factory:()=>Nz});function Pz(n){return Rz.replace(Pw,n)}function Mz(n){return Az.replace(Pw,n)}function DP(n,e){return e.map(t=>t.replace(Pw,n))}var wP=(()=>{let e=class e{constructor(r,i,s,o,a,c,u,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=u,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=bw(c),this.defaultRenderer=new hl(r,a,u,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Ar.ShadowDom&&(i=nt(K({},i),{encapsulation:Ar.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Ep?s.applyToHost(r):s instanceof fl&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,u=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(i.encapsulation){case Ar.Emulated:o=new Ep(u,d,i,this.appId,h,a,c,g);break;case Ar.ShadowDom:return new xw(u,d,r,i,a,c,this.nonce,g);default:o=new fl(u,d,i,h,a,c,g);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(te(TP),te(bP),te(rp),te(xz),te(wn),te(qi),te($e),te(Xv))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let n=e;return n})(),hl=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Dw[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(IP(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(IP(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Z(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Dw[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Dw[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Xs.DashCase|Xs.Important)?e.style.setProperty(t,r,i&Xs.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Xs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=Zs().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function IP(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var xw=class extends hl{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=DP(i.id,i.styles);for(let d of u){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},fl=class extends hl{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?DP(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Ep=class extends fl{constructor(e,t,r,i,s,o,a,c){let u=i+"-"+r.id;super(e,t,r,s,o,a,c,u),this.contentAttr=Pz(u),this.hostAttr=Mz(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},kz=(()=>{let e=class e extends Ip{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(te(wn))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let n=e;return n})(),EP=["alt","control","meta","shift"],Oz={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Lz={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Fz=(()=>{let e=class e extends Ip{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Zs().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),EP.forEach(d=>{let h=i.indexOf(d);h>-1&&(i.splice(h,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let u={};return u.domEventName=s,u.fullKey=a,u}static matchEventFullKeyCode(r,i){let s=Oz[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),EP.forEach(a=>{if(a!==s){let c=Lz[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(te(wn))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let n=e;return n})();function Vz(){Aw.makeCurrent()}function Uz(){return new Nr}function Bz(){return _x(document),document}var jz=[{provide:qi,useValue:Tw},{provide:Jv,useValue:Vz,multi:!0},{provide:wn,useFactory:Bz,deps:[]}],SP=_w(aP,"browser",jz),$z=new ce(""),Hz=[{provide:al,useClass:Rw,deps:[]},{provide:fw,useClass:pp,deps:[$e,gp,al]},{provide:pp,useClass:pp,deps:[$e,gp,al]}],qz=[{provide:Zf,useValue:"root"},{provide:Nr,useFactory:Uz,deps:[]},{provide:Nw,useClass:kz,multi:!0,deps:[wn,$e,qi]},{provide:Nw,useClass:Fz,multi:!0,deps:[wn]},wP,bP,TP,{provide:Zu,useExisting:wP},{provide:vp,useClass:Sz,deps:[]},[]],AP=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:rp,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(te($z,12))},e.\u0275mod=cr({type:e}),e.\u0275inj=ar({providers:[...qz,...Hz],imports:[yP,cP]});let n=e;return n})();var RP=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(te(wn))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var he="primary",Al=Symbol("RouteTitle"),Fw=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Va(n){return new Fw(n)}function zz(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Gz(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Pr(n[t],e[t]))return!1;return!0}function Pr(n,e){let t=n?Vw(n):void 0,r=e?Vw(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!UP(n[i],e[i]))return!1;return!0}function Vw(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function UP(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function BP(n){return n.length>0?n[n.length-1]:null}function Ki(n){return Ly(n)?n:cl(n)?ct(Promise.resolve(n)):se(n)}var Wz={exact:$P,subset:HP},jP={exact:Kz,subset:Qz,ignored:()=>!0};function xP(n,e,t){return Wz[t.paths](n.root,e.root,t.matrixParams)&&jP[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Kz(n,e){return Pr(n,e)}function $P(n,e,t){if(!to(n.segments,e.segments)||!Cp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!$P(n.children[r],e.children[r],t))return!1;return!0}function Qz(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>UP(n[t],e[t]))}function HP(n,e,t){return qP(n,e,e.segments,t)}function qP(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!to(i,t)||e.hasChildren()||!Cp(i,t,r))}else if(n.segments.length===t.length){if(!to(n.segments,t)||!Cp(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!HP(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!to(n.segments,i)||!Cp(n.segments,i,r)||!n.children[he]?!1:qP(n.children[he],e,s,r)}}function Cp(n,e,t){return e.every((r,i)=>jP[t](n[i].parameters,r.parameters))}var zi=class{constructor(e=new Pe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Va(this.queryParams),this._queryParamMap}toString(){return Xz.serialize(this)}},Pe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Dp(this)}},eo=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Va(this.parameters),this._parameterMap}toString(){return GP(this)}};function Yz(n,e){return to(n,e)&&n.every((t,r)=>Pr(t.parameters,e[r].parameters))}function to(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function Jz(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===he&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==he&&(t=t.concat(e(i,r)))}),t}var Rl=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>new wl,providedIn:"root"});let n=e;return n})(),wl=class{parse(e){let t=new Bw(e);return new zi(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${pl(e.root,!0)}`,r=t4(e.queryParams),i=typeof e.fragment=="string"?`#${Zz(e.fragment)}`:"";return`${t}${r}${i}`}},Xz=new wl;function Dp(n){return n.segments.map(e=>GP(e)).join("/")}function pl(n,e){if(!n.hasChildren())return Dp(n);if(e){let t=n.children[he]?pl(n.children[he],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==he&&r.push(`${i}:${pl(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=Jz(n,(r,i)=>i===he?[pl(n.children[he],!1)]:[`${i}:${pl(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[he]!=null?`${Dp(n)}/${t[0]}`:`${Dp(n)}/(${t.join("//")})`}}function zP(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Tp(n){return zP(n).replace(/%3B/gi,";")}function Zz(n){return encodeURI(n)}function Uw(n){return zP(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Sp(n){return decodeURIComponent(n)}function PP(n){return Sp(n.replace(/\+/g,"%20"))}function GP(n){return`${Uw(n.path)}${e4(n.parameters)}`}function e4(n){return Object.entries(n).map(([e,t])=>`;${Uw(e)}=${Uw(t)}`).join("")}function t4(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Tp(t)}=${Tp(i)}`).join("&"):`${Tp(t)}=${Tp(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var n4=/^[^\/()?;#]+/;function Mw(n){let e=n.match(n4);return e?e[0]:""}var r4=/^[^\/()?;=#]+/;function i4(n){let e=n.match(r4);return e?e[0]:""}var s4=/^[^=?&#]+/;function o4(n){let e=n.match(s4);return e?e[0]:""}var a4=/^[^&#]+/;function c4(n){let e=n.match(a4);return e?e[0]:""}var Bw=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Pe([],{}):new Pe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[he]=new Pe(e,t)),r}parseSegment(){let e=Mw(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Z(4009,!1);return this.capture(e),new eo(Sp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=i4(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Mw(this.remaining);i&&(r=i,this.capture(r))}e[Sp(t)]=Sp(r)}parseQueryParam(e){let t=o4(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=c4(this.remaining);o&&(r=o,this.capture(r))}let i=PP(t),s=PP(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Mw(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Z(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=he);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[he]:new Pe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Z(4011,!1)}};function WP(n){return n.segments.length>0?new Pe([],{[he]:n}):n}function KP(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=KP(i);if(r===he&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Pe(n.segments,e);return u4(t)}function u4(n){if(n.numberOfChildren===1&&n.children[he]){let e=n.children[he];return new Pe(n.segments.concat(e.segments),e.children)}return n}function Ua(n){return n instanceof zi}function l4(n,e,t=null,r=null){let i=QP(n);return YP(i,e,t,r)}function QP(n){let e;function t(s){let o={};for(let c of s.children){let u=t(c);o[c.outlet]=u}let a=new Pe(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=WP(r);return e??i}function YP(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return kw(i,i,i,t,r);let s=d4(e);if(s.toRoot())return kw(i,i,new Pe([],{}),t,r);let o=h4(s,i,n),a=o.processChildren?_l(o.segmentGroup,o.index,s.commands):XP(o.segmentGroup,o.index,s.commands);return kw(i,o.segmentGroup,a,t,r)}function Ap(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Il(n){return typeof n=="object"&&n!=null&&n.outlets}function kw(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(d=>`${d}`):`${u}`});let o;n===e?o=t:o=JP(n,e,t);let a=WP(KP(o));return new zi(a,s,i)}function JP(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=JP(s,e,t)}),new Pe(n.segments,r)}var Rp=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Ap(r[0]))throw new Z(4003,!1);let i=r.find(Il);if(i&&i!==BP(r))throw new Z(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function d4(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Rp(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Rp(t,e,r)}var La=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function h4(n,e,t){if(n.isAbsolute)return new La(e,!0,0);if(!t)return new La(e,!1,NaN);if(t.parent===null)return new La(t,!0,0);let r=Ap(n.commands[0])?0:1,i=t.segments.length-1+r;return f4(t,i,n.numberOfDoubleDots)}function f4(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new Z(4005,!1);i=r.segments.length}return new La(r,!1,i-s)}function p4(n){return Il(n[0])?n[0].outlets:{[he]:n}}function XP(n,e,t){if(n??=new Pe([],{}),n.segments.length===0&&n.hasChildren())return _l(n,e,t);let r=g4(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Pe(n.segments.slice(0,r.pathIndex),{});return s.children[he]=new Pe(n.segments.slice(r.pathIndex),n.children),_l(s,0,i)}else return r.match&&i.length===0?new Pe(n.segments,{}):r.match&&!n.hasChildren()?jw(n,e,t):r.match?_l(n,0,i):jw(n,e,t)}function _l(n,e,t){if(t.length===0)return new Pe(n.segments,{});{let r=p4(t),i={};if(Object.keys(r).some(s=>s!==he)&&n.children[he]&&n.numberOfChildren===1&&n.children[he].segments.length===0){let s=_l(n.children[he],e,t);return new Pe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=XP(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Pe(n.segments,i)}}function g4(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(Il(a))break;let c=`${a}`,u=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!kP(c,u,o))return s;r+=2}else{if(!kP(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function jw(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Il(s)){let c=m4(s.outlets);return new Pe(r,c)}if(i===0&&Ap(t[0])){let c=n.segments[e];r.push(new eo(c.path,MP(t[0]))),i++;continue}let o=Il(s)?s.outlets[he]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Ap(a)?(r.push(new eo(o,MP(a))),i+=2):(r.push(new eo(o,{})),i++)}return new Pe(r,{})}function m4(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=jw(new Pe([],{}),0,r))}),e}function MP(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function kP(n,e,t){return n==t.path&&Pr(e,t.parameters)}var yl="imperative",xt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(xt||{}),qn=class{constructor(e,t){this.id=e,this.url=t}},Ba=class extends qn{constructor(e,t,r="imperative",i=null){super(e,t),this.type=xt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Mr=class extends qn{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=xt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Nn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Nn||{}),Np=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Np||{}),Gi=class extends qn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=xt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Wi=class extends qn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=xt.NavigationSkipped}},El=class extends qn{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=xt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},xp=class extends qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=xt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},$w=class extends qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=xt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Hw=class extends qn{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=xt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},qw=class extends qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=xt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},zw=class extends qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=xt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Gw=class{constructor(e){this.route=e,this.type=xt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ww=class{constructor(e){this.route=e,this.type=xt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Kw=class{constructor(e){this.snapshot=e,this.type=xt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Qw=class{constructor(e){this.snapshot=e,this.type=xt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Yw=class{constructor(e){this.snapshot=e,this.type=xt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Jw=class{constructor(e){this.snapshot=e,this.type=xt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pp=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=xt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Tl=class{},bl=class{constructor(e){this.url=e}};var Xw=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Nl,this.attachRef=null}},Nl=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new Xw,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Mp=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Zw(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Zw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=eI(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return eI(e,this._root).map(t=>t.value)}};function Zw(n,e){if(n===e.value)return e;for(let t of e.children){let r=Zw(n,t);if(r)return r}return null}function eI(n,e){if(n===e.value)return[e];for(let t of e.children){let r=eI(n,t);if(r.length)return r.unshift(e),r}return[]}var Rn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Oa(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var kp=class extends Mp{constructor(e,t){super(e),this.snapshot=t,lI(this,e)}toString(){return this.snapshot.toString()}};function ZP(n){let e=_4(n),t=new Vt([new eo("",{})]),r=new Vt({}),i=new Vt({}),s=new Vt({}),o=new Vt(""),a=new no(t,r,s,o,i,he,n,e.root);return a.snapshot=e.root,new kp(new Rn(a,[]),e)}function _4(n){let e={},t={},r={},i="",s=new Cl([],e,r,i,t,he,n,null,{});return new Op("",new Rn(s,[]))}var no=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Ie(u=>u[Al]))??se(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Ie(e=>Va(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Ie(e=>Va(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function uI(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:K(K({},e.params),n.params),data:K(K({},e.data),n.data),resolve:K(K(K(K({},n.data),e.data),i?.data),n._resolvedData)}:r={params:K({},n.params),data:K({},n.data),resolve:K(K({},n.data),n._resolvedData??{})},i&&tM(i)&&(r.resolve[Al]=i.title),r}var Cl=class{get title(){return this.data?.[Al]}constructor(e,t,r,i,s,o,a,c,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Va(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Va(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Op=class extends Mp{constructor(e,t){super(t),this.url=e,lI(this,t)}toString(){return eM(this._root)}};function lI(n,e){e.value._routerState=n,e.children.forEach(t=>lI(n,t))}function eM(n){let e=n.children.length>0?` { ${n.children.map(eM).join(", ")} } `:"";return`${n.value}${e}`}function Ow(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Pr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Pr(e.params,t.params)||n.paramsSubject.next(t.params),Gz(e.url,t.url)||n.urlSubject.next(t.url),Pr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function tI(n,e){let t=Pr(n.params,e.params)&&Yz(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||tI(n.parent,e.parent))}function tM(n){return typeof n.title=="string"||n.title===null}var dI=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=he,this.activateEvents=new rn,this.deactivateEvents=new rn,this.attachEvents=new rn,this.detachEvents=new rn,this.parentContexts=q(Nl),this.location=q(lp),this.changeDetector=q(ul),this.environmentInjector=q(yn),this.inputBinder=q(Bp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Z(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Z(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Z(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new Z(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new nI(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:u,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Xf({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[il]});let n=e;return n})(),nI=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===no?this.route:e===Nl?this.childContexts:this.parent.get(e,t)}},Bp=new ce(""),OP=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Bu([i.queryParams,i.params,i.data]).pipe(Bn(([o,a,c],u)=>(c=K(K(K({},o),a),c),u===0?se(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=uP(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let n=e;return n})();function y4(n,e,t){let r=Dl(n,e._root,t?t._root:void 0);return new kp(r,e)}function Dl(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=v4(n,e,t);return new Rn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Dl(n,a)),o}}let r=w4(e.value),i=e.children.map(s=>Dl(n,s));return new Rn(r,i)}}function v4(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Dl(n,r,i);return Dl(n,r)})}function w4(n){return new no(new Vt(n.url),new Vt(n.params),new Vt(n.queryParams),new Vt(n.fragment),new Vt(n.data),n.outlet,n.component,n)}var nM="ngNavigationCancelingError";function rM(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Ua(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=iM(!1,Nn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function iM(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[nM]=!0,t.cancellationCode=e,t}function I4(n){return sM(n)&&Ua(n.url)}function sM(n){return!!n&&n[nM]}var E4=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rt({type:e,selectors:[["ng-component"]],standalone:!0,features:[Zx],decls:1,vars:0,template:function(i,s){i&1&&De(0,"router-outlet")},dependencies:[dI],encapsulation:2});let n=e;return n})();function T4(n,e){return n.providers&&!n._injector&&(n._injector=dp(n.providers,e,`Route: ${n.path}`)),n._injector??e}function hI(n){let e=n.children&&n.children.map(hI),t=e?nt(K({},n),{children:e}):K({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==he&&(t.component=E4),t}function kr(n){return n.outlet||he}function b4(n,e){let t=n.filter(r=>kr(r)===e);return t.push(...n.filter(r=>kr(r)!==e)),t}function xl(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var C4=(n,e,t,r)=>Ie(i=>(new rI(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),rI=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Ow(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Oa(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Oa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Oa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Oa(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Jw(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Qw(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Ow(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Ow(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=xl(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Lp=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Fa=class{constructor(e,t){this.component=e,this.route=t}};function D4(n,e,t){let r=n._root,i=e?e._root:null;return gl(r,i,t,[r.value])}function S4(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function $a(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!sN(n)?n:e.get(n):r}function gl(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Oa(e);return n.children.forEach(o=>{A4(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>vl(a,t.getContext(o),i)),i}function A4(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=R4(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Lp(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?gl(n,e,a?a.children:null,r,i):gl(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Fa(a.outlet.component,o))}else o&&vl(e,a,i),i.canActivateChecks.push(new Lp(r)),s.component?gl(n,null,a?a.children:null,r,i):gl(n,null,t,r,i);return i}function R4(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!to(n.url,e.url);case"pathParamsOrQueryParamsChange":return!to(n.url,e.url)||!Pr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!tI(n,e)||!Pr(n.queryParams,e.queryParams);case"paramsChange":default:return!tI(n,e)}}function vl(n,e,t){let r=Oa(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?vl(o,e.children.getContext(s),t):vl(o,null,t):vl(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Fa(e.outlet.component,i)):t.canDeactivateChecks.push(new Fa(null,i)):t.canDeactivateChecks.push(new Fa(null,i))}function Pl(n){return typeof n=="function"}function N4(n){return typeof n=="boolean"}function x4(n){return n&&Pl(n.canLoad)}function P4(n){return n&&Pl(n.canActivate)}function M4(n){return n&&Pl(n.canActivateChild)}function k4(n){return n&&Pl(n.canDeactivate)}function O4(n){return n&&Pl(n.canMatch)}function oM(n){return n instanceof ui||n?.name==="EmptyError"}var bp=Symbol("INITIAL_VALUE");function ja(){return Bn(n=>Bu(n.map(e=>e.pipe(li(1),By(bp)))).pipe(Ie(e=>{for(let t of e)if(t!==!0){if(t===bp)return bp;if(t===!1||t instanceof zi)return t}return!0}),Un(e=>e!==bp),li(1)))}function L4(n,e){return pt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?se(nt(K({},t),{guardsResult:!0})):F4(o,r,i,n).pipe(pt(a=>a&&N4(a)?V4(r,s,n,e):se(a)),Ie(a=>nt(K({},t),{guardsResult:a})))})}function F4(n,e,t,r){return ct(n).pipe(pt(i=>H4(i.component,i.route,t,e,r)),br(i=>i!==!0,!0))}function V4(n,e,t,r){return ct(e).pipe(qs(i=>ya(B4(i.route.parent,r),U4(i.route,r),$4(n,i.path,t),j4(n,i.route,t))),br(i=>i!==!0,!0))}function U4(n,e){return n!==null&&e&&e(new Yw(n)),se(!0)}function B4(n,e){return n!==null&&e&&e(new Kw(n)),se(!0)}function j4(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return se(!0);let i=r.map(s=>If(()=>{let o=xl(e)??t,a=$a(s,o),c=P4(a)?a.canActivate(e,n):fi(o,()=>a(e,n));return Ki(c).pipe(br())}));return se(i).pipe(ja())}function $4(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>S4(o)).filter(o=>o!==null).map(o=>If(()=>{let a=o.guards.map(c=>{let u=xl(o.node)??t,d=$a(c,u),h=M4(d)?d.canActivateChild(r,n):fi(u,()=>d(r,n));return Ki(h).pipe(br())});return se(a).pipe(ja())}));return se(s).pipe(ja())}function H4(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return se(!0);let o=s.map(a=>{let c=xl(e)??i,u=$a(a,c),d=k4(u)?u.canDeactivate(n,e,t,r):fi(c,()=>u(n,e,t,r));return Ki(d).pipe(br())});return se(o).pipe(ja())}function q4(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return se(!0);let s=i.map(o=>{let a=$a(o,n),c=x4(a)?a.canLoad(e,t):fi(n,()=>a(e,t));return Ki(c)});return se(s).pipe(ja(),aM(r))}function aM(n){return Py(Ut(e=>{if(Ua(e))throw rM(n,e)}),Ie(e=>e===!0))}function z4(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return se(!0);let s=i.map(o=>{let a=$a(o,n),c=O4(a)?a.canMatch(e,t):fi(n,()=>a(e,t));return Ki(c)});return se(s).pipe(ja(),aM(r))}var Sl=class{constructor(e){this.segmentGroup=e||null}},Fp=class extends Error{constructor(e){super(),this.urlTree=e}};function ka(n){return ma(new Sl(n))}function G4(n){return ma(new Z(4e3,!1))}function W4(n){return ma(iM(!1,Nn.GuardRejected))}var iI=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return se(r);if(i.numberOfChildren>1||!i.children[he])return G4(e.redirectTo);i=i.children[he]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new Fp(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new zi(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Pe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new Z(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},sI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function K4(n,e,t,r,i){let s=fI(n,e,t);return s.matched?(r=T4(e,r),z4(r,e,t,i).pipe(Ie(o=>o===!0?s:K({},sI)))):se(s)}function fI(n,e,t){if(e.path==="**")return Q4(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?K({},sI):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||zz)(t,n,e);if(!i)return K({},sI);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?K(K({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function Q4(n){return{matched:!0,parameters:n.length>0?BP(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function LP(n,e,t,r){return t.length>0&&X4(n,t,r)?{segmentGroup:new Pe(e,J4(r,new Pe(t,n.children))),slicedSegments:[]}:t.length===0&&Z4(n,t,r)?{segmentGroup:new Pe(n.segments,Y4(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Pe(n.segments,n.children),slicedSegments:t}}function Y4(n,e,t,r){let i={};for(let s of t)if(jp(n,e,s)&&!r[kr(s)]){let o=new Pe([],{});i[kr(s)]=o}return K(K({},r),i)}function J4(n,e){let t={};t[he]=e;for(let r of n)if(r.path===""&&kr(r)!==he){let i=new Pe([],{});t[kr(r)]=i}return t}function X4(n,e,t){return t.some(r=>jp(n,e,r)&&kr(r)!==he)}function Z4(n,e,t){return t.some(r=>jp(n,e,r))}function jp(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function eG(n,e,t,r){return kr(n)!==r&&(r===he||!jp(e,t,n))?!1:fI(e,n,t).matched}function tG(n,e,t){return e.length===0&&!n.children[t]}var oI=class{};function nG(n,e,t,r,i,s,o="emptyOnly"){return new aI(n,e,t,r,i,o,s).recognize()}var rG=31,aI=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new iI(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Z(4002,`'${e.segmentGroup}'`)}recognize(){let e=LP(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Ie(t=>{let r=new Cl([],Object.freeze({}),Object.freeze(K({},this.urlTree.queryParams)),this.urlTree.fragment,{},he,this.rootComponentType,null,{}),i=new Rn(r,t),s=new Op("",i),o=l4(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,he).pipe(Vi(r=>{if(r instanceof Fp)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Sl?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=uI(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Ie(s=>s instanceof Rn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ct(i).pipe(qs(s=>{let o=r.children[s],a=b4(t,s);return this.processSegmentGroup(e,a,o,s)}),Uy((s,o)=>(s.push(...o),s)),Ui(null),Vy(),pt(s=>{if(s===null)return ka(r);let o=cM(s);return iG(o),se(o)}))}processSegment(e,t,r,i,s,o){return ct(t).pipe(qs(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(Vi(c=>{if(c instanceof Sl)return se(null);throw c}))),br(a=>!!a),Vi(a=>{if(oM(a))return tG(r,i,s)?se(new oI):ka(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return eG(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):ka(i):ka(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:u,remainingSegments:d}=fI(t,i,s);if(!a)return ka(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>rG&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,u);return this.applyRedirects.lineralizeSegments(i,h).pipe(pt(g=>this.processSegment(e,r,t,g.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=K4(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(Bn(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Bn(({routes:c})=>{let u=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:g}=a,_=new Cl(d,g,Object.freeze(K({},this.urlTree.queryParams)),this.urlTree.fragment,oG(r),kr(r),r.component??r._loadedComponent??null,r,aG(r)),{segmentGroup:w,slicedSegments:C}=LP(t,d,h,c);if(C.length===0&&w.hasChildren())return this.processChildren(u,c,w).pipe(Ie(O=>O===null?null:new Rn(_,O)));if(c.length===0&&C.length===0)return se(new Rn(_,[]));let A=kr(r)===s;return this.processSegment(u,c,w,C,A?he:s,!0).pipe(Ie(O=>new Rn(_,O instanceof Rn?[O]:[])))}))):ka(t)))}getChildConfig(e,t,r){return t.children?se({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?se({routes:t._loadedRoutes,injector:t._loadedInjector}):q4(e,t,r,this.urlSerializer).pipe(pt(i=>i?this.configLoader.loadChildren(e,t).pipe(Ut(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):W4(t))):se({routes:[],injector:e})}};function iG(n){n.sort((e,t)=>e.value.outlet===he?-1:t.value.outlet===he?1:e.value.outlet.localeCompare(t.value.outlet))}function sG(n){let e=n.value.routeConfig;return e&&e.path===""}function cM(n){let e=[],t=new Set;for(let r of n){if(!sG(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=cM(r.children);e.push(new Rn(r.value,i))}return e.filter(r=>!t.has(r))}function oG(n){return n.data||{}}function aG(n){return n.resolve||{}}function cG(n,e,t,r,i,s){return pt(o=>nG(n,e,t,r,o.extractedUrl,i,s).pipe(Ie(({state:a,tree:c})=>nt(K({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function uG(n,e){return pt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return se(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of uM(c))o.add(u);let a=0;return ct(o).pipe(qs(c=>s.has(c)?lG(c,r,n,e):(c.data=uI(c,c.parent,n).resolve,se(void 0))),Ut(()=>a++),va(1),pt(c=>a===o.size?se(t):Dn))})}function uM(n){let e=n.children.map(t=>uM(t)).flat();return[n,...e]}function lG(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!tM(i)&&(s[Al]=i.title),dG(s,n,e,r).pipe(Ie(o=>(n._resolvedData=o,n.data=uI(n,n.parent,t).resolve,null)))}function dG(n,e,t,r){let i=Vw(n);if(i.length===0)return se({});let s={};return ct(i).pipe(pt(o=>hG(n[o],e,t,r).pipe(br(),Ut(a=>{s[o]=a}))),va(1),Fy(s),Vi(o=>oM(o)?Dn:ma(o)))}function hG(n,e,t,r){let i=xl(e)??r,s=$a(n,i),o=s.resolve?s.resolve(e,t):fi(i,()=>s(e,t));return Ki(o)}function Lw(n){return Bn(e=>{let t=n(e);return t?ct(t).pipe(Ie(()=>e)):se(e)})}var lM=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===he);return i}getResolvedTitleForRoute(r){return r.data[Al]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>q(fG),providedIn:"root"});let n=e;return n})(),fG=(()=>{let e=class e extends lM{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(te(RP))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ml=new ce("",{providedIn:"root",factory:()=>({})}),Vp=new ce(""),pI=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=q(_p)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return se(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Ki(r.loadComponent()).pipe(Ie(dM),Ut(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),ju(()=>{this.componentLoaders.delete(r)})),s=new ga(i,()=>new Gt).pipe(pa());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return se({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=pG(i,this.compiler,r,this.onLoadEndListener).pipe(ju(()=>{this.childrenLoaders.delete(i)})),a=new ga(o,()=>new Gt).pipe(pa());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function pG(n,e,t,r){return Ki(n.loadChildren()).pipe(Ie(dM),pt(i=>i instanceof el||Array.isArray(i)?se(i):ct(e.compileModuleAsync(i))),Ie(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(Vp,[],{optional:!0,self:!0}).flat()),{routes:o.map(hI),injector:s}}))}function gG(n){return n&&typeof n=="object"&&"default"in n}function dM(n){return gG(n)?n.default:n}var gI=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>q(mG),providedIn:"root"});let n=e;return n})(),mG=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),hM=new ce(""),fM=new ce("");function _G(n,e,t){let r=n.get(fM),i=n.get(wn);return n.get($e).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(u=>setTimeout(u));let s,o=new Promise(u=>{s=u}),a=i.startViewTransition(()=>(s(),yG(n))),{onViewTransitionCreated:c}=r;return c&&fi(n,()=>c({transition:a,from:e,to:t})),o})}function yG(n){return new Promise(e=>{up(e,{injector:n})})}var mI=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Gt,this.transitionAbortSubject=new Gt,this.configLoader=q(pI),this.environmentInjector=q(yn),this.urlSerializer=q(Rl),this.rootContexts=q(Nl),this.location=q(Ma),this.inputBindingEnabled=q(Bp,{optional:!0})!==null,this.titleStrategy=q(lM),this.options=q(Ml,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=q(gI),this.createViewTransition=q(hM,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>se(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Gw(s)),i=s=>this.events.next(new Ww(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(nt(K(K({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Vt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:yl,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Un(o=>o.id!==0),Ie(o=>nt(K({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Bn(o=>{let a=!1,c=!1;return se(o).pipe(Bn(u=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Nn.SupersededByNewNavigation),Dn;this.currentTransition=o,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?nt(K({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=u.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&h!=="reload"){let g="";return this.events.next(new Wi(u.id,this.urlSerializer.serialize(u.rawUrl),g,Np.IgnoredSameUrlNavigation)),u.resolve(null),Dn}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return se(u).pipe(Bn(g=>{let _=this.transitions?.getValue();return this.events.next(new Ba(g.id,this.urlSerializer.serialize(g.extractedUrl),g.source,g.restoredState)),_!==this.transitions?.getValue()?Dn:Promise.resolve(g)}),cG(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Ut(g=>{o.targetSnapshot=g.targetSnapshot,o.urlAfterRedirects=g.urlAfterRedirects,this.currentNavigation=nt(K({},this.currentNavigation),{finalUrl:g.urlAfterRedirects});let _=new xp(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(_)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:g,extractedUrl:_,source:w,restoredState:C,extras:A}=u,O=new Ba(g,this.urlSerializer.serialize(_),w,C);this.events.next(O);let H=ZP(this.rootComponentType).snapshot;return this.currentTransition=o=nt(K({},u),{targetSnapshot:H,urlAfterRedirects:_,extras:nt(K({},A),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=_,se(o)}else{let g="";return this.events.next(new Wi(u.id,this.urlSerializer.serialize(u.extractedUrl),g,Np.IgnoredByUrlHandlingStrategy)),u.resolve(null),Dn}}),Ut(u=>{let d=new $w(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Ie(u=>(this.currentTransition=o=nt(K({},u),{guards:D4(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),L4(this.environmentInjector,u=>this.events.next(u)),Ut(u=>{if(o.guardsResult=u.guardsResult,Ua(u.guardsResult))throw rM(this.urlSerializer,u.guardsResult);let d=new Hw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(d)}),Un(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",Nn.GuardRejected),!1)),Lw(u=>{if(u.guards.canActivateChecks.length)return se(u).pipe(Ut(d=>{let h=new qw(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),Bn(d=>{let h=!1;return se(d).pipe(uG(this.paramsInheritanceStrategy,this.environmentInjector),Ut({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",Nn.NoDataFromResolver)}}))}),Ut(d=>{let h=new zw(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),Lw(u=>{let d=h=>{let g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe(Ut(_=>{h.component=_}),Ie(()=>{})));for(let _ of h.children)g.push(...d(_));return g};return Bu(d(u.targetSnapshot.root)).pipe(Ui(null),li(1))}),Lw(()=>this.afterPreactivation()),Bn(()=>{let{currentSnapshot:u,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,u.root,d.root);return h?ct(h).pipe(Ie(()=>o)):se(o)}),Ie(u=>{let d=y4(r.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=nt(K({},u),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),Ut(()=>{this.events.next(new Tl)}),C4(this.rootContexts,r.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),li(1),Ut({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Mr(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),jy(this.transitionAbortSubject.pipe(Ut(u=>{throw u}))),ju(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Nn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Vi(u=>{if(c=!0,sM(u))this.events.next(new Gi(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),I4(u)?this.events.next(new bl(u.url)):o.resolve(!1);else{this.events.next(new El(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(u))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Dn}))}))}cancelNavigationTransition(r,i,s){let o=new Gi(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function vG(n){return n!==yl}var wG=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>q(IG),providedIn:"root"});let n=e;return n})(),cI=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},IG=(()=>{let e=class e extends cI{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Wv(e)))(s||e)}})(),e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),pM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:()=>q(EG),providedIn:"root"});let n=e;return n})(),EG=(()=>{let e=class e extends pM{constructor(){super(...arguments),this.location=q(Ma),this.urlSerializer=q(Rl),this.options=q(Ml,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=q(gI),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new zi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=ZP(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Ba)this.stateMemento=this.createStateMemento();else if(r instanceof Wi)this.rawUrlTree=i.initialUrl;else if(r instanceof xp){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Tl?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Gi&&(r.code===Nn.GuardRejected||r.code===Nn.NoDataFromResolver)?this.restoreHistory(i):r instanceof El?this.restoreHistory(i,!0):r instanceof Mr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=K(K({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=K(K({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Wv(e)))(s||e)}})(),e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),ml=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(ml||{});function gM(n,e){n.events.pipe(Un(t=>t instanceof Mr||t instanceof Gi||t instanceof El||t instanceof Wi),Ie(t=>t instanceof Mr||t instanceof Wi?ml.COMPLETE:(t instanceof Gi?t.code===Nn.Redirect||t.code===Nn.SupersededByNewNavigation:!1)?ml.REDIRECTING:ml.FAILED),Un(t=>t!==ml.REDIRECTING),li(1)).subscribe(()=>{e()})}function TG(n){throw n}var bG={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},CG={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Nt=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=q(fp),this.stateManager=q(pM),this.options=q(Ml,{optional:!0})||{},this.pendingTasks=q(hp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=q(mI),this.urlSerializer=q(Rl),this.location=q(Ma),this.urlHandlingStrategy=q(gI),this._events=new Gt,this.errorHandler=this.options.errorHandler||TG,this.navigated=!1,this.routeReuseStrategy=q(wG),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=q(Vp,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!q(Bp,{optional:!0}),this.eventsSubscription=new bt,this.isNgZoneEnabled=q($e)instanceof $e&&$e.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Gi&&i.code!==Nn.Redirect&&i.code!==Nn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Mr)this.navigated=!0;else if(i instanceof bl){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||vG(s.source)};this.scheduleNavigation(a,yl,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}SG(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),yl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let u=K({},s);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(hI),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:u}=i,d=u?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=K(K({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let g;try{let _=s?s.snapshot:this.routerState.snapshot.root;g=QP(_)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),g=this.currentUrlTree.root}return YP(g,r,h,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Ua(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,yl,null,i)}navigate(r,i={skipLocationChange:!1}){return DG(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=K({},bG):i===!1?s=K({},CG):s=i,Ua(r))return xP(this.currentUrlTree,r,s);let o=this.parseUrl(r);return xP(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,u,d;a?(c=a.resolve,u=a.reject,d=a.promise):d=new Promise((g,_)=>{c=g,u=_});let h=this.pendingTasks.add();return gM(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:u,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(g=>Promise.reject(g))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function DG(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Z(4008,!1)}function SG(n){return!(n instanceof Tl)&&!(n instanceof bl)}var $p=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Gt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let u=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof Mr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,u),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:wx(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(ut(Nt),ut(no),Kv("tabindex"),ut(cp),ut(ol),ut(hr))},e.\u0275dir=Xf({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Kt("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&hw("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[sr.HasDecoratorInputTransform,"preserveFragment","preserveFragment",ll],skipLocationChange:[sr.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",ll],replaceUrl:[sr.HasDecoratorInputTransform,"replaceUrl","replaceUrl",ll],routerLink:"routerLink"},standalone:!0,features:[dw,il]});let n=e;return n})();var Up=class{};var AG=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Un(r=>r instanceof Mr),qs(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=dp(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return ct(s).pipe(_a())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=se(null);let o=s.pipe(pt(a=>a===null?se(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return ct([o,a]).pipe(_a())}else return o})}};e.\u0275fac=function(i){return new(i||e)(te(Nt),te(_p),te(yn),te(Up),te(pI))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),mM=new ce(""),RG=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=q(yn),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Ba?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof Mr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Wi&&r.code===Np.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Pp&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>m(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),up(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Pp(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){Mx()},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let n=e;return n})();function NG(n){return n.routerState.root}function kl(n,e){return{\u0275kind:n,\u0275providers:e}}function xG(){let n=q(xr);return e=>{let t=n.get(Pa);if(e!==t.components[0])return;let r=n.get(Nt),i=n.get(_M);n.get(_I)===1&&r.initialNavigation(),n.get(yM,null,me.Optional)?.setUpPreloading(),n.get(mM,null,me.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var _M=new ce("",{factory:()=>new Gt}),_I=new ce("",{providedIn:"root",factory:()=>1});function PG(){return kl(2,[{provide:_I,useValue:0},{provide:mp,multi:!0,deps:[xr],useFactory:e=>{let t=e.get(gP,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(Nt),s=e.get(_M);gM(i,()=>{r(!0)}),e.get(mI).afterPreactivation=()=>(r(!0),s.closed?se(void 0):s),i.initialNavigation()}))}}])}function MG(){return kl(3,[{provide:mp,multi:!0,useFactory:()=>{let e=q(Nt);return()=>{e.setUpLocationChangeListener()}}},{provide:_I,useValue:2}])}var yM=new ce("");function kG(n){return kl(0,[{provide:yM,useExisting:AG},{provide:Up,useExisting:n}])}function OG(){return kl(8,[OP,{provide:Bp,useExisting:OP}])}function LG(n){let e=[{provide:hM,useValue:_G},{provide:fM,useValue:K({skipNextTransition:!!n?.skipInitialTransition},n)}];return kl(9,e)}var FP=new ce("ROUTER_FORROOT_GUARD"),FG=[Ma,{provide:Rl,useClass:wl},Nt,Nl,{provide:no,useFactory:NG,deps:[Nt]},pI,[]],yI=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[FG,[],{provide:Vp,multi:!0,useValue:r},{provide:FP,useFactory:jG,deps:[[Nt,new Mv,new hN]]},{provide:Ml,useValue:i||{}},i?.useHash?UG():BG(),VG(),i?.preloadingStrategy?kG(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?$G(i):[],i?.bindToComponentInputs?OG().\u0275providers:[],i?.enableViewTransitions?LG().\u0275providers:[],HG()]}}static forChild(r){return{ngModule:e,providers:[{provide:Vp,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(te(FP,8))},e.\u0275mod=cr({type:e}),e.\u0275inj=ar({});let n=e;return n})();function VG(){return{provide:mM,useFactory:()=>{let n=q(vP),e=q($e),t=q(Ml),r=q(mI),i=q(Rl);return t.scrollOffset&&n.setOffset(t.scrollOffset),new RG(i,r,n,e,t)}}}function UG(){return{provide:hr,useClass:wp}}function BG(){return{provide:hr,useClass:Ew}}function jG(n){return"guarded"}function $G(n){return[n.initialNavigation==="disabled"?MG().\u0275providers:[],n.initialNavigation==="enabledBlocking"?PG().\u0275providers:[]]}var VP=new ce("");function HG(){return[{provide:VP,useFactory:xG},{provide:gw,multi:!0,useExisting:VP}]}var wI={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var V=function(n,e){if(!n)throw ro(e)},ro=function(n){return new Error("Firebase Database ("+wI.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var wM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},qG=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},qp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,u=c?n[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4,g=(a&15)<<2|u>>6,_=u&63;c||(_=64,o||(g=64)),r.push(t[d],t[h],t[g],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(wM(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):qG(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let u=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||u==null||h==null)throw new II;let g=s<<2|a>>4;if(r.push(g),u!==64){let _=a<<4&240|u>>2;if(r.push(_),h!==64){let w=u<<6&192|h;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},II=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},TI=function(n){let e=wM(n);return qp.encodeByteArray(e,!0)},Ll=function(n){return TI(n).replace(/\./g,"")},Fl=function(n){try{return qp.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function IM(n){return qa(void 0,n)}function qa(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!zG(t)||(n[t]=qa(n[t],e[t]));return n}function zG(n){return n!=="__proto__"}function GG(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var WG=()=>GG().__FIREBASE_DEFAULTS__,KG=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},QG=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Fl(n[1]);return e&&JSON.parse(e)},bI=()=>{try{return WG()||KG()||QG()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var CI=()=>{var n;return(n=bI())===null||n===void 0?void 0:n.config},EM=n=>{var e;return(e=bI())===null||e===void 0?void 0:e[`_${n}`]};var Ct=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function za(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Ll(JSON.stringify(t)),Ll(JSON.stringify(o)),""].join(".")}function Ue(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Vl(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ue())}function zp(){var n;let e=(n=bI())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Gp(){return typeof self=="object"&&self.self===self}function Wp(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function io(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Kp(){let n=Ue();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Or(){return wI.NODE_CLIENT===!0||wI.NODE_ADMIN===!0}function DI(){return!zp()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Qi(){try{return typeof indexedDB=="object"}catch{return!1}}function TM(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var YG="FirebaseError",rt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=YG,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zn.prototype.create)}},zn=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?JG(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new rt(i,a,r)}};function JG(n,e){return n.replace(XG,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var XG=/\{\$([^}]+)}/g;function Ha(n){return JSON.parse(n)}function gt(n){return JSON.stringify(n)}var bM=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=Ha(Fl(s[0])||""),t=Ha(Fl(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var CM=function(n){let e=bM(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},DM=function(n){let e=bM(n).claims;return typeof e=="object"&&e.admin===!0};function an(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Yi(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Ga(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ul(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Ji(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(vM(s)&&vM(o)){if(!Ji(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function vM(n){return n!==null&&typeof n=="object"}function _i(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Xi(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Wa(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var Hp=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){let g=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(g<<1|g>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],u,d;for(let h=0;h<80;h++){h<40?h<20?(u=a^s&(o^a),d=1518500249):(u=s^o^a,d=1859775393):h<60?(u=s&o|a&(s|o),d=2400959708):(u=s^o^a,d=3395469782);let g=(i<<5|i>>>27)+u+c+d+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=g}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function Qp(n,e){let t=new EI(n,e);return t.subscribe.bind(t)}var EI=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");ZG(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=vI),i.error===void 0&&(i.error=vI),i.complete===void 0&&(i.complete=vI);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function ZG(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function vI(){}var ne=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){let s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function Qt(n,e){return`${n} failed: ${e} argument `}function Dt(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(Qt(n,e)+"must be a valid function.")}function SI(n,e,t,r){if(!(r&&!t)&&(typeof t!="object"||t===null))throw new Error(Qt(n,e)+"must be a valid context object.")}var SM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,V(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Bl=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var hie=4*60*60*1e3;function B(n){return n&&n._delegate?n._delegate:n}var Le=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var so="[DEFAULT]";var oo=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Ct;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tW(e))try{this.getOrInitializeService({instanceIdentifier:so})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=so){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return m(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=so){return this.instances.has(e)}getOptions(e=so){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:eW(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=so){return this.component?this.component.multipleInstances?e:so:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function eW(n){return n===so?void 0:n}function tW(n){return n.instantiationMode==="EAGER"}var Zi=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new oo(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var HI={};IB(HI,{FirebaseError:()=>rt,SDK_VERSION:()=>un,_DEFAULT_ENTRY_NAME:()=>Fr,_addComponent:()=>Ya,_addOrOverwriteComponent:()=>BI,_apps:()=>es,_clearComponents:()=>$W,_components:()=>Qa,_getProvider:()=>Ja,_isFirebaseApp:()=>$M,_isFirebaseServerApp:()=>Je,_registerComponent:()=>cn,_removeServiceInstance:()=>jM,_serverApps:()=>Ka,deleteApp:()=>eg,getApp:()=>$l,getApps:()=>zW,initializeApp:()=>Zp,initializeServerApp:()=>qW,onLog:()=>jI,registerVersion:()=>lt,setLogLevel:()=>$I});var AI=[],fe=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(fe||{}),AM={debug:fe.DEBUG,verbose:fe.VERBOSE,info:fe.INFO,warn:fe.WARN,error:fe.ERROR,silent:fe.SILENT},nW=fe.INFO,rW={[fe.DEBUG]:"log",[fe.VERBOSE]:"log",[fe.INFO]:"info",[fe.WARN]:"warn",[fe.ERROR]:"error"},iW=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=rW[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},In=class{constructor(e){this.name=e,this._logLevel=nW,this._logHandler=iW,this._userLogHandler=null,AI.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?AM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,fe.DEBUG,...e),this._logHandler(this,fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,fe.VERBOSE,...e),this._logHandler(this,fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,fe.INFO,...e),this._logHandler(this,fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,fe.WARN,...e),this._logHandler(this,fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,fe.ERROR,...e),this._logHandler(this,fe.ERROR,...e)}};function RM(n){AI.forEach(e=>{e.setLogLevel(n)})}function NM(n,e){for(let t of AI){let r=null;e&&e.level&&(r=AM[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:fe[s].toLowerCase(),message:a,args:o,type:i.name})}}}var sW=(n,e)=>e.some(t=>n instanceof t),xM,PM;function oW(){return xM||(xM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function aW(){return PM||(PM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var MM=new WeakMap,NI=new WeakMap,kM=new WeakMap,RI=new WeakMap,PI=new WeakMap;function cW(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Lr(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&MM.set(t,n)}).catch(()=>{}),PI.set(e,n),e}function uW(n){if(NI.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});NI.set(n,e)}var xI={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return NI.get(n);if(e==="objectStoreNames")return n.objectStoreNames||kM.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Lr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function OM(n){xI=n(xI)}function lW(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Yp(this),e,...t);return kM.set(r,e.sort?e.sort():[e]),Lr(r)}:aW().includes(n)?function(...e){return n.apply(Yp(this),e),Lr(MM.get(this))}:function(...e){return Lr(n.apply(Yp(this),e))}}function dW(n){return typeof n=="function"?lW(n):(n instanceof IDBTransaction&&uW(n),sW(n,oW())?new Proxy(n,xI):n)}function Lr(n){if(n instanceof IDBRequest)return cW(n);if(RI.has(n))return RI.get(n);let e=dW(n);return e!==n&&(RI.set(n,e),PI.set(e,n)),e}var Yp=n=>PI.get(n);function FM(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=Lr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Lr(o.result),c.oldVersion,c.newVersion,Lr(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}var hW=["get","getKey","getAll","getAllKeys","count"],fW=["put","add","delete","clear"],MI=new Map;function LM(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(MI.get(e))return MI.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=fW.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||hW.includes(t)))return;let s=function(o,...a){return m(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),u=c.store;return r&&(u=u.index(a.shift())),(yield Promise.all([u[t](...a),i&&c.done]))[0]})};return MI.set(e,s),s}OM(n=>nt(K({},n),{get:(e,t,r)=>LM(e,t)||n.get(e,t,r),has:(e,t)=>!!LM(e,t)||n.has(e,t)}));var OI=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(pW(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function pW(n){let e=n.getComponent();return e?.type==="VERSION"}var Jp="@firebase/app",LI="0.10.5";var ao=new In("@firebase/app"),gW="@firebase/app-compat",mW="@firebase/analytics-compat",_W="@firebase/analytics",yW="@firebase/app-check-compat",vW="@firebase/app-check",wW="@firebase/auth",IW="@firebase/auth-compat",EW="@firebase/database",TW="@firebase/database-compat",bW="@firebase/functions",CW="@firebase/functions-compat",DW="@firebase/installations",SW="@firebase/installations-compat",AW="@firebase/messaging",RW="@firebase/messaging-compat",NW="@firebase/performance",xW="@firebase/performance-compat",PW="@firebase/remote-config",MW="@firebase/remote-config-compat",kW="@firebase/storage",OW="@firebase/storage-compat",LW="@firebase/firestore",FW="@firebase/vertexai-preview",VW="@firebase/firestore-compat",UW="firebase",BW="10.12.2";var Fr="[DEFAULT]",jW={[Jp]:"fire-core",[gW]:"fire-core-compat",[_W]:"fire-analytics",[mW]:"fire-analytics-compat",[vW]:"fire-app-check",[yW]:"fire-app-check-compat",[wW]:"fire-auth",[IW]:"fire-auth-compat",[EW]:"fire-rtdb",[TW]:"fire-rtdb-compat",[bW]:"fire-fn",[CW]:"fire-fn-compat",[DW]:"fire-iid",[SW]:"fire-iid-compat",[AW]:"fire-fcm",[RW]:"fire-fcm-compat",[NW]:"fire-perf",[xW]:"fire-perf-compat",[PW]:"fire-rc",[MW]:"fire-rc-compat",[kW]:"fire-gcs",[OW]:"fire-gcs-compat",[LW]:"fire-fst",[VW]:"fire-fst-compat",[FW]:"fire-vertex","fire-js":"fire-js",[UW]:"fire-js-all"};var es=new Map,Ka=new Map,Qa=new Map;function Ya(n,e){try{n.container.addComponent(e)}catch(t){ao.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function BI(n,e){n.container.addOrOverwriteComponent(e)}function cn(n){let e=n.name;if(Qa.has(e))return ao.debug(`There were multiple attempts to register component ${e}.`),!1;Qa.set(e,n);for(let t of es.values())Ya(t,n);for(let t of Ka.values())Ya(t,n);return!0}function Ja(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function jM(n,e,t=Fr){Ja(n,e).clearInstance(t)}function $M(n){return n.options!==void 0}function Je(n){return n.settings!==void 0}function $W(){Qa.clear()}var HW={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Gn=new zn("app","Firebase",HW);var Xp=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Le("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gn.create("app-deleted",{appName:this._name})}};var FI=class extends Xp{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,lt(Jp,LI,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){eg(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Gn.create("server-app-deleted")}};var un=BW;function Zp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Fr,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Gn.create("bad-app-name",{appName:String(i)});if(t||(t=CI()),!t)throw Gn.create("no-options");let s=es.get(i);if(s){if(Ji(t,s.options)&&Ji(r,s.config))return s;throw Gn.create("duplicate-app",{appName:i})}let o=new Zi(i);for(let c of Qa.values())o.addComponent(c);let a=new Xp(t,r,o);return es.set(i,a),a}function qW(n,e){if(Gp())throw Gn.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;$M(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=u=>[...u].reduce((d,h)=>Math.imul(31,d)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Gn.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=Ka.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new Zi(s);for(let u of Qa.values())a.addComponent(u);let c=new FI(t,e,s,a);return Ka.set(s,c),c}function $l(n=Fr){let e=es.get(n);if(!e&&n===Fr&&CI())return Zp();if(!e)throw Gn.create("no-app",{appName:n});return e}function zW(){return Array.from(es.values())}function eg(n){return m(this,null,function*(){let e=!1,t=n.name;es.has(t)?(e=!0,es.delete(t)):Ka.has(t)&&n.decRefCount()<=0&&(Ka.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function lt(n,e,t){var r;let i=(r=jW[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ao.warn(a.join(" "));return}cn(new Le(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function jI(n,e){if(n!==null&&typeof n!="function")throw Gn.create("invalid-log-argument");NM(n,e)}function $I(n){RM(n)}var GW="firebase-heartbeat-database",WW=1,jl="firebase-heartbeat-store",kI=null;function HM(){return kI||(kI=FM(GW,WW,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(jl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Gn.create("idb-open",{originalErrorMessage:n.message})})),kI}function KW(n){return m(this,null,function*(){try{let t=(yield HM()).transaction(jl),r=yield t.objectStore(jl).get(qM(n));return yield t.done,r}catch(e){if(e instanceof rt)ao.warn(e.message);else{let t=Gn.create("idb-get",{originalErrorMessage:e?.message});ao.warn(t.message)}}})}function VM(n,e){return m(this,null,function*(){try{let r=(yield HM()).transaction(jl,"readwrite");yield r.objectStore(jl).put(e,qM(n)),yield r.done}catch(t){if(t instanceof rt)ao.warn(t.message);else{let r=Gn.create("idb-set",{originalErrorMessage:t?.message});ao.warn(r.message)}}})}function qM(n){return`${n.name}!${n.options.appId}`}var QW=1024,YW=30*24*60*60*1e3,VI=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new UI(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return m(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=UM();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=YW}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return m(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=UM(),{heartbeatsToSend:r,unsentEntries:i}=JW(this._heartbeatsCache.heartbeats),s=Ll(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function UM(){return new Date().toISOString().substring(0,10)}function JW(n,e=QW){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),BM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),BM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var UI=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return m(this,null,function*(){return Qi()?TM().then(()=>!0).catch(()=>!1):!1})}read(){return m(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield KW(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return m(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return VM(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return m(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return VM(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function BM(n){return Ll(JSON.stringify({version:2,heartbeats:n})).length}function XW(n){cn(new Le("platform-logger",e=>new OI(e),"PRIVATE")),cn(new Le("heartbeat",e=>new VI(e),"PRIVATE")),lt(Jp,LI,n),lt(Jp,LI,"esm2017"),lt("fire-js","")}XW("");var qI=class{constructor(e,t){this._delegate=e,this.firebase=t,Ya(e,new Le("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),eg(this._delegate)))}_getService(e,t=Fr){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=Fr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Ya(this._delegate,e)}_addOrOverwriteComponent(e){BI(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var ZW={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},zM=new zn("app-compat","Firebase",ZW);function e3(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:lt,setLogLevel:$I,onLog:jI,apps:null,SDK_VERSION:un,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:HI}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(u){delete e[u]}function i(u){if(u=u||Fr,!an(e,u))throw zM.create("no-app",{appName:u});return e[u]}i.App=n;function s(u,d={}){let h=Zp(u,d);if(an(e,h.name))return e[h.name];let g=new n(h,t);return e[h.name]=g,g}function o(){return Object.keys(e).map(u=>e[u])}function a(u){let d=u.name,h=d.replace("-compat","");if(cn(u)&&u.type==="PUBLIC"){let g=(_=i())=>{if(typeof _[h]!="function")throw zM.create("invalid-app-argument",{appName:d});return _[h]()};u.serviceProps!==void 0&&qa(g,u.serviceProps),t[h]=g,n.prototype[h]=function(..._){return this._getService.bind(this,d).apply(this,u.multipleInstances?_:[])}}return u.type==="PUBLIC"?t[h]:null}function c(u,d){return d==="serverAuth"?null:d}return t}function WM(){let n=e3(qI);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:WM,extendNamespace:e,createSubscribe:Qp,ErrorFactory:zn,deepExtend:qa});function e(t){qa(n,t)}return n}var t3=WM();var GM=new In("@firebase/app-compat"),n3="@firebase/app-compat",r3="0.2.35";function i3(n){lt(n3,r3,n)}if(Gp()&&self.firebase!==void 0){GM.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);let n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&GM.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var Ne=t3;i3();var po={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var ss={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function s3(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function uk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var IE=s3,lk=uk,dk=new zn("auth","Firebase",uk());var ig=new In("@firebase/auth");function o3(n,...e){ig.logLevel<=fe.WARN&&ig.warn(`Auth (${un}): ${n}`,...e)}function ng(n,...e){ig.logLevel<=fe.ERROR&&ig.error(`Auth (${un}): ${n}`,...e)}function yt(n,...e){throw TE(n,...e)}function _t(n,...e){return TE(n,...e)}function EE(n,e,t){let r=Object.assign(Object.assign({},lk()),{[e]:t});return new zn("auth","Firebase",r).create(e,{appName:n.name})}function Pt(n){return EE(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ec(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&yt(n,"argument-error"),EE(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function TE(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return dk.create(n,...e)}function L(n,e,...t){if(!n)throw TE(e,...t)}function Vr(n){let e="INTERNAL ASSERTION FAILED: "+n;throw ng(e),new Error(e)}function Wn(n,e){n||Vr(e)}function Wl(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function bE(){return KM()==="http:"||KM()==="https:"}function KM(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function a3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(bE()||Wp()||"connection"in navigator)?navigator.onLine:!0}function c3(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var co=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Wn(t>e,"Short delay should be less than long delay!"),this.isMobile=Vl()||io()}get(){return a3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function CE(n,e){Wn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Kl=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var u3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var l3=new co(3e4,6e4);function it(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function st(s,o,a,c){return m(this,arguments,function*(n,e,t,r,i={}){return hk(n,i,()=>m(this,null,function*(){let u={},d={};r&&(e==="GET"?d=r:u={body:JSON.stringify(r)});let h=_i(Object.assign({key:n.config.apiKey},d)).slice(1),g=yield n._getAdditionalHeaders();return g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode),Kl.fetch()(fk(n,n.config.apiHost,t,h),Object.assign({method:e,headers:g,referrerPolicy:"no-referrer"},u))}))})}function hk(n,e,t){return m(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},u3),e);try{let i=new QI(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Hl(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hl(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Hl(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Hl(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw EE(n,d,u);yt(n,d)}}catch(i){if(i instanceof rt)throw i;yt(n,"network-request-failed",{message:String(i)})}})}function wi(s,o,a,c){return m(this,arguments,function*(n,e,t,r,i={}){let u=yield st(n,e,t,r,i);return"mfaPendingCredential"in u&&yt(n,"multi-factor-auth-required",{_serverResponse:u}),u})}function fk(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?CE(n.config,i):`${n.config.apiScheme}://${i}`}function d3(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var QI=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(_t(this.auth,"network-request-failed")),l3.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Hl(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=_t(n,e,r);return i.customData._tokenResponse=t,i}function QM(n){return n!==void 0&&n.getResponse!==void 0}function YM(n){return n!==void 0&&n.enterprise!==void 0}var YI=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return d3(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function h3(n){return m(this,null,function*(){return(yield st(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})}function f3(n,e){return m(this,null,function*(){return st(n,"GET","/v2/recaptchaConfig",it(n,e))})}function p3(n,e){return m(this,null,function*(){return st(n,"POST","/v1/accounts:delete",e)})}function g3(n,e){return m(this,null,function*(){return st(n,"POST","/v1/accounts:update",e)})}function pk(n,e){return m(this,null,function*(){return st(n,"POST","/v1/accounts:lookup",e)})}function ql(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function gk(n,e=!1){return m(this,null,function*(){let t=B(n),r=yield t.getIdToken(e),i=gg(r);L(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:ql(zI(i.auth_time)),issuedAtTime:ql(zI(i.iat)),expirationTime:ql(zI(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function zI(n){return Number(n)*1e3}function gg(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ng("JWT malformed, contained fewer than 3 sections"),null;try{let i=Fl(t);return i?JSON.parse(i):(ng("Failed to decode base64 JWT payload"),null)}catch(i){return ng("Caught error parsing JWT payload as JSON",i?.toString()),null}}function JM(n){let e=gg(n);return L(e,"internal-error"),L(typeof e.exp<"u","internal-error"),L(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function vi(n,e,t=!1){return m(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof rt&&m3(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function m3({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var JI=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>m(this,null,function*(){yield this.iteration()}),t)}iteration(){return m(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Ql=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ql(this.lastLoginAt),this.creationTime=ql(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Yl(n){return m(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield vi(n,pk(t,{idToken:r}));L(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?_k(s.providerUserInfo):[],a=_3(n.providerData,o),c=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!a?.length,d=c?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Ql(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,h)})}function mk(n){return m(this,null,function*(){let e=B(n);yield Yl(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function _3(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function _k(n){return n.map(e=>{var{providerId:t}=e,r=cf(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function y3(n,e){return m(this,null,function*(){let t=yield hk(n,{},()=>m(this,null,function*(){let r=_i({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=fk(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Kl.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function v3(n,e){return m(this,null,function*(){return st(n,"POST","/v2/accounts:revokeToken",it(n,e))})}var zl=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){L(e.idToken,"internal-error"),L(typeof e.idToken<"u","internal-error"),L(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):JM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){L(e.length!==0,"internal-error");let t=JM(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return m(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(L(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return m(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield y3(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(L(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(L(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(L(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Vr("not implemented")}};function ts(n,e){L(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var uo=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=cf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new JI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ql(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return m(this,null,function*(){let t=yield vi(this,this.stsTokenManager.getToken(this.auth,e));return L(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return gk(this,e)}reload(){return mk(this)}_assign(e){this!==e&&(L(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){L(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return m(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Yl(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return m(this,null,function*(){if(Je(this.auth.app))return Promise.reject(Pt(this.auth));let e=yield this.getIdToken();return yield vi(this,p3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,u,d;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,w=(o=t.photoURL)!==null&&o!==void 0?o:void 0,C=(a=t.tenantId)!==null&&a!==void 0?a:void 0,A=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,O=(u=t.createdAt)!==null&&u!==void 0?u:void 0,H=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:F,emailVerified:z,isAnonymous:ie,providerData:W,stsTokenManager:T}=t;L(F&&T,e,"internal-error");let v=zl.fromJSON(this.name,T);L(typeof F=="string",e,"internal-error"),ts(h,e.name),ts(g,e.name),L(typeof z=="boolean",e,"internal-error"),L(typeof ie=="boolean",e,"internal-error"),ts(_,e.name),ts(w,e.name),ts(C,e.name),ts(A,e.name),ts(O,e.name),ts(H,e.name);let I=new n({uid:F,auth:e,email:g,emailVerified:z,displayName:h,isAnonymous:ie,photoURL:w,phoneNumber:_,tenantId:C,stsTokenManager:v,createdAt:O,lastLoginAt:H});return W&&Array.isArray(W)&&(I.providerData=W.map(b=>Object.assign({},b))),A&&(I._redirectEventId=A),I}static _fromIdTokenResponse(e,t,r=!1){return m(this,null,function*(){let i=new zl;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Yl(s),s})}static _fromGetAccountInfoResponse(e,t,r){return m(this,null,function*(){let i=t.users[0];L(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?_k(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new zl;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ql(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,u),c})}};var XM=new Map;function Yt(n){Wn(n instanceof Function,"Expected a class definition");let e=XM.get(n);return e?(Wn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,XM.set(n,e),e)}var w3=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return m(this,null,function*(){return!0})}_set(t,r){return m(this,null,function*(){this.storage[t]=r})}_get(t){return m(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return m(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),rs=w3;function Ur(n,e,t){return`firebase:${n}:${e}:${t}`}var sg=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Ur(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ur("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return m(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?uo._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return m(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return m(this,null,function*(){if(!t.length)return new n(Yt(rs),e,r);let i=(yield Promise.all(t.map(u=>m(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=i[0]||Yt(rs),o=Ur(r,e.config.apiKey,e.name),a=null;for(let u of t)try{let d=yield u._get(o);if(d){let h=uo._fromJSON(e,d);u!==s&&(a=h),s=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(u=>m(this,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new n(s,e,r))})}};function ZM(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(wk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ik(e))return"Blackberry";if(Ek(e))return"Webos";if(DE(e))return"Safari";if((e.includes("chrome/")||vk(e))&&!e.includes("edge/"))return"Chrome";if(tc(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function yk(n=Ue()){return/firefox\//i.test(n)}function DE(n=Ue()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vk(n=Ue()){return/crios\//i.test(n)}function wk(n=Ue()){return/iemobile/i.test(n)}function tc(n=Ue()){return/android/i.test(n)}function Ik(n=Ue()){return/blackberry/i.test(n)}function Ek(n=Ue()){return/webos/i.test(n)}function go(n=Ue()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Tk(n=Ue()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function I3(n=Ue()){var e;return go(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function E3(){return Kp()&&document.documentMode===10}function bk(n=Ue()){return go(n)||tc(n)||Ek(n)||Ik(n)||/windows phone/i.test(n)||wk(n)}function T3(){try{return!!(window&&window!==window.top)}catch{return!1}}function SE(n,e=[]){let t;switch(n){case"Browser":t=ZM(Ue());break;case"Worker":t=`${ZM(Ue())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${un}/${r}`}var XI=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return m(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function b3(t){return m(this,arguments,function*(n,e={}){return st(n,"GET","/v2/passwordPolicy",it(n,e))})}var C3=6,ZI=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:C3,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var og=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ag(this),this.idTokenSubscription=new ag(this),this.beforeStateQueue=new XI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=dk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Yt(t)),this._initializationPromise=this.queue(()=>m(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield sg.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return m(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return m(this,null,function*(){try{let t=yield pk(this,{idToken:e}),r=yield uo._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return m(this,null,function*(){var t;if(Je(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return L(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return m(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return m(this,null,function*(){try{yield Yl(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=c3()}_delete(){return m(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return m(this,null,function*(){if(Je(this.app))return Promise.reject(Pt(this));let t=e?B(e):null;return t&&L(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return m(this,null,function*(){if(!this._deleted)return e&&L(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>m(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return m(this,null,function*(){return Je(this.app)?Promise.reject(Pt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Je(this.app)?Promise.reject(Pt(this)):this.queue(()=>m(this,null,function*(){yield this.assertedPersistence.setPersistence(Yt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return m(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return m(this,null,function*(){let e=yield b3(this),t=new ZI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new zn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return m(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield v3(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return m(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return m(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Yt(e)||this._popupRedirectResolver;L(t,this,"argument-error"),this.redirectPersistenceManager=yield sg.create(this,[Yt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return m(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>m(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return m(this,null,function*(){if(e===this.currentUser)return this.queue(()=>m(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(L(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return m(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return L(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=SE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return m(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return m(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&o3(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Ge(n){return B(n)}var ag=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Qp(t=>this.observer=t)}get next(){return L(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var od={loadJS(){return m(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function D3(n){od=n}function AE(n){return od.loadJS(n)}function S3(){return od.recaptchaV2Script}function A3(){return od.recaptchaEnterpriseScript}function R3(){return od.gapiScript}function Ck(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var N3="recaptcha-enterprise",x3="NO_RECAPTCHA",eE=class{constructor(e){this.type=N3,this.auth=Ge(e)}verify(e="verify",t=!1){return m(this,null,function*(){function r(s){return m(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>m(this,null,function*(){f3(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let u=new YI(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;YM(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(x3)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&YM(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=A3();c.length!==0&&(c+=a),AE(c).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})})}};function ek(n,e,t,r=!1){return m(this,null,function*(){let i=new eE(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function Jl(n,e,t,r){return m(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield ek(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>m(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield ek(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function P3(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Yt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function RE(n,e,t){let r=Ge(n);L(r._canInitEmulator,r,"emulator-config-failed"),L(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Dk(e),{host:o,port:a}=M3(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||k3()}function Dk(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function M3(n){let e=Dk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:tk(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:tk(o)}}}function tk(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function k3(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Br=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Vr("not implemented")}_getIdTokenResponse(e){return Vr("not implemented")}_linkToIdToken(e,t){return Vr("not implemented")}_getReauthenticationResolver(e){return Vr("not implemented")}};function Sk(n,e){return m(this,null,function*(){return st(n,"POST","/v1/accounts:resetPassword",it(n,e))})}function O3(n,e){return m(this,null,function*(){return st(n,"POST","/v1/accounts:update",e)})}function L3(n,e){return m(this,null,function*(){return st(n,"POST","/v1/accounts:signUp",e)})}function F3(n,e){return m(this,null,function*(){return st(n,"POST","/v1/accounts:update",it(n,e))})}function V3(n,e){return m(this,null,function*(){return wi(n,"POST","/v1/accounts:signInWithPassword",it(n,e))})}function mg(n,e){return m(this,null,function*(){return st(n,"POST","/v1/accounts:sendOobCode",it(n,e))})}function U3(n,e){return m(this,null,function*(){return mg(n,e)})}function B3(n,e){return m(this,null,function*(){return mg(n,e)})}function j3(n,e){return m(this,null,function*(){return mg(n,e)})}function $3(n,e){return m(this,null,function*(){return mg(n,e)})}function H3(n,e){return m(this,null,function*(){return wi(n,"POST","/v1/accounts:signInWithEmailLink",it(n,e))})}function q3(n,e){return m(this,null,function*(){return wi(n,"POST","/v1/accounts:signInWithEmailLink",it(n,e))})}var Xl=class n extends Br{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return m(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jl(e,t,"signInWithPassword",V3);case"emailLink":return H3(e,{email:this._email,oobCode:this._password});default:yt(e,"internal-error")}})}_linkToIdToken(e,t){return m(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jl(e,r,"signUpPassword",L3);case"emailLink":return q3(e,{idToken:t,email:this._email,oobCode:this._password});default:yt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function yi(n,e){return m(this,null,function*(){return wi(n,"POST","/v1/accounts:signInWithIdp",it(n,e))})}var z3="http://localhost",fr=class n extends Br{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):yt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=cf(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return yi(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,yi(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,yi(e,t)}buildRequest(){let e={requestUri:z3,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=_i(t)}return e}};function G3(n,e){return m(this,null,function*(){return st(n,"POST","/v1/accounts:sendVerificationCode",it(n,e))})}function W3(n,e){return m(this,null,function*(){return wi(n,"POST","/v1/accounts:signInWithPhoneNumber",it(n,e))})}function K3(n,e){return m(this,null,function*(){let t=yield wi(n,"POST","/v1/accounts:signInWithPhoneNumber",it(n,e));if(t.temporaryProof)throw Hl(n,"account-exists-with-different-credential",t);return t})}var Q3={USER_NOT_FOUND:"user-not-found"};function Y3(n,e){return m(this,null,function*(){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return wi(n,"POST","/v1/accounts:signInWithPhoneNumber",it(n,t),Q3)})}var Xa=class n extends Br{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return W3(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return K3(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return Y3(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function J3(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function X3(n){let e=Xi(Wa(n)).link,t=e?Xi(Wa(e)).deep_link_id:null,r=Xi(Wa(n)).deep_link_id;return(r?Xi(Wa(r)).link:null)||r||t||e||n}var Zl=class n{constructor(e){var t,r,i,s,o,a;let c=Xi(Wa(e)),u=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=J3((i=c.mode)!==null&&i!==void 0?i:null);L(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=X3(e);try{return new n(t)}catch{return null}}};var ad=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Xl._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Zl.parseLink(r);return L(i,"argument-error"),Xl._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),pr=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var is=class extends pr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},Za=class n extends is{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return L("providerId"in t&&"signInMethod"in t,"argument-error"),fr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return L(e.idToken||e.accessToken,"argument-error"),fr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var _g=(()=>{class n extends is{constructor(){super("facebook.com")}static credential(t){return fr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.FACEBOOK_SIGN_IN_METHOD="facebook.com",n.PROVIDER_ID="facebook.com";return n})(),yg=(()=>{class n extends is{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return fr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})(),vg=(()=>{class n extends is{constructor(){super("github.com")}static credential(t){return fr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.GITHUB_SIGN_IN_METHOD="github.com",n.PROVIDER_ID="github.com";return n})(),Z3="http://localhost",lo=class n extends Br{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return yi(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,yi(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,yi(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:Z3,returnSecureToken:!0,pendingToken:this.pendingToken}}};var e6="saml.",ed=class n extends pr{constructor(e){L(e.startsWith(e6),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=lo.fromJSON(e);return L(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return lo._create(r,t)}catch{return null}}};var wg=(()=>{class n extends is{constructor(){super("twitter.com")}static credential(t,r){return fr._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return n.credential(r,i)}catch{return null}}}n.TWITTER_SIGN_IN_METHOD="twitter.com",n.PROVIDER_ID="twitter.com";return n})();function Ak(n,e){return m(this,null,function*(){return wi(n,"POST","/v1/accounts:signUp",it(n,e))})}var gr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return m(this,null,function*(){let s=yield uo._fromIdTokenResponse(e,r,i),o=nk(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return m(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=nk(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function nk(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function NE(n){return m(this,null,function*(){var e;if(Je(n.app))return Promise.reject(Pt(n));let t=Ge(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new gr({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield Ak(t,{returnSecureToken:!0}),i=yield gr._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var tE=class n extends rt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Rk(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?tE._fromErrorAndOperation(n,s,e,r):s})}function Nk(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}function xE(n,e){return m(this,null,function*(){let t=B(n);yield Ig(!0,t,e);let{providerUserInfo:r}=yield g3(t.auth,{idToken:yield t.getIdToken(),deleteProvider:[e]}),i=Nk(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),yield t.auth._persistUserIfCurrent(t),t})}function PE(n,e,t=!1){return m(this,null,function*(){let r=yield vi(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return gr._forOperation(n,"link",r)})}function Ig(n,e,t){return m(this,null,function*(){yield Yl(e);let r=Nk(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";L(r.has(t)===n,e.auth,i)})}function xk(n,e,t=!1){return m(this,null,function*(){let{auth:r}=n;if(Je(r.app))return Promise.reject(Pt(r));let i="reauthenticate";try{let s=yield vi(n,Rk(r,i,e,n),t);L(s.idToken,r,"internal-error");let o=gg(s.idToken);L(o,r,"internal-error");let{sub:a}=o;return L(n.uid===a,r,"user-mismatch"),gr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&yt(r,"user-mismatch"),s}})}function Pk(n,e,t=!1){return m(this,null,function*(){if(Je(n.app))return Promise.reject(Pt(n));let r="signIn",i=yield Rk(n,r,e),s=yield gr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function nc(n,e){return m(this,null,function*(){return Pk(Ge(n),e)})}function Eg(n,e){return m(this,null,function*(){let t=B(n);return yield Ig(!1,t,e.providerId),PE(t,e)})}function Tg(n,e){return m(this,null,function*(){return xk(B(n),e)})}function t6(n,e){return m(this,null,function*(){return wi(n,"POST","/v1/accounts:signInWithCustomToken",it(n,e))})}function ME(n,e){return m(this,null,function*(){if(Je(n.app))return Promise.reject(Pt(n));let t=Ge(n),r=yield t6(t,{token:e,returnSecureToken:!0}),i=yield gr._fromIdTokenResponse(t,"signIn",r);return yield t._updateCurrentUser(i.user),i})}var ho=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?nE._fromServerResponse(e,t):"totpInfo"in t?rE._fromServerResponse(e,t):yt(e,"internal-error")}},nE=class n extends ho{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},rE=class n extends ho{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function bg(n,e,t){var r;L(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),L(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(L(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(L(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function kE(n){return m(this,null,function*(){let e=Ge(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function OE(n,e,t){return m(this,null,function*(){let r=Ge(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&bg(r,i,t),yield Jl(r,i,"getOobCode",B3)})}function LE(n,e,t){return m(this,null,function*(){yield Sk(B(n),{oobCode:e,newPassword:t}).catch(r=>m(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&kE(n),r}))})}function FE(n,e){return m(this,null,function*(){yield F3(B(n),{oobCode:e})})}function Cg(n,e){return m(this,null,function*(){let t=B(n),r=yield Sk(t,{oobCode:e}),i=r.requestType;switch(L(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":L(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":L(r.mfaInfo,t,"internal-error");default:L(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=ho._fromServerResponse(Ge(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}})}function VE(n,e){return m(this,null,function*(){let{data:t}=yield Cg(B(n),e);return t.email})}function UE(n,e,t){return m(this,null,function*(){if(Je(n.app))return Promise.reject(Pt(n));let r=Ge(n),o=yield Jl(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ak).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&kE(n),c}),a=yield gr._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function BE(n,e,t){return Je(n.app)?Promise.reject(Pt(n)):nc(B(n),ad.credential(e,t)).catch(r=>m(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&kE(n),r}))}function jE(n,e,t){return m(this,null,function*(){let r=Ge(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){L(a.handleCodeInApp,r,"argument-error"),a&&bg(r,o,a)}s(i,t),yield Jl(r,i,"getOobCode",j3)})}function $E(n,e){let t=Zl.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}function HE(n,e,t){return m(this,null,function*(){if(Je(n.app))return Promise.reject(Pt(n));let r=B(n),i=ad.credentialWithLink(e,t||Wl());return L(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),nc(r,i)})}function n6(n,e){return m(this,null,function*(){return st(n,"POST","/v1/accounts:createAuthUri",it(n,e))})}function qE(n,e){return m(this,null,function*(){let t=bE()?Wl():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=yield n6(B(n),r);return i||[]})}function zE(n,e){return m(this,null,function*(){let t=B(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&bg(t.auth,i,e);let{email:s}=yield U3(t.auth,i);s!==n.email&&(yield n.reload())})}function GE(n,e,t){return m(this,null,function*(){let r=B(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield n.getIdToken(),newEmail:e};t&&bg(r.auth,s,t);let{email:o}=yield $3(r.auth,s);o!==n.email&&(yield n.reload())})}function r6(n,e){return m(this,null,function*(){return st(n,"POST","/v1/accounts:update",e)})}function WE(r,i){return m(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=B(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield vi(s,r6(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let u=s.providerData.find(({providerId:d})=>d==="password");u&&(u.displayName=s.displayName,u.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function KE(n,e){let t=B(n);return Je(t.auth.app)?Promise.reject(Pt(t.auth)):Mk(t,e,null)}function QE(n,e){return Mk(B(n),null,e)}function Mk(n,e,t){return m(this,null,function*(){let{auth:r}=n,s={idToken:yield n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=yield vi(n,O3(r,s));yield n._updateTokensIfNecessary(o,!0)})}function i6(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=gg(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new ns(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new iE(s,i);case"github.com":return new sE(s,i);case"google.com":return new oE(s,i);case"twitter.com":return new aE(s,i,n.screenName||null);case"custom":case"anonymous":return new ns(s,null);default:return new ns(s,r,i)}}var ns=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},cg=class extends ns{constructor(e,t,r,i){super(e,t,r),this.username=i}},iE=class extends ns{constructor(e,t){super(e,"facebook.com",t)}},sE=class extends cg{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},oE=class extends ns{constructor(e,t){super(e,"google.com",t)}},aE=class extends cg{constructor(e,t,r){super(e,"twitter.com",t,r)}};function YE(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:i6(t)}var ug=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var cE=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=Ge(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>ho._fromServerResponse(r,a));L(i.mfaPendingCredential,r,"internal-error");let o=ug._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,a=>m(this,null,function*(){let c=yield a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let u=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let d=yield gr._fromIdTokenResponse(r,t.operationType,u);return yield r._updateCurrentUser(d.user),d;case"reauthenticate":return L(t.user,r,"internal-error"),gr._forOperation(t.user,t.operationType,u);default:yt(r,"internal-error")}}))}resolveSignIn(e){return m(this,null,function*(){let t=e;return this.signInResolver(t)})}};function JE(n,e){var t;let r=B(n),i=e;return L(e.customData.operationType,r,"argument-error"),L((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),cE._fromError(r,i)}function s6(n,e){return st(n,"POST","/v2/accounts/mfaEnrollment:start",it(n,e))}function o6(n,e){return st(n,"POST","/v2/accounts/mfaEnrollment:finalize",it(n,e))}function a6(n,e){return st(n,"POST","/v2/accounts/mfaEnrollment:withdraw",it(n,e))}var uE=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>ho._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}getSession(){return m(this,null,function*(){return ug._fromIdtoken(yield this.user.getIdToken(),this.user)})}enroll(e,t){return m(this,null,function*(){let r=e,i=yield this.getSession(),s=yield vi(this.user,r._process(this.user.auth,i,t));return yield this.user._updateTokensIfNecessary(s),this.user.reload()})}unenroll(e){return m(this,null,function*(){let t=typeof e=="string"?e:e.uid,r=yield this.user.getIdToken();try{let i=yield vi(this.user,a6(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),yield this.user._updateTokensIfNecessary(i),yield this.user.reload()}catch(i){throw i}})}},GI=new WeakMap;function XE(n){let e=B(n);return GI.has(e)||GI.set(e,uE._fromUser(e)),GI.get(e)}var lg="__sak";var dg=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(lg,"1"),this.storage.removeItem(lg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function c6(){let n=Ue();return DE(n)||go(n)}var u6=1e3,l6=10,d6=(()=>{class n extends dg{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=c6()&&T3(),this.fallbackToPolling=bk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}let i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(i);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);E3()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,l6):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},u6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return m(this,null,function*(){yield Tr(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return m(this,null,function*(){let r=yield Tr(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return m(this,null,function*(){yield Tr(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),rc=d6;var h6=(()=>{class n extends dg{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),jr=h6;function f6(n){return Promise.all(n.map(e=>m(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var p6=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return m(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>m(this,null,function*(){return d(r.origin,o)})),u=yield f6(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:u})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function mo(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var lE=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return m(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let u=mo("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let g=h;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(g.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function mt(){return window}function g6(n){mt().location.href=n}function ZE(){return typeof mt().WorkerGlobalScope<"u"&&typeof mt().importScripts=="function"}function m6(){return m(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function _6(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function y6(){return ZE()?self:null}var kk="firebaseLocalStorageDb",v6=1,hg="firebaseLocalStorage",Ok="fbase_key",fo=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Dg(n,e){return n.transaction([hg],e?"readwrite":"readonly").objectStore(hg)}function w6(){let n=indexedDB.deleteDatabase(kk);return new fo(n).toPromise()}function dE(){let n=indexedDB.open(kk,v6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(hg,{keyPath:Ok})}catch(i){t(i)}}),n.addEventListener("success",()=>m(this,null,function*(){let r=n.result;r.objectStoreNames.contains(hg)?e(r):(r.close(),yield w6(),e(yield dE()))}))})}function rk(n,e,t){return m(this,null,function*(){let r=Dg(n,!0).put({[Ok]:e,value:t});return new fo(r).toPromise()})}function I6(n,e){return m(this,null,function*(){let t=Dg(n,!1).get(e),r=yield new fo(t).toPromise();return r===void 0?null:r.value})}function ik(n,e){let t=Dg(n,!0).delete(e);return new fo(t).toPromise()}var E6=800,T6=3,b6=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return m(this,null,function*(){return this.db?this.db:(this.db=yield dE(),this.db)})}_withRetries(t){return m(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>T6)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return m(this,null,function*(){return ZE()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return m(this,null,function*(){this.receiver=p6._getInstance(y6()),this.receiver._subscribe("keyChanged",(t,r)=>m(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>m(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return m(this,null,function*(){var t,r;if(this.activeServiceWorker=yield m6(),!this.activeServiceWorker)return;this.sender=new lE(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return m(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||_6()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return m(this,null,function*(){try{if(!indexedDB)return!1;let t=yield dE();return yield rk(t,lg,"1"),yield ik(t,lg),!0}catch{}return!1})}_withPendingWrite(t){return m(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return m(this,null,function*(){return this._withPendingWrite(()=>m(this,null,function*(){return yield this._withRetries(i=>rk(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return m(this,null,function*(){let r=yield this._withRetries(i=>I6(i,t));return this.localCache[t]=r,r})}_remove(t){return m(this,null,function*(){return this._withPendingWrite(()=>m(this,null,function*(){return yield this._withRetries(r=>ik(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return m(this,null,function*(){let t=yield this._withRetries(s=>{let o=Dg(s,!1).getAll();return new fo(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>m(this,null,function*(){return this._poll()}),E6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),_o=b6;function C6(n,e){return st(n,"POST","/v2/accounts/mfaSignIn:start",it(n,e))}function D6(n,e){return st(n,"POST","/v2/accounts/mfaSignIn:finalize",it(n,e))}var S6=500,A6=6e4,tg=1e12,hE=class{constructor(e){this.auth=e,this.counter=tg,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new fE(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||tg;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||tg;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}execute(e){return m(this,null,function*(){var t;let r=e||tg;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""})}},fE=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;L(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=R6(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},A6)},S6))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function R6(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var WI=Ck("rcb"),N6=new co(3e4,6e4),pE=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=mt().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return L(x6(t),e,"argument-error"),this.shouldResolveImmediately(t)&&QM(mt().grecaptcha)?Promise.resolve(mt().grecaptcha):new Promise((r,i)=>{let s=mt().setTimeout(()=>{i(_t(e,"network-request-failed"))},N6.get());mt()[WI]=()=>{mt().clearTimeout(s),delete mt()[WI];let a=mt().grecaptcha;if(!a||!QM(a)){i(_t(e,"internal-error"));return}let c=a.render;a.render=(u,d)=>{let h=c(u,d);return this.counter++,h},this.hostLanguage=t,r(a)};let o=`${S3()}?${_i({onload:WI,render:"explicit",hl:t})}`;AE(o).catch(()=>{clearTimeout(s),i(_t(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=mt().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function x6(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var gE=class{load(e){return m(this,null,function*(){return new hE(e)})}clearedOneInstance(){}};var Lk="recaptcha",P6={theme:"light",type:"image"},td=class{constructor(e,t,r=Object.assign({},P6)){this.parameters=r,this.type=Lk,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ge(e),this.isInvisible=this.parameters.size==="invisible",L(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;L(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new gE:new pE,this.validateStartingState()}verify(){return m(this,null,function*(){this.assertNotDestroyed();let e=yield this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){L(!this.parameters.sitekey,this.auth,"argument-error"),L(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),L(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=mt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){L(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){return m(this,null,function*(){if(yield this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId})}init(){return m(this,null,function*(){L(bE()&&!ZE(),this.auth,"internal-error"),yield M6(),this.recaptcha=yield this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=yield h3(this.auth);L(e,this.auth,"internal-error"),this.parameters.sitekey=e})}getAssertedRecaptcha(){return L(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function M6(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var nd=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=Xa._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};function eT(n,e,t){return m(this,null,function*(){if(Je(n.app))return Promise.reject(Pt(n));let r=Ge(n),i=yield Sg(r,e,B(t));return new nd(i,s=>nc(r,s))})}function tT(n,e,t){return m(this,null,function*(){let r=B(n);yield Ig(!1,r,"phone");let i=yield Sg(r.auth,e,B(t));return new nd(i,s=>Eg(r,s))})}function nT(n,e,t){return m(this,null,function*(){let r=B(n);if(Je(r.auth.app))return Promise.reject(Pt(r.auth));let i=yield Sg(r.auth,e,B(t));return new nd(i,s=>Tg(r,s))})}function Sg(n,e,t){return m(this,null,function*(){var r;let i=yield t.verify();try{L(typeof i=="string",n,"argument-error"),L(t.type===Lk,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return L(o.type==="enroll",n,"internal-error"),(yield s6(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{L(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return L(a,n,"missing-multi-factor-info"),(yield C6(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=yield G3(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}})}function rT(n,e){return m(this,null,function*(){let t=B(n);if(Je(t.auth.app))return Promise.reject(Pt(t.auth));yield PE(t,e)})}var yo=(()=>{class n{constructor(t){this.providerId=n.PROVIDER_ID,this.auth=Ge(t)}verifyPhoneNumber(t,r){return Sg(this.auth,t,B(r))}static credential(t,r){return Xa._fromVerification(t,r)}static credentialFromResult(t){let r=t;return n.credentialFromTaggedObject(r)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{phoneNumber:r,temporaryProof:i}=t;return r&&i?Xa._fromTokenResponse(r,i):null}}n.PROVIDER_ID="phone",n.PHONE_SIGN_IN_METHOD="phone";return n})();function vo(n,e){return e?Yt(e):(L(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var rd=class extends Br{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return yi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return yi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return yi(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function k6(n){return Pk(n.auth,new rd(n),n.bypassAuthState)}function O6(n){let{auth:e,user:t}=n;return L(t,e,"internal-error"),xk(t,new rd(n),n.bypassAuthState)}function L6(n){return m(this,null,function*(){let{auth:e,user:t}=n;return L(t,e,"internal-error"),PE(t,new rd(n),n.bypassAuthState)})}var fg=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>m(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return m(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return k6;case"linkViaPopup":case"linkViaRedirect":return L6;case"reauthViaPopup":case"reauthViaRedirect":return O6;default:yt(this.auth,"internal-error")}}resolve(e){Wn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Wn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var F6=new co(2e3,1e4);function iT(n,e,t){return m(this,null,function*(){if(Je(n.app))return Promise.reject(_t(n,"operation-not-supported-in-this-environment"));let r=Ge(n);ec(n,e,pr);let i=vo(r,t);return new aT(r,"signInViaPopup",e,i).executeNotNull()})}function sT(n,e,t){return m(this,null,function*(){let r=B(n);if(Je(r.auth.app))return Promise.reject(_t(r.auth,"operation-not-supported-in-this-environment"));ec(r.auth,e,pr);let i=vo(r.auth,t);return new aT(r.auth,"reauthViaPopup",e,i,r).executeNotNull()})}function oT(n,e,t){return m(this,null,function*(){let r=B(n);ec(r.auth,e,pr);let i=vo(r.auth,t);return new aT(r.auth,"linkViaPopup",e,i,r).executeNotNull()})}var aT=(()=>{class n extends fg{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return m(this,null,function*(){let t=yield this.execute();return L(t,this.auth,"internal-error"),t})}onExecution(){return m(this,null,function*(){Wn(this.filter.length===1,"Popup operations only handle one event");let t=mo();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(_t(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(_t(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_t(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,F6.get())};t()}}n.currentPopupAction=null;return n})(),V6="pendingRedirect",Gl=new Map,mE=class n extends fg{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return m(this,null,function*(){let e=Gl.get(this.auth._key());if(!e){try{let r=(yield U6(this.resolver,this.auth))?yield Tr(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Gl.set(this.auth._key(),e)}return this.bypassAuthState||Gl.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return m(this,null,function*(){if(e.type==="signInViaRedirect")return Tr(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Tr(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return m(this,null,function*(){})}cleanUp(){}};function U6(n,e){return m(this,null,function*(){let t=Uk(e),r=Vk(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function cT(n,e){return m(this,null,function*(){return Vk(n)._set(Uk(e),"true")})}function Fk(){Gl.clear()}function ic(n,e){Gl.set(n._key(),e)}function Vk(n){return Yt(n._redirectPersistence)}function Uk(n){return Ur(V6,n.config.apiKey,n.name)}function uT(n,e,t){return B6(n,e,t)}function B6(n,e,t){return m(this,null,function*(){if(Je(n.app))return Promise.reject(Pt(n));let r=Ge(n);ec(n,e,pr),yield r._initializationPromise;let i=vo(r,t);return yield cT(i,r),i._openRedirect(r,e,"signInViaRedirect")})}function lT(n,e,t){return j6(n,e,t)}function j6(n,e,t){return m(this,null,function*(){let r=B(n);if(ec(r.auth,e,pr),Je(r.auth.app))return Promise.reject(Pt(r.auth));yield r.auth._initializationPromise;let i=vo(r.auth,t);yield cT(i,r.auth);let s=yield Bk(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)})}function dT(n,e,t){return $6(n,e,t)}function $6(n,e,t){return m(this,null,function*(){let r=B(n);ec(r.auth,e,pr),yield r.auth._initializationPromise;let i=vo(r.auth,t);yield Ig(!1,r,e.providerId),yield cT(i,r.auth);let s=yield Bk(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)})}function hT(n,e){return m(this,null,function*(){return yield Ge(n)._initializationPromise,wo(n,e,!1)})}function wo(n,e,t=!1){return m(this,null,function*(){if(Je(n.app))return Promise.reject(Pt(n));let r=Ge(n),i=vo(r,e),o=yield new mE(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}function Bk(n){return m(this,null,function*(){let e=mo(`${n.uid}:::`);return n._redirectEventId=e,yield n.auth._setRedirectUser(n),yield n.auth._persistUserIfCurrent(n),e})}var H6=10*60*1e3,id=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!q6(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!jk(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(_t(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=H6&&this.cachedEventUids.clear(),this.cachedEventUids.has(sk(e))}saveEventToCache(e){this.cachedEventUids.add(sk(e)),this.lastProcessedEventTime=Date.now()}};function sk(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function jk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function q6(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return jk(n);default:return!1}}function fT(t){return m(this,arguments,function*(n,e={}){return st(n,"GET","/v1/projects",e)})}var z6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,G6=/^https?/;function W6(n){return m(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield fT(n);for(let t of e)try{if(K6(t))return}catch{}yt(n,"unauthorized-domain")})}function K6(n){let e=Wl(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!G6.test(t))return!1;if(z6.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var Q6=new co(3e4,6e4);function ok(){let n=mt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Y6(n){return new Promise((e,t)=>{var r,i,s;function o(){ok(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ok(),t(_t(n,"network-request-failed"))},timeout:Q6.get()})}if(!((i=(r=mt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=mt().gapi)===null||s===void 0)&&s.load)o();else{let a=Ck("iframefcb");return mt()[a]=()=>{gapi.load?o():t(_t(n,"network-request-failed"))},AE(`${R3()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw rg=null,e})}var rg=null;function J6(n){return rg=rg||Y6(n),rg}var X6=new co(5e3,15e3),Z6="__/auth/iframe",e9="emulator/auth/iframe",t9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},n9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function r9(n){let e=n.config;L(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?CE(e,e9):`https://${n.config.authDomain}/${Z6}`,r={apiKey:e.apiKey,appName:n.name,v:un},i=n9.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${_i(r).slice(1)}`}function i9(n){return m(this,null,function*(){let e=yield J6(n),t=mt().gapi;return L(t,n,"internal-error"),e.open({where:document.body,url:r9(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:t9,dontclear:!0},r=>new Promise((i,s)=>m(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=_t(n,"network-request-failed"),a=mt().setTimeout(()=>{s(o)},X6.get());function c(){mt().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var s9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},o9=500,a9=600,c9="_blank",u9="http://localhost",sd=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function l9(n,e,t,r=o9,i=a9){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},s9),{width:r.toString(),height:i.toString(),top:s,left:o}),u=Ue().toLowerCase();t&&(a=vk(u)?c9:t),yk(u)&&(e=e||u9,c.scrollbars="yes");let d=Object.entries(c).reduce((g,[_,w])=>`${g}${_}=${w},`,"");if(I3(u)&&a!=="_self")return d9(e||"",a),new sd(null);let h=window.open(e||"",a,d);L(h,n,"popup-blocked");try{h.focus()}catch{}return new sd(h)}function d9(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var h9="__/auth/handler",f9="emulator/auth/handler",p9=encodeURIComponent("fac");function pg(n,e,t,r,i,s){return m(this,null,function*(){L(n.config.authDomain,n,"auth-domain-config-required"),L(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:un,eventId:i};if(e instanceof pr){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Ga(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(s||{}))o[d]=h}if(e instanceof is){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),u=c?`#${p9}=${encodeURIComponent(c)}`:"";return`${g9(n)}?${_i(a).slice(1)}${u}`})}function g9({config:n}){return n.emulator?CE(n,f9):`https://${n.authDomain}/${h9}`}var KI="webStorageSupport",_E=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=jr,this._completeRedirectFn=wo,this._overrideRedirectResult=ic}_openPopup(e,t,r,i){return m(this,null,function*(){var s;Wn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield pg(e,t,r,Wl(),i);return l9(e,o,mo())})}_openRedirect(e,t,r,i){return m(this,null,function*(){yield this._originValidation(e);let s=yield pg(e,t,r,Wl(),i);return g6(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Wn(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return m(this,null,function*(){let t=yield i9(e),r=new id(e);return t.register("authEvent",i=>(L(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(KI,{type:KI},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[KI];o!==void 0&&t(!!o),yt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=W6(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return bk()||DE()||go()}},pT=_E,yE=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Vr("unexpected MultiFactorSessionType")}}},vE=class n extends yE{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return o6(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return D6(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},gT=(()=>{class n{constructor(){}static assertion(t){return vE._fromCredential(t)}}return n.FACTOR_ID="phone",n})();var ak="@firebase/auth",ck="1.7.4";var wE=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return m(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){L(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function m9(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _9(n){cn(new Le("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;L(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:SE(n)},u=new og(r,i,s,c);return P3(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),cn(new Le("auth-internal",e=>{let t=Ge(e.getProvider("auth").getImmediate());return(r=>new wE(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),lt(ak,ck,m9(n)),lt(ak,ck,"esm2017")}var y9=5*60,Bie=EM("authIdTokenMaxAge")||y9;function v9(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}D3({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=_t("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",v9().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_9("Browser");function Io(){return window}var w9=2e3;function I9(n,e,t){return m(this,null,function*(){var r;let{BuildInfo:i}=Io();Wn(e.sessionId,"AuthEvent did not contain a session ID");let s=yield D9(e.sessionId),o={};return go()?o.ibi=i.packageName:tc()?o.apn=i.packageName:yt(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,pg(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)})}function E9(n){return m(this,null,function*(){let{BuildInfo:e}=Io(),t={};go()?t.iosBundleId=e.packageName:tc()?t.androidPackageName=e.packageName:yt(n,"operation-not-supported-in-this-environment"),yield fT(n,t)})}function T9(n){let{cordova:e}=Io();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,Tk()?"_blank":"_system","location=yes"),t(i)})})}function b9(n,e,t){return m(this,null,function*(){let{cordova:r}=Io(),i=()=>{};try{yield new Promise((s,o)=>{let a=null;function c(){var h;s();let g=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof g=="function"&&g(),typeof t?.close=="function"&&t.close()}function u(){a||(a=window.setTimeout(()=>{o(_t(n,"redirect-cancelled-by-user"))},w9))}function d(){document?.visibilityState==="visible"&&u()}e.addPassiveListener(c),document.addEventListener("resume",u,!1),tc()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}})}function C9(n){var e,t,r,i,s,o,a,c,u,d;let h=Io();L(typeof((e=h?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),L(typeof((t=h?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),L(typeof((s=(i=(r=h?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),L(typeof((c=(a=(o=h?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),L(typeof((d=(u=h?.cordova)===null||u===void 0?void 0:u.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function D9(n){return m(this,null,function*(){let e=S9(n),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")})}function S9(n){if(Wn(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var A9=20,mT=class extends id{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}initialized(){return m(this,null,function*(){yield this.initPromise})}};function R9(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:P9(),postBody:null,tenantId:n.tenantId,error:_t(n,"no-auth-event")}}function N9(n,e){return _T()._set(yT(n),e)}function $k(n){return m(this,null,function*(){let e=yield _T()._get(yT(n));return e&&(yield _T()._remove(yT(n))),e})}function x9(n,e){var t,r;let i=k9(e);if(i.includes("/__/auth/callback")){let s=Ag(i),o=s.firebaseError?M9(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?_t(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function P9(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<A9;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function _T(){return Yt(rc)}function yT(n){return Ur("authEvent",n.config.apiKey,n.name)}function M9(n){try{return JSON.parse(n)}catch{return null}}function k9(n){let e=Ag(n),t=e.link?decodeURIComponent(e.link):void 0,r=Ag(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Ag(i).link||i||r||t||n}function Ag(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return Xi(t.join("?"))}var O9=500,vT=class{constructor(){this._redirectPersistence=jr,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=wo,this._overrideRedirectResult=ic}_initialize(e){return m(this,null,function*(){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new mT(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r})}_openPopup(e){yt(e,"operation-not-supported-in-this-environment")}_openRedirect(e,t,r,i){return m(this,null,function*(){C9(e);let s=yield this._initialize(e);yield s.initialized(),s.resetRedirect(),Fk(),yield this._originValidation(e);let o=R9(e,r,i);yield N9(e,o);let a=yield I9(e,o,t),c=yield T9(a);return b9(e,s,c)})}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=E9(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Io(),o=setTimeout(()=>m(this,null,function*(){yield $k(e),t.onEvent(Hk())}),O9),a=d=>m(this,null,function*(){clearTimeout(o);let h=yield $k(e),g=null;h&&d?.url&&(g=x9(h,d.url)),t.onEvent(g||Hk())});typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,u=`${s.packageName.toLowerCase()}://`;Io().handleOpenURL=d=>m(this,null,function*(){if(d.toLowerCase().startsWith(u)&&a({url:d}),typeof c=="function")try{c(d)}catch(h){console.error(h)}})}},qk=vT;function Hk(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:_t("no-auth-event")}}function zk(n,e){Ge(n)._logFramework(e)}var F9="@firebase/auth-compat",V9="0.5.9";var U9=1e3;function ld(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function B9(){return ld()==="http:"||ld()==="https:"}function Kk(n=Ue()){return!!((ld()==="file:"||ld()==="ionic:"||ld()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function j9(){return io()||zp()}function $9(){return Kp()&&document?.documentMode===11}function H9(n=Ue()){return/Edge\/\d+/.test(n)}function q9(n=Ue()){return $9()||H9(n)}function Qk(){try{let n=self.localStorage,e=mo();if(n)return n.setItem(e,"1"),n.removeItem(e),q9()?Qi():!0}catch{return CT()&&Qi()}return!1}function CT(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function wT(){return(B9()||Wp()||Kk())&&!j9()&&Qk()&&!CT()}function Yk(){return Kk()&&typeof document<"u"}function z9(){return m(this,null,function*(){return Yk()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},U9);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1})}function G9(){return typeof window<"u"?window:null}var xn={LOCAL:"local",NONE:"none",SESSION:"session"},cd=L,Jk="persistence";function W9(n,e){if(cd(Object.values(xn).includes(e),n,"invalid-persistence-type"),io()){cd(e!==xn.SESSION,n,"unsupported-persistence-type");return}if(zp()){cd(e===xn.NONE,n,"unsupported-persistence-type");return}if(CT()){cd(e===xn.NONE||e===xn.LOCAL&&Qi(),n,"unsupported-persistence-type");return}cd(e===xn.NONE||Qk(),n,"unsupported-persistence-type")}function IT(n){return m(this,null,function*(){yield n._initializationPromise;let e=Xk(),t=Ur(Jk,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())})}function K9(n,e){let t=Xk();if(!t)return[];let r=Ur(Jk,n,e);switch(t.getItem(r)){case xn.NONE:return[rs];case xn.LOCAL:return[_o,jr];case xn.SESSION:return[jr];default:return[]}}function Xk(){var n;try{return((n=G9())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var Q9=L,$r=class{constructor(){this.browserResolver=Yt(pT),this.cordovaResolver=Yt(qk),this.underlyingResolver=null,this._redirectPersistence=jr,this._completeRedirectFn=wo,this._overrideRedirectResult=ic}_initialize(e){return m(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)})}_openPopup(e,t,r,i){return m(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)})}_openRedirect(e,t,r,i){return m(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)})}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return Yk()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Q9(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){return m(this,null,function*(){if(this.underlyingResolver)return;let e=yield z9();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver})}};function Zk(n){return n.unwrap()}function Y9(n){return n.wrapped()}function J9(n){return eO(n)}function X9(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new TT(n,JE(n,e))}else if(r){let i=eO(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function eO(n){let{_tokenResponse:e}=n instanceof rt?n.customData:n;if(!e)return null;if(!(n instanceof rt)&&"temporaryProof"in e&&"phoneNumber"in e)return yo.credentialFromResult(n);let t=e.providerId;if(!t||t===po.PASSWORD)return null;let r;switch(t){case po.GOOGLE:r=yg;break;case po.FACEBOOK:r=_g;break;case po.GITHUB:r=vg;break;case po.TWITTER:r=wg;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?lo._create(t,a):fr._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new Za(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof rt?r.credentialFromError(n):r.credentialFromResult(n)}function En(n,e){return e.catch(t=>{throw t instanceof rt&&X9(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:J9(t),additionalUserInfo:YE(t),user:sc.getOrCreate(i)}})}function ET(n,e){return m(this,null,function*(){let t=yield e;return{verificationId:t.verificationId,confirm:r=>En(n,t.confirm(r))}})}var TT=class{constructor(e,t){this.resolver=t,this.auth=Y9(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return En(Zk(this.auth),this.resolver.resolveSignIn(e))}};var sc=class n{constructor(e){this._delegate=e,this.multiFactor=XE(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}linkWithCredential(e){return m(this,null,function*(){return En(this.auth,Eg(this._delegate,e))})}linkWithPhoneNumber(e,t){return m(this,null,function*(){return ET(this.auth,tT(this._delegate,e,t))})}linkWithPopup(e){return m(this,null,function*(){return En(this.auth,oT(this._delegate,e,$r))})}linkWithRedirect(e){return m(this,null,function*(){return yield IT(Ge(this.auth)),dT(this._delegate,e,$r)})}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}reauthenticateWithCredential(e){return m(this,null,function*(){return En(this.auth,Tg(this._delegate,e))})}reauthenticateWithPhoneNumber(e,t){return ET(this.auth,nT(this._delegate,e,t))}reauthenticateWithPopup(e){return En(this.auth,sT(this._delegate,e,$r))}reauthenticateWithRedirect(e){return m(this,null,function*(){return yield IT(Ge(this.auth)),lT(this._delegate,e,$r)})}sendEmailVerification(e){return zE(this._delegate,e)}unlink(e){return m(this,null,function*(){return yield xE(this._delegate,e),this})}updateEmail(e){return KE(this._delegate,e)}updatePassword(e){return QE(this._delegate,e)}updatePhoneNumber(e){return rT(this._delegate,e)}updateProfile(e){return WE(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return GE(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};sc.USER_MAP=new WeakMap;var ud=L,Gk=(()=>{class n{constructor(t,r){if(this.app=t,r.isInitialized()){this._delegate=r.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:i}=t.options;ud(i,"invalid-api-key",{appName:t.name}),ud(i,"invalid-api-key",{appName:t.name});let s=typeof window<"u"?$r:void 0;this._delegate=r.initialize({options:{persistence:Z9(i,t.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(IE),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?sc.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,r){RE(this._delegate,t,r)}applyActionCode(t){return FE(this._delegate,t)}checkActionCode(t){return Cg(this._delegate,t)}confirmPasswordReset(t,r){return LE(this._delegate,t,r)}createUserWithEmailAndPassword(t,r){return m(this,null,function*(){return En(this._delegate,UE(this._delegate,t,r))})}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return qE(this._delegate,t)}isSignInWithEmailLink(t){return $E(this._delegate,t)}getRedirectResult(){return m(this,null,function*(){ud(wT(),this._delegate,"operation-not-supported-in-this-environment");let t=yield hT(this._delegate,$r);return t?En(this._delegate,Promise.resolve(t)):{credential:null,user:null}})}addFrameworkForLogging(t){zk(this._delegate,t)}onAuthStateChanged(t,r,i){let{next:s,error:o,complete:a}=Wk(t,r,i);return this._delegate.onAuthStateChanged(s,o,a)}onIdTokenChanged(t,r,i){let{next:s,error:o,complete:a}=Wk(t,r,i);return this._delegate.onIdTokenChanged(s,o,a)}sendSignInLinkToEmail(t,r){return jE(this._delegate,t,r)}sendPasswordResetEmail(t,r){return OE(this._delegate,t,r||void 0)}setPersistence(t){return m(this,null,function*(){W9(this._delegate,t);let r;switch(t){case xn.SESSION:r=jr;break;case xn.LOCAL:r=(yield Yt(_o)._isAvailable())?_o:rc;break;case xn.NONE:r=rs;break;default:return yt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)})}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return En(this._delegate,NE(this._delegate))}signInWithCredential(t){return En(this._delegate,nc(this._delegate,t))}signInWithCustomToken(t){return En(this._delegate,ME(this._delegate,t))}signInWithEmailAndPassword(t,r){return En(this._delegate,BE(this._delegate,t,r))}signInWithEmailLink(t,r){return En(this._delegate,HE(this._delegate,t,r))}signInWithPhoneNumber(t,r){return ET(this._delegate,eT(this._delegate,t,r))}signInWithPopup(t){return m(this,null,function*(){return ud(wT(),this._delegate,"operation-not-supported-in-this-environment"),En(this._delegate,iT(this._delegate,t,$r))})}signInWithRedirect(t){return m(this,null,function*(){return ud(wT(),this._delegate,"operation-not-supported-in-this-environment"),yield IT(this._delegate),uT(this._delegate,t,$r)})}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return VE(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=xn,n})();function Wk(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&sc.getOrCreate(o)),error:e,complete:t}}function Z9(n,e){let t=K9(n,e);if(typeof self<"u"&&!t.includes(_o)&&t.push(_o),typeof window<"u")for(let r of[rc,jr])t.includes(r)||t.push(r);return t.includes(rs)||t.push(rs),t}var dd=class{constructor(){this.providerId="phone",this._delegate=new yo(Zk(Ne.auth()))}static credential(e,t){return yo.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};dd.PHONE_SIGN_IN_METHOD=yo.PHONE_SIGN_IN_METHOD;dd.PROVIDER_ID=yo.PROVIDER_ID;var e5=L,bT=class{constructor(e,t,r=Ne.app()){var i;e5((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new td(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var t5="auth-compat";function n5(n){n.INTERNAL.registerComponent(new Le(t5,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Gk(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ss.EMAIL_SIGNIN,PASSWORD_RESET:ss.PASSWORD_RESET,RECOVER_EMAIL:ss.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:ss.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:ss.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:ss.VERIFY_EMAIL}},EmailAuthProvider:ad,FacebookAuthProvider:_g,GithubAuthProvider:vg,GoogleAuthProvider:yg,OAuthProvider:Za,SAMLAuthProvider:ed,PhoneAuthProvider:dd,PhoneMultiFactorGenerator:gT,RecaptchaVerifier:bT,TwitterAuthProvider:wg,Auth:Gk,AuthCredential:Br,Error:rt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(F9,V9)}n5(Ne);var tO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},nO={};var os,DT;(function(){var n;function e(T,v){function I(){}I.prototype=v.prototype,T.D=v.prototype,T.prototype=new I,T.prototype.constructor=T,T.C=function(b,D,R){for(var E=Array(arguments.length-2),oi=2;oi<arguments.length;oi++)E[oi-2]=arguments[oi];return v.prototype[D].apply(b,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,v,I){I||(I=0);var b=Array(16);if(typeof v=="string")for(var D=0;16>D;++D)b[D]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(D=0;16>D;++D)b[D]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=T.g[0],I=T.g[1],D=T.g[2];var R=T.g[3],E=v+(R^I&(D^R))+b[0]+3614090360&4294967295;v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[1]+3905402710&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[2]+606105819&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[3]+3250441966&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+b[4]+4118548399&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[5]+1200080426&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[6]+2821735955&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[7]+4249261313&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+b[8]+1770035416&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[9]+2336552879&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[10]+4294925233&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[11]+2304563134&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(R^I&(D^R))+b[12]+1804603682&4294967295,v=I+(E<<7&4294967295|E>>>25),E=R+(D^v&(I^D))+b[13]+4254626195&4294967295,R=v+(E<<12&4294967295|E>>>20),E=D+(I^R&(v^I))+b[14]+2792965006&4294967295,D=R+(E<<17&4294967295|E>>>15),E=I+(v^D&(R^v))+b[15]+1236535329&4294967295,I=D+(E<<22&4294967295|E>>>10),E=v+(D^R&(I^D))+b[1]+4129170786&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[6]+3225465664&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[11]+643717713&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[0]+3921069994&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+b[5]+3593408605&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[10]+38016083&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[15]+3634488961&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[4]+3889429448&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+b[9]+568446438&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[14]+3275163606&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[3]+4107603335&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[8]+1163531501&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(D^R&(I^D))+b[13]+2850285829&4294967295,v=I+(E<<5&4294967295|E>>>27),E=R+(I^D&(v^I))+b[2]+4243563512&4294967295,R=v+(E<<9&4294967295|E>>>23),E=D+(v^I&(R^v))+b[7]+1735328473&4294967295,D=R+(E<<14&4294967295|E>>>18),E=I+(R^v&(D^R))+b[12]+2368359562&4294967295,I=D+(E<<20&4294967295|E>>>12),E=v+(I^D^R)+b[5]+4294588738&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[8]+2272392833&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[11]+1839030562&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[14]+4259657740&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+b[1]+2763975236&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[4]+1272893353&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[7]+4139469664&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[10]+3200236656&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+b[13]+681279174&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[0]+3936430074&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[3]+3572445317&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[6]+76029189&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(I^D^R)+b[9]+3654602809&4294967295,v=I+(E<<4&4294967295|E>>>28),E=R+(v^I^D)+b[12]+3873151461&4294967295,R=v+(E<<11&4294967295|E>>>21),E=D+(R^v^I)+b[15]+530742520&4294967295,D=R+(E<<16&4294967295|E>>>16),E=I+(D^R^v)+b[2]+3299628645&4294967295,I=D+(E<<23&4294967295|E>>>9),E=v+(D^(I|~R))+b[0]+4096336452&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[7]+1126891415&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[14]+2878612391&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[5]+4237533241&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+b[12]+1700485571&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[3]+2399980690&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[10]+4293915773&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[1]+2240044497&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+b[8]+1873313359&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[15]+4264355552&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[6]+2734768916&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[13]+1309151649&4294967295,I=D+(E<<21&4294967295|E>>>11),E=v+(D^(I|~R))+b[4]+4149444226&4294967295,v=I+(E<<6&4294967295|E>>>26),E=R+(I^(v|~D))+b[11]+3174756917&4294967295,R=v+(E<<10&4294967295|E>>>22),E=D+(v^(R|~I))+b[2]+718787259&4294967295,D=R+(E<<15&4294967295|E>>>17),E=I+(R^(D|~v))+b[9]+3951481745&4294967295,T.g[0]=T.g[0]+v&4294967295,T.g[1]=T.g[1]+(D+(E<<21&4294967295|E>>>11))&4294967295,T.g[2]=T.g[2]+D&4294967295,T.g[3]=T.g[3]+R&4294967295}r.prototype.u=function(T,v){v===void 0&&(v=T.length);for(var I=v-this.blockSize,b=this.B,D=this.h,R=0;R<v;){if(D==0)for(;R<=I;)i(this,T,R),R+=this.blockSize;if(typeof T=="string"){for(;R<v;)if(b[D++]=T.charCodeAt(R++),D==this.blockSize){i(this,b),D=0;break}}else for(;R<v;)if(b[D++]=T[R++],D==this.blockSize){i(this,b),D=0;break}}this.h=D,this.o+=v},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var v=1;v<T.length-8;++v)T[v]=0;var I=8*this.o;for(v=T.length-8;v<T.length;++v)T[v]=I&255,I/=256;for(this.u(T),T=Array(16),v=I=0;4>v;++v)for(var b=0;32>b;b+=8)T[I++]=this.g[v]>>>b&255;return T};function s(T,v){var I=a;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=v(T)}function o(T,v){this.h=v;for(var I=[],b=!0,D=T.length-1;0<=D;D--){var R=T[D]|0;b&&R==v||(I[D]=R,b=!1)}this.g=I}var a={};function c(T){return-128<=T&&128>T?s(T,function(v){return new o([v|0],0>v?-1:0)}):new o([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return h;if(0>T)return A(u(-T));for(var v=[],I=1,b=0;T>=I;b++)v[b]=T/I|0,I*=4294967296;return new o(v,0)}function d(T,v){if(T.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(T.charAt(0)=="-")return A(d(T.substring(1),v));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(v,8)),b=h,D=0;D<T.length;D+=8){var R=Math.min(8,T.length-D),E=parseInt(T.substring(D,D+R),v);8>R?(R=u(Math.pow(v,R)),b=b.j(R).add(u(E))):(b=b.j(I),b=b.add(u(E)))}return b}var h=c(0),g=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(C(this))return-A(this).m();for(var T=0,v=1,I=0;I<this.g.length;I++){var b=this.i(I);T+=(0<=b?b:4294967296+b)*v,v*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(w(this))return"0";if(C(this))return"-"+A(this).toString(T);for(var v=u(Math.pow(T,6)),I=this,b="";;){var D=z(I,v).g;I=O(I,D.j(v));var R=((0<I.g.length?I.g[0]:I.h)>>>0).toString(T);if(I=D,w(I))return R+b;for(;6>R.length;)R="0"+R;b=R+b}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function w(T){if(T.h!=0)return!1;for(var v=0;v<T.g.length;v++)if(T.g[v]!=0)return!1;return!0}function C(T){return T.h==-1}n.l=function(T){return T=O(this,T),C(T)?-1:w(T)?0:1};function A(T){for(var v=T.g.length,I=[],b=0;b<v;b++)I[b]=~T.g[b];return new o(I,~T.h).add(g)}n.abs=function(){return C(this)?A(this):this},n.add=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0,D=0;D<=v;D++){var R=b+(this.i(D)&65535)+(T.i(D)&65535),E=(R>>>16)+(this.i(D)>>>16)+(T.i(D)>>>16);b=E>>>16,R&=65535,E&=65535,I[D]=E<<16|R}return new o(I,I[I.length-1]&-2147483648?-1:0)};function O(T,v){return T.add(A(v))}n.j=function(T){if(w(this)||w(T))return h;if(C(this))return C(T)?A(this).j(A(T)):A(A(this).j(T));if(C(T))return A(this.j(A(T)));if(0>this.l(_)&&0>T.l(_))return u(this.m()*T.m());for(var v=this.g.length+T.g.length,I=[],b=0;b<2*v;b++)I[b]=0;for(b=0;b<this.g.length;b++)for(var D=0;D<T.g.length;D++){var R=this.i(b)>>>16,E=this.i(b)&65535,oi=T.i(D)>>>16,vu=T.i(D)&65535;I[2*b+2*D]+=E*vu,H(I,2*b+2*D),I[2*b+2*D+1]+=R*vu,H(I,2*b+2*D+1),I[2*b+2*D+1]+=E*oi,H(I,2*b+2*D+1),I[2*b+2*D+2]+=R*oi,H(I,2*b+2*D+2)}for(b=0;b<v;b++)I[b]=I[2*b+1]<<16|I[2*b];for(b=v;b<2*v;b++)I[b]=0;return new o(I,0)};function H(T,v){for(;(T[v]&65535)!=T[v];)T[v+1]+=T[v]>>>16,T[v]&=65535,v++}function F(T,v){this.g=T,this.h=v}function z(T,v){if(w(v))throw Error("division by zero");if(w(T))return new F(h,h);if(C(T))return v=z(A(T),v),new F(A(v.g),A(v.h));if(C(v))return v=z(T,A(v)),new F(A(v.g),v.h);if(30<T.g.length){if(C(T)||C(v))throw Error("slowDivide_ only works with positive integers.");for(var I=g,b=v;0>=b.l(T);)I=ie(I),b=ie(b);var D=W(I,1),R=W(b,1);for(b=W(b,2),I=W(I,2);!w(b);){var E=R.add(b);0>=E.l(T)&&(D=D.add(I),R=E),b=W(b,1),I=W(I,1)}return v=O(T,D.j(v)),new F(D,v)}for(D=h;0<=T.l(v);){for(I=Math.max(1,Math.floor(T.m()/v.m())),b=Math.ceil(Math.log(I)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),R=u(I),E=R.j(v);C(E)||0<E.l(T);)I-=b,R=u(I),E=R.j(v);w(R)&&(R=g),D=D.add(R),T=O(T,E)}return new F(D,T)}n.A=function(T){return z(this,T).h},n.and=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)&T.i(b);return new o(I,this.h&T.h)},n.or=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)|T.i(b);return new o(I,this.h|T.h)},n.xor=function(T){for(var v=Math.max(this.g.length,T.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)^T.i(b);return new o(I,this.h^T.h)};function ie(T){for(var v=T.g.length+1,I=[],b=0;b<v;b++)I[b]=T.i(b)<<1|T.i(b-1)>>>31;return new o(I,T.h)}function W(T,v){var I=v>>5;v%=32;for(var b=T.g.length-I,D=[],R=0;R<b;R++)D[R]=0<v?T.i(R+I)>>>v|T.i(R+I+1)<<32-v:T.i(R+I);return new o(D,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,DT=nO.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,os=nO.Integer=o}).apply(typeof tO<"u"?tO:typeof self<"u"?self:typeof window<"u"?window:{});var Rg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ii={};var ST,AT,oc,RT,hd,Ng,NT,xT,PT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,f,p){return l==Array.prototype||l==Object.prototype||(l[f]=p.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Rg=="object"&&Rg];for(var f=0;f<l.length;++f){var p=l[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(l,f){if(f)e:{var p=r;l=l.split(".");for(var y=0;y<l.length-1;y++){var S=l[y];if(!(S in p))break e;p=p[S]}l=l[l.length-1],y=p[l],f=f(y),f!=y&&f!=null&&e(p,l,{configurable:!0,writable:!0,value:f})}}function s(l,f){l instanceof String&&(l+="");var p=0,y=!1,S={next:function(){if(!y&&p<l.length){var x=p++;return{value:f(x,l[x]),done:!1}}return y=!0,{done:!0,value:void 0}}};return S[Symbol.iterator]=function(){return S},S}i("Array.prototype.values",function(l){return l||function(){return s(this,function(f,p){return p})}});var o=o||{},a=this||self;function c(l){var f=typeof l;return f=f!="object"?f:l?Array.isArray(l)?"array":f:"null",f=="array"||f=="object"&&typeof l.length=="number"}function u(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function d(l,f,p){return l.call.apply(l.bind,arguments)}function h(l,f,p){if(!l)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var S=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(S,y),l.apply(f,S)}}return function(){return l.apply(f,arguments)}}function g(l,f,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,g.apply(null,arguments)}function _(l,f){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),l.apply(this,y)}}function w(l,f){function p(){}p.prototype=f.prototype,l.aa=f.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(y,S,x){for(var U=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)U[Fe-2]=arguments[Fe];return f.prototype[S].apply(y,U)}}function C(l){let f=l.length;if(0<f){let p=Array(f);for(let y=0;y<f;y++)p[y]=l[y];return p}return[]}function A(l,f){for(let p=1;p<arguments.length;p++){let y=arguments[p];if(c(y)){let S=l.length||0,x=y.length||0;l.length=S+x;for(let U=0;U<x;U++)l[S+U]=y[U]}else l.push(y)}}class O{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function H(l){return/^[\s\xa0]*$/.test(l)}function F(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function z(l){return z[" "](l),l}z[" "]=function(){};var ie=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function W(l,f,p){for(let y in l)f.call(p,l[y],y,l)}function T(l,f){for(let p in l)f.call(void 0,l[p],p,l)}function v(l){let f={};for(let p in l)f[p]=l[p];return f}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(l,f){let p,y;for(let S=1;S<arguments.length;S++){y=arguments[S];for(p in y)l[p]=y[p];for(let x=0;x<I.length;x++)p=I[x],Object.prototype.hasOwnProperty.call(y,p)&&(l[p]=y[p])}}function D(l){var f=1;l=l.split(":");let p=[];for(;0<f&&l.length;)p.push(l.shift()),f--;return l.length&&p.push(l.join(":")),p}function R(l){a.setTimeout(()=>{throw l},0)}function E(){var l=X_;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class oi{constructor(){this.h=this.g=null}add(f,p){let y=vu.get();y.set(f,p),this.h?this.h.next=y:this.g=y,this.h=y}}var vu=new O(()=>new O2,l=>l.reset());class O2{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let wu,Iu=!1,X_=new oi,k0=()=>{let l=a.Promise.resolve(void 0);wu=()=>{l.then(L2)}};var L2=()=>{for(var l;l=E();){try{l.h.call(l.g)}catch(p){R(p)}var f=vu;f.j(l),100>f.h&&(f.h++,l.next=f.g,f.g=l)}Iu=!1};function Mi(){this.s=this.s,this.C=this.C}Mi.prototype.s=!1,Mi.prototype.ma=function(){this.s||(this.s=!0,this.N())},Mi.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $t(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}$t.prototype.h=function(){this.defaultPrevented=!0};var F2=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{let p=()=>{};a.addEventListener("test",p,f),a.removeEventListener("test",p,f)}catch{}return l}();function Eu(l,f){if($t.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,y=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget){if(ie){e:{try{z(f.nodeName);var S=!0;break e}catch{}S=!1}S||(f=null)}}else p=="mouseover"?f=l.fromElement:p=="mouseout"&&(f=l.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:V2[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Eu.aa.h.call(this)}}w(Eu,$t);var V2={2:"touch",3:"pen",4:"mouse"};Eu.prototype.h=function(){Eu.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Tu="closure_listenable_"+(1e6*Math.random()|0),U2=0;function B2(l,f,p,y,S){this.listener=l,this.proxy=null,this.src=f,this.type=p,this.capture=!!y,this.ha=S,this.key=++U2,this.da=this.fa=!1}function Vh(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Uh(l){this.src=l,this.g={},this.h=0}Uh.prototype.add=function(l,f,p,y,S){var x=l.toString();l=this.g[x],l||(l=this.g[x]=[],this.h++);var U=ey(l,f,y,S);return-1<U?(f=l[U],p||(f.fa=!1)):(f=new B2(f,this.src,x,!!y,S),f.fa=p,l.push(f)),f};function Z_(l,f){var p=f.type;if(p in l.g){var y=l.g[p],S=Array.prototype.indexOf.call(y,f,void 0),x;(x=0<=S)&&Array.prototype.splice.call(y,S,1),x&&(Vh(f),l.g[p].length==0&&(delete l.g[p],l.h--))}}function ey(l,f,p,y){for(var S=0;S<l.length;++S){var x=l[S];if(!x.da&&x.listener==f&&x.capture==!!p&&x.ha==y)return S}return-1}var ty="closure_lm_"+(1e6*Math.random()|0),ny={};function O0(l,f,p,y,S){if(y&&y.once)return F0(l,f,p,y,S);if(Array.isArray(f)){for(var x=0;x<f.length;x++)O0(l,f[x],p,y,S);return null}return p=oy(p),l&&l[Tu]?l.K(f,p,u(y)?!!y.capture:!!y,S):L0(l,f,p,!1,y,S)}function L0(l,f,p,y,S,x){if(!f)throw Error("Invalid event type");var U=u(S)?!!S.capture:!!S,Fe=iy(l);if(Fe||(l[ty]=Fe=new Uh(l)),p=Fe.add(f,p,y,U,x),p.proxy)return p;if(y=j2(),p.proxy=y,y.src=l,y.listener=p,l.addEventListener)F2||(S=U),S===void 0&&(S=!1),l.addEventListener(f.toString(),y,S);else if(l.attachEvent)l.attachEvent(U0(f.toString()),y);else if(l.addListener&&l.removeListener)l.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function j2(){function l(p){return f.call(l.src,l.listener,p)}let f=$2;return l}function F0(l,f,p,y,S){if(Array.isArray(f)){for(var x=0;x<f.length;x++)F0(l,f[x],p,y,S);return null}return p=oy(p),l&&l[Tu]?l.L(f,p,u(y)?!!y.capture:!!y,S):L0(l,f,p,!0,y,S)}function V0(l,f,p,y,S){if(Array.isArray(f))for(var x=0;x<f.length;x++)V0(l,f[x],p,y,S);else y=u(y)?!!y.capture:!!y,p=oy(p),l&&l[Tu]?(l=l.i,f=String(f).toString(),f in l.g&&(x=l.g[f],p=ey(x,p,y,S),-1<p&&(Vh(x[p]),Array.prototype.splice.call(x,p,1),x.length==0&&(delete l.g[f],l.h--)))):l&&(l=iy(l))&&(f=l.g[f.toString()],l=-1,f&&(l=ey(f,p,y,S)),(p=-1<l?f[l]:null)&&ry(p))}function ry(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[Tu])Z_(f.i,l);else{var p=l.type,y=l.proxy;f.removeEventListener?f.removeEventListener(p,y,l.capture):f.detachEvent?f.detachEvent(U0(p),y):f.addListener&&f.removeListener&&f.removeListener(y),(p=iy(f))?(Z_(p,l),p.h==0&&(p.src=null,f[ty]=null)):Vh(l)}}}function U0(l){return l in ny?ny[l]:ny[l]="on"+l}function $2(l,f){if(l.da)l=!0;else{f=new Eu(f,this);var p=l.listener,y=l.ha||l.src;l.fa&&ry(l),l=p.call(y,f)}return l}function iy(l){return l=l[ty],l instanceof Uh?l:null}var sy="__closure_events_fn_"+(1e9*Math.random()>>>0);function oy(l){return typeof l=="function"?l:(l[sy]||(l[sy]=function(f){return l.handleEvent(f)}),l[sy])}function Ht(){Mi.call(this),this.i=new Uh(this),this.M=this,this.F=null}w(Ht,Mi),Ht.prototype[Tu]=!0,Ht.prototype.removeEventListener=function(l,f,p,y){V0(this,l,f,p,y)};function tn(l,f){var p,y=l.F;if(y)for(p=[];y;y=y.F)p.push(y);if(l=l.M,y=f.type||f,typeof f=="string")f=new $t(f,l);else if(f instanceof $t)f.target=f.target||l;else{var S=f;f=new $t(y,l),b(f,S)}if(S=!0,p)for(var x=p.length-1;0<=x;x--){var U=f.g=p[x];S=Bh(U,y,!0,f)&&S}if(U=f.g=l,S=Bh(U,y,!0,f)&&S,S=Bh(U,y,!1,f)&&S,p)for(x=0;x<p.length;x++)U=f.g=p[x],S=Bh(U,y,!1,f)&&S}Ht.prototype.N=function(){if(Ht.aa.N.call(this),this.i){var l=this.i,f;for(f in l.g){for(var p=l.g[f],y=0;y<p.length;y++)Vh(p[y]);delete l.g[f],l.h--}}this.F=null},Ht.prototype.K=function(l,f,p,y){return this.i.add(String(l),f,!1,p,y)},Ht.prototype.L=function(l,f,p,y){return this.i.add(String(l),f,!0,p,y)};function Bh(l,f,p,y){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();for(var S=!0,x=0;x<f.length;++x){var U=f[x];if(U&&!U.da&&U.capture==p){var Fe=U.listener,Ft=U.ha||U.src;U.fa&&Z_(l.i,U),S=Fe.call(Ft,y)!==!1&&S}}return S&&!y.defaultPrevented}function B0(l,f,p){if(typeof l=="function")p&&(l=g(l,p));else if(l&&typeof l.handleEvent=="function")l=g(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(l,f||0)}function j0(l){l.g=B0(()=>{l.g=null,l.i&&(l.i=!1,j0(l))},l.l);let f=l.h;l.h=null,l.m.apply(null,f)}class H2 extends Mi{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:j0(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bu(l){Mi.call(this),this.h=l,this.g={}}w(bu,Mi);var $0=[];function H0(l){W(l.g,function(f,p){this.g.hasOwnProperty(p)&&ry(f)},l),l.g={}}bu.prototype.N=function(){bu.aa.N.call(this),H0(this)},bu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ay=a.JSON.stringify,q2=a.JSON.parse,z2=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function cy(){}cy.prototype.h=null;function q0(l){return l.h||(l.h=l.i())}function z0(){}var Cu={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function uy(){$t.call(this,"d")}w(uy,$t);function ly(){$t.call(this,"c")}w(ly,$t);var Fs={},G0=null;function jh(){return G0=G0||new Ht}Fs.La="serverreachability";function W0(l){$t.call(this,Fs.La,l)}w(W0,$t);function Du(l){let f=jh();tn(f,new W0(f))}Fs.STAT_EVENT="statevent";function K0(l,f){$t.call(this,Fs.STAT_EVENT,l),this.stat=f}w(K0,$t);function nn(l){let f=jh();tn(f,new K0(f,l))}Fs.Ma="timingevent";function Q0(l,f){$t.call(this,Fs.Ma,l),this.size=f}w(Q0,$t);function Su(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},f)}function Au(){this.g=!0}Au.prototype.xa=function(){this.g=!1};function G2(l,f,p,y,S,x){l.info(function(){if(l.g)if(x)for(var U="",Fe=x.split("&"),Ft=0;Ft<Fe.length;Ft++){var Se=Fe[Ft].split("=");if(1<Se.length){var qt=Se[0];Se=Se[1];var zt=qt.split("_");U=2<=zt.length&&zt[1]=="type"?U+(qt+"="+Se+"&"):U+(qt+"=redacted&")}}else U=null;else U=x;return"XMLHTTP REQ ("+y+") [attempt "+S+"]: "+f+`
`+p+`
`+U})}function W2(l,f,p,y,S,x,U){l.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+S+"]: "+f+`
`+p+`
`+x+" "+U})}function sa(l,f,p,y){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+Q2(l,p)+(y?" "+y:"")})}function K2(l,f){l.info(function(){return"TIMEOUT: "+f})}Au.prototype.info=function(){};function Q2(l,f){if(!l.g)return f;if(!f)return null;try{var p=JSON.parse(f);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var y=p[l];if(!(2>y.length)){var S=y[1];if(Array.isArray(S)&&!(1>S.length)){var x=S[0];if(x!="noop"&&x!="stop"&&x!="close")for(var U=1;U<S.length;U++)S[U]=""}}}}return ay(p)}catch{return f}}var $h={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Y0={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},dy;function Hh(){}w(Hh,cy),Hh.prototype.g=function(){return new XMLHttpRequest},Hh.prototype.i=function(){return{}},dy=new Hh;function ki(l,f,p,y){this.j=l,this.i=f,this.l=p,this.R=y||1,this.U=new bu(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new J0}function J0(){this.i=null,this.g="",this.h=!1}var X0={},hy={};function fy(l,f,p){l.L=1,l.v=Wh(ai(f)),l.m=p,l.P=!0,Z0(l,null)}function Z0(l,f){l.F=Date.now(),qh(l),l.A=ai(l.v);var p=l.A,y=l.R;Array.isArray(y)||(y=[String(y)]),fA(p.i,"t",y),l.C=0,p=l.j.J,l.h=new J0,l.g=xA(l.j,p?f:null,!l.m),0<l.O&&(l.M=new H2(g(l.Y,l,l.g),l.O)),f=l.U,p=l.g,y=l.ca;var S="readystatechange";Array.isArray(S)||(S&&($0[0]=S.toString()),S=$0);for(var x=0;x<S.length;x++){var U=O0(p,S[x],y||f.handleEvent,!1,f.h||f);if(!U)break;f.g[U.key]=U}f=l.H?v(l.H):{},l.m?(l.u||(l.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,f)):(l.u="GET",l.g.ea(l.A,l.u,null,f)),Du(),G2(l.i,l.u,l.A,l.l,l.R,l.m)}ki.prototype.ca=function(l){l=l.target;let f=this.M;f&&ci(l)==3?f.j():this.Y(l)},ki.prototype.Y=function(l){try{if(l==this.g)e:{let zt=ci(this.g);var f=this.g.Ba();let ca=this.g.Z();if(!(3>zt)&&(zt!=3||this.g&&(this.h.h||this.g.oa()||wA(this.g)))){this.J||zt!=4||f==7||(f==8||0>=ca?Du(3):Du(2)),py(this);var p=this.g.Z();this.X=p;t:if(eA(this)){var y=wA(this.g);l="";var S=y.length,x=ci(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vs(this),Ru(this);var U="";break t}this.h.i=new a.TextDecoder}for(f=0;f<S;f++)this.h.h=!0,l+=this.h.i.decode(y[f],{stream:!(x&&f==S-1)});y.length=0,this.h.g+=l,this.C=0,U=this.h.g}else U=this.g.oa();if(this.o=p==200,W2(this.i,this.u,this.A,this.l,this.R,zt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Fe,Ft=this.g;if((Fe=Ft.g?Ft.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Fe)){var Se=Fe;break t}}Se=null}if(p=Se)sa(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gy(this,p);else{this.o=!1,this.s=3,nn(12),Vs(this),Ru(this);break e}}if(this.P){p=!0;let tr;for(;!this.J&&this.C<U.length;)if(tr=Y2(this,U),tr==hy){zt==4&&(this.s=4,nn(14),p=!1),sa(this.i,this.l,null,"[Incomplete Response]");break}else if(tr==X0){this.s=4,nn(15),sa(this.i,this.l,U,"[Invalid Chunk]"),p=!1;break}else sa(this.i,this.l,tr,null),gy(this,tr);if(eA(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),zt!=4||U.length!=0||this.h.h||(this.s=1,nn(16),p=!1),this.o=this.o&&p,!p)sa(this.i,this.l,U,"[Invalid Chunked Response]"),Vs(this),Ru(this);else if(0<U.length&&!this.W){this.W=!0;var qt=this.j;qt.g==this&&qt.ba&&!qt.M&&(qt.j.info("Great, no buffering proxy detected. Bytes received: "+U.length),Iy(qt),qt.M=!0,nn(11))}}else sa(this.i,this.l,U,null),gy(this,U);zt==4&&Vs(this),this.o&&!this.J&&(zt==4?SA(this.j,this):(this.o=!1,qh(this)))}else fB(this.g),p==400&&0<U.indexOf("Unknown SID")?(this.s=3,nn(12)):(this.s=0,nn(13)),Vs(this),Ru(this)}}}catch{}finally{}};function eA(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Y2(l,f){var p=l.C,y=f.indexOf(`
`,p);return y==-1?hy:(p=Number(f.substring(p,y)),isNaN(p)?X0:(y+=1,y+p>f.length?hy:(f=f.slice(y,y+p),l.C=y+p,f)))}ki.prototype.cancel=function(){this.J=!0,Vs(this)};function qh(l){l.S=Date.now()+l.I,tA(l,l.I)}function tA(l,f){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Su(g(l.ba,l),f)}function py(l){l.B&&(a.clearTimeout(l.B),l.B=null)}ki.prototype.ba=function(){this.B=null;let l=Date.now();0<=l-this.S?(K2(this.i,this.A),this.L!=2&&(Du(),nn(17)),Vs(this),this.s=2,Ru(this)):tA(this,this.S-l)};function Ru(l){l.j.G==0||l.J||SA(l.j,l)}function Vs(l){py(l);var f=l.M;f&&typeof f.ma=="function"&&f.ma(),l.M=null,H0(l.U),l.g&&(f=l.g,l.g=null,f.abort(),f.ma())}function gy(l,f){try{var p=l.j;if(p.G!=0&&(p.g==l||my(p.h,l))){if(!l.K&&my(p.h,l)&&p.G==3){try{var y=p.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var S=y;if(S[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)Xh(p),Yh(p);else break e;wy(p),nn(18)}}else p.za=S[1],0<p.za-p.T&&37500>S[2]&&p.F&&p.v==0&&!p.C&&(p.C=Su(g(p.Za,p),6e3));if(1>=iA(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Bs(p,11)}else if((l.K||p.g==l)&&Xh(p),!H(f))for(S=p.Da.g.parse(f),f=0;f<S.length;f++){let Se=S[f];if(p.T=Se[0],Se=Se[1],p.G==2)if(Se[0]=="c"){p.K=Se[1],p.ia=Se[2];let qt=Se[3];qt!=null&&(p.la=qt,p.j.info("VER="+p.la));let zt=Se[4];zt!=null&&(p.Aa=zt,p.j.info("SVER="+p.Aa));let ca=Se[5];ca!=null&&typeof ca=="number"&&0<ca&&(y=1.5*ca,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;let tr=l.g;if(tr){let ef=tr.g?tr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ef){var x=y.h;x.g||ef.indexOf("spdy")==-1&&ef.indexOf("quic")==-1&&ef.indexOf("h2")==-1||(x.j=x.l,x.g=new Set,x.h&&(_y(x,x.h),x.h=null))}if(y.D){let Ey=tr.g?tr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ey&&(y.ya=Ey,ze(y.I,y.D,Ey))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var U=l;if(y.qa=NA(y,y.J?y.ia:null,y.W),U.K){sA(y.h,U);var Fe=U,Ft=y.L;Ft&&(Fe.I=Ft),Fe.B&&(py(Fe),qh(Fe)),y.g=U}else CA(y);0<p.i.length&&Jh(p)}else Se[0]!="stop"&&Se[0]!="close"||Bs(p,7);else p.G==3&&(Se[0]=="stop"||Se[0]=="close"?Se[0]=="stop"?Bs(p,7):vy(p):Se[0]!="noop"&&p.l&&p.l.ta(Se),p.v=0)}}Du(4)}catch{}}var J2=class{constructor(l,f){this.g=l,this.map=f}};function nA(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function rA(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function iA(l){return l.h?1:l.g?l.g.size:0}function my(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function _y(l,f){l.g?l.g.add(f):l.h=f}function sA(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}nA.prototype.cancel=function(){if(this.i=oA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let l of this.g.values())l.cancel();this.g.clear()}};function oA(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let f=l.i;for(let p of l.g.values())f=f.concat(p.D);return f}return C(l.i)}function X2(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var f=[],p=l.length,y=0;y<p;y++)f.push(l[y]);return f}f=[],p=0;for(y in l)f[p++]=l[y];return f}function Z2(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var f=[];l=l.length;for(var p=0;p<l;p++)f.push(p);return f}f=[],p=0;for(let y in l)f[p++]=y;return f}}}function aA(l,f){if(l.forEach&&typeof l.forEach=="function")l.forEach(f,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,f,void 0);else for(var p=Z2(l),y=X2(l),S=y.length,x=0;x<S;x++)f.call(void 0,y[x],p&&p[x],l)}var cA=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eB(l,f){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var y=l[p].indexOf("="),S=null;if(0<=y){var x=l[p].substring(0,y);S=l[p].substring(y+1)}else x=l[p];f(x,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function Us(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Us){this.h=l.h,zh(this,l.j),this.o=l.o,this.g=l.g,Gh(this,l.s),this.l=l.l;var f=l.i,p=new Pu;p.i=f.i,f.g&&(p.g=new Map(f.g),p.h=f.h),uA(this,p),this.m=l.m}else l&&(f=String(l).match(cA))?(this.h=!1,zh(this,f[1]||"",!0),this.o=Nu(f[2]||""),this.g=Nu(f[3]||"",!0),Gh(this,f[4]),this.l=Nu(f[5]||"",!0),uA(this,f[6]||"",!0),this.m=Nu(f[7]||"")):(this.h=!1,this.i=new Pu(null,this.h))}Us.prototype.toString=function(){var l=[],f=this.j;f&&l.push(xu(f,lA,!0),":");var p=this.g;return(p||f=="file")&&(l.push("//"),(f=this.o)&&l.push(xu(f,lA,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(xu(p,p.charAt(0)=="/"?rB:nB,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",xu(p,sB)),l.join("")};function ai(l){return new Us(l)}function zh(l,f,p){l.j=p?Nu(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function Gh(l,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);l.s=f}else l.s=null}function uA(l,f,p){f instanceof Pu?(l.i=f,oB(l.i,l.h)):(p||(f=xu(f,iB)),l.i=new Pu(f,l.h))}function ze(l,f,p){l.i.set(f,p)}function Wh(l){return ze(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Nu(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function xu(l,f,p){return typeof l=="string"?(l=encodeURI(l).replace(f,tB),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function tB(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var lA=/[#\/\?@]/g,nB=/[#\?:]/g,rB=/[#\?]/g,iB=/[#\?@]/g,sB=/#/g;function Pu(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function Oi(l){l.g||(l.g=new Map,l.h=0,l.i&&eB(l.i,function(f,p){l.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}n=Pu.prototype,n.add=function(l,f){Oi(this),this.i=null,l=oa(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(f),this.h+=1,this};function dA(l,f){Oi(l),f=oa(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function hA(l,f){return Oi(l),f=oa(l,f),l.g.has(f)}n.forEach=function(l,f){Oi(this),this.g.forEach(function(p,y){p.forEach(function(S){l.call(f,S,y,this)},this)},this)},n.na=function(){Oi(this);let l=Array.from(this.g.values()),f=Array.from(this.g.keys()),p=[];for(let y=0;y<f.length;y++){let S=l[y];for(let x=0;x<S.length;x++)p.push(f[y])}return p},n.V=function(l){Oi(this);let f=[];if(typeof l=="string")hA(this,l)&&(f=f.concat(this.g.get(oa(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)f=f.concat(l[p])}return f},n.set=function(l,f){return Oi(this),this.i=null,l=oa(this,l),hA(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},n.get=function(l,f){return l?(l=this.V(l),0<l.length?String(l[0]):f):f};function fA(l,f,p){dA(l,f),0<p.length&&(l.i=null,l.g.set(oa(l,f),C(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let l=[],f=Array.from(this.g.keys());for(var p=0;p<f.length;p++){var y=f[p];let x=encodeURIComponent(String(y)),U=this.V(y);for(y=0;y<U.length;y++){var S=x;U[y]!==""&&(S+="="+encodeURIComponent(String(U[y]))),l.push(S)}}return this.i=l.join("&")};function oa(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function oB(l,f){f&&!l.j&&(Oi(l),l.i=null,l.g.forEach(function(p,y){var S=y.toLowerCase();y!=S&&(dA(this,y),fA(this,S,p))},l)),l.j=f}function aB(l,f){let p=new Au;if(a.Image){let y=new Image;y.onload=_(Li,p,"TestLoadImage: loaded",!0,f,y),y.onerror=_(Li,p,"TestLoadImage: error",!1,f,y),y.onabort=_(Li,p,"TestLoadImage: abort",!1,f,y),y.ontimeout=_(Li,p,"TestLoadImage: timeout",!1,f,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=l}else f(!1)}function cB(l,f){let p=new Au,y=new AbortController,S=setTimeout(()=>{y.abort(),Li(p,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:y.signal}).then(x=>{clearTimeout(S),x.ok?Li(p,"TestPingServer: ok",!0,f):Li(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(S),Li(p,"TestPingServer: error",!1,f)})}function Li(l,f,p,y,S){try{S&&(S.onload=null,S.onerror=null,S.onabort=null,S.ontimeout=null),y(p)}catch{}}function uB(){this.g=new z2}function lB(l,f,p){let y=p||"";try{aA(l,function(S,x){let U=S;u(S)&&(U=ay(S)),f.push(y+x+"="+encodeURIComponent(U))})}catch(S){throw f.push(y+"type="+encodeURIComponent("_badmap")),S}}function Mu(l){this.l=l.Ub||null,this.j=l.eb||!1}w(Mu,cy),Mu.prototype.g=function(){return new Kh(this.l,this.j)},Mu.prototype.i=function(l){return function(){return l}}({});function Kh(l,f){Ht.call(this),this.D=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Kh,Ht),n=Kh.prototype,n.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=f,this.readyState=1,Ou(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(f.body=l),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ku(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Ou(this)),this.g&&(this.readyState=3,Ou(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;pA(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function pA(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?ku(this):Ou(this),this.readyState==3&&pA(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,ku(this))},n.Qa=function(l){this.g&&(this.response=l,ku(this))},n.ga=function(){this.g&&ku(this)};function ku(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Ou(l)}n.setRequestHeader=function(l,f){this.u.append(l,f)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let l=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=f.next();return l.join(`\r
`)};function Ou(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Kh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function gA(l){let f="";return W(l,function(p,y){f+=y,f+=":",f+=p,f+=`\r
`}),f}function yy(l,f,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=gA(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):ze(l,f,p))}function tt(l){Ht.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(tt,Ht);var dB=/^https?$/i,hB=["POST","PUT"];n=tt.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,f,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():dy.g(),this.v=this.o?q0(this.o):q0(dy),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(x){mA(this,x);return}if(l=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var S in y)p.set(S,y[S]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let x of y.keys())p.set(x,y.get(x));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(x=>x.toLowerCase()=="content-type"),S=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(hB,f,void 0))||y||S||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[x,U]of p)this.g.setRequestHeader(x,U);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{vA(this),this.u=!0,this.g.send(l),this.u=!1}catch(x){mA(this,x)}};function mA(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.m=5,_A(l),Qh(l)}function _A(l){l.A||(l.A=!0,tn(l,"complete"),tn(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,tn(this,"complete"),tn(this,"abort"),Qh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qh(this,!0)),tt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?yA(this):this.bb())},n.bb=function(){yA(this)};function yA(l){if(l.h&&typeof o<"u"&&(!l.v[1]||ci(l)!=4||l.Z()!=2)){if(l.u&&ci(l)==4)B0(l.Ea,0,l);else if(tn(l,"readystatechange"),ci(l)==4){l.h=!1;try{let U=l.Z();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var p;if(!(p=f)){var y;if(y=U===0){var S=String(l.D).match(cA)[1]||null;!S&&a.self&&a.self.location&&(S=a.self.location.protocol.slice(0,-1)),y=!dB.test(S?S.toLowerCase():"")}p=y}if(p)tn(l,"complete"),tn(l,"success");else{l.m=6;try{var x=2<ci(l)?l.g.statusText:""}catch{x=""}l.l=x+" ["+l.Z()+"]",_A(l)}}finally{Qh(l)}}}}function Qh(l,f){if(l.g){vA(l);let p=l.g,y=l.v[0]?()=>{}:null;l.g=null,l.v=null,f||tn(l,"ready");try{p.onreadystatechange=y}catch{}}}function vA(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function ci(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<ci(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),q2(f)}};function wA(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function fB(l){let f={};l=(l.g&&2<=ci(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<l.length;y++){if(H(l[y]))continue;var p=D(l[y]);let S=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let x=f[S]||[];f[S]=x,x.push(p)}T(f,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Lu(l,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||f}function IA(l){this.Aa=0,this.i=[],this.j=new Au,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Lu("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Lu("baseRetryDelayMs",5e3,l),this.cb=Lu("retryDelaySeedMs",1e4,l),this.Wa=Lu("forwardChannelMaxRetries",2,l),this.wa=Lu("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new nA(l&&l.concurrentRequestLimit),this.Da=new uB,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=IA.prototype,n.la=8,n.G=1,n.connect=function(l,f,p,y){nn(0),this.W=l,this.H=f||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=NA(this,null,this.W),Jh(this)};function vy(l){if(EA(l),l.G==3){var f=l.U++,p=ai(l.I);if(ze(p,"SID",l.K),ze(p,"RID",f),ze(p,"TYPE","terminate"),Fu(l,p),f=new ki(l,l.j,f),f.L=2,f.v=Wh(ai(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=f.v,p=!0),p||(f.g=xA(f.j,null),f.g.ea(f.v)),f.F=Date.now(),qh(f)}RA(l)}function Yh(l){l.g&&(Iy(l),l.g.cancel(),l.g=null)}function EA(l){Yh(l),l.u&&(a.clearTimeout(l.u),l.u=null),Xh(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function Jh(l){if(!rA(l.h)&&!l.s){l.s=!0;var f=l.Ga;wu||k0(),Iu||(wu(),Iu=!0),X_.add(f,l),l.B=0}}function pB(l,f){return iA(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=f.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Su(g(l.Ga,l,f),AA(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;let S=new ki(this,this.j,l),x=this.o;if(this.S&&(x?(x=v(x),b(x,this.S)):x=this.S),this.m!==null||this.O||(S.H=x,x=null),this.P)e:{for(var f=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=p;break e}if(f===4096||p===this.i.length-1){f=p+1;break e}}f=1e3}else f=1e3;f=bA(this,S,f),p=ai(this.I),ze(p,"RID",l),ze(p,"CVER",22),this.D&&ze(p,"X-HTTP-Session-Id",this.D),Fu(this,p),x&&(this.O?f="headers="+encodeURIComponent(String(gA(x)))+"&"+f:this.m&&yy(p,this.m,x)),_y(this.h,S),this.Ua&&ze(p,"TYPE","init"),this.P?(ze(p,"$req",f),ze(p,"SID","null"),S.T=!0,fy(S,p,null)):fy(S,p,f),this.G=2}}else this.G==3&&(l?TA(this,l):this.i.length==0||rA(this.h)||TA(this))};function TA(l,f){var p;f?p=f.l:p=l.U++;let y=ai(l.I);ze(y,"SID",l.K),ze(y,"RID",p),ze(y,"AID",l.T),Fu(l,y),l.m&&l.o&&yy(y,l.m,l.o),p=new ki(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),f&&(l.i=f.D.concat(l.i)),f=bA(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),_y(l.h,p),fy(p,y,f)}function Fu(l,f){l.H&&W(l.H,function(p,y){ze(f,y,p)}),l.l&&aA({},function(p,y){ze(f,y,p)})}function bA(l,f,p){p=Math.min(l.i.length,p);var y=l.l?g(l.l.Na,l.l,l):null;e:{var S=l.i;let x=-1;for(;;){let U=["count="+p];x==-1?0<p?(x=S[0].g,U.push("ofs="+x)):x=0:U.push("ofs="+x);let Fe=!0;for(let Ft=0;Ft<p;Ft++){let Se=S[Ft].g,qt=S[Ft].map;if(Se-=x,0>Se)x=Math.max(0,S[Ft].g-100),Fe=!1;else try{lB(qt,U,"req"+Se+"_")}catch{y&&y(qt)}}if(Fe){y=U.join("&");break e}}}return l=l.i.splice(0,p),f.D=l,y}function CA(l){if(!l.g&&!l.u){l.Y=1;var f=l.Fa;wu||k0(),Iu||(wu(),Iu=!0),X_.add(f,l),l.v=0}}function wy(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Su(g(l.Fa,l),AA(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,DA(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Su(g(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,nn(10),Yh(this),DA(this))};function Iy(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function DA(l){l.g=new ki(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var f=ai(l.qa);ze(f,"RID","rpc"),ze(f,"SID",l.K),ze(f,"AID",l.T),ze(f,"CI",l.F?"0":"1"),!l.F&&l.ja&&ze(f,"TO",l.ja),ze(f,"TYPE","xmlhttp"),Fu(l,f),l.m&&l.o&&yy(f,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=Wh(ai(f)),p.m=null,p.P=!0,Z0(p,l)}n.Za=function(){this.C!=null&&(this.C=null,Yh(this),wy(this),nn(19))};function Xh(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function SA(l,f){var p=null;if(l.g==f){Xh(l),Iy(l),l.g=null;var y=2}else if(my(l.h,f))p=f.D,sA(l.h,f),y=1;else return;if(l.G!=0){if(f.o)if(y==1){p=f.m?f.m.length:0,f=Date.now()-f.F;var S=l.B;y=jh(),tn(y,new Q0(y,p)),Jh(l)}else CA(l);else if(S=f.s,S==3||S==0&&0<f.X||!(y==1&&pB(l,f)||y==2&&wy(l)))switch(p&&0<p.length&&(f=l.h,f.i=f.i.concat(p)),S){case 1:Bs(l,5);break;case 4:Bs(l,10);break;case 3:Bs(l,6);break;default:Bs(l,2)}}}function AA(l,f){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*f}function Bs(l,f){if(l.j.info("Error code "+f),f==2){var p=g(l.fb,l),y=l.Xa;let S=!y;y=new Us(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||zh(y,"https"),Wh(y),S?aB(y.toString(),p):cB(y.toString(),p)}else nn(2);l.G=0,l.l&&l.l.sa(f),RA(l),EA(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),nn(2)):(this.j.info("Failed to ping google.com"),nn(1))};function RA(l){if(l.G=0,l.ka=[],l.l){let f=oA(l.h);(f.length!=0||l.i.length!=0)&&(A(l.ka,f),A(l.ka,l.i),l.h.i.length=0,C(l.i),l.i.length=0),l.l.ra()}}function NA(l,f,p){var y=p instanceof Us?ai(p):new Us(p);if(y.g!="")f&&(y.g=f+"."+y.g),Gh(y,y.s);else{var S=a.location;y=S.protocol,f=f?f+"."+S.hostname:S.hostname,S=+S.port;var x=new Us(null);y&&zh(x,y),f&&(x.g=f),S&&Gh(x,S),p&&(x.l=p),y=x}return p=l.D,f=l.ya,p&&f&&ze(y,p,f),ze(y,"VER",l.la),Fu(l,y),y}function xA(l,f,p){if(f&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Ca&&!l.pa?new tt(new Mu({eb:p})):new tt(l.pa),f.Ha(l.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function PA(){}n=PA.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Zh(){}Zh.prototype.g=function(l,f){return new bn(l,f)};function bn(l,f){Ht.call(this),this.g=new IA(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(l?l["X-WebChannel-Client-Profile"]=f.va:l={"X-WebChannel-Client-Profile":f.va}),this.g.S=l,(l=f&&f.Sb)&&!H(l)&&(this.g.m=l),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!H(f)&&(this.g.D=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new aa(this)}w(bn,Ht),bn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},bn.prototype.close=function(){vy(this.g)},bn.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=ay(l),l=p);f.i.push(new J2(f.Ya++,l)),f.G==3&&Jh(f)},bn.prototype.N=function(){this.g.l=null,delete this.j,vy(this.g),delete this.g,bn.aa.N.call(this)};function MA(l){uy.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(let p in f){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}w(MA,uy);function kA(){ly.call(this),this.status=1}w(kA,ly);function aa(l){this.g=l}w(aa,PA),aa.prototype.ua=function(){tn(this.g,"a")},aa.prototype.ta=function(l){tn(this.g,new MA(l))},aa.prototype.sa=function(l){tn(this.g,new kA)},aa.prototype.ra=function(){tn(this.g,"b")},Zh.prototype.createWebChannel=Zh.prototype.g,bn.prototype.send=bn.prototype.o,bn.prototype.open=bn.prototype.m,bn.prototype.close=bn.prototype.close,PT=Ii.createWebChannelTransport=function(){return new Zh},xT=Ii.getStatEventTarget=function(){return jh()},NT=Ii.Event=Fs,Ng=Ii.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},$h.NO_ERROR=0,$h.TIMEOUT=8,$h.HTTP_ERROR=6,hd=Ii.ErrorCode=$h,Y0.COMPLETE="complete",RT=Ii.EventType=Y0,z0.EventType=Cu,Cu.OPEN="a",Cu.CLOSE="b",Cu.ERROR="c",Cu.MESSAGE="d",Ht.prototype.listen=Ht.prototype.K,oc=Ii.WebChannel=z0,AT=Ii.FetchXmlHttpFactory=Mu,tt.prototype.listenOnce=tt.prototype.L,tt.prototype.getLastError=tt.prototype.Ka,tt.prototype.getLastErrorCode=tt.prototype.Ba,tt.prototype.getStatus=tt.prototype.Z,tt.prototype.getResponseJson=tt.prototype.Oa,tt.prototype.getResponseText=tt.prototype.oa,tt.prototype.send=tt.prototype.ea,tt.prototype.setWithCredentials=tt.prototype.Ha,ST=Ii.XhrIo=tt}).apply(typeof Rg<"u"?Rg:typeof self<"u"?self:typeof window<"u"?window:{});var rO="@firebase/firestore";var It=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};It.UNAUTHENTICATED=new It(null),It.GOOGLE_CREDENTIALS=new It("google-credentials-uid"),It.FIRST_PARTY=new It("first-party-uid"),It.MOCK_USER=new It("mock-user");var Fc="10.12.1";var fs=new In("@firebase/firestore");function dc(){return fs.logLevel}function i1(n){fs.setLogLevel(n)}function k(n,...e){if(fs.logLevel<=fe.DEBUG){let t=e.map(OC);fs.debug(`Firestore (${Fc}): ${n}`,...t)}}function dt(n,...e){if(fs.logLevel<=fe.ERROR){let t=e.map(OC);fs.error(`Firestore (${Fc}): ${n}`,...t)}}function Qn(n,...e){if(fs.logLevel<=fe.WARN){let t=e.map(OC);fs.warn(`Firestore (${Fc}): ${n}`,...t)}}function OC(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function G(n="Unexpected state"){let e=`FIRESTORE (${Fc}) INTERNAL ASSERTION FAILED: `+n;throw dt(e),new Error(e)}function Y(n,e){n||G()}function s1(n,e){n||G()}function $(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends rt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Et=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var jg=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},FT=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(It.UNAUTHENTICATED))}shutdown(){}},VT=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},UT=class{constructor(e){this.t=e,this.currentUser=It.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Et;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Et,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>m(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Et)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string"),new jg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string"),new It(e)}},BT=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=It.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},jT=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new BT(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(It.FIRST_PARTY))}shutdown(){}invalidateToken(){}},$T=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},HT=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,k("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Y(typeof t.token=="string"),this.R=t.token,new $T(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function r5(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var $g=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=r5(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function ue(n,e){return n<e?-1:n>e?1:0}function wc(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function o1(n){return n+"\0"}var Xe=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ue(this.nanoseconds,e.nanoseconds):ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var X=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Xe(0,0))}static max(){return new n(new Xe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Hg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&G(),r===void 0?r=e.length-t:r>e.length-t&&G(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},be=class n extends Hg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new M(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},i5=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ht=class n extends Hg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return i5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new M(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new M(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new M(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var j=class n{constructor(e){this.path=e}static fromPath(e){return new n(be.fromString(e))}static fromName(e){return new n(be.fromString(e).popFirst(5))}static empty(){return new n(be.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&be.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return be.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new be(e.slice()))}};var Ic=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function qT(n){return n.fields.find(e=>e.kind===2)}function To(n){return n.fields.filter(e=>e.kind!==2)}Ic.UNKNOWN_ID=-1;var _c=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var bd=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Yn.min())}};function a1(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=X.fromTimestamp(r===1e9?new Xe(t+1,0):new Xe(t,r));return new Yn(i,j.empty(),e)}function c1(n){return new Yn(n.readTime,n.key,-1)}var Yn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(X.min(),j.empty(),-1)}static max(){return new n(X.max(),j.empty(),-1)}};function LC(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=j.comparator(n.documentKey,e.documentKey),t!==0?t:ue(n.largestBatchId,e.largestBatchId))}var u1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",qg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ts(n){return m(this,null,function*(){if(n.code!==P.FAILED_PRECONDITION||n.message!==u1)throw n;k("LocalStore","Unexpectedly lost primary lease")})}var N=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&G(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;t(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var zg=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Et,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ro(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=FC(r.target.error);this.V.reject(new Ro(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new Ro(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(k("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new GT(t)}},ps=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(Ue())===12.2&&dt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return k("SimpleDb","Removing database:",e),bo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Qi())return!1;if(n.C())return!0;let e=Ue(),t=n.S(e),r=0<t&&t<10,i=l1(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return m(this,null,function*(){return this.db||(k("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new Ro(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new M(P.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new M(P.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ro(e,o))},i.onupgradeneeded=s=>{k("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{k("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return m(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=zg.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),N.reject(u))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,u=c.name!=="FirebaseError"&&o<3;if(k("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function l1(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var zT=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return bo(this.B.delete())}},Ro=class extends M{constructor(e,t){super(P.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function bs(n){return n.name==="IndexedDbTransactionError"}var GT=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(k("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(k("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),bo(r)}add(e){return k("SimpleDb","ADD",this.store.name,e,e),bo(this.store.add(e))}get(e){return bo(this.store.get(e)).next(t=>(t===void 0&&(t=null),k("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return k("SimpleDb","DELETE",this.store.name,e),bo(this.store.delete(e))}count(){return k("SimpleDb","COUNT",this.store.name),bo(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new N((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new N((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){k("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new N((r,i)=>{t.onerror=s=>{let o=FC(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new N((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new zT(a),u=t(a.primaryKey,a.value,c);if(u instanceof N){let d=u.catch(h=>(c.done(),N.reject(h)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>N.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function bo(n){return new N((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=FC(r.target.error);t(i)}})}var iO=!1;function FC(n){let e=ps.S(Ue());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new M("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return iO||(iO=!0,setTimeout(()=>{throw r},0)),r}}return n}var WT=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){k("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>m(this,null,function*(){this.task=null;try{k("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){bs(t)?k("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield Ts(t)}yield this.X(6e4)}))}},KT=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return m(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return N.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return k("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(k("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=c1(s);LC(o,r)>0&&(r=o)}),new Yn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Pn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Gd(n){return n==null}function Cd(n){return n===0&&1/n==-1/0}function d1(n){return typeof n=="number"&&Number.isInteger(n)&&!Cd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function ln(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=sO(e)),e=s5(n.get(t),e);return sO(e)}function s5(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function sO(n){return n+""}function Hr(n){let e=n.length;if(Y(e>=2),e===2)return Y(n.charAt(0)===""&&n.charAt(1)===""),be.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&G(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:G()}s=o+2}return new be(r)}var oO=["userId","batchId"];function Og(n,e){return[n,ln(e)]}function h1(n,e,t){return[n,ln(e),t]}var o5={},a5=["prefixPath","collectionGroup","readTime","documentId"],c5=["prefixPath","collectionGroup","documentId"],u5=["collectionGroup","readTime","prefixPath","documentId"],l5=["canonicalId","targetId"],d5=["targetId","path"],h5=["path","targetId"],f5=["collectionId","parent"],p5=["indexId","uid"],g5=["uid","sequenceNumber"],m5=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],_5=["indexId","uid","orderedDocumentKey"],y5=["userId","collectionPath","documentId"],v5=["userId","collectionPath","largestBatchId"],w5=["userId","collectionGroup","largestBatchId"],f1=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],I5=[...f1,"documentOverlays"],p1=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],g1=p1,m1=[...g1,"indexConfiguration","indexState","indexEntries"],E5=m1;var Dd=class extends qg{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function kt(n,e){let t=$(n);return ps.F(t._e,e)}function aO(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function jo(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function _1(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var We=class n{constructor(e,t){this.comparator=e,this.root=t||zr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,zr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new mc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new mc(this.root,e,this.comparator,!1)}getReverseIterator(){return new mc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new mc(this.root,e,this.comparator,!0)}},mc=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},zr=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw G();let e=this.left.check();if(e!==this.right.check())throw G();return e+(this.isRed()?0:1)}};zr.EMPTY=null,zr.RED=!0,zr.BLACK=!1;zr.EMPTY=new class{constructor(){this.size=0}get key(){throw G()}get value(){throw G()}get color(){throw G()}get left(){throw G()}get right(){throw G()}copy(e,t,r,i,s){return this}insert(e,t,r){return new zr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Be=class n{constructor(e){this.comparator=e,this.data=new We(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Gg(this.data.getIterator())}getIteratorFrom(e){return new Gg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Gg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function ac(n){return n.hasNext()?n.getNext():void 0}var Mn=class n{constructor(e){this.fields=e,e.sort(ht.comparator)}static empty(){return new n([])}unionWith(e){let t=new Be(ht.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return wc(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Wg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function y1(){return typeof atob<"u"}var Mt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Wg("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Mt.EMPTY_BYTE_STRING=new Mt("");var T5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bi(n){if(Y(!!n),typeof n=="string"){let e=0,t=T5.exec(n);if(Y(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ot(n.seconds),nanos:ot(n.nanos)}}function ot(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function gs(n){return typeof n=="string"?Mt.fromBase64String(n):Mt.fromUint8Array(n)}function Fm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function VC(n){let e=n.mapValue.fields.__previous_value__;return Fm(e)?VC(e):e}function Sd(n){let e=bi(n.mapValue.fields.__local_write_time__.timestampValue);return new Xe(e.seconds,e.nanos)}var QT=class{constructor(e,t,r,i,s,o,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},ms=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var ds={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Lg={nullValue:"NULL_VALUE"};function No(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fm(n)?4:v1(n)?9007199254740991:10:G()}function Kr(n,e){if(n===e)return!0;let t=No(n);if(t!==No(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Sd(n).isEqual(Sd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=bi(i.timestampValue),a=bi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return gs(i.bytesValue).isEqual(gs(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return ot(i.geoPointValue.latitude)===ot(s.geoPointValue.latitude)&&ot(i.geoPointValue.longitude)===ot(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ot(i.integerValue)===ot(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=ot(i.doubleValue),a=ot(s.doubleValue);return o===a?Cd(o)===Cd(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return wc(n.arrayValue.values||[],e.arrayValue.values||[],Kr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(aO(o)!==aO(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Kr(o[c],a[c])))return!1;return!0}(n,e);default:return G()}}function Ad(n,e){return(n.values||[]).find(t=>Kr(t,e))!==void 0}function _s(n,e){if(n===e)return 0;let t=No(n),r=No(e);if(t!==r)return ue(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ue(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=ot(s.integerValue||s.doubleValue),c=ot(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return cO(n.timestampValue,e.timestampValue);case 4:return cO(Sd(n),Sd(e));case 5:return ue(n.stringValue,e.stringValue);case 6:return function(s,o){let a=gs(s),c=gs(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let d=ue(a[u],c[u]);if(d!==0)return d}return ue(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ue(ot(s.latitude),ot(o.latitude));return a!==0?a:ue(ot(s.longitude),ot(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let d=_s(a[u],c[u]);if(d)return d}return ue(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===ds.mapValue&&o===ds.mapValue)return 0;if(s===ds.mapValue)return 1;if(o===ds.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let g=ue(c[h],d[h]);if(g!==0)return g;let _=_s(a[c[h]],u[d[h]]);if(_!==0)return _}return ue(c.length,d.length)}(n.mapValue,e.mapValue);default:throw G()}}function cO(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ue(n,e);let t=bi(n),r=bi(e),i=ue(t.seconds,r.seconds);return i!==0?i:ue(t.nanos,r.nanos)}function Ec(n){return YT(n)}function YT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=bi(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return gs(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return j.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=YT(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${YT(t.fields[o])}`;return i+"}"}(n.mapValue):G()}function xo(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function JT(n){return!!n&&"integerValue"in n}function Rd(n){return!!n&&"arrayValue"in n}function uO(n){return!!n&&"nullValue"in n}function lO(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Fg(n){return!!n&&"mapValue"in n}function vd(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return jo(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=vd(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=vd(n.arrayValue.values[t]);return e}return Object.assign({},n)}function v1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function b5(n){return"nullValue"in n?Lg:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?xo(ms.empty(),j.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:G()}function C5(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?xo(ms.empty(),j.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?ds:G()}function dO(n,e){let t=_s(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function hO(n,e){let t=_s(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Xt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Fg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=vd(t)}setAll(e){let t=ht.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=vd(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Fg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Kr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Fg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){jo(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(vd(this.value))}};function w1(n){let e=[];return jo(n.fields,(t,r)=>{let i=new ht([t]);if(Fg(r)){let s=w1(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Mn(e)}var Tt=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,X.min(),X.min(),X.min(),Xt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,X.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,X.min(),X.min(),Xt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,X.min(),X.min(),Xt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(X.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Qr=class{constructor(e,t){this.position=e,this.inclusive=t}};function fO(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=j.comparator(j.fromName(o.referenceValue),t.key):r=_s(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function pO(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Kr(n.position[t],e.position[t]))return!1;return!0}var Po=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function D5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Kg=class{},ye=class n extends Kg{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new eb(e,t,r):t==="array-contains"?new rb(e,r):t==="in"?new Qg(e,r):t==="not-in"?new ib(e,r):t==="array-contains-any"?new sb(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new tb(e,r):new nb(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(_s(t,this.value)):t!==null&&No(this.value)===No(t)&&this.matchesComparison(_s(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return G()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ke=class n extends Kg{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Tc(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Tc(n){return n.op==="and"}function XT(n){return n.op==="or"}function UC(n){return I1(n)&&Tc(n)}function I1(n){for(let e of n.filters)if(e instanceof ke)return!1;return!0}function ZT(n){if(n instanceof ye)return n.field.canonicalString()+n.op.toString()+Ec(n.value);if(UC(n))return n.filters.map(e=>ZT(e)).join(",");{let e=n.filters.map(t=>ZT(t)).join(",");return`${n.op}(${e})`}}function E1(n,e){return n instanceof ye?function(r,i){return i instanceof ye&&r.op===i.op&&r.field.isEqual(i.field)&&Kr(r.value,i.value)}(n,e):n instanceof ke?function(r,i){return i instanceof ke&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&E1(o,i.filters[a]),!0):!1}(n,e):void G()}function T1(n,e){let t=n.filters.concat(e);return ke.create(t,n.op)}function b1(n){return n instanceof ye?function(t){return`${t.field.canonicalString()} ${t.op} ${Ec(t.value)}`}(n):n instanceof ke?function(t){return t.op.toString()+" {"+t.getFilters().map(b1).join(" ,")+"}"}(n):"Filter"}var eb=class extends ye{constructor(e,t,r){super(e,t,r),this.key=j.fromName(r.referenceValue)}matches(e){let t=j.comparator(e.key,this.key);return this.matchesComparison(t)}},tb=class extends ye{constructor(e,t){super(e,"in",t),this.keys=C1("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},nb=class extends ye{constructor(e,t){super(e,"not-in",t),this.keys=C1("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function C1(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>j.fromName(r.referenceValue))}var rb=class extends ye{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Rd(t)&&Ad(t.arrayValue,this.value)}},Qg=class extends ye{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ad(this.value.arrayValue,t)}},ib=class extends ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ad(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ad(this.value.arrayValue,t)}},sb=class extends ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Rd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ad(this.value.arrayValue,r))}};var ob=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function ab(n,e=null,t=[],r=[],i=null,s=null,o=null){return new ob(n,e,t,r,i,s,o)}function Mo(n){let e=$(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>ZT(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Gd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Ec(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Ec(r)).join(",")),e.ue=t}return e.ue}function Wd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!D5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!E1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!pO(n.startAt,e.startAt)&&pO(n.endAt,e.endAt)}function Yg(n){return j.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Jg(n,e){return n.filters.filter(t=>t instanceof ye&&t.field.isEqual(e))}function gO(n,e,t){let r=Lg,i=!0;for(let s of Jg(n,e)){let o=Lg,a=!0;switch(s.op){case"<":case"<=":o=b5(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Lg}dO({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];dO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function mO(n,e,t){let r=ds,i=!0;for(let s of Jg(n,e)){let o=ds,a=!0;switch(s.op){case">=":case">":o=C5(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=ds}hO({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];hO({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var mr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function D1(n,e,t,r,i,s,o,a){return new mr(n,e,t,r,i,s,o,a)}function Vc(n){return new mr(n)}function _O(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function BC(n){return n.collectionGroup!==null}function yc(n){let e=$(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Be(ht.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Po(s,r))}),t.has(ht.keyField().canonicalString())||e.ce.push(new Po(ht.keyField(),r))}return e.ce}function dn(n){let e=$(n);return e.le||(e.le=S5(e,yc(n))),e.le}function S5(n,e){if(n.limitType==="F")return ab(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Po(i.field,s)});let t=n.endAt?new Qr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Qr(n.startAt.position,n.startAt.inclusive):null;return ab(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function cb(n,e){let t=n.filters.concat([e]);return new mr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Xg(n,e,t){return new mr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Kd(n,e){return Wd(dn(n),dn(e))&&n.limitType===e.limitType}function S1(n){return`${Mo(dn(n))}|lt:${n.limitType}`}function hc(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>b1(i)).join(", ")}]`),Gd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Ec(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Ec(i)).join(",")),`Target(${r})`}(dn(n))}; limitType=${n.limitType})`}function Qd(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):j.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of yc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=fO(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,yc(r),i)||r.endAt&&!function(o,a,c){let u=fO(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,yc(r),i))}(n,e)}function A1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function R1(n){return(e,t)=>{let r=!1;for(let i of yc(n)){let s=A5(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function A5(n,e,t){let r=n.field.isKeyField()?j.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?_s(c,u):G()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return G()}}var Yr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){jo(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return _1(this.inner)}size(){return this.innerSize}};var R5=new We(j.comparator);function Tn(){return R5}var N1=new We(j.comparator);function _d(...n){let e=N1;for(let t of n)e=e.insert(t.key,t);return e}function x1(n){let e=N1;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function qr(){return wd()}function P1(){return wd()}function wd(){return new Yr(n=>n.toString(),(n,e)=>n.isEqual(e))}var N5=new We(j.comparator),x5=new Be(j.comparator);function de(...n){let e=x5;for(let t of n)e=e.add(t);return e}var P5=new Be(ue);function jC(){return P5}function M1(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Cd(e)?"-0":e}}function k1(n){return{integerValue:""+n}}function O1(n,e){return d1(e)?k1(e):M1(n,e)}var bc=class{constructor(){this._=void 0}};function M5(n,e,t){return n instanceof ys?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Fm(s)&&(s=VC(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Ci?F1(n,e):n instanceof Di?V1(n,e):function(i,s){let o=L1(i,s),a=yO(o)+yO(i.Pe);return JT(o)&&JT(i.Pe)?k1(a):M1(i.serializer,a)}(n,e)}function k5(n,e,t){return n instanceof Ci?F1(n,e):n instanceof Di?V1(n,e):t}function L1(n,e){return n instanceof vs?function(r){return JT(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var ys=class extends bc{},Ci=class extends bc{constructor(e){super(),this.elements=e}};function F1(n,e){let t=U1(e);for(let r of n.elements)t.some(i=>Kr(i,r))||t.push(r);return{arrayValue:{values:t}}}var Di=class extends bc{constructor(e){super(),this.elements=e}};function V1(n,e){let t=U1(e);for(let r of n.elements)t=t.filter(i=>!Kr(i,r));return{arrayValue:{values:t}}}var vs=class extends bc{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function yO(n){return ot(n.integerValue||n.doubleValue)}function U1(n){return Rd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var ko=class{constructor(e,t){this.field=e,this.transform=t}};function O5(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Ci&&i instanceof Ci||r instanceof Di&&i instanceof Di?wc(r.elements,i.elements,Kr):r instanceof vs&&i instanceof vs?Kr(r.Pe,i.Pe):r instanceof ys&&i instanceof ys}(n.transform,e.transform)}var ub=class{constructor(e,t){this.version=e,this.transformResults=t}},at=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Vg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Cc=class{};function B1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Is(n.key,at.none()):new ws(n.key,n.data,at.none());{let t=n.data,r=Xt.empty(),i=new Be(ht.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new _r(n.key,r,new Mn(i.toArray()),at.none())}}function L5(n,e,t){n instanceof ws?function(i,s,o){let a=i.value.clone(),c=wO(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof _r?function(i,s,o){if(!Vg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=wO(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(j1(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Id(n,e,t,r){return n instanceof ws?function(s,o,a,c){if(!Vg(s.precondition,o))return a;let u=s.value.clone(),d=IO(s.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof _r?function(s,o,a,c){if(!Vg(s.precondition,o))return a;let u=IO(s.fieldTransforms,c,o),d=o.data;return d.setAll(j1(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return Vg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function F5(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=L1(r.transform,i||null);s!=null&&(t===null&&(t=Xt.empty()),t.set(r.field,s))}return t||null}function vO(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&wc(r,i,(s,o)=>O5(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var ws=class extends Cc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},_r=class extends Cc{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function j1(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function wO(n,e,t){let r=new Map;Y(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,k5(o,a,t[i]))}return r}function IO(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,M5(s,o,e))}return r}var Is=class extends Cc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Nd=class extends Cc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var xd=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&L5(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Id(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Id(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=P1();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=B1(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(X.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),de())}isEqual(e){return this.batchId===e.batchId&&wc(this.mutations,e.mutations,(t,r)=>vO(t,r))&&wc(this.baseMutations,e.baseMutations,(t,r)=>vO(t,r))}},lb=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Y(e.mutations.length===r.length);let i=function(){return N5}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Pd=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var db=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var vt,Te;function $1(n){switch(n){default:return G();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function H1(n){if(n===void 0)return dt("GRPC error has no .code"),P.UNKNOWN;switch(n){case vt.OK:return P.OK;case vt.CANCELLED:return P.CANCELLED;case vt.UNKNOWN:return P.UNKNOWN;case vt.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case vt.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case vt.INTERNAL:return P.INTERNAL;case vt.UNAVAILABLE:return P.UNAVAILABLE;case vt.UNAUTHENTICATED:return P.UNAUTHENTICATED;case vt.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case vt.NOT_FOUND:return P.NOT_FOUND;case vt.ALREADY_EXISTS:return P.ALREADY_EXISTS;case vt.PERMISSION_DENIED:return P.PERMISSION_DENIED;case vt.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case vt.ABORTED:return P.ABORTED;case vt.OUT_OF_RANGE:return P.OUT_OF_RANGE;case vt.UNIMPLEMENTED:return P.UNIMPLEMENTED;case vt.DATA_LOSS:return P.DATA_LOSS;default:return G()}}(Te=vt||(vt={}))[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";var EO=null;function q1(){return new TextEncoder}var V5=new os([4294967295,4294967295],0);function TO(n){let e=q1().encode(n),t=new DT;return t.update(e),new Uint8Array(t.digest())}function bO(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new os([t,r],0),new os([i,s],0)]}var hb=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ao(`Invalid padding: ${t}`);if(r<0)throw new Ao(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ao(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ao(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=os.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(os.fromNumber(r)));return i.compare(V5)===1&&(i=new os([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=TO(e),[r,i]=bO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=TO(e),[r,i]=bO(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Ao=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Md=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,kd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(X.min(),i,new We(ue),Tn(),de())}},kd=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,de(),de(),de())}};var vc=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Zg=class{constructor(e,t){this.targetId=e,this.me=t}},em=class{constructor(e,t,r=Mt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},tm=class{constructor(){this.fe=0,this.ge=DO(),this.pe=Mt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=de(),t=de(),r=de();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:G()}}),new kd(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=DO()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Y(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},fb=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Tn(),this.qe=CO(),this.Qe=new We(ue)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:G()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(Yg(s))if(r===0){let o=new j(s.path);this.Ue(t,o,Tt.newNoDocument(o,X.min()))}else Y(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}EO?.et(function(d,h,g,_,w){var C,A,O,H,F,z;let ie={localCacheCount:d,existenceFilterCount:h.count,databaseId:g.database,projectId:g.projectId},W=h.unchangedNames;return W&&(ie.bloomFilter={applied:w===0,hashCount:(C=W?.hashCount)!==null&&C!==void 0?C:0,bitmapLength:(H=(O=(A=W?.bits)===null||A===void 0?void 0:A.bitmap)===null||O===void 0?void 0:O.length)!==null&&H!==void 0?H:0,padding:(z=(F=W?.bits)===null||F===void 0?void 0:F.padding)!==null&&z!==void 0?z:0,mightContain:T=>{var v;return(v=_?.mightContain(T))!==null&&v!==void 0&&v}}),ie}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=gs(r).toUint8Array()}catch(c){if(c instanceof Wg)return Qn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new hb(o,i,s)}catch(c){return Qn(c instanceof Ao?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&Yg(a.target)){let c=new j(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Tt.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let r=de();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Md(e,t,this.Qe,this.ke,r);return this.ke=Tn(),this.qe=CO(),this.Qe=new We(ue),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new tm,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Be(ue),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new tm),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function CO(){return new We(j.comparator)}function DO(){return new We(j.comparator)}var U5={asc:"ASCENDING",desc:"DESCENDING"},B5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},j5={and:"AND",or:"OR"},pb=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function gb(n,e){return n.useProto3Json||Gd(e)?e:{value:e}}function Dc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function z1(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function $5(n,e){return Dc(n,e.toTimestamp())}function ft(n){return Y(!!n),X.fromTimestamp(function(t){let r=bi(t);return new Xe(r.seconds,r.nanos)}(n))}function $C(n,e){return mb(n,e).canonicalString()}function mb(n,e){let t=function(i){return new be(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function G1(n){let e=be.fromString(n);return Y(nL(e)),e}function Od(n,e){return $C(n.databaseId,e.path)}function Gr(n,e){let t=G1(e);if(t.get(1)!==n.databaseId.projectId)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new j(Q1(t))}function W1(n,e){return $C(n.databaseId,e)}function K1(n){let e=G1(n);return e.length===4?be.emptyPath():Q1(e)}function _b(n){return new be(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Q1(n){return Y(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function SO(n,e,t){return{name:Od(n,e),fields:t.value.mapValue.fields}}function Y1(n,e,t){let r=Gr(n,e.name),i=ft(e.updateTime),s=e.createTime?ft(e.createTime):X.min(),o=new Xt({mapValue:{fields:e.fields}}),a=Tt.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function H5(n,e){return"found"in e?function(r,i){Y(!!i.found),i.found.name,i.found.updateTime;let s=Gr(r,i.found.name),o=ft(i.found.updateTime),a=i.found.createTime?ft(i.found.createTime):X.min(),c=new Xt({mapValue:{fields:i.found.fields}});return Tt.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){Y(!!i.missing),Y(!!i.readTime);let s=Gr(r,i.missing),o=ft(i.readTime);return Tt.newNoDocument(s,o)}(n,e):G()}function q5(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:G()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(Y(d===void 0||typeof d=="string"),Mt.fromBase64String(d||"")):(Y(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Mt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let d=u.code===void 0?P.UNKNOWN:H1(u.code);return new M(d,u.message||"")}(o);t=new em(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Gr(n,r.document.name),s=ft(r.document.updateTime),o=r.document.createTime?ft(r.document.createTime):X.min(),a=new Xt({mapValue:{fields:r.document.fields}}),c=Tt.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new vc(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Gr(n,r.document),s=r.readTime?ft(r.readTime):X.min(),o=Tt.newNoDocument(i,s),a=r.removedTargetIds||[];t=new vc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Gr(n,r.document),s=r.removedTargetIds||[];t=new vc([],s,i,null)}else{if(!("filter"in e))return G();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new db(i,s),a=r.targetId;t=new Zg(a,o)}}return t}function Ld(n,e){let t;if(e instanceof ws)t={update:SO(n,e.key,e.value)};else if(e instanceof Is)t={delete:Od(n,e.key)};else if(e instanceof _r)t={update:SO(n,e.key,e.data),updateMask:Y5(e.fieldMask)};else{if(!(e instanceof Nd))return G();t={verify:Od(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof ys)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ci)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Di)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof vs)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw G()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:$5(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:G()}(n,e.precondition)),t}function yb(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?at.updateTime(ft(s.updateTime)):s.exists!==void 0?at.exists(s.exists):at.none()}(e.currentDocument):at.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)Y(a.setToServerValue==="REQUEST_TIME"),c=new ys;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new Ci(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new Di(d)}else"increment"in a?c=new vs(o,a.increment):G();let u=ht.fromServerFormat(a.fieldPath);return new ko(u,c)}(n,i)):[];if(e.update){e.update.name;let i=Gr(n,e.update.name),s=new Xt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let u=c.fieldPaths||[];return new Mn(u.map(d=>ht.fromServerFormat(d)))}(e.updateMask);return new _r(i,s,o,t,r)}return new ws(i,s,t,r)}if(e.delete){let i=Gr(n,e.delete);return new Is(i,t)}if(e.verify){let i=Gr(n,e.verify);return new Nd(i,t)}return G()}function z5(n,e){return n&&n.length>0?(Y(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?ft(i.updateTime):ft(s);return o.isEqual(X.min())&&(o=ft(s)),new ub(o,i.transformResults||[])}(t,e))):[]}function J1(n,e){return{documents:[W1(n,e.path)]}}function X1(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=W1(n,i);let s=function(u){if(u.length!==0)return tL(ke.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(d=>function(g){return{field:fc(g.field),direction:W5(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=gb(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:i}}function Z1(n){let e=K1(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Y(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let g=eL(h);return g instanceof ke&&UC(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(g=>function(w){return new Po(pc(w.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(h){let g;return g=typeof h=="object"?h.value:h,Gd(g)?null:g}(t.limit));let c=null;t.startAt&&(c=function(h){let g=!!h.before,_=h.values||[];return new Qr(_,g)}(t.startAt));let u=null;return t.endAt&&(u=function(h){let g=!h.before,_=h.values||[];return new Qr(_,g)}(t.endAt)),D1(e,i,o,s,a,"F",c,u)}function G5(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return G()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function eL(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=pc(t.unaryFilter.field);return ye.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=pc(t.unaryFilter.field);return ye.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=pc(t.unaryFilter.field);return ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=pc(t.unaryFilter.field);return ye.create(o,"!=",{nullValue:"NULL_VALUE"});default:return G()}}(n):n.fieldFilter!==void 0?function(t){return ye.create(pc(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return G()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ke.create(t.compositeFilter.filters.map(r=>eL(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return G()}}(t.compositeFilter.op))}(n):G()}function W5(n){return U5[n]}function K5(n){return B5[n]}function Q5(n){return j5[n]}function fc(n){return{fieldPath:n.canonicalString()}}function pc(n){return ht.fromServerFormat(n.fieldPath)}function tL(n){return n instanceof ye?function(t){if(t.op==="=="){if(lO(t.value))return{unaryFilter:{field:fc(t.field),op:"IS_NAN"}};if(uO(t.value))return{unaryFilter:{field:fc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(lO(t.value))return{unaryFilter:{field:fc(t.field),op:"IS_NOT_NAN"}};if(uO(t.value))return{unaryFilter:{field:fc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fc(t.field),op:K5(t.op),value:t.value}}}(n):n instanceof ke?function(t){let r=t.getFilters().map(i=>tL(i));return r.length===1?r[0]:{compositeFilter:{op:Q5(t.op),filters:r}}}(n):G()}function Y5(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function nL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Sc=class n{constructor(e,t,r,i,s=X.min(),o=X.min(),a=Mt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var nm=class{constructor(e){this.ct=e}};function J5(n,e){let t;if(e.document)t=Y1(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=j.fromSegments(e.noDocument.path),i=Lo(e.noDocument.readTime);t=Tt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return G();{let r=j.fromSegments(e.unknownDocument.path),i=Lo(e.unknownDocument.version);t=Tt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new Xe(i[0],i[1]);return X.fromTimestamp(s)}(e.readTime)),t}function AO(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:rm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Od(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Dc(s,o.version.toTimestamp()),createTime:Dc(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Oo(e.version)};else{if(!e.isUnknownDocument())return G();r.unknownDocument={path:t.path.toArray(),version:Oo(e.version)}}return r}function rm(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Oo(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Lo(n){let e=new Xe(n.seconds,n.nanoseconds);return X.fromTimestamp(e)}function Co(n,e){let t=(e.baseMutations||[]).map(s=>yb(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>yb(n.ct,s)),i=Xe.fromMillis(e.localWriteTimeMs);return new xd(e.batchId,i,t,r)}function yd(n){let e=Lo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Lo(n.lastLimboFreeSnapshotVersion):X.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return Y(s.documents.length===1),dn(Vc(K1(s.documents[0])))}(n.query):function(s){return dn(Z1(s))}(n.query),new Sc(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Mt.fromBase64String(n.resumeToken))}function rL(n,e){let t=Oo(e.snapshotVersion),r=Oo(e.lastLimboFreeSnapshotVersion),i;i=Yg(e.target)?J1(n.ct,e.target):X1(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Mo(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function HC(n){let e=Z1({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Xg(e,e.limit,"L"):e}function MT(n,e){return new Pd(e.largestBatchId,yb(n.ct,e.overlayMutation))}function RO(n,e){let t=e.path.lastSegment();return[n,ln(e.path.popLast()),t]}function NO(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Oo(r.readTime),documentKey:ln(r.documentKey.path),largestBatchId:r.largestBatchId}}var vb=class{getBundleMetadata(e,t){return xO(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Lo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return xO(e).put(function(i){return{bundleId:i.id,createTime:Oo(ft(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return PO(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:HC(s.bundledQuery),readTime:Lo(s.readTime)}}(r)})}saveNamedQuery(e,t){return PO(e).put(function(i){return{name:i.name,readTime:Oo(ft(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function xO(n){return kt(n,"bundles")}function PO(n){return kt(n,"namedQueries")}var im=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return fd(e).get(RO(this.userId,t)).next(r=>r?MT(this.serializer,r):null)}getOverlays(e,t){let r=qr();return N.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new Pd(t,o);i.push(this.ht(e,a))}),N.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(ln(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(fd(e).j("collectionPathOverlayIndex",a))}),N.waitFor(s)}getOverlaysForCollection(e,t,r){let i=qr(),s=ln(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return fd(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let u=MT(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=qr(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return fd(e).J({index:"collectionGroupOverlayIndex",range:a},(c,u,d)=>{let h=MT(this.serializer,u);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return fd(e).put(function(i,s,o){let[a,c,u]=RO(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ld(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function fd(n){return kt(n,"documentOverlays")}var Ei=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(ot(e.integerValue));else if("doubleValue"in e){let r=ot(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),Cd(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=bi(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(gs(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?v1(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):G()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),j.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};Ei.bt=new Ei;function X5(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function MO(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=X5(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var wb=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ct(r.value),r=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Mt(r.value),r=t.next();this.xt()}Ot(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let t=this.Bt(e),r=MO(t);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){let t=this.Bt(e),r=MO(t);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},Ib=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},Eb=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Do=class{constructor(){this.Gt=new wb,this.zt=new Ib(this.Gt),this.jt=new Eb(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var So=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function as(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=kO(n.arrayValue,e.arrayValue),t!==0?t:(t=kO(n.directionalValue,e.directionalValue),t!==0?t:j.comparator(n.documentKey,e.documentKey)))}function kO(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var sm=class{constructor(e){this.Yt=new Be((t,r)=>ht.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let r=t;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(Y(e.collectionGroup===this.collectionId),this.en)return!1;let t=qT(e);if(t!==void 0&&!this.nn(t))return!1;let r=To(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Be(ht.comparator),t=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new _c(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new _c(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new _c(r.field,r.dir==="asc"?0:1)));return new Ic(Ic.UNKNOWN_ID,this.collectionId,t,bd.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function iL(n){var e,t;if(Y(n instanceof ye||n instanceof ke),n instanceof ye){if(n instanceof Qg){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ye.create(n.field,"==",s)))||[];return ke.create(i,"or")}return n}let r=n.filters.map(i=>iL(i));return ke.create(r,n.op)}function Z5(n){if(n.getFilters().length===0)return[];let e=Cb(iL(n));return Y(sL(e)),Tb(e)||bb(e)?[e]:e.getFilters()}function Tb(n){return n instanceof ye}function bb(n){return n instanceof ke&&UC(n)}function sL(n){return Tb(n)||bb(n)||function(t){if(t instanceof ke&&XT(t)){for(let r of t.getFilters())if(!Tb(r)&&!bb(r))return!1;return!0}return!1}(n)}function Cb(n){if(Y(n instanceof ye||n instanceof ke),n instanceof ye)return n;if(n.filters.length===1)return Cb(n.filters[0]);let e=n.filters.map(r=>Cb(r)),t=ke.create(e,n.op);return t=om(t),sL(t)?t:(Y(t instanceof ke),Y(Tc(t)),Y(t.filters.length>1),t.filters.reduce((r,i)=>qC(r,i)))}function qC(n,e){let t;return Y(n instanceof ye||n instanceof ke),Y(e instanceof ye||e instanceof ke),t=n instanceof ye?e instanceof ye?function(i,s){return ke.create([i,s],"and")}(n,e):OO(n,e):e instanceof ye?OO(e,n):function(i,s){if(Y(i.filters.length>0&&s.filters.length>0),Tc(i)&&Tc(s))return T1(i,s.getFilters());let o=XT(i)?i:s,a=XT(i)?s:i,c=o.filters.map(u=>qC(u,a));return ke.create(c,"or")}(n,e),om(t)}function OO(n,e){if(Tc(e))return T1(e,n.getFilters());{let t=e.filters.map(r=>qC(n,r));return ke.create(t,"or")}}function om(n){if(Y(n instanceof ye||n instanceof ke),n instanceof ye)return n;let e=n.getFilters();if(e.length===1)return om(e[0]);if(I1(n))return n;let t=e.map(i=>om(i)),r=[];return t.forEach(i=>{i instanceof ye?r.push(i):i instanceof ke&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:ke.create(r,n.op)}var Db=class{constructor(){this._n=new Fd}addToCollectionParentIndex(e,t){return this._n.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return N.resolve()}deleteFieldIndex(e,t){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,t){return N.resolve()}getDocumentsMatchingTarget(e,t){return N.resolve(null)}getIndexType(e,t){return N.resolve(0)}getFieldIndexes(e,t){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,t){return N.resolve(Yn.min())}getMinOffsetFromCollectionGroup(e,t){return N.resolve(Yn.min())}updateCollectionGroup(e,t,r){return N.resolve()}updateIndexEntries(e,t){return N.resolve()}},Fd=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Be(be.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Be(be.comparator)).toArray()}};var xg=new Uint8Array(0),Sb=class{constructor(e,t){this.databaseId=t,this.an=new Fd,this.un=new Yr(r=>Mo(r),(r,i)=>Wd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:r,parent:ln(i)};return LO(e).put(s)}return N.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[o1(t),""],!1,!0);return LO(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(Hr(o.parent))}return r})}addFieldIndex(e,t){let r=pd(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=uc(e);return s.next(a=>{o.put(NO(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=pd(e),i=uc(e),s=cc(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=pd(e),r=cc(e),i=uc(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return N.forEach(this.cn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new sm(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=cc(e),i=!0,s=new Map;return N.forEach(this.cn(t),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=de(),a=[];return N.forEach(s,(c,u)=>{k("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`}(c)} to execute ${Mo(t)}`);let d=function(F,z){let ie=qT(z);if(ie===void 0)return null;for(let W of Jg(F,ie.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null}(u,c),h=function(F,z){let ie=new Map;for(let W of To(z))for(let T of Jg(F,W.fieldPath))switch(T.op){case"==":case"in":ie.set(W.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return ie.set(W.fieldPath.canonicalString(),T.value),Array.from(ie.values())}return null}(u,c),g=function(F,z){let ie=[],W=!0;for(let T of To(z)){let v=T.kind===0?gO(F,T.fieldPath,F.startAt):mO(F,T.fieldPath,F.startAt);ie.push(v.value),W&&(W=v.inclusive)}return new Qr(ie,W)}(u,c),_=function(F,z){let ie=[],W=!0;for(let T of To(z)){let v=T.kind===0?mO(F,T.fieldPath,F.endAt):gO(F,T.fieldPath,F.endAt);ie.push(v.value),W&&(W=v.inclusive)}return new Qr(ie,W)}(u,c),w=this.hn(c,u,g),C=this.hn(c,u,_),A=this.Pn(c,u,h),O=this.In(c.indexId,d,w,g.inclusive,C,_.inclusive,A);return N.forEach(O,H=>r.G(H,t.limit).next(F=>{F.forEach(z=>{let ie=j.fromSegments(z.documentKey);o.has(ie)||(o=o.add(ie),a.push(ie))})}))}).next(()=>a)}return N.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=Z5(ke.create(e.filters,"and")).map(r=>ab(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),u=c/(t!=null?t.length:1),d=[];for(let h=0;h<c;++h){let g=t?this.Tn(t[h/u]):xg,_=this.En(e,g,r[h%u],i),w=this.dn(e,g,s[h%u],o),C=a.map(A=>this.En(e,g,A,!0));d.push(...this.createRange(_,w,C))}return d}En(e,t,r,i){let s=new So(e,j.empty(),t,r);return i?s:s.Jt()}dn(e,t,r,i){let s=new So(e,j.empty(),t,r);return i?s.Jt():s}ln(e,t){let r=new sm(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.cn(t);return N.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Be(ht.comparator),d=!1;for(let h of c.filters)for(let g of h.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:u=u.add(g.field));for(let h of c.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}An(e,t){let r=new Do;for(let i of To(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Ei.bt.Pt(s,o)}return r.Wt()}Tn(e){let t=new Do;return Ei.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let r=new Do;return Ei.bt.Pt(xo(this.databaseId,t),r.Ht(function(s){let o=To(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,t,r){if(r===null)return[];let i=[];i.push(new Do);let s=0;for(let o of To(e)){let a=r[s++];for(let c of i)if(this.Vn(t,o.fieldPath)&&Rd(a))i=this.mn(i,o,a);else{let u=c.Ht(o.kind);Ei.bt.Pt(a,u)}}return this.fn(i)}hn(e,t,r){return this.Pn(e,t,r.position)}fn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Wt();return t}mn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new Do;c.seed(a.Wt()),Ei.bt.Pt(o,c.Ht(t.kind)),s.push(c)}return s}Vn(e,t){return!!e.filters.find(r=>r instanceof ye&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=pd(e),i=uc(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return N.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,h){let g=h?new bd(h.sequenceNumber,new Yn(Lo(h.readTime),new j(Hr(h.documentKey)),h.largestBatchId)):bd.empty(),_=d.fields.map(([w,C])=>new _c(ht.fromServerFormat(w),C));return new Ic(d.indexId,d.collectionGroup,_,g)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ue(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=pd(e),s=uc(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>N.forEach(a,c=>s.put(NO(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return N.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?N.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),N.forEach(a,c=>this.pn(e,i,c).next(u=>{let d=this.yn(s,c);return u.isEqual(d)?N.resolve():this.wn(e,s,c,u,d)}))))})}Sn(e,t,r,i){return cc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,t.key),documentKey:t.key.path.toArray()})}bn(e,t,r,i){return cc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,t.key),t.key.path.toArray()])}pn(e,t,r){let i=cc(e),s=new Be(as);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,t)])},(o,a)=>{s=s.add(new So(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,t){let r=new Be(as),i=this.An(t,e);if(i==null)return r;let s=qT(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Rd(o))for(let a of o.arrayValue.values||[])r=r.add(new So(t.indexId,e.key,this.Tn(a),i))}else r=r.add(new So(t.indexId,e.key,xg,i));return r}wn(e,t,r,i,s){k("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,u,d,h,g){let _=c.getIterator(),w=u.getIterator(),C=ac(_),A=ac(w);for(;C||A;){let O=!1,H=!1;if(C&&A){let F=d(C,A);F<0?H=!0:F>0&&(O=!0)}else C!=null?H=!0:O=!0;O?(h(A),A=ac(w)):H?(g(C),C=ac(_)):(C=ac(_),A=ac(w))}}(i,s,as,a=>{o.push(this.Sn(e,t,r,a))},a=>{o.push(this.bn(e,t,r,a))}),N.waitFor(o)}gn(e){let t=1;return uc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>as(o,a)).filter((o,a,c)=>!a||as(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=as(o,e),c=as(o,t);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,xg,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,xg,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,t){return as(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(FO)}getMinOffset(e,t){return N.mapArray(this.cn(t),r=>this.ln(e,r).next(i=>i||G())).next(FO)}};function LO(n){return kt(n,"collectionParents")}function cc(n){return kt(n,"indexEntries")}function pd(n){return kt(n,"indexConfiguration")}function uc(n){return kt(n,"indexState")}function FO(n){Y(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;LC(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Yn(e.readTime,e.documentKey,t)}var VO={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Kn=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function oL(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,h,g)=>(a++,g.delete()));s.push(c.next(()=>{Y(a===1)}));let u=[];for(let d of t.mutations){let h=h1(e,d.key.path,t.batchId);s.push(i.delete(h)),u.push(d.key)}return N.waitFor(s).next(()=>u)}function am(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw G();e=n.noDocument}return JSON.stringify(e).length}Kn.DEFAULT_COLLECTION_PERCENTILE=10,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kn.DEFAULT=new Kn(41943040,Kn.DEFAULT_COLLECTION_PERCENTILE,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kn.DISABLED=new Kn(-1,0,0);var cm=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,t,r,i){Y(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return cs(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=gc(e),o=cs(e);return o.add({}).next(a=>{Y(typeof a=="number");let c=new xd(a,t,r,i),u=function(_,w,C){let A=C.baseMutations.map(H=>Ld(_.ct,H)),O=C.mutations.map(H=>Ld(_.ct,H));return{userId:w,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:A,mutations:O}}(this.serializer,this.userId,c),d=[],h=new Be((g,_)=>ue(g.canonicalString(),_.canonicalString()));for(let g of i){let _=h1(this.userId,g.key.path,a);h=h.add(g.key.path.popLast()),d.push(o.put(u)),d.push(s.put(_,o5))}return h.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),N.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return cs(e).get(t).next(r=>r?(Y(r.userId===this.userId),Co(this.serializer,r)):null)}vn(e,t){return this.Cn[t]?N.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return cs(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(Y(a.batchId>=r),s=Co(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return cs(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return cs(e).U("userMutationsIndex",t).next(r=>r.map(i=>Co(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Og(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return gc(e).J({range:i},(o,a,c)=>{let[u,d,h]=o,g=Hr(d);if(u===this.userId&&t.path.isEqual(g))return cs(e).get(h).next(_=>{if(!_)throw G();Y(_.userId===this.userId),s.push(Co(this.serializer,_))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Be(ue),i=[];return t.forEach(s=>{let o=Og(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=gc(e).J({range:a},(u,d,h)=>{let[g,_,w]=u,C=Hr(_);g===this.userId&&s.path.isEqual(C)?r=r.add(w):h.done()});i.push(c)}),N.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Og(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Be(ue);return gc(e).J({range:o},(c,u,d)=>{let[h,g,_]=c,w=Hr(g);h===this.userId&&r.isPrefixOf(w)?w.length===i&&(a=a.add(_)):d.done()}).next(()=>this.Fn(e,a))}Fn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(cs(e).get(s).next(o=>{if(o===null)throw G();Y(o.userId===this.userId),r.push(Co(this.serializer,o))}))}),N.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return oL(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),N.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return N.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return gc(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=Hr(s[1]);i.push(c)}else a.done()}).next(()=>{Y(i.length===0)})})}containsKey(e,t){return aL(e,this.userId,t)}xn(e){return cL(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function aL(n,e,t){let r=Og(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return gc(n).J({range:s,H:!0},(a,c,u)=>{let[d,h,g]=a;d===e&&h===i&&(o=!0),u.done()}).next(()=>o)}function cs(n){return kt(n,"mutations")}function gc(n){return kt(n,"documentMutations")}function cL(n){return kt(n,"mutationQueues")}var Ac=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var Ab=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let r=new Ac(t.highestTargetId);return t.highestTargetId=r.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>X.fromTimestamp(new Xe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(t,r),this.kn(e,r))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>lc(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(Y(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return lc(e).J((o,a)=>{let c=yd(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>N.waitFor(s)).next(()=>i)}forEachTarget(e,t){return lc(e).J((r,i)=>{let s=yd(i);t(s)})}Bn(e){return UO(e).get("targetGlobalKey").next(t=>(Y(t!==null),t))}kn(e,t){return UO(e).put("targetGlobalKey",t)}qn(e,t){return lc(e).put(rL(this.serializer,t))}Qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Mo(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return lc(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let u=yd(a);Wd(t,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=us(e);return t.forEach(o=>{let a=ln(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),N.waitFor(i)}removeMatchingKeys(e,t,r){let i=us(e);return N.forEach(t,s=>{let o=ln(s.path);return N.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=us(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=us(e),s=de();return i.J({range:r,H:!0},(o,a,c)=>{let u=Hr(o[1]),d=new j(u);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=ln(t.path),i=IDBKeyRange.bound([r],[o1(r)],!1,!0),s=0;return us(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,t){return lc(e).get(t).next(r=>r?yd(r):null)}};function lc(n){return kt(n,"targets")}function UO(n){return kt(n,"targetGlobal")}function us(n){return kt(n,"targetDocuments")}function BO([n,e],[t,r]){let i=ue(n,t);return i===0?ue(e,r):i}var Rb=class{constructor(e){this.Kn=e,this.buffer=new Be(BO),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();BO(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Nb=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){k("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>m(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){bs(t)?k("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Ts(t)}yield this.zn(3e5)}))}},xb=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return N.resolve(Pn.oe);let r=new Rb(t);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(VO)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),VO):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let r,i,s,o,a,c,u,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),dc()<=fe.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function e8(n,e){return new xb(n,e)}var Pb=class{constructor(e,t){this.db=e,this.garbageCollector=e8(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Zn(e){let t=0;return this.Jn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(r,i)=>t(i))}addReference(e,t,r){return Pg(e,r)}removeReference(e,t,r){return Pg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Pg(e,t)}er(e,t){return function(i,s){let o=!1;return cL(i).Y(a=>aL(i,a,s).next(c=>(c&&(o=!0),N.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=t){let c=this.er(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,X.min()),us(e).delete(function(h){return[0,ln(h.path)]}(o))))});i.push(c)}}).next(()=>N.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Pg(e,t)}Xn(e,t){let r=us(e),i,s=Pn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==Pn.oe&&t(new j(Hr(i)),s),s=u,i=c):s=Pn.oe}).next(()=>{s!==Pn.oe&&t(new j(Hr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Pg(n,e){return us(n).put(function(r,i){return{targetId:0,path:ln(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var um=class{constructor(){this.changes=new Yr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?N.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Mb=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Eo(e).put(r)}removeEntry(e,t,r){return Eo(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],rm(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.tr(e,r)))}getEntry(e,t){let r=Tt.newInvalidDocument(t);return Eo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(gd(t))},(i,s)=>{r=this.nr(t,s)}).next(()=>r)}rr(e,t){let r={size:0,document:Tt.newInvalidDocument(t)};return Eo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(gd(t))},(i,s)=>{r={document:this.nr(t,s),size:am(s)}}).next(()=>r)}getEntries(e,t){let r=Tn();return this.ir(e,t,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,t){let r=Tn(),i=new We(j.comparator);return this.ir(e,t,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,am(o))}).next(()=>({documents:r,_r:i}))}ir(e,t,r){if(t.isEmpty())return N.resolve();let i=new Be(HO);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(gd(i.first()),gd(i.last())),o=i.getIterator(),a=o.getNext();return Eo(e).J({index:"documentKeyIndex",range:s},(c,u,d)=>{let h=j.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&HO(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.$(gd(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),rm(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Eo(e).U(IDBKeyRange.bound(a,c,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let d=Tn();for(let h of u){let g=this.nr(j.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);g.isFoundDocument()&&(Qd(t,g)||i.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=Tn(),o=$O(t,r),a=$O(t,Yn.max());return Eo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,d)=>{let h=this.nr(j.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new kb(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return jO(e).get("remoteDocumentGlobalKey").next(t=>(Y(!!t),t))}tr(e,t){return jO(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let r=J5(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(X.min())))return r}return Tt.newInvalidDocument(e)}};function uL(n){return new Mb(n)}var kb=class extends um{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new Yr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Be((s,o)=>ue(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=AO(this.ar.serializer,o);i=i.add(s.path.popLast());let u=am(c);r+=u-a.size,t.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=AO(this.ar.serializer,o.convertToNoDocument(X.min()));t.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,r)),N.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(r=>(this.ur.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function jO(n){return kt(n,"remoteDocumentGlobal")}function Eo(n){return kt(n,"remoteDocumentsV14")}function gd(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function $O(n,e){let t=e.documentKey.path.toArray();return[n,rm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function HO(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ue(t[s],r[s]),i)return i;return i=ue(t.length,r.length),i||(i=ue(t[t.length-2],r[r.length-2]),i||ue(t[t.length-1],r[r.length-1]))}var Ob=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var lm=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Id(r.mutation,i,Mn.empty(),Xe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,de()).next(()=>r))}getLocalViewOfDocuments(e,t,r=de()){let i=qr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=_d();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=qr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,de()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Tn(),o=wd(),a=function(){return wd()}();return t.forEach((c,u)=>{let d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof _r)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Id(d.mutation,u,d.mutation.getFieldMask(),Xe.now())):o.set(u.key,Mn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,d)=>o.set(u,d)),t.forEach((u,d)=>{var h;return a.set(u,new Ob(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=wd(),i=new We((o,a)=>o-a),s=de();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=t.get(c);if(u===null)return;let d=r.get(c)||Mn.empty();d=a.applyToLocalView(u,d),r.set(c,d);let h=(i.get(a.batchId)||de()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,d=c.value,h=P1();d.forEach(g=>{if(!s.has(g)){let _=B1(t.get(g),r.get(g));_!==null&&h.set(g,_),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return N.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return j.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):BC(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):N.resolve(qr()),a=-1,c=s;return o.next(u=>N.forEach(u,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?N.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,de())).next(d=>({batchId:a,changes:x1(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new j(t)).next(r=>{let i=_d();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=_d();return this.indexManager.getCollectionParents(e,s).next(a=>N.forEach(a,c=>{let u=function(h,g){return new mr(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((h,g)=>{o=o.insert(h,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,u)=>{let d=u.getKey();o.get(d)===null&&(o=o.insert(d,Tt.newInvalidDocument(d)))});let a=_d();return o.forEach((c,u)=>{let d=s.get(c);d!==void 0&&Id(d.mutation,u,Mn.empty(),Xe.now()),Qd(t,u)&&(a=a.insert(c,u))}),a})}};var Lb=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return N.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:ft(i.createTime)}}(t)),N.resolve()}getNamedQuery(e,t){return N.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:HC(i.bundledQuery),readTime:ft(i.readTime)}}(t)),N.resolve()}};var Fb=class{constructor(){this.overlays=new We(j.comparator),this.hr=new Map}getOverlay(e,t){return N.resolve(this.overlays.get(t))}getOverlays(e,t){let r=qr();return N.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),N.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),N.resolve()}getOverlaysForCollection(e,t,r){let i=qr(),s=t.length+1,o=new j(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return N.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new We((u,d)=>u-d),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=qr(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=qr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return N.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Pd(t,r));let s=this.hr.get(t);s===void 0&&(s=de(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var Vd=class{constructor(){this.Pr=new Be(wt.Ir),this.Tr=new Be(wt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new wt(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new wt(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new j(new be([])),r=new wt(t,e),i=new wt(t,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new j(new be([])),r=new wt(t,e),i=new wt(t,e+1),s=de();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new wt(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},wt=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return j.comparator(e.key,t.key)||ue(e.pr,t.pr)}static Er(e,t){return ue(e.pr,t.pr)||j.comparator(e.key,t.key)}};var Vb=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new Be(wt.Ir)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new xd(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new wt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return N.resolve(o)}lookupMutationBatch(e,t){return N.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return N.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new wt(t,0),i=new wt(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),N.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Be(ue);return t.forEach(i=>{let s=new wt(i,0),o=new wt(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),N.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;j.isDocumentKey(s)||(s=s.child(""));let o=new wt(new j(s),0),a=new Be(ue);return this.wr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.pr)),!0)},o),N.resolve(this.Dr(a))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Y(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return N.forEach(t.mutations,i=>{let s=new wt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new wt(t,0),i=this.wr.firstAfterOrEqual(r);return N.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Ub=class{constructor(e){this.vr=e,this.docs=function(){return new We(j.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return N.resolve(r?r.document.mutableCopy():Tt.newInvalidDocument(t))}getEntries(e,t){let r=Tn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Tt.newInvalidDocument(i))}),N.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Tn(),o=t.path,a=new j(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||LC(c1(d),r)<=0||(i.has(d.key)||Qd(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return N.resolve(s)}getAllFromCollectionGroup(e,t,r,i){G()}Fr(e,t){return N.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Bb(this)}getSize(e){return N.resolve(this.size)}},Bb=class extends um{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),N.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var jb=class{constructor(e){this.persistence=e,this.Mr=new Yr(t=>Mo(t),Wd),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Vd,this.targetCount=0,this.Lr=Ac.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),N.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new Ac(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.qn(t),N.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),N.waitFor(s).next(()=>i)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return N.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),N.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),N.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),N.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return N.resolve(r)}containsKey(e,t){return N.resolve(this.Nr.containsKey(t))}};var dm=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new Pn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new jb(this),this.indexManager=new Db,this.remoteDocumentCache=function(i){return new Ub(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new nm(t),this.$r=new Lb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Fb,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new Vb(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){k("MemoryPersistence","Starting transaction:",e);let i=new $b(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return N.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},$b=class extends qg{constructor(e){super(),this.currentSequenceNumber=e}},hm=class n{constructor(e){this.persistence=e,this.zr=new Vd,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw G()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),N.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),N.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.Jr,r=>{let i=j.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,X.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return N.or([()=>N.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var Hb=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new zg("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",oO,{unique:!0}),c.createObjectStore("documentMutations")}(e),qO(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=N.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),qO(e)),o=o.next(()=>function(c){let u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:X.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",oO,{unique:!0});let h=u.store("mutations"),g=d.map(_=>h.put(_));return N.waitFor(g)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let u=c.createObjectStore("documentOverlays",{keyPath:y5});u.createIndex("collectionPathOverlayIndex",v5,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",w5,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let u=c.createObjectStore("remoteDocumentsV14",{keyPath:a5});u.createIndex("documentKeyIndex",c5),u.createIndex("collectionGroupIndex",u5)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:p5}).createIndex("sequenceNumberIndex",g5,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:m5}).createIndex("documentKeyIndex",_5,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=am(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>N.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>N.forEach(a,c=>{Y(c.userId===s.userId);let u=Co(this.serializer,c);return oL(e,s.userId,u).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new be(o),u=function(h){return[0,ln(h)]}(c);s.push(t.get(u).next(d=>d?N.resolve():(h=>t.put({targetId:0,path:ln(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>N.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:f5});let r=t.store("collectionParents"),i=new Fd,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:ln(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new be(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],u)=>{let d=Hr(a);return s(d.popLast())}))}ri(e){let t=e.store("targets");return t.J((r,i)=>{let s=yd(i),o=rL(this.serializer,s);return t.put(o)})}ii(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(h){return h.document?new j(be.fromString(h.document.name).popFirst(5)):h.noDocument?j.fromSegments(h.noDocument.path):h.unknownDocument?j.fromSegments(h.unknownDocument.path):G()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>N.waitFor(i))}si(e,t){let r=t.store("mutations"),i=uL(this.serializer),s=new dm(hm.Hr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var u;let d=(u=a.get(c.userId))!==null&&u!==void 0?u:de();Co(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),N.forEach(a,(c,u)=>{let d=new It(u),h=im.lt(this.serializer,d),g=s.getIndexManager(d),_=cm.lt(d,this.serializer,g,s.referenceDelegate);return new lm(i,_,h,g).recalculateAndSaveOverlaysForDocumentKeys(new Dd(t,Pn.oe),c).next()})})}};function qO(n){n.createObjectStore("targetDocuments",{keyPath:d5}).createIndex("documentTargetsIndex",h5,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",l5,{unique:!0}),n.createObjectStore("targetGlobal")}var kT="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",qb=class n{constructor(e,t,r,i,s,o,a,c,u,d,h=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=u,this.ai=d,this.ui=h,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=g=>Promise.resolve(),!n.D())throw new M(P.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Pb(this,i),this.Ti=t+"main",this.serializer=new nm(c),this.Ei=new ps(this.Ti,this.ui,new Hb(this.serializer)),this.Qr=new Ab(this.referenceDelegate,this.serializer),this.remoteDocumentCache=uL(this.serializer),this.$r=new vb,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,d===!1&&dt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new M(P.FAILED_PRECONDITION,kT);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new Pn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>m(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>m(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>m(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Mg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(bs(e))return k("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return md(e).get("owner").next(t=>N.resolve(this.Si(t)))}bi(e){return Mg(e).delete(this.clientId)}Di(){return m(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=kt(t,"clientMetadata");return r.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return N.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?N.resolve(!0):md(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new M(P.FAILED_PRECONDITION,kT);return!1}}return!(!this.networkEnabled||!this.inForeground)||Mg(e).U().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return m(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Dd(e,Pn.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(r=>this.Ci(r.updateTimeMs,t)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Mg(e).U().next(t=>this.vi(t,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return cm.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Sb(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return im.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,r){k("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===16?E5:c===15?m1:c===14?g1:c===13?p1:c===12?I5:c===11?f1:void G()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Dd(a,this.kr?this.kr.next():Pn.oe),t==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw dt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new M(P.FAILED_PRECONDITION,u1);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return md(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new M(P.FAILED_PRECONDITION,kT)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return md(e).put("owner",t)}static D(){return ps.D()}yi(e){let t=md(e);return t.get("owner").next(r=>this.Si(r)?(k("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):N.resolve())}Ci(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(dt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;DI()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let r=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return k("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return dt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){dt("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function md(n){return kt(n,"owner")}function Mg(n){return kt(n,"clientMetadata")}function zC(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var zb=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=de(),i=de();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Gb=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var fm=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return DI()?8:l1(Ue())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Gb;return this.Ji(e,t,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(dc()<=fe.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",hc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),N.resolve()):(dc()<=fe.DEBUG&&k("QueryEngine","Query:",hc(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(dc()<=fe.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",hc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dn(t))):N.resolve())}ji(e,t){if(_O(t))return N.resolve(null);let r=dn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Xg(t,null,"F"),r=dn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=de(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.Zi(t,a);return this.Xi(t,u,o,c.readTime)?this.ji(e,Xg(t,null,"F")):this.es(e,u,t,c)}))})))}Hi(e,t,r,i){return _O(t)||i.isEqual(X.min())?N.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,r,i)?N.resolve(null):(dc()<=fe.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),hc(t)),this.es(e,o,t,a1(i,-1)).next(a=>a))})}Zi(e,t){let r=new Be(R1(e));return t.forEach((i,s)=>{Qd(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return dc()<=fe.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",hc(t)),this.zi.getDocumentsMatchingQuery(e,t,Yn.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Wb=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new We(ue),this.rs=new Yr(s=>Mo(s),Wd),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lm(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function lL(n,e,t,r){return new Wb(n,e,t,r)}function dL(n,e){return m(this,null,function*(){let t=$(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=de();for(let u of i){o.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}for(let u of s){a.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(u=>({us:u,removedBatchIds:o,addedBatchIds:a}))})})})}function t8(n,e){let t=$(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(a,c,u,d){let h=u.batch,g=h.keys(),_=N.resolve();return g.forEach(w=>{_=_.next(()=>d.getEntry(c,w)).next(C=>{let A=u.docVersions.get(w);Y(A!==null),C.version.compareTo(A)<0&&(h.applyToRemoteDocument(C,u),C.isValidDocument()&&(C.setReadTime(u.commitVersion),d.addEntry(C)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=de();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function hL(n){let e=$(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function n8(n,e){let t=$(n),r=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let a=[];e.targetChanges.forEach((d,h)=>{let g=i.get(h);if(!g)return;a.push(t.Qr.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Qr.addMatchingKeys(s,d.addedDocuments,h)));let _=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?_=_.withResumeToken(Mt.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(h,_),function(C,A,O){return C.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(g,_,d)&&a.push(t.Qr.updateTargetData(s,_))});let c=Tn(),u=de();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(fL(s,o,e.documentUpdates).next(d=>{c=d.cs,u=d.ls})),!r.isEqual(X.min())){let d=t.Qr.getLastRemoteSnapshotVersion(s).next(h=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return N.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(t.ns=i,s))}function fL(n,e,t){let r=de(),i=de();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Tn();return t.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(X.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):k("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{cs:o,ls:i}})}function r8(n,e){let t=$(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Rc(n,e){let t=$(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,N.resolve(i)):t.Qr.allocateTargetId(r).next(o=>(i=new Sc(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}function Nc(n,e,t){return m(this,null,function*(){let r=$(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!bs(o))throw o;k("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function pm(n,e,t){let r=$(n),i=X.min(),s=de();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){let h=$(c),g=h.rs.get(d);return g!==void 0?N.resolve(h.ns.get(g)):h.Qr.getTargetData(u,d)}(r,o,dn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?i:X.min(),t?s:de())).next(a=>(mL(r,A1(e),a),{documents:a,hs:s})))}function pL(n,e){let t=$(n),r=$(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function gL(n,e){let t=$(n),r=t.ss.get(e)||X.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,a1(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(mL(t,e,i),i))}function mL(n,e,t){let r=n.ss.get(e)||X.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}function i8(n,e,t,r){return m(this,null,function*(){let i=$(n),s=de(),o=Tn();for(let u of t){let d=e.Ps(u.metadata.name);u.document&&(s=s.add(d));let h=e.Is(u);h.setReadTime(e.Ts(u.metadata.readTime)),o=o.insert(d,h)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield Rc(i,function(d){return dn(Vc(be.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>fL(u,a,o).next(d=>(a.apply(u),d)).next(d=>i.Qr.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.Qr.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,d.cs,d.ls)).next(()=>d.cs)))})}function s8(r,i){return m(this,arguments,function*(n,e,t=de()){let s=yield Rc(n,dn(HC(e.bundledQuery))),o=$(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=ft(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let u=s.withResumeToken(Mt.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(u.targetId,u),o.Qr.updateTargetData(a,u).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,t,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function zO(n,e){return`firestore_clients_${n}_${e}`}function GO(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function OT(n,e){return`firestore_targets_${n}_${e}`}var gm=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Es(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new M(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(dt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Ed=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Es(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new M(r.error.code,r.error.message))),s?new n(e,r.state,i):(dt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},mm=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=jC();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=d1(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(dt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},Kb=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(dt("SharedClientState",`Failed to parse online state: ${e}`),null)}},Ud=class{constructor(){this.activeTargetIds=jC()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Td=class{constructor(e,t,r,i,s){this.window=e,this.oi=t,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new We(ue),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=zO(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Ud),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return m(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(zO(this.persistenceKey,r));if(i){let s=mm.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let r=this.xs(t);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,r){this.Ls(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(OT(this.persistenceKey,e));if(r){let i=Ed.Es(e,r);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(OT(this.persistenceKey,e))}updateQueryState(e,t,r){this.qs(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k("SharedClientState","READ",e,t),t}setItem(e,t){k("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){k("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(k("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void dt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>m(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let r=this.$s(t.key);return this.Us(r,null)}{let r=this.Ws(t.key,t.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let r=this.Gs(t.key,t.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let r=this.js(t.key,t.newValue);if(r)return this.Hs(r)}}else if(t.key===this.vs){if(t.newValue!==null){let r=this.xs(t.newValue);if(r)return this.Os(r)}}else if(t.key===this.Ss){let r=function(s){let o=Pn.oe;if(s!=null)try{let a=JSON.parse(s);Y(typeof a=="number"),o=a}catch(a){dt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Pn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Fs){let r=this.Js(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,r){let i=new gm(this.currentUser,e,t,r),s=GO(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let t=GO(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,r){let i=OT(this.persistenceKey,e),s=new Ed(e,t,r);this.setItem(i,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let r=this.$s(e);return mm.Es(r,t)}Gs(e,t){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return gm.Es(new It(s),i,t)}js(e,t){let r=this.Cs.exec(e),i=Number(r[1]);return Ed.Es(i,t)}xs(e){return Kb.Es(e)}Js(e){return JSON.parse(e)}zs(e){return m(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);k("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let r=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=jC();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},_m=class{constructor(){this.no=new Ud,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Ud,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Qb=class{io(e){}shutdown(){}};var ym=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var kg=null;function LT(){return kg===null?kg=function(){return 268435456+Math.round(2147483648*Math.random())}():kg++,"0x"+kg.toString(16)}var o8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Yb=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var Jt="WebChannelConnection",Jb=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,o){let a=LT(),c=this.vo(t,r.toUriEncodedString());k("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(u,s,o),this.Mo(t,c,u,i).then(d=>(k("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Qn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}xo(t,r,i,s,o,a){return this.Co(t,r,i,s,o)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Fc}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,r){let i=o8[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=LT();return new Promise((o,a)=>{let c=new ST;c.setWithCredentials(!0),c.listenOnce(RT.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case hd.NO_ERROR:let d=c.getResponseJson();k(Jt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case hd.TIMEOUT:k(Jt,`RPC '${e}' ${s} timed out`),a(new M(P.DEADLINE_EXCEEDED,"Request time out"));break;case hd.HTTP_ERROR:let h=c.getStatus();if(k(Jt,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);let _=g?.error;if(_&&_.status&&_.message){let w=function(A){let O=A.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(O)>=0?O:P.UNKNOWN}(_.status);a(new M(w,_.message))}else a(new M(P.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new M(P.UNAVAILABLE,"Connection failed."));break;default:G()}}finally{k(Jt,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);k(Jt,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",u,r,15)})}Oo(e,t,r){let i=LT(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=PT(),a=xT(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new AT({})),this.Fo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");k(Jt,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c),g=!1,_=!1,w=new Yb({lo:A=>{_?k(Jt,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(g||(k(Jt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),g=!0),k(Jt,`RPC '${e}' stream ${i} sending:`,A),h.send(A))},ho:()=>h.close()}),C=(A,O,H)=>{A.listen(O,F=>{try{H(F)}catch(z){setTimeout(()=>{throw z},0)}})};return C(h,oc.EventType.OPEN,()=>{_||(k(Jt,`RPC '${e}' stream ${i} transport opened.`),w.mo())}),C(h,oc.EventType.CLOSE,()=>{_||(_=!0,k(Jt,`RPC '${e}' stream ${i} transport closed`),w.po())}),C(h,oc.EventType.ERROR,A=>{_||(_=!0,Qn(Jt,`RPC '${e}' stream ${i} transport errored:`,A),w.po(new M(P.UNAVAILABLE,"The operation could not be completed")))}),C(h,oc.EventType.MESSAGE,A=>{var O;if(!_){let H=A.data[0];Y(!!H);let F=H,z=F.error||((O=F[0])===null||O===void 0?void 0:O.error);if(z){k(Jt,`RPC '${e}' stream ${i} received error:`,z);let ie=z.status,W=function(I){let b=vt[I];if(b!==void 0)return H1(b)}(ie),T=z.message;W===void 0&&(W=P.INTERNAL,T="Unknown error status: "+ie+" with message "+z.message),_=!0,w.po(new M(W,T)),h.close()}else k(Jt,`RPC '${e}' stream ${i} received:`,H),w.yo(H)}}),C(a,NT.STAT_EVENT,A=>{A.stat===Ng.PROXY?k(Jt,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===Ng.NOPROXY&&k(Jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}};function _L(){return typeof window<"u"?window:null}function Ug(){return typeof document<"u"?document:null}function Yd(n){return new pb(n,!0)}var Bd=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var vm=class{constructor(e,t,r,i,s,o,a,c){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Bd(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return m(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return m(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return m(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(dt(t.toString()),dt("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new M(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>m(this,null,function*(){this.state=0,this.start()}))}c_(e){return k("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Xb=class extends vm{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=q5(this.serializer,e),r=function(s){if(!("targetChange"in s))return X.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?X.min():o.readTime?ft(o.readTime):X.min()}(e);return this.listener.h_(t,r)}P_(e){let t={};t.database=_b(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=Yg(c)?{documents:J1(s,c)}:{query:X1(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=z1(s,o.resumeToken);let u=gb(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(X.min())>0){a.readTime=Dc(s,o.snapshotVersion.toTimestamp());let u=gb(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=G5(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){let t={};t.database=_b(this.serializer),t.removeTarget=e,this.i_(t)}},Zb=class extends vm{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(Y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=z5(e.writeResults,e.commitTime),r=ft(e.commitTime);return this.listener.A_(r,t)}return Y(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=_b(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Ld(this.serializer,r))};this.i_(t)}};var eC=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,mb(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(P.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,mb(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(P.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},tC=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(dt(t),this.y_=!1):k("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var nC=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>m(this,null,function*(){Cs(this)&&(k("RemoteStore","Restarting streams for network reachability change."),yield function(c){return m(this,null,function*(){let u=$(c);u.M_.add(4),yield Uc(u),u.N_.set("Unknown"),u.M_.delete(4),yield Jd(u)})}(this))}))}),this.N_=new tC(r,i)}};function Jd(n){return m(this,null,function*(){if(Cs(n))for(let e of n.x_)yield e(!0)})}function Uc(n){return m(this,null,function*(){for(let e of n.x_)yield e(!1)})}function Vm(n,e){let t=$(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),KC(t)?WC(t):jc(t).Xo()&&GC(t,e))}function xc(n,e){let t=$(n),r=jc(t);t.F_.delete(e),r.Xo()&&yL(t,e),t.F_.size===0&&(r.Xo()?r.n_():Cs(t)&&t.N_.set("Unknown"))}function GC(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(X.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}jc(n).P_(e)}function yL(n,e){n.L_.xe(e),jc(n).I_(e)}function WC(n){n.L_=new fb({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),jc(n).start(),n.N_.w_()}function KC(n){return Cs(n)&&!jc(n).Zo()&&n.F_.size>0}function Cs(n){return $(n).M_.size===0}function vL(n){n.L_=void 0}function a8(n){return m(this,null,function*(){n.N_.set("Online")})}function c8(n){return m(this,null,function*(){n.F_.forEach((e,t)=>{GC(n,e)})})}function u8(n,e){return m(this,null,function*(){vL(n),KC(n)?(n.N_.D_(e),WC(n)):n.N_.set("Unknown")})}function l8(n,e,t){return m(this,null,function*(){if(n.N_.set("Online"),e instanceof em&&e.state===2&&e.cause)try{yield function(i,s){return m(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(n,e)}catch(r){k("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield wm(n,r)}else if(e instanceof vc?n.L_.Ke(e):e instanceof Zg?n.L_.He(e):n.L_.We(e),!t.isEqual(X.min()))try{let r=yield hL(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.F_.get(u);d&&s.F_.set(u,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let d=s.F_.get(c);if(!d)return;s.F_.set(c,d.withResumeToken(Mt.EMPTY_BYTE_STRING,d.snapshotVersion)),yL(s,c);let h=new Sc(d.target,c,u,d.sequenceNumber);GC(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){k("RemoteStore","Failed to raise snapshot:",r),yield wm(n,r)}})}function wm(n,e,t){return m(this,null,function*(){if(!bs(e))throw e;n.M_.add(1),yield Uc(n),n.N_.set("Offline"),t||(t=()=>hL(n.localStore)),n.asyncQueue.enqueueRetryable(()=>m(this,null,function*(){k("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield Jd(n)}))})}function wL(n,e){return e().catch(t=>wm(n,t,e))}function Bc(n){return m(this,null,function*(){let e=$(n),t=Es(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;d8(e);)try{let i=yield r8(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,h8(e,i)}catch(i){yield wm(e,i)}IL(e)&&EL(e)})}function d8(n){return Cs(n)&&n.v_.length<10}function h8(n,e){n.v_.push(e);let t=Es(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function IL(n){return Cs(n)&&!Es(n).Zo()&&n.v_.length>0}function EL(n){Es(n).start()}function f8(n){return m(this,null,function*(){Es(n).V_()})}function p8(n){return m(this,null,function*(){let e=Es(n);for(let t of n.v_)e.d_(t.mutations)})}function g8(n,e,t){return m(this,null,function*(){let r=n.v_.shift(),i=lb.from(r,e,t);yield wL(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Bc(n)})}function m8(n,e){return m(this,null,function*(){e&&Es(n).E_&&(yield function(r,i){return m(this,null,function*(){if(function(o){return $1(o)&&o!==P.ABORTED}(i.code)){let s=r.v_.shift();Es(r).t_(),yield wL(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Bc(r)}})}(n,e)),IL(n)&&EL(n)})}function WO(n,e){return m(this,null,function*(){let t=$(n);t.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");let r=Cs(t);t.M_.add(3),yield Uc(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield Jd(t)})}function rC(n,e){return m(this,null,function*(){let t=$(n);e?(t.M_.delete(2),yield Jd(t)):e||(t.M_.add(2),yield Uc(t),t.N_.set("Unknown"))})}function jc(n){return n.B_||(n.B_=function(t,r,i){let s=$(t);return s.f_(),new Xb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:a8.bind(null,n),To:c8.bind(null,n),Ao:u8.bind(null,n),h_:l8.bind(null,n)}),n.x_.push(e=>m(this,null,function*(){e?(n.B_.t_(),KC(n)?WC(n):n.N_.set("Unknown")):(yield n.B_.stop(),vL(n))}))),n.B_}function Es(n){return n.k_||(n.k_=function(t,r,i){let s=$(t);return s.f_(),new Zb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:f8.bind(null,n),Ao:m8.bind(null,n),R_:p8.bind(null,n),A_:g8.bind(null,n)}),n.x_.push(e=>m(this,null,function*(){e?(n.k_.t_(),yield Bc(n)):(yield n.k_.stop(),n.v_.length>0&&(k("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var iC=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Et,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function $c(n,e){if(dt("AsyncQueue",`${e}: ${n}`),bs(n))return new M(P.UNAVAILABLE,`${e}: ${n}`);throw n}var Im=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||j.comparator(t.key,r.key):(t,r)=>j.comparator(t.key,r.key),this.keyedMap=_d(),this.sortedSet=new We(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Em=class{constructor(){this.q_=new We(j.comparator)}track(e){let t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):G():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}},Pc=class n{constructor(e,t,r,i,s,o,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Im.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var sC=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},oC=class{constructor(){this.queries=new Yr(e=>S1(e),Kd),this.onlineState="Unknown",this.z_=new Set}};function QC(n,e){return m(this,null,function*(){let t=$(n),r=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new sC,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=$c(o,`Initialization of query '${hc(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&JC(t)})}function YC(n,e){return m(this,null,function*(){let t=$(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function _8(n,e){let t=$(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&JC(t)}function y8(n,e,t){let r=$(n),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(t);r.queries.delete(e)}function JC(n){n.z_.forEach(e=>{e.next()})}var aC,KO;(KO=aC||(aC={})).J_="default",KO.Cache="cache";var jd=class{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Pc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Pc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==aC.Cache}};var cC=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var Tm=class{constructor(e){this.serializer=e}Ps(e){return Gr(this.serializer,e)}Is(e){return e.metadata.exists?Y1(this.serializer,e.document,!1):Tt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return ft(e)}},uC=class{constructor(e,t,r){this.oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=TL(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let r=be.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,r=new Tm(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||de()).add(s);t.set(o,a)}}return t}complete(){return m(this,null,function*(){let e=yield i8(this.localStore,new Tm(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let r of this.queries)yield s8(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function TL(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var bm=class{constructor(e){this.key=e}},Cm=class{constructor(e){this.key=e}},Dm=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=de(),this.mutatedKeys=de(),this.Ia=R1(e),this.Ta=new Im(this.Ia)}get Ea(){return this.la}da(e,t){let r=t?t.Aa:new Em,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let g=i.get(d),_=Qd(this.query,h)?h:null,w=!!g&&this.mutatedKeys.has(g.key),C=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),A=!1;g&&_?g.data.isEqual(_.data)?w!==C&&(r.track({type:3,doc:_}),A=!0):this.Ra(g,_)||(r.track({type:2,doc:_}),A=!0,(c&&this.Ia(_,c)>0||u&&this.Ia(_,u)<0)&&(a=!0)):!g&&_?(r.track({type:0,doc:_}),A=!0):g&&!_&&(r.track({type:1,doc:g}),A=!0,(c||u)&&(a=!0)),A&&(_?(o=o.add(_),s=C?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((d,h)=>function(_,w){let C=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return G()}};return C(_)-C(w)}(d.type,h.type)||this.Ia(d.doc,h.doc)),this.Va(r),i=i!=null&&i;let a=t&&!i?this.ma():[],c=this.Pa.size===0&&this.current&&!i?1:0,u=c!==this.ha;return this.ha=c,o.length!==0||u?{snapshot:new Pc(this.query,e.Ta,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new Em,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=de(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new Cm(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new bm(r))}),t}pa(e){this.la=e.hs,this.Pa=de();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Pc.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},lC=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},dC=class{constructor(e){this.key=e,this.wa=!1}},hC=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new Yr(a=>S1(a),Kd),this.Da=new Map,this.Ca=new Set,this.va=new We(j.comparator),this.Fa=new Map,this.Ma=new Vd,this.xa={},this.Oa=new Map,this.Na=Ac.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function v8(n,e,t=!0){return m(this,null,function*(){let r=Um(n),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield bL(r,e,t,!0),i})}function w8(n,e){return m(this,null,function*(){let t=Um(n);yield bL(t,e,!0,!1)})}function bL(n,e,t,r){return m(this,null,function*(){let i=yield Rc(n.localStore,dn(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield XC(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Vm(n.remoteStore,i),a})}function XC(n,e,t,r,i){return m(this,null,function*(){n.Ba=(h,g,_)=>function(C,A,O,H){return m(this,null,function*(){let F=A.view.da(O);F.Xi&&(F=yield pm(C.localStore,A.query,!1).then(({documents:T})=>A.view.da(T,F)));let z=H&&H.targetChanges.get(A.targetId),ie=H&&H.targetMismatches.get(A.targetId)!=null,W=A.view.applyChanges(F,C.isPrimaryClient,z,ie);return fC(C,A.targetId,W.fa),W.snapshot})}(n,h,g,_);let s=yield pm(n.localStore,e,!0),o=new Dm(e,s.hs),a=o.da(s.documents),c=kd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=o.applyChanges(a,n.isPrimaryClient,c);fC(n,t,u.fa);let d=new lC(e,t,o);return n.ba.set(e,d),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),u.snapshot})}function I8(n,e,t){return m(this,null,function*(){let r=$(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!Kd(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Nc(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&xc(r.remoteStore,i.targetId),Mc(r,i.targetId)}).catch(Ts))):(Mc(r,i.targetId),yield Nc(r.localStore,i.targetId,!0))})}function E8(n,e){return m(this,null,function*(){let t=$(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),xc(t.remoteStore,r.targetId))})}function T8(n,e,t){return m(this,null,function*(){let r=nD(n);try{let i=yield function(o,a){let c=$(o),u=Xe.now(),d=a.reduce((_,w)=>_.add(w.key),de()),h,g;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let w=Tn(),C=de();return c.os.getEntries(_,d).next(A=>{w=A,w.forEach((O,H)=>{H.isValidDocument()||(C=C.add(O))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,w)).next(A=>{h=A;let O=[];for(let H of a){let F=F5(H,h.get(H.key).overlayedDocument);F!=null&&O.push(new _r(H.key,F,w1(F.value.mapValue),at.exists(!0)))}return c.mutationQueue.addMutationBatch(_,u,O,a)}).next(A=>{g=A;let O=A.applyToLocalDocumentSet(h,C);return c.documentOverlayCache.saveOverlays(_,A.batchId,O)})}).then(()=>({batchId:g.batchId,changes:x1(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.xa[o.currentUser.toKey()];u||(u=new We(ue)),u=u.insert(a,c),o.xa[o.currentUser.toKey()]=u}(r,i.batchId,t),yield Ri(r,i.changes),yield Bc(r.remoteStore)}catch(i){let s=$c(i,"Failed to persist write");t.reject(s)}})}function CL(n,e){return m(this,null,function*(){let t=$(n);try{let r=yield n8(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(Y(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?Y(o.wa):i.removedDocuments.size>0&&(Y(o.wa),o.wa=!1))}),yield Ri(t,r,e)}catch(r){yield Ts(r)}})}function QO(n,e,t){let r=$(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=$(o);c.onlineState=a;let u=!1;c.queries.forEach((d,h)=>{for(let g of h.U_)g.j_(a)&&(u=!0)}),u&&JC(c)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function b8(n,e,t){return m(this,null,function*(){let r=$(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new We(j.comparator);o=o.insert(s,Tt.newNoDocument(s,X.min()));let a=de().add(s),c=new Md(X.min(),new Map,new We(ue),o,a);yield CL(r,c),r.va=r.va.remove(s),r.Fa.delete(e),tD(r)}else yield Nc(r.localStore,e,!1).then(()=>Mc(r,e,t)).catch(Ts)})}function C8(n,e){return m(this,null,function*(){let t=$(n),r=e.batch.batchId;try{let i=yield t8(t.localStore,e);eD(t,r,null),ZC(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ri(t,i)}catch(i){yield Ts(i)}})}function D8(n,e,t){return m(this,null,function*(){let r=$(n);try{let i=yield function(o,a){let c=$(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next(h=>(Y(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);eD(r,e,t),ZC(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ri(r,i)}catch(i){yield Ts(i)}})}function S8(n,e){return m(this,null,function*(){let t=$(n);Cs(t.remoteStore)||k("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=$(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Oa.get(r)||[];i.push(e),t.Oa.set(r,i)}catch(r){let i=$c(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function ZC(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function eD(n,e,t){let r=$(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Mc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||DL(n,r)})}function DL(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(xc(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),tD(n))}function fC(n,e,t){for(let r of t)r instanceof bm?(n.Ma.addReference(r.key,e),A8(n,r)):r instanceof Cm?(k("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||DL(n,r.key)):G()}function A8(n,e){let t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(k("SyncEngine","New document in limbo: "+t),n.Ca.add(r),tD(n))}function tD(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new j(be.fromString(e)),r=n.Na.next();n.Fa.set(r,new dC(t)),n.va=n.va.insert(t,r),Vm(n.remoteStore,new Sc(dn(Vc(t.path)),r,"TargetPurposeLimboResolution",Pn.oe))}}function Ri(n,e,t){return m(this,null,function*(){let r=$(n),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,c)=>{o.push(r.Ba(c,e,t).then(u=>{if((u||t)&&r.isPrimaryClient){let d=u&&!u.fromCache;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(u){i.push(u);let d=zb.Ki(c.targetId,u);s.push(d)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(c,u){return m(this,null,function*(){let d=$(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>N.forEach(u,g=>N.forEach(g.qi,_=>d.persistence.referenceDelegate.addReference(h,g.targetId,_)).next(()=>N.forEach(g.Qi,_=>d.persistence.referenceDelegate.removeReference(h,g.targetId,_)))))}catch(h){if(!bs(h))throw h;k("LocalStore","Failed to update sequence numbers: "+h)}for(let h of u){let g=h.targetId;if(!h.fromCache){let _=d.ns.get(g),w=_.snapshotVersion,C=_.withLastLimboFreeSnapshotVersion(w);d.ns=d.ns.insert(g,C)}}})}(r.localStore,s))})}function R8(n,e){return m(this,null,function*(){let t=$(n);if(!t.currentUser.isEqual(e)){k("SyncEngine","User change. New user:",e.toKey());let r=yield dL(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(c=>{c.reject(new M(P.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ri(t,r.us)}})}function N8(n,e){let t=$(n),r=t.Fa.get(e);if(r&&r.wa)return de().add(r.key);{let i=de(),s=t.Da.get(e);if(!s)return i;for(let o of s){let a=t.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function x8(n,e){return m(this,null,function*(){let t=$(n),r=yield pm(t.localStore,e.query,!0),i=e.view.pa(r);return t.isPrimaryClient&&fC(t,e.targetId,i.fa),i})}function P8(n,e){return m(this,null,function*(){let t=$(n);return gL(t.localStore,e).then(r=>Ri(t,r))})}function M8(n,e,t,r){return m(this,null,function*(){let i=$(n),s=yield function(a,c){let u=$(a),d=$(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.vn(h,c).next(g=>g?u.localDocuments.getDocuments(h,g):N.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield Bc(i.remoteStore):t==="acknowledged"||t==="rejected"?(eD(i,e,r||null),ZC(i,e),function(a,c){$($(a).mutationQueue).Mn(c)}(i.localStore,e)):G(),yield Ri(i,s)):k("SyncEngine","Cannot apply mutation batch with id: "+e)})}function k8(n,e){return m(this,null,function*(){let t=$(n);if(Um(t),nD(t),e===!0&&t.La!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield YO(t,r.toArray());t.La=!0,yield rC(t.remoteStore,!0);for(let s of i)Vm(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let r=[],i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Mc(t,o),Nc(t.localStore,o,!0))),xc(t.remoteStore,o)}),yield i,yield YO(t,r),function(o){let a=$(o);a.Fa.forEach((c,u)=>{xc(a.remoteStore,u)}),a.Ma.mr(),a.Fa=new Map,a.va=new We(j.comparator)}(t),t.La=!1,yield rC(t.remoteStore,!1)}})}function YO(n,e,t){return m(this,null,function*(){let r=$(n),i=[],s=[];for(let o of e){let a,c=r.Da.get(o);if(c&&c.length!==0){a=yield Rc(r.localStore,dn(c[0]));for(let u of c){let d=r.ba.get(u),h=yield x8(r,d);h.snapshot&&s.push(h.snapshot)}}else{let u=yield pL(r.localStore,o);a=yield Rc(r.localStore,u),yield XC(r,SL(u),o,!1,a.resumeToken)}i.push(a)}return r.Sa.h_(s),i})}function SL(n){return D1(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function O8(n){return function(t){return $($(t).persistence).Bi()}($(n).localStore)}function L8(n,e,t,r){return m(this,null,function*(){let i=$(n);if(i.La)return void k("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield gL(i.localStore,A1(s[0])),a=Md.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Mt.EMPTY_BYTE_STRING);yield Ri(i,o,a);break}case"rejected":yield Nc(i.localStore,e,!0),Mc(i,e,r);break;default:G()}})}function F8(n,e,t){return m(this,null,function*(){let r=Um(n);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){k("SyncEngine","Adding an already active target "+i);continue}let s=yield pL(r.localStore,i),o=yield Rc(r.localStore,s);yield XC(r,SL(s),o.targetId,!1,o.resumeToken),Vm(r.remoteStore,o)}for(let i of t)r.Da.has(i)&&(yield Nc(r.localStore,i,!1).then(()=>{xc(r.remoteStore,i),Mc(r,i)}).catch(Ts))}})}function Um(n){let e=$(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=CL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=N8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=b8.bind(null,e),e.Sa.h_=_8.bind(null,e.eventManager),e.Sa.ka=y8.bind(null,e.eventManager),e}function nD(n){let e=$(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=C8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=D8.bind(null,e),e}function V8(n,e,t){let r=$(n);(function(s,o,a){return m(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(_,w){let C=$(_),A=ft(w.createTime);return C.persistence.runTransaction("hasNewerBundle","readonly",O=>C.$r.getBundleMetadata(O,w.id)).then(O=>!!O&&O.createTime.compareTo(A)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(TL(c));let u=new uC(c,s.localStore,o.serializer),d=yield o.qa();for(;d;){let g=yield u._a(d);g&&a._updateProgress(g),d=yield o.qa()}let h=yield u.complete();return yield Ri(s,h.ca,void 0),yield function(_,w){let C=$(_);return C.persistence.runTransaction("Save bundle","readwrite",A=>C.$r.saveBundleMetadata(A,w))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.ua)}catch(c){return Qn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var $d=class{constructor(){this.synchronizeTabs=!1}initialize(e){return m(this,null,function*(){this.serializer=Yd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return lL(this.persistence,new fm,e.initialUser,this.serializer)}createPersistence(e){return new dm(hm.Hr,this.serializer)}createSharedClientState(e){return new _m}terminate(){return m(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Sm=class n extends $d{constructor(e,t,r){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return m(this,null,function*(){yield Tr(n.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield nD(this.Qa.syncEngine),yield Bc(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return lL(this.persistence,new fm,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new Nb(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new KT(t,this.persistence);return new WT(e.asyncQueue,r)}createPersistence(e){let t=zC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Kn.withCacheSize(this.cacheSizeBytes):Kn.DEFAULT;return new qb(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,_L(),Ug(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new _m}},pC=class n extends Sm{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return m(this,null,function*(){yield Tr(n.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof Td&&(this.sharedClientState.syncEngine={Zs:M8.bind(null,t),Xs:L8.bind(null,t),eo:F8.bind(null,t),Bi:O8.bind(null,t),Ys:P8.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>m(this,null,function*(){yield k8(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=_L();if(!Td.D(t))throw new M(P.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=zC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Td(t,e.asyncQueue,r,e.clientId,e.initialUser)}},Hd=class{initialize(e,t){return m(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>QO(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=R8.bind(null,this.syncEngine),yield rC(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new oC}()}createDatastore(e){let t=Yd(e.databaseInfo.databaseId),r=function(s){return new Jb(s)}(e.databaseInfo);return function(s,o,a,c){return new eC(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new nC(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>QO(this.syncEngine,t,0),function(){return ym.D()?new ym:new Qb}())}createSyncEngine(e,t){return function(i,s,o,a,c,u,d){let h=new hC(i,s,o,a,c,u);return d&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return m(this,null,function*(){var e;yield function(r){return m(this,null,function*(){let i=$(r);k("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Uc(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function JO(n,e=10240){let t=0;return{read(){return m(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return m(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var kc=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):dt("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var gC=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new Et,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return m(this,null,function*(){return this.metadata.promise})}qa(){return m(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return m(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),r=Number(t);isNaN(r)&&this.ja(`length string (${t}) is not valid number`);let i=yield this.Ha(r);return new cC(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return m(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return m(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return m(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var mC=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return m(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new M(P.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return m(this,null,function*(){let o=$(i),a={documents:s.map(h=>Od(o.serializer,h))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,be.emptyPath(),a,s.length),u=new Map;c.forEach(h=>{let g=H5(o.serializer,h);u.set(g.key.toString(),g)});let d=[];return s.forEach(h=>{let g=u.get(h.toString());Y(!!g),d.push(g)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Is(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return m(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=j.fromPath(r);this.mutations.push(new Nd(i,this.precondition(i)))}),yield function(r,i){return m(this,null,function*(){let s=$(r),o={writes:i.map(a=>Ld(s.serializer,a))};yield s.Co("Commit",s.serializer.databaseId,be.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw G();t=X.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new M(P.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(X.min())?at.exists(!1):at.updateTime(t):at.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(X.min()))throw new M(P.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return at.updateTime(t)}return at.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var _C=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Yo=new Bd(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>m(this,null,function*(){let e=new mC(this.datastore),t=this.tu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let t=this.updateFunction(e);return!Gd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!$1(t)}return!1}};var yC=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=It.UNAUTHENTICATED,this.clientId=$g.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>m(this,null,function*(){k("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(k("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Et;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>m(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=$c(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Bg(n,e){return m(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>m(this,null,function*(){r.isEqual(i)||(yield dL(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function vC(n,e){return m(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield rD(n);k("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>WO(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>WO(e.remoteStore,i)),n._onlineComponents=e})}function AL(n){return n.name==="FirebaseError"?n.code===P.FAILED_PRECONDITION||n.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function rD(n){return m(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Bg(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!AL(t))throw t;Qn("Error using user provided cache. Falling back to memory cache: "+t),yield Bg(n,new $d)}}else k("FirestoreClient","Using default OfflineComponentProvider"),yield Bg(n,new $d);return n._offlineComponents})}function Bm(n){return m(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),yield vC(n,n._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),yield vC(n,new Hd))),n._onlineComponents})}function RL(n){return rD(n).then(e=>e.persistence)}function iD(n){return rD(n).then(e=>e.localStore)}function NL(n){return Bm(n).then(e=>e.remoteStore)}function sD(n){return Bm(n).then(e=>e.syncEngine)}function U8(n){return Bm(n).then(e=>e.datastore)}function Oc(n){return m(this,null,function*(){let e=yield Bm(n),t=e.eventManager;return t.onListen=v8.bind(null,e.syncEngine),t.onUnlisten=I8.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=w8.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=E8.bind(null,e.syncEngine),t})}function B8(n){return n.asyncQueue.enqueue(()=>m(this,null,function*(){let e=yield RL(n),t=yield NL(n);return e.setNetworkEnabled(!0),function(i){let s=$(i);return s.M_.delete(0),Jd(s)}(t)}))}function j8(n){return n.asyncQueue.enqueue(()=>m(this,null,function*(){let e=yield RL(n),t=yield NL(n);return e.setNetworkEnabled(!1),function(i){return m(this,null,function*(){let s=$(i);s.M_.add(0),yield Uc(s),s.N_.set("Offline")})}(t)}))}function $8(n,e){let t=new Et;return n.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return function(i,s,o){return m(this,null,function*(){try{let a=yield function(u,d){let h=$(u);return h.persistence.runTransaction("read document","readonly",g=>h.localDocuments.getDocument(g,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new M(P.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=$c(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield iD(n),e,t)})),t.promise}function xL(n,e,t={}){let r=new Et;return n.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return function(s,o,a,c,u){let d=new kc({next:g=>{o.enqueueAndForget(()=>YC(s,h));let _=g.docs.has(a);!_&&g.fromCache?u.reject(new M(P.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&g.fromCache&&c&&c.source==="server"?u.reject(new M(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),h=new jd(Vc(a.path),d,{includeMetadataChanges:!0,ra:!0});return QC(s,h)}(yield Oc(n),n.asyncQueue,e,t,r)})),r.promise}function H8(n,e){let t=new Et;return n.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return function(i,s,o){return m(this,null,function*(){try{let a=yield pm(i,s,!0),c=new Dm(s,a.hs),u=c.da(a.documents),d=c.applyChanges(u,!1);o.resolve(d.snapshot)}catch(a){let c=$c(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield iD(n),e,t)})),t.promise}function PL(n,e,t={}){let r=new Et;return n.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return function(s,o,a,c,u){let d=new kc({next:g=>{o.enqueueAndForget(()=>YC(s,h)),g.fromCache&&c.source==="server"?u.reject(new M(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),h=new jd(a,d,{includeMetadataChanges:!0,ra:!0});return QC(s,h)}(yield Oc(n),n.asyncQueue,e,t,r)})),r.promise}function q8(n,e){let t=new kc(e);return n.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return function(i,s){$(i).z_.add(s),s.next()}(yield Oc(n),t)})),()=>{t.$a(),n.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return function(i,s){$(i).z_.delete(s)}(yield Oc(n),t)}))}}function z8(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?q1().encode(o):o,function(d,h){return new gC(d,h)}(function(d,h){if(d instanceof Uint8Array)return JO(d,h);if(d instanceof ArrayBuffer)return JO(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,Yd(e));n.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){V8(yield sD(n),i,r)}))}function G8(n,e){return n.asyncQueue.enqueue(()=>m(this,null,function*(){return function(r,i){let s=$(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield iD(n),e)}))}function ML(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var XO=new Map;function oD(n,e,t){if(!t)throw new M(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function aD(n,e,t,r){if(e===!0&&r===!0)throw new M(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function ZO(n){if(!j.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function e1(n){if(j.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function jm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":G()}function Ce(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new M(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=jm(n);throw new M(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function kL(n,e){if(e<=0)throw new M(P.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Am=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}aD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ML((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Fo=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Am({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new M(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Am(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new FT;switch(r.type){case"firstParty":return new jT(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=XO.get(t);r&&(k("ComponentProvider","Removing Datastore"),XO.delete(t),r.terminate())}(this),Promise.resolve()}};function OL(n,e,t,r={}){var i;let s=(n=Ce(n,Fo))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Qn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=It.MOCK_USER;else{a=za(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new M(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new It(u)}n._authCredentials=new VT(new jg(a,c))}}var Bt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},He=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Wr=class n extends Bt{constructor(e,t,r){super(e,t,Vc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new He(this.firestore,null,new j(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function cD(n,e,...t){if(n=B(n),oD("collection","path",e),n instanceof Fo){let r=be.fromString(e,...t);return e1(r),new Wr(n,null,r)}{if(!(n instanceof He||n instanceof Wr))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(be.fromString(e,...t));return e1(r),new Wr(n.firestore,null,r)}}function LL(n,e){if(n=Ce(n,Fo),oD("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new M(P.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Bt(n,null,function(r){return new mr(be.emptyPath(),r)}(e))}function Xd(n,e,...t){if(n=B(n),arguments.length===1&&(e=$g.newId()),oD("doc","path",e),n instanceof Fo){let r=be.fromString(e,...t);return ZO(r),new He(n,null,new j(r))}{if(!(n instanceof He||n instanceof Wr))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(be.fromString(e,...t));return ZO(r),new He(n.firestore,n instanceof Wr?n.converter:null,new j(r))}}function uD(n,e){return n=B(n),e=B(e),(n instanceof He||n instanceof Wr)&&(e instanceof He||e instanceof Wr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function lD(n,e){return n=B(n),e=B(e),n instanceof Bt&&e instanceof Bt&&n.firestore===e.firestore&&Kd(n._query,e._query)&&n.converter===e.converter}var wC=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Bd(this,"async_queue_retry"),this.hu=()=>{let t=Ug();t&&k("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=Ug();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=Ug();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new Et;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return m(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!bs(e))throw e;k("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw dt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=iC.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&G()}verifyOperationInProgress(){}du(){return m(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function IC(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var EC=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Et,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var FL=-1,Ke=class extends Fo{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new wC}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||VL(this),this._firestoreClient.terminate()}};function St(n){return n._firestoreClient||VL(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function VL(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,u,d){return new QT(a,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,ML(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new yC(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function UL(n,e){KL(n=Ce(n,Ke));let t=St(n);if(t._uninitializedComponentsProvider)throw new M(P.FAILED_PRECONDITION,"SDK cache is already specified.");Qn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new Hd;return jL(t,i,new Sm(i,r.cacheSizeBytes,e?.forceOwnership))}function BL(n){KL(n=Ce(n,Ke));let e=St(n);if(e._uninitializedComponentsProvider)throw new M(P.FAILED_PRECONDITION,"SDK cache is already specified.");Qn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new Hd;return jL(e,r,new pC(r,t.cacheSizeBytes))}function jL(n,e,t){let r=new Et;return n.asyncQueue.enqueue(()=>m(this,null,function*(){try{yield Bg(n,t),yield vC(n,e),r.resolve()}catch(i){let s=i;if(!AL(s))throw s;Qn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function $L(n){if(n._initialized&&!n._terminated)throw new M(P.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Et;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>m(this,null,function*(){try{yield function(r){return m(this,null,function*(){if(!ps.D())return Promise.resolve();let i=r+"main";yield ps.delete(i)})}(zC(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function HL(n){return function(t){let r=new Et;return t.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return S8(yield sD(t),r)})),r.promise}(St(n=Ce(n,Ke)))}function qL(n){return B8(St(n=Ce(n,Ke)))}function zL(n){return j8(St(n=Ce(n,Ke)))}function GL(n,e){let t=St(n=Ce(n,Ke)),r=new EC;return z8(t,n._databaseId,e,r),r}function WL(n,e){return G8(St(n=Ce(n,Ke)),e).then(t=>t?new Bt(n,null,t.query):null)}function KL(n){if(n._initialized||n._terminated)throw new M(P.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Jr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Mt.fromBase64String(e))}catch(t){throw new M(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var yr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ht(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Si=class{constructor(e){this._methodName=e}};var Vo=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ue(this._lat,e._lat)||ue(this._long,e._long)}};var W8=/^__.*__$/,TC=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new _r(e,this.data,this.fieldMask,t,this.fieldTransforms):new ws(e,this.data,t,this.fieldTransforms)}},Rm=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new _r(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function QL(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw G()}}var Nm=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return xm(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(QL(this.fu)&&W8.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},bC=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Yd(e)}Fu(e,t,r,i=!1){return new Nm({fu:e,methodName:t,vu:r,path:ht.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function $o(n){let e=n._freezeSettings(),t=Yd(n._databaseId);return new bC(n._databaseId,!!e.ignoreUndefinedProperties,t)}function $m(n,e,t,r,i,s={}){let o=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);fD("Data must be an object, but it was:",o,r);let a=XL(r,o),c,u;if(s.merge)c=new Mn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let g=RC(e,h,t);if(!o.contains(g))throw new M(P.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);eF(d,g)||d.push(g)}c=new Mn(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new TC(new Xt(a),c,u)}var qd=class n extends Si{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function YL(n,e,t){return new Nm({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var CC=class n extends Si{_toFieldTransform(e){return new ko(e.path,new ys)}isEqual(e){return e instanceof n}},DC=class n extends Si{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=YL(this,e,!0),r=this.Mu.map(s=>Ho(s,t)),i=new Ci(r);return new ko(e.path,i)}isEqual(e){return e instanceof n&&Ji(this.Mu,e.Mu)}},SC=class n extends Si{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=YL(this,e,!0),r=this.Mu.map(s=>Ho(s,t)),i=new Di(r);return new ko(e.path,i)}isEqual(e){return e instanceof n&&Ji(this.Mu,e.Mu)}},AC=class n extends Si{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new vs(e.serializer,O1(e.serializer,this.xu));return new ko(e.path,t)}isEqual(e){return e instanceof n&&this.xu===e.xu}};function dD(n,e,t,r){let i=n.Fu(1,e,t);fD("Data must be an object, but it was:",i,r);let s=[],o=Xt.empty();jo(r,(c,u)=>{let d=pD(e,c,t);u=B(u);let h=i.Su(d);if(u instanceof qd)s.push(d);else{let g=Ho(u,h);g!=null&&(s.push(d),o.set(d,g))}});let a=new Mn(s);return new Rm(o,a,i.fieldTransforms)}function hD(n,e,t,r,i,s){let o=n.Fu(1,e,t),a=[RC(e,r,t)],c=[i];if(s.length%2!=0)throw new M(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(RC(e,s[g])),c.push(s[g+1]);let u=[],d=Xt.empty();for(let g=a.length-1;g>=0;--g)if(!eF(u,a[g])){let _=a[g],w=c[g];w=B(w);let C=o.Su(_);if(w instanceof qd)u.push(_);else{let A=Ho(w,C);A!=null&&(u.push(_),d.set(_,A))}}let h=new Mn(u);return new Rm(d,h,o.fieldTransforms)}function JL(n,e,t,r=!1){return Ho(t,n.Fu(r?4:3,e))}function Ho(n,e){if(ZL(n=B(n)))return fD("Unsupported field value:",e,n),XL(n,e);if(n instanceof Si)return function(r,i){if(!QL(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Ho(a,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=B(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return O1(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Xe.fromDate(r);return{timestampValue:Dc(i.serializer,s)}}if(r instanceof Xe){let s=new Xe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Dc(i.serializer,s)}}if(r instanceof Vo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jr)return{bytesValue:z1(i.serializer,r._byteString)};if(r instanceof He){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:$C(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${jm(r)}`)}(n,e)}function XL(n,e){let t={};return _1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jo(n,(r,i)=>{let s=Ho(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function ZL(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Xe||n instanceof Vo||n instanceof Jr||n instanceof He||n instanceof Si)}function fD(n,e,t){if(!ZL(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=jm(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function RC(n,e,t){if((e=B(e))instanceof yr)return e._internalPath;if(typeof e=="string")return pD(n,e);throw xm("Field path arguments must be of type string or ",n,!1,void 0,t)}var K8=new RegExp("[~\\*/\\[\\]]");function pD(n,e,t){if(e.search(K8)>=0)throw xm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new yr(...e.split("."))._internalPath}catch{throw xm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function xm(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new M(P.INVALID_ARGUMENT,a+n+c)}function eF(n,e){return n.some(t=>t.isEqual(e))}var Uo=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new He(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new NC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Hm("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},NC=class extends Uo{data(){return super.data()}};function Hm(n,e){return typeof e=="string"?pD(n,e):e instanceof yr?e._internalPath:e._delegate._internalPath}function tF(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new M(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var zd=class{},Bo=class extends zd{};function Ni(n,e,...t){let r=[];e instanceof zd&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof xC).length,a=s.filter(c=>c instanceof Pm).length;if(o>1||o>0&&a>0)throw new M(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Pm=class n extends Bo{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return dF(e._query,t),new Bt(e.firestore,e.converter,cb(e._query,t))}_parse(e){let t=$o(e.firestore);return function(s,o,a,c,u,d,h){let g;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new M(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){n1(h,d);let _=[];for(let w of h)_.push(t1(c,s,w));g={arrayValue:{values:_}}}else g=t1(c,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||n1(h,d),g=JL(a,o,h,d==="in"||d==="not-in");return ye.create(u,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function nF(n,e,t){let r=e,i=Hm("where",n);return Pm._create(i,r,t)}var xC=class n extends zd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ke.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)dF(o,c),o=cb(o,c)}(e._query,t),new Bt(e.firestore,e.converter,cb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var PC=class n extends Bo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new M(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Po(s,o)}(e._query,this._field,this._direction);return new Bt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new mr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function rF(n,e="asc"){let t=e,r=Hm("orderBy",n);return PC._create(r,t)}var Mm=class n extends Bo{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Bt(e.firestore,e.converter,Xg(e._query,this._limit,this._limitType))}};function iF(n){return kL("limit",n),Mm._create("limit",n,"F")}function sF(n){return kL("limitToLast",n),Mm._create("limitToLast",n,"L")}var km=class n extends Bo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=lF(e,this.type,this._docOrFields,this._inclusive);return new Bt(e.firestore,e.converter,function(i,s){return new mr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function oF(...n){return km._create("startAt",n,!0)}function aF(...n){return km._create("startAfter",n,!1)}var Om=class n extends Bo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=lF(e,this.type,this._docOrFields,this._inclusive);return new Bt(e.firestore,e.converter,function(i,s){return new mr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function cF(...n){return Om._create("endBefore",n,!1)}function uF(...n){return Om._create("endAt",n,!0)}function lF(n,e,t,r){if(t[0]=B(t[0]),t[0]instanceof Uo)return function(s,o,a,c,u){if(!c)throw new M(P.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of yc(s))if(h.field.isKeyField())d.push(xo(o,c.key));else{let g=c.data.field(h.field);if(Fm(g))throw new M(P.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let _=h.field.canonicalString();throw new M(P.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(g)}return new Qr(d,u)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=$o(n.firestore);return function(o,a,c,u,d,h){let g=o.explicitOrderBy;if(d.length>g.length)throw new M(P.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let _=[];for(let w=0;w<d.length;w++){let C=d[w];if(g[w].field.isKeyField()){if(typeof C!="string")throw new M(P.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof C}`);if(!BC(o)&&C.indexOf("/")!==-1)throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${C}' contains a slash.`);let A=o.path.child(be.fromString(C));if(!j.isDocumentKey(A))throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);let O=new j(A);_.push(xo(a,O))}else{let A=JL(c,u,C);_.push(A)}}return new Qr(_,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function t1(n,e,t){if(typeof(t=B(t))=="string"){if(t==="")throw new M(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!BC(e)&&t.indexOf("/")!==-1)throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(be.fromString(t));if(!j.isDocumentKey(r))throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xo(n,new j(r))}if(t instanceof He)return xo(n,t._key);throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jm(t)}.`)}function n1(n,e){if(!Array.isArray(n)||n.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function dF(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Lc=class{convertValue(e,t="none"){switch(No(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ot(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw G()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return jo(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Vo(ot(e.latitude),ot(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=VC(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Sd(e));default:return null}}convertTimestamp(e){let t=bi(e);return new Xe(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=be.fromString(e);Y(nL(r));let i=new ms(r.get(1),r.get(3)),s=new j(r.popFirst(5));return i.isEqual(t)||dt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function qm(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var MC=class extends Lc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new He(this.firestore,null,t)}};var Ti=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Jn=class extends Uo{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new hs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Hm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},hs=class extends Jn{data(e={}){return super.data(e)}},vr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ti(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new hs(this._firestore,this._userDataWriter,r.key,r,new Ti(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new hs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ti(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new hs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ti(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:Q8(a.type),doc:c,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Q8(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return G()}}function gD(n,e){return n instanceof Jn&&e instanceof Jn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof vr&&e instanceof vr&&n._firestore===e._firestore&&lD(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function hF(n){n=Ce(n,He);let e=Ce(n.firestore,Ke);return xL(St(e),n._key).then(t=>vD(e,n,t))}var Ai=class extends Lc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new He(this.firestore,null,t)}};function fF(n){n=Ce(n,He);let e=Ce(n.firestore,Ke),t=St(e),r=new Ai(e);return $8(t,n._key).then(i=>new Jn(e,r,n._key,i,new Ti(i!==null&&i.hasLocalMutations,!0),n.converter))}function pF(n){n=Ce(n,He);let e=Ce(n.firestore,Ke);return xL(St(e),n._key,{source:"server"}).then(t=>vD(e,n,t))}function gF(n){n=Ce(n,Bt);let e=Ce(n.firestore,Ke),t=St(e),r=new Ai(e);return tF(n._query),PL(t,n._query).then(i=>new vr(e,r,n,i))}function mF(n){n=Ce(n,Bt);let e=Ce(n.firestore,Ke),t=St(e),r=new Ai(e);return H8(t,n._query).then(i=>new vr(e,r,n,i))}function _F(n){n=Ce(n,Bt);let e=Ce(n.firestore,Ke),t=St(e),r=new Ai(e);return PL(t,n._query,{source:"server"}).then(i=>new vr(e,r,n,i))}function mD(n,e,t){n=Ce(n,He);let r=Ce(n.firestore,Ke),i=qm(n.converter,e,t);return Hc(r,[$m($o(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,at.none())])}function _D(n,e,t,...r){n=Ce(n,He);let i=Ce(n.firestore,Ke),s=$o(i),o;return o=typeof(e=B(e))=="string"||e instanceof yr?hD(s,"updateDoc",n._key,e,t,r):dD(s,"updateDoc",n._key,e),Hc(i,[o.toMutation(n._key,at.exists(!0))])}function yF(n){return Hc(Ce(n.firestore,Ke),[new Is(n._key,at.none())])}function vF(n,e){let t=Ce(n.firestore,Ke),r=Xd(n),i=qm(n.converter,e);return Hc(t,[$m($o(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,at.exists(!1))]).then(()=>r)}function yD(n,...e){var t,r,i;n=B(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||IC(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(IC(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,u,d;if(n instanceof He)u=Ce(n.firestore,Ke),d=Vc(n._key.path),c={next:h=>{e[o]&&e[o](vD(u,n,h))},error:e[o+1],complete:e[o+2]};else{let h=Ce(n,Bt);u=Ce(h.firestore,Ke),d=h._query;let g=new Ai(u);c={next:_=>{e[o]&&e[o](new vr(u,g,h,_))},error:e[o+1],complete:e[o+2]},tF(n._query)}return function(g,_,w,C){let A=new kc(C),O=new jd(_,A,w);return g.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return QC(yield Oc(g),O)})),()=>{A.$a(),g.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return YC(yield Oc(g),O)}))}}(St(u),d,a,c)}function wF(n,e){return q8(St(n=Ce(n,Ke)),IC(e)?e:{next:e})}function Hc(n,e){return function(r,i){let s=new Et;return r.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){return T8(yield sD(r),i,s)})),s.promise}(St(n),e)}function vD(n,e,t){let r=t.docs.get(e._key),i=new Ai(n);return new Jn(n,i,e._key,r,new Ti(t.hasPendingWrites,t.fromCache),e.converter)}var Y8={maxAttempts:5};var Lm=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=$o(e)}set(e,t,r){this._verifyNotCommitted();let i=ls(e,this._firestore),s=qm(i.converter,t,r),o=$m(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,at.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=ls(e,this._firestore),o;return o=typeof(t=B(t))=="string"||t instanceof yr?hD(this._dataReader,"WriteBatch.update",s._key,t,r,i):dD(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,at.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=ls(e,this._firestore);return this._mutations=this._mutations.concat(new Is(t._key,at.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new M(P.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ls(n,e){if((n=B(n)).firestore!==e)throw new M(P.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var kC=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=$o(t)}get(t){let r=ls(t,this._firestore),i=new MC(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return G();let o=s[0];if(o.isFoundDocument())return new Uo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Uo(this._firestore,i,r._key,null,r.converter);throw G()})}set(t,r,i){let s=ls(t,this._firestore),o=qm(s.converter,r,i),a=$m(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=ls(t,this._firestore),a;return a=typeof(r=B(r))=="string"||r instanceof yr?hD(this._dataReader,"Transaction.update",o._key,r,i,s):dD(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=ls(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=ls(e,this._firestore),r=new Ai(this._firestore);return super.get(e).then(i=>new Jn(this._firestore,r,t._key,i._document,new Ti(!1,!1),t.converter))}};function IF(n,e,t){n=Ce(n,Ke);let r=Object.assign(Object.assign({},Y8),t);return function(s){if(s.maxAttempts<1)throw new M(P.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new Et;return s.asyncQueue.enqueueAndForget(()=>m(this,null,function*(){let u=yield U8(s);new _C(s.asyncQueue,u,a,o,c).Xa()})),c.promise}(St(n),i=>e(new kC(n,i)),r)}function EF(){return new qd("deleteField")}function TF(){return new CC("serverTimestamp")}function bF(...n){return new DC("arrayUnion",n)}function CF(...n){return new SC("arrayRemove",n)}function DF(n){return new AC("increment",n)}(function(e,t=!0){(function(i){Fc=i})(un),cn(new Le("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ke(new UT(r.getProvider("auth-internal")),new HT(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new M(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ms(u.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),lt(rO,"4.6.3",e),lt(rO,"4.6.3","esm2017")})();var J8="@firebase/firestore-compat",X8="0.3.32";function CD(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new M("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function SF(){if(typeof Uint8Array>"u")throw new M("unimplemented","Uint8Arrays are not available in this environment.")}function AF(){if(!y1())throw new M("unimplemented","Blobs are unavailable in Firestore in this environment.")}var zm=class n{constructor(e){this._delegate=e}static fromBase64String(e){return AF(),new n(Jr.fromBase64String(e))}static fromUint8Array(e){return SF(),new n(Jr.fromUint8Array(e))}toBase64(){return AF(),this._delegate.toBase64()}toUint8Array(){return SF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function wD(n){return Z8(n,["next","error","complete"])}function Z8(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var ID=class{enableIndexedDbPersistence(e,t){return UL(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return BL(e._delegate)}clearIndexedDbPersistence(e){return $L(e._delegate)}},Gm=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ms||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Qn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){OL(this._delegate,e,t,r)}enableNetwork(){return qL(this._delegate)}disableNetwork(){return zL(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,aD("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return HL(this._delegate)}onSnapshotsInSync(e){return wF(this._delegate,e)}get app(){if(!this._appCompat)throw new M("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Gc(this,cD(this._delegate,e))}catch(t){throw hn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Xr(this,Xd(this._delegate,e))}catch(t){throw hn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Wo(this,LL(this._delegate,e))}catch(t){throw hn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return IF(this._delegate,t=>e(new Wm(this,t)))}batch(){return St(this._delegate),new Km(new Lm(this._delegate,e=>Hc(this._delegate,e)))}loadBundle(e){return GL(this._delegate,e)}namedQuery(e){return WL(this._delegate,e).then(t=>t?new Wo(this,t):null)}},qc=class extends Lc{constructor(e){super(),this.firestore=e}convertBytes(e){return new zm(new Jr(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Xr.forKey(t,this.firestore,null)}};function eK(n){i1(n)}var Wm=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new qc(e)}get(e){let t=qo(e);return this._delegate.get(t).then(r=>new zo(this._firestore,new Jn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=qo(e);return r?(CD("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=qo(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=qo(e);return this._delegate.delete(t),this}},Km=class{constructor(e){this._delegate=e}set(e,t,r){let i=qo(e);return r?(CD("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=qo(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=qo(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},zc=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new hs(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Go(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new qc(e),t),i.set(t,s)),s}};zc.INSTANCES=new WeakMap;var Xr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new qc(e)}static forPath(e,t,r){if(e.length%2!==0)throw new M("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new He(t._delegate,r,new j(e)))}static forKey(e,t,r){return new n(t,new He(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Gc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Gc(this.firestore,cD(this._delegate,e))}catch(t){throw hn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=B(e),e instanceof He?uD(this._delegate,e):!1}set(e,t){t=CD("DocumentReference.set",t);try{return t?mD(this._delegate,e,t):mD(this._delegate,e)}catch(r){throw hn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?_D(this._delegate,e):_D(this._delegate,e,t,...r)}catch(i){throw hn(i,"updateDoc()","DocumentReference.update()")}}delete(){return yF(this._delegate)}onSnapshot(...e){let t=RF(e),r=NF(e,i=>new zo(this.firestore,new Jn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return yD(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=fF(this._delegate):e?.source==="server"?t=pF(this._delegate):t=hF(this._delegate),t.then(r=>new zo(this.firestore,new Jn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(zc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function hn(n,e,t){return n.message=n.message.replace(e,t),n}function RF(n){for(let e of n)if(typeof e=="object"&&!wD(e))return e;return{}}function NF(n,e){var t,r;let i;return wD(n[0])?i=n[0]:wD(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var zo=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Xr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return gD(this._delegate,e._delegate)}},Go=class extends zo{data(e){let t=this._delegate.data(e);return this._delegate._converter||s1(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Wo=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new qc(e)}where(e,t,r){try{return new n(this.firestore,Ni(this._delegate,nF(e,t,r)))}catch(i){throw hn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Ni(this._delegate,rF(e,t)))}catch(r){throw hn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Ni(this._delegate,iF(e)))}catch(t){throw hn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Ni(this._delegate,sF(e)))}catch(t){throw hn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Ni(this._delegate,oF(...e)))}catch(t){throw hn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Ni(this._delegate,aF(...e)))}catch(t){throw hn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Ni(this._delegate,cF(...e)))}catch(t){throw hn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Ni(this._delegate,uF(...e)))}catch(t){throw hn(t,"endAt()","Query.endAt()")}}isEqual(e){return lD(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=mF(this._delegate):e?.source==="server"?t=_F(this._delegate):t=gF(this._delegate),t.then(r=>new Zd(this.firestore,new vr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=RF(e),r=NF(e,i=>new Zd(this.firestore,new vr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return yD(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(zc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},ED=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Go(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Zd=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Wo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Go(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new ED(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Go(this._firestore,r))})}isEqual(e){return gD(this._delegate,e._delegate)}},Gc=class n extends Wo{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Xr(this.firestore,e):null}doc(e){try{return e===void 0?new Xr(this.firestore,Xd(this._delegate)):new Xr(this.firestore,Xd(this._delegate,e))}catch(t){throw hn(t,"doc()","CollectionReference.doc()")}}add(e){return vF(this._delegate,e).then(t=>new Xr(this.firestore,t))}isEqual(e){return uD(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(zc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function qo(n){return Ce(n,He)}var TD=class n{constructor(...e){this._delegate=new yr(...e)}static documentId(){return new n(ht.keyField().canonicalString())}isEqual(e){return e=B(e),e instanceof yr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var bD=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=TF();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=EF();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=bF(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=CF(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=DF(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var tK={Firestore:Gm,GeoPoint:Vo,Timestamp:Xe,Blob:zm,Transaction:Wm,WriteBatch:Km,DocumentReference:Xr,DocumentSnapshot:zo,Query:Wo,QueryDocumentSnapshot:Go,QuerySnapshot:Zd,CollectionReference:Gc,FieldPath:TD,FieldValue:bD,setLogLevel:eK,CACHE_SIZE_UNLIMITED:FL};function nK(n,e){n.INTERNAL.registerComponent(new Le("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},tK)))}function rK(n){nK(n,(e,t)=>new Gm(e,t,new ID)),n.registerVersion(J8,X8)}rK(Ne);var UF="firebasestorage.googleapis.com",BF="storageBucket",iK=2*60*1e3,sK=10*60*1e3,oK=1e3;var Ze=class n extends rt{constructor(e,t,r=0){super(DD(e),`Firebase Storage: ${t} (${DD(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return DD(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Qe=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Qe||{});function DD(n){return"storage/"+n}function kD(){let n="An unknown error occurred, please check the error payload for server response.";return new Ze(Qe.UNKNOWN,n)}function aK(n){return new Ze(Qe.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function cK(n){return new Ze(Qe.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function uK(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ze(Qe.UNAUTHENTICATED,n)}function lK(){return new Ze(Qe.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function dK(n){return new Ze(Qe.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function jF(){return new Ze(Qe.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function $F(){return new Ze(Qe.CANCELED,"User canceled the upload/download.")}function hK(n){return new Ze(Qe.INVALID_URL,"Invalid URL '"+n+"'.")}function fK(n){return new Ze(Qe.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function pK(){return new Ze(Qe.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+BF+"' property when initializing the app?")}function HF(){return new Ze(Qe.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function gK(){return new Ze(Qe.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function mK(){return new Ze(Qe.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function _K(n){return new Ze(Qe.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ko(n){return new Ze(Qe.INVALID_ARGUMENT,n)}function qF(){return new Ze(Qe.APP_DELETED,"The Firebase app was deleted.")}function OD(n){return new Ze(Qe.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function th(n,e){return new Ze(Qe.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function eh(n){throw new Ze(Qe.INTERNAL_ERROR,"Internal error: "+n)}var fn=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw fK(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(z){z.path.charAt(z.path.length-1)==="/"&&(z.path_=z.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function u(z){z.path_=decodeURIComponent(z.path)}let d="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",_=new RegExp(`^https?://${h}/${d}/b/${i}/o${g}`,"i"),w={bucket:1,path:3},C=t===UF?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",O=new RegExp(`^https?://${C}/${i}/${A}`,"i"),F=[{regex:a,indices:c,postModify:s},{regex:_,indices:w,postModify:u},{regex:O,indices:{bucket:1,path:2},postModify:u}];for(let z=0;z<F.length;z++){let ie=F[z],W=ie.regex.exec(e);if(W){let T=W[ie.indices.bucket],v=W[ie.indices.path];v||(v=""),r=new n(T,v),ie.postModify(r);break}}if(r==null)throw hK(e);return r}},AD=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function yK(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let u=!1;function d(...A){u||(u=!0,e.apply(null,A))}function h(A){i=setTimeout(()=>{i=null,n(_,c())},A)}function g(){s&&clearTimeout(s)}function _(A,...O){if(u){g();return}if(A){g(),d.call(null,A,...O);return}if(c()||o){g(),d.call(null,A,...O);return}r<64&&(r*=2);let F;a===1?(a=2,F=0):F=(r+Math.random())*1e3,h(F)}let w=!1;function C(A){w||(w=!0,g(),!u&&(i!==null?(A||(a=2),clearTimeout(i),h(0)):A||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,C(!0)},t),C}function vK(n){n(!1)}function wK(n){return n!==void 0}function IK(n){return typeof n=="function"}function EK(n){return typeof n=="object"&&!Array.isArray(n)}function Jm(n){return typeof n=="string"||n instanceof String}function xF(n){return LD()&&n instanceof Blob}function LD(){return typeof Blob<"u"}function RD(n,e,t,r){if(r<e)throw Ko(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Ko(`Invalid value for '${n}'. Expected ${t} or less.`)}function Ds(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function zF(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Qc=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Qc||{});function GF(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var ND=class{constructor(e,t,r,i,s,o,a,c,u,d,h,g=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,w)=>{this.resolve_=_,this.reject_=w,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Kc(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Qc.NO_ERROR,c=s.getStatus();if(!a||GF(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===Qc.ABORT;r(!1,new Kc(!1,null,d));return}let u=this.successCodes_.indexOf(c)!==-1;r(!0,new Kc(u,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());wK(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=kD();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?qF():$F();o(c)}else{let c=jF();o(c)}};this.canceled_?t(!1,new Kc(!1,null,!0)):this.backoffId_=yK(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&vK(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Kc=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function TK(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function bK(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function CK(n,e){e&&(n["X-Firebase-GMPID"]=e)}function DK(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function SK(n,e,t,r,i,s,o=!0){let a=zF(n.urlParams),c=n.url+a,u=Object.assign({},n.headers);return CK(u,e),TK(u,t),bK(u,s),DK(u,r),new ND(c,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function AK(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function RK(...n){let e=AK();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(LD())return new Blob(n);throw new Ze(Qe.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function NK(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function xK(n){if(typeof atob>"u")throw _K("base-64");return atob(n)}var kn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},nh=class{constructor(e,t){this.data=e,this.contentType=t||null}};function FD(n,e){switch(n){case kn.RAW:return new nh(WF(e));case kn.BASE64:case kn.BASE64URL:return new nh(KF(n,e));case kn.DATA_URL:return new nh(MK(e),kK(e))}throw kD()}function WF(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function PK(n){let e;try{e=decodeURIComponent(n)}catch{throw th(kn.DATA_URL,"Malformed data URL.")}return WF(e)}function KF(n,e){switch(n){case kn.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw th(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case kn.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw th(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=xK(e)}catch(i){throw i.message.includes("polyfill")?i:th(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var Ym=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw th(kn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=OK(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function MK(n){let e=new Ym(n);return e.base64?KF(kn.BASE64,e.rest):PK(e.rest)}function kK(n){return new Ym(n).contentType}function OK(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var Yc=class n{constructor(e,t){let r=0,i="";xF(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(xF(this.data_)){let r=this.data_,i=NK(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(LD()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(RK.apply(null,t))}else{let t=e.map(o=>Jm(o)?FD(kn.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function VD(n){let e;try{e=JSON.parse(n)}catch{return null}return EK(e)?e:null}function LK(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function FK(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function QF(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function VK(n,e){return e}var jt=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||VK}},Qm=null;function UK(n){return!Jm(n)||n.length<2?n:QF(n)}function Xm(){if(Qm)return Qm;let n=[];n.push(new jt("bucket")),n.push(new jt("generation")),n.push(new jt("metageneration")),n.push(new jt("name","fullPath",!0));function e(s,o){return UK(o)}let t=new jt("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new jt("size");return i.xform=r,n.push(i),n.push(new jt("timeCreated")),n.push(new jt("updated")),n.push(new jt("md5Hash",null,!0)),n.push(new jt("cacheControl",null,!0)),n.push(new jt("contentDisposition",null,!0)),n.push(new jt("contentEncoding",null,!0)),n.push(new jt("contentLanguage",null,!0)),n.push(new jt("contentType",null,!0)),n.push(new jt("metadata","customMetadata",!0)),Qm=n,Qm}function BK(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new fn(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function jK(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return BK(r,n),r}function YF(n,e,t){let r=VD(e);return r===null?null:jK(n,r,t)}function $K(n,e,t,r){let i=VD(e);if(i===null||!Jm(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(u=>{let d=n.bucket,h=n.fullPath,g="/b/"+o(d)+"/o/"+o(h),_=Ds(g,t,r),w=zF({alt:"media",token:u});return _+w})[0]}function UD(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var PF="prefixes",MF="items";function HK(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[PF])for(let i of t[PF]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new fn(e,s));r.prefixes.push(o)}if(t[MF])for(let i of t[MF]){let s=n._makeStorageReference(new fn(e,i.name));r.items.push(s)}return r}function qK(n,e,t){let r=VD(t);return r===null?null:HK(n,e,r)}var wr=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function ei(n){if(!n)throw kD()}function Zm(n,e){function t(r,i){let s=YF(n,i,e);return ei(s!==null),s}return t}function zK(n,e){function t(r,i){let s=qK(n,e,i);return ei(s!==null),s}return t}function GK(n,e){function t(r,i){let s=YF(n,i,e);return ei(s!==null),$K(s,i,n.host,n._protocol)}return t}function Zc(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=lK():i=uK():t.getStatus()===402?i=cK(n.bucket):t.getStatus()===403?i=dK(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function e_(n){let e=Zc(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=aK(n.path)),s.serverResponse=i.serverResponse,s}return t}function JF(n,e,t){let r=e.fullServerUrl(),i=Ds(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new wr(i,s,Zm(n,t),o);return a.errorHandler=e_(e),a}function WK(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=Ds(o,n.host,n._protocol),c="GET",u=n.maxOperationRetryTime,d=new wr(a,c,zK(n,e.bucket),u);return d.urlParams=s,d.errorHandler=Zc(e),d}function KK(n,e,t){let r=e.fullServerUrl(),i=Ds(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new wr(i,s,GK(n,t),o);return a.errorHandler=e_(e),a}function QK(n,e,t,r){let i=e.fullServerUrl(),s=Ds(i,n.host,n._protocol),o="PATCH",a=UD(t,r),c={"Content-Type":"application/json; charset=utf-8"},u=n.maxOperationRetryTime,d=new wr(s,o,Zm(n,r),u);return d.headers=c,d.body=a,d.errorHandler=e_(e),d}function YK(n,e){let t=e.fullServerUrl(),r=Ds(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,u){}let a=new wr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=e_(e),a}function JK(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function XF(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=JK(null,e)),r}function XK(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let F="";for(let z=0;z<2;z++)F=F+Math.random().toString().slice(2);return F}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let u=XF(e,r,i),d=UD(u,t),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,g=`\r
--`+c+"--",_=Yc.getBlob(h,r,g);if(_===null)throw HF();let w={name:u.fullPath},C=Ds(s,n.host,n._protocol),A="POST",O=n.maxUploadRetryTime,H=new wr(C,A,Zm(n,t),O);return H.urlParams=w,H.headers=o,H.body=_.uploadData(),H.errorHandler=Zc(e),H}var Jc=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function BD(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{ei(!1)}return ei(!!t&&(e||["active"]).indexOf(t)!==-1),t}function ZK(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=XF(e,r,i),a={name:o.fullPath},c=Ds(s,n.host,n._protocol),u="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=UD(o,t),g=n.maxUploadRetryTime;function _(C){BD(C);let A;try{A=C.getResponseHeader("X-Goog-Upload-URL")}catch{ei(!1)}return ei(Jm(A)),A}let w=new wr(c,u,_,g);return w.urlParams=a,w.headers=d,w.body=h,w.errorHandler=Zc(e),w}function eQ(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(u){let d=BD(u,["active","final"]),h=null;try{h=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{ei(!1)}h||ei(!1);let g=Number(h);return ei(!isNaN(g)),new Jc(g,r.size(),d==="final")}let o="POST",a=n.maxUploadRetryTime,c=new wr(t,o,s,a);return c.headers=i,c.errorHandler=Zc(e),c}var kF=256*1024;function tQ(n,e,t,r,i,s,o,a){let c=new Jc(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw gK();let u=c.total-c.current,d=u;i>0&&(d=Math.min(d,i));let h=c.current,g=h+d,_="";d===0?_="finalize":u===d?_="upload, finalize":_="upload";let w={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${c.current}`},C=r.slice(h,g);if(C===null)throw HF();function A(z,ie){let W=BD(z,["active","final"]),T=c.current+d,v=r.size(),I;return W==="final"?I=Zm(e,s)(z,ie):I=null,new Jc(T,v,W==="final",I)}let O="POST",H=e.maxUploadRetryTime,F=new wr(t,O,A,H);return F.headers=w,F.body=C.uploadData(),F.progressCallback=a||null,F.errorHandler=Zc(n),F}var ZF={STATE_CHANGED:"state_changed"},Zt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function SD(n){switch(n){case"running":case"pausing":case"canceling":return Zt.RUNNING;case"paused":return Zt.PAUSED;case"success":return Zt.SUCCESS;case"canceled":return Zt.CANCELED;case"error":return Zt.ERROR;default:return Zt.ERROR}}var xD=class{constructor(e,t,r){if(IK(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Wc(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var OF=null,PD=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Qc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Qc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Qc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw eh("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw eh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw eh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw eh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw eh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},MD=class extends PD{initXhr(){this.xhr_.responseType="text"}};function Zr(){return OF?OF():new MD}var rh=class{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=Xm(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Qe.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(GF(i.status,[]))if(s)i=jF();else{this.sleepTime=Math.max(this.sleepTime*2,oK),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Qe.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=ZK(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Zr,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=eQ(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Zr,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=kF*this._chunkMultiplier,t=new Jc(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=tQ(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,Zr,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){kF*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=JF(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Zr,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=XK(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Zr,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=$F(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=SD(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new xD(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(SD(this._state)){case Zt.SUCCESS:Wc(this._resolve.bind(null,this.snapshot))();break;case Zt.CANCELED:case Zt.ERROR:let t=this._reject;Wc(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(SD(this._state)){case Zt.RUNNING:case Zt.PAUSED:e.next&&Wc(e.next.bind(e,this.snapshot))();break;case Zt.SUCCESS:e.complete&&Wc(e.complete.bind(e))();break;case Zt.CANCELED:case Zt.ERROR:e.error&&Wc(e.error.bind(e,this._error))();break;default:e.error&&Wc(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var Xc=class n{constructor(e,t){this._service=e,t instanceof fn?this._location=t:this._location=fn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new fn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return QF(this._location.path)}get storage(){return this._service}get parent(){let e=LK(this._location.path);if(e===null)return null;let t=new fn(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw OD(e)}};function nQ(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new rh(n,new Yc(e),t)}function rQ(n){let e={prefixes:[],items:[]};return eV(n,e).then(()=>e)}function eV(n,e,t){return m(this,null,function*(){let i=yield tV(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield eV(n,e,i.nextPageToken))})}function tV(n,e){e!=null&&typeof e.maxResults=="number"&&RD("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=WK(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Zr)}function iQ(n){n._throwIfRoot("getMetadata");let e=JF(n.storage,n._location,Xm());return n.storage.makeRequestWithTokens(e,Zr)}function sQ(n,e){n._throwIfRoot("updateMetadata");let t=QK(n.storage,n._location,e,Xm());return n.storage.makeRequestWithTokens(t,Zr)}function oQ(n){n._throwIfRoot("getDownloadURL");let e=KK(n.storage,n._location,Xm());return n.storage.makeRequestWithTokens(e,Zr).then(t=>{if(t===null)throw mK();return t})}function aQ(n){n._throwIfRoot("deleteObject");let e=YK(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Zr)}function nV(n,e){let t=FK(n._location.path,e),r=new fn(n._location.bucket,t);return new Xc(n.storage,r)}function cQ(n){return/^[A-Za-z]+:\/\//.test(n)}function uQ(n,e){return new Xc(n,e)}function rV(n,e){if(n instanceof ih){let t=n;if(t._bucket==null)throw pK();let r=new Xc(t,t._bucket);return e!=null?rV(r,e):r}else return e!==void 0?nV(n,e):n}function lQ(n,e){if(e&&cQ(e)){if(n instanceof ih)return uQ(n,e);throw Ko("To use ref(service, url), the first argument must be a Storage instance.")}else return rV(n,e)}function LF(n,e){let t=e?.[BF];return t==null?null:fn.makeFromBucketSpec(t,n)}function dQ(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:za(i,n.app.options.projectId))}var ih=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=UF,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=iK,this._maxUploadRetryTime=sK,this._requests=new Set,i!=null?this._bucket=fn.makeFromBucketSpec(i,this._host):this._bucket=LF(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=fn.makeFromBucketSpec(this._url,e):this._bucket=LF(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){RD("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){RD("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return m(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return m(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xc(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new AD(qF());{let o=SK(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return m(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},FF="@firebase/storage",VF="0.12.5";var hQ="storage";function iV(n,e,t){return n=B(n),nQ(n,e,t)}function sV(n){return n=B(n),iQ(n)}function oV(n,e){return n=B(n),sQ(n,e)}function aV(n,e){return n=B(n),tV(n,e)}function cV(n){return n=B(n),rQ(n)}function uV(n){return n=B(n),oQ(n)}function lV(n){return n=B(n),aQ(n)}function jD(n,e){return n=B(n),lQ(n,e)}function dV(n,e){return nV(n,e)}function hV(n,e,t,r={}){dQ(n,e,t,r)}function fQ(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new ih(t,r,i,e,un)}function pQ(){cn(new Le(hQ,fQ,"PUBLIC").setMultipleInstances(!0)),lt(FF,VF,""),lt(FF,VF,"esm2017")}pQ();var eu=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var t_=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new eu(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new eu(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new eu(o,this,this._ref)):s={next:t.next?o=>t.next(new eu(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},n_=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Qo(e,this._service))}get items(){return this._delegate.items.map(e=>new Qo(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var Qo=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=dV(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new t_(iV(this._delegate,e,t),this)}putString(e,t=kn.RAW,r){this._throwIfRoot("putString");let i=FD(t,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new t_(new rh(this._delegate,new Yc(i.data,!0),s),this)}listAll(){return cV(this._delegate).then(e=>new n_(e,this.storage))}list(e){return aV(this._delegate,e||void 0).then(t=>new n_(t,this.storage))}getMetadata(){return sV(this._delegate)}updateMetadata(e){return oV(this._delegate,e)}getDownloadURL(){return uV(this._delegate)}delete(){return this._throwIfRoot("delete"),lV(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw OD(e)}};var r_=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(fV(e))throw Ko("ref() expected a child path but got a URL, use refFromURL instead.");return new Qo(jD(this._delegate,e),this)}refFromURL(e){if(!fV(e))throw Ko("refFromURL() expected a full URL but got a child path, use ref() instead.");try{fn.makeFromUrl(e,this._delegate.host)}catch{throw Ko("refFromUrl() expected a valid full URL but got an invalid one.")}return new Qo(jD(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){hV(this._delegate,e,t,r)}};function fV(n){return/^[A-Za-z]+:\/\//.test(n)}var gQ="@firebase/storage-compat",mQ="0.3.8";var _Q="storage-compat";function yQ(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new r_(t,r)}function vQ(n){let e={TaskState:Zt,TaskEvent:ZF,StringFormat:kn,Storage:r_,Reference:Qo};n.INTERNAL.registerComponent(new Le(_Q,yQ,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(gQ,mQ)}vQ(Ne);var pV="@firebase/database",gV="1.0.5";var ZS="";function e0(n){ZS=n}var QD=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),gt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Ha(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var YD=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return an(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var GV=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new QD(e)}}catch{}return new YD},Jo=GV("localStorage"),JD=GV("sessionStorage");var iu=new In("@firebase/database"),WV=function(){let n=1;return function(){return n++}}(),KV=function(n){let e=SM(n),t=new Hp;t.update(e);let r=t.digest();return qp.encodeByteArray(r)},Ah=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Ah.apply(null,r):typeof r=="object"?e+=gt(r):e+=r,e+=" "}return e},Xo=null,mV=!0,QV=function(n,e){V(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(iu.logLevel=fe.VERBOSE,Xo=iu.log.bind(iu),e&&JD.set("logging_enabled",!0)):typeof n=="function"?Xo=n:(Xo=null,JD.remove("logging_enabled"))},Ot=function(...n){if(mV===!0&&(mV=!1,Xo===null&&JD.get("logging_enabled")===!0&&QV(!0)),Xo){let e=Ah.apply(null,n);Xo(e)}},Rh=function(n){return function(...e){Ot(n,...e)}},XD=function(...n){let e="FIREBASE INTERNAL ERROR: "+Ah(...n);iu.error(e)},ri=function(...n){let e=`FIREBASE FATAL ERROR: ${Ah(...n)}`;throw iu.error(e),new Error(e)},en=function(...n){let e="FIREBASE WARNING: "+Ah(...n);iu.warn(e)},wQ=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&en("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},x_=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},IQ=function(n){if(Or()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ns="[MIN_NAME]",xi="[MAX_NAME]",ea=function(n,e){if(n===e)return 0;if(n===Ns||e===xi)return-1;if(e===Ns||n===xi)return 1;{let t=_V(n),r=_V(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},EQ=function(n,e){return n===e?0:n<e?-1:1},sh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+gt(e))},t0=function(n){if(typeof n!="object"||n===null)return gt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=gt(e[r]),t+=":",t+=t0(n[e[r]]);return t+="}",t},YV=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Lt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var JV=function(n){V(!x_(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let u=[];for(c=t;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();let d=u.join(""),h="";for(c=0;c<64;c+=8){let g=parseInt(d.substr(c,8),2).toString(16);g.length===1&&(g="0"+g),h=h+g}return h.toLowerCase()},TQ=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},bQ=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function CQ(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var DQ=new RegExp("^-?(0*)\\d{1,10}$"),SQ=-2147483648,AQ=2147483647,_V=function(n){if(DQ.test(n)){let e=Number(n);if(e>=SQ&&e<=AQ)return e}return null},fu=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw en("Exception was thrown by user callback.",t),e},Math.floor(0))}},RQ=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},uh=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var ZD=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){en(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var eS=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Ot("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',en(e)}},lh=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),s_="5",XV="v",ZV="s",eU="r",tU="f",nU=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,rU="ls",iU="p",tS="ac",sU="websocket",oU="long_polling";var o_=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Jo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Jo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function NQ(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function aU(n,e,t){V(typeof e=="string","typeof type must == string"),V(typeof t=="object","typeof params must == object");let r;if(e===sU)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===oU)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);NQ(n)&&(t.ns=n.namespace);let i=[];return Lt(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var nS=class{constructor(){this.counters_={}}incrementCounter(e,t=1){an(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return IM(this.counters_)}};var $D={},HD={};function n0(n){let e=n.toString();return $D[e]||($D[e]=new nS),$D[e]}function xQ(n,e){let t=n.toString();return HD[t]||(HD[t]=e()),HD[t]}var rS=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&fu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var yV="start",PQ="close",MQ="pLPCommand",kQ="pRTLPCB",cU="id",uU="pw",lU="ser",OQ="cb",LQ="seg",FQ="ts",VQ="d",UQ="dframe",dU=1870,hU=30,BQ=dU-hU,jQ=25e3,$Q=3e4,ph=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Rh(e),this.stats_=n0(t),this.urlFn=c=>(this.appCheckToken&&(c[tS]=this.appCheckToken),aU(t,oU,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new rS(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor($Q)),IQ(()=>{if(this.isClosed_)return;this.scriptTagHolder=new iS((...s)=>{let[o,a,c,u,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===yV)this.id=a,this.password=c;else if(o===PQ)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[yV]="t",r[lU]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[OQ]=this.scriptTagHolder.uniqueCallbackIdentifier),r[XV]=s_,this.transportSessionId&&(r[ZV]=this.transportSessionId),this.lastSessionId&&(r[rU]=this.lastSessionId),this.applicationId&&(r[iU]=this.applicationId),this.appCheckToken&&(r[tS]=this.appCheckToken),typeof location<"u"&&location.hostname&&nU.test(location.hostname)&&(r[eU]=tU);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Or()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!TQ()&&!bQ()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=gt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=TI(t),i=YV(r,BQ);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Or())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[UQ]="t",r[cU]=e,r[uU]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=gt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},iS=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Or())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=WV(),window[MQ+this.uniqueCallbackIdentifier]=e,window[kQ+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ot("frame writing exception"),a.stack&&Ot(a.stack),Ot(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ot("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[cU]=this.myID,e[uU]=this.myPW,e[lU]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+hU+r.length<=dU;){let o=this.pendingSegs.shift();r=r+"&"+LQ+i+"="+o.seg+"&"+FQ+i+"="+o.ts+"&"+VQ+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(jQ)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){Or()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Ot("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var HQ=16384,qQ=45e3,a_=null;typeof MozWebSocket<"u"?a_=MozWebSocket:typeof WebSocket<"u"&&(a_=WebSocket);var nu=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Rh(this.connId),this.stats_=n0(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[XV]=s_,!Or()&&typeof location<"u"&&location.hostname&&nU.test(location.hostname)&&(a[eU]=tU),r&&(a[ZV]=r),i&&(a[rU]=i),s&&(a[tS]=s),o&&(a[iU]=o),aU(t,sU,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Jo.set("previous_websocket_failure",!0);try{let i;if(Or()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${s_}/${ZS}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new a_(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&a_!==null&&!n.forceDisallow_}static previouslyFailed(){return Jo.isInMemoryStorage||Jo.get("previous_websocket_failure")===!0}markConnectionHealthy(){Jo.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Ha(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(V(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=gt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=YV(r,HQ);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(qQ))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),fU=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[ph,nu]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=nu&&nu.isAvailable(),i=r&&!nu.previouslyFailed();if(t.webSocketOnly&&(r||en("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[nu];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),zQ=6e4,GQ=5e3,WQ=10*1024,KQ=100*1024,qD="t",vV="d",QQ="s",wV="r",YQ="e",IV="o",EV="a",TV="n",bV="p",JQ="h",sS=class{constructor(e,t,r,i,s,o,a,c,u,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Rh("c:"+this.id+":"),this.transportManager_=new fU(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=uh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>KQ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>WQ?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(qD in e){let t=e[qD];t===EV?this.upgradeIfSecondaryHealthy_():t===wV?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===IV&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=sh("t",e),r=sh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:bV,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:EV,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:TV,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=sh("t",e),r=sh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=sh(qD,e);if(vV in e){let r=e[vV];if(t===JQ){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===TV){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===QQ?this.onConnectionShutdown_(r):t===wV?this.onReset_(r):t===YQ?XD("Server Error: "+r):t===IV?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):XD("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),s_!==r&&en("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),uh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(zQ))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):uh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(GQ))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:bV,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Jo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var c_=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var u_=class{constructor(e){this.allowedEvents_=e,this.listeners_={},V(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){V(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var l_=class n extends u_{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Vl()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return V(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var CV=32,DV=768,Re=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Ae(){return new Re("")}function pe(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function xs(n){return n.pieces_.length-n.pieceNum_}function je(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Re(n.pieces_,e)}function r0(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function XQ(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function gh(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function pU(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Re(e,0)}function Ye(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Re)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Re(t,0)}function ge(n){return n.pieceNum_>=n.pieces_.length}function pn(n,e){let t=pe(n),r=pe(e);if(t===null)return e;if(t===r)return pn(je(n),je(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function ZQ(n,e){let t=gh(n,0),r=gh(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=ea(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function i0(n,e){if(xs(n)!==xs(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Xn(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(xs(n)>xs(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var oS=class{constructor(e,t){this.errorPrefix_=t,this.parts_=gh(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Bl(this.parts_[r]);gU(this)}};function e7(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Bl(e),gU(n)}function t7(n){let e=n.parts_.pop();n.byteLength_-=Bl(e),n.parts_.length>0&&(n.byteLength_-=1)}function gU(n){if(n.byteLength_>DV)throw new Error(n.errorPrefix_+"has a key path longer than "+DV+" bytes ("+n.byteLength_+").");if(n.parts_.length>CV)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+CV+") or object contains a cycle "+Yo(n))}function Yo(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var aS=class n extends u_{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return V(e==="visible","Unknown event type: "+e),[this.visible_]}};var oh=1e3,n7=60*5*1e3,SV=30*1e3,r7=1.3,i7=3e4,s7="server_kill",AV=3,s0=(()=>{class n extends c_{constructor(t,r,i,s,o,a,c,u){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=Rh("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=oh,this.maxReconnectDelay_=n7,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!Or())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");aS.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&l_.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(gt(o)),V(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new Ct,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),V(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),V(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let u=c.d,d=c.s;n.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,u))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&an(t,"w")){let i=Yi(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();en(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||DM(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=SV)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=CM(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),V(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+gt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):XD("Unrecognized action received from server: "+gt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){V(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=oh,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=oh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>i7&&(this.reconnectDelay_=oh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*r7)}this.onConnectStatus_(!1)}establishConnection_(){return m(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},d=function(g){V(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(g)};this.realtime_={close:u,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,_]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?Ot("getToken() completed but was canceled"):(Ot("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=_&&_.token,c=new sS(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,w=>{en(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(s7)},o))}catch(g){this.log_("Failed to get token: "+g),a||(this.repoInfo_.nodeAdmin&&en(g),u())}}})}interrupt(t){Ot("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Ot("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Ga(this.interruptReasons_)&&(this.reconnectDelay_=oh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>t0(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new Re(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Ot("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=AV&&(this.reconnectDelay_=SV,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Ot("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=AV&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";Or()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+ZS.replace(/\./g,"-")]=1,Vl()?t["framework.cordova"]=1:io()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=l_.getInstance().currentlyOnline();return Ga(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),_e=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var su=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new _e(Ns,e),i=new _e(Ns,t);return this.compare(r,i)!==0}minPost(){return _e.MIN}};var i_,d_=class extends su{static get __EMPTY_NODE(){return i_}static set __EMPTY_NODE(e){i_=e}compare(e,t){return ea(e.name,t.name)}isDefinedOn(e){throw ro("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return _e.MIN}maxPost(){return new _e(xi,i_)}makePost(e,t){return V(typeof e=="string","KeyIndex indexValue must always be a string."),new _e(e,i_)}toString(){return".key"}},ni=new d_;var ru=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Ir=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Zn.EMPTY_NODE,this.right=o??Zn.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Zn.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Zn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),cS=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new Ir(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Zn=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ir.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ir.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ru(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new ru(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new ru(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new ru(this.root_,null,this.comparator_,!0,e)}};Zn.EMPTY_NODE=new cS;function o7(n,e){return ea(n.name,e.name)}function o0(n,e){return ea(n,e)}var uS;function a7(n){uS=n}var mU=function(n){return typeof n=="number"?"number:"+JV(n):"string:"+n},_U=function(n){if(n.isLeafNode()){let e=n.val();V(typeof e=="string"||typeof e=="number"||typeof e=="object"&&an(e,".sv"),"Priority must be a string or number.")}else V(n===uS||n.isEmpty(),"priority of unexpected type.");V(n===uS||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var RV,ou=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,V(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),_U(this.priorityNode_)}static set __childrenNodeConstructor(t){RV=t}static get __childrenNodeConstructor(){return RV}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return ge(t)?this:pe(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=pe(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(V(i!==".priority"||xs(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(je(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+mU(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=JV(this.value_):t+=this.value_,this.lazyHash_=KV(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(V(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return V(s>=0,"Unknown leaf type: "+r),V(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),yU,vU;function c7(n){yU=n}function u7(n){vU=n}var lS=class extends su{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?ea(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return _e.MIN}maxPost(){return new _e(xi,new ou("[PRIORITY-POST]",vU))}makePost(e,t){let r=yU(e);return new _e(t,new ou("[PRIORITY-POST]",r))}toString(){return".priority"}},qe=new lS;var l7=Math.log(2),dS=class{constructor(e){let t=s=>parseInt(Math.log(s)/l7,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},h_=function(n,e,t,r){n.sort(e);let i=function(c,u){let d=u-c,h,g;if(d===0)return null;if(d===1)return h=n[c],g=t?t(h):h,new Ir(g,h.node,Ir.BLACK,null,null);{let _=parseInt(d/2,10)+c,w=i(c,_),C=i(_+1,u);return h=n[_],g=t?t(h):h,new Ir(g,h.node,Ir.BLACK,w,C)}},s=function(c){let u=null,d=null,h=n.length,g=function(w,C){let A=h-w,O=h;h-=w;let H=i(A+1,O),F=n[A],z=t?t(F):F;_(new Ir(z,F.node,C,null,H))},_=function(w){u?(u.left=w,u=w):(d=w,u=w)};for(let w=0;w<c.count;++w){let C=c.nextBitIsOne(),A=Math.pow(2,c.count-(w+1));C?g(A,Ir.BLACK):(g(A,Ir.BLACK),g(A,Ir.RED))}return d},o=new dS(n.length),a=s(o);return new Zn(r||e,a)};var zD,tu={},au=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return V(tu&&qe,"ChildrenNode.ts has not been loaded"),zD=zD||new n({".priority":tu},{".priority":qe}),zD}get(e){let t=Yi(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Zn?t:null}hasIndex(e){return an(this.indexSet_,e.toString())}addIndex(e,t){V(e!==ni,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(_e.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=h_(r,e.getCompare()):a=tu;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,u)}addToIndexes(e,t){let r=Ul(this.indexes_,(i,s)=>{let o=Yi(this.indexSet_,s);if(V(o,"Missing index implementation for "+s),i===tu)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(_e.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),h_(a,o.getCompare())}else return tu;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new _e(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Ul(this.indexes_,i=>{if(i===tu)return i;{let s=t.get(e.name);return s?i.remove(new _e(e.name,s)):i}});return new n(r,this.indexSet_)}};var ah,le=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&_U(this.priorityNode_),this.children_.isEmpty()&&V(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ah||(ah=new n(new Zn(o0),null,au.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ah}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?ah:r}}getChild(t){let r=pe(t);return r===null?this:this.getImmediateChild(r).getChild(je(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(V(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new _e(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?ah:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=pe(t);if(i===null)return r;{V(pe(t)!==".priority"||xs(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(je(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(qe,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+mU(this.getPriority().val())+":"),this.forEachChild(qe,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":KV(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new _e(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new _e(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new _e(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,_e.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,_e.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Nh?-1:0}withIndex(t){if(t===ni||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===ni||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(qe),s=r.getIterator(qe),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===ni?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),hS=class extends le{constructor(){super(new Zn(o0),le.EMPTY_NODE,au.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return le.EMPTY_NODE}isEmpty(){return!1}},Nh=new hS;Object.defineProperties(_e,{MIN:{value:new _e(Ns,le.EMPTY_NODE)},MAX:{value:new _e(xi,Nh)}});d_.__EMPTY_NODE=le.EMPTY_NODE;ou.__childrenNodeConstructor=le;a7(Nh);u7(Nh);var d7=!0;function et(n,e=null){if(n===null)return le.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),V(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new ou(t,et(e))}if(!(n instanceof Array)&&d7){let t=[],r=!1;if(Lt(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=et(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new _e(o,c)))}}),t.length===0)return le.EMPTY_NODE;let s=h_(t,o7,o=>o.name,o0);if(r){let o=h_(t,qe.getCompare());return new le(s,et(e),new au({".priority":o},{".priority":qe}))}else return new le(s,et(e),au.Default)}else{let t=le.EMPTY_NODE;return Lt(n,(r,i)=>{if(an(n,r)&&r.substring(0,1)!=="."){let s=et(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(et(e))}}c7(et);var mh=class extends su{constructor(e){super(),this.indexPath_=e,V(!ge(e)&&pe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?ea(e.name,t.name):s}makePost(e,t){let r=et(e),i=le.EMPTY_NODE.updateChild(this.indexPath_,r);return new _e(t,i)}maxPost(){let e=le.EMPTY_NODE.updateChild(this.indexPath_,Nh);return new _e(xi,e)}toString(){return gh(this.indexPath_,0).join("/")}};var fS=class extends su{compare(e,t){let r=e.node.compareTo(t.node);return r===0?ea(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return _e.MIN}maxPost(){return _e.MAX}makePost(e,t){let r=et(e);return new _e(t,r)}toString(){return".value"}},a0=new fS;function wU(n){return{type:"value",snapshotNode:n}}function cu(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function _h(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function yh(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function h7(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var vh=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){V(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(_h(t,a)):V(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(cu(t,r)):o.trackChildChange(yh(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(qe,(i,s)=>{t.hasChild(i)||r.trackChildChange(_h(i,s))}),t.isLeafNode()||t.forEachChild(qe,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(yh(i,s,o))}else r.trackChildChange(cu(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?le.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var f_=class n{constructor(e){this.indexedFilter_=new vh(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new _e(t,r))||(r=le.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=le.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(le.EMPTY_NODE);let s=this;return t.forEachChild(qe,(o,a)=>{s.matches(new _e(o,a))||(i=i.updateImmediateChild(o,le.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var pS=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new f_(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new _e(t,r))||(r=le.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=le.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=le.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(le.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,le.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(g,_)=>h(_,g)}else o=this.index_.getCompare();let a=e;V(a.numChildren()===this.limit_,"");let c=new _e(t,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(t)){let h=a.getImmediateChild(t),g=i.getChildAfterChild(this.index_,u,this.reverse_);for(;g!=null&&(g.name===t||a.hasChild(g.name));)g=i.getChildAfterChild(this.index_,g,this.reverse_);let _=g==null?1:o(g,c);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(yh(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(_h(t,h));let C=a.updateImmediateChild(t,le.EMPTY_NODE);return g!=null&&this.rangedFilter_.matches(g)?(s?.trackChildChange(cu(g.name,g.node)),C.updateImmediateChild(g.name,g.node)):C}}else return r.isEmpty()?e:d&&o(u,c)>=0?(s!=null&&(s.trackChildChange(_h(u.name,u.node)),s.trackChildChange(cu(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(u.name,le.EMPTY_NODE)):e}};var wh=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=qe}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return V(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return V(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ns}hasEnd(){return this.endSet_}getIndexEndValue(){return V(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return V(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:xi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return V(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===qe}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function f7(n){return n.loadsAllData()?new vh(n.getIndex()):n.hasLimit()?new pS(n):new f_(n)}function p7(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function g7(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function gS(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function m7(n,e,t){let r;return n.index_===ni||t?r=gS(n,e,t):r=gS(n,e,xi),r.startAfterSet_=!0,r}function mS(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function _7(n,e,t){let r;return n.index_===ni||t?r=mS(n,e,t):r=mS(n,e,Ns),r.endBeforeSet_=!0,r}function P_(n,e){let t=n.copy();return t.index_=e,t}function NV(n){let e={};if(n.isDefault())return e;let t;if(n.index_===qe?t="$priority":n.index_===a0?t="$value":n.index_===ni?t="$key":(V(n.index_ instanceof mh,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=gt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=gt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+gt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=gt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+gt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function xV(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==qe&&(e.i=n.index_.toString()),e}var _S=class n extends c_{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Rh("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(V(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=NV(e._queryParams);this.restRequest_(s+".json",c,(u,d)=>{let h=d;if(u===404&&(h=null,u=null),u===null&&this.onDataUpdate_(s,h,!1,r),Yi(this.listens_,o)===a){let g;u?u===401?g="permission_denied":g="rest_error:"+u:g="ok",i(g,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=NV(e._queryParams),r=e._path.toString(),i=new Ct;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+_i(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Ha(a.responseText)}catch{en("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&en("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var yS=class{constructor(){this.rootNode_=le.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function p_(){return{value:null,children:new Map}}function pu(n,e,t){if(ge(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=pe(e);n.children.has(r)||n.children.set(r,p_());let i=n.children.get(r);e=je(e),pu(i,e,t)}}function vS(n,e){if(ge(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(qe,(r,i)=>{pu(n,new Re(r),i)}),vS(n,e)}}else if(n.children.size>0){let t=pe(e);return e=je(e),n.children.has(t)&&vS(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function wS(n,e,t){n.value!==null?t(e,n.value):y7(n,(r,i)=>{let s=new Re(e.toString()+"/"+r);wS(i,s,t)})}function y7(n,e){n.children.forEach((t,r)=>{e(r,t)})}var IS=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Lt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var PV=10*1e3,v7=30*1e3,w7=5*60*1e3,ES=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new IS(e);let r=PV+(v7-PV)*Math.random();uh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Lt(e,(i,s)=>{s>0&&an(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),uh(this.reportStats_.bind(this),Math.floor(Math.random()*2*w7))}};var ti=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(ti||{});function c0(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function u0(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function l0(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var TS=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=ti.ACK_USER_WRITE,this.source=c0()}operationForChild(e){if(ge(this.path)){if(this.affectedTree.value!=null)return V(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new Re(e));return new n(Ae(),t,this.revert)}}else return V(pe(this.path)===e,"operationForChild called for unrelated child."),new n(je(this.path),this.affectedTree,this.revert)}};var g_=class n{constructor(e,t){this.source=e,this.path=t,this.type=ti.LISTEN_COMPLETE}operationForChild(e){return ge(this.path)?new n(this.source,Ae()):new n(this.source,je(this.path))}};var uu=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=ti.OVERWRITE}operationForChild(e){return ge(this.path)?new n(this.source,Ae(),this.snap.getImmediateChild(e)):new n(this.source,je(this.path),this.snap)}};var Ih=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=ti.MERGE}operationForChild(e){if(ge(this.path)){let t=this.children.subtree(new Re(e));return t.isEmpty()?null:t.value?new uu(this.source,Ae(),t.value):new n(this.source,Ae(),t)}else return V(pe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,je(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var ii=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ge(e))return this.isFullyInitialized()&&!this.filtered_;let t=pe(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var bS=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function I7(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(h7(o.childName,o.snapshotNode))}),ch(n,i,"child_removed",e,r,t),ch(n,i,"child_added",e,r,t),ch(n,i,"child_moved",s,r,t),ch(n,i,"child_changed",e,r,t),ch(n,i,"value",e,r,t),i}function ch(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>T7(n,a,c)),o.forEach(a=>{let c=E7(n,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,n.query_))})})}function E7(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function T7(n,e,t){if(e.childName==null||t.childName==null)throw ro("Should only compare child_ events.");let r=new _e(e.childName,e.snapshotNode),i=new _e(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function M_(n,e){return{eventCache:n,serverCache:e}}function dh(n,e,t,r){return M_(new ii(e,t,r),n.serverCache)}function IU(n,e,t,r){return M_(n.eventCache,new ii(e,t,r))}function m_(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Zo(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var GD,b7=()=>(GD||(GD=new Zn(EQ)),GD),gn=class n{constructor(e,t=b7()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Lt(e,(r,i)=>{t=t.set(new Re(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Ae(),value:this.value};if(ge(e))return null;{let r=pe(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(je(e),t);return s!=null?{path:Ye(new Re(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ge(e))return this;{let t=pe(e),r=this.children.get(t);return r!==null?r.subtree(je(e)):new n(null)}}set(e,t){if(ge(e))return new n(t,this.children);{let r=pe(e),s=(this.children.get(r)||new n(null)).set(je(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(ge(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=pe(e),r=this.children.get(t);if(r){let i=r.remove(je(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(ge(e))return this.value;{let t=pe(e),r=this.children.get(t);return r?r.get(je(e)):null}}setTree(e,t){if(ge(e))return t;{let r=pe(e),s=(this.children.get(r)||new n(null)).setTree(je(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Ae(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Ye(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Ae(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(ge(e))return null;{let s=pe(e),o=this.children.get(s);return o?o.findOnPath_(je(e),Ye(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ae(),t)}foreachOnPath_(e,t,r){if(ge(e))return this;{this.value&&r(t,this.value);let i=pe(e),s=this.children.get(i);return s?s.foreachOnPath_(je(e),Ye(t,i),r):new n(null)}}foreach(e){this.foreach_(Ae(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Ye(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Er=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new gn(null))}};function hh(n,e,t){if(ge(e))return new Er(new gn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=pn(i,e);return s=s.updateChild(o,t),new Er(n.writeTree_.set(i,s))}else{let i=new gn(t),s=n.writeTree_.setTree(e,i);return new Er(s)}}}function CS(n,e,t){let r=n;return Lt(t,(i,s)=>{r=hh(r,Ye(e,i),s)}),r}function MV(n,e){if(ge(e))return Er.empty();{let t=n.writeTree_.setTree(e,new gn(null));return new Er(t)}}function DS(n,e){return ta(n,e)!=null}function ta(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(pn(t.path,e)):null}function kV(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(qe,(r,i)=>{e.push(new _e(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new _e(r,i.value))}),e}function As(n,e){if(ge(e))return n;{let t=ta(n,e);return t!=null?new Er(new gn(t)):new Er(n.writeTree_.subtree(e))}}function SS(n){return n.writeTree_.isEmpty()}function lu(n,e){return EU(Ae(),n.writeTree_,e)}function EU(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(V(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=EU(Ye(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Ye(n,".priority"),r)),t}}function k_(n,e){return DU(e,n)}function C7(n,e,t,r,i){V(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=hh(n.visibleWrites,e,t)),n.lastWriteId=r}function D7(n,e,t,r){V(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=CS(n.visibleWrites,e,t),n.lastWriteId=r}function S7(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function A7(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);V(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&R7(a,r.path)?i=!1:Xn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return N7(n),!0;if(r.snap)n.visibleWrites=MV(n.visibleWrites,r.path);else{let a=r.children;Lt(a,c=>{n.visibleWrites=MV(n.visibleWrites,Ye(r.path,c))})}return!0}else return!1}function R7(n,e){if(n.snap)return Xn(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Xn(Ye(n.path,t),e))return!0;return!1}function N7(n){n.visibleWrites=TU(n.allWrites,x7,Ae()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function x7(n){return n.visible}function TU(n,e,t){let r=Er.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)Xn(t,o)?(a=pn(t,o),r=hh(r,a,s.snap)):Xn(o,t)&&(a=pn(o,t),r=hh(r,Ae(),s.snap.getChild(a)));else if(s.children){if(Xn(t,o))a=pn(t,o),r=CS(r,a,s.children);else if(Xn(o,t))if(a=pn(o,t),ge(a))r=CS(r,Ae(),s.children);else{let c=Yi(s.children,pe(a));if(c){let u=c.getChild(je(a));r=hh(r,Ae(),u)}}}else throw ro("WriteRecord should have .snap or .children")}}return r}function bU(n,e,t,r,i){if(!r&&!i){let s=ta(n.visibleWrites,e);if(s!=null)return s;{let o=As(n.visibleWrites,e);if(SS(o))return t;if(t==null&&!DS(o,Ae()))return null;{let a=t||le.EMPTY_NODE;return lu(o,a)}}}else{let s=As(n.visibleWrites,e);if(!i&&SS(s))return t;if(!i&&t==null&&!DS(s,Ae()))return null;{let o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(Xn(u.path,e)||Xn(e,u.path))},a=TU(n.allWrites,o,e),c=t||le.EMPTY_NODE;return lu(a,c)}}}function P7(n,e,t){let r=le.EMPTY_NODE,i=ta(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(qe,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=As(n.visibleWrites,e);return t.forEachChild(qe,(o,a)=>{let c=lu(As(s,new Re(o)),a);r=r.updateImmediateChild(o,c)}),kV(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=As(n.visibleWrites,e);return kV(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function M7(n,e,t,r,i){V(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Ye(e,t);if(DS(n.visibleWrites,s))return null;{let o=As(n.visibleWrites,s);return SS(o)?i.getChild(t):lu(o,i.getChild(t))}}function k7(n,e,t,r){let i=Ye(e,t),s=ta(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=As(n.visibleWrites,i);return lu(o,r.getNode().getImmediateChild(t))}else return null}function O7(n,e){return ta(n.visibleWrites,e)}function L7(n,e,t,r,i,s,o){let a,c=As(n.visibleWrites,e),u=ta(c,Ae());if(u!=null)a=u;else if(t!=null)a=lu(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),g=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=g.getNext();for(;_&&d.length<i;)h(_,r)!==0&&d.push(_),_=g.getNext();return d}else return[]}function F7(){return{visibleWrites:Er.empty(),allWrites:[],lastWriteId:-1}}function __(n,e,t,r){return bU(n.writeTree,n.treePath,e,t,r)}function d0(n,e){return P7(n.writeTree,n.treePath,e)}function OV(n,e,t,r){return M7(n.writeTree,n.treePath,e,t,r)}function y_(n,e){return O7(n.writeTree,Ye(n.treePath,e))}function V7(n,e,t,r,i,s){return L7(n.writeTree,n.treePath,e,t,r,i,s)}function h0(n,e,t){return k7(n.writeTree,n.treePath,e,t)}function CU(n,e){return DU(Ye(n.treePath,e),n.writeTree)}function DU(n,e){return{treePath:n,writeTree:e}}var AS=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;V(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),V(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,yh(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,_h(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,cu(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,yh(r,e.snapshotNode,i.oldSnap));else throw ro("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var RS=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},SU=new RS,Eh=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new ii(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return h0(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Zo(this.viewCache_),s=V7(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function U7(n){return{filter:n}}function B7(n,e){V(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),V(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function j7(n,e,t,r,i){let s=new AS,o,a;if(t.type===ti.OVERWRITE){let u=t;u.source.fromUser?o=NS(n,e,u.path,u.snap,r,i,s):(V(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!ge(u.path),o=v_(n,e,u.path,u.snap,r,i,a,s))}else if(t.type===ti.MERGE){let u=t;u.source.fromUser?o=H7(n,e,u.path,u.children,r,i,s):(V(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=xS(n,e,u.path,u.children,r,i,a,s))}else if(t.type===ti.ACK_USER_WRITE){let u=t;u.revert?o=G7(n,e,u.path,r,i,s):o=q7(n,e,u.path,u.affectedTree,r,i,s)}else if(t.type===ti.LISTEN_COMPLETE)o=z7(n,e,t.path,r,s);else throw ro("Unknown operation type: "+t.type);let c=s.getChanges();return $7(e,o,c),{viewCache:o,changes:c}}function $7(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=m_(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(wU(m_(e)))}}function AU(n,e,t,r,i,s){let o=e.eventCache;if(y_(r,t)!=null)return e;{let a,c;if(ge(t))if(V(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=Zo(e),d=u instanceof le?u:le.EMPTY_NODE,h=d0(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let u=__(r,Zo(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=pe(t);if(u===".priority"){V(xs(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let h=OV(r,t,d,c);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=je(t),h;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();let g=OV(r,t,o.getNode(),c);g!=null?h=o.getNode().getImmediateChild(u).updateChild(d,g):h=o.getNode().getImmediateChild(u)}else h=h0(r,u,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),u,h,d,i,s):a=o.getNode()}}return dh(e,a,o.isFullyInitialized()||ge(t),n.filter.filtersNodes())}}function v_(n,e,t,r,i,s,o,a){let c=e.serverCache,u,d=o?n.filter:n.filter.getIndexedFilter();if(ge(t))u=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);u=d.updateFullNode(c.getNode(),_,null)}else{let _=pe(t);if(!c.isCompleteForPath(t)&&xs(t)>1)return e;let w=je(t),A=c.getNode().getImmediateChild(_).updateChild(w,r);_===".priority"?u=d.updatePriority(c.getNode(),A):u=d.updateChild(c.getNode(),_,A,w,SU,null)}let h=IU(e,u,c.isFullyInitialized()||ge(t),d.filtersNodes()),g=new Eh(i,h,s);return AU(n,h,t,i,g,a)}function NS(n,e,t,r,i,s,o){let a=e.eventCache,c,u,d=new Eh(i,e,s);if(ge(t))u=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=dh(e,u,!0,n.filter.filtersNodes());else{let h=pe(t);if(h===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),r),c=dh(e,u,a.isFullyInitialized(),a.isFiltered());else{let g=je(t),_=a.getNode().getImmediateChild(h),w;if(ge(g))w=r;else{let C=d.getCompleteChild(h);C!=null?r0(g)===".priority"&&C.getChild(pU(g)).isEmpty()?w=C:w=C.updateChild(g,r):w=le.EMPTY_NODE}if(_.equals(w))c=e;else{let C=n.filter.updateChild(a.getNode(),h,w,g,d,o);c=dh(e,C,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function LV(n,e){return n.eventCache.isCompleteForChild(e)}function H7(n,e,t,r,i,s,o){let a=e;return r.foreach((c,u)=>{let d=Ye(t,c);LV(e,pe(d))&&(a=NS(n,a,d,u,i,s,o))}),r.foreach((c,u)=>{let d=Ye(t,c);LV(e,pe(d))||(a=NS(n,a,d,u,i,s,o))}),a}function FV(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function xS(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;ge(t)?u=r:u=new gn(null).setTree(t,r);let d=e.serverCache.getNode();return u.children.inorderTraversal((h,g)=>{if(d.hasChild(h)){let _=e.serverCache.getNode().getImmediateChild(h),w=FV(n,_,g);c=v_(n,c,new Re(h),w,i,s,o,a)}}),u.children.inorderTraversal((h,g)=>{let _=!e.serverCache.isCompleteForChild(h)&&g.value===null;if(!d.hasChild(h)&&!_){let w=e.serverCache.getNode().getImmediateChild(h),C=FV(n,w,g);c=v_(n,c,new Re(h),C,i,s,o,a)}}),c}function q7(n,e,t,r,i,s,o){if(y_(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(ge(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return v_(n,e,t,c.getNode().getChild(t),i,s,a,o);if(ge(t)){let u=new gn(null);return c.getNode().forEachChild(ni,(d,h)=>{u=u.set(new Re(d),h)}),xS(n,e,t,u,i,s,a,o)}else return e}else{let u=new gn(null);return r.foreach((d,h)=>{let g=Ye(t,d);c.isCompleteForPath(g)&&(u=u.set(d,c.getNode().getChild(g)))}),xS(n,e,t,u,i,s,a,o)}}function z7(n,e,t,r,i){let s=e.serverCache,o=IU(e,s.getNode(),s.isFullyInitialized()||ge(t),s.isFiltered());return AU(n,o,t,r,SU,i)}function G7(n,e,t,r,i,s){let o;if(y_(r,t)!=null)return e;{let a=new Eh(r,e,i),c=e.eventCache.getNode(),u;if(ge(t)||pe(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=__(r,Zo(e));else{let h=e.serverCache.getNode();V(h instanceof le,"serverChildren would be complete if leaf node"),d=d0(r,h)}d=d,u=n.filter.updateFullNode(c,d,s)}else{let d=pe(t),h=h0(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?u=n.filter.updateChild(c,d,h,je(t),a,s):e.eventCache.getNode().hasChild(d)?u=n.filter.updateChild(c,d,le.EMPTY_NODE,je(t),a,s):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=__(r,Zo(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||y_(r,Ae())!=null,dh(e,u,o,n.filter.filtersNodes())}}var PS=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new vh(r.getIndex()),s=f7(r);this.processor_=U7(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(le.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(le.EMPTY_NODE,a.getNode(),null),d=new ii(c,o.isFullyInitialized(),i.filtersNodes()),h=new ii(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=M_(h,d),this.eventGenerator_=new bS(this.query_)}get query(){return this.query_}};function W7(n){return n.viewCache_.serverCache.getNode()}function K7(n){return m_(n.viewCache_)}function Q7(n,e){let t=Zo(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!ge(e)&&!t.getImmediateChild(pe(e)).isEmpty())?t.getChild(e):null}function VV(n){return n.eventRegistrations_.length===0}function Y7(n,e){n.eventRegistrations_.push(e)}function UV(n,e,t){let r=[];if(t){V(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function BV(n,e,t,r){e.type===ti.MERGE&&e.source.queryId!==null&&(V(Zo(n.viewCache_),"We should always have a full cache before handling merges"),V(m_(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=j7(n.processor_,i,e,t,r);return B7(n.processor_,s.viewCache),V(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,RU(n,s.changes,s.viewCache.eventCache.getNode(),null)}function J7(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(qe,(s,o)=>{r.push(cu(s,o))}),t.isFullyInitialized()&&r.push(wU(t.getNode())),RU(n,r,t.getNode(),e)}function RU(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return I7(n.eventGenerator_,e,t,i)}var w_,I_=class{constructor(){this.views=new Map}};function X7(n){V(!w_,"__referenceConstructor has already been defined"),w_=n}function Z7(){return V(w_,"Reference.ts has not been loaded"),w_}function eY(n){return n.views.size===0}function f0(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return V(s!=null,"SyncTree gave us an op for an invalid query."),BV(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(BV(o,e,t,r));return s}}function NU(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=__(t,i?r:null),c=!1;a?c=!0:r instanceof le?(a=d0(t,r),c=!1):(a=le.EMPTY_NODE,c=!1);let u=M_(new ii(a,c,!1),new ii(r,i,!1));return new PS(e,u)}return o}function tY(n,e,t,r,i,s){let o=NU(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),Y7(o,t),J7(o,t)}function nY(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=Ps(n);if(i==="default")for(let[c,u]of n.views.entries())o=o.concat(UV(u,t,r)),VV(u)&&(n.views.delete(c),u.query._queryParams.loadsAllData()||s.push(u.query));else{let c=n.views.get(i);c&&(o=o.concat(UV(c,t,r)),VV(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!Ps(n)&&s.push(new(Z7())(e._repo,e._path)),{removed:s,events:o}}function xU(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Rs(n,e){let t=null;for(let r of n.views.values())t=t||Q7(r,e);return t}function PU(n,e){if(e._queryParams.loadsAllData())return O_(n);{let r=e._queryIdentifier;return n.views.get(r)}}function MU(n,e){return PU(n,e)!=null}function Ps(n){return O_(n)!=null}function O_(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var E_;function rY(n){V(!E_,"__referenceConstructor has already been defined"),E_=n}function iY(){return V(E_,"Reference.ts has not been loaded"),E_}var sY=1,T_=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new gn(null),this.pendingWriteTree_=F7(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function p0(n,e,t,r,i){return C7(n.pendingWriteTree_,e,t,r,i),i?gu(n,new uu(c0(),e,t)):[]}function oY(n,e,t,r){D7(n.pendingWriteTree_,e,t,r);let i=gn.fromObject(t);return gu(n,new Ih(c0(),e,i))}function Ss(n,e,t=!1){let r=S7(n.pendingWriteTree_,e);if(A7(n.pendingWriteTree_,e)){let s=new gn(null);return r.snap!=null?s=s.set(Ae(),!0):Lt(r.children,o=>{s=s.set(new Re(o),!0)}),gu(n,new TS(r.path,s,t))}else return[]}function xh(n,e,t){return gu(n,new uu(u0(),e,t))}function aY(n,e,t){let r=gn.fromObject(t);return gu(n,new Ih(u0(),e,r))}function cY(n,e){return gu(n,new g_(u0(),e))}function uY(n,e,t){let r=g0(n,t);if(r){let i=m0(r),s=i.path,o=i.queryId,a=pn(s,e),c=new g_(l0(o),a);return _0(n,s,c)}else return[]}function b_(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||MU(o,e))){let c=nY(o,e,t,r);eY(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let u=c.removed;if(a=c.events,!i){let d=u.findIndex(g=>g._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(g,_)=>Ps(_));if(d&&!h){let g=n.syncPointTree_.subtree(s);if(!g.isEmpty()){let _=hY(g);for(let w=0;w<_.length;++w){let C=_[w],A=C.query,O=FU(n,C);n.listenProvider_.startListening(fh(A),Th(n,A),O.hashFn,O.onComplete)}}}!h&&u.length>0&&!r&&(d?n.listenProvider_.stopListening(fh(e),null):u.forEach(g=>{let _=n.queryToTagMap.get(F_(g));n.listenProvider_.stopListening(fh(g),_)}))}fY(n,u)}return a}function kU(n,e,t,r){let i=g0(n,r);if(i!=null){let s=m0(i),o=s.path,a=s.queryId,c=pn(o,e),u=new uu(l0(a),c,t);return _0(n,o,u)}else return[]}function lY(n,e,t,r){let i=g0(n,r);if(i){let s=m0(i),o=s.path,a=s.queryId,c=pn(o,e),u=gn.fromObject(t),d=new Ih(l0(a),c,u);return _0(n,o,d)}else return[]}function MS(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(g,_)=>{let w=pn(g,i);s=s||Rs(_,w),o=o||Ps(_)});let a=n.syncPointTree_.get(i);a?(o=o||Ps(a),s=s||Rs(a,Ae())):(a=new I_,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=le.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,w)=>{let C=Rs(w,Ae());C&&(s=s.updateImmediateChild(_,C))}));let u=MU(a,e);if(!u&&!e._queryParams.loadsAllData()){let g=F_(e);V(!n.queryToTagMap.has(g),"View does not exist, but we have a tag");let _=pY();n.queryToTagMap.set(g,_),n.tagToQueryMap.set(_,g)}let d=k_(n.pendingWriteTree_,i),h=tY(a,e,t,d,s,c);if(!u&&!o&&!r){let g=PU(a,e);h=h.concat(gY(n,e,g))}return h}function L_(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=pn(o,e),u=Rs(a,c);if(u)return u});return bU(i,e,s,t,!0)}function dY(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(u,d)=>{let h=pn(u,t);r=r||Rs(d,h)});let i=n.syncPointTree_.get(t);i?r=r||Rs(i,Ae()):(i=new I_,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new ii(r,!0,!1):null,a=k_(n.pendingWriteTree_,e._path),c=NU(i,e,a,s?o.getNode():le.EMPTY_NODE,s);return K7(c)}function gu(n,e){return OU(e,n.syncPointTree_,null,k_(n.pendingWriteTree_,Ae()))}function OU(n,e,t,r){if(ge(n.path))return LU(n,e,t,r);{let i=e.get(Ae());t==null&&i!=null&&(t=Rs(i,Ae()));let s=[],o=pe(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let u=t?t.getImmediateChild(o):null,d=CU(r,o);s=s.concat(OU(a,c,u,d))}return i&&(s=s.concat(f0(i,n,r,t))),s}}function LU(n,e,t,r){let i=e.get(Ae());t==null&&i!=null&&(t=Rs(i,Ae()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,u=CU(r,o),d=n.operationForChild(o);d&&(s=s.concat(LU(d,a,c,u)))}),i&&(s=s.concat(f0(i,n,r,t))),s}function FU(n,e){let t=e.query,r=Th(n,t);return{hashFn:()=>(W7(e)||le.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?uY(n,t._path,r):cY(n,t._path);{let s=CQ(i,t);return b_(n,t,null,s)}}}}function Th(n,e){let t=F_(e);return n.queryToTagMap.get(t)}function F_(n){return n._path.toString()+"$"+n._queryIdentifier}function g0(n,e){return n.tagToQueryMap.get(e)}function m0(n){let e=n.indexOf("$");return V(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Re(n.substr(0,e))}}function _0(n,e,t){let r=n.syncPointTree_.get(e);V(r,"Missing sync point for query tag that we're tracking");let i=k_(n.pendingWriteTree_,e);return f0(r,t,i,null)}function hY(n){return n.fold((e,t,r)=>{if(t&&Ps(t))return[O_(t)];{let i=[];return t&&(i=xU(t)),Lt(r,(s,o)=>{i=i.concat(o)}),i}})}function fh(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(iY())(n._repo,n._path):n}function fY(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=F_(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function pY(){return sY++}function gY(n,e,t){let r=e._path,i=Th(n,e),s=FU(n,t),o=n.listenProvider_.startListening(fh(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)V(!Ps(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((u,d,h)=>{if(!ge(u)&&d&&Ps(d))return[O_(d).query];{let g=[];return d&&(g=g.concat(xU(d).map(_=>_.query))),Lt(h,(_,w)=>{g=g.concat(w)}),g}});for(let u=0;u<c.length;++u){let d=c[u];n.listenProvider_.stopListening(fh(d),Th(n,d))}}return o}var kS=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},OS=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=Ye(this.path_,e);return new n(this.syncTree_,t)}node(){return L_(this.syncTree_,this.path_)}},mY=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},jV=function(n,e,t){if(!n||typeof n!="object")return n;if(V(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return _Y(n[".sv"],e,t);if(typeof n[".sv"]=="object")return yY(n[".sv"],e);V(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},_Y=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:V(!1,"Unexpected server value: "+n)}},yY=function(n,e,t){n.hasOwnProperty("increment")||V(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&V(!1,"Unexpected increment value: "+r);let i=e.node();if(V(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},VU=function(n,e,t,r){return v0(e,new OS(t,n),r)},y0=function(n,e,t){return v0(n,new kS(e),t)};function v0(n,e,t){let r=n.getPriority().val(),i=jV(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=jV(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new ou(a,et(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new ou(i))),o.forEachChild(qe,(a,c)=>{let u=v0(c,e.getImmediateChild(a),t);u!==c&&(s=s.updateImmediateChild(a,u))}),s}}var bh=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function V_(n,e){let t=e instanceof Re?e:new Re(e),r=n,i=pe(t);for(;i!==null;){let s=Yi(r.node.children,i)||{children:{},childCount:0};r=new bh(i,r,s),t=je(t),i=pe(t)}return r}function na(n){return n.node.value}function w0(n,e){n.node.value=e,LS(n)}function UU(n){return n.node.childCount>0}function vY(n){return na(n)===void 0&&!UU(n)}function U_(n,e){Lt(n.node.children,(t,r)=>{e(new bh(t,n,r))})}function BU(n,e,t,r){t&&!r&&e(n),U_(n,i=>{BU(i,e,!0,r)}),t&&r&&e(n)}function wY(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Ph(n){return new Re(n.parent===null?n.name:Ph(n.parent)+"/"+n.name)}function LS(n){n.parent!==null&&IY(n.parent,n.name,n)}function IY(n,e,t){let r=vY(t),i=an(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,LS(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,LS(n))}var EY=/[\[\].#$\/\u0000-\u001F\u007F]/,TY=/[\[\].#$\u0000-\u001F\u007F]/,WD=10*1024*1024,B_=function(n){return typeof n=="string"&&n.length!==0&&!EY.test(n)},jU=function(n){return typeof n=="string"&&n.length!==0&&!TY.test(n)},bY=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),jU(n)},Ch=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!x_(n)||n&&typeof n=="object"&&an(n,".sv")},si=function(n,e,t,r){r&&e===void 0||Mh(Qt(n,"value"),e,t)},Mh=function(n,e,t){let r=t instanceof Re?new oS(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Yo(r));if(typeof e=="function")throw new Error(n+"contains a function "+Yo(r)+" with contents = "+e.toString());if(x_(e))throw new Error(n+"contains "+e.toString()+" "+Yo(r));if(typeof e=="string"&&e.length>WD/3&&Bl(e)>WD)throw new Error(n+"contains a string greater than "+WD+" utf8 bytes "+Yo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Lt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!B_(o)))throw new Error(n+" contains an invalid key ("+o+") "+Yo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);e7(r,o),Mh(n,a,r),t7(r)}),i&&s)throw new Error(n+' contains ".value" child '+Yo(r)+" in addition to actual children.")}},CY=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=gh(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!B_(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(ZQ);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&Xn(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},$U=function(n,e,t,r){if(r&&e===void 0)return;let i=Qt(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Lt(e,(o,a)=>{let c=new Re(o);if(Mh(i,a,Ye(t,c)),r0(c)===".priority"&&!Ch(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),CY(i,s)},I0=function(n,e,t){if(!(t&&e===void 0)){if(x_(e))throw new Error(Qt(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ch(e))throw new Error(Qt(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},kh=function(n,e,t,r){if(!(r&&t===void 0)&&!B_(t))throw new Error(Qt(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},mu=function(n,e,t,r){if(!(r&&t===void 0)&&!jU(t))throw new Error(Qt(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},DY=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),mu(n,e,t,r)},On=function(n,e){if(pe(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},HU=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!B_(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!bY(t))throw new Error(Qt(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var FS=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function j_(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!i0(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function qU(n,e,t){j_(n,t),zU(n,r=>i0(r,e))}function Ln(n,e,t){j_(n,t),zU(n,r=>Xn(r,e)||Xn(e,r))}function zU(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(SY(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function SY(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Xo&&Ot("event: "+t.toString()),fu(r)}}}var GU="repo_interrupt",AY=25,VS=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new FS,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=p_(),this.transactionQueueTree_=new bh,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function RY(n,e,t){if(n.stats_=n0(n.repoInfo_),n.forceRestClient_||RQ())n.server_=new _S(n.repoInfo_,(r,i,s,o)=>{$V(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>HV(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{gt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new s0(n.repoInfo_,e,(r,i,s,o)=>{$V(n,r,i,s,o)},r=>{HV(n,r)},r=>{NY(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=xQ(n.repoInfo_,()=>new ES(n.stats_,n.server_)),n.infoData_=new yS,n.infoSyncTree_=new T_({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=xh(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),E0(n,"connected",!1),n.serverSyncTree_=new T_({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let u=o(a,c);Ln(n.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function WU(n){let t=n.infoData_.getNode(new Re(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Oh(n){return mY({timestamp:WU(n)})}function $V(n,e,t,r,i){n.dataUpdateCount++;let s=new Re(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=Ul(t,u=>et(u));o=lY(n.serverSyncTree_,s,c,i)}else{let c=et(t);o=kU(n.serverSyncTree_,s,c,i)}else if(r){let c=Ul(t,u=>et(u));o=aY(n.serverSyncTree_,s,c)}else{let c=et(t);o=xh(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=du(n,s)),Ln(n.eventQueue_,a,o)}function HV(n,e){E0(n,"connected",e),e===!1&&MY(n)}function NY(n,e){Lt(e,(t,r)=>{E0(n,t,r)})}function E0(n,e,t){let r=new Re("/.info/"+e),i=et(t);n.infoData_.updateSnapshot(r,i);let s=xh(n.infoSyncTree_,r,i);Ln(n.eventQueue_,r,s)}function $_(n){return n.nextWriteId_++}function xY(n,e,t){let r=dY(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=et(i).withIndex(e._queryParams.getIndex());MS(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=xh(n.serverSyncTree_,e._path,s);else{let a=Th(n.serverSyncTree_,e);o=kU(n.serverSyncTree_,e._path,s,a)}return Ln(n.eventQueue_,e._path,o),b_(n.serverSyncTree_,e,t,null,!0),s},i=>(_u(n,"get for query "+gt(e)+" failed: "+i),Promise.reject(new Error(i))))}function T0(n,e,t,r,i){_u(n,"set",{path:e.toString(),value:t,priority:r});let s=Oh(n),o=et(t,r),a=L_(n.serverSyncTree_,e),c=y0(o,a,s),u=$_(n),d=p0(n.serverSyncTree_,e,c,u,!0);j_(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(g,_)=>{let w=g==="ok";w||en("set at "+e+" failed: "+g);let C=Ss(n.serverSyncTree_,u,!w);Ln(n.eventQueue_,e,C),Ms(n,i,g,_)});let h=C0(n,e);du(n,h),Ln(n.eventQueue_,h,[])}function PY(n,e,t,r){_u(n,"update",{path:e.toString(),value:t});let i=!0,s=Oh(n),o={};if(Lt(t,(a,c)=>{i=!1,o[a]=VU(Ye(e,a),et(c),n.serverSyncTree_,s)}),i)Ot("update() called with empty data.  Don't do anything."),Ms(n,r,"ok",void 0);else{let a=$_(n),c=oY(n.serverSyncTree_,e,o,a);j_(n.eventQueue_,c),n.server_.merge(e.toString(),t,(u,d)=>{let h=u==="ok";h||en("update at "+e+" failed: "+u);let g=Ss(n.serverSyncTree_,a,!h),_=g.length>0?du(n,e):e;Ln(n.eventQueue_,_,g),Ms(n,r,u,d)}),Lt(t,u=>{let d=C0(n,Ye(e,u));du(n,d)}),Ln(n.eventQueue_,e,[])}}function MY(n){_u(n,"onDisconnectEvents");let e=Oh(n),t=p_();wS(n.onDisconnect_,Ae(),(i,s)=>{let o=VU(i,s,n.serverSyncTree_,e);pu(t,i,o)});let r=[];wS(t,Ae(),(i,s)=>{r=r.concat(xh(n.serverSyncTree_,i,s));let o=C0(n,i);du(n,o)}),n.onDisconnect_=p_(),Ln(n.eventQueue_,Ae(),r)}function kY(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&vS(n.onDisconnect_,e),Ms(n,t,r,i)})}function qV(n,e,t,r){let i=et(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&pu(n.onDisconnect_,e,i),Ms(n,r,s,o)})}function OY(n,e,t,r,i){let s=et(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&pu(n.onDisconnect_,e,s),Ms(n,i,o,a)})}function LY(n,e,t,r){if(Ga(t)){Ot("onDisconnect().update() called with empty data.  Don't do anything."),Ms(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Lt(t,(o,a)=>{let c=et(a);pu(n.onDisconnect_,Ye(e,o),c)}),Ms(n,r,i,s)})}function FY(n,e,t){let r;pe(e._path)===".info"?r=MS(n.infoSyncTree_,e,t):r=MS(n.serverSyncTree_,e,t),qU(n.eventQueue_,e._path,r)}function US(n,e,t){let r;pe(e._path)===".info"?r=b_(n.infoSyncTree_,e,t):r=b_(n.serverSyncTree_,e,t),qU(n.eventQueue_,e._path,r)}function KU(n){n.persistentConnection_&&n.persistentConnection_.interrupt(GU)}function VY(n){n.persistentConnection_&&n.persistentConnection_.resume(GU)}function _u(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Ot(t,...e)}function Ms(n,e,t,r){e&&fu(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function UY(n,e,t,r,i,s){_u(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:WV(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=b0(n,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Mh("transaction failed: Data returned ",c,o.path),o.status=0;let u=V_(n.transactionQueueTree_,e),d=na(u)||[];d.push(o),w0(u,d);let h;typeof c=="object"&&c!==null&&an(c,".priority")?(h=Yi(c,".priority"),V(Ch(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(L_(n.serverSyncTree_,e)||le.EMPTY_NODE).getPriority().val();let g=Oh(n),_=et(c,h),w=y0(_,a,g);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=w,o.currentWriteId=$_(n);let C=p0(n.serverSyncTree_,e,w,o.currentWriteId,o.applyLocally);Ln(n.eventQueue_,e,C),H_(n,n.transactionQueueTree_)}}function b0(n,e,t){return L_(n.serverSyncTree_,e,t)||le.EMPTY_NODE}function H_(n,e=n.transactionQueueTree_){if(e||q_(n,e),na(e)){let t=YU(n,e);V(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&BY(n,Ph(e),t)}else UU(e)&&U_(e,t=>{H_(n,t)})}function BY(n,e,t){let r=t.map(u=>u.currentWriteId),i=b0(n,e,r),s=i,o=i.hash();for(let u=0;u<t.length;u++){let d=t[u];V(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=pn(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,u=>{_u(n,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){let h=[];for(let g=0;g<t.length;g++)t[g].status=2,d=d.concat(Ss(n.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&h.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();q_(n,V_(n.transactionQueueTree_,e)),H_(n,n.transactionQueueTree_),Ln(n.eventQueue_,e,d);for(let g=0;g<h.length;g++)fu(h[g])}else{if(u==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{en("transaction at "+c.toString()+" failed: "+u);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=u}du(n,e)}},o)}function du(n,e){let t=QU(n,e),r=Ph(t),i=YU(n,t);return jY(n,i,r),r}function jY(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=pn(t,c.path),d=!1,h;if(V(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,i=i.concat(Ss(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=AY)d=!0,h="maxretry",i=i.concat(Ss(n.serverSyncTree_,c.currentWriteId,!0));else{let g=b0(n,c.path,o);c.currentInputSnapshot=g;let _=e[a].update(g.val());if(_!==void 0){Mh("transaction failed: Data returned ",_,c.path);let w=et(_);typeof _=="object"&&_!=null&&an(_,".priority")||(w=w.updatePriority(g.getPriority()));let A=c.currentWriteId,O=Oh(n),H=y0(w,g,O);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=H,c.currentWriteId=$_(n),o.splice(o.indexOf(A),1),i=i.concat(p0(n.serverSyncTree_,c.path,H,c.currentWriteId,c.applyLocally)),i=i.concat(Ss(n.serverSyncTree_,A,!0))}else d=!0,h="nodata",i=i.concat(Ss(n.serverSyncTree_,c.currentWriteId,!0))}Ln(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(g){setTimeout(g,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}q_(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)fu(r[a]);H_(n,n.transactionQueueTree_)}function QU(n,e){let t,r=n.transactionQueueTree_;for(t=pe(e);t!==null&&na(r)===void 0;)r=V_(r,t),e=je(e),t=pe(e);return r}function YU(n,e){let t=[];return JU(n,e,t),t.sort((r,i)=>r.order-i.order),t}function JU(n,e,t){let r=na(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);U_(e,i=>{JU(n,i,t)})}function q_(n,e){let t=na(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,w0(e,t.length>0?t:void 0)}U_(e,r=>{q_(n,r)})}function C0(n,e){let t=Ph(QU(n,e)),r=V_(n.transactionQueueTree_,e);return wY(r,i=>{KD(n,i)}),KD(n,r),BU(r,i=>{KD(n,i)}),t}function KD(n,e){let t=na(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(V(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(V(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Ss(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?w0(e,void 0):t.length=s+1,Ln(n.eventQueue_,Ph(e),i);for(let o=0;o<r.length;o++)fu(r[o])}}function $Y(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function HY(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):en(`Invalid query segment '${t}' in query '${n}'`)}return e}var BS=function(n,e){let t=qY(n),r=t.namespace;t.domain==="firebase.com"&&ri(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&ri("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||wQ();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new o_(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Re(t.pathString)}},qY=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=$Y(n.substring(d,h)));let g=HY(n.substring(Math.min(n.length,h)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let _=e.slice(0,u);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let w=e.indexOf(".");r=e.substring(0,w).toLowerCase(),t=e.substring(w+1),s=r}"ns"in g&&(s=g.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var zV="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",zY=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=zV.charAt(t%64),t=Math.floor(t/64);V(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=zV.charAt(e[i]);return V(o.length===20,"nextPushId: Length should be 20."),o}}();var C_=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+gt(this.snapshot.exportVal())}},D_=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Dh=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return V(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var S_=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new Ct;return kY(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){On("OnDisconnect.remove",this._path);let e=new Ct;return qV(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){On("OnDisconnect.set",this._path),si("OnDisconnect.set",e,this._path,!1);let t=new Ct;return qV(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){On("OnDisconnect.setWithPriority",this._path),si("OnDisconnect.setWithPriority",e,this._path,!1),I0("OnDisconnect.setWithPriority",t,!1);let r=new Ct;return OY(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){On("OnDisconnect.update",this._path),$U("OnDisconnect.update",e,this._path,!1);let t=new Ct;return LY(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var mn=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return ge(this._path)?null:r0(this._path)}get ref(){return new Fn(this._repo,this._path)}get _queryIdentifier(){let e=xV(this._queryParams),t=t0(e);return t==="{}"?"default":t}get _queryObject(){return xV(this._queryParams)}isEqual(e){if(e=B(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=i0(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+XQ(this._path)}};function z_(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Os(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===ni){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Ns)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==xi)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===qe){if(e!=null&&!Ch(e)||t!=null&&!Ch(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(V(n.getIndex()instanceof mh||n.getIndex()===a0,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function G_(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Fn=class n extends mn{constructor(e,t){super(e,t,new wh,!1)}get parent(){let e=pU(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},hu=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new Re(e),r=ks(this.ref,e);return new n(this._node.getChild(t),r,qe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,ks(this.ref,r),qe)))}hasChild(e){let t=new Re(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function yu(n,e){return n=B(n),n._checkNotDeleted("ref"),e!==void 0?ks(n._root,e):n._root}function D0(n,e){n=B(n),n._checkNotDeleted("refFromURL");let t=BS(e,n._repo.repoInfo_.nodeAdmin);HU("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&ri("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),yu(n,t.path.toString())}function ks(n,e){return n=B(n),pe(n._path)===null?DY("child","path",e,!1):mu("child","path",e,!1),new Fn(n._repo,Ye(n._path,e))}function W_(n,e){n=B(n),On("push",n._path),si("push",e,n._path,!0);let t=WU(n._repo),r=zY(t),i=ks(n,r),s=ks(n,r),o;return e!=null?o=K_(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function XU(n){return On("remove",n._path),K_(n,null)}function K_(n,e){n=B(n),On("set",n._path),si("set",e,n._path,!1);let t=new Ct;return T0(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function ZU(n,e){n=B(n),On("setPriority",n._path),I0("setPriority",e,!1);let t=new Ct;return T0(n._repo,Ye(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function e2(n,e,t){if(On("setWithPriority",n._path),si("setWithPriority",e,n._path,!1),I0("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new Ct;return T0(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function t2(n,e){$U("update",e,n._path,!1);let t=new Ct;return PY(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function n2(n){n=B(n);let e=new Dh(()=>{}),t=new Sh(e);return xY(n._repo,n,t).then(r=>new hu(r,new Fn(n._repo,n._path),n._queryParams.getIndex()))}var Sh=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new C_("value",this,new hu(e.snapshotNode,new Fn(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new D_(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},A_=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new D_(this,e,t):null}createEvent(e,t){V(e.childName!=null,"Child events should have a childName.");let r=ks(new Fn(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new C_(e.type,this,new hu(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Lh(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,u=(d,h)=>{US(n._repo,n,a),c(d,h)};u.userCallback=t.userCallback,u.context=t.context,t=u}let o=new Dh(t,s||void 0),a=e==="value"?new Sh(o):new A_(e,o);return FY(n._repo,n,a),()=>US(n._repo,n,a)}function Q_(n,e,t,r){return Lh(n,"value",e,t,r)}function Fh(n,e,t,r){return Lh(n,"child_added",e,t,r)}function S0(n,e,t,r){return Lh(n,"child_changed",e,t,r)}function A0(n,e,t,r){return Lh(n,"child_moved",e,t,r)}function R0(n,e,t,r){return Lh(n,"child_removed",e,t,r)}function N0(n,e,t){let r=null,i=t?new Dh(t):null;e==="value"?r=new Sh(i):e&&(r=new A_(e,i)),US(n._repo,n,r)}var Vn=class{},R_=class extends Vn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){si("endAt",this._value,e._path,!0);let t=mS(e._queryParams,this._value,this._key);if(G_(t),Os(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function r2(n,e){return kh("endAt","key",e,!0),new R_(n,e)}var jS=class extends Vn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){si("endBefore",this._value,e._path,!1);let t=_7(e._queryParams,this._value,this._key);if(G_(t),Os(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function i2(n,e){return kh("endBefore","key",e,!0),new jS(n,e)}var N_=class extends Vn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){si("startAt",this._value,e._path,!0);let t=gS(e._queryParams,this._value,this._key);if(G_(t),Os(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function s2(n=null,e){return kh("startAt","key",e,!0),new N_(n,e)}var $S=class extends Vn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){si("startAfter",this._value,e._path,!1);let t=m7(e._queryParams,this._value,this._key);if(G_(t),Os(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function o2(n,e){return kh("startAfter","key",e,!0),new $S(n,e)}var HS=class extends Vn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new mn(e._repo,e._path,p7(e._queryParams,this._limit),e._orderByCalled)}};function a2(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new HS(n)}var qS=class extends Vn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new mn(e._repo,e._path,g7(e._queryParams,this._limit),e._orderByCalled)}};function c2(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new qS(n)}var zS=class extends Vn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){z_(e,"orderByChild");let t=new Re(this._path);if(ge(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new mh(t),i=P_(e._queryParams,r);return Os(i),new mn(e._repo,e._path,i,!0)}};function u2(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return mu("orderByChild","path",n,!1),new zS(n)}var GS=class extends Vn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){z_(e,"orderByKey");let t=P_(e._queryParams,ni);return Os(t),new mn(e._repo,e._path,t,!0)}};function l2(){return new GS}var WS=class extends Vn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){z_(e,"orderByPriority");let t=P_(e._queryParams,qe);return Os(t),new mn(e._repo,e._path,t,!0)}};function d2(){return new WS}var KS=class extends Vn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){z_(e,"orderByValue");let t=P_(e._queryParams,a0);return Os(t),new mn(e._repo,e._path,t,!0)}};function h2(){return new KS}var QS=class extends Vn{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(si("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new R_(this._value,this._key)._apply(new N_(this._value,this._key)._apply(e))}};function f2(n,e){return kh("equalTo","key",e,!0),new QS(n,e)}function er(n,...e){let t=B(n);for(let r of e)t=r._apply(t);return t}X7(Fn);rY(Fn);var GY="FIREBASE_DATABASE_EMULATOR_HOST",YS={},WY=!1;function KY(n,e,t,r){n.repoInfo_=new o_(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function x0(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||ri("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ot("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=BS(s,i),a=o.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[GY]),u?(c=!0,s=`http://${u}?ns=${a.namespace}`,o=BS(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new lh(lh.OWNER):new eS(n.name,n.options,e);HU("Invalid Firebase Database URL",o),ge(o.path)||ri("Database URL must point to the root of a Firebase Database (not including a child path).");let h=YY(a,n,d,new ZD(n.name,t));return new JS(h,n)}function QY(n,e){let t=YS[e];(!t||t[n.key]!==n)&&ri(`Database ${e}(${n.repoInfo_}) has already been deleted.`),KU(n),delete t[n.key]}function YY(n,e,t,r){let i=YS[e.name];i||(i={},YS[e.name]=i);let s=i[n.toURLString()];return s&&ri("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new VS(n,WY,t,r),i[n.toURLString()]=s,s}var JS=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(RY(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Fn(this._repo,Ae())),this._rootInternal}_delete(){return this._rootInternal!==null&&(QY(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ri("Cannot call "+e+" on a deleted database.")}};function p2(){fU.IS_TRANSPORT_INITIALIZED&&en("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function g2(){p2(),ph.forceDisallow()}function m2(){p2(),nu.forceDisallow(),ph.forceAllow()}function _2(n,e,t,r={}){n=B(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&ri("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ri('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new lh(lh.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:za(r.mockUserToken,n.app.options.projectId);s=new lh(o)}KY(i,e,t,s)}function y2(n){n=B(n),n._checkNotDeleted("goOffline"),KU(n._repo)}function v2(n){n=B(n),n._checkNotDeleted("goOnline"),VY(n._repo)}function w2(n,e){QV(n,e)}function JY(n){e0(un),cn(new Le("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return x0(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),lt(pV,gV,n),lt(pV,gV,"esm2017")}var XY={".sv":"timestamp"};function I2(){return XY}function E2(n){return{".sv":{increment:n}}}var XS=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function T2(n,e,t){var r;if(n=B(n),On("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new Ct,o=(c,u,d)=>{let h=null;c?s.reject(c):(h=new hu(d,new Fn(n._repo,n._path),qe),s.resolve(new XS(u,h)))},a=Q_(n,()=>{});return UY(n._repo,n._path,e,o,a,i),s.promise}s0.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};s0.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};JY();var ZY="@firebase/database-compat",eJ="1.0.5";var tJ=new In("@firebase/database-compat"),b2=function(n){let e="FIREBASE WARNING: "+n;tJ.warn(e)};var nJ=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(Qt(n,e)+"must be a boolean.")},rJ=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Qt(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var P0=class{constructor(e){this._delegate=e}cancel(e){ne("OnDisconnect.cancel",0,1,arguments.length),Dt("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){ne("OnDisconnect.remove",0,1,arguments.length),Dt("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){ne("OnDisconnect.set",1,2,arguments.length),Dt("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ne("OnDisconnect.setWithPriority",2,3,arguments.length),Dt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(ne("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,b2("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Dt("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var M0=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ne("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var ra=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return ne("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ne("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ne("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ne("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ne("DataSnapshot.child",0,1,arguments.length),e=String(e),mu("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return ne("DataSnapshot.hasChild",1,1,arguments.length),mu("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ne("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ne("DataSnapshot.forEach",1,1,arguments.length),Dt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return ne("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ne("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ne("DataSnapshot.ref",0,0,arguments.length),new Pi(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Y_=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;ne("Query.on",2,4,arguments.length),Dt("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(u,d)=>{t.call(o.context,new ra(this.database,u),d)};a.userCallback=t,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Q_(this._delegate,a,c),t;case"child_added":return Fh(this._delegate,a,c),t;case"child_removed":return R0(this._delegate,a,c),t;case"child_changed":return S0(this._delegate,a,c),t;case"child_moved":return A0(this._delegate,a,c),t;default:throw new Error(Qt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(ne("Query.off",0,3,arguments.length),rJ("Query.off",e,!0),Dt("Query.off","callback",t,!0),SI("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,N0(this._delegate,e,i)}else N0(this._delegate,e)}get(){return n2(this._delegate).then(e=>new ra(this.database,e))}once(e,t,r,i){ne("Query.once",1,4,arguments.length),Dt("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new Ct,a=(u,d)=>{let h=new ra(this.database,u);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let c=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(e){case"value":Q_(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":Fh(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":R0(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":S0(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":A0(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(Qt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ne("Query.limitToFirst",1,1,arguments.length),new n(this.database,er(this._delegate,a2(e)))}limitToLast(e){return ne("Query.limitToLast",1,1,arguments.length),new n(this.database,er(this._delegate,c2(e)))}orderByChild(e){return ne("Query.orderByChild",1,1,arguments.length),new n(this.database,er(this._delegate,u2(e)))}orderByKey(){return ne("Query.orderByKey",0,0,arguments.length),new n(this.database,er(this._delegate,l2()))}orderByPriority(){return ne("Query.orderByPriority",0,0,arguments.length),new n(this.database,er(this._delegate,d2()))}orderByValue(){return ne("Query.orderByValue",0,0,arguments.length),new n(this.database,er(this._delegate,h2()))}startAt(e=null,t){return ne("Query.startAt",0,2,arguments.length),new n(this.database,er(this._delegate,s2(e,t)))}startAfter(e=null,t){return ne("Query.startAfter",0,2,arguments.length),new n(this.database,er(this._delegate,o2(e,t)))}endAt(e=null,t){return ne("Query.endAt",0,2,arguments.length),new n(this.database,er(this._delegate,r2(e,t)))}endBefore(e=null,t){return ne("Query.endBefore",0,2,arguments.length),new n(this.database,er(this._delegate,i2(e,t)))}equalTo(e,t){return ne("Query.equalTo",1,2,arguments.length),new n(this.database,er(this._delegate,f2(e,t)))}toString(){return ne("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ne("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ne("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,Dt(e,"cancel",i.cancel,!0),i.context=r,SI(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(Qt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Pi(this.database,new Fn(this._delegate._repo,this._delegate._path))}},Pi=class n extends Y_{constructor(e,t){super(e,new mn(t._repo,t._path,new wh,!1)),this.database=e,this._delegate=t}getKey(){return ne("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ne("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,ks(this._delegate,e))}getParent(){ne("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return ne("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){ne("Reference.set",1,2,arguments.length),Dt("Reference.set","onComplete",t,!0);let r=K_(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(ne("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,b2("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}On("Reference.update",this._delegate._path),Dt("Reference.update","onComplete",t,!0);let r=t2(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ne("Reference.setWithPriority",2,3,arguments.length),Dt("Reference.setWithPriority","onComplete",r,!0);let i=e2(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){ne("Reference.remove",0,1,arguments.length),Dt("Reference.remove","onComplete",e,!0);let t=XU(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){ne("Reference.transaction",1,3,arguments.length),Dt("Reference.transaction","transactionUpdate",e,!1),Dt("Reference.transaction","onComplete",t,!0),nJ("Reference.transaction","applyLocally",r,!0);let i=T2(this._delegate,e,{applyLocally:r}).then(s=>new M0(s.committed,new ra(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){ne("Reference.setPriority",1,2,arguments.length),Dt("Reference.setPriority","onComplete",t,!0);let r=ZU(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){ne("Reference.push",0,2,arguments.length),Dt("Reference.push","onComplete",t,!0);let r=W_(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return On("Reference.onDisconnect",this._delegate._path),new P0(new S_(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var ia=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:g2,forceLongPolling:m2}}useEmulator(e,t,r={}){_2(this._delegate,e,t,r)}ref(e){if(ne("database.ref",0,1,arguments.length),e instanceof Pi){let t=D0(this._delegate,e.toString());return new Pi(this,t)}else{let t=yu(this._delegate,e);return new Pi(this,t)}}refFromURL(e){ne("database.refFromURL",1,1,arguments.length);let r=D0(this._delegate,e);return new Pi(this,r)}goOffline(){return ne("database.goOffline",0,0,arguments.length),y2(this._delegate)}goOnline(){return ne("database.goOnline",0,0,arguments.length),v2(this._delegate)}};ia.ServerValue={TIMESTAMP:I2(),increment:n=>E2(n)};function iJ({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){e0(t);let a=new Zi("database-standalone"),c=new oo("auth-internal",a);c.setComponent(new Le("auth-internal",()=>r,"PRIVATE"));let u;return i&&(u=new oo("app-check-internal",a),u.setComponent(new Le("app-check-internal",()=>i,"PRIVATE"))),{instance:new ia(x0(n,c,u,e,o),n),namespace:s}}var sJ=Object.freeze({__proto__:null,initStandalone:iJ});var oJ=ia.ServerValue;function aJ(n){n.INTERNAL.registerComponent(new Le("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new ia(i,r)},"PUBLIC").setServiceProps({Reference:Pi,Query:Y_,Database:ia,DataSnapshot:ra,enableLogging:w2,INTERNAL:sJ,ServerValue:oJ}).setMultipleInstances(!0)),n.registerVersion(ZY,eJ)}aJ(Ne);var cJ="firebase",uJ="10.12.2";Ne.registerVersion(cJ,uJ,"app-compat");var C2=(()=>{let e=class e{constructor(r){this.router=r}ngOnInit(){Ne.auth().onAuthStateChanged(r=>{r?this.router.navigate(["/chat"]):(this.router.navigate(["/log"]),document.getElementById("sidebar").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%")})}};e.\u0275fac=function(i){return new(i||e)(ut(Nt))},e.\u0275cmp=Rt({type:e,selectors:[["app-log"]],decls:9,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],["routerLink","/login",1,"button"],["routerLink","/register",1,"button"]],template:function(i,s){i&1&&(J(0,"div",0),De(1,"div",1),J(2,"div",2),De(3,"img",3),J(4,"button",4),re(5,"Accedi"),Q(),J(6,"button",5),re(7,"Registrati"),Q()(),De(8,"div",1),Q())},dependencies:[$p]});let n=e;return n})();var Ls=(()=>{let e=class e{constructor(r){this.router=r,this.messageQueue=[]}getUserData(){Ne.auth().onAuthStateChanged(r=>{r?Ne.firestore().collection("users_data").doc(r.uid).get().then(i=>{if(i.exists){var s=i.data();this.currentUser=s,document.getElementById("header-name-display").innerText=this.currentUser.name,document.getElementById("header-email-display").innerText=this.currentUser.email,document.getElementById("header-agency-display").innerText=this.currentUser.agencyName}else this.presentToast("Nessun utente trovato"),this.router.navigate(["/log"])}).catch(i=>{this.presentToast("Errore durante il recupero dell'utente:"+i.message)}):(console.log("Nessun utente loggato."),this.router.navigate(["/log"]))})}presentToast(r){this.animate1("toast-message"),this.messageQueue.push(r),this.messageQueue.length===1&&this.showMessageFromQueue()}showMessageFromQueue(){let r=this.messageQueue[0];document.getElementById("toast-message").style.display="flex",document.getElementById("toast-message-text").innerText=r,setTimeout(()=>{this.hideToastMessage()},3e3)}hideToastMessage(){this.animateFadeOut("toast-message"),setTimeout(()=>{document.getElementById("toast-message").style.display="none"},100),this.messageQueue.shift(),this.messageQueue.length>0&&(this.showMessageFromQueue(),this.animate1("toast-message"))}animate1(r){var i=document.getElementById(r),s=[{opacity:0},{opacity:1}],o={duration:150,easing:"ease-in-out"};i.animate(s,o)}animateFadeOut(r){var i=document.getElementById(r),s=[{opacity:1},{opacity:0}],o={duration:150,easing:"ease-out"};i.animate(s,o)}};e.\u0275fac=function(i){return new(i||e)(te(Nt))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var D2=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}login(){var r=document.getElementById("email-login-input").value,i=document.getElementById("password-login-input").value;Ne.auth().signInWithEmailAndPassword(r,i).then(s=>{var o=s.user;this.generalService.presentToast("Login effettuato con successo"),this.router.navigate(["/chat"])}).catch(s=>{s.code=="auth/invalid-credential"&&this.generalService.presentToast("Email o password non validi")})}};e.\u0275fac=function(i){return new(i||e)(ut(Ls),ut(Nt))},e.\u0275cmp=Rt({type:e,selectors:[["app-login"]],decls:15,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate",2,"color","#333"],["id","email-login-input","type","text","placeholder","Email",1,"input"],["id","password-login-input","type","text","placeholder","Password",1,"input"],[1,"button",3,"click"]],template:function(i,s){i&1&&(J(0,"div",0),De(1,"div",1),J(2,"div",2),De(3,"img",3),J(4,"div",4)(5,"span",5),re(6,"mail"),Q(),De(7,"input",6),Q(),J(8,"div",4)(9,"span",5),re(10,"key"),Q(),De(11,"input",7),Q(),J(12,"button",8),Kt("click",function(){return s.login()}),re(13,"Accedi"),Q()(),De(14,"div",1),Q())}});let n=e;return n})();var S2=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i}ngOnInit(){document.getElementById("sidebar").style.display="none",document.getElementById("header").style.display="none",document.getElementById("router-outlet-container").style.height="100%",document.getElementById("router-outlet-container").style.width="100%"}register(){var r=document.getElementById("email-register-input").value,i=document.getElementById("password-register-input").value,s=document.getElementById("confirm-password-register-input").value,o=document.getElementById("name-register-input").value,a=document.getElementById("agency-name-register-input").value;i==s?Ne.auth().createUserWithEmailAndPassword(r,i).then(c=>{let u=c.user;var d=Ne.firestore();d.collection("users_data").doc(u.uid).set({name:o,agencyName:a,email:r}).catch(h=>{this.generalService.presentToast("Errore nel salvataggio dei dati dell'utente durante la registrazione: "+h.message)}),this.generalService.presentToast("Registrazione completata con successo"),this.router.navigate(["/chat"])}).catch(c=>{c.code=="auth/invalid-email"&&this.generalService.presentToast("Email non valida"),c.code=="auth/weak-password"&&this.generalService.presentToast("Password troppo debole")}):this.generalService.presentToast("Le password inserite non corrispondono")}};e.\u0275fac=function(i){return new(i||e)(ut(Ls),ut(Nt))},e.\u0275cmp=Rt({type:e,selectors:[["app-register"]],decls:27,vars:0,consts:[[2,"width","100%","height","100%","display","flex","flex-direction","column","align-items","center"],[2,"flex","1"],[1,"card",2,"width","18rem","padding-top","1rem","padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem","padding-bottom","1rem"],["src","assets\\imgs\\logo.png",2,"width","100%"],[1,"input-group"],[1,"material-symbols-outlined","notranslate"],["id","name-register-input","type","text","placeholder","Nome di battesimo",1,"input"],["id","agency-name-register-input","type","text","placeholder","Nome agenzia",1,"input"],["id","email-register-input","type","email","placeholder","Email",1,"input"],["id","password-register-input","type","email","placeholder","Password",1,"input"],["id","confirm-password-register-input","type","email","placeholder","Conferma password",1,"input"],[1,"button",2,"width","100%","height","2.5rem",3,"click"]],template:function(i,s){i&1&&(J(0,"div",0),De(1,"div",1),J(2,"div",2),De(3,"img",3),J(4,"div",4)(5,"span",5),re(6,"person"),Q(),De(7,"input",6),Q(),J(8,"div",4)(9,"span",5),re(10,"store"),Q(),De(11,"input",7),Q(),J(12,"div",4)(13,"span",5),re(14,"mail"),Q(),De(15,"input",8),Q(),J(16,"div",4)(17,"span",5),re(18,"lock"),Q(),De(19,"input",9),Q(),J(20,"div",4)(21,"span",5),re(22,"lock"),Q(),De(23,"input",10),Q(),J(24,"button",11),Kt("click",function(){return s.register()}),re(25,"Register"),Q()(),De(26,"div",1),Q())}});let n=e;return n})();var A2=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){let r=Ne.database(),i=document.getElementById("messages"),s=yu(r,"messages");Fh(s,o=>{let a=o.val().text,c=document.createElement("div");c.className="chat-card";let u=document.createElement("p");u.style.marginBottom="0.5rem",u.textContent=o.val().name+" | "+o.val().email+" | "+this.convertTimestamp(o.val().timestamp),c.appendChild(u);let d=document.createElement("p");d.style.marginTop="0rem",d.textContent=a,c.appendChild(d),i.appendChild(c)})}sendMessage(){let r=Ne.database();var i=Ne.auth().currentUser;let s=document.getElementById("message-input"),o=s.value;if(o){let a=yu(r,"messages");W_(a,{text:o,name:this.generalService.currentUser.name,email:i.email,uid:i.uid,timestamp:Ne.database.ServerValue.TIMESTAMP}),s.value=""}}convertTimestamp(r){let i=new Date(r),s=i.getDate(),o=i.getMonth()+1,a=i.getFullYear(),c=i.getHours(),u=i.getMinutes(),d=i.getSeconds(),h=s<10?`0${s}`:`${s}`,g=o<10?`0${o}`:`${o}`,_=c<10?`0${c}`:`${c}`,w=u<10?`0${u}`:`${u}`,C=d<10?`0${d}`:`${d}`;return`${h}/${g}/${a} ${_}:${w}:${C}`}};e.\u0275fac=function(i){return new(i||e)(ut(Ls))},e.\u0275cmp=Rt({type:e,selectors:[["app-chat"]],decls:9,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden","padding-right","1rem"],["id","messages",2,"width","100%","height","calc(100% - 6rem)","display","flex","flex-direction","column","gap","1rem","overflow-x","hidden","overflow-y","auto","padding-right","1rem","padding-bottom","1rem"],[2,"width","100%","height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem"],["id","message-input","type","text","placeholder","Inserisci qui il tuo messaggio",2,"width","calc(100% - 3.5rem)","border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Poppins'",3,"keydown.enter"],["id","send-button",2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"]],template:function(i,s){i&1&&(J(0,"div",0)(1,"h2"),re(2,"Chat Generale"),Q(),De(3,"div",1),J(4,"div",2)(5,"input",3),Kt("keydown.enter",function(){return s.sendMessage()}),Q(),J(6,"button",4),Kt("click",function(){return s.sendMessage()}),J(7,"span",5),re(8,"send"),Q()()()())}});let n=e;return n})();var R2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rt({type:e,selectors:[["app-company"]],decls:7,vars:0,consts:[[2,"padding-left","1rem"],[2,"max-width","80%"]],template:function(i,s){i&1&&(J(0,"div",0)(1,"h3"),re(2,"L'azienda | Mission"),Q(),J(3,"p",1)(4,"strong"),re(5,"CI SONO MOLTE AGENZIE DI PRATICHE AUTO, INFINITE POSSIBILIT\xC0 PER AUTOMOBILISTI E ADDETTI AI LAVORI. CHE COSA RENDE AUTOTEAM DIVERSA E UNICA?"),Q(),re(6," NON CI SONO RICETTE SEGRETE: TUTTO PARTE DALLA PRECISA VOLONT\xC0 DI COSTRUIRE SOLIDE RELAZIONI CON I CLIENTI. DIALOGO, ASSISTENZA, PRESENZA: IN OGNI FASE DEL LAVORO, IN OGNI OCCASIONE, PER QUALSIASI NECESSIT\xC0, AUTOTEAM C'\xC8. UN'AMPIA GAMMA DI SERVIZI E UNA COSTANTE FORMAZIONE DEI COLLABORATORI GARANTISCE TEMPESTIVIT\xC0 E QUALIT\xC0 DEI SERVIZI, METTENDO A DISPOSIZIONE DELLA CLIENTELA PERSONALE ALTAMENTE QUALIFICATO E, DAL PUNTO DI VISTA UMANO, PERSONE DISPOSTE AD ASCOLTARE E A TROVARE LA SOLUZIONE MIGLIORE PER OGNI TIPO DI ESIGENZA. UN TEAM FUNZIONA SE ALLA BASE CI SONO VALORI SOLIDI E CONDIVISI. AGENZIA AUTOTEAM CREDE PROFONDAMENTE NEL PROPRIO GRUPPO: STIMA, FIDUCIA, RISPETTO PER I COLLABORATORI SONO LE FONDAMENTA SULLE QUALI SI BASA LA NOSTRA IDEA DI GRUPPO. OGNUNO \xC8 IMPORTANTE, IL CONTRIBUTO DI TUTTI CONTRIBUISCE ALLA CRESCITA E AL SUCCESSO. SENZA ANTONIA, SENZA LILIANA E SENZA ROSANNA UNA REALT\xC0 COME AUTOTEAM NON SAREBBE MAI NATA: PERCH\xC9 \xC8 DAL VALORE DELLE PERSONE CHE NASCONO STORIE DI SUCCESSO. PER QUESTO MOTIVO CREDIAMO CHE UN AMBIENTE SERENO, VIVIBILE E DOVE LA MERITOCRAZIA SIA CENTRALE, POSSA ESSERE TERRENO FERTILE PER RAGGIUNGERE AMBIZIOSI TRAGUARDI"),Q()())}});let n=e;return n})();var N2=(()=>{let e=class e{constructor(){}ngOnInit(){}showSector(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rt({type:e,selectors:[["app-settori"]],decls:29,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-y","auto","overflow-x","hidden","padding-left","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","cursor","pointer"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.5rem","margin-top","0.8rem","margin-bottom","0rem","cursor","pointer",3,"click"],[1,"material-symbols-outlined","notranslate"],[2,"width","28rem","height","16rem","background","#333","border-radius","1rem","margin-top","1rem","display","flex","align-items","center","justify-content","center","flex-shrink","0"],[1,"material-symbols-outlined","notranslate",2,"cursor","pointer","color","white","font-size","3rem"],[2,"width","28rem","height","16rem","background","#333","border-radius","1rem","margin-top","1rem","display","flex","align-items","center","justify-content","center","flex-shrink","0","margin-bottom","1rem"]],template:function(i,s){i&1&&(J(0,"div",0)(1,"h3",1),re(2,"Settori"),J(3,"span",2),re(4,"add_circle"),Q()(),J(5,"h4",3),Kt("click",function(){return s.showSector("commerciale")}),re(6,"Commerciale"),J(7,"span",4),re(8,"keyboard_arrow_down"),Q()(),J(9,"div",5)(10,"span",6),re(11,"play_circle"),Q()(),J(12,"h4",3),Kt("click",function(){return s.showSector("amministrativo")}),re(13,"Amministrativo"),J(14,"span",4),re(15,"keyboard_arrow_down"),Q()(),J(16,"div",5)(17,"span",6),re(18,"play_circle"),Q()(),J(19,"div",5)(20,"span",6),re(21,"play_circle"),Q()(),J(22,"h4",3),Kt("click",function(){return s.showSector("operativo")}),re(23,"Operativo"),J(24,"span",4),re(25,"keyboard_arrow_down"),Q()(),J(26,"div",7)(27,"span",6),re(28,"play_circle"),Q()()())}});let n=e;return n})();var x2=(()=>{let e=class e{ngOnInit(){document.getElementById("sidebar").style.display="flex",document.getElementById("header").style.display="flex",document.getElementById("router-outlet-container").style.height="calc(100% - 3.5rem)",document.getElementById("router-outlet-container").style.width="calc(100% - 18rem)"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rt({type:e,selectors:[["app-home"]],decls:1,vars:0,consts:[[2,"height","100%","padding-left","1rem","display","flex","flex-direction","row","flex-wrap","wrap"]],template:function(i,s){i&1&&De(0,"div",0)}});let n=e;return n})();var lJ=[{path:"",redirectTo:"chat",pathMatch:"full"},{path:"log",component:C2},{path:"login",component:D2},{path:"register",component:S2},{path:"company",component:R2},{path:"chat",component:A2},{path:"settori_e_procedure",component:N2},{path:"home",component:x2}],P2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=cr({type:e}),e.\u0275inj=ar({imports:[yI.forRoot(lJ),yI]});let n=e;return n})();var M2=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.initFirebase(),this.generalService.getUserData()}ngOnInit(){}initFirebase(){let r={apiKey:"AIzaSyCsD3AG7Zq7Aw_VAhn6N9ZGqVdabUrcFZU",authDomain:"tenquestion-6e3dd.firebaseapp.com",databaseURL:"https://tenquestion-6e3dd-default-rtdb.europe-west1.firebasedatabase.app",projectId:"tenquestion-6e3dd",storageBucket:"tenquestion-6e3dd.appspot.com",messagingSenderId:"438469942447",appId:"1:438469942447:web:97b3e3a5bf4620aa4f485a",measurementId:"G-3XVQGB22FD"};Ne.initializeApp(r)}logout(){window.confirm("Sei sicuro di volerti disconnettere?")&&Ne.auth().signOut().then(()=>{this.generalService.presentToast("Disconnessione effettuata con successo"),this.router.navigate(["/log"])}).catch(r=>{this.generalService.presentToast("Errore durante la disconnessione: "+r.message)})}};e.\u0275fac=function(i){return new(i||e)(ut(Ls),ut(Nt))},e.\u0275cmp=Rt({type:e,selectors:[["app-root"]],decls:40,vars:0,consts:[["id","toast-message",2,"height","100%","width","100%","display","none","flex-direction","column","pointer-events","none","background","transparent","z-index","99999999","position","absolute","align-items","center","justify-content","end"],[1,"toastMessage",2,"pointer-events","all"],["id","toast-message-text"],["id","header",2,"height","3.5rem","border-bottom","1px solid rgba(0, 0, 0, 0.192)","display","flex","flex-direction","row","align-items","center","flex-shrink","0","justify-content","space-between","padding-left","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","2rem","color","#333","cursor","pointer"],["id","header-name-display",2,"margin-bottom","0rem","margin-top","0rem"],["id","header-email-display",2,"margin-top","0rem","margin-bottom","0rem"],["id","header-agency-display",2,"margin-bottom","0rem","margin-top","0rem"],[2,"width","100%","height","100%","display","flex","flex-direction","row"],["id","sidebar",2,"display","flex","flex-direction","column","width","18rem","flex-shrink","0","height","calc(100% - 3.5rem)","background","white","border-right","1px solid rgba(0, 0, 0, 0.192)"],["src","assets\\imgs\\logo.png",2,"width","100%","margin-top","1rem"],["routerLink","/company",1,"sidebar-button"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],["routerLink","/ticket",1,"sidebar-button"],["routerLink","/chat",1,"sidebar-button"],["routerLink","/settori_e_procedure",1,"sidebar-button"],[2,"flex","1"],[1,"sidebar-button",2,"margin-bottom","1rem",3,"click"],["id","router-outlet-container",2,"width","calc(100% - 18rem)","height","calc(100% - 3.5rem)"]],template:function(i,s){i&1&&(J(0,"div",0)(1,"div",1),De(2,"p",2),Q()(),J(3,"div",3)(4,"div",4)(5,"span",5),re(6,"account_circle"),Q(),J(7,"div"),De(8,"h3",6)(9,"p",7),Q(),J(10,"p"),re(11," | "),Q(),J(12,"div"),De(13,"h3",8),Q()()(),J(14,"div",9)(15,"div",10),De(16,"img",11),J(17,"button",12)(18,"span",13),re(19,"apartment"),Q(),re(20,"L'azienda"),Q(),J(21,"button",14)(22,"span",13),re(23,"rss_feed"),Q(),re(24,"Ticket e Blog"),Q(),J(25,"button",15)(26,"span",13),re(27,"chat"),Q(),re(28,"Chat"),Q(),J(29,"button",16)(30,"span",13),re(31,"steppers"),Q(),re(32,"Settori e procedure"),Q(),De(33,"div",17),J(34,"button",18),Kt("click",function(){return s.logout()}),J(35,"span",13),re(36,"logout"),Q(),re(37,"Disconnetti"),Q()(),J(38,"div",19),De(39,"router-outlet"),Q()())},dependencies:[dI,$p]});let n=e;return n})();var k2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=cr({type:e,bootstrap:[M2]}),e.\u0275inj=ar({providers:[{provide:hr,useClass:wp}],imports:[AP,P2]});let n=e;return n})();SP().bootstrapModule(k2).catch(n=>console.error(n));
